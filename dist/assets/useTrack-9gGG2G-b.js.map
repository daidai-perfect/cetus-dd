{"version":3,"file":"useTrack-9gGG2G-b.js","sources":["../../../utils/src/gtag.ts","../../../hooks/src/useTrack.tsx"],"sourcesContent":["export const TrackDataProviders: any = {\n  CETUS: 'a',\n  DEEPBOOK: 'b',\n  DEEPBOOKV3: 'c',\n  KRIYA: 'd',\n  KRIYAV3: 'e',\n  FLOWX: 'f',\n  FLOWXV3: 'g',\n  AFTERMATH: 'h',\n  TURBOS: 'i',\n  HAEDAL: 'j',\n  HAEDALPMM: 'k',\n  VOLO: 'l',\n  AFSUI: 'm',\n  BLUEMOVE: 'n',\n  SCALLOP: 'o',\n  SPRINGSUI: 'p',\n  BLUEFIN: 'q',\n  ALPHAFI: 'r',\n  STEAMM: 's',\n  METASTABLE: 't',\n  OBRIC: 'u'\n}\n\nexport function trackShioEvent(type: string, status: boolean, tx: string) {\n  if (typeof window !== 'undefined' && (window as any).gtag) {\n    ;(window as any).gtag('event', 'track_shio_status', {\n      operation_type: type,\n      shio_enabled: status,\n      tx_hash: tx\n    })\n  }\n}\n\ntype CommonTrackData = {\n  action: string\n  txHash: string\n  actionTime: number\n}\n\ntype SwapTrackData = CommonTrackData & {\n  isOpenAggregator: boolean // ÊòØÂê¶ÂºÄÂêØAggregator\n  isDowngrade: boolean // ÊòØÂê¶ÈôçÁ∫ß\n  providers: string[] // ÂºÄÂêØÁöÑË∑ØÂæÑ\n  // errorMsg: string\n  fromCoin?: string // Áî®-ÂàÜÂâ≤ÔºåÂêéÈù¢Âä†Êï∞Èáè\n  toCoin?: string // Áî®-ÂàÜÂâ≤, ÂêéÈù¢Âä†Êï∞Èáè\n  // acountIn?: string\n  // amountOut?: string\n  isError: boolean\n  errorMsg1?: string\n  errorMsg2?: string\n  errorMsg3?: string\n  errorMsg4?: string\n  errorMsg5?: string\n  useMev?: boolean\n  useFastMode?: boolean\n}\n\nexport function trackTransaction(data: SwapTrackData) {\n  console.log('üöÄ ~ file: gtag.ts:30 ~ trackTransaction ~ data:', data)\n  const providerArr = data.providers.map((item: string) => TrackDataProviders?.[item])\n  const providerText = providerArr.join('')\n\n  console.log('üöÄ ~ file: gtsag.ts:30 ~ trackTransaction ~ final data:', {\n    ...data,\n    providers: providerText\n  })\n\n  if (typeof window !== 'undefined' && (window as any).gtag) {\n    ;(window as any).gtag('event', 'track_transaction', {\n      ...data,\n      providers: providerText\n    })\n  }\n}\n\nexport function trackWalletConnect({ walletName, walletAddress }: { walletName: string; walletAddress: string }) {\n  if (typeof window !== 'undefined' && (window as any).gtag) {\n    ;(window as any).gtag('event', 'wallet_connection', {\n      walletName,\n      walletAddress\n    })\n  }\n}\n","import { trackShioEvent, trackTransaction, trackWalletConnect } from '@cetus/utils'\n\nexport default function useTrack() {\n  const trackShio = (data: any, status: boolean, txHash: string) => {\n    const type = data?.action\n    const supported = [\n      'FarmingOpenAndAddLiquidity',\n      'FarmingIncreaseLiquidity',\n      'FarmingDecreaseLiquidity',\n      'FarmingRemoveLiquidity',\n      'FarmingRemoveLiquidity',\n      'OpenAndAddLiquidity',\n      'IncreaseLiquidity',\n      'RemoveLiquidity',\n      'DecreaseLiquidity',\n      'AddVaultsPosition',\n      'RemoveVaultsPosition',\n      'AggregatorSwap'\n    ]\n\n    if (supported.includes(type)) {\n      try {\n        trackShioEvent(type, status, txHash)\n      } catch (e) {\n        console.log('üöÄ ~ useTransaction ~ trackShioEvent error:', e)\n      }\n    }\n  }\n\n  const trackSwap = (params: any, error: string, txHash: string) => {\n    console.log('üöÄ ~ trackSwap ~ params:', params)\n    console.log('üöÄ ~ trackSwap ~ error:', error)\n    console.log('üöÄ ~ trackSwap ~ txHash:', txHash)\n    if (error === 'User rejected the request') return\n\n    try {\n      const action = 'Swap'\n      const actionTime = new Date().getTime()\n\n      const isOpenAggregator = params?.providerKey?.length > 1\n      const isDowngrade = !!params?.routerData?.isDowngrade\n      const providers = params?.providerKey || []\n      const fromCoin = `${params?.from}-${params?.routerData?.fromAmountUi}`\n      const toCoin = `${params?.to}-${params?.routerData?.toAmountUi}`\n      const isError = !!error\n\n      const data: any = {\n        action,\n        actionTime,\n        txHash,\n        isOpenAggregator,\n        isDowngrade,\n        providers,\n        fromCoin,\n        toCoin,\n        isError: !!error,\n        useMev: params?.useMev,\n        useFastMode: params?.useFastMode\n      }\n\n      const errorString = String(error)\n      const errorMsgLength = errorString.length\n      data['errorMsgLength'] = errorMsgLength\n      if (errorMsgLength > 100) {\n        let i = 1\n        while (i <= 5) {\n          data[`errorMsg${i}`] = errorString.slice((i - 1) * 100, (i - 1) * 100 + 100)\n          i++\n        }\n      } else if (isError) {\n        data['errorMsg1'] = errorString\n      }\n\n      console.log('useTrack üöÄ ~ trackSwap ~ data:', data)\n      trackTransaction(data)\n    } catch (error) {\n      console.log('üöÄ ~ useTrack ~ error:', error)\n    }\n  }\n\n  const toTrackWalletConnect = ({ walletAddress, walletName }: { walletAddress: string; walletName: string }) => {\n    // ‰∏ÄÂ§©‰∏Ä‰∏™Âú∞ÂùÄÂØπÂ∫î‰∏Ä‰∏™Èí±ÂåÖÂè™‰∏äÊä•‰∏ÄÊ¨°\n    const today = new Date().toISOString().split('T')[0] // Ëé∑ÂèñÂΩìÂ§©Êó•Êúü (YYYY-MM-DD)\n    const key = `wallet_connected_${walletName}_${walletAddress}`\n\n    const lastConnectionDate = localStorage.getItem(key)\n\n    if (!lastConnectionDate || lastConnectionDate !== today) {\n      localStorage.setItem(key, today) // Êõ¥Êñ∞‰∏∫‰ªäÂ§©ÁöÑÊó•Êúü\n      trackWalletConnect({\n        walletAddress,\n        walletName\n      })\n    }\n  }\n\n  return {\n    trackShio,\n    trackSwap,\n    toTrackWalletConnect\n  }\n}\n"],"names":["TrackDataProviders","trackShioEvent","type","status","tx","trackTransaction","data","providerText","item","trackWalletConnect","walletName","walletAddress","useTrack","txHash","e","params","error","action","actionTime","isOpenAggregator","_a","isDowngrade","_b","providers","fromCoin","_c","toCoin","_d","isError","errorString","errorMsgLength","i","today","key","lastConnectionDate"],"mappings":"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"}
import{a as d,j as t,V as z,u as Ve,H as P,T as C,C as ut,v as ye,f as jt,am as $t,S as mt,X as zt,Y as Lt,Z as Wt,$ as Bt,a8 as Ht,a0 as Ut,a1 as Ft,O as Gt,an as Vt,ao as qt,ap as Yt,aq as gt,I as Kt}from"./vendor-_1sPVx0S.js";import{M as Qt,C as Xt}from"./MenuDropBlock-CeK2yNtB.js";import{T as Zt,a as Jt}from"./TradeTab-CZ-zbyAg.js";import{u as qe}from"./useTransaction-DopuwF40.js";import{e as fe,h as It,u as pt,a as Ye,b as ft,c as Ot,B as je,d as _,i as lt,j as R,t as $e,I as Oe,C as es,k as Ke,l as ts,m as ss,n as as,D as ge,o as Fe,p as ot,q as dt,r as we,v as is,S as ns,w as Ge,N as cs,x as ls}from"./index-DZworFuu.js";import{P as Pt}from"./Pagination-mtBmubrM.js";import{N as rt}from"./NoData-CxevJSkT.js";import{R as ht}from"./RefreshButton-C6wipRYR.js";import{u as At,R as Tt}from"./RangeValue-CZfdgmR_.js";import{D as os,e as rs,g as us}from"./useWrapPoolData-CDrg47b6.js";import{H as ue}from"./HTextLabelBox-DBHn66eq.js";import{E as Ee}from"./ErrorTips-DTGb4xHZ.js";import{u as xt}from"./useAccountBalance-Bqky3zOE.js";import{u as ps}from"./useInsufficientBalanceToast-DGofqIoS.js";import{A as xs}from"./aggregator-Dpwk2mAM.js";import{A as yt}from"./useSwapHelper-5Q8nfW7L.js";import{u as _t}from"./useTokenBalance-Bm-sJqFs.js";import{u as ms}from"./useFindBestRouting-Lj4RLbMT.js";import{u as Ct}from"./useToken-BWHB2fhl.js";import{i as gs}from"./icon_currentprice@2x-DeObnx8l.js";import{C as ds}from"./CurrentPrice-CGR3x2xi.js";import{T as hs}from"./TooltipIcon-2k0oF2Ae.js";import{T as ys}from"./TradeInputGroup-BU_bV5JV.js";import{W as _s}from"./WarningTokenTipModal-C36z3uwB.js";import{S as St}from"./SingleTokenInfo-BOld9qyS.js";import{I as Nt}from"./InputBox-DNXDX2jY.js";import{LimitPriceChart as Ss}from"./LimitPriceChart-CN8wSsK1.js";import{u as bs}from"./global-CG4XJcf0.js";import{u as vs}from"./useInterval-DnUakcwK.js";import{u as Ds}from"./useRpcListener-DH9nq8gz.js";import"./IconBg-DlQiyDex.js";import"./useSigner-CskzV9L0.js";import"./useGetPoolList-CsB88aY2.js";import"./_getAllKeysIn-BnIExAEt.js";import"./CheckBox-BlDWS91y.js";import"./CopyButton-Dh94jbmg.js";import"./usePreviousValue-CZ-jBHri.js";function kt(){const{peripherySdk:a}=fe();return{dcaCloseOrderPayload:async e=>await a.Dca.dcaCloseOrderPayload(e)}}function Rt(){const{peripherySdk:a}=fe();return{dcaWithdrawPayload:async e=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaClaim.ts:12 ~ params:",e),await a.Dca.withdrawAll(e))}}const ws=(a,s)=>({upperPriceSize:"0%",setUpperPriceSize:e=>{a(()=>({upperPriceSize:e}))},lowerPriceSize:"0%",setLowerPriceSize:e=>{a(()=>({lowerPriceSize:e}))},dcaMode:"total",setDcaMode:e=>{a(()=>({dcaMode:e}))},isDcaRefresh:!1,setIsDcaRefresh:e=>{a(()=>({isDcaRefresh:e}))},pageDirect:!1,setPageDirect:e=>{a(()=>({pageDirect:e}))},sellTotalAmount:"",setSellTotalAmount:e=>{a(()=>({sellTotalAmount:e}))},sellAmount:"",setSellAmount:e=>{a(()=>({sellAmount:e}))},buyAmount:"",setBuyAmount:e=>{a(()=>({buyAmount:e}))},sellCoin:void 0,setSellCoin:e=>{a(()=>({sellCoin:e}))},buyCoin:void 0,setBuyCoin:e=>{a(()=>({buyCoin:e}))},orderNum:"2",setOrderNum:e=>{a(()=>({orderNum:e}))},investNum:"1",setInvestNum:e=>{a(()=>({investNum:e}))},currentCoinKey:"sellCoin",setCurrentCoinKey:e=>{a(()=>({currentCoinKey:e}))},currentInvest:"Hour",setCurrentInvest:e=>{a(()=>({currentInvest:e}))},pageLoading:!0,setPageLoading:e=>{a(()=>({pageLoading:e}))},dcaConfig:{},setDcaConfig:e=>{a(()=>({dcaConfig:e}))},dcaQuote:{},setDcaQuote:e=>{a(()=>({dcaQuote:e}))},orderHistoryObj:{},setOrderHistoryObj:e=>{a(()=>({orderHistoryObj:{...s().orderHistoryObj,...e}}))},inCoinWhiteList:[],setInCoinWhiteList:e=>{a(()=>({inCoinWhiteList:e}))},outCoinWhiteList:[],setOutCoinWhiteList:e=>{a(()=>({outCoinWhiteList:e}))}}),se=It(ws);function js(){const{fetchByApi:a}=pt(),{setOrderHistoryObj:s}=se();return{getDcaOrderHistory:async({orderId:y,limit:p,offset:o})=>{var i;const n=await a(os,"GET",{order_id:y,limit:p,offset:o});if(console.log("ðŸš€ ~ file: useGetDcaOrderHistory.ts:16 ~ useGetDcaOrderHistory ~ res:",n),n!=null&&n.list){const m={[y]:{list:((i=n==null?void 0:n.list)==null?void 0:i.map(c=>({inAmount:c==null?void 0:c.in_amount,outAmount:c==null?void 0:c.out_amount,inCoinType:c==null?void 0:c.in_coin,outCoinType:c==null?void 0:c.out_coin,time:c==null?void 0:c.execution_at,tx:c==null?void 0:c.tx})))||[],total:(n==null?void 0:n.total)||0}};return s(m),m}}}}function fs({isDetail:a,currentTabVal:s,orderInfo:e,handleRefresh:y,pageDirect:p}){const{isApp:o}=Ye(),{inCoin:n,outCoin:i}=e,{getDcaOrderHistory:m}=js(),[c,g]=d.useState(p),[u,b]=d.useState(p),x=10,[r,h]=d.useState([]),[w,j]=d.useState(0),[L,H]=d.useState(1),[M,D]=d.useState(!1),[U,G]=d.useState({label:"Overview",value:"overview"}),J=d.useMemo(()=>[{label:"Overview",value:"overview"},{label:M||Number(w)===0?"Orders":`Orders (${w})`,value:"orders"}],[w]),B=S=>{G(S),e!=null&&e.orderID&&I(e==null?void 0:e.orderID,x,0,!1)};d.useEffect(()=>{a&&(e!=null&&e.orderID)&&I(e==null?void 0:e.orderID,x,0,!1)},[e,a]);const ae=S=>{console.log("ðŸš€ ~ handleCurrentPage ~ page:",S);const A=(S-1)*x;I(e==null?void 0:e.orderID,x,A,!1),H(S)},I=async(S,A,F,T=!1)=>{var ee,ie,ne,_e;console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ loading:",T),D(T);const $=await m({orderId:S,limit:A,offset:F});console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ res?.list:",$,$[S]),(ee=$[S])!=null&&ee.list&&h((ie=$[S])==null?void 0:ie.list),(ne=$[S])!=null&&ne.total&&j((_e=$[S])==null?void 0:_e.total),D(!1),console.log("ðŸš€ ~ file: TestData.tsx:170 ~ handleGetDcaOrderHistory ~ res:",$)},[E,N]=d.useState(!1),{dcaWithdrawPayload:f}=Rt();xt();const{signAndExecuteTransaction:W}=qe(),K=async()=>{N(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",e);const S=[],A={order_id:e==null?void 0:e.orderID,in_coin_type:e==null?void 0:e.inCoin.coin_type,out_coin_type:e==null?void 0:e.outCoin.coin_type};S.push(A),console.log("ðŸš€ ~ toClaim ~ claimOrderParams:",S);const F=await f(S),T=await W(F,{getShowInfo:$=>{var ie,ne;const ee={modalDescriptionText:`${(ie=e==null?void 0:e.outCoin)==null?void 0:ie.symbol} Claimed`,toastTitleText:`${(ne=e==null?void 0:e.outCoin)==null?void 0:ne.symbol} Claimed`};return $==="success"&&(ee.toastDescriptionContent=""),ee}});T&&(console.log("ðŸš€ ~ toClaim ~ res:",T),setTimeout(()=>{y()},2e3)),N(!1)}catch(S){console.log("ðŸš€ ~ toClaim ~ error:",S),N(!1)}},{getExplorerUrl:O}=ft();return t.jsxs(z,{w:"100%",gap:"20px",children:[t.jsx(Ot,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:J,currentTab:U.label,handleChangeTab:B}),t.jsxs(je,{p:"30px 8px 20px",mt:"-42px",borderRadius:"8px",zIndex:"0",bg:"bg_primary",children:[U.value=="orders"&&(M?t.jsx(Ve,{height:"4",width:"100%"}):(r==null?void 0:r.length)===0?t.jsx(rt,{type:"nodata",text:"No orders",noBorder:!0,p:"12px",bg:"none"}):t.jsxs(z,{w:"100%",align:"flex-start",gap:"16px",mt:"12px",children:[!o&&t.jsxs(P,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[t.jsx(Z,{label:"Order info",value:"",w:{base:"100%",lg:"40%"}}),t.jsx(Z,{label:"Rate",value:"",w:{base:"100%",lg:"calc(32% - 16px)"},direct:u,onChangeDirect:()=>b(!u)}),t.jsx(Z,{label:"Time (UTC)",value:"",w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]}),r==null?void 0:r.map(S=>{console.log("ðŸš€ ~ {orderHistoryList?.map ~ orderHistory:",S);const A=lt(S.inAmount,n==null?void 0:n.decimals),F=lt(S.outAmount,i==null?void 0:i.decimals),T=_(A).div(F).toString(),$=_(1).div(T).toString();return t.jsxs(P,{w:"100%",flexDirection:{base:"column",lg:"row"},borderBottom:o?"1px solid":"none",pb:o?"16px":"0",borderColor:"border",_last:{borderBottom:"none",pb:"0"},children:[t.jsx(Z,{label:o?"Order info":"",value:`${R(A)} ${n.symbol} â†’ ${R(F)} ${i.symbol}`,w:{base:"100%",lg:"40%"}}),t.jsx(Z,{label:o?"Rate":"",value:u?`${R(T)} ${n.symbol} per ${i.symbol}`:`${R($)} ${i.symbol} per ${n.symbol}`,w:{base:"100%",lg:"calc(32% - 16px)"},direct:u,showDirectIcon:!!o,onChangeDirect:()=>b(!u)}),t.jsx(Z,{label:o?"Time (UTC)":"",value:t.jsxs(P,{h:"12px",children:[t.jsx(C,{fontSize:"12px",color:"text_caption",children:$e((S==null?void 0:S.time)*1e3,"YMDHM")}),t.jsx(Oe,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(O(S==null?void 0:S.tx,"tx"))}})]}),w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]},S==null?void 0:S.time)}),_(w).gt(x)&&t.jsx(ut,{w:"100%",children:t.jsx(Pt,{total:w,size:x,currentPage:L,onChange:ae})})]})),U.value=="overview"&&t.jsxs(z,{align:"flex-start",gap:"20px",children:[(e==null?void 0:e.isShowTradeTips)&&(e==null?void 0:e.orderStatus)=="Active"&&s=="active"&&t.jsx(Os,{}),t.jsxs(z,{w:"100%",borderRadius:"8px",p:"12px",bg:"card_bg",gap:"12px",children:[t.jsx(ue,{isLoading:!1,label:`DCA  ${n==null?void 0:n.symbol} Balance`,value:`${R(e==null?void 0:e.inBalance,2)||"0"} ${n==null?void 0:n.symbol}`,skeletonStyle:{valueW:"128px"}}),t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsxs(C,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]}),t.jsxs(P,{children:[t.jsxs(C,{color:"text_caption",fontSize:"12px",children:[(e==null?void 0:e.outBalance)>0?R(e==null?void 0:e.outBalance):e==null?void 0:e.outBalance," ",i==null?void 0:i.symbol]}),s=="active"&&t.jsx(ye,{isLoading:E,onClick:K,disabled:(e==null?void 0:e.outBalance)<=0||E,w:"60px",h:"20px",fontSize:"12px",borderRadius:"4px",variant:"outline",children:"Claim"})]})]}),t.jsx(ue,{isLoading:!1,label:"Amount Withdrawn",value:s=="active"?`${R(e==null?void 0:e.outWithdraw,2)}`:(e==null?void 0:e.orderStatus)=="PartialDeal"||(e==null?void 0:e.orderStatus)=="Close"?_(e==null?void 0:e.outWithdraw).gt(0)?`${R(e==null?void 0:e.inWithdrawn)} ${n==null?void 0:n.symbol} ${R(e==null?void 0:e.outWithdraw)} ${i==null?void 0:i.symbol}`:`${R(e==null?void 0:e.inWithdrawn)} ${n==null?void 0:n.symbol}`:`${R(e==null?void 0:e.outWithdraw)} ${i==null?void 0:i.symbol}`,skeletonStyle:{valueW:"128px"}})]}),t.jsxs(P,{flexWrap:"wrap",p:{base:"0",lg:"0 12px"},mt:{base:"-12px",lg:"-28px"},sx:{">div":{mt:{base:"12px",lg:"28px"},w:{base:"100%",lg:"calc((100% - 66px)/3)"},"&:nth-child(3n+1)":{mr:{base:"0",lg:"50px"}}}},children:[t.jsx(Z,{label:"Invest Every",value:e==null?void 0:e.investEvery}),t.jsx(Z,{label:"# of Orders Left",value:e==null?void 0:e.ofOrderLeft}),t.jsx(Z,{label:"Each Order Size",value:`${e==null?void 0:e.eachOrderSize} ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right"}),t.jsx(Z,{label:"Minimum Price",value:c?`${e==null?void 0:e.minPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.minPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,direct:c,onChangeDirect:()=>g(!c)}),t.jsx(Z,{label:"Maximum Price",value:c?`${e==null?void 0:e.maxPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.maxPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,direct:c,onChangeDirect:()=>g(!c)}),s=="active"&&t.jsx(Z,{label:"Current Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>g(!c)}),s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"&&t.jsx(Z,{label:"Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>g(!c)}),s=="active"&&t.jsx(Z,{label:"Next Order (UTC)",value:e==null?void 0:e.nextCycleAt}),t.jsx(Z,{label:"Created (UTC)",value:e==null?void 0:e.createAt,align:s=="active"||s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"?"flex-start":"flex-end"})]})]})]})]})}const Z=({label:a,value:s,direct:e,onChangeDirect:y,textAlign:p="left",showDirectIcon:o=!0,...n})=>t.jsxs(z,{align:"flex-start",flexDirection:{base:"row",lg:"column"},w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"unset"},...n,children:[a!==""&&t.jsxs(P,{h:"12px",children:[t.jsx(C,{fontSize:"12px",children:a}),y&&o&&t.jsx(Oe,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:y})]}),s!==""&&t.jsx(jt,{fontSize:"12px",color:"text_caption",textAlign:p,children:s})]}),Os=()=>t.jsxs(z,{p:"12px 12px 0",align:"flex-start",children:[t.jsx(P,{children:t.jsx(Ee,{tips:"The system tried to execute your order multiple times but did not get it through. This is possibly because:",type:"warning",tipsFontSize:"12px",p:"0",bg:"none",svgW:"20px",svgH:"20px"})}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market price is not in your required price range"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market no longer exit"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market is extremely volatile"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"This DCA will continue to be attempted and the estimated end date may be extended until your order is fully executed."})]});function Ps({currentTabVal:a,orderInfo:s,handleRefresh:e}){const{isApp:y}=Ye(),{inCoin:p,outCoin:o}=s,[n,i]=d.useState(!1),[m,c]=d.useState(!1);d.useEffect(()=>{i(!1)},[a]);const{getTokenRank:g}=At(),[u,b]=d.useState(!1);d.useEffect(()=>{const j=g(p,o);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",o,p,j),b(!j)},[p==null?void 0:p.coin_type,o==null?void 0:o.coin_type]);const{dcaCloseOrderPayload:x}=kt(),{signAndExecuteTransaction:r}=qe(),h=async()=>{c(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",s);const j=[{order_id:s==null?void 0:s.orderID,in_coin_type:s==null?void 0:s.inCoin.coin_type,out_coin_type:s==null?void 0:s.outCoin.coin_type}];console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-order-card.vue:280 ~ closeOrder ~ closeOrderParams:",j);const L=await x(j),H=await r(L,{getShowInfo:M=>{const D={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return M==="success"&&(D.modalDescriptionText="DCA Order Closed",D.toastDescriptionContent="",D.toastTitleText="DCA Order Closed"),D}});console.log("ðŸš€ ~ closeOrder ~ res:",H),H&&setTimeout(()=>{e()},2e3),c(!1)}catch(j){console.log("ðŸš€ ~ closeOrder ~ error:",j),c(!1)}},{getExplorerUrl:w}=ft();return t.jsxs(z,{w:"100%",gap:"12px",align:"flex-start",children:[t.jsxs(P,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[t.jsxs(P,{children:[t.jsx(es,{coinAIconUrl:p==null?void 0:p.logo_url,coinBIconUrl:o==null?void 0:o.logo_url,coinACoinType:p==null?void 0:p.coin_type,coinBCoinType:o==null?void 0:o.coin_type,w:"28px",h:"28px"}),t.jsxs(C,{color:"text_caption",children:[p==null?void 0:p.symbol," â†’ ",o==null?void 0:o.symbol]}),t.jsx(Oe,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(w(s==null?void 0:s.orderID,"poolAddress"))}})]}),!y&&t.jsx(bt,{currentTabVal:a,isCloseLoading:m,closeOrder:h,orderInfo:s,isDetail:n,onClickDetail:()=>i(!n)})]}),t.jsxs(P,{children:[t.jsxs(C,{color:"text_caption",fontSize:"12px",children:[R(s==null?void 0:s.inDepositedOut)," ",p==null?void 0:p.symbol]}),t.jsxs(C,{color:"primary_gray",fontSize:"12px",children:["/ ",R(s==null?void 0:s.inDeposited)," ",p==null?void 0:p.symbol]}),t.jsxs(C,{color:"primary_gray",fontSize:"12px",children:["(",s==null?void 0:s.inBalanceRatio,"%)"]}),t.jsx($t,{w:"50px",h:"4px",value:s==null?void 0:s.inBalanceRatio,bg:"#282828",sx:{'div[role="progressbar"]':{bg:"primary"}}})]}),t.jsxs(P,{w:"100%",children:[t.jsx(C,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),t.jsx(Tt,{displayTokenA:o,displayTokenB:p,isRank:!0,priceInfo:{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,minPriceResever:s==null?void 0:s.minPriceResever,maxPriceResever:s==null?void 0:s.maxPriceResever},fontSize:"12px"})]}),y&&t.jsx(bt,{currentTabVal:a,isCloseLoading:m,closeOrder:h,orderInfo:s,isDetail:n,onClickDetail:()=>i(!n)}),n&&t.jsx(fs,{pageDirect:u,isDetail:n,currentTabVal:a,orderInfo:s,handleRefresh:e})]})}const bt=({currentTabVal:a,isCloseLoading:s,closeOrder:e,orderInfo:y,isDetail:p,onClickDetail:o})=>t.jsxs(P,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[a=="active"&&t.jsx(ye,{w:{base:"100%",lg:"unset"},isLoading:s,disabled:s,onClick:e,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(y==null?void 0:y.outBalance)<=0?"Close":"Close and Withdraw"}),t.jsx(ye,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:t.jsx(Oe,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:o,children:"Details"})]});function vt({handleRefresh:a,activeList:s,pastList:e,isOrderLoading:y}){const[o,n]=d.useState([]),[i,m]=d.useState([]),[c,g]=d.useState(0),[u,b]=d.useState(1),{currentAccount:x,onWalletModal:r}=Ke(),[h,w]=d.useState({label:"Active DCAs",value:"active"}),j=d.useMemo(()=>[{label:"Active DCAs",value:"active",num:(s==null?void 0:s.length)>0?s==null?void 0:s.length:void 0},{label:"Past DCAs",value:"past",num:(e==null?void 0:e.length)>0?e==null?void 0:e.length:void 0}],[h==null?void 0:h.value,s,e]),L=f=>{b(1),w(f)};d.useEffect(()=>{const f=(h==null?void 0:h.value)==="active"?s:e;n(f),g(f==null?void 0:f.length)},[h==null?void 0:h.value,s,e]),d.useEffect(()=>{const f=(u-1)*10,W=f+10;m(o==null?void 0:o.slice(f,W))},[u,o,h==null?void 0:h.value]);const H=d.useMemo(()=>(h==null?void 0:h.value)==="past"||(o==null?void 0:o.length)===0?0:o==null?void 0:o.reduce((f,W)=>_(f).plus(W==null?void 0:W.outBalance),_(0)).toString(),[h==null?void 0:h.value,o]),[M,D]=d.useState(!1),[U,G]=d.useState(!1),{dcaWithdrawPayload:J}=Rt(),{dcaCloseOrderPayload:B}=kt(),{signAndExecuteTransaction:ae}=qe(),I=async()=>{G(!0);try{const f=o==null?void 0:o.map(O=>({order_id:O==null?void 0:O.orderID,in_coin_type:O==null?void 0:O.inCoin.coin_type,out_coin_type:O==null?void 0:O.outCoin.coin_type}));console.log("ðŸš€ ~ const closeOrderParams:any=pageList.map ~ closeOrderParams:",f);const W=await B(f),K=await ae(W,{getShowInfo:O=>{const S={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return O==="success"&&(S.modalDescriptionText="DCA Order Closed",S.toastDescriptionContent="",S.toastTitleText="DCA Order Closed"),S}});console.log("ðŸš€ ~ closeAll ~ res:",K),K&&setTimeout(()=>{a(!0)},2e3),G(!1)}catch(f){console.log("ðŸš€ ~ closeAll ~ error:",f),G(!1)}},E=async()=>{D(!0);try{const f=o==null?void 0:o.map(O=>({order_id:O==null?void 0:O.orderID,in_coin_type:O==null?void 0:O.inCoin.coin_type,out_coin_type:O==null?void 0:O.outCoin.coin_type}));console.log("ðŸš€ ~ const claimOrderParams:any=pageList.map ~ claimOrderParams:",f);const W=await J(f),K=await ae(W,{getShowInfo:O=>{const S={modalDescriptionText:"DCA Order Claimed",toastTitleText:"DCA Order Claimed"};return O==="success"&&(S.toastDescriptionContent=""),S}});console.log("ðŸš€ ~ claimAll ~ res:",K),K&&setTimeout(()=>{a(!0)},2e3),D(!1)}catch(f){console.log("ðŸš€ ~ claimAll ~ error:",f),D(!1)}},{isApp:N}=Ye();return t.jsxs(z,{w:"100%",children:[t.jsxs(P,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[t.jsxs(P,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[t.jsx(Ot,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:j,currentTab:h.label,handleChangeTab:L}),N&&t.jsx(ht,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),t.jsxs(P,{w:{base:"100%",lg:"unset"},children:[h.value==="active"&&(o==null?void 0:o.length)>0&&(x==null?void 0:x.address)&&t.jsx(ye,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:M,disabled:Number(H)===0||M,onClick:E,leftIcon:t.jsx(Oe,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),h.value==="active"&&(o==null?void 0:o.length)>0&&(x==null?void 0:x.address)&&t.jsx(ye,{w:{base:"50%",lg:"unset"},isLoading:U,disabled:(o==null?void 0:o.length)==0||U,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:I,children:"Close All"}),!N&&t.jsx(ht,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),x!=null&&x.address?y?t.jsx(je,{children:t.jsx(z,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((f,W)=>t.jsx(As,{},W))})}):(o==null?void 0:o.length)===0?t.jsx(rt,{type:"nodata",text:(h==null?void 0:h.value)==="active"?"No active orders":"No closed orders"}):t.jsxs(je,{h:(i==null?void 0:i.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[t.jsx(z,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:i==null?void 0:i.map(f=>t.jsx(Ps,{handleRefresh:()=>a(!0),currentTabVal:h.value,orderInfo:f},f==null?void 0:f.orderID))}),!y&&(o==null?void 0:o.length)>10&&t.jsx(ut,{mt:"28px",children:t.jsx(Pt,{total:c,size:10,currentPage:u,onChange:b})})]}):t.jsx(rt,{type:"nowallet",onboard:()=>r(!0)})]})}const As=()=>t.jsxs(z,{w:"100%",gap:"16px",align:"flex-start",children:[t.jsxs(P,{w:"100%",gap:"0",justify:"space-between",children:[t.jsxs(P,{gap:"0",children:[t.jsxs(P,{gap:"0px",mr:"8px",align:"flex-start",children:[t.jsx(mt,{size:"8"}),t.jsx(mt,{size:"8"})]}),t.jsx(Ve,{height:"4",width:"100px"})]}),t.jsx(Ve,{height:"4",width:"150px"})]}),t.jsx(Ve,{height:"4",width:"180px"})]});function Ts(){const{fetchByApi:a}=pt(),{peripherySdk:s}=fe(),{setDcaConfig:e}=se(),y=async()=>await a(rs,"GET")||null,p=async()=>await s.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const n={};try{const i=await y();i&&(n.minCycleAmountInUsd=i==null?void 0:i.min_amount_in_usd)}catch(i){console.log("ðŸš€ ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",i)}try{const i=await p();n.minCycleCount=i==null?void 0:i.min_cycle_count,n.minCycleFrequency=i==null?void 0:i.min_cycle_frequency,n.whitelistMode=i==null?void 0:i.whitelist_mode}catch(i){console.log("ðŸš€ ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",i)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",n),e(n),n}}}function Mt(){const{fetchByApi:a}=pt(),{setDcaQuote:s}=se();return{getDcaQuote:async({inCoin:y,freq:p,count:o,sender:n})=>{try{const i=await a(us,"GET",{in_coin:y,freq:p,count:o,sender:n});if(i){const m={amountInLimitPerCycle:i==null?void 0:i.amount_in_limit_per_cycle,coinType:i==null?void 0:i.coin_type,feeRate:i==null?void 0:i.fee_rate,signature:i==null?void 0:i.signature,signer:i==null?void 0:i.signer,timestamp:i==null?void 0:i.timestamp};return s(m),m}}catch(i){console.log("getDcaQuote ~ error:",i)}return null}}}function Cs(){var X,ve;const{sellCoin:a,buyCoin:s,setSellCoin:e,setBuyCoin:y,sellAmount:p,buyAmount:o,setBuyAmount:n,setSellAmount:i,dcaConfig:m,setCurrentCoinKey:c,currentCoinKey:g,investNum:u,currentInvest:b,orderNum:x,dcaQuote:r,setInvestNum:h,setOrderNum:w,setCurrentInvest:j,setPageDirect:L,pageDirect:H,dcaMode:M,sellTotalAmount:D,setSellTotalAmount:U,setLowerPriceSize:G,setUpperPriceSize:J}=se(),{currentAccount:B}=Ke(),{getDcaConfig:ae}=Ts(),{getDcaQuote:I}=Mt(),{coinPriceObj:E}=ts(),{fetchTokenPrices:N,getTokenAmountValue:f}=ss(),[W,K]=d.useState(""),O=d.useRef(W);d.useEffect(()=>{O.current=W},[W]);const S=()=>{console.log("ðŸš€ ~ initiaTokenSelect ~ setSellCoin:"),e(dt.clmm_swap.from_coin),y(dt.clmm_swap.to_coin)};d.useEffect(()=>(G("0%"),J("0%"),S(),ae(),()=>{ce()}),[]);const[A,F]=d.useState(""),[T,$]=d.useState(""),{balanceInfo:ee}=_t(a),{balanceInfo:ie}=_t(s),ne=f(a==null?void 0:a.coin_type,p),_e=l=>{c("sellCoin"),i(l),be()};d.useEffect(()=>{+p&&+x?M=="total"?U(p):U(_(p).mul(x).toString()):U("")},[p,M,x]);const Qe=()=>{const l=H?a==null?void 0:a.decimals:s==null?void 0:s.decimals;if(L(!H),A&&T){const k=A,q=_(1).div(T).toString(),re=_(1).div(k).toString();F(we(q,l,!0).toString()),$(we(re,l,!0).toString())}},Xe=(l,k=!0)=>{var q,re,De,he;F(""),$(""),k?(((q=l==null?void 0:l.coin_type)==null?void 0:q.toLowerCase())===((re=s==null?void 0:s.coin_type)==null?void 0:re.toLowerCase())?Pe():e(l),c("sellCoin")):(((De=l==null?void 0:l.coin_type)==null?void 0:De.toLowerCase())===((he=a==null?void 0:a.coin_type)==null?void 0:he.toLowerCase())?Pe():y(l),c("buyCoin"))},ce=()=>{i(""),F(""),$(""),K(""),h("1"),w("2"),j("Hour")},Pe=()=>{e(s),y(a)},Ae=d.useMemo(()=>{const l=m==null?void 0:m.whitelistMode;return console.log("ðŸš€ ~ useDcaHook ~ whitelistMode:",l),l===3?!0:l===0?!1:g==="sellCoin"?l===1:g==="buyCoin"?l===2:!1},[m==null?void 0:m.whitelistMode]),Te=((X=E[as(a==null?void 0:a.coin_type).full_address])==null?void 0:X.price)||0,V=d.useMemo(()=>D&&x?_(D).div(x).toString():0,[D,x]),Ce=d.useMemo(()=>D&&x&&Te&&_(D).div(x).mul(Te).toString()||0,[D,x,Te]),Ze=_(r==null?void 0:r.feeRate).div(ge.pow(10,6)).mul(100).toString()+"%"||"0%",le=d.useMemo(()=>{if(r!=null&&r.amountInLimitPerCycle&&(a!=null&&a.decimals))return lt(r==null?void 0:r.amountInLimitPerCycle,a==null?void 0:a.decimals)},[r==null?void 0:r.amountInLimitPerCycle]),de=d.useMemo(()=>(console.log("ðŸš€ ~ orderSizeError ~ sellPerOrder:",V,le),m!=null&&m.minCycleAmountInUsd&&x&&p&&le&&Number(V)<Number(le)?{status:!0,tips:`Each order size should be higher than $${m==null?void 0:m.minCycleAmountInUsd}.`}:p&&x&&Number(Ce)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[M,le,x,V,p,Ce,m==null?void 0:m.minCycleAmountInUsd]),Ne=d.useMemo(()=>(console.log("ðŸš€ ~ orderInputError ~ orderNum:",x,x&&Number(x)<Number(m==null?void 0:m.minCycleCount)),m!=null&&m.minCycleCount&&x&&Number(x)<Number(m==null?void 0:m.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${m==null?void 0:m.minCycleCount}.`}:x&&Number(u)<=0?{status:!0,tips:"Please enter an interval above 0"}:x&&u&&Number(u)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[x,m==null?void 0:m.minCycleCount,u]),ke=d.useMemo(()=>A&&Number(A)==0||T&&Number(T)==0?{status:!0,tips:"Please enter a price greater than 0."}:A&&T&&Number(A)>=Number(T)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[A,T]),[Je,ze]=d.useState(""),[Re,Le]=d.useState({status:!1,tips:""}),Ie=()=>{const l=new Date().getTime();let k=0;switch(console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",b),b){case"Minute":k=Number(u)*60*1e3*(Number(x)-1)+6e4;break;case"Hour":k=Number(u)*60*60*1e3*(Number(x)-1)+6e4;break;case"Day":k=Number(u)*60*60*24*1e3*(Number(x)-1)+6e4;break;case"Week":k=Number(u)*60*60*24*7*1e3*(Number(x)-1)+6e4;break;case"Month":k=Number(u)*60*60*24*30*1e3*(Number(x)-1)+6e4;break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",x,l,k,k>60*60*24*365*1e3);const q=$e(l+k,"YMDHM");console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",q),ze(q),q=="NaN-NaN-NaN NaN:NaN"&&ze("--"),k>60*60*24*365*1e3?Le({status:!0,tips:"The maximum execution period is 1 year"}):Le({status:!1,tips:"The maximum execution period is 1 year"})};d.useEffect(()=>{Ie()},[p,u,x,A,T,b]);const pe=d.useMemo(()=>{let l=0;switch(b){case"Minute":l=Number(u)*60;break;case"Hour":l=Number(u)*60*60;break;case"Day":l=Number(u)*60*60*24;break;case"Week":l=Number(u)*60*60*24*7;break;case"Month":l=Number(u)*60*60*24*30;break}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",l),l},[b,u]);d.useEffect(()=>{a!=null&&a.coin_type&&pe&&x&&Me(a==null?void 0:a.coin_type,pe,x,B==null?void 0:B.address)},[a==null?void 0:a.coin_type,pe,x,B==null?void 0:B.address]);const Se=async(l,k,q,re)=>{const De=re||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const he=await I({inCoin:l,freq:k,count:q,sender:De});return console.log("ðŸš€ ~ queryDcaQuote ~ result:",he),he}catch(he){console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",he)}},Me=Fe((l,k,q,re)=>{Se(l,k,q,re)},500),{findBestRouters:xe}=ms(),[et,We]=d.useState(!1),[te,Be]=d.useState(void 0),{getTokenRank:He}=At();d.useEffect(()=>{Ue();const l=He(a,s);console.log("ðŸš€ ~ useEffect ~ direct:",l),L(l)},[a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]),d.useEffect(()=>{be()},[V,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]);const be=()=>{_(V).gt(0)&&(a!=null&&a.coin_type)&&(s!=null&&s.coin_type)&&(We(!0),console.log("ðŸš€ ~ useDcaHook ~ sellAmountDebounce:",Number(V)>0,V,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,x),tt())},tt=Fe(()=>{st()},500),st=async()=>{if(console.log("ðŸš€ ~ findAvailableRouter ~ findAvailableRouter:",V),a&&s){const l=`${a.coin_type}_${s.coin_type}`;K(l);const k=Object.entries(xs).map(([re,De])=>De.id),q=await xe({fromToken:a,toToken:s,amount:ot(V||1,a==null?void 0:a.decimals).toFixed(0),providersKeys:k,by_amount_in:!0,uuid:l});console.log("ðŸš€ ~ findAvailableRouter ~ newUuid:",l,W,q),l===O.current&&(Be(q),n(q==null?void 0:q.toAmountUi),We(!1))}},Ue=()=>{const l=((a==null?void 0:a.coin_type)||(s==null?void 0:s.coin_type))&&Array.from(new Set([a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]));(l==null?void 0:l.length)>0&&N(l)},at=d.useMemo(()=>{console.log("ðŸš€ ~ btnStatus ~ routerData:",te);const l={text:"Create DCA Order",disabled:!1};return B!=null&&B.address?!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)?(l.disabled=!0,l.text="Select a token",l):!p||Number(p)==0?(l.disabled=!0,l.text="Enter an amount",l):_(D).gt((ee==null?void 0:ee.balanceFormat)||0)?(l.disabled=!0,l.text=`Insufficient ${a==null?void 0:a.symbol} balance`,l):_(m==null?void 0:m.minCycleCount).gt(x||0)?(l.disabled=!0,l.text=`Minimum ${m==null?void 0:m.minCycleCount} orders`,l):_(le).gt(V||0)?(l.disabled=!0,l.text=`Minimum $${m==null?void 0:m.minCycleAmountInUsd} per order`,l):de.status||Ne.status||ke.status||Re.status||!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)||!x||!u||!A||!T?(l.disabled=!0,l.text="Create DCA Order",l):(console.log("ðŸš€ ~ btnStatus ~ routerData:",te),te&&te.errorCode&&(te.errorCode===yt.NoRouter||te.errorCode===yt.HoneyPot)&&(l.text="No Available Route",l.disabled=!0),l):(l.text="Connect Wallet",l.disabled=!1,l)},[B==null?void 0:B.address,ee,de,Ne,ke,Re,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,D,u,x,A,T,(ve=te==null?void 0:te.routes)==null?void 0:ve.length]),it=d.useMemo(()=>{const l=[];return s&&l.push(s),a&&l.push(a),l},[s,a]),oe=d.useMemo(()=>H&&o&&V?R(_(o).div(V).toString(),s==null?void 0:s.decimals,!0):!H&&o&&V?R(_(V).div(o).toString(),a==null?void 0:a.decimals,!0):"",[H,V,o]),nt=Fe(l=>{F(l)},500),ct=Fe(l=>{$(l)},500),v=l=>{console.log("ðŸš€ ~ handleMinInputChange ~ val:",l),nt(l)},Y=l=>{console.log("ðŸš€ ~ handleMaxInputChange ~ val:",l),ct(l)};d.useEffect(()=>{me(A)},[A,oe]),d.useEffect(()=>{Q(T)},[T,oe]);const me=l=>{if(console.log("ðŸš€ ~ changeLowerPriceSize ~ val:",l),oe&&l){const k=_(l).div(oe).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",k),G(_(k).gt(1e4)?">10,000%":`${R(k,1,!1,ge.ROUND_HALF_DOWN)}%`)}},Q=l=>{if(oe&&l){const k=_(l).div(oe).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",k),J(_(k).gt(1e4)?">10,000%":`${R(k,1,!1,ge.ROUND_HALF_DOWN)}%`)}};return{currentPrice:oe,handleMinInputChange:v,handleMaxInputChange:Y,warningTokenList:it,resetInputAmount:ce,cycleFrequency:pe,btnStatus:at,fetchFindAvailableRouterDebounce:be,queryDcaQuote:Se,findRouterLoading:et,platformFee:Ze,estEndDate:Je,sellPerOrder:V,isDcaSelect:Ae,onReverseClick:Pe,sellBalanceInfo:ee,buyBalanceInfo:ie,sellAmountValue:ne,handleAmountChange:_e,handleSelectToken:Xe,minPriceValue:A,maxPriceValue:T,handlePageToggleDirect:Qe,orderSizeError:de,orderInputError:Ne,priceError:ke,orderTimeError:Re}}function Ns(){const{peripherySdk:a}=fe(),{getTokenInfo:s}=Ct(),{setFilterTokenLoading:e}=is(),{setInCoinWhiteList:y,setOutCoinWhiteList:p}=se();return{getDcaCoinWhiteList:async n=>{var i,m;console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:");try{e(!0);const{inCoinList:c,outCoinList:g}=await a.Dca.getDcaCoinWhiteList(n);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",g),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",c);const u=[],b=[];for(let x=0;x<c.length;x++){const r=await s(c[x]);u.push({...r,labels:((i=r==null?void 0:r.labels)==null?void 0:i.length)>0?r.labels:""})}for(let x=0;x<g.length;x++){const r=await s(g[x]);b.push({...r,labels:((m=r==null?void 0:r.labels)==null?void 0:m.length)>0?r.labels:""})}console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",b),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",u),y(u),p(b),e(!1)}catch(c){y([]),p([]),e(!1),console.log("ðŸš€ ~ file: useGetDcaTokenList.ts:35 ~ getDcaCoinWhiteList ~ error:",c)}}}}function ks(){const{peripherySdk:a}=fe(),{getDcaQuote:s}=Mt(),e=(o,n,i,m,c,g)=>{const u=_(ot(o,i)).div(n),b=_(u).div(_(c)),x=_(u).div(_(g));let r,h;if(i>m){const w=ge.pow(10,i-m);r=x.div(w).ceil().toString(),h=b.div(w).ceil().toString()}else if(i<m){const w=ge.pow(10,m-i);r=x.mul(w).ceil().toString(),h=b.mul(w).ceil().toString()}else r=x.ceil().toString(),h=b.ceil().toString();return{perCycleMinOutAmount:r,perCycleMaxOutAmount:h,cycleCountAmount:u}},y=(o,n,i,m)=>{const{in_coin:c,in_coin_amount:g,freq:u,cycle_count:b,out_coin:x}=o;return{in_coin_amount:String(ot(g,c.decimals)),in_coin_type:c.coin_type,out_coin_type:x.coin_type,cycle_frequency:u,cycle_count:b,per_cycle_min_out_amount:i,per_cycle_max_out_amount:m,per_cycle_in_amount_limit:n.amountInLimitPerCycle,fee_rate:n.feeRate,timestamp:n.timestamp,signature:n.signature}};return{openDcaOrder:async o=>{const{in_coin:n,out_coin:i,in_coin_amount:m,cycle_count:c,min_price:g,max_price:u,freq:b}=o,x=a.ClmmSDK.senderAddress||"0x0000000000000000000000000000000000000000000000000000000000000000",r=await s({inCoin:n.coin_type,freq:b,count:c,sender:x});if(!r)throw new Error("Request timed out");const{perCycleMinOutAmount:h,perCycleMaxOutAmount:w}=e(m,c,n.decimals,i.decimals,g,u),j=y(o,r,h,w);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",j);const L=await a.Dca.dcaOpenOrderPayload(j);return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",L),L}}}function Et({detailsData:a,isConfirm:s=!1}){const{sellPerOrder:e,estEndDate:y,platformFee:p,minPriceValue:o,maxPriceValue:n,minPriceResever:i,maxPriceResever:m}=a,{sellCoin:c,buyCoin:g,sellTotalAmount:u,investNum:b,currentInvest:x,pageDirect:r}=se();return console.log("ðŸš€ ~ DetailsBlock ~ investNum:",a,b),t.jsxs(z,{w:"100%",gap:s?"20px":"16px",children:[t.jsx(ue,{isLoading:!1,label:"Sell total",value:u?`${R(u,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(ue,{isLoading:!1,label:"Sell per order",value:e?`${R(e,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!s&&t.jsx(ue,{isLoading:!1,label:"Receive",value:t.jsxs(P,{gap:"4px",children:[t.jsx(ns,{imageUrl:g==null?void 0:g.logo_url,w:"20px",h:"20px",coinType:g==null?void 0:g.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),t.jsx(C,{color:"text_caption",children:g==null?void 0:g.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsx(C,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),t.jsx(Tt,{displayTokenA:g,displayTokenB:c,isRank:!0,justify:"flex-end",priceInfo:{minPrice:Ge(o).toString(),maxPrice:Ge(n).toString(),minPriceResever:Ge(i).toString(),maxPriceResever:Ge(m).toString()},fontSize:"14px",color:"text_caption"})]}),t.jsx(ue,{isLoading:!1,label:"Invest every",value:Number(b)>1?`${b} ${x}s`:`${b} ${x}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsx(ue,{isLoading:!1,label:"Start date",value:String($e(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(ue,{isLoading:!1,label:"Est. end date(UTC)",value:y,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(ue,{isLoading:!1,label:"Platform fee",value:p,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const Rs=({confirmData:a,isOpen:s,onClose:e,toOpenDca:y,toOpenDcaLoading:p})=>{const{sellCoin:o,buyCoin:n}=se();return t.jsxs(zt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:e,isCentered:!0,children:[t.jsx(Lt,{}),t.jsxs(Wt,{children:[t.jsx(Bt,{children:t.jsx(Ht,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),t.jsx(Ut,{}),t.jsx(Ft,{textAlign:"center",p:"0px",children:t.jsxs(z,{w:"100%",gap:"16px",p:"16px",children:[t.jsxs(je,{borderRadius:"12px",position:"relative",p:"0 12px",children:[t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsxs(z,{align:"flex-start",w:"calc(50% - 24px)",children:[t.jsx(C,{children:"Sell"}),t.jsx(St,{portal:!1,token:o,haveName:!1,symbolEllipsesDecimals:10})]}),t.jsx(jt,{w:"1px",h:"100px",bg:"border"}),t.jsxs(z,{align:"flex-end",w:"calc(50% - 24px)",children:[t.jsx(C,{children:"Buy"}),t.jsx(St,{portal:!1,token:n,haveName:!1,symbolEllipsesDecimals:10})]})]}),t.jsx(ut,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:t.jsx(Oe,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),t.jsx(Et,{detailsData:a,isConfirm:!0}),t.jsx(ye,{mt:"12px",onClick:()=>{y(),e()},disabled:p,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function Ms({detailsData:a}){return t.jsx(je,{children:t.jsxs(z,{gap:"20px",children:[t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsx(C,{color:"text_caption",children:"Details"}),t.jsx(C,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),t.jsx(Et,{detailsData:a})]})})}function Dt({title:a,label:s,inputValue:e,inputChange:y=()=>{},list:p=[],onListItemClick:o=()=>{}}){const n=i=>{const m=i.target.value.replace(/[^\d]/g,"");y(m)};return t.jsx(Nt,{w:"50%",borderRadius:"16px",children:t.jsxs(z,{gap:"16px",align:"flex-start",children:[typeof a=="string"?t.jsx(C,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:a}):a,t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsx(Gt,{value:e,onChange:n,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),p.length>0?t.jsx(Qt,{label:s,list:p,onListItemClick:o}):t.jsx(C,{color:"text_caption",children:s})]})]})})}function wt({direct:a,text:s,align:e,inputValue:y,inputChange:p=()=>{}}){const{sellCoin:o,buyCoin:n}=se();return t.jsx(Nt,{w:"unset",borderRadius:"8px",children:t.jsx(P,{children:t.jsxs(z,{align:e,children:[t.jsx(cs,{value:y,placeholder:"0.0",decimals:18,onChange:i=>p(i),style:{width:"calc(100% - 8px)",textAlign:e=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),t.jsxs(P,{w:"100%",justify:"space-between",children:[t.jsx(C,{fontSize:"12px",fontWeight:"500",children:a?`${n==null?void 0:n.symbol} per ${o==null?void 0:o.symbol}`:`${o==null?void 0:o.symbol} per ${n==null?void 0:n.symbol}`}),s&&t.jsx(C,{fontSize:"12px",fontWeight:"500",children:s})]})]})})})}function Es({handleGetDcaOrderList:a}){const{sellCoin:s,buyCoin:e,sellAmount:y,buyAmount:p,setInvestNum:o,setOrderNum:n,investNum:i,orderNum:m,currentInvest:c,setCurrentInvest:g,pageDirect:u,isDcaRefresh:b,dcaMode:x,setDcaMode:r,sellTotalAmount:h,upperPriceSize:w,lowerPriceSize:j,setLowerPriceSize:L,setUpperPriceSize:H}=se(),{currentPrice:M,btnStatus:D,findRouterLoading:U,sellBalanceInfo:G,buyBalanceInfo:J,sellAmountValue:B,handleAmountChange:ae,handleSelectToken:I,minPriceValue:E,maxPriceValue:N,handleMinInputChange:f,handleMaxInputChange:W,handlePageToggleDirect:K,onReverseClick:O,orderSizeError:S,orderInputError:A,orderTimeError:F,priceError:T,sellPerOrder:$,estEndDate:ee,platformFee:ie,fetchFindAvailableRouterDebounce:ne,cycleFrequency:_e,resetInputAmount:Qe,warningTokenList:Xe}=Cs();d.useEffect(()=>{b&&ne()},[b]);const{currentAccount:ce,onWalletModal:Pe}=Ke(),[Ae,Te]=d.useState("#icon-a-icon_trade"),V=["Minute","Hour","Day","Week","Month"],Ce=v=>Te(v?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:Ze}=ks(),[le,de]=d.useState(!1),{fetchCoinBalance:Ne}=xt(),{signAndExecuteTransaction:ke,transactionRejected:Je,transactionConfirmation:ze}=qe(),{failedTsToast:Re}=ls(),{showInsufficientBalanceToast:Le}=ps(),Ie=async()=>{de(!0);const v={getShowInfo:Q=>{`${R(h)}${s==null?void 0:s.symbol}${e==null?void 0:e.symbol}${m}`;const X={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return Q==="success"&&(X.modalDescriptionText="DCA Order Created",X.toastDescriptionContent="",X.toastTitleText="DCA Order Created"),X}};ze(v);const Y=u?_(1).div(N).toString():E,me=u?_(1).div(E).toString():N;try{const Q={in_coin:s,out_coin:e,in_coin_amount:h,cycle_count:m,min_price:Y,max_price:me,freq:_e};console.log("ðŸš€ ~ toOpenDca ~ params:",!u,E,N,Y,me,Q);const X=await Ze(Q);console.log("ðŸš€ ~ toOpenDca ~ tx:",X);const ve=await ke(X,v);console.log("ðŸš€ ~ toOpenDca ~ res:",ve),ve&&(Qe(),setTimeout(()=>{Ne(ce==null?void 0:ce.address,s==null?void 0:s.coin_type),a(ce==null?void 0:ce.address)},2e3)),de(!1)}catch(Q){const X={getShowInfo:ve=>{const l={};return String(Q)==="Error: Each order size should be higher than $10"&&(l.toastTitleText="Transaction Submission Error",l.toastDescriptionContent="Each order size should be higher than $10."),String(Q)==="Error: Request timed out"&&(l.toastTitleText="Request timed out",l.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(Q)==="Error: minPrice error"&&(l.toastTitleText="DCA order submission failed",l.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),l}};console.log("ðŸš€ ~ toOpenDca ~ error:",Q),console.error("Open DCA Order Error: ",Q),Le(String(Q)),Je(X),Re(X),de(!1)}},{currentCoinKey:pe,inCoinWhiteList:Se,outCoinWhiteList:Me,dcaConfig:xe}=se(),{getDcaCoinWhiteList:et}=Ns(),[We,te]=d.useState([]);d.useEffect(()=>{pe=="sellCoin"?te(Se):te(Me)},[pe,Se,Me]),d.useEffect(()=>{xe&&(xe.whitelistMode||xe.whitelistMode==0)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",xe),et(xe.whitelistMode))},[xe]);const[Be,He]=d.useState(!1),be=d.useMemo(()=>{const v=u?e==null?void 0:e.decimals:s==null?void 0:s.decimals;let Y="",me="",Q="",X="";return E&&N&&(Y=u?we(_(1).div(N).toString(),v,!0).toString():E,me=u?we(_(1).div(E).toString(),v,!0).toString():N,Q=u?E:we(_(1).div(N).toString(),v,!0).toString(),X=u?N:we(_(1).div(E).toString(),v,!0).toString()),{estEndDate:ee,sellPerOrder:$,platformFee:ie,minPriceValue:Y,maxPriceValue:me,minPriceResever:Q,maxPriceResever:X}},[u,ee,$,ie,E,N]),tt=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[st,Ue]=d.useState([0,0]),[at,it]=d.useState(0),[oe,nt]=d.useState(0),ct=v=>{console.log("ðŸš€ ~ handleSlider ~ val:",v),Ue(v),f(v[0].toString()),W(v[1].toString())};return d.useEffect(()=>{if(E&&N){const v=Number(E),Y=Number(N);Ue([v,Y]),console.log("ðŸš€ ~ useEffect ~ start:",v,Y)}E||L("0%"),N||H("0%")},[E,N]),d.useEffect(()=>{if(M){const v=_("-100").div(100).plus(1).mul(M).toNumber(),Y=_("100").div(100).plus(1).mul(M).toNumber();console.log("ðŸš€ ~ useEffect ~ min:",v,Y),it(v),nt(Y)}},[M]),t.jsxs(z,{w:"100%",children:[t.jsx(ys,{onClick:O,currentCoinKey:pe,whiteTokenList:We,from:{inputTabOptions:{type:"outlineTab",tabList:tt,currentTab:x=="total"?"Total":"Per Order",handleChangeTab:v=>{r(v==null?void 0:v.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(G==null?void 0:G.balanceFormat)||"",value:y,amountValue:B,loading:!1,onChange:ae,selectable:!0,placeholder:"0.0",token:s,whiteTokenList:Se,onTokenChange:v=>I(v,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(J==null?void 0:J.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:e,whiteTokenList:Me,onTokenChange:v=>I(v,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:Ae,svgFill:"text_caption",transform:Ae==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:Ae==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>Ce(!0),onMouseLeave:()=>Ce(!1)}}),(S==null?void 0:S.status)&&t.jsx(Ee,{tips:S==null?void 0:S.tips,bg:"primary_red_bg"}),t.jsxs(P,{w:"100%",children:[t.jsx(Dt,{title:"Invest Every",label:c,inputValue:i,list:V,onListItemClick:v=>{g(v)},inputChange:v=>{console.log("ðŸš€ ~ DcaInputBlock ~ item:",v),o(v)}}),t.jsx(Dt,{title:t.jsx(hs,{type:"over",children:t.jsx(C,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:m,inputChange:v=>{n(v),ne()}})]}),(A==null?void 0:A.status)&&t.jsx(Ee,{tips:A==null?void 0:A.tips,bg:"primary_red_bg"}),(F==null?void 0:F.status)&&t.jsx(Ee,{tips:F==null?void 0:F.tips,bg:"primary_red_bg"}),t.jsxs(je,{zIndex:"1",p:"16px",borderRadius:"16px",children:[t.jsxs(z,{align:"flex-start",children:[t.jsx(C,{color:"text_caption",children:"Set Price Range"}),t.jsx(C,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:y?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),y&&$&&t.jsxs(P,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[t.jsx(C,{children:"Current Rate"}),t.jsx(z,{align:{base:"flex-start",lg:"flex-end"},children:t.jsx(ds,{color:"text_caption",pageDirect:u,handlePageToggleDirect:K,fromToken:s,toToken:e,fromValue:$,toValue:p,isLoading:U||!p||!$})})]})]}),t.jsxs(P,{justify:"space-between",gap:"8px",mt:"20px",children:[t.jsx(wt,{direct:u,text:y&&E?j:"",inputValue:E,inputChange:v=>f(v),align:"flex-start"}),t.jsx(C,{color:"text_caption",children:"-"}),t.jsx(wt,{direct:u,text:y&&N?w:"",inputValue:N,inputChange:v=>W(v),align:"flex-start"})]}),!U&&y&&E&&N&&Number(N)>=Number(E)&&(D==null?void 0:D.text)!=="No Available Route"&&t.jsxs(z,{w:"100%",gap:"0",mt:"20px",children:[t.jsxs(Vt,{min:at,max:oe,step:.1,value:st,onChange:v=>{ct(v)},colorScheme:"teal",children:[t.jsx(qt,{children:t.jsx(Yt,{})}),t.jsx(gt,{index:0}),t.jsx(gt,{index:1})]}),t.jsx(Kt,{src:gs,w:"32px",h:"32px"}),t.jsx(P,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:t.jsx(C,{children:"Current Rate"})})]})]}),(T==null?void 0:T.status)&&t.jsx(Ee,{tips:T==null?void 0:T.tips,bg:"primary_red_bg"}),t.jsx(ye,{isLoading:le,disabled:(D==null?void 0:D.disabled)||le,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",onClick:(D==null?void 0:D.text)=="Connect Wallet"?()=>Pe(!0):()=>He(!0),children:D==null?void 0:D.text}),y&&t.jsx(Ms,{detailsData:be}),Be&&t.jsx(Rs,{confirmData:be,isOpen:Be,onClose:()=>He(!1),toOpenDca:Ie,toOpenDcaLoading:le}),(e||s)&&t.jsx(_s,{addToken:!0,tokensInfo:Xe,waringModalCancel:v=>{v.forEach(Y=>{(Y.coin_type===(e==null?void 0:e.coin_type)||Y.coin_type===(s==null?void 0:s.coin_type))&&I(void 0,Y.coin_type===(e==null?void 0:e.coin_type))})}})]})}function $s(a){const n=Math.floor(a/2592e3);a%=2592e3;const i=Math.floor(a/604800);a%=604800;const m=Math.floor(a/86400);a%=86400;const c=Math.floor(a/3600);a%=3600;const g=Math.floor(a/60);a%=60;const u=[];return n>0&&u.push(`${n} Month${n>1?"s":""}`),i>0&&u.push(`${i} Week${i>1?"s":""}`),m>0&&u.push(`${m} Day${m>1?"s":""}`),c>0&&u.push(`${c} Hour${c>1?"s":""}`),g>0&&u.push(`${g} Minute${g>1?"s":""}`),u.join(" ")}function zs(){const{getTokenInfo:a}=Ct(),{peripherySdk:s}=fe(),e=async c=>{console.log("ðŸš€ ~ getDcaOrderList ~ walletAddress:",c);try{const g=await s.Dca.getDcaOrders(c);return console.log("ðŸš€ ~ getDcaOrderList ~ list:",g),await m(g==null?void 0:g.data)}catch(g){console.log("ðŸš€ ~ getDcaOrderList ~ error:",g)}},y=async c=>{const g=await a(c),u=ge.pow(10,g==null?void 0:g.decimals);return{token:g,decimalsPow:u}},p=(c,g,u,b,x)=>{const r=_(c).div(g).div(_(b).div(u)).toString(),h=_(c).div(g).div(_(x).div(u)).toString();return{minPrice:r,maxPrice:h,minPriceResever:_(1).div(_(h)).toString(),maxPriceResever:_(1).div(_(r)).toString()}},o=c=>c.in_withdrawn>0&&c.in_withdrawn==c.in_deposited?"Close":c.in_withdrawn>0&&c.out_withdrawn>0?"PartialDeal":c.amount_left_next_cycle==0&&c.next_cycle_at==0?"AllDeal":"Active",n=(c,g,u,b,x,r,h)=>{const w=j=>j==="--"?"--":_(1).div(j).toString();switch(c){case"Close":return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"};case"PartialDeal":{const j=g.sub(u).div(r).toString(),L=g.sub(u).div(g).mul(100).toDP(2,ge.ROUND_HALF_UP).toString();return console.log("ðŸš€ ~ useGetDcaOrderList ~ inDeposited:",u,g),{currentAvgPrice:j,currentAvgPriceResever:w(j),inBalanceRatio:L,inDepositedOut:g.sub(u).toString()}}case"AllDeal":{const j=g.div(r).toString();return{currentAvgPrice:j,currentAvgPriceResever:w(j),inBalanceRatio:"100",inDepositedOut:g.sub(b).toString()}}case"Active":{const j=x.gt(0)||r.gt(0)?g.sub(b).div(x.add(r)).toString():"--",L=g.sub(b).div(g).mul(100).toDP(2,ge.ROUND_HALF_UP).toString();return{currentAvgPrice:j,currentAvgPriceResever:w(j),inBalanceRatio:L,inDepositedOut:g.sub(b).toString()}}default:return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"}}},i=(c,g,u,b)=>{const x=Date.now()/1e3,r=_(x).sub(c).div(g),h=u.lte(0)&&_(b).lte(0);return r.gt(3)&&h},m=async c=>{const g=[],u=[];for(const r of c){const{token:h,decimalsPow:w}=await y(r.in_coin_type),{token:j,decimalsPow:L}=await y(r.out_coin_type),H=_(r.in_deposited).div(w);console.log("ðŸš€ ~ buildDcaOrderList ~ order.in_deposited:",r.in_deposited,w);const M=_(r.in_deposited).div(r.in_amount_per_cycle).floor().toString(),D=_(r.in_amount_per_cycle).div(w).toString(),U=_(r.in_balance).div(w),G=_(r.in_withdrawn).div(w),J=_(r.out_balance).gt(0)?_(r.out_balance).div(L):_(0),B=_(r.out_withdrawn).div(L),ae=R(H.div(M).toString()),I=U.div(D).floor().toNumber(),{minPrice:E,maxPrice:N,minPriceResever:f,maxPriceResever:W}=p(r.in_amount_per_cycle,w,L,r.max_out_amount_per_cycle,r.min_out_amount_per_cycle),K=o(r),{currentAvgPrice:O,currentAvgPriceResever:S,inBalanceRatio:A,inDepositedOut:F}=n(K,H,G,U,J,B),T=i(r.created_at,r.cycle_frequency,J,B),$={createAt:$e(r.created_at*1e3,"YMDHM"),cycleFrequency:r.cycle_frequency,orderID:r.id,inAmountPerCycle:D,nextCycleAt:$e(r.next_cycle_at*1e3,"YMDHM"),inDeposited:H.toString(),cycleCount:M,inDepositedOut:F,inBalance:U.toString(),minPrice:R(E),maxPrice:R(N),minPriceResever:R(f),maxPriceResever:R(W),inCoin:h,outCoin:j,outBalance:J.toString(),inBalanceRatio:A,outWithdraw:B.toString(),investEvery:$s(r.cycle_frequency),eachOrderSize:ae,currentAvgPrice:O==="--"?"--":R(O,j.decimals),currentAvgPriceResever:O==="--"?"--":R(S,h.decimals),orderStatus:K,inWithdrawn:G.toString(),ofOrderLeft:I,isShowTradeTips:T,next_cycle_at:r.created_at+I*r.cycle_frequency,created_at:r.created_at,version:r.version};K==="Active"?g.push($):u.push($)}const b=g==null?void 0:g.sort((r,h)=>h.version-r.version),x=u==null?void 0:u.sort((r,h)=>h.version-r.version);return console.log("ðŸš€ ~ buildDcaOrderList ~ activeResult, pastResult:",b,x,g,u),{activeResult:b,pastResult:x}};return{getDcaOrderList:e}}function va(){const[a,s]=d.useState([]),[e,y]=d.useState([]),{currentAccount:p}=Ke(),{sellCoin:o,buyCoin:n,setIsDcaRefresh:i}=se(),[m,c]=d.useState(!0),{isShowTradeChart:g,isShowTradeOrders:u}=bs(),{getDcaOrderList:b}=zs(),{fetchAccountBalance:x}=xt(),r=async(M,D=!1)=>{if(!u)return;D&&c(!0);const{activeResult:U,pastResult:G}=await b(M);s(U),y(G),c(!1),console.log("ðŸš€ ~ handleGetDcaOrderList ~ list:",U,G)};d.useEffect(()=>{p!=null&&p.address?r(p==null?void 0:p.address,!0):(s([]),y([]))},[p==null?void 0:p.address,u]);const h=(M=!0)=>{H(0),i(!0),setTimeout(()=>{i(!1)},1e3),p!=null&&p.address&&(M||x(),r(p==null?void 0:p.address,M))};Ds({onRpcChange:()=>{h()}}),d.useEffect(()=>{p!=null&&p.address&&x()},[p==null?void 0:p.address]);const{isApp:w,windowWidth:j}=Ye(),[L,H]=d.useState(0);return vs({interval:1e3,callback:()=>{H(L+1),L>=20&&h(!1)}}),t.jsxs(P,{mt:j&&j<1024?"28px":"42px",className:w||g||u?"":"bg_img",w:"100%",gap:"16px",justify:"center",align:"flex-start",flexDirection:{base:"column",lg:"row"},children:[(u||g)&&t.jsxs(z,{w:{base:"100%",lg:"calc(100% - 470px)"},mt:w&&!g?"-16px":"0",children:[g&&t.jsx(Ss,{baseToken:o,quoteToken:n}),u&&!w&&t.jsx(vt,{handleRefresh:h,activeList:a,pastList:e,isOrderLoading:m})]}),t.jsxs(z,{w:{base:"100%",lg:"470px"},children:[t.jsxs(P,{w:"100%",justify:"space-between",mb:"8px",children:[t.jsx(Zt,{currTradeTab:Jt.DCA}),t.jsx(Xt,{})]}),t.jsx(Es,{handleGetDcaOrderList:M=>r(M)})]}),w&&u&&t.jsx(z,{w:{base:"100%",lg:"calc(100% - 470px)"},children:t.jsx(vt,{handleRefresh:h,activeList:a,pastList:e,isOrderLoading:m})})]})}export{va as default};
//# sourceMappingURL=Dca-DGbzG98Q.js.map

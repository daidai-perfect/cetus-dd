import{j as e,H as l,T as c,V as S,ap as we,a as w,W as re,X as le,Y as ce,Z as oe,a7 as xe,$ as de,a0 as pe,f as Ce,q as W,p as $,C as se}from"./vendor-BFGDaAdA.js";import{X as fe,f as L,aE as ue,w as K,aj as ie,h as q,a as I,B,I as v,F as T,r as Y,Q as Le,k as me,l as ee,aG as P,aT as k,aF as ge,Z as H,d as U,j as Oe,N as Se,e as ve,C as ae,u as He,aU as ke}from"./index-Fe2tZAmL.js";import{I as ne}from"./IconText-1ihWDE2A.js";import{u as J}from"./useTransaction-C_My4i0J.js";import{u as he}from"./useAccountBalance-Byib0voT.js";import{u as _e}from"./useToken-BKskvPZm.js";import{N as Te}from"./NoData-DtiZhmrM.js";import{S as Fe}from"./SingleTokenInfo-B9uwt8O4.js";import{u as We}from"./RangeValue-Bc8-kgED.js";const Ee=({info:t,imgSize:n="32px",isProfile:s=!1})=>{const{pay_coin:d,target_coin:p,total_pay_amount:u,expect_obtain_amount:o}=t;return e.jsxs(l,{children:[e.jsx(fe,{w:n,h:n,coinAIconUrl:d.logo_url,coinBIconUrl:p.logo_url}),e.jsxs(l,{flexWrap:"wrap",children:[e.jsxs(l,{children:[!s&&e.jsx(c,{color:"text_caption",children:L(u)}),e.jsxs(c,{color:"text_caption",children:[d.symbol," â†’ "]})]}),e.jsxs(l,{children:[!s&&e.jsx(c,{color:"text_caption",children:L(o)}),e.jsx(c,{color:"text_caption",children:p.symbol})]})]})]})},Ae=({info:t,isProfile:n=!1})=>e.jsx(l,{justifyContent:"end",gap:"2px",children:n?e.jsx(c,{color:"text_caption",children:ue(t==null?void 0:t.expire_ts)}):e.jsxs(c,{color:"text_caption",children:[K(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),Be=({info:t,isProfile:n=!1})=>{const{pay_coin:s,total_pay_amount:d,deal_amount:p,deal_rate:u}=t;return e.jsxs(S,{align:"flex-end",gap:n?"4px":"8px",children:[e.jsxs(l,{justifyContent:"end",gap:"2px",children:[e.jsx(c,{color:"text_caption",children:L(p)}),e.jsxs(l,{justifyContent:"end",gap:"2px",children:[e.jsxs(c,{color:"text_caption",children:["/",L(d)," ",s.symbol]}),e.jsxs(c,{color:"primary_gray",children:["(",ie(Number(u)*100),")"]})]})]}),n&&e.jsxs(l,{w:"100%",justify:"flex-end",gap:"2px",children:[e.jsx(c,{color:"primary_gray",fontSize:"12px",children:ie(Number(u)*100)}),e.jsx(we,{h:"4px",w:"40px",value:Number(u)*100,bg:"primary_opacity.10",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})},Ke=({historyInfo:t,type:n,...s})=>{const{getExplorerUrl:d}=q(),p=w.useMemo(()=>(t==null?void 0:t.events)||[],[t]),{isApp:u}=I();return e.jsx(B,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...s,children:e.jsx(S,{align:"flex-start",children:p.map(o=>{const{tokenInfo:g,text:j,icon:b,color:a,num:m}=je(o,t);return e.jsxs(S,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(l,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(l,{gap:n=="card"?"4px":"8px",flexDirection:n=="card"?"column":"row",align:n=="card"?"flex-start":"center",children:[e.jsxs(l,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(v,{svgW:"14px",xlinkHref:b,svgFill:a,svgHover:a}),e.jsx(c,{color:a,children:j})]}),!u&&e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]})]}),e.jsxs(l,{gap:n=="card"?"4px":"20px",flexDirection:n=="card"&&!u?"column":"row",align:n=="card"?"flex-end":"center",children:[e.jsxs(c,{h:"20px",lineHeight:"20px",children:[K(Number(o.block_time),"")," (UTC)"]}),e.jsxs(l,{gap:"4px",cursor:"pointer",onClick:i=>{T(i),window.open(d(o.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!u&&e.jsx(c,{color:"text_caption",children:"View Transaction"}),e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),u&&e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]})]},o==null?void 0:o.tx)})})})},je=(t,n)=>{const{pay_coin:s,target_coin:d}=n,p=t==null?void 0:t.event_type;return p.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:s,num:`+${L(Y(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`}:p.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:d,num:`+${L(Y(t==null?void 0:t.amount,d==null?void 0:d.decimals))}`}:p.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${L(Y(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`,tokenInfo:s}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},Me=({info:t,isProfile:n=!1})=>{const[s,d]=w.useState(!0),{getTokenRank:p}=We();w.useEffect(()=>{const a=p(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",a),d(a)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:u,target_coin:o,price:g,reseverPrice:j}=t,b=n?"12px":"14px";return e.jsxs(S,{flexDirection:n?"column":"row",justify:"flex-end",align:n?"flex-end":"center",gap:n?"0px":"8px",children:[n&&(s?e.jsx(c,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(g)}):e.jsx(c,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(j)})),e.jsxs(l,{justifyContent:"end",children:[s?e.jsxs(l,{flexWrap:"wrap",justify:"flex-end",children:[!n&&e.jsx(c,{color:"text_caption",lineHeight:"1",children:L(g)}),e.jsxs(c,{fontSize:b,color:n?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[o.symbol," per ",u.symbol]})]}):e.jsxs(l,{flexWrap:"wrap",justify:"flex-end",children:[!n&&e.jsx(c,{color:"text_caption",children:L(j)}),e.jsxs(c,{fontSize:b,color:n?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[u.symbol," per ",o.symbol]})]}),e.jsx(v,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:a=>{T(a),d(!s)}})]})]})},Ie=({historyInfo:t,openExpendItemObj:n,isProfile:s=!1})=>e.jsxs(l,{justifyContent:"end",gap:"4px",children:[!s&&((t==null?void 0:t.status)=="Cancelled"?e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(v,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"})),e.jsx(c,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),!s&&e.jsx(v,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:n[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),De=(t,n)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:s=>{t(()=>({orderListLoading:s}))},historyOrderList:[],setHistoryOrderList:s=>{t(()=>({historyOrderList:s}))},setMyOrderList:s=>{t(()=>({myOrderList:s}))}}),Re=Le(De);function ze({isOpen:t,onClose:n,historyInfo:s}){const{isApp:d}=I(),p=w.useMemo(()=>(s==null?void 0:s.events)||[],[s]),{getExplorerUrl:u}=q();return e.jsxs(re,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(le,{}),e.jsxs(ce,{minWidth:d?"300px":"420px",children:[e.jsx(oe,{children:e.jsx(xe,{h:"44px",lineHeight:"24px",fontWeight:"500",fontSize:"16px",borderBottom:"1px solid",borderColor:"border",pb:"0px",children:"Trade Details"})}),e.jsx(de,{}),e.jsx(pe,{p:"0px 16px ",textAlign:"center",children:e.jsx(l,{h:"100%",gap:"12px",mt:"8px",children:e.jsx(S,{align:"flex-start",w:"100%",gap:"32px",ml:"4px",p:"0 0 16px 16px",borderLeft:"1px dashed",borderColor:"border",children:p.map(o=>{const{tokenInfo:g,text:j,icon:b,color:a,num:m}=je(o,s);return e.jsxs(S,{align:"flex-start",w:"100%",mt:"-8px",children:[e.jsxs(l,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(c,{h:"20px",lineHeight:"20px",children:[ue(o.block_time)," (UTC)"]}),e.jsx(c,{color:a,children:j}),e.jsx(l,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-23px",top:"4px",borderRadius:"50%",children:e.jsx(Ce,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(B,{p:"16px",borderRadius:"12px",children:e.jsxs(l,{w:"100%",gap:"4px",justify:"space-between",children:[e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]}),e.jsx(v,{svgW:"24px",svgH:"24px",minW:"24px",xlinkHref:"#icon-icon_link1",onClick:i=>{T(i),window.open(u(o.tx,"tx"))}})]})})]},o==null?void 0:o.tx)})})})})]})]})}function ye(){const{currentAccount:t,addressChangeVersion:n}=me(),s=ee("limit"),{setOrderListLoading:d,setMyOrderList:p,myOrderList:u,orderListLoading:o}=Re(),{getTokenListInfo:g}=_e(),j=async(a=t==null?void 0:t.address,m)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",a);try{if(!a){d(!1),p([]);return}m&&d(!0);const i=await s.LimitOrder.getOwnerLimitOrderList(a,"all"),r=await b(i.data.filter(x=>x.status===P.PartialCompleted||x.status===P.Running));p(r),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",r)}catch(i){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",i)}finally{d(!1)}},b=async a=>{const m=[],i=[];for(const x of a)i.push(x.pay_coin_type),i.push(x.target_coin_type);const r=await g(i);for(const x of a){const[h,C]=[r==null?void 0:r.get(x.pay_coin_type),r==null?void 0:r.get(x.target_coin_type)];if(h&&C){const{total_pay_amount:f,pay_balance:_,rate:O,obtained_amount:y,claimed_amount:M,target_balance:E,created_ts:D,expire_ts:X,status:Z,id:R}=x,F=k(f,h.decimals).toString(),A=k(_,h.decimals).toString(),G=k(y,C.decimals).toString(),z=k(M,C.decimals).toString(),V=k(E,C.decimals).toString(),N=ge.rateToPrice(O.toString(),h.decimals,C.decimals),Q=H(1).div(N).toString(),te=k(H(f).sub(_).toFixed(0),h.decimals).toString(),be={order_id:R,pay_coin:h,target_coin:C,price:N,reseverPrice:Q,total_pay_amount:F,expect_obtain_amount:H(F).mul(N).toString(),remaining_amount:A,deal_amount:te,deal_rate:H(te).div(F).toString(),obtained_amount:G,claimed_amount:z,un_claimed_amount:H(V).sub(z).toString(),created_ts:D,expire_ts:X,status:Z};m.push(be)}}return m.sort((x,h)=>h.created_ts-x.created_ts)};return{fetchMyLimitOrder:j,formatLimitOrderList:b,orderListLoading:o,myOrderList:u}}function Ne(){const{fetchAccountBalance:t}=he(),{fetchMyLimitOrder:n}=ye(),{signAndExecuteTransaction:s}=J(),d=ee("limit"),[p,u]=w.useState(!1),{transactionConfirmation:o}=J();return{handleCancelOrder:async j=>{u(!0);const b={getShowInfo:r=>{const x="Canceling order",h={modalDescriptionText:x,toastTitleText:x};return r==="success"&&(h.toastDescriptionContent="Order cancelled successfully",h.modalDescriptionText="Order cancelled successfully",h.toastTitleText="Order cancelled"),h}};o(b);const a=j.map(r=>({pay_coin_type:r.pay_coin.coin_type,target_coin_type:r.target_coin.coin_type,order_id:r.order_id})),m=await d.LimitOrder.cancelOrdersByOwner(a),i=await s(m,b);u(!1),i&&setTimeout(()=>{t(),n()},2e3)},cancelOrderLoading:p}}function Ue(){const{fetchAccountBalance:t}=he(),{fetchMyLimitOrder:n}=ye(),{signAndExecuteTransaction:s}=J(),d=ee("limit"),[p,u]=w.useState(!1),[o,g]=w.useState(!1);return{handleClaimOrder:async(a,m)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",a),u(!0);const i={pay_coin_type:a.pay_coin.coin_type,target_coin_type:a.target_coin.coin_type,order_id:a.order_id},r=await d.LimitOrder.claimTargetCoin(i),x=await s(r,{getShowInfo:(h,C)=>{var O;const f=`Claim ${L(m)} ${(O=a==null?void 0:a.target_coin)==null?void 0:O.symbol}`,_={modalDescriptionText:f,toastTitleText:f};return h==="success"&&(_.toastDescriptionContent="",_.modalDescriptionText="",_.toastTitleText="Claim successfully"),_}});u(!1),x&&setTimeout(()=>{t(),n()},2e3)},getLimitOrderClaimHistory:async a=>{console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ order:",a),g(!0);const m=await d.LimitOrder.getLimitOrderClaimLogs(a.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",a,m),m?(g(!1),m.map(i=>{var x;const r=U(i.parsed_json.claimed_amount).div(Math.pow(10,(x=a.target_coin)==null?void 0:x.decimals));return{...i,...i.parsed_json,claimed_amount:r}})):[]},isClaimHistoryLoading:o,claimLoading:p}}const Ge=({orderInfo:t,isOpen:n,onClose:s,handleClaim:d,claimLoading:p,getLimitOrderClaimHistory:u,isClaimHistoryLoading:o})=>{const{getExplorerUrl:g}=q(),[j,b]=w.useState(""),[a,m]=w.useState([]),[i,r]=w.useState({label:"Claim",value:"claim"}),x=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],h=y=>{r(y),(y==null?void 0:y.value)=="history"&&C()},C=async()=>{const y=await u();y&&m(y)},f=w.useMemo(()=>!j||p?{disabled:!0,text:"Claim"}:U(j).gt(t.un_claimed_amount)||U(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[j,t.un_claimed_amount]),[_,O]=w.useState(!0);return w.useEffect(()=>{_&&(O(!1),b(t.un_claimed_amount))},[_,t.un_claimed_amount]),console.log("claimModal###history###",history),e.jsxs(re,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:s,isCentered:!0,children:[e.jsx(le,{}),e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(de,{}),e.jsx(pe,{textAlign:"center",p:"0px",children:e.jsxs(S,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(B,{borderRadius:"8px",p:"8px",children:e.jsx(c,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(Ee,{info:t,imgSize:"28px"}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Price"}),e.jsx(Me,{info:t})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Filled Size"}),e.jsx(Be,{info:t})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Expiry"}),e.jsx(Ae,{info:t})]}),e.jsx(Oe,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:x,currentTab:i.label,handleChangeTab:h}),(i==null?void 0:i.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(S,{gap:"16px",align:"flex-start",children:[e.jsx(c,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(Se,{value:j?L(j).toString():"",onChange:y=>{b(y)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(l,{children:e.jsx(Fe,{token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(W,{onClick:()=>{d(j),s()},disabled:f.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:f.text})]}),(i==null?void 0:i.value)=="history"&&e.jsx(S,{w:"100%",gap:"12px",children:o?e.jsxs(B,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(l,{justify:"space-between",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]}),e.jsxs(l,{justify:"space-between",mt:"16px",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]})]}):(a==null?void 0:a.length)==0?e.jsx(Te,{type:"nodata",text:"No History.",p:"20px"}):a==null?void 0:a.map(y=>{var M,E;return e.jsx(B,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(S,{gap:"16px",align:"flex-start",children:[e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Amount"}),e.jsxs(l,{gap:"4px",children:[e.jsx(ve,{imageUrl:(M=t==null?void 0:t.target_coin)==null?void 0:M.logo_url,w:"20px",h:"20px"}),e.jsxs(c,{color:"text_caption",lineHeight:"18px",children:[L(y==null?void 0:y.claimed_amount)," ",(E=t==null?void 0:t.target_coin)==null?void 0:E.symbol]})]})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Time"}),e.jsxs(l,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:D=>{T(D),window.open(g(y.digest,"tx"))},children:[e.jsxs(c,{color:"text_caption",children:[K(Number(y==null?void 0:y.timestampMs),"")," (UTC)"]}),e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},y.digest)})})]})})]})]})},et=({orderInfo:t,isProfile:n=!1,isOpenOrder:s=!0})=>{const{handleCancelOrder:d,cancelOrderLoading:p}=Ne(),{handleClaimOrder:u,claimLoading:o,getLimitOrderClaimHistory:g,isClaimHistoryLoading:j}=Ue(),[b,a]=w.useState(),[m,i]=w.useState(!1),[r,x]=w.useState(!1),h=(_,O)=>{a(_),O==="cancel"&&d([_]),O==="claim"&&i(!0)},{isApp:C}=I(),{getExplorerUrl:f}=q();return e.jsxs(l,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:{base:"space-between",lg:"flex-end"},gap:"8px",children:[s&&e.jsxs(l,{justify:"flex-end",children:[U(t==null?void 0:t.obtained_amount).lte(0)&&U(t.un_claimed_amount).lte(0)?e.jsx(ae,{placement:"top",tooltip:e.jsx(c,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."}),children:e.jsx(se,{w:{base:"calc(50vw - 28px)",lg:"unset"},children:e.jsx(W,{disabled:!0,p:"0 8px",h:"28px",borderRadius:"8px",fontSize:"12px",children:"Claim"})})}):e.jsx(W,{isLoading:o,disabled:o,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:_=>{T(_),o||h(t,"claim")},children:"Claim"}),n&&e.jsx(ae,{placement:"bottom-end",tooltip:e.jsxs(S,{align:"flex-start",children:[e.jsx(ne,{text:"View on Explorer",onClick:()=>{window.open(f(t.order_id,"poolAddress"))}}),e.jsx(ne,{text:"Cancel",onClick:()=>{p||h(t,"cancel")}})]}),children:e.jsx(se,{children:e.jsx(W,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(v,{svgFill:C?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!n&&s&&e.jsx(W,{isLoading:p,disabled:p,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",variant:"outline",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:_=>{T(_),p||h(t,"cancel")},children:"Cancel"}),n&&!s&&e.jsxs(l,{children:[e.jsx(W,{h:"32px",variant:"outline",fontSize:"12px",p:"0 8px",borderRadius:"8px",fontWeight:"500",onClick:_=>{T(_),x(!0)},children:"Details"}),e.jsx(W,{onClick:_=>{T(_),window.open(f(t.order_id,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),m&&e.jsx(Ge,{orderInfo:t,claimLoading:o,isOpen:m,onClose:()=>i(!1),handleClaim:_=>u(t,_),getLimitOrderClaimHistory:()=>g(t),isClaimHistoryLoading:j}),r&&e.jsx(ze,{isOpen:r,onClose:()=>x(!1),historyInfo:t})]})};function tt(){const{fetchByApi:t}=He(),{getTokenListInfo:n}=_e(),{currentAccount:s}=me(),[d,p]=w.useState(!0),[u,o]=w.useState([]);w.useEffect(()=>{o([])},[s==null?void 0:s.address]);const g=async(b,a)=>{var m;try{a&&p(!0);const i=await t(ke,"GET",{wallet_address:b});if(console.log(i,"getLimitOrderHistory"),i!=null&&i.list&&((m=i==null?void 0:i.list)==null?void 0:m.length)>0){const r=await j((i==null?void 0:i.list)||[]);return o(r),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",r),r}return[]}catch(i){return console.log("getLimitOrderHistory ~ error:",i),[]}finally{p(!1)}},j=async b=>{const a=[],m=[];for(const r of b)m.push(r.pay_coin),m.push(r.target_coin);const i=await n(m);for(const r of b){const[x,h]=[i==null?void 0:i.get(r.pay_coin),i==null?void 0:i.get(r.target_coin)];if(x&&h){const{total_pay_amount:C,remaining_amount:f,rate:_,obtained_amount:O,claimed_amount:y,target_balance:M,created_ts:E,expire_ts:D,cancel_reason:X,events:Z}=r,R=Z;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",r,R),R.sort((N,Q)=>Q.block_time-N.block_time);const F=k(C,x.decimals).toString(),A=ge.rateToPrice(_.toString(),x.decimals,h.decimals),G=H(1).div(A).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",A,G);const z=k(H(C).sub(f).toFixed(0),x.decimals).toString(),V={order_id:r.order_id,pay_coin:x,target_coin:h,price:A,reseverPrice:G,total_pay_amount:F,remaining_amount:f,deal_amount:z,deal_rate:H(z).div(F).toString(),expect_obtain_amount:H(F).mul(A).toString(),obtained_amount:O,claimed_amount:y,un_claimed_amount:"0",created_ts:E,expire_ts:D,status:Number(X)===0?P.Completed:P.Cancelled,events:R};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",V),a.push(V)}}return a.sort((r,x)=>x.created_ts=r.created_ts),a};return{getLimitOrderHistory:g,historyOrderLoading:d,historyOrderList:u}}export{Ee as C,Ae as E,Be as F,Ke as L,et as O,Me as P,Ie as S,ye as a,tt as b,Ne as c,Re as u};
//# sourceMappingURL=useGetLimitOrderHistory-CZVdvvPx.js.map

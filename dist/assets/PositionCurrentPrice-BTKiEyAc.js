import{a4 as A,aC as U,d as S,aH as w,R as j,r as D,j as i,H as b,S as R,T as P,as as C,I as H,c as v}from"./index-D49RffYW.js";import{u as E}from"./useBurn-BlABJCgq.js";import{M as I}from"./msafe-oYBkW7LJ.js";import{c as B}from"./usePositionList-CyCzZNts.js";function K(){const{getTokenAmountValue:_}=A(),f=(l,a,c)=>{if(!(l!=null&&l.length))return{total:"0",rewardAndFeeList:[]};let e="0";const o=[];l.forEach(s=>{const m=a[s==null?void 0:s.posId],x=c[s==null?void 0:s.posId]||[];if(m){const t=d(s==null?void 0:s.displayTokenA,m==null?void 0:m.displayFeeOwedA),n=d(s==null?void 0:s.displayTokenB,m==null?void 0:m.displayFeeOwedB);t&&o.push(t),n&&o.push(n),e=p(e,t==null?void 0:t.amountUSD,n==null?void 0:n.amountUSD)}x.forEach(t=>{if(Number(t==null?void 0:t.display_amount_owed)>0){const n=d(t==null?void 0:t.token,t==null?void 0:t.display_amount_owed,t==null?void 0:t.coin_address);n&&(o.push(n),e=p(e,n==null?void 0:n.amountUSD))}})});const u=h(o);return{total:(u==null?void 0:u.length)>0&&Number(e)==0?"--":e,rewardAndFeeList:u}},d=(l,a,c)=>{if(!l||!a)return null;const e=c||l.coin_type,o=_(e,a);return{coin_address:U(e,!1),amount:a,amountUSD:S(a).gt(0)&&S(o).lte(0)?"--":o,token:l}},p=(l,...a)=>{let c=S(l);return a.forEach(e=>{e&&e!=="--"&&c!=="--"&&(c=c.plus(e))}),c.toString()},h=l=>{const a={};return l.forEach(c=>{var s,m;const{coin_address:e,amount:o,amountUSD:u}=c;a[e]||(a[e]={...c,amount:"0",amountUSD:"0"}),u=="--"?a[e].amountUSD="--":a[e].amountUSD=a[e].amountUSD=="--"?"--":S((s=a[e])==null?void 0:s.amountUSD).plus(u||0).toString(),a[e].amount=S((m=a[e])==null?void 0:m.amount).plus(o||0).toString()}),Object.values(a).filter(c=>Number(c.amount)>0).sort((c,e)=>S(e.amountUSD=="--"?0:e.amountUSD).minus(c.amountUSD=="--"?0:c.amountUSD).toNumber())};return{calculatePendingYield:f}}const T=_=>_.startsWith("0x")?_.slice(2):_;function Y(){const{clmmSdk:_}=w(),{peripherySdk:f,burnSdk:d}=j(),{getBurnClaimTxPayload:p}=E();return{getPosClaimFeeAndRewardTxPayload:async a=>{const{posType:c,id:e,clmmPool:o,coinTypeA:u,coinTypeB:s,rewarderCoinTypes:m,account:x}=a;let t,n;if(c==="clmm"){const r={pool_id:o,pos_id:e,rewarder_coin_types:m,coinTypeA:u,coinTypeB:s,collect_fee:!0};t=await _.Rewarder.collectRewarderTransactionPayload(r),n={action:I.ClaimFeeAndMining,txbParams:r}}else if(c==="farms"){const r={coinTypeA:u,coinTypeB:s,clmm_pool_id:o,position_nft_id:e,clmm_rewarder_types:m,collect_fee:!0};t=await f.Farms.claimFeeAndClmmReward(r),n={action:"FarmingClaimFeeAndReward",txbParams:r}}else c==="burn"&&(t=p({poolAddress:o,posId:e,coinTypeA:u,coinTypeB:s,account:x,rewarderCoinTypes:m}));return{tx:t,msafeParams:n}},getBatchHarvestFeeAndRewardsTxPayload:async(a,c,e)=>{const o=[],u=[],s=[];a.forEach(r=>{var g;const y=((g=c[r.posId])==null?void 0:g.map(F=>F.coin_address))||[];r.posType=="clmm"?o.push({pool_id:r.clmmPool,pos_id:r.id,collect_fee:!0,rewarder_coin_types:y,coinTypeA:T(r.coinTypeA),coinTypeB:T(r.coinTypeB)}):r.posType=="farms"?u.push({pool_id:r.farmsPool,position_nft_id:r.id,clmm_pool_id:r.clmmPool,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:y,coinTypeA:r.coinTypeA,coinTypeB:r.coinTypeB}):s.push({pos:r==null?void 0:r.id,pool:r.clmmPool,coinTypeA:r.coinTypeA,coinTypeB:r.coinTypeB,rewarderCoinTypes:y,account:e})});const m=await f.Farms.batchHarvestAndClmmFeePayload(u,o),x=[];for(let r=0;r<s.length;r++){const y=s[r];(y==null?void 0:y.rewarderCoinTypes.length)>0&&x.push(y)}const t=d.Burn.createCollectFeesPaylaod(s,m),n=d.Burn.crateCollectRewardsPayload(x,t);return{txb:t,tx:n}}}}function V({posId:_,displayTokenA:f,displayTokenB:d,symbolEllipsesDecimals:p=10}){const[h,l]=D.useState(!0),{posPoolsRelatedData:a}=B(),c=a[_];return i.jsxs(b,{children:[i.jsx(R,{isLoaded:!!(c!=null&&c.currentPrice),children:i.jsx(P,{color:"text_caption",children:h?c==null?void 0:c.currentPrice:c==null?void 0:c.currentPriceReverse})}),i.jsxs(b,{gap:"0",children:[i.jsx(P,{color:"primary_gray",children:C(h?d==null?void 0:d.symbol:f==null?void 0:f.symbol,p)}),i.jsx(P,{color:"primary_gray",children:" per "}),i.jsx(P,{color:"primary_gray",children:C(h?f==null?void 0:f.symbol:d==null?void 0:d.symbol,p)})]}),i.jsx(H,{xlinkHref:"#icon-icon_swap1",w:"16px",h:"16px",onClick:e=>{v(e),l(!h)}})]})}export{V as P,K as a,Y as u};

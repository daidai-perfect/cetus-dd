import{a as c,j as e,V as C,H as k,T as E,v as pe,C as bt,S as rt,u as st,X as kt,Y as Tt,Z as Pt,$ as Ot,a8 as Nt,a0 as At,a1 as Ct,f as Mt,O as Rt,am as Et,an as zt,ao as It,ap as it,I as Wt}from"./vendor-DXHkIl66.js";import{M as Lt,C as Bt}from"./MenuDropBlock-DAfpGPDY.js";import{T as $t,a as Ht}from"./TradeTab-BynUSQJA.js";import{u as Ft,D as Vt,a as Ut,R as Gt,O as qt,b as Yt,c as U,d as Kt}from"./OverviewOrders-BMTSFfpu.js";import{a as ot,e as Qt,I as Be,j as $e,d as D,i as Xt,B as we,u as yt,k as at,D as Zt,l as Jt,m as es,n as ts,o as ss,p as je,q as ns,r as ze,t as nt,v as re,w as lt,x as St,y as de,z as Ie,A as os,c as as,C as We,N as rs,E as is}from"./index-COrObqhs.js";import{P as ls}from"./Pagination-D8saQRTc.js";import{N as ct}from"./NoData-CqJO7NcS.js";import{R as ut}from"./RefreshButton-DMtB0j6U.js";import{u as Dt,R as cs}from"./RangeValue-C-T8hOod.js";import{u as us}from"./useInsufficientBalanceToast-_0v0Ptve.js";import{u as ds}from"./useTransaction-19_gbWik.js";import{A as ps}from"./aggregator-Ce3ogcL7.js";import{A as dt}from"./useSwapHelper-BEAhr1pE.js";import{u as pt}from"./useTokenBalance-DKaSilR5.js";import{u as ms}from"./useFindBestRouting-B2G_AVeI.js";import{u as xs}from"./useToken-tdeKOG5n.js";import{i as fs}from"./icon_currentprice@2x-DeObnx8l.js";import{C as gs}from"./CurrentPrice-CYj3IVOr.js";import{E as Le}from"./ErrorTips-Cvdl__4Z.js";import{u as jt}from"./useAccountBalance-JIpp1bm5.js";import{T as hs}from"./TooltipIcon-QGHwK_uy.js";import{T as bs}from"./TradeInputGroup-F01zgmGz.js";import{W as ys}from"./WarningTokenTipModal-CB16i9Zp.js";import{S as mt}from"./SingleTokenInfo-Cu4rhuHx.js";import{H as ae}from"./HTextLabelBox-BHTpNjoy.js";import{I as wt}from"./InputBox-Dlz8xsDZ.js";import{LimitPriceChart as Ss}from"./LimitPriceChart-DC-DaEp9.js";import{u as Ds}from"./global-DhYiu20h.js";import{u as js}from"./activeOrders-DYIROuuV.js";import{u as ws}from"./useInterval-Cb1zlf7x.js";import{u as vs}from"./useRpcListener-DGAb7YGU.js";import"./IconBg-Cm6ZhWpr.js";import"./useTrack-pnnm1Ell.js";import"./useSigner-C6u4-fR7.js";import"./useGetPoolList-B9bUsMZ5.js";import"./useWrapPoolData-fdYmV8CX.js";import"./_getAllKeysIn-BvQOU9sJ.js";import"./CheckBox-rv3qIDs9.js";import"./CopyButton-0PPlBtQz.js";import"./usePreviousValue-BBpD8e7r.js";function _s({currentTabVal:t,orderInfo:s}){const{isApp:l}=ot(),{inCoin:f,outCoin:m}=s,[o,d]=c.useState(!1);c.useEffect(()=>{d(!1)},[t]);const{getTokenRank:a}=Dt(),[r,p]=c.useState(!1);c.useEffect(()=>{const h=a(f,m);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",m,f,h),p(!h)},[f==null?void 0:f.coin_type,m==null?void 0:m.coin_type]);const{closeOrderAction:b,isCloseLoading:u}=Ft(),y=async()=>{b(s)},{getExplorerUrl:i}=Qt();return e.jsxs(C,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsxs(k,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[e.jsxs(k,{children:[e.jsx(Vt,{orderInfo:s}),e.jsx(Be,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(i(s==null?void 0:s.orderID,"poolAddress"))}})]}),!l&&e.jsx(xt,{currentTabVal:t,isCloseLoading:u,closeOrder:y,orderInfo:s,isDetail:o,onClickDetail:()=>d(!o)})]}),e.jsx(Ut,{orderInfo:s}),e.jsxs(k,{w:"100%",children:[e.jsx(E,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),e.jsx(Gt,{orderInfo:s,isRank:!0})]}),l&&e.jsx(xt,{currentTabVal:t,isCloseLoading:u,closeOrder:y,orderInfo:s,isDetail:o,onClickDetail:()=>d(!o)}),o&&e.jsx(qt,{pageDirect:r,isDetail:o,currentTabVal:t,orderInfo:s})]})}const xt=({currentTabVal:t,isCloseLoading:s,closeOrder:l,orderInfo:f,isDetail:m,onClickDetail:o})=>e.jsxs(k,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[t=="active"&&e.jsx(pe,{w:{base:"100%",lg:"unset"},isLoading:s,disabled:s,onClick:l,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(f==null?void 0:f.outBalance)<=0?"Close":"Close and Withdraw"}),e.jsx(pe,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:e.jsx(Be,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:m?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:o,children:"Details"})]});function ft({handleRefresh:t,activeList:s,pastList:l,isOrderLoading:f}){const[o,d]=c.useState([]),[a,r]=c.useState([]),[p,b]=c.useState(0),[u,y]=c.useState(1),{currentAccount:i,onWalletModal:h}=$e(),[g,O]=c.useState({label:"Active DCAs",value:"active"}),v=c.useMemo(()=>[{label:"Active DCAs",value:"active",num:(s==null?void 0:s.length)>0?s==null?void 0:s.length:void 0},{label:"Past DCAs",value:"past",num:(l==null?void 0:l.length)>0?l==null?void 0:l.length:void 0}],[g==null?void 0:g.value,s,l]),j=S=>{y(1),O(S)};c.useEffect(()=>{const S=(g==null?void 0:g.value)==="active"?s:l;d(S),b(S==null?void 0:S.length)},[g==null?void 0:g.value,s,l]),c.useEffect(()=>{const S=(u-1)*10,H=S+10;r(o==null?void 0:o.slice(S,H))},[u,o,g==null?void 0:g.value]);const z=c.useMemo(()=>(g==null?void 0:g.value)==="past"||(o==null?void 0:o.length)===0?0:o==null?void 0:o.reduce((S,H)=>D(S).plus(H==null?void 0:H.outBalance),D(0)).toString(),[g==null?void 0:g.value,o]),{closeAll:B,claimAll:_,isClaimAllLoading:G,isCloseAllLoading:q}=Yt(),{isApp:Y}=ot();return e.jsxs(C,{w:"100%",children:[e.jsxs(k,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(k,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[e.jsx(Xt,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:v,currentTab:g.label,handleChangeTab:j}),Y&&e.jsx(ut,{handleRefresh:t,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),e.jsxs(k,{w:{base:"100%",lg:"unset"},children:[g.value==="active"&&(o==null?void 0:o.length)>0&&(i==null?void 0:i.address)&&e.jsx(pe,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:G,disabled:Number(z)===0||G,onClick:()=>_(o),leftIcon:e.jsx(Be,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),g.value==="active"&&(o==null?void 0:o.length)>0&&(i==null?void 0:i.address)&&e.jsx(pe,{w:{base:"50%",lg:"unset"},isLoading:q,disabled:(o==null?void 0:o.length)==0||q,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:()=>B(o),children:"Close All"}),!Y&&e.jsx(ut,{handleRefresh:t,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),i!=null&&i.address?f?e.jsx(we,{children:e.jsx(C,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((S,H)=>e.jsx(ks,{},H))})}):(o==null?void 0:o.length)===0?e.jsx(ct,{type:"nodata",text:(g==null?void 0:g.value)==="active"?"No active orders":"No closed orders"}):e.jsxs(we,{h:(a==null?void 0:a.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[e.jsx(C,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:a==null?void 0:a.map(S=>e.jsx(_s,{currentTabVal:g.value,orderInfo:S},S==null?void 0:S.orderID))}),!f&&(o==null?void 0:o.length)>10&&e.jsx(bt,{mt:"28px",children:e.jsx(ls,{total:p,size:10,currentPage:u,onChange:y})})]}):e.jsx(ct,{type:"nowallet",onboard:()=>h(!0)})]})}const ks=()=>e.jsxs(C,{w:"100%",gap:"16px",align:"flex-start",children:[e.jsxs(k,{w:"100%",gap:"0",justify:"space-between",children:[e.jsxs(k,{gap:"0",children:[e.jsxs(k,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(rt,{size:"8"}),e.jsx(rt,{size:"8"})]}),e.jsx(st,{height:"4",width:"100px"})]}),e.jsx(st,{height:"4",width:"150px"})]}),e.jsx(st,{height:"4",width:"180px"})]});function Ts(){const{fetchByApi:t}=yt(),{peripherySdk:s}=at(),{setDcaConfig:l}=U(),f=async()=>await t(Zt,"GET")||null,m=async()=>await s.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const d={};try{const a=await f();a&&(d.minCycleAmountInUsd=a==null?void 0:a.min_amount_in_usd)}catch(a){console.log("ðŸš€ ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",a)}try{const a=await m();d.minCycleCount=a==null?void 0:a.min_cycle_count,d.minCycleFrequency=a==null?void 0:a.min_cycle_frequency,d.whitelistMode=a==null?void 0:a.whitelist_mode}catch(a){console.log("ðŸš€ ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",a)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",d),l(d),d}}}function vt(){const{fetchByApi:t}=yt(),{setDcaQuote:s}=U();return{getDcaQuote:async({inCoin:f,freq:m,count:o,sender:d})=>{try{const a=await t(Jt,"GET",{in_coin:f,freq:m,count:o,sender:d});if(a){const r={amountInLimitPerCycle:a==null?void 0:a.amount_in_limit_per_cycle,coinType:a==null?void 0:a.coin_type,feeRate:a==null?void 0:a.fee_rate,signature:a==null?void 0:a.signature,signer:a==null?void 0:a.signer,timestamp:a==null?void 0:a.timestamp};return s(r),r}}catch(a){console.log("getDcaQuote ~ error:",a)}return null}}}function Ps(){var W,ce;const{sellCoin:t,buyCoin:s,setSellCoin:l,setBuyCoin:f,sellAmount:m,buyAmount:o,setBuyAmount:d,setSellAmount:a,dcaConfig:r,setCurrentCoinKey:p,currentCoinKey:b,investNum:u,currentInvest:y,orderNum:i,dcaQuote:h,setInvestNum:g,setOrderNum:O,setCurrentInvest:v,setPageDirect:j,pageDirect:z,dcaMode:B,sellTotalAmount:_,setSellTotalAmount:G,setLowerPriceSize:q,setUpperPriceSize:Y}=U(),{currentAccount:S}=$e(),{getDcaConfig:H}=Ts(),{getDcaQuote:me}=vt(),{coinPriceObj:N}=es(),{fetchTokenPrices:A,getTokenAmountValue:ve}=ts(),[ne,_e]=c.useState(""),ke=c.useRef(ne);c.useEffect(()=>{ke.current=ne},[ne]);const Z=()=>{console.log("ðŸš€ ~ initiaTokenSelect ~ setSellCoin:"),l(lt.clmm_swap.from_coin),f(lt.clmm_swap.to_coin)};c.useEffect(()=>(q("0%"),Y("0%"),Z(),H(),()=>{K()}),[]);const[T,F]=c.useState(""),[P,V]=c.useState(""),{balanceInfo:J}=pt(t),{balanceInfo:Te}=pt(s),Pe=ve(t==null?void 0:t.coin_type,m),He=n=>{p("sellCoin"),a(n),le()};c.useEffect(()=>{+m&&+i?B=="total"?G(m):G(D(m).mul(i).toString()):G("")},[m,B,i]);const Fe=()=>{const n=z?t==null?void 0:t.decimals:s==null?void 0:s.decimals;if(j(!z),T&&P){const w=T,L=D(1).div(P).toString(),ue=D(1).div(w).toString();F(de(L,n,!0).toString()),V(de(ue,n,!0).toString())}},Ve=(n,w=!0)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useDcaHook.ts:143 ~ handleSelectToken ~ handleSelectToken:"),F(""),V(""),w?(Ie(n==null?void 0:n.coin_type)===Ie(s==null?void 0:s.coin_type)?xe():l(n),p("sellCoin")):(Ie(n==null?void 0:n.coin_type)===Ie(t==null?void 0:t.coin_type)?xe():f(n),p("buyCoin"))},K=()=>{a(""),F(""),V(""),_e(""),g("1"),O("2"),v("Hour")},xe=()=>{l(s),f(t)},fe=c.useMemo(()=>{const n=r==null?void 0:r.whitelistMode;return console.log("ðŸš€ ~ useDcaHook ~ whitelistMode:",n),n===3?!0:n===0?!1:b==="sellCoin"?n===1:b==="buyCoin"?n===2:!1},[r==null?void 0:r.whitelistMode]),ge=((W=N[ss(t==null?void 0:t.coin_type).full_address])==null?void 0:W.price)||0,M=c.useMemo(()=>_&&i?D(_).div(i).toString():0,[_,i]),he=c.useMemo(()=>_&&i&&ge&&D(_).div(i).mul(ge).toString()||0,[_,i,ge]),Ue=D(h==null?void 0:h.feeRate).div(je.pow(10,6)).mul(100).toString()+"%"||"0%",Q=c.useMemo(()=>{if(h!=null&&h.amountInLimitPerCycle&&(t!=null&&t.decimals))return ns(h==null?void 0:h.amountInLimitPerCycle,t==null?void 0:t.decimals)},[h==null?void 0:h.amountInLimitPerCycle]),oe=c.useMemo(()=>(console.log("ðŸš€ ~ orderSizeError ~ sellPerOrder:",M,Q),r!=null&&r.minCycleAmountInUsd&&i&&m&&Q&&Number(M)<Number(Q)?{status:!0,tips:`Each order size should be higher than $${r==null?void 0:r.minCycleAmountInUsd}.`}:m&&i&&Number(he)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[B,Q,i,M,m,he,r==null?void 0:r.minCycleAmountInUsd]),be=c.useMemo(()=>(console.log("ðŸš€ ~ orderInputError ~ orderNum:",i,i&&Number(i)<Number(r==null?void 0:r.minCycleCount)),r!=null&&r.minCycleCount&&i&&Number(i)<Number(r==null?void 0:r.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${r==null?void 0:r.minCycleCount}.`}:i&&Number(u)<=0?{status:!0,tips:"Please enter an interval above 0"}:i&&u&&Number(u)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[i,r==null?void 0:r.minCycleCount,u]),ye=c.useMemo(()=>T&&Number(T)==0||P&&Number(P)==0?{status:!0,tips:"Please enter a price greater than 0."}:T&&P&&Number(T)>=Number(P)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[T,P]),[Ge,Oe]=c.useState(""),[Se,Ne]=c.useState({status:!1,tips:""}),qe=()=>{const n=new Date().getTime();let w=0;switch(console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",y),y){case"Minute":w=Number(u)*60*1e3*(Number(i)-1)+6e4;break;case"Hour":w=Number(u)*60*60*1e3*(Number(i)-1)+6e4;break;case"Day":w=Number(u)*60*60*24*1e3*(Number(i)-1)+6e4;break;case"Week":w=Number(u)*60*60*24*7*1e3*(Number(i)-1)+6e4;break;case"Month":w=Number(u)*60*60*24*30*1e3*(Number(i)-1)+6e4;break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",i,n,w,w>60*60*24*365*1e3);const L=St(n+w,"YMDHM");console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",L),Oe(L),L=="NaN-NaN-NaN NaN:NaN"&&Oe("--"),w>60*60*24*365*1e3?Ne({status:!0,tips:"The maximum execution period is 1 year"}):Ne({status:!1,tips:"The maximum execution period is 1 year"})};c.useEffect(()=>{qe()},[m,u,i,T,P,y]);const ee=c.useMemo(()=>{let n=0;switch(y){case"Minute":n=Number(u)*60;break;case"Hour":n=Number(u)*60*60;break;case"Day":n=Number(u)*60*60*24;break;case"Week":n=Number(u)*60*60*24*7;break;case"Month":n=Number(u)*60*60*24*30;break}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",n),n},[y,u]);c.useEffect(()=>{t!=null&&t.coin_type&&ee&&i&&De(t==null?void 0:t.coin_type,ee,i,S==null?void 0:S.address)},[t==null?void 0:t.coin_type,ee,i,S==null?void 0:S.address]);const ie=async(n,w,L,ue)=>{const tt=ue||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const Ee=await me({inCoin:n,freq:w,count:L,sender:tt});return console.log("ðŸš€ ~ queryDcaQuote ~ result:",Ee),Ee}catch(Ee){console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",Ee)}},De=ze((n,w,L,ue)=>{ie(n,w,L,ue)},500),{findBestRouters:te}=ms(),[Ye,Ae]=c.useState(!1),[$,Ce]=c.useState(void 0),{getTokenRank:Me}=Dt();c.useEffect(()=>{Re();const n=Me(t,s);console.log("ðŸš€ ~ useEffect ~ direct:",n),j(n)},[t==null?void 0:t.coin_type,s==null?void 0:s.coin_type]),c.useEffect(()=>{le()},[M,t==null?void 0:t.coin_type,s==null?void 0:s.coin_type]);const le=()=>{D(M).gt(0)&&(t!=null&&t.coin_type)&&(s!=null&&s.coin_type)&&(Ae(!0),console.log("ðŸš€ ~ useDcaHook ~ sellAmountDebounce:",Number(M)>0,M,t==null?void 0:t.coin_type,s==null?void 0:s.coin_type,i),Ke())},Ke=ze(()=>{Qe()},500),Qe=async()=>{if(console.log("ðŸš€ ~ findAvailableRouter ~ findAvailableRouter:",M),t&&s){const n=`${t.coin_type}_${s.coin_type}`;_e(n);const w=Object.entries(ps).map(([ue,tt])=>tt.id),L=await te({fromToken:t,toToken:s,amount:nt(M||1,t==null?void 0:t.decimals).toFixed(0),providersKeys:w,by_amount_in:!0,uuid:n});console.log("ðŸš€ ~ findAvailableRouter ~ newUuid:",n,ne,L),n===ke.current&&(Ce(L),d(L==null?void 0:L.toAmountUi),Ae(!1))}},Re=()=>{const n=((t==null?void 0:t.coin_type)||(s==null?void 0:s.coin_type))&&Array.from(new Set([t==null?void 0:t.coin_type,s==null?void 0:s.coin_type]));(n==null?void 0:n.length)>0&&A(n)},Xe=c.useMemo(()=>{console.log("ðŸš€ ~ btnStatus ~ routerData:",$);const n={text:"Create DCA Order",disabled:!1};return S!=null&&S.address?!(t!=null&&t.coin_type)||!(s!=null&&s.coin_type)?(n.disabled=!0,n.text="Select a token",n):!m||Number(m)==0?(n.disabled=!0,n.text="Enter an amount",n):D(_).gt((J==null?void 0:J.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${t==null?void 0:t.symbol} balance`,n):D(r==null?void 0:r.minCycleCount).gt(i||0)?(n.disabled=!0,n.text=`Minimum ${r==null?void 0:r.minCycleCount} orders`,n):D(Q).gt(M||0)?(n.disabled=!0,n.text=`Minimum $${r==null?void 0:r.minCycleAmountInUsd} per order`,n):oe.status||be.status||ye.status||Se.status||!(t!=null&&t.coin_type)||!(s!=null&&s.coin_type)||!i||!u||!T||!P?(n.disabled=!0,n.text="Create DCA Order",n):(console.log("ðŸš€ ~ btnStatus ~ routerData:",$),$&&$.errorCode&&($.errorCode===dt.NoRouter||$.errorCode===dt.HoneyPot)&&(n.text="No Available Route",n.disabled=!0),n):(n.text="Connect Wallet",n.disabled=!1,n)},[S==null?void 0:S.address,J,oe,be,ye,Se,t==null?void 0:t.coin_type,s==null?void 0:s.coin_type,_,u,i,T,P,(ce=$==null?void 0:$.routes)==null?void 0:ce.length]),Ze=c.useMemo(()=>{const n=[];return s&&n.push(s),t&&n.push(t),n},[s,t]),X=c.useMemo(()=>z&&o&&M?re(D(o).div(M).toString(),s==null?void 0:s.decimals,!0):!z&&o&&M?re(D(M).div(o).toString(),t==null?void 0:t.decimals,!0):"",[z,M,o]),Je=ze(n=>{F(n)},500),et=ze(n=>{V(n)},500),x=n=>{console.log("ðŸš€ ~ handleMinInputChange ~ val:",n),Je(n)},R=n=>{console.log("ðŸš€ ~ handleMaxInputChange ~ val:",n),et(n)};c.useEffect(()=>{se(T)},[T,X]),c.useEffect(()=>{I(P)},[P,X]);const se=n=>{if(console.log("ðŸš€ ~ changeLowerPriceSize ~ val:",n),X&&n){const w=D(n).div(X).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",w),q(D(w).gt(1e4)?">10,000%":`${re(w,1,!1,je.ROUND_HALF_DOWN)}%`)}},I=n=>{if(X&&n){const w=D(n).div(X).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",w),Y(D(w).gt(1e4)?">10,000%":`${re(w,1,!1,je.ROUND_HALF_DOWN)}%`)}};return{currentPrice:X,handleMinInputChange:x,handleMaxInputChange:R,warningTokenList:Ze,resetInputAmount:K,cycleFrequency:ee,btnStatus:Xe,fetchFindAvailableRouterDebounce:le,queryDcaQuote:ie,findRouterLoading:Ye,platformFee:Ue,estEndDate:Ge,sellPerOrder:M,isDcaSelect:fe,onReverseClick:xe,sellBalanceInfo:J,buyBalanceInfo:Te,sellAmountValue:Pe,handleAmountChange:He,handleSelectToken:Ve,minPriceValue:T,maxPriceValue:P,handlePageToggleDirect:Fe,orderSizeError:oe,orderInputError:be,priceError:ye,orderTimeError:Se}}function Os(){const{peripherySdk:t}=at(),{getTokenListInfo:s}=xs(),{setFilterTokenLoading:l}=os(),{setInCoinWhiteList:f,setOutCoinWhiteList:m}=U();return{getDcaCoinWhiteList:async d=>{var a,r;console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:");try{l(!0);const{inCoinList:p,outCoinList:b}=await t.Dca.getDcaCoinWhiteList(d);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",b),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",p);const u=[],y=[],i=p.map(v=>v),h=await s(i);if(h)for(let v=0;v<p.length;v++){const j=h.get(p[v]);u.push({...j,labels:((a=j==null?void 0:j.labels)==null?void 0:a.length)>0?j==null?void 0:j.labels:""})}const g=b.map(v=>v),O=await s(g);if(O)for(let v=0;v<b.length;v++){const j=O.get(b[v]);y.push({...j,labels:((r=j==null?void 0:j.labels)==null?void 0:r.length)>0?j==null?void 0:j.labels:""})}console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",y),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",u),f(u),m(y),l(!1)}catch(p){f([]),m([]),l(!1),console.log("ðŸš€ ~ file: useGetDcaTokenList.ts:35 ~ getDcaCoinWhiteList ~ error:",p)}}}}function Ns(){const{peripherySdk:t}=at(),{getDcaQuote:s}=vt(),l=(o,d,a,r,p,b)=>{const u=D(nt(o,a)).div(d),y=D(u).div(D(p)),i=D(u).div(D(b));let h,g;if(a>r){const O=je.pow(10,a-r);h=i.div(O).ceil().toString(),g=y.div(O).ceil().toString()}else if(a<r){const O=je.pow(10,r-a);h=i.mul(O).ceil().toString(),g=y.mul(O).ceil().toString()}else h=i.ceil().toString(),g=y.ceil().toString();return{perCycleMinOutAmount:h,perCycleMaxOutAmount:g,cycleCountAmount:u}},f=(o,d,a,r)=>{const{in_coin:p,in_coin_amount:b,freq:u,cycle_count:y,out_coin:i}=o;return{in_coin_amount:String(nt(b,p.decimals)),in_coin_type:p.coin_type,out_coin_type:i.coin_type,cycle_frequency:u,cycle_count:y,per_cycle_min_out_amount:a,per_cycle_max_out_amount:r,per_cycle_in_amount_limit:d.amountInLimitPerCycle,fee_rate:d.feeRate,timestamp:d.timestamp,signature:d.signature}};return{openDcaOrder:async o=>{const{in_coin:d,out_coin:a,in_coin_amount:r,cycle_count:p,min_price:b,max_price:u,freq:y}=o,i=t.ClmmSDK.senderAddress||"0x0000000000000000000000000000000000000000000000000000000000000000",h=await s({inCoin:d.coin_type,freq:y,count:p,sender:i});if(!h)throw new Error("Request timed out");const{perCycleMinOutAmount:g,perCycleMaxOutAmount:O}=l(r,p,d.decimals,a.decimals,b,u),v=f(o,h,g,O);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",v);const j=await t.Dca.dcaOpenOrderPayload(v);return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",j),j}}}function _t({detailsData:t,isConfirm:s=!1}){const{sellPerOrder:l,estEndDate:f,platformFee:m,minPriceValue:o,maxPriceValue:d,minPriceResever:a,maxPriceResever:r}=t,{sellCoin:p,buyCoin:b,sellTotalAmount:u,investNum:y,currentInvest:i,pageDirect:h}=U();return console.log("ðŸš€ ~ DetailsBlock ~ investNum:",t,y),e.jsxs(C,{w:"100%",gap:s?"20px":"16px",children:[e.jsx(ae,{isLoading:!1,label:"Sell total",value:u?`${re(u,p==null?void 0:p.decimals)} ${p==null?void 0:p.symbol}`:`-- ${p==null?void 0:p.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),e.jsx(ae,{isLoading:!1,label:"Sell per order",value:l?`${re(l,p==null?void 0:p.decimals)} ${p==null?void 0:p.symbol}`:`-- ${p==null?void 0:p.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!s&&e.jsx(ae,{isLoading:!1,label:"Receive",value:e.jsxs(k,{gap:"4px",children:[e.jsx(as,{imageUrl:b==null?void 0:b.logo_url,w:"20px",h:"20px",coinType:b==null?void 0:b.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),e.jsx(E,{color:"text_caption",children:b==null?void 0:b.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(E,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),e.jsx(cs,{displayTokenA:b,displayTokenB:p,isRank:!0,justify:"flex-end",priceInfo:{minPrice:We(o).toString(),maxPrice:We(d).toString(),minPriceResever:We(a).toString(),maxPriceResever:We(r).toString()},fontSize:"14px",color:"text_caption"})]}),e.jsx(ae,{isLoading:!1,label:"Invest every",value:Number(y)>1?`${y} ${i}s`:`${y} ${i}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&e.jsx(ae,{isLoading:!1,label:"Start date",value:String(St(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),e.jsx(ae,{isLoading:!1,label:"Est. end date(UTC)",value:f,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),e.jsx(ae,{isLoading:!1,label:"Platform fee",value:m,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const As=({confirmData:t,isOpen:s,onClose:l,toOpenDca:f,toOpenDcaLoading:m})=>{const{sellCoin:o,buyCoin:d}=U();return e.jsxs(kt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:l,isCentered:!0,children:[e.jsx(Tt,{}),e.jsxs(Pt,{children:[e.jsx(Ot,{children:e.jsx(Nt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(At,{}),e.jsx(Ct,{textAlign:"center",p:"0px",children:e.jsxs(C,{w:"100%",gap:"16px",p:"16px",children:[e.jsxs(we,{borderRadius:"12px",position:"relative",p:"0 12px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsxs(C,{align:"flex-start",w:"calc(50% - 24px)",children:[e.jsx(E,{children:"Sell"}),e.jsx(mt,{token:o,haveName:!1,symbolEllipsesDecimals:10})]}),e.jsx(Mt,{w:"1px",h:"100px",bg:"border"}),e.jsxs(C,{align:"flex-end",w:"calc(50% - 24px)",children:[e.jsx(E,{children:"Buy"}),e.jsx(mt,{token:d,haveName:!1,symbolEllipsesDecimals:10})]})]}),e.jsx(bt,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:e.jsx(Be,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),e.jsx(_t,{detailsData:t,isConfirm:!0}),e.jsx(pe,{mt:"12px",onClick:()=>{f(),l()},disabled:m,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function Cs({detailsData:t}){return e.jsx(we,{children:e.jsxs(C,{gap:"20px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(E,{color:"text_caption",children:"Details"}),e.jsx(E,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),e.jsx(_t,{detailsData:t})]})})}function gt({title:t,label:s,inputValue:l,inputChange:f=()=>{},list:m=[],onListItemClick:o=()=>{}}){const d=a=>{const r=a.target.value.replace(/[^\d]/g,"");f(r)};return e.jsx(wt,{w:"50%",borderRadius:"16px",children:e.jsxs(C,{gap:"16px",align:"flex-start",children:[typeof t=="string"?e.jsx(E,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:t}):t,e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(Rt,{value:l,onChange:d,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),m.length>0?e.jsx(Lt,{label:s,list:m,onListItemClick:o}):e.jsx(E,{color:"text_caption",children:s})]})]})})}function ht({direct:t,text:s,align:l,inputValue:f,inputChange:m=()=>{}}){const{sellCoin:o,buyCoin:d}=U();return e.jsx(wt,{w:"unset",borderRadius:"8px",children:e.jsx(k,{children:e.jsxs(C,{align:l,children:[e.jsx(rs,{value:f,placeholder:"0.0",decimals:18,onChange:a=>m(a),style:{width:"calc(100% - 8px)",textAlign:l=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(E,{fontSize:"12px",fontWeight:"500",children:t?`${d==null?void 0:d.symbol} per ${o==null?void 0:o.symbol}`:`${o==null?void 0:o.symbol} per ${d==null?void 0:d.symbol}`}),s&&e.jsx(E,{fontSize:"12px",fontWeight:"500",children:s})]})]})})})}function Ms({handleGetDcaOrderList:t}){const{sellCoin:s,buyCoin:l,sellAmount:f,buyAmount:m,setInvestNum:o,setOrderNum:d,investNum:a,orderNum:r,currentInvest:p,setCurrentInvest:b,pageDirect:u,isDcaRefresh:y,dcaMode:i,setDcaMode:h,sellTotalAmount:g,upperPriceSize:O,lowerPriceSize:v,setLowerPriceSize:j,setUpperPriceSize:z}=U(),{currentPrice:B,btnStatus:_,findRouterLoading:G,sellBalanceInfo:q,buyBalanceInfo:Y,sellAmountValue:S,handleAmountChange:H,handleSelectToken:me,minPriceValue:N,maxPriceValue:A,handleMinInputChange:ve,handleMaxInputChange:ne,handlePageToggleDirect:_e,onReverseClick:ke,orderSizeError:Z,orderInputError:T,orderTimeError:F,priceError:P,sellPerOrder:V,estEndDate:J,platformFee:Te,fetchFindAvailableRouterDebounce:Pe,cycleFrequency:He,resetInputAmount:Fe,warningTokenList:Ve}=Ps();c.useEffect(()=>{y&&Pe()},[y]);const{currentAccount:K,onWalletModal:xe}=$e(),[fe,ge]=c.useState("#icon-a-icon_trade"),M=["Minute","Hour","Day","Week","Month"],he=x=>ge(x?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:Ue}=Ns(),[Q,oe]=c.useState(!1),{fetchCoinBalance:be}=jt(),{signAndExecuteTransaction:ye,transactionRejected:Ge,transactionConfirmation:Oe}=ds(),{failedTsToast:Se}=is(),{showInsufficientBalanceToast:Ne}=us(),qe=async()=>{oe(!0);const x={getShowInfo:I=>{`${re(g)}${s==null?void 0:s.symbol}${l==null?void 0:l.symbol}${r}`;const W={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return I==="success"&&(W.modalDescriptionText="DCA Order Created",W.toastDescriptionContent="",W.toastTitleText="DCA Order Created"),W}};Oe(x);const R=u?D(1).div(A).toString():N,se=u?D(1).div(N).toString():A;try{const I={in_coin:s,out_coin:l,in_coin_amount:g,cycle_count:r,min_price:R,max_price:se,freq:He};console.log("ðŸš€ ~ toOpenDca ~ params:",!u,N,A,R,se,I);const W=await Ue(I);console.log("ðŸš€ ~ toOpenDca ~ tx:",W);const ce=await ye(W,x);console.log("ðŸš€ ~ toOpenDca ~ res:",ce),ce&&(Fe(),setTimeout(()=>{be(K==null?void 0:K.address,s==null?void 0:s.coin_type),t(K==null?void 0:K.address)},2e3)),oe(!1)}catch(I){const W={getShowInfo:ce=>{const n={};return String(I)==="Error: Each order size should be higher than $10"&&(n.toastTitleText="Transaction Submission Error",n.toastDescriptionContent="Each order size should be higher than $10."),String(I)==="Error: Request timed out"&&(n.toastTitleText="Request timed out",n.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(I)==="Error: minPrice error"&&(n.toastTitleText="DCA order submission failed",n.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),n}};console.log("ðŸš€ ~ toOpenDca ~ error:",I),console.error("Open DCA Order Error: ",I),Ne(String(I)),Ge(W),Se(W),oe(!1)}},{currentCoinKey:ee,inCoinWhiteList:ie,outCoinWhiteList:De,dcaConfig:te}=U(),{getDcaCoinWhiteList:Ye}=Os(),[Ae,$]=c.useState([]);c.useEffect(()=>{ee=="sellCoin"?$(ie):$(De)},[ee,ie,De]),c.useEffect(()=>{te&&(te.whitelistMode||te.whitelistMode==0)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",te),Ye(te.whitelistMode))},[te]);const[Ce,Me]=c.useState(!1),le=c.useMemo(()=>{const x=u?l==null?void 0:l.decimals:s==null?void 0:s.decimals;let R="",se="",I="",W="";return N&&A&&(R=u?de(D(1).div(A).toString(),x,!0).toString():N,se=u?de(D(1).div(N).toString(),x,!0).toString():A,I=u?N:de(D(1).div(A).toString(),x,!0).toString(),W=u?A:de(D(1).div(N).toString(),x,!0).toString()),{estEndDate:J,sellPerOrder:V,platformFee:Te,minPriceValue:R,maxPriceValue:se,minPriceResever:I,maxPriceResever:W}},[u,J,V,Te,N,A]),Ke=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[Qe,Re]=c.useState([0,0]),[Xe,Ze]=c.useState(0),[X,Je]=c.useState(0),et=x=>{console.log("ðŸš€ ~ handleSlider ~ val:",x),Re(x),ve(x[0].toString()),ne(x[1].toString())};return c.useEffect(()=>{if(N&&A){const x=Number(N),R=Number(A);Re([x,R]),console.log("ðŸš€ ~ useEffect ~ start:",x,R)}N||j("0%"),A||z("0%")},[N,A]),c.useEffect(()=>{if(B){const x=D("-100").div(100).plus(1).mul(B).toNumber(),R=D("100").div(100).plus(1).mul(B).toNumber();console.log("ðŸš€ ~ useEffect ~ min:",x,R),Ze(x),Je(R)}},[B]),e.jsxs(C,{w:"100%",children:[e.jsx(bs,{onClick:ke,currentCoinKey:ee,whiteTokenList:Ae,from:{inputTabOptions:{type:"outlineTab",tabList:Ke,currentTab:i=="total"?"Total":"Per Order",handleChangeTab:x=>{h(x==null?void 0:x.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(q==null?void 0:q.balanceFormat)||"",value:f,amountValue:S,loading:!1,onChange:H,selectable:!0,placeholder:"0.0",token:s,whiteTokenList:ie,onTokenChange:x=>me(x,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(Y==null?void 0:Y.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:l,whiteTokenList:De,onTokenChange:x=>me(x,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:fe,svgFill:"text_caption",transform:fe==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:fe==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>he(!0),onMouseLeave:()=>he(!1)}}),(Z==null?void 0:Z.status)&&e.jsx(Le,{tips:Z==null?void 0:Z.tips,bg:"primary_red_bg"}),e.jsxs(k,{w:"100%",children:[e.jsx(gt,{title:"Invest Every",label:p,inputValue:a,list:M,onListItemClick:x=>{b(x)},inputChange:x=>{console.log("ðŸš€ ~ DcaInputBlock ~ item:",x),o(x)}}),e.jsx(gt,{title:e.jsx(hs,{type:"over",children:e.jsx(E,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:r,inputChange:x=>{d(x),Pe()}})]}),(T==null?void 0:T.status)&&e.jsx(Le,{tips:T==null?void 0:T.tips,bg:"primary_red_bg"}),(F==null?void 0:F.status)&&e.jsx(Le,{tips:F==null?void 0:F.tips,bg:"primary_red_bg"}),e.jsxs(we,{zIndex:"1",p:"16px",borderRadius:"16px",children:[e.jsxs(C,{align:"flex-start",children:[e.jsx(E,{color:"text_caption",children:"Set Price Range"}),e.jsx(E,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:f?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),f&&V&&e.jsxs(k,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[e.jsx(E,{children:"Current Rate"}),e.jsx(C,{align:{base:"flex-start",lg:"flex-end"},children:e.jsx(gs,{color:"text_caption",pageDirect:u,handlePageToggleDirect:_e,fromToken:s,toToken:l,fromValue:V,toValue:m,isLoading:G||!m||!V})})]})]}),e.jsxs(k,{justify:"space-between",gap:"8px",mt:"20px",children:[e.jsx(ht,{direct:u,text:f&&N?v:"",inputValue:N,inputChange:x=>ve(x),align:"flex-start"}),e.jsx(E,{color:"text_caption",children:"-"}),e.jsx(ht,{direct:u,text:f&&A?O:"",inputValue:A,inputChange:x=>ne(x),align:"flex-start"})]}),!G&&f&&N&&A&&Number(A)>=Number(N)&&(_==null?void 0:_.text)!=="No Available Route"&&e.jsxs(C,{w:"100%",gap:"0",mt:"20px",children:[e.jsxs(Et,{min:Xe,max:X,step:.1,value:Qe,onChange:x=>{et(x)},colorScheme:"teal",children:[e.jsx(zt,{children:e.jsx(It,{})}),e.jsx(it,{index:0}),e.jsx(it,{index:1})]}),e.jsx(Wt,{src:fs,w:"32px",h:"32px"}),e.jsx(k,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:e.jsx(E,{children:"Current Rate"})})]})]}),(P==null?void 0:P.status)&&e.jsx(Le,{tips:P==null?void 0:P.tips,bg:"primary_red_bg"}),e.jsx(pe,{isLoading:Q,disabled:(_==null?void 0:_.disabled)||Q,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",onClick:(_==null?void 0:_.text)=="Connect Wallet"?()=>xe(!0):()=>Me(!0),children:_==null?void 0:_.text}),f&&e.jsx(Cs,{detailsData:le}),Ce&&e.jsx(As,{confirmData:le,isOpen:Ce,onClose:()=>Me(!1),toOpenDca:qe,toOpenDcaLoading:Q}),(l||s)&&e.jsx(ys,{addToken:!0,tokensInfo:Ve,waringModalCancel:x=>{x.forEach(R=>{(R.coin_type===(l==null?void 0:l.coin_type)||R.coin_type===(s==null?void 0:s.coin_type))&&me(void 0,R.coin_type===(l==null?void 0:l.coin_type))})}})]})}function Dn(){const{currentAccount:t}=$e(),{sellCoin:s,buyCoin:l,setIsDcaRefresh:f}=U(),{isShowTradeChart:m,isShowTradeOrders:o}=Ds(),{getDcaOrderList:d}=Kt(),{fetchAccountBalance:a}=jt(),{dcaOrderListLoading:r,dcaActiveOrderList:p,dcaPastOrderList:b,setDcaActiveOrderList:u,setDcaPastOrderList:y}=js(),i=async(z,B=!1)=>{o&&d(z,B)};c.useEffect(()=>{t!=null&&t.address?i(t==null?void 0:t.address,!0):(u([]),y([]))},[t==null?void 0:t.address,o]);const h=(z=!0)=>{j(0),f(!0),setTimeout(()=>{f(!1)},1e3),t!=null&&t.address&&(z||a(),i(t==null?void 0:t.address,z))};vs({onRpcChange:()=>{h()}}),c.useEffect(()=>{t!=null&&t.address&&a()},[t==null?void 0:t.address]);const{isApp:g,windowWidth:O}=ot(),[v,j]=c.useState(0);return ws({interval:1e3,callback:()=>{j(v+1),v>=20&&h(!1)}}),e.jsxs(k,{mt:O&&O<1024?"28px":"42px",className:g||m||o?"":"bg_img",w:"100%",gap:"16px",justify:"center",align:"flex-start",flexDirection:{base:"column",lg:"row"},children:[(o||m)&&e.jsxs(C,{w:{base:"100%",lg:"calc(100% - 470px)"},mt:g&&!m?"-16px":"0",children:[m&&e.jsx(Ss,{baseToken:s,quoteToken:l}),o&&!g&&e.jsx(ft,{handleRefresh:h,activeList:p,pastList:b,isOrderLoading:r})]}),e.jsxs(C,{w:{base:"100%",lg:"470px"},children:[e.jsxs(k,{w:"100%",justify:"space-between",mb:"8px",children:[e.jsx($t,{currTradeTab:Ht.DCA}),e.jsx(Bt,{})]}),e.jsx(Ms,{handleGetDcaOrderList:z=>i(z)})]}),g&&o&&e.jsx(C,{w:{base:"100%",lg:"calc(100% - 470px)"},children:e.jsx(ft,{handleRefresh:h,activeList:p,pastList:b,isOrderLoading:r})})]})}export{Dn as default};
//# sourceMappingURL=Dca-BZRsemGv.js.map

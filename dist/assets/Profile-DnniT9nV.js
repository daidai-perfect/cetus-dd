import{a as p,D as Ke,j as e,V as E,F as Ye,aa as Oe,H as v,T as x,C as Z,u as Q,f as W,v as X,X as Ie,Y as Qe,Z as Ze,$ as Je,a0 as et,a1 as tt,ab as Ae,I as st,N as mt,O as bt,Q as wt,ar as Me,ag as Pe}from"./vendor-DXHkIl66.js";import{u as nt}from"./global-Cy6BFixe.js";import{u as K}from"./activeOrders-CytUVoPq.js";import{j as U,F as re,I as M,O as le,i as je,e as ot,q as Xe,d as B,aU as fe,B as q,v as G,c as Re,a as V,G as Ct,z as ee,R as it,n as ce,M as te,p as yt,X as _t,f as at,w as $,m as He,as as J,aV as St,ar as rt,am as Tt,k as me,aW as vt,aX as $e,Q as he,V as lt,aR as kt,al as Lt,aI as Se,a0 as Pt,aY as We,aZ as Ve}from"./index-BWU-xuMx.js";import{N as se}from"./NoData-CqJO7NcS.js";import{A as ct,R as Rt}from"./RecentTransactions-mXJKOrew.js";import{u as dt,D as pt,g as Dt,e as Ot,f as At,W as Ht,b as Et,R as zt,a as Ft,d as Bt}from"./OverviewOrders-DajngGPb.js";import{I as Te}from"./IconText-BEGD1VZt.js";import{u as Ut}from"./RangeValue-CG9Va_fu.js";import{H as I}from"./HTextLabelBox-B52zKGK1.js";import{H as Ee,T as be}from"./Table-UdNVpX61.js";import{P as we}from"./Pagination-5uFb3XfX.js";import{b as Mt,u as de,c as Xt,C as $t,P as Wt,F as Vt,E as Nt,S as Gt,O as qt,a as Kt}from"./useGetLimitOrderHistory-CYKS53pl.js";import{u as Yt}from"./useRpcListener-DbPuy7G_.js";import{R as It}from"./RefreshButton-CViusFGq.js";import{a as oe,d as Qt,u as ut,e as Zt,f as Jt,g as es,c as ts,b as ss}from"./usePositionList-DceGZ6LP.js";import{P as ns,a as os,b as is,u as as}from"./PoolItem-D_P7HYJG.js";import{P as rs,u as ls}from"./PositionListLoading-BxZytAFw.js";import{u as cs}from"./useAccountBalance-Dc1tjRHC.js";import{u as xt}from"./useToken-Dv9jqb7X.js";import{f as ze,X as ds,a as ps,b as us,u as xs,c as gs,E as hs,C as fs,e as js,d as ms,g as bs}from"./useXCetus-DMsTo9z2.js";import{S as ws}from"./SingleTokenInfo-BZRxSqIy.js";import{S as Cs}from"./SortDropBlock-CijPMqPu.js";import{T as ve}from"./TableSortTh-DF-xwO9R.js";import{u as ys}from"./useTokenBalance-BeC9TbB5.js";import{X as _s,a as Ss,b as Ts,c as vs,u as ks}from"./useXCetusHelper-8sKVbcRU.js";import"./CopyButton-BGxQLghs.js";import"./useTransaction--hseLEnq.js";import"./useTrack-DqdqmYnF.js";import"./useSigner-Bl0Jc_0o.js";import"./ErrorTips-oth4F3Re.js";import"./usePreviousValue-BBpD8e7r.js";import"./useFavoritePool-CFMYb2zc.js";import"./useGetPoolList-Dii1Q-HM.js";import"./useWrapPoolData-CnKYhKQf.js";import"./CheckBox-DUe7IsOw.js";import"./SearchInputBlock-oeQw2R0u.js";import"./index-DzhMFUno.js";import"./Loading-BH2b7hW0.js";import"./TooltipIcon-D2ojWQaW.js";import"./PositionCurrentPrice-boduDsig.js";import"./useBurn-CgzubnbY.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-BgKWlnoq.js";import"./PoweredByHaedal-990R--7x.js";import"./PriceRange-awCX93ZC.js";import"./PositionStatus-DNdglHlb.js";import"./detail-C7llP71h.js";import"./TradeInputGroup-C2q2Eh5E.js";import"./_getAllKeysIn-B4R85e1T.js";import"./HighlightText-BLaAjUt8.js";import"./index-CptRizr3.js";import"./debounce-BgSgg6I6.js";import"./index-DKPh1ief.js";function Ls(t=100){const n=p.useRef([]),s=p.useRef(!1),i=p.useRef(void 0),r=p.useCallback(async()=>{if(!s.current){for(s.current=!0;n.current.length>0;){const l=n.current.shift();if(!l)continue;const{id:c,run:u,onStart:m,onSuccess:g,onError:b}=l;if(l._cancelled){console.log(`[task:${l.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),m==null||m(c);const d=await u(i.current,c);i.current=d,console.log(`[task:${c}] success`,d),g==null||g(d,c)}catch(d){console.error(`[task:${c}] failed`,d),b==null||b(d,c)}await new Promise(d=>setTimeout(d,t))}s.current=!1}},[t]),a=l=>{n.current.push(l),r()},o=l=>{const c=n.current.find(u=>u.id===l);c&&(c._cancelled=!0),n.current=n.current.filter(u=>u.id!==l)};return p.useEffect(()=>()=>{n.current=[],s.current=!1,i.current=void 0},[]),{addTask:a,removeTask:o}}const gt=(t,n)=>n?t:"********";function Ps({totalValue:t,onRefreshTask:n,isLoading:s,children:i}){const[r,a]=p.useState(!1),{currentAccount:o,onWalletModal:l,accounts:c}=U(),{isShowProfileAssets:u,setIsShowProfileAssets:m}=nt(),{isAutoRefresh:g,dcaOrderListLoading:b,setAutoRefreshCount:d,resetAutoRefreshCount:w}=K();p.useEffect(()=>{a(!0)},[]);const{onClose:k}=Ke();return e.jsx(E,{w:"100%",mt:"28px",children:r?o!=null&&o.address?e.jsxs(E,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(v,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(v,{h:"18px",children:[e.jsx(x,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(x,{fontSize:"12px",children:u?"Hide Value":"View Value"}),children:e.jsx(Z,{children:e.jsx(M,{xlinkHref:u?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>m(!u)})})})]}),e.jsxs(v,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(x,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(M,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(Q,{isLoaded:!s,h:"32px",children:e.jsx(x,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(le(t,2),u)})}),c.length>1&&e.jsxs(v,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",children:[e.jsx(M,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(x,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:["Roul :"," "]}),e.jsx(ct,{currentAccount:o,accounts:c,onClose:k,isProfile:!0})]}),i]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>l(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Oe,{})})})}function Ce(t){const{type:n,children:s,wrapStyle:i={h:"60px"},textStyle:r={fontSize:"16px"}}=t,a=(o,l)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(o,l):o===l.value;return e.jsxs(v,{justify:"space-between",w:"100%",h:"60px",...i,children:["title"in t?e.jsx(x,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(je,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(o,l)=>a(o,l),wrapStyle:{h:"60px",border:"none",gap:"38px",...i},itemStyle:r}),s]})}function Rs({orderInfo:t,isActiveOrder:n,pageDirect:s}){const{inCoin:i,outCoin:r}=t,{orderHistoryList:a,handleGetDcaOrderHistory:o,orderHistoryListLoading:l}=dt();p.useEffect(()=>{t!=null&&t.orderID&&o(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=ot(),[u,m]=p.useState(s),g=142,b=(a==null?void 0:a.length)||0,d=(a==null?void 0:a.length)<=1?`${g*b-8}px`:`${g*b+(b-1)*32-8}px`;return e.jsxs(E,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(a==null?void 0:a.length)>=3?"460px":"unset",overflowY:"auto",children:[!l&&e.jsx(W,{h:d,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),l?e.jsx(v,{h:"100px",w:"100%",justify:"center",children:e.jsx(Oe,{})}):(a==null?void 0:a.length)===0?e.jsx(se,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):a.map(w=>{const k=Xe(w.inAmount,i==null?void 0:i.decimals),H=Xe(w.outAmount,r==null?void 0:r.decimals),_=B(k).div(H).toString(),j=B(1).div(_).toString();return e.jsxs(E,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(v,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(x,{h:"20px",lineHeight:"20px",children:[fe((w==null?void 0:w.time)*1e3)," (UTC)"]}),e.jsx(M,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(w==null?void 0:w.tx,"tx"))}}),e.jsx(v,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(W,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(q,{p:"16px",borderRadius:"12px",children:e.jsxs(E,{align:"flex-start",gap:"20px",children:[e.jsxs(E,{gap:"0px",align:"flex-start",children:[e.jsx(x,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:u?`${G(_)} `:`${G(j)} `}),e.jsxs(v,{children:[e.jsxs(x,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",u?` ${i.symbol} per ${r.symbol}`:` ${r.symbol} per ${i.symbol}`,")"]}),e.jsx(M,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>m(!u)})]})]}),e.jsxs(v,{w:"100%",gap:"4px",children:[e.jsx(Re,{imageUrl:i==null?void 0:i.logo_url,w:"20px",h:"20px"}),e.jsx(x,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${G(k)}`}),e.jsx(x,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${i.symbol}`}),e.jsx(x,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(Re,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(x,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${G(H)}`}),e.jsx(x,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},w==null?void 0:w.tx)})]})}function Ds({orderInfo:t,isActiveOrder:n,pageDirect:s,isClaimLoading:i=!1,toClaim:r}){const{inCoin:a,outCoin:o}=t;return e.jsxs(E,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&n&&e.jsx(Os,{}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(pt,{orderInfo:t}),n&&r&&e.jsx(X,{isLoading:i,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||i,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(x,{fontSize:"16px",color:"text_caption",children:Dt(t,n,!0)}),e.jsx(x,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(v,{w:"100%",justify:"space-around",children:[e.jsxs(E,{children:[e.jsx(x,{fontSize:"16px",color:"text_caption",children:Ot(t)}),e.jsxs(x,{fontSize:"12px",children:["DCA ",a==null?void 0:a.symbol," Balance"]})]}),e.jsx(W,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(E,{children:[e.jsx(x,{color:"text_caption",fontSize:"16px",children:At(t)}),e.jsxs(x,{fontSize:"12px",children:["DCA ",o==null?void 0:o.symbol," Balance "]})]})]}),e.jsxs(E,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(I,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(I,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(I,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${a==null?void 0:a.symbol}`}),n&&e.jsx(I,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${o==null?void 0:o.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${o==null?void 0:o.symbol} per ${a==null?void 0:a.symbol}`}),!n&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(I,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${o==null?void 0:o.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${o==null?void 0:o.symbol} per ${a==null?void 0:a.symbol}`}),n&&e.jsx(I,{label:"Next Order (UTC)",value:fe(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(I,{label:"Created (UTC)",value:fe(t==null?void 0:t.createdAt)||""})]})]})}const Os=()=>{const[t,n]=p.useState(!1);return e.jsxs(E,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(v,{align:"center",w:"100%",cursor:"pointer",onClick:()=>n(!t),children:[e.jsx(x,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(M,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(E,{align:"flex-start",w:"100%",children:[e.jsx(W,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Ht,{})]})]})};function As({isOpen:t,onClose:n,orderInfo:s,isActiveOrder:i,isClaimLoading:r=!1,toClaim:a}){const{isApp:o}=V(),l=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,u]=p.useState("overview"),{inCoin:m,outCoin:g}=s,[b,d]=p.useState(!1),{getTokenRank:w}=Ut();return p.useEffect(()=>{const k=w(m,g);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",g,m,k),d(!k)},[m==null?void 0:m.coin_type,g==null?void 0:g.coin_type]),e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{minWidth:o?"300px":"482px",children:[e.jsx(Je,{children:e.jsx(W,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ce,{type:"tab",currentTab:c,tabs:l,onTabChange:k=>u(k.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(Ds,{orderInfo:s,isActiveOrder:i,pageDirect:b,isClaimLoading:r,toClaim:a}),c=="orders"&&e.jsx(Rs,{orderInfo:s,isActiveOrder:i,pageDirect:b})]})]})]})}function Hs({orderInfo:t,isActiveOrder:n=!0}){const{isApp:s}=V(),[i,r]=p.useState(!1),{getExplorerUrl:a}=ot(),{isClaimLoading:o,toClaim:l,closeOrderAction:c,isCloseLoading:u}=dt();return e.jsxs(e.Fragment,{children:[n&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(X,{isLoading:o,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||o,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(re,{placement:"bottom-end",tooltip:e.jsxs(E,{align:"flex-start",children:[e.jsx(Te,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(Te,{text:"View on Explorer",onClick:()=>{window.open(a(t.orderID,"poolAddress"))}}),e.jsx(Te,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:u?()=>{}:()=>{c(t)}})]}),children:e.jsx(Z,{children:e.jsx(X,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(M,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!n&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(X,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(X,{onClick:m=>{Ct(m),window.open(a(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(M,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),i&&e.jsx(As,{isOpen:i,onClose:()=>r(!1),orderInfo:t,isActiveOrder:n,isClaimLoading:o,toClaim:l})]})}function Es(){const{isAutoRefresh:t,dcaOrderListLoading:n,dcaActiveOrderList:s,dcaPastOrderList:i}=K(),[r,a]=p.useState("activeDCAs"),o=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&n?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&n?"":i==null?void 0:i.length}],[n,i,s]),l=p.useMemo(()=>r=="activeDCAs"?s:i,[r,s,i]),{isApp:c}=V(),{closeAll:u,claimAll:m,isClaimAllLoading:g,isCloseAllLoading:b}=Et(),d=p.useMemo(()=>r==="pastDCAs"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((A,y)=>B(A).plus(y==null?void 0:y.outBalance),B(0)).toString(),[r,l]),[w,k]=p.useState([]),[H,_]=p.useState(0),[j,C]=p.useState(1),T=10,L=Ne(r=="activeDCAs");return p.useEffect(()=>{if((l==null?void 0:l.length)>0){const A=(j-1)*T;(l==null?void 0:l.length)<=A&&C(1)}},[l]),p.useEffect(()=>{if((l==null?void 0:l.length)>0){_(l==null?void 0:l.length);const A=(j-1)*T,y=A+T;console.log("ðŸš€ ~ useEffect ~ start:",j,l.slice(0,y),A,y),(l==null?void 0:l.length)>A&&k(l.slice(A,y))}},[j,l]),e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:o,currentTab:r,handleChangeTab:A=>a(A==null?void 0:A.value),isActive:(A,y)=>A===y.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(l==null?void 0:l.length)>1&&r=="activeDCAs"&&e.jsxs(v,{children:[e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:g,disabled:Number(d)===0||g,onClick:()=>{m(l)},children:"Claim All"}),e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:b,disabled:(l==null?void 0:l.length)==0||b,onClick:()=>{u(l)},children:"Close All"})]})]}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!n&&(l==null?void 0:l.length)===0?e.jsx(se,{type:"nodata",noBorder:!0}):c?e.jsx(E,{w:"100%",gap:"4px",children:e.jsx(Ee,{rowKey:"orderID",columns:L,dataSource:w,loading:!t&&n,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"orderID",columns:Ne(r=="activeDCAs"),dataSource:w,loading:!t&&n,rowStyle:{h:"80px",cursor:"pointer"}}),(l==null?void 0:l.length)>T&&e.jsx(Z,{children:e.jsx(we,{total:H,size:T,currentPage:j,onChange:A=>{C(A)}})})]})]})}const Ne=t=>[{title:e.jsx(x,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(pt,{orderInfo:s})},{title:e.jsx(x,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(zt,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(x,{textAlign:"right",children:"Total"}),key:"total",thConfig:{w:"12%"},render:({inDeposited:s,inCoin:i})=>e.jsxs(x,{color:"text_caption",children:[G(s)," ",i==null?void 0:i.symbol]})},{title:e.jsx(x,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Ft,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(x,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(x,{color:"text_caption",children:fe(s)})},{title:e.jsx(x,{textAlign:"right",children:t?"Actions":"Action"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(Hs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function zs(){const{currentAccount:t}=U(),{getLimitOrderHistory:n,historyOrderList:s,historyOrderLoading:i}=Mt(),{myOrderList:r,orderListLoading:a}=de(),{isAutoRefresh:o,autoRefreshCount:l}=K(),[c,u]=p.useState("openOrders"),m=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:!o&&a?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:!o&&i?"":s==null?void 0:s.length}],[a,i,r,s]),g=h=>{t!=null&&t.address&&n(t.address,h)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",l),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),l>0&&g(!0)},[l]),p.useEffect(()=>{g(!0)},[c,t]);const b=p.useMemo(()=>c=="openOrders"?a:i,[c,a,i]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,s),c=="openOrders"?r:s),[c,r,s]);Yt({onRpcChange:()=>{g(!0)}});const{isApp:w}=V(),{handleCancelOrder:k,cancelOrderLoading:H}=Xt(),[_,j]=p.useState([]),[C,T]=p.useState(0),[L,A]=p.useState(1),y=10,P=Fs(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const h=(L-1)*y;(d==null?void 0:d.length)<=h&&A(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){T(d==null?void 0:d.length);const h=(L-1)*y,S=h+y;console.log("ðŸš€ ~ useEffect ~ start:",L,d.slice(0,S),h,S),(d==null?void 0:d.length)>h&&j(d.slice(h,S))}},[L,d]),e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:m,currentTab:c,handleChangeTab:h=>u(h==null?void 0:h.value),isActive:(h,S)=>h===S.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(v,{children:e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:H,onClick:()=>{k(r)},children:"Cancel All"})})]}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!b&&(d==null?void 0:d.length)===0?e.jsx(se,{type:"nodata",noBorder:!0}):w?e.jsx(E,{w:"100%",gap:"4px",children:e.jsx(Ee,{rowKey:"order_id",columns:P,dataSource:_,loading:!o&&b,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"order_id",columns:P,dataSource:_,loading:!o&&b,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>y&&e.jsx(Z,{children:e.jsx(we,{total:C,size:y,currentPage:L,onChange:h=>{A(h)}})})]})]})}const Fs=t=>[{title:e.jsx(x,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx($t,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(x,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Wt,{info:s,isProfile:!0})},{title:e.jsx(x,{textAlign:"right",children:"Total"}),key:"total",thConfig:{w:"16%"},render:({total_pay_amount:s,pay_coin:i})=>e.jsxs(x,{color:"text_caption",children:[G(s)," ",i.symbol]})},{title:e.jsx(x,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(Vt,{info:s,isProfile:!0})},{title:e.jsx(x,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Nt,{info:s,isProfile:!0})},!t&&{title:e.jsx(x,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Gt,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(x,{textAlign:"right",children:t?"Actions":"Action"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(qt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function Bs(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[n,s]=p.useState("limitOrders");return e.jsx(q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{align:"flex-start",gap:"20px",children:[e.jsx(W,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ce,{type:"tab",currentTab:n,tabs:t,onTabChange:i=>s(i.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),n==="limitOrders"&&e.jsx(zs,{}),n==="dca"&&e.jsx(Es,{})]})})}function Us({handleRefresh:t,totalValue:n,isLoading:s}){var b,d;const{isApp:i}=V(),{currentAccount:r,accounts:a}=U(),{isShowProfileAssets:o,setIsShowProfileAssets:l}=nt(),[c,u]=p.useState(!1),{onClose:m}=Ke(),g=a.reduce((w,k)=>(w[k.address]=k,w),{});return e.jsxs(E,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(v,{w:"100%",children:[e.jsx(x,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!i,placement:"bottom-end",tooltip:e.jsx(x,{fontSize:"12px",children:o?"Hide Value":"View Value"}),children:e.jsx(Z,{children:e.jsx(M,{xlinkHref:o?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>l(!o)})})})]}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(Q,{isLoaded:!s,h:"22px",children:e.jsx(x,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(le(n,2),o)})}),e.jsxs(v,{children:[e.jsxs(v,{p:"0 8px",h:"36px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{u(!0)},children:[e.jsx(M,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(x,{children:"Transactions"})]}),e.jsx(It,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),a.length>1&&e.jsxs(v,{children:[((b=g==null?void 0:g[r==null?void 0:r.address])==null?void 0:b.label)&&e.jsxs(x,{color:"primary_gray",children:[(d=g==null?void 0:g[r==null?void 0:r.address])==null?void 0:d.label," :"]}),e.jsx(ct,{currentAccount:r,accounts:a,onClose:m,isProfile:!0})]}),c&&e.jsx(Rt,{isOpen:c,onClose:()=>u(!1)})]})}function Ms(){var H;const{currentAccount:t,onWalletModal:n}=U(),{showPosListLength:s,setShowPosListLength:i,posBaseListLoading:r,posBaseListGroupByPool:a}=oe(),[o,l]=p.useState([]),{isAutoRefresh:c}=K(),[u,m]=p.useState([]),g=_=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",_),m(j=>[...j,_])},b=_=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",_),m(j=>j.filter(C=>(C==null?void 0:C.coin_type)!==(_==null?void 0:_.coin_type)))};p.useEffect(()=>{t!=null&&t.address?console.log("ðŸš€ ~ useEffect ~ currentAccount?.address:",t==null?void 0:t.address):i("")},[t==null?void 0:t.address]),p.useEffect(()=>{var L,A,y,P;const _=(L=u[0])!=null&&L.coin_type?ee((A=u[0])==null?void 0:A.coin_type):void 0,j=(y=u[1])!=null&&y.coin_type?ee((P=u[1])==null?void 0:P.coin_type):void 0,C=Object.values(a).filter(h=>_&&j?ee(h.tokenA.coin_type)==_&&ee(h.tokenB.coin_type)==j||ee(h.tokenA.coin_type)==j&&ee(h.tokenB.coin_type)==_:_?ee(h.tokenA.coin_type)==_||ee(h.tokenB.coin_type)==_:h);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(a),C),l(C);const T=C.reduce((h,S)=>h+(S.list?S.list.length:0),0);t!=null&&t.address&&i(T.toString())},[u,a]),p.useEffect(()=>()=>{i("")},[]),p.useEffect(()=>{r&&i("")},[r]);const d=p.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[w,k]=p.useState("positions");return e.jsx(q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{gap:"16px",w:"100%",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(Ce,{type:"tab",currentTab:w,tabs:d,onTabChange:_=>k(_.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(ns,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:u,onClickSelectCoinList:g,onDeleteSelectCoinList:b})]}),e.jsx(W,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(os,{}),t!=null&&t.address?!c&&r?[{},{},{},{}].map((_,j)=>e.jsx(rs,{},j)):((H=Object.values(o))==null?void 0:H.length)>0?Object.values(o).map((_,j)=>e.jsx(is,{poolInfo:_},j)):e.jsx(se,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(se,{type:"nowallet",onboard:()=>n(!0),noBorder:!0})]})})}function Xs({tabList:t,tabData:n,onClickTab:s}){return e.jsx(E,{w:"100%",children:t==null?void 0:t.map(i=>e.jsx($s,{imgUrl:i.activeImgUrl,value:n[i.value].totalValue,title:i.title,url:i.route,tooltip:i==null?void 0:i.tooltip,onClick:()=>s(i.value),isLoading:n[i.value].isLoading},i.title))})}const $s=({imgUrl:t,value:n,title:s,url:i,tooltip:r,isLoading:a,onClick:o})=>(Ae(),e.jsxs(v,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:o,children:[e.jsxs(v,{gap:"12px",children:[e.jsx(st,{w:"36px",h:"36px",src:t}),e.jsxs(E,{gap:"2px",align:"flex-start",children:[e.jsx(Q,{h:"24px",isLoaded:!a,children:e.jsx(x,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:n})}),e.jsxs(v,{gap:"4px",children:[e.jsx(x,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),r&&e.jsx(re,{tooltip:r,children:e.jsx(W,{children:e.jsx(M,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(Z,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(M,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function Ws({tabList:t,activeTab:n,tabData:s,onClickTab:i}){return e.jsx(v,{w:"100%",mt:"10px",children:t.map(r=>{var a,o;return e.jsxs(q,{w:"25%",p:"24px 16px",h:"94px",bgImage:n===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",onClick:()=>i(r.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",img:{opacity:"0.8"}},children:[e.jsxs(E,{align:"flex-start",gap:"12px",children:[e.jsx(x,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(v,{h:"22px",children:e.jsx(re,{placement:"top",tooltip:e.jsx(x,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:r.tooltip}),showTooltip:r.showTooltip,children:e.jsx(Z,{as:"button",children:e.jsx(Q,{isLoaded:!((a=s[r.value])!=null&&a.isLoading),children:e.jsx(x,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(o=s[r.value])==null?void 0:o.totalValue})})})})})]}),e.jsx(st,{w:"48px",h:"48px",src:r.activeImgUrl,opacity:n===r.value?"0.8":"0.4"})]},r.value)})})}function Ge(t){const{isApp:n}=V();return n?e.jsx(Xs,{...t}):e.jsx(Ws,{...t})}const Vs=(t,n)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),ye=it(Vs);function ht(){const{currentAccount:t}=U(),{fetchAccountBalance:n}=cs(),{coinHoldingList:s,setCoinHoldingList:i,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:a,setHoldingsTotalUsd:o,isCoinPriceLoading:l,setUnknownCoinCount:c}=ye(),{getTokenListInfo:u}=xt(),{getTokenPrice:m}=ce(),{refreshCoinPriceInfo:g}=ze(),b=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const d=async()=>{const j=b.current;if(j){r(!0);const C=await n(j,!0);if(C){const T=await u(C.filter(y=>B(y.totalBalance).gt(0)).map(y=>y.coinType));if(!T)throw r(!1),i([]),new Error("get token list info error");const L=[];let A=0;return C.forEach(y=>{const P=T.get(y.coinType);if(P){const h=y.totalBalance,S=te(h,P.decimals).toString(),D=G(S,void 0,void 0,yt.ROUND_DOWN).toString(),O={balance:h,balance_format:S,balance_display:D,balance_usd:"0",coin:P,coin_type:P==null?void 0:P.coin_type,price:"",price_diff_24:""};L.push(O),P.is_verified||A++}}),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",j),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",b.current),j===b.current&&(i(L),c(A),w([...L])),r(!1),L}}else r(!1),i([]);return[]},w=async j=>{a(!0);try{await g(j.filter(C=>C.coin.is_verified).map(C=>C.coin.coin_type))}catch(C){console.error("fetch coin price info error",C)}finally{a(!1)}},k=j=>{j.forEach(C=>{const{coin:T}=C;if(T.is_verified){const L=m(T.coin_type);L&&(C.price=L.price,C.price_diff_24="",C.balance_usd=B(C.balance_format).mul(L.price).toString())}})},H=async j=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:j,coinHoldingList:s,currentAccount:t}),t){const{search:C,current_sort:T,current_sort_order:L,is_show_unknown:A=!1,is_hide_small_balance:y=!0}=j;let P=[];if(A?P.push(...s):P=s.filter(h=>h.coin.is_verified),C){const h=C.toLowerCase();P=P.filter(S=>S.coin.coin_type.toLowerCase().includes(h)||S.coin.symbol.toLowerCase().includes(h)||S.coin.name.toLowerCase().includes(h))}return k(P),y&&!l&&(P=P.filter(h=>B(h.balance_usd).gt(.01))),P.sort((h,S)=>{if(T==="balance"){const D=B(h.balance_format).cmp(B(S.balance_format));if(D!==0)return L==="desc"?-D:D}if(T==="value"){const D=B(h.balance_usd).cmp(B(S.balance_usd));return D!==0?L==="desc"?-D:D:B(S.balance_format).cmp(B(h.balance_format))}if(T==="price"){const D=B(h.price).cmp(B(S.price));return D!==0?L==="desc"?-D:D:B(S.balance_format).cmp(B(h.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",P),P}return[]};return p.useEffect(()=>{k(s);const j=s.reduce((C,T)=>C+Number(T.balance_usd||0),0);o(j.toString())},[s,l]),{getFilterCoinHoldingList:H,fetchCoinHoldingList:d,resetUserData:()=>{i([]),o("0"),c(0)}}}function Ns({inputValue:t,changeInputValue:n}){const s=p.useRef(null),[i,r]=p.useState(!1);return V(),e.jsxs(mt,{children:[e.jsx(bt,{w:i?"203px":"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},bg:"bg_secondary",ref:s,borderRadius:"8px",h:"32px",border:"1px solid",borderColor:"border",variant:"outline",value:t,onChange:a=>{n(a.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{n(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:"8px",pl:i?"28px":"8px"}),e.jsxs(wt,{children:[e.jsx(M,{position:"absolute",top:"6px",left:i?"-198px":"-26px",xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:a=>{var o;(o=s.current)==null||o.focus(),r(!0)}}),t?e.jsx(M,{xlinkHref:"#icon-icon_close",position:"absolute",top:"6px",right:"6px",onMouseDown:a=>a.preventDefault(),onClick:a=>{n(""),setTimeout(()=>{var o;(o=s.current)==null||o.focus()},0)}}):null]})]})}function Gs({inputValue:t,changeInputValue:n,isShowUnknownCoin:s,handleIsShowUnknownCoin:i,isHideLowAsset:r,handleIsHideLowAsset:a,unknownCoinCount:o}){return V(),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(x,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(v,{children:[e.jsx(Ns,{inputValue:t,changeInputValue:n}),e.jsx(q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsxs(x,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",o,")"]}),e.jsx(Me,{isChecked:s,onChange:i})]})}),e.jsx(q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsx(x,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Me,{isChecked:r,onChange:a})]})})]})]})}function qs(){const{isApp:t}=V(),{getFilterCoinHoldingList:n}=ht(),{isCoinHoldingLoading:s,isCoinPriceLoading:i,unknownCoinCount:r}=ye(),{isAutoRefresh:a}=K(),[o,l]=p.useState([]),[c,u]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[m,g]=p.useState(!1),[b,d]=p.useState(!0),[w,k]=p.useState("desc"),[H,_]=p.useState(De[2]),j=f=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",f),a||F(1),u(f),n(f).then(l)},C=f=>{j({...c,search:f})},T=(f,z)=>{j({...c,[f]:z}),f==="is_show_unknown"&&g(z),f==="is_hide_small_balance"&&d(z)},L=f=>{const z=(f==null?void 0:f.value)===(H==null?void 0:H.value),Y=t||!z?"desc":w==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",Y,f),_(f),k(Y),j({...c,current_sort:f.value,current_sort_order:Y})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,i,o),!s&&!i&&j(c)},[s,i]);const A=Ae(),y=f=>{A(`/swap/${f}/''`)},[P,h]=p.useState([]),[S,D]=p.useState(0),[O,F]=p.useState(1),R=10;return p.useEffect(()=>{if((o==null?void 0:o.length)>0){const f=(O-1)*R;(o==null?void 0:o.length)<=f&&F(1)}},[o]),p.useEffect(()=>{if((o==null?void 0:o.length)>0){D(o==null?void 0:o.length);const f=(O-1)*R,z=f+R;console.log("ðŸš€ ~ useEffect ~ start:",O,o.slice(0,z),f,z),(o==null?void 0:o.length)>f&&h(o.slice(f,z))}},[O,o]),e.jsx(q,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Gs,{unknownCoinCount:r,inputValue:c.search||"",changeInputValue:C,isShowUnknownCoin:m,handleIsShowUnknownCoin:f=>T("is_show_unknown",f.target.checked),isHideLowAsset:b,handleIsHideLowAsset:f=>T("is_hide_small_balance",f.target.checked)}),e.jsx(W,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!s&&!i&&(o==null?void 0:o.length)===0?e.jsx(se,{type:"nodata",noBorder:!0}):t?e.jsxs(E,{w:"100%",gap:"4px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(x,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Cs,{sortText:"Sort by",minW:"180px",currentSort:H,sortByList:De,onSortByChange:L,xlinkHref:w==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>k(f=>f==="desc"?"asc":"desc")})]}),e.jsx(Ee,{rowKey:"coin_type",columns:qe(w,H,L,y,!a&&i),dataSource:P,loading:!a&&(s||i),itemSkeletonLength:5,itemHeight:"30px",onRowClick:f=>{y(f==null?void 0:f.coin_type)}})]}):e.jsx(be,{rowKey:"coin_type",columns:qe(w,H,L,y,!a&&i),dataSource:P,skeletonLength:10,loading:!a&&(s||i),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:f=>{y(f==null?void 0:f.coin_type)}}),(o==null?void 0:o.length)>R&&e.jsx(Z,{children:e.jsx(we,{total:S,size:R,currentPage:O,onChange:f=>{F(f)}})})]})]})})}const De=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],ke=Object.fromEntries(De.map(t=>[t.value,t])),qe=(t,n,s,i,r)=>[{title:e.jsx(x,{children:"Token"}),key:"pool",thConfig:{w:"22%"},showLabel:!1,render:({coin:a})=>e.jsx(ws,{haveTooltip:!0,token:a,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(ve,{labelInfo:ke.balance,sortRule:t,sortBy:n,clickSort:s}),key:"balance",thConfig:{w:"20%"},render:({coin:a,balance_display:o})=>e.jsxs(x,{color:"text_caption",children:[o," ",_t(a==null?void 0:a.symbol,10)]})},{title:e.jsx(ve,{labelInfo:ke.price,sortRule:t,sortBy:n,clickSort:s}),key:"price",thConfig:{w:"20%"},render:({price:a})=>e.jsx(v,{justify:"flex-end",children:e.jsx(Q,{isLoaded:!r,children:e.jsxs(x,{color:"text_caption",children:["$",at(a)]})})})},{title:e.jsx(ve,{labelInfo:ke.value,sortRule:t,sortBy:n,clickSort:s}),key:"balance_usd",thConfig:{w:"20%"},render:({balance_usd:a})=>e.jsx(v,{justify:"flex-end",children:e.jsx(Q,{isLoaded:!r,children:e.jsx(x,{color:"text_caption",children:le(a,2)})})})},{title:e.jsx(x,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"18%"},key:"actions",render:a=>e.jsx(X,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{i(a==null?void 0:a.coin_type)},children:"Swap"})}],Ks=(t,n)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),_e=it(Ks);function ft(t){const{title:n,imgUrl:s}=t;return e.jsxs(v,{justify:"space-between",align:"flex-start",w:"100%",children:[e.jsxs(v,{children:[s&&e.jsx(Re,{imageUrl:s,p:"4px",imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(x,{children:n})]}),"btnTitle"in t&&t.btnTitle?e.jsx(X,{h:"32px",borderRadius:"8px",p:"8px",fontSize:"12px",onClick:t.onClick,fontWeight:"500",children:t.btnTitle}):e.jsx(W,{h:"32px"})]})}const Ys={cetus:{title:"CETUS",imgUrl:$.cetus_coin.logo_url,bgUrl:"/images/cetus_holding_bg.png"},xcetus:{title:"xCETUS",imgUrl:$.x_cetus_coin.logo_url,bgUrl:"/images/xcetus_holding_bg.png"}};function jt({type:t,amount:n,amountUSD:s,isLoading:i,onClick:r,btnTitle:a,children:o}){const{title:l,imgUrl:c,bgUrl:u}=Ys[t];return e.jsx(q,{flex:"1",bg:`right 0 bottom 60% / 86px 142px no-repeat url("${u}"), radial-gradient(40% 74% at 100% 100%,#1D342E 0%, rgba(22,27,48,0) 100%), rgba(0,0,0,0.5)`,backdropFilter:"blur(20px)",p:"16px",borderRadius:"16px",children:e.jsxs(E,{w:"100%",gap:"0",children:[e.jsx(ft,{title:`${l} Holdings`,imgUrl:c,onClick:r,btnTitle:a}),e.jsxs(E,{align:"flex-start",w:"100%",m:"31px 0 60px",children:[e.jsx(Q,{isLoaded:!i,h:"26px",children:e.jsx(x,{color:"text_caption",h:"26px",lineHeight:"26px",fontSize:"22px",children:n})}),e.jsx(Q,{isLoaded:!i,h:"17px",children:e.jsxs(x,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["Total ",l," (â‰ˆ $",at(s,2),")"]})})]}),o]})})}function Is(){const{currentAccount:t}=U(),{balanceInfo:n}=ys($.cetus_coin),{getTokenAmountValue:s}=ce(),{coinPriceObj:i}=He(),r=p.useMemo(()=>s($.cetus_coin.coin_type,te((n==null?void 0:n.balance)||"0",$.cetus_coin.decimals)).toString(),[n==null?void 0:n.balance,t==null?void 0:t.address,i]),{setCurrentXCetusTab:a,setIsXCetusModalOpen:o}=_e(),l=()=>{o(!0),a("Get xCETUS")},{veNFT:c,veNFTLoading:u,lockCetusListLoading:m}=J();return e.jsx(jt,{type:"cetus",amount:t?(n==null?void 0:n.balanceFormat)||"0":"--",amountUSD:r,isLoading:(m||u)&&c!==void 0,children:e.jsx(X,{w:"100%",h:"48px",borderRadius:"12px",fontWeight:"500",fontSize:"16px",onClick:l,children:"Get xCETUS"})})}function Qs(){const{lockCetusList:t,lockCetusListLoading:n}=J(),[s,i]=p.useState([]),[r,a]=p.useState(0),[o,l]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const u=(o-1)*c;(t==null?void 0:t.length)<=u&&l(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){a(t==null?void 0:t.length);const u=(o-1)*c,m=u+c;console.log("ðŸš€ ~ useEffect ~ start:",o,t.slice(0,m),u,m),(t==null?void 0:t.length)>u&&i(t.slice(u,m))}},[o,t]),t&&t.length>0&&e.jsxs(q,{p:"0 16px 16px",w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:[e.jsx(Ce,{type:"title",title:"Redeeming xCETUS"}),e.jsx(Pe,{orientation:"horizontal"}),e.jsx(be,{rowKey:"id",mt:"10px",dataSource:s,columns:Zs(),loading:n,skeletonLength:t==null?void 0:t.length,rowStyle:{h:"80px"}}),(t==null?void 0:t.length)>c&&e.jsx(Z,{children:e.jsx(we,{total:r,size:c,currentPage:o,onChange:u=>{l(u)}})})]})}const Zs=()=>[{title:e.jsx(x,{children:"xCETUS To CETUS"}),key:"to",render:t=>e.jsx(ds,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"})},{title:e.jsx(x,{textAlign:"right",children:"Vesting Duration (Day)"}),key:"lock_day",render:t=>e.jsx(x,{color:"text_caption",fontSize:"14px",children:t==null?void 0:t.lock_day})},{title:e.jsx(x,{textAlign:"right",children:"Available Claim Date"}),key:"date",render:t=>e.jsx(x,{color:"text_caption",fontSize:"14px",children:St.unix(t==null?void 0:t.locked_until_time).format("MMM D, YYYY HH:mm")})},{title:e.jsx(x,{textAlign:"right",children:"Action"}),key:"action",render:t=>{const[n,s]=p.useState(!1),{cancelOrderLoading:i,handleCancelOrder:r}=ps(),{claimOrderLoading:a,handleClaimOrder:o}=us(),l=c=>{c?o(t.id):r(t)};return p.useEffect(()=>{s(!rt.isLocked(t))},[t.id]),e.jsx(v,{justify:"flex-end",children:e.jsx(X,{onClick:()=>{i||a||l(n)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:i||a,color:n?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:n?"Claim":"Cancel"})})}}];function Js({cetusApr:t,myShare:n,totalRewardValue:s,nextStartTime:i,rewardList:r}){const{currentAccount:a}=U(),{days:o,hours:l,minutes:c,seconds:u}=xs((i||0)*1e3),{veNFTLoading:m}=J(),{claimRewardLoading:g,handleClaimReward:b}=gs(),d=()=>{g||b(r)};return V(),e.jsx(q,{flex:"1.46",p:"16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{w:"100%",gap:"0",children:[e.jsx(ft,{title:"Staking Rewards",onClick:d,btnTitle:B(s).gt(0)?"Claim":""}),e.jsxs(E,{m:"36px 0 50px",h:"57px",children:[e.jsxs(v,{children:[e.jsx(ue,{value:o,type:"d"}),e.jsx(x,{color:"text_caption",children:":"}),e.jsx(ue,{value:l,type:"h"}),e.jsx(x,{color:"text_caption",children:":"}),e.jsx(ue,{value:c,type:"m"}),e.jsx(x,{color:"text_caption",children:":"}),e.jsx(ue,{value:u,type:"s"})]}),e.jsx(x,{fontSize:"14px",h:"17px",lineHeight:"17px",children:"Reward Distribution In"})]}),e.jsxs(v,{justify:"space-between",w:"80%",mb:"12px",children:[e.jsx(Le,{title:"Est.APR",value:e.jsx(hs,{children:e.jsxs(x,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",cursor:"pointer",children:["â‰ˆ$",Tt(t,2)]})}),loading:t==="0"}),e.jsx(Pe,{orientation:"vertical"}),e.jsx(Le,{title:"Your Share",value:n!=="--"?`â‰ˆ${n}`:n,loading:m}),e.jsx(Pe,{orientation:"vertical"}),e.jsx(Le,{title:"Pending Yield",value:a?le(s,2):"--",loading:m})]})]})})}const en={d:"D",h:"H",m:"M",s:"S"},ue=({value:t,type:n})=>e.jsxs(v,{borderRadius:"8px",bg:"background",p:"4px 8px",justify:"center",align:"flex-end",w:"64px",h:"32px",gap:"2px",children:[e.jsx(x,{color:"text_caption",fontSize:"20px",textAlign:"center",children:t}),e.jsx(x,{fontSize:"12px",mb:"1px",children:en[n]})]}),Le=({title:t,value:n,loading:s})=>e.jsxs(E,{gap:"3px",children:[e.jsx(Q,{isLoaded:!s,h:"17px",children:e.jsx(x,{color:"text_caption",fontSize:"14px",h:"17px",lineHeight:"1",children:n})}),e.jsx(x,{fontSize:"14px",h:"15px",lineHeight:"1",children:t})]});function tn({availableXCetusAmount:t,redeemingXCetusAmount:n}){const{currentAccount:s}=U(),{veNFT:i,veNFTLoading:r,lockCetusListLoading:a}=J(),{getTokenAmountValue:o}=ce(),{coinPriceObj:l}=He(),c=p.useMemo(()=>o($.cetus_coin.coin_type,te((i==null?void 0:i.xcetus_balance)||"0",$.x_cetus_coin.decimals)).toString(),[i==null?void 0:i.xcetus_balance,s==null?void 0:s.address,l]),{setCurrentXCetusTab:u,setIsXCetusModalOpen:m}=_e(),g=()=>{m(!0),u("Redeem CETUS")},b=(a||r)&&i!==void 0;return e.jsx(jt,{type:"xcetus",amount:s?G(te((i==null?void 0:i.xcetus_balance)||"0",9),9).toString():"--",amountUSD:c,onClick:g,btnTitle:"Redeem",isLoading:b,children:e.jsxs(E,{w:"100%",gap:"16px",h:"48px",children:[e.jsx(I,{isLoading:b,label:"Available",value:s?G(te(t,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}}),e.jsx(I,{isLoading:b,label:"Redeeming",value:s?G(te(n,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}})]})})}const xe=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function sn({isOpen:t,onClose:n,availableXCetusAmount:s}){const{currentXCetusTab:i,setCurrentXCetusTab:r}=_e(),[a,o]=p.useState("#icon-a-icon_trade"),l=()=>{o("#icon-icon_swap1")},c=()=>{o("#icon-a-icon_trade")},u=()=>{var g;const m=(g=xe==null?void 0:xe.find(b=>(b==null?void 0:b.value)!==i))==null?void 0:g.value;m&&r(m)};return e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{children:[e.jsx(Je,{p:"0 16px",children:e.jsx(W,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:xe,currentTab:i,handleChangeTab:m=>{r(m==null?void 0:m.value)}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"20px 16px 16px",children:[i==="Get xCETUS"&&e.jsx(fs,{availableXCetusAmount:s,onIconClick:u,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}}),i==="Redeem CETUS"&&e.jsx(js,{availableXCetusAmount:te(s,9),onIconClick:u,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}})]})]})]})}function nn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:n}=_e(),{availableXCetusAmount:s,redeemingXCetusAmount:i,cetusApr:r,myShare:a,totalRewardValue:o,nextStartTime:l,rewardList:c}=ms();return e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsx(Js,{cetusApr:r,myShare:a,totalRewardValue:o,nextStartTime:l,rewardList:c}),e.jsx(tn,{availableXCetusAmount:s,redeemingXCetusAmount:i}),e.jsx(Is,{})]}),e.jsx(Qs,{}),t&&e.jsx(sn,{isOpen:t,onClose:()=>n(!1),availableXCetusAmount:s})]})}function on(){const{currentAccount:t}=U(),{orderListLoading:n,myOrderList:s}=de(),{isAutoRefresh:i,dcaOrderListLoading:r,dcaActiveOrderList:a}=K(),{getTokenAmountValue:o,coinPriceObj:l}=ce(),c=p.useMemo(()=>{let g=B(0);if(i||!n)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(b=>{const{pay_coin:d,target_coin:w,un_claimed_amount:k,remaining_amount:H}=b,_=o(d.coin_type,H),j=o(w.coin_type,k);g=B(g).plus(_).plus(j),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",g.toString())}),g.toString()):"0"},[i,s,t==null?void 0:t.address,n,l]),u=p.useMemo(()=>{let g=B(0);if(i||!r)return(a==null?void 0:a.length)>0&&(t!=null&&t.address)?(a.forEach(b=>{const{inBalance:d,inCoin:w,outBalance:k,outCoin:H}=b,_=o(w.coin_type,d),j=o(H.coin_type,k);g=B(g).plus(_).plus(j),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",g.toString())}),g):"0"},[i,a,t==null?void 0:t.address,r,l]),m=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",u,c),u&&c){let g=B(0);return g=B(g).plus(u).plus(c),g.toString()}return"--"},[u,c]);return{limitTotalTvl:c,dcaTotalTvl:u,orderTotalTvl:m}}function an(){const{currentAccount:t}=U(),{isAutoRefresh:n}=K(),{veNFT:s,veNFTLoading:i,lockCetusListLoading:r}=J(),{getTokenAmountValue:a}=ce(),{coinPriceObj:o}=He();return{xCetusTotalTvl:p.useMemo(()=>{if(n||!i&&!r)return t!=null&&t.address&&s?a($.cetus_coin.coin_type,te(s==null?void 0:s.xcetus_balance,$.cetus_coin.decimals)).toString():"0"},[n,s==null?void 0:s.xcetus_balance,r,i,t==null?void 0:t.address,o])}}const rn="fetch-coin-holding-list",ln="fetch-owner-nft",cn="fetch-active-order-list",dn="fetch-xcetus-base-info";function pn(){const{currentAccount:t}=U(),{getTokenListInfo:n}=xt(),{getLimitUserIndexer:s,getDcaUserIndexer:i}=bs(),{setOrderListLoading:r,setMyOrderList:a}=de(),{setDcaOrderListLoading:o,setDcaActiveOrderList:l,setDcaPastOrderList:c}=K(),{refreshCoinPriceInfo:u}=ze(),{buildDcaOrderList:m}=Bt(),{peripherySdk:g}=me(),{formatLimitOrderList:b}=Kt(),d=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{d.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const w=async()=>{if(t){r(!0);const j=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",j),j)try{return(await g.ClmmSDK.fullClient.getDynamicFieldsByPage(j)).data.map(L=>L.name.value)}catch(C){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",C)}}return[]},k=async()=>{if(t){o(!0);const j=await i(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",j),j)try{return(await g.ClmmSDK.fullClient.getDynamicFieldsByPage(j)).data.map(L=>L.name.value)}catch(C){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",C)}}return[]};return{fetchActiveOrderList:async()=>{try{const j=await w(),C=await k(),T=await g.ClmmSDK.fullClient.batchGetObjects([...j,...C],{showType:!0,showContent:!0}),L=T.filter(R=>{var f,z;return(z=(f=R.data)==null?void 0:f.type)==null?void 0:z.includes("limit_order::LimitOrder")}),A=T.filter(R=>{var f,z;return(z=(f=R.data)==null?void 0:f.type)==null?void 0:z.includes("order::Order")}),P=L.map(R=>vt.buildLimitOrderInfo(R)).filter(R=>R!==void 0).filter(R=>R.status===$e.PartialCompleted||R.status===$e.Running),h=A.map(R=>{var ie,N,ae,ne,pe,Fe,Be,Ue;const f=he(((ie=R.data)==null?void 0:ie.type)||""),z=f.type_arguments[0],Y=f.type_arguments[1];return{in_coin_type:z,out_coin_type:Y,...(ae=(N=R.data)==null?void 0:N.content)==null?void 0:ae.fields,id:(Be=(Fe=(pe=(ne=R.data)==null?void 0:ne.content)==null?void 0:pe.fields)==null?void 0:Fe.id)==null?void 0:Be.id,version:(Ue=R.data)==null?void 0:Ue.version}}),S=new Set;for(const R of P)S.add(R.pay_coin_type),S.add(R.target_coin_type);for(const R of h)S.add(R.in_coin_type),S.add(R.out_coin_type);await n(Array.from(S));const D=await b(P);a(D);const{activeResult:O,pastResult:F}=await m(h);d.current===(t==null?void 0:t.address)&&(l(O),c(F),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",D),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",h)),u(Array.from(S))}catch(j){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",j)}finally{r(!1),o(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),a([]),l([]),c([])}}}function un(){const{currentAccount:t}=U(),{clmmSdk:n}=lt(),{xCetusSdk:s}=me(),{buildFarmsPositionType:i,buildBurnPositionType:r}=Qt(),{setPosBaseList:a,setFullRangePosBaseList:o,setPosBaseListLoading:l}=oe(),{setVeNFT:c,setVeNFTLoading:u,setLockCetusList:m,clearData:g,setLockCetusListLoading:b}=J(),{formatPosBaseList:d}=ut(),w=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{w.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const _=w.current;if(_){l(!0),u(!0);const j=await n.fullClient.getOwnedObjectsByPage(_,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:$.clmm_sdk_options.clmm_pool.package_id},{StructType:i},{StructType:r},{StructType:_s},{StructType:Ss}]}});let C=await d(j);a(C),l(!1),(C==null?void 0:C.length)==0&&o([]);const T=Ts(j.data);if(T&&_===w.current){c(T,_);const L=await vs(j.data,s);console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList:",L),m(L)}else b(!1);return{veNFT:T,posBaseList:C}}}catch(_){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",_),_ instanceof TypeError&&(l(!1),a([]))}finally{l(!1),u(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{a([]),g()}}}function xn(){const{currentAccount:t}=U(),{peripherySdk:n}=me(),{clmmSdk:s}=lt();ut();const{getPosPoolsOriginalObj:i,getPosPoolsRelatedData:r}=Zt(),{getPosLiquidityData:a}=Jt(),{setPosLiquidityData:o,setFarmsPosRewardsData:l,setFarmsPosRewardsDataLoading:c,setPosRewardsData:u,setPosRewardsDataLoading:m,setPosFeeData:g,setPosFeeDataLoading:b}=oe(),{formatFarmsRewardsData:d}=es(),{formatPosRewardsData:w}=ts(),{formatPosFeeData:k}=ss(),{posBaseList:H,setShowPosListLength:_,setMyPosYieldValue:j}=oe(),{refreshCoinPriceInfo:C}=ze(),T=async y=>{var D;const P=y.filter(O=>O.posType==="farms"&&O.farmsPool),h=await i(y);if(r(y,h),((D=Object.keys(h))==null?void 0:D.length)===0)throw o({}),new Error("No pool data found");a(y,h);const S=new kt;P.length>0&&P.forEach(O=>{n.Farms.buildCalculateFarmingReward({pool_id:O.farmsPool,position_nft_id:O.id},S)}),y.forEach(O=>{s.Rewarder.buildFetchPosFee({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB},S)}),y.filter(O=>O.posType!=="farms").forEach(O=>{const F=h[O.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB,rewarderInfo:F.rewarder_infos},S)});try{c(!0),m(!0),b(!0);const O=await s.fullClient.devInspectTransactionBlock({transactionBlock:S,sender:Lt("0x0")}),F=n.Farms.parsedPosRewardData(O),R=s.Rewarder.parsedPosRewardData(O),f=s.Rewarder.parsedPosFeeData(O);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:F,clmmRewardData:R,clmmFeeData:f});const z=await d(F);l(z);const Y=await w(Object.values(R).map(N=>{const ae=h[y.find(ne=>ne.posId===N.position_id).clmmPool];return{poolAddress:ae.pool_address,positionId:N.position_id,rewarderAmountOwed:N.rewarder_amount.map((ne,pe)=>({coin_address:ae.rewarder_infos[pe].coinAddress,amount_owed:new Se(ne)}))}}));u(Y);const ie=await k(Object.values(f).map(N=>({position_id:N.position_id,feeOwedA:new Se(N.fee_owned_a),feeOwedB:new Se(N.fee_owned_b)})),y);g(ie),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:ie,posRewardsData:Y,posFarmsRewardsObj:z}),L(Y,z)}catch(O){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",O)}finally{c(!1),m(!1),b(!1)}},L=async(y,P)=>{const h=[];if(H.length>0){H.map(D=>{h.push(he(D==null?void 0:D.coinTypeA).full_address),h.push(he(D==null?void 0:D.coinTypeB).full_address);const O=y[D==null?void 0:D.posId]||[],F=P[D==null?void 0:D.id]||[],R=O.concat(F);R==null||R.map(f=>{var z;Pt(f==null?void 0:f.display_amount_owed).gt(0)&&h.push(he((z=f==null?void 0:f.token)==null?void 0:z.coin_type).full_address)})});const S=Array.from(new Set(h));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",S),C(S)}};return{fetchPosRelatedData:T,resetUserData:()=>{o({}),l({}),u({}),g({})}}}function gn(){const{currentAccount:t}=U(),{setXCetusManager:n,setDividendManager:s}=J(),{xCetusSdk:i}=me();return{fetchXCetusBaseInfo:async a=>{try{const{xcetus:o,xcetus_dividends:l}=$.xcetus_sdk_options,{dividend_manager_id:c}=We(l),{xcetus_manager_id:u}=We(o),m=await i.fullClient.batchGetObjects([u,c],{showType:!0,showContent:!0}),g=m.find(d=>{var w,k;return(k=(w=d.data)==null?void 0:w.type)==null?void 0:k.includes("xcetus::XcetusManager")});if(g){const d=Ve(g),w={id:d.id.id,index:Number(d.index),has_venft:{handle:d.has_venft.fields.id.id,size:d.has_venft.fields.size},nfts:{handle:d.nfts.fields.id.id,size:d.nfts.fields.size},total_locked:d.total_locked,treasury:d.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",w),n(w)}const b=m.find(d=>{var w,k;return(k=(w=d.data)==null?void 0:w.type)==null?void 0:k.includes("dividend::DividendManager")});if(b){const d=Ve(b),w=rt.buildDividendManager(d);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",w),i.XCetusModule.updateCache(`${c}_getDividendManager`,w),s(w)}}catch(o){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",o)}}}}function hn(t){const{currentAccount:n}=U(),{fetchCoinHoldingList:s,resetUserData:i}=ht(),{fetchPosRelatedData:r,resetUserData:a}=xn(),{fetchActiveOrderList:o,resetUserData:l}=pn(),{setAutoRefreshCount:c}=K(),{fetchOwnerNFT:u,resetUserData:m}=un(),{fetchXCetusBaseInfo:g}=gn(),{addTask:b,removeTask:d}=Ls(),[w,k]=p.useState([]),H=p.useRef(n),{fetchOwnerLockCetusList:_}=ks(),{setOrderListLoading:j}=de(),{setLockCetusListLoading:C}=J(),{setPosBaseListLoading:T}=oe(),{setIsCoinHoldingLoading:L}=ye(),A=()=>{i(),a(),l(),m()};p.useEffect(()=>{var F,R;n?((F=H.current)!=null&&F.address&&((R=H.current)==null?void 0:R.address)!==(n==null?void 0:n.address)&&(c(!1),A(),w.forEach(f=>{d(f.id)})),D()):(A(),w.forEach(f=>{d(f.id)})),H.current=n},[n==null?void 0:n.address]);const y={id:rn,run:s},P={id:ln,run:u,onSuccess:F=>{const{veNFT:R,posBaseList:f}=F;r(f),R&&(n!=null&&n.address)&&_(n==null?void 0:n.address)}},h={id:dn,run:g},S={id:cn,run:o},D=()=>{const F=[];j(!0),C(!0),T(!0),L(!0),t==="wallet"?F.push(y,P,S,h):t==="liquidity"?F.push(P,y,S,h):t==="orders"?F.push(S,y,P,h):F.push(P,h,y,S),k(F),F.forEach(R=>{b(R)})};return{refreshTask:()=>{n&&(w.forEach(F=>{d(F.id)}),D())}}}const ge=t=>t?le(t,2):"$--",fn=(...t)=>t.reduce((n,s)=>n.plus(s&&+s?s:0),B(0)).toString();function mo(){const{tab:t}=ls(),{currentAccount:n,onWalletModal:s}=U(),i=Ae(),{posBaseListLoading:r,posLiquidityDataLoading:a}=oe(),{holdingsTotalUsd:o,isCoinPriceLoading:l,isCoinHoldingLoading:c}=ye(),{clmmTotalTvl:u}=as(),{orderTotalTvl:m}=on(),{orderListLoading:g}=de(),{isAutoRefresh:b,dcaOrderListLoading:d,setAutoRefreshCount:w,resetAutoRefreshCount:k}=K(),{xCetusTotalTvl:H}=an(),{lockCetusListLoading:_,veNFTLoading:j,veNFT:C}=J(),T=p.useMemo(()=>t||"wallet",[t]),{refreshTask:L}=hn(T),A=!b&&(c||l),y=!b&&(r||a),P=!b&&(g||d),h=!b&&(_||j),S=p.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",o,u,m,H),{wallet:{totalValue:ge(o),isLoading:A},liquidity:{totalValue:ge(u),isLoading:y},orders:{totalValue:ge(m),isLoading:P},xCetus:{totalValue:ge(H),isLoading:h}}),[o,u,m,H,A,y,P,h]),D=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],O=p.useMemo(()=>fn(H,u,m,o),[H,u,m,o]);p.useEffect(()=>k(!1),[]);const[F,R]=p.useState(!1);p.useEffect(()=>{R(!0)},[]);const{isApp:f}=V();return f?e.jsx(Ps,{totalValue:O,onRefreshTask:L,isLoading:!b&&(j||r||g||d),children:e.jsx(Ge,{tabList:D,activeTab:T,tabData:S,onClickTab:z=>i(`/profile?tab=${z}`)})}):e.jsx(E,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:F?n!=null&&n.address?e.jsxs(E,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Us,{handleRefresh:z=>{w(!z),L()},totalValue:O,isLoading:!b&&(j||r||g||d)}),e.jsx(Ge,{tabList:D,activeTab:T,tabData:S,onClickTab:z=>i(`/profile?tab=${z}`)}),T==="wallet"&&e.jsx(qs,{}),T==="liquidity"&&e.jsx(Ms,{}),T==="orders"&&e.jsx(Bs,{}),T==="xCetus"&&e.jsx(nn,{})]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>s(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Oe,{})})})}export{mo as default};
//# sourceMappingURL=Profile-DnniT9nV.js.map

import{A as q}from"./aggregator-CyJUJwdf.js";import{u as bs}from"./useTransaction-Cc765MUE.js";import{u as De}from"./global-DaL79zhi.js";import{i as js,u as ys}from"./index-C2tUnNb3.js";import{u as ws}from"./useAccountBalance-CeUdpiKX.js";import{o as ms,aW as _s,v as Fe,bJ as Le,t as Ss,G as M,E as vs,bK as fe,aI as Rs,z as U,a2 as Ee,bL as As,k as Is,Z as Ne,V as be,C as zs,I as se,d as Ts,a as je,e as F,h as Hs,X as Ve,bM as Ge,Y as Ps,F as $s,f as Ws,q as Fs}from"./index-CJa1Q5Eu.js";import{a,ar as Ls,aa as Es,j as e,H as d,T as f,C as ee,p as A,V as I,f as z,P as Ke,h as qe,k as Ye,m as ke,n as Je,af as Bs,S as P,W as Ms,X as Us,Y as Cs,Z as Os,$ as Ds,a0 as Ns,q as ce}from"./vendor-BFGDaAdA.js";import{u as ye}from"./useToken-DcLYM1a2.js";import{u as Be}from"./useTokenBalance-CeWcIfEX.js";import{u as Vs}from"./useFindBestRouting-u1qIkehW.js";import{b as Xe,A as ge,c as Gs}from"./useSwapHelper-BTHj2AcR.js";import{v as Me,M as Ks,c as qs,u as Ze}from"./usePriceImpact-DhEpoyWT.js";import{C as we}from"./CurrentPrice-DQNOgFSm.js";import{H as Ys}from"./HighlightText-fkyigc44.js";import{g as pe}from"./index-BleV78I3.js";import{A as Ue}from"./SingleTokenInfo-DvfSTCmR.js";import{H as Ce}from"./HTextLabelBox-BT9c1ibT.js";import{T as ks}from"./TradeConfirmAmountInfo-CcbHRYfi.js";import{b as Js}from"./TradeInputGroup-DATFBLnD.js";var Xs=1,Zs=4;function Qs(t){return Js(t,Xs|Zs)}function Oe(t){const[p,s]=a.useState(),r=async x=>{if(x.is_verified===void 0?x.is_trusted:x.is_verified)return!1;try{const i=await js(x.coin_type);return console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:24 ~ checkIsScamsCoin ~ isScamsCoin:",i),i}catch(i){console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:19 ~ checkTokenScams ~ error:",i)}return!1};return a.useEffect(()=>{s(void 0),t&&r(t).then(x=>{s(x)})},[t==null?void 0:t.coin_type]),{isScamsCoin:p}}const er="0xeb863165a109f7791a3182be08aff1438ab2a429314fc135ae19d953afe1edd6";function Ir(t,p){const{fromCoin:s,toCoin:r,setFromCoin:x,setToCoin:o,setToAmount:i,fromAmount:h,toAmount:c,setFromAmount:l,routerData:b,setFindRouterLoading:j,setRouterData:u,setByAmountIn:y,byAmountIn:w}=t,{from:_,to:g}=Ls(),{findBestRouters:S,checkProvidersKeys:v}=Vs(),{fetchTokenPrices:T,getTokenAmountValue:H}=ms(),{slippage:$,mevProtect:C,maxCapForGas:le,transactionMode:D,customGasPrice:re}=De(),{aggregatorSDK:xe}=_s(),R=Es(),{fetchTokenInfo:W}=ye(),[ae,te]=a.useState(!1),{signAndExecuteTransaction:ue,transactionConfirmation:rs}=bs(),{providersSwitchStates:me,supportOrderSplit:or}=ys(),{fetchAccountBalance:ts}=ws(),{balanceInfo:is}=Be(s),{balanceInfo:os}=Be(r),ns=H(s==null?void 0:s.coin_type,h),cs=H(r==null?void 0:r.coin_type,c),[_e,Se]=a.useState(""),ve=a.useRef(""),ie=a.useRef(!0),Y=a.useRef(""),k=a.useRef(""),J=a.useRef(),X=a.useRef(),Re=a.useRef([]);a.useEffect(()=>{J.current=s},[s]),a.useEffect(()=>{X.current=r},[r]),a.useEffect(()=>{ve.current=_e},[_e]),a.useEffect(()=>{ie.current=w},[w]),a.useEffect(()=>{Y.current=h},[h]),a.useEffect(()=>{k.current=c},[c]);const ps=a.useMemo(()=>String(g)+String(_),[_,g]);a.useEffect(()=>{p||ls()},[ps]);const ls=a.useCallback(()=>{!_&&!g?(x(Fe.clmm_swap.from_coin),o(Fe.clmm_swap.to_coin),R("/swap")):(_&&Le(_)?W(_).then(n=>{n?(n==null?void 0:n.coin_type)!==(s==null?void 0:s.coin_type)&&x(n):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):x(void 0),g&&Le(g)?W(g).then(n=>{n?(n==null?void 0:n.coin_type)!==(r==null?void 0:r.coin_type)&&o(n):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):o(void 0))},[_,g]),Ae=Ss(async(n,m,L)=>{if(J.current&&X.current&&+n){const O=p?Object.entries(q).map(([B,G])=>B):Object.entries(me).filter(([B,G])=>G===!0).map(([B,G])=>B);(+Y.current||+k.current)&&j(!0);const V=await v(O),ze=vs(n,m?J.current.decimals:X.current.decimals),E=await S({fromToken:J.current,toToken:X.current,amount:ze.toString(),providersKeys:V,by_amount_in:m,uuid:L});j(!1),ve.current===L&&(Re.current=V,m?+Y.current?(i(E.toAmountUi||""),u(E)):i(""):+k.current?(l(E.fromAmountUi||"ÃŸ"),u(E)):l(""))}else Z(!m)},500),xs=(n,m,L=!1)=>{if(y(m),m?(l(n),L&&i("")):(i(n),L&&l("")),+n){const O=Me();Se(O),Ae(n,m,O)}else j(!1),u(void 0),n!=="0"?Z():m?i(""):l("")},N=()=>{const n=ie.current?Y.current:k.current;if(console.log("ðŸš€ ~ file: useSwap.ts:273 ~ reCalculateRouteData ~ amount:",n,ie.current,Y.current,k.current),+n){const m=Me();Se(m),Ae(n,ie.current,m)}};a.useEffect(()=>{N()},[JSON.stringify(me)]);const as=a.useCallback((n,m=!0)=>{Z(),p?m?(n&&M((n==null?void 0:n.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")&&o(s),x(n)):(n&&M((n==null?void 0:n.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")&&x(r),o(n)):m?n&&M((n==null?void 0:n.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")?R(`/swap/${n==null?void 0:n.coin_type}/${s==null?void 0:s.coin_type}`):R(`/swap/${n==null?void 0:n.coin_type}/${r==null?void 0:r.coin_type}`):n&&M((n==null?void 0:n.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")?R(`/swap/${r==null?void 0:r.coin_type}/${n==null?void 0:n.coin_type}`):R(`/swap/${s==null?void 0:s.coin_type}/${n==null?void 0:n.coin_type}`)},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),{amountLimit:us}=Xe($,b),Z=n=>{n===void 0?(l(""),i("")):n?l(""):i(""),j(!1),u(void 0)};a.useEffect(()=>{Ie()},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const Ie=()=>{const n=[];s&&n.push(s.coin_type),r&&n.push(r.coin_type),n.length>0&&T(n)},ds=()=>({...b}),hs=async n=>{var L,O;let m;try{const{routerData:V,byAmountIn:ze,fromAmountUi:E,toAmountUi:B}=n,G=new Rs,K={routers:V,partner:er,txb:G,slippage:Number($),refreshAllCoins:!0};te(!1),console.log("ðŸš€ ~ file: useSwap.ts:261 ~ doSwapAction ~ params:",K),m={isSwapWidget:p,actionType:"swap",getShowInfo:(He,de)=>{const he=`Swapping ${U(E)} ${s==null?void 0:s.symbol} for ${U(B)} ${r==null?void 0:r.symbol}`,Q={modalDescriptionText:he,toastTitleText:he};if(He==="success"){let Pe=E,$e=B;de&&(Pe=Ee(de,s)||E,$e=Ee(de,r)||B);const We=`Swapped ${U(Pe)} ${s==null?void 0:s.symbol} for ${U($e)} ${r==null?void 0:r.symbol}`;Q.toastDescriptionContent=We,Q.modalDescriptionText=We,Q.toastTitleText="Swap Successful"}return He==="rejected"&&(Q.toastTitleText=he.replace("Swapping","Swap")),Q}},p||rs(m);const Te=await ue(async()=>(await xe.fastRouterSwap(K),G),m,{useMev:C,useFastMode:D==="Fast Mode",maxCapForGas:le,customGasPrice:re,msafeParams:{action:"AggregatorSwap",txbParams:{...K,routers:As(K==null?void 0:K.routers)}},otherParams:{routerData:t.routerData,providerKey:Re.current,from:(L=J.current)==null?void 0:L.coin_type,to:(O=X.current)==null?void 0:O.coin_type}});return console.log("ðŸš€ ~ file: useSwap.ts:272 ~ doSwapAction ~ res:",Te),Te?(Z(),ts(),!0):(N(),!1)}catch(V){console.log("ðŸš€ ~ doSwapAction ~ error text:",V)}},{isScamsCoin:oe}=Oe(s),{isScamsCoin:ne}=Oe(r),fs=a.useMemo(()=>{if(!(!oe&&!ne)){if(oe&&ne&&(s!=null&&s.symbol)&&(r!=null&&r.symbol))return`${s==null?void 0:s.symbol} and ${r==null?void 0:r.symbol} are`;if(oe&&(s!=null&&s.symbol))return`${s==null?void 0:s.symbol} token is `;if(ne&&(r!=null&&r.symbol))return`${r==null?void 0:r.symbol} token is `}},[oe,ne,s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),gs=async n=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useSwap.ts:491 ~ onReverseClick ~ isOpenAggregatorMode:",n),n?(p?(x(r),o(s)):(x(r),o(s),R(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`)),l(c),i(""),y(!0),await fe(200),N()):w?(p?(x(r),o(s)):R(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`),l(""),i(h),y(!1),await fe(200),N()):(p?(x(r),o(s)):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`),l(c),i(""),y(!0),await fe(200),N())};return a.useEffect(()=>()=>{p||(x(void 0),o(void 0)),l(""),i("")},[]),{handleSelectToken:as,handleAmountChange:xs,fromAmount:h,toAmount:c,fromAmountValue:ns,toAmountValue:cs,amountLimit:us,getSwapSecondaryData:ds,reCalculateRouteData:N,fromBalanceInfo:is,toBalanceInfo:os,doSwapAction:hs,scamsText:fs,refreshMarketPrice:Ie,isOpenConfirmModel:ae,setIsOpenConfirmModel:te,resetInputAmount:Z,onReverseClick:gs}}function zr(t,p,s,r,x,o){const{currentAccount:i}=Is(),h=a.useMemo(()=>{const c={text:"Swap",disabled:!1};if(!(i!=null&&i.address))return c.text="Connect Wallet",c.disabled=!1,c;if(!r||!x)return c.text="Select a token",c.disabled=!0,c;if(!+t&&!+p)return c.text="Enter an amount",c.disabled=!0,c;if(o&&o.errorCode){if(o.errorCode===ge.InsufficientLiquidity)return c.text="Insufficient liquidity for this trade",c.disabled=!0,c;if(o.errorCode===ge.NoRouter||o.errorCode===ge.HoneyPot)return c.text="No Available Route",c.disabled=!0,c}return+t&&Ne(t).gt(s||0)?(c.disabled=!0,c.text=`Insufficient ${be(r==null?void 0:r.symbol,10)} Balance`,c):((!+t||!+p)&&(c.disabled=!0),c)},[i==null?void 0:i.address,t,p,s,o==null?void 0:o.errorCode,r,x]);return{btnText:h.text,btnDisabled:h.disabled}}function Qe(t){const{showIncalculable:p,fromToken:s,toToken:r,marketPrice:x,priceImpact:o,sources:i=[],isWidget:h=!1,isLoading:c}=t;return e.jsxs(d,{justify:"space-between",w:"100%",gap:"4px",flexWrap:"wrap",children:[e.jsxs(d,{w:"132px",alignItems:"end",gap:"4px",children:[e.jsx(f,{whiteSpace:"nowrap",fontSize:h?"12px":"14px",h:"20px",lineHeight:"20px",fontWeight:"500",children:"Price Difference"}),e.jsx(zs,{tooltip:e.jsx(sr,{marketPrice:x,sources:i,fromToken:s,toToken:r,showIncalculable:p}),children:e.jsx(ee,{children:e.jsx(se,{xlinkHref:"#icon-icon_tips",svgW:"20px",svgH:"20px"})})})]}),e.jsx(A,{isLoaded:!c,h:"20px",children:e.jsxs(d,{justify:"flex-end",h:"20px",children:[e.jsx(f,{maxW:h?`calc(90vw - 56px - ${24*((i==null?void 0:i.length)||0)}px)`:"unset",flex:"1",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:o==null?void 0:o.textColor,fontWeight:"500",fontSize:h?"12px":"14px",children:o!=null&&o.priceImpactText&&!p?o==null?void 0:o.priceImpactText:"Incalculable"}),!p&&(i==null?void 0:i.map(l=>e.jsx(Ks,{market:l},l)))]})})]})}function sr(t){const{marketPrice:p,sources:s,fromToken:r,toToken:x,showIncalculable:o}=t;return e.jsxs(I,{className:"no-close-widget-flag",w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(f,{color:"content_text",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The difference between the market price and estimated price due to trade size."}),!o&&e.jsxs(I,{w:"100%",align:"flex-start",children:[e.jsx(f,{fontSize:"12px",color:"text_caption",children:"Market price sources:"}),p?e.jsx(we,{fontSize:"12px",fromToken:r,toToken:x,fromValue:"1",toValue:p,color:"text_caption"}):e.jsx(f,{color:"primary_yellow",fontSize:"12px",children:"Price is unknown"})]}),p&&!o&&e.jsxs(d,{w:"100%",children:[e.jsx(f,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:"Market price sources:"}),e.jsx(f,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:s.map(i=>qs[i]+"  ")})]})]})}function Tr(t){const{fromCoin:p,toCoin:s,findRouterLoading:r,isWidget:x=!1,routerData:o,bg:i="primary_opacity.10"}=t,{marketPrice:h,priceImpact:c,sources:l,priceImpactTextInfo:b,showIncalculable:j}=Ze(p,s,o==null?void 0:o.fromAmountUi,o==null?void 0:o.toAmountUi);return e.jsxs(I,{w:"100%",p:"8px",gap:"8px",bg:i,borderRadius:"12px",align:"flex-start",children:[e.jsx(we,{fromToken:p,toToken:s,fromValue:o==null?void 0:o.fromAmountUi,toValue:o==null?void 0:o.toAmountUi,isLoading:r,color:"text_caption",fontSize:x?"12px":"14px"}),!j&&Ts(c).lte(-30)&&e.jsxs(d,{w:"100%",justify:"flex-start",children:[e.jsx(se,{xlinkHref:"#icon-warning",svgFill:"primary_red",svgHover:"primary_red",fontSize:"16px"}),e.jsx(f,{color:"primary_red",fontSize:"12px",lineHeight:"20px",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})]}),e.jsx(Qe,{fromToken:p,isWidget:x,toToken:s,marketPrice:h,priceImpact:b,isLoading:r,sources:l,showIncalculable:j})]})}function Hr({scamsText:t}){return e.jsxs(I,{borderRadius:"8px",border:"1px solid",borderColor:"border",pt:"12px",maxW:"480px",children:[e.jsxs(d,{children:[e.jsx(se,{xlinkHref:"#icon-icon_priceupdated",svgFill:"primary_yellow",svgHover:"primary_yellow",svgW:"20px",svgH:"20px"}),e.jsx(f,{color:"primary_yellow",children:"Alert"})]}),e.jsx(z,{bg:"card_bg",borderRadius:"8px",p:"11px",children:e.jsx(Ys,{text:`${t}  detected to have Deny List feature. It's an optional feature on Sui designed for regulated coins (learn more). However, it could be misused by HoneyPot scams, which may restrict users from selling the tokens after buying. Please be cautious.`,keywords:["learn more"],onKeywordClick:()=>{window.open("https://docs.sui.io/guides/developer/coin/regulated","_blank")}})})]})}const es=({data:t,children:p,loading:s,isSwapWidget:r})=>{var l,b,j;const{getTokenListInfo:x}=ye(),{isApp:o}=je(),[i,h]=a.useState(new Map),c=async()=>{var u,y,w;if(t&&(t!=null&&t.routers)&&((u=t==null?void 0:t.routers)==null?void 0:u.length)>0){const _=[];(w=(y=t==null?void 0:t.routers[0])==null?void 0:y.paths)==null||w.forEach(S=>{_.push(S==null?void 0:S.from_type),_.push(S==null?void 0:S.to_type)});const g=await x(_);g&&h(g)}};return a.useEffect(()=>{c()},[t==null?void 0:t.routers]),(t==null?void 0:t.providers)&&e.jsx(A,{isLoaded:!s,minW:"128px",minH:"20px",lineHeight:"20px",children:e.jsxs(d,{w:"100%",gap:"4px",align:"center",justify:"flex-end",wrap:"wrap",children:[(t==null?void 0:t.router_summery)!=="1 Streams"?e.jsx(f,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",overflowWrap:"break-word",children:t==null?void 0:t.router_summery}):e.jsx(e.Fragment,{children:e.jsx(f,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",textAlign:"right",overflowWrap:"break-word",children:(b=(l=t==null?void 0:t.routers[0])==null?void 0:l.paths)==null?void 0:b.map((u,y)=>{var w,_,g;return y===0?`${(w=i==null?void 0:i.get(u==null?void 0:u.from_type))==null?void 0:w.symbol} > ${(_=i==null?void 0:i.get(u==null?void 0:u.to_type))==null?void 0:_.symbol}`:(g=i==null?void 0:i.get(u==null?void 0:u.to_type))==null?void 0:g.symbol}).join(" > ")})}),(j=t==null?void 0:t.providers)==null?void 0:j.map(u=>o&&p?e.jsx(F,{w:"16px",h:"16px",imageUrl:q[u].logo}):e.jsxs(Ke,{isLazy:!0,trigger:o?"click":"hover",children:[e.jsx(qe,{children:e.jsx(z,{children:e.jsx(F,{w:"16px",h:"16px",imageUrl:q[u].logo})})}),e.jsx(Ye,{children:e.jsx(ke,{w:"unset",children:e.jsx(Je,{fontSize:"12px",children:q[u].name})})})]},u)),p]})})};function ss({children:t,fromToken:p,toToken:s,poolAddress:r}){const{isApp:x}=je(),{getExplorerUrl:o}=Hs();return e.jsxs(Ke,{isLazy:!0,trigger:x?"click":"hover",children:[e.jsx(qe,{children:t}),e.jsx(Ye,{children:e.jsx(ke,{w:"unset",minW:"unset",children:e.jsx(Je,{p:"12px",children:e.jsxs(I,{w:"100%",gap:"12px",className:"no-close-widget-flag",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{w:"100%",justify:"space-between",h:"20px",p:"0",children:[e.jsx(d,{children:e.jsx(f,{fontSize:"12px",color:"text_caption",children:"Pool"})}),e.jsx(Ue,{address:r,color:"text_caption",showLink:!!x,onClickLink:()=>{window.open(o(r,"poolAddress"),"_blank")}})]}),e.jsx(Bs,{orientation:"horizontal",borderColor:"border"})]}),[p,s].map(i=>e.jsxs(d,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsxs(d,{children:[e.jsx(F,{imageUrl:i==null?void 0:i.logo_url,w:"24px",h:"24px",coinType:i?i==null?void 0:i.coin_type:"",showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(I,{align:"flex-start",gap:"0px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",fontWeight:"500",children:be((i==null?void 0:i.symbol)||"",10)})})]}),e.jsx(Ue,{color:"primary_gray",showLink:!!x,address:i==null?void 0:i.coin_type,onClickLink:()=>window.open(o(i==null?void 0:i.coin_type,"coin"))})]},i==null?void 0:i.coin_type))]})})})})]})}const rr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:x,loading:o})=>e.jsxs(I,{w:"100%",align:"center",p:"20px 0 8px",children:[e.jsx(d,{children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(s||"0")}),e.jsx(f,{children:t==null?void 0:t.symbol})]})}),e.jsx(z,{w:"100%",bg:"bg_secondary",p:"20px 8px",borderRadius:"8px",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"},_after:{content:'""',position:"absolute",bottom:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"}},children:e.jsx(I,{gap:o?"56px":"16px",border:"1px dashed",borderColor:"border",borderRadius:"8px",p:o?"36px 0":"16px 0",children:x==null?void 0:x.map((i,h)=>e.jsxs(d,{w:"100%",gap:"0",justify:"space-between",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}},children:[!o&&e.jsx(ee,{borderRadius:"12px",h:"24px",bg:"h5_router_percentage_bg",p:"6px 12px",ml:"20px",zIndex:2,children:e.jsx(f,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(i.percentage)})}),e.jsx(I,{w:"100%",align:"center",sx:i.paths.length>1&&!o?{position:"relative",_before:{content:'""',backgroundColor:"bg_secondary",position:"absolute",top:"20px",right:"16px",width:"calc(100% - 32px)",height:"calc(100% - 40px)",border:"1px dashed",borderColor:"border",borderRadius:"8px",zIndex:2}}:{},children:o?e.jsx(e.Fragment,{children:e.jsxs(d,{gap:"8px",position:"absolute",h:"40px",top:"-20px",borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:2,children:[e.jsxs(d,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):i.paths.map(c=>{var l,b,j,u,y;return e.jsx(ss,{fromToken:c==null?void 0:c.fromToken,toToken:c==null?void 0:c.toToken,poolAddress:c==null?void 0:c.pool_address,children:e.jsxs(d,{borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:3,children:[e.jsx(Ve,{coinAIconUrl:(l=c.fromToken)==null?void 0:l.logo_url,coinBIconUrl:(b=c.toToken)==null?void 0:b.logo_url,w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(j=c.fromToken)==null?void 0:j.coin_type,coinBCoinType:(u=c.toToken)==null?void 0:u.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(y=q[c.provider])==null?void 0:y.name}),!!+c.fee_rate&&e.jsx(ee,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(Ge(c.fee_rate))})})]},c.to_type)},c.to_type)})})]},h))})}),e.jsx(d,{children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(r||"0")}),e.jsx(f,{children:p==null?void 0:p.symbol})]})})]}),tr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:x,loading:o})=>{var i;return e.jsxs(I,{w:"100%",gap:"12px",children:[e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(d,{borderRadius:"14px",h:"28px",p:"0 12px 0 0 ",children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(s||"0")}),e.jsx(f,{children:t==null?void 0:t.symbol})]})}),e.jsx(d,{borderRadius:"14px",h:"28px",p:"0 0 0 12px",children:o?e.jsxs(e.Fragment,{children:[e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]}),e.jsx(P,{w:"28px",h:"28px"})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{color:"text_caption",children:U(r||"0")}),e.jsx(f,{children:p==null?void 0:p.symbol}),e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"})]})})]}),e.jsxs(z,{w:"100%",bg:"bg_secondary",p:"32px 24px",borderRadius:"12px",position:"relative",children:[e.jsx(z,{position:"absolute",left:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"0px 100px 100px 0px",zIndex:2,children:o?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"24px",h:"24px",coinType:t==null?void 0:t.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(z,{position:"absolute",right:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"100px 0px 0px 100px",zIndex:2,children:o?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"24px",h:"24px",coinType:p==null?void 0:p.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(I,{gap:"32px",border:"1px dashed",borderBottom:((i=x||[])==null?void 0:i.length)>1?"1px dashed":"none",borderColor:"border",borderRadius:"8px",children:x==null?void 0:x.map((h,c)=>e.jsxs(d,{mt:c===0?"-20px":0,mb:c===x.length-1?"-20px":0,w:"100%",justify:"space-between",gap:"0",sx:c>0&&c<x.length-1?{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}}:{position:"relative"},children:[!o&&e.jsx(ee,{borderRadius:"12px",h:"24px",bg:"card_bg",p:"8px 12px",ml:"24px",zIndex:2,position:"absolute",children:e.jsx(f,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(h.percentage)})}),e.jsx(d,{h:"40px",w:"100%",justify:"center",zIndex:2,children:o?e.jsx(e.Fragment,{children:e.jsxs(d,{gap:"8px",position:"absolute",h:"40px",borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsxs(d,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(z,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):h.paths.map(l=>{var b,j,u,y,w;return e.jsx(ss,{fromToken:l==null?void 0:l.fromToken,toToken:l==null?void 0:l.toToken,poolAddress:l==null?void 0:l.pool_address,children:e.jsxs(d,{borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsx(Ve,{coinAIconUrl:(b=l.fromToken)==null?void 0:b.logo_url,coinBIconUrl:(j=l.toToken)==null?void 0:j.logo_url,variant:"",p:"0px",w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(u=l.fromToken)==null?void 0:u.coin_type,coinBCoinType:(y=l.toToken)==null?void 0:y.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(w=q[l.provider])==null?void 0:w.name}),!!+l.fee_rate&&e.jsx(ee,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(Ge(l.fee_rate))})})]})},l.to_type)})})]},c))})]})]})},ir=({isOpen:t,onClose:p,data:s,fromCoin:r,toCoin:x,fromAmount:o,toAmount:i})=>{const{isApp:h}=je(),{getTokenListInfo:c}=ye(),[l,b]=a.useState(new Map),j=async S=>{const v=await c(S);v&&(v==null?void 0:v.size)>0&&b(v)};Ps(()=>{var S,v;if(s!=null&&s.routers&&((S=s==null?void 0:s.routers)==null?void 0:S.length)>0){const T=[];(v=s==null?void 0:s.routers)==null||v.forEach(H=>{H.paths.forEach($=>{T.includes($.from_type)||T.push($.from_type),T.includes($.to_type)||T.push($.to_type)})}),j(T)}},[s==null?void 0:s.routers]);const u=a.useMemo(()=>{var S,v;return!(s!=null&&s.routers)||((S=s==null?void 0:s.routers)==null?void 0:S.length)===0||(l==null?void 0:l.size)===0?[]:(v=s==null?void 0:s.routers)==null?void 0:v.map(T=>({...T,paths:T.paths.map(H=>({...H,fromToken:l==null?void 0:l.get(H.from_type),toToken:l==null?void 0:l.get(H.to_type)}))}))},[s==null?void 0:s.routers,l]),y={fromToken:r,toToken:x,fromAmount:o,toAmount:i,routes:u},[w,_]=a.useState(!0),g=a.useRef(null);return a.useEffect(()=>(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{_(!1)},200),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),e.jsxs(Ms,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:p,isCentered:!0,children:[e.jsx(Us,{}),e.jsxs(Cs,{maxW:"1200px",w:h?"calc(100vw - 32px)":"880px",children:[e.jsx(Os,{mr:"-10px",children:e.jsxs(d,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(f,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Route"}),e.jsxs(d,{gap:"0",align:"center",children:[e.jsx(es,{data:s}),e.jsx(Ds,{mt:"0",position:"static"})]})]})}),e.jsx(Ns,{p:{base:"8px 16px",lg:"16px"},children:h?e.jsx(rr,{...y,loading:w}):e.jsx(tr,{...y,loading:w})})]})]})};function Pr(t){const{formatSwapRouter:p,findRouterLoading:s,fromAmount:r,toAmount:x,fromCoin:o,toCoin:i,isSwapWidget:h=!1,handleSwapWidgetRouterClick:c}=t,[l,b]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(d,{w:"100%",justify:"space-between",p:"0 8px",children:[e.jsx(f,{fontSize:h?"12px":"14px",fontWeight:"500",whiteSpace:"nowrap",children:"Auto Router"}),e.jsx(z,{onClick:j=>{$s(j),h?c&&c():b(!l)},cursor:"pointer",children:e.jsx(es,{data:p,loading:s,isSwapWidget:h,children:e.jsx(se,{xlinkHref:"#icon-icon_spread",fontSize:"16px"})})})]}),l&&!h&&e.jsx(ir,{isOpen:l,onClose:()=>b(!1),fromCoin:o,toCoin:i,data:p,fromAmount:r,toAmount:x})]})}function $r(t){const{lastRouterData:p,fromCoin:s,toCoin:r,onClose:x,data:o,onSubmitClick:i,isWidget:h}=t,{slippage:c}=De(),l=a.useRef(!1),[b,j]=a.useState(o),{fromAmountUi:u,toAmountUi:y,byAmountIn:w}=b,{amountLimit:_}=Xe(c,b),[g,S]=a.useState(!1),{priceImpactTextInfo:v,marketPrice:T,sources:H,showPriceImpactTips:$,showPriceImpactWarn:C,showIncalculable:le}=Ze(s,r,u,y),{priceAcceptRouterData:D}=Gs(b,p),[re,xe]=a.useState(!1),R=a.useMemo(()=>D!==void 0,[D]),W=a.useMemo(()=>w?r:s,[w]),ae=()=>{if(D){if(l.current)return;l.current=!0;const ue=Qs(D);j(ue),setTimeout(()=>{l.current=!1},300)}},te=a.useMemo(()=>g?!1:!!C,[g,C]);return e.jsxs(I,{textAlign:"center",p:"0px",w:"100%",children:[e.jsxs(I,{w:"100%",gap:"16px",pl:"16px",pr:"16px",pb:"16px",children:[e.jsx(ks,{bg:h?"swap_bg_primary":"bg_primary",coinA:{amount:u||"0",...s},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:y||"0",...r}}),e.jsx(d,{w:"100%",minH:"48px",bg:h?"swap_bg_primary":"bg_primary",borderRadius:"8px",border:"1px solid",borderColor:"border",justifyContent:"center",zIndex:"100",children:e.jsx(we,{fromToken:s,toToken:r,fromValue:u,toValue:y,color:"text_caption"})}),$&&e.jsx(d,{zIndex:"99",w:"100%",mt:"-26px",bg:C?"primary_red_opacity.10":"primary_yellow_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"center",p:"18px 16px 10px",children:e.jsx(f,{color:C?"primary_red":"primary_yellow",fontSize:"12px",lineHeight:"20px",textAlign:"start",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})}),e.jsx(Ce,{wrapStyle:{h:"20px",lineHeight:"20px"},label:"Slippage Tolerance",labelStyle:{fontSize:"14px"},value:`${Ne(c).mul(100)}%`,valueStyle:{fontSize:"14px"}}),e.jsx(Ce,{wrapStyle:{h:"20px",lineHeight:"20px"},label:w?"Minimum Received":"Maximum Input",labelStyle:{fontSize:"14px"},value:`${Ws(_||0,W==null?void 0:W.decimals,!1,Fs.ROUND_DOWN).toString()} ${be(W==null?void 0:W.symbol)}`,valueStyle:{fontSize:"14px"}}),e.jsx(Qe,{fromToken:s,toToken:r,sources:H,marketPrice:T,priceImpact:v,showIncalculable:le}),C&&e.jsxs(I,{w:"100%",gap:"8px",children:[e.jsx(d,{w:"100%",bg:"primary_red_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"start",p:"10px 16px",children:e.jsx(f,{color:"primary_red",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?"})}),e.jsxs(d,{w:"100%",justifyContent:"space-between",gap:"16px",children:[e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:g?"text_highlight":"button_outline_border",onClick:()=>{S(!0)},children:"Yes, please continue."}),e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:"button_outline_border",onClick:x,children:"No,cancel it."})]})]}),R&&e.jsxs(d,{w:"100%",justifyContent:"space-between",children:[e.jsxs(d,{children:[e.jsx(se,{xlinkHref:"#icon-icon_priceupdated1",svgW:"20px",svgH:"20px"}),e.jsx(f,{color:"text_caption",fontWeight:"500",fontSize:"14px",children:"Price updated"})]}),e.jsx(ce,{onClick:ae,h:"40px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",p:"0 42px",children:"Accept"})]})]}),!R&&e.jsx(ce,{disabled:te,isLoading:re,mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{re||(xe(!0),i(b))},children:"Confirm Swap"})]})}export{rr as H,es as O,Tr as P,Hr as S,zr as a,Pr as b,$r as c,Ir as u};
//# sourceMappingURL=SwapConfirmBlock-4h3Yx6_7.js.map

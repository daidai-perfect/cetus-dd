import{a as g,j as t,V as z,p as Ve,H as A,T as C,C as pt,q as de,f as ft,al as zt,S as gt,W as Lt,X as Wt,Y as Bt,Z as Ht,a7 as Ut,$ as Ft,a0 as Gt,O as Vt,am as qt,an as Yt,ao as Kt,ap as dt,I as Qt}from"./vendor-BowHGuwE.js";import{M as Xt,C as Zt}from"./MenuDropBlock-B_Xo_jdj.js";import{T as Jt,a as It}from"./TradeTab-C0uP3iOt.js";import{u as qe}from"./useTransaction-B2ZSWOCT.js";import{k as we,l as es,u as xt,D as ts,a as Ye,h as Ot,j as Pt,B as De,d as _,m as ot,f as E,t as Me,I as je,C as ss,n as Ke,o as as,p as is,q as ns,r as cs,v as ls,w as me,x as Ue,E as rt,y as ht,z as ve,G as Fe,A as os,e as rs,F as Ge,N as us,H as ps}from"./index-C10POeB7.js";import{P as Tt}from"./Pagination-Z1OymywO.js";import{N as ut}from"./NoData-DwPvHKvw.js";import{R as yt}from"./RefreshButton-BMB7SlVK.js";import{u as At,R as Nt}from"./RangeValue-3Nko4R47.js";import{H as re}from"./HTextLabelBox-seuGwifr.js";import{E as Re}from"./ErrorTips-DC2NN0Mq.js";import{u as mt}from"./useAccountBalance-CvxAcInh.js";import{u as xs}from"./useInsufficientBalanceToast-BNnRL5y7.js";import{A as ms}from"./aggregator-oFKtN55h.js";import{A as _t}from"./useSwapHelper-B0yOkkbM.js";import{u as St}from"./useTokenBalance-BHB-OVys.js";import{u as gs}from"./useFindBestRouting-DyZEpIII.js";import{u as kt}from"./useToken-CQONILEW.js";import{i as ds}from"./icon_currentprice@2x-DeObnx8l.js";import{C as hs}from"./CurrentPrice-CqynVSTc.js";import{T as ys}from"./TooltipIcon-DwzOcTXu.js";import{T as _s}from"./TradeInputGroup-B2IjGkE1.js";import{W as Ss}from"./WarningTokenTipModal-D-lRKxGu.js";import{S as bt}from"./SingleTokenInfo-DwdF0PGY.js";import{I as Ct}from"./InputBox-DcOfvTu8.js";import{LimitPriceChart as bs}from"./LimitPriceChart-DSPM_MnS.js";import{u as vs}from"./global-C6vh2RR7.js";import{u as Ds}from"./useInterval-BcJtT0it.js";import{u as ws}from"./useRpcListener-D04jIA7L.js";import"./IconBg-n4uXCJ_X.js";import"./useTrack-CTrZMfmf.js";import"./useSigner-D0zB_yMy.js";import"./useGetPoolList-BTM-c6TE.js";import"./useWrapPoolData-B4Ejf7Ww.js";import"./_getAllKeysIn-De-tcGkV.js";import"./CheckBox-h6TTd1Hz.js";import"./CopyButton-CxshaeC4.js";import"./usePreviousValue-ChnvxeJQ.js";function Rt(){const a=we("dca");return{dcaCloseOrderPayload:async e=>await a.Dca.dcaCloseOrderPayload(e)}}function Mt(){const a=we("dca");return{dcaWithdrawPayload:async e=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaClaim.ts:12 ~ params:",e),await a.Dca.withdrawAll(e))}}const js=(a,s)=>({upperPriceSize:"0%",setUpperPriceSize:e=>{a(()=>({upperPriceSize:e}))},lowerPriceSize:"0%",setLowerPriceSize:e=>{a(()=>({lowerPriceSize:e}))},dcaMode:"total",setDcaMode:e=>{a(()=>({dcaMode:e}))},isDcaRefresh:!1,setIsDcaRefresh:e=>{a(()=>({isDcaRefresh:e}))},pageDirect:!1,setPageDirect:e=>{a(()=>({pageDirect:e}))},sellTotalAmount:"",setSellTotalAmount:e=>{a(()=>({sellTotalAmount:e}))},sellAmount:"",setSellAmount:e=>{a(()=>({sellAmount:e}))},buyAmount:"",setBuyAmount:e=>{a(()=>({buyAmount:e}))},sellCoin:void 0,setSellCoin:e=>{a(()=>({sellCoin:e}))},buyCoin:void 0,setBuyCoin:e=>{a(()=>({buyCoin:e}))},orderNum:"2",setOrderNum:e=>{a(()=>({orderNum:e}))},investNum:"1",setInvestNum:e=>{a(()=>({investNum:e}))},currentCoinKey:"sellCoin",setCurrentCoinKey:e=>{a(()=>({currentCoinKey:e}))},currentInvest:"Hour",setCurrentInvest:e=>{a(()=>({currentInvest:e}))},pageLoading:!0,setPageLoading:e=>{a(()=>({pageLoading:e}))},dcaConfig:{},setDcaConfig:e=>{a(()=>({dcaConfig:e}))},dcaQuote:{},setDcaQuote:e=>{a(()=>({dcaQuote:e}))},orderHistoryObj:{},setOrderHistoryObj:e=>{a(()=>({orderHistoryObj:{...s().orderHistoryObj,...e}}))},inCoinWhiteList:[],setInCoinWhiteList:e=>{a(()=>({inCoinWhiteList:e}))},outCoinWhiteList:[],setOutCoinWhiteList:e=>{a(()=>({outCoinWhiteList:e}))}}),ie=es(js);function fs(){const{fetchByApi:a}=xt(),{setOrderHistoryObj:s}=ie();return{getDcaOrderHistory:async({orderId:S,limit:u,offset:r})=>{var i;const n=await a(ts,"GET",{order_id:S,limit:u,offset:r});if(console.log("ðŸš€ ~ file: useGetDcaOrderHistory.ts:16 ~ useGetDcaOrderHistory ~ res:",n),n!=null&&n.list){const x={[S]:{list:((i=n==null?void 0:n.list)==null?void 0:i.map(c=>({inAmount:c==null?void 0:c.in_amount,outAmount:c==null?void 0:c.out_amount,inCoinType:c==null?void 0:c.in_coin,outCoinType:c==null?void 0:c.out_coin,time:c==null?void 0:c.execution_at,tx:c==null?void 0:c.tx})))||[],total:(n==null?void 0:n.total)||0}};return s(x),x}}}}function Os({isDetail:a,currentTabVal:s,orderInfo:e,handleRefresh:S,pageDirect:u}){const{isApp:r}=Ye(),{inCoin:n,outCoin:i}=e,{getDcaOrderHistory:x}=fs(),[c,m]=g.useState(u),[l,b]=g.useState(u),p=10,[y,h]=g.useState([]),[d,v]=g.useState(0),[j,H]=g.useState(1),[R,f]=g.useState(!1),[F,G]=g.useState({label:"Overview",value:"overview"}),J=g.useMemo(()=>[{label:"Overview",value:"overview"},{label:R||Number(d)===0?"Orders":`Orders (${d})`,value:"orders"}],[d]),B=D=>{G(D),e!=null&&e.orderID&&X(e==null?void 0:e.orderID,p,0,!1)};g.useEffect(()=>{a&&(e!=null&&e.orderID)&&X(e==null?void 0:e.orderID,p,0,!1)},[e,a]);const se=D=>{console.log("ðŸš€ ~ handleCurrentPage ~ page:",D);const P=(D-1)*p;X(e==null?void 0:e.orderID,p,P,!1),H(D)},X=async(D,P,U,N=!1)=>{var Y,ee,ne,he;console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ loading:",N),f(N);const L=await x({orderId:D,limit:P,offset:U});console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ res?.list:",L,L[D]),(Y=L[D])!=null&&Y.list&&h((ee=L[D])==null?void 0:ee.list),(ne=L[D])!=null&&ne.total&&v((he=L[D])==null?void 0:he.total),f(!1),console.log("ðŸš€ ~ file: TestData.tsx:170 ~ handleGetDcaOrderHistory ~ res:",L)},[$,k]=g.useState(!1),{dcaWithdrawPayload:O}=Mt();mt();const{signAndExecuteTransaction:W}=qe(),I=async()=>{k(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",e);const D=[],P={order_id:e==null?void 0:e.orderID,in_coin_type:e==null?void 0:e.inCoin.coin_type,out_coin_type:e==null?void 0:e.outCoin.coin_type};D.push(P),console.log("ðŸš€ ~ toClaim ~ claimOrderParams:",D);const U=await O(D),N=await W(U,{getShowInfo:L=>{var ee,ne;const Y={modalDescriptionText:`${(ee=e==null?void 0:e.outCoin)==null?void 0:ee.symbol} Claimed`,toastTitleText:`${(ne=e==null?void 0:e.outCoin)==null?void 0:ne.symbol} Claimed`};return L==="success"&&(Y.toastDescriptionContent=""),Y}});N&&(console.log("ðŸš€ ~ toClaim ~ res:",N),setTimeout(()=>{S()},2e3)),k(!1)}catch(D){console.log("ðŸš€ ~ toClaim ~ error:",D),k(!1)}},{getExplorerUrl:T}=Ot();return t.jsxs(z,{w:"100%",gap:"20px",children:[t.jsx(Pt,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:J,currentTab:F.label,handleChangeTab:B}),t.jsxs(De,{p:"30px 8px 20px",mt:"-42px",borderRadius:"8px",zIndex:"0",bg:"bg_primary",children:[F.value=="orders"&&(R?t.jsx(Ve,{height:"4",width:"100%"}):(y==null?void 0:y.length)===0?t.jsx(ut,{type:"nodata",text:"No orders",noBorder:!0,p:"12px",bg:"none"}):t.jsxs(z,{w:"100%",align:"flex-start",gap:"16px",mt:"12px",children:[!r&&t.jsxs(A,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[t.jsx(Z,{label:"Order info",value:"",w:{base:"100%",lg:"40%"}}),t.jsx(Z,{label:"Rate",value:"",w:{base:"100%",lg:"calc(32% - 16px)"},direct:l,onChangeDirect:()=>b(!l)}),t.jsx(Z,{label:"Time (UTC)",value:"",w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]}),y==null?void 0:y.map(D=>{console.log("ðŸš€ ~ {orderHistoryList?.map ~ orderHistory:",D);const P=ot(D.inAmount,n==null?void 0:n.decimals),U=ot(D.outAmount,i==null?void 0:i.decimals),N=_(P).div(U).toString(),L=_(1).div(N).toString();return t.jsxs(A,{w:"100%",flexDirection:{base:"column",lg:"row"},borderBottom:r?"1px solid":"none",pb:r?"16px":"0",borderColor:"border",_last:{borderBottom:"none",pb:"0"},children:[t.jsx(Z,{label:r?"Order info":"",value:`${E(P)} ${n.symbol} â†’ ${E(U)} ${i.symbol}`,w:{base:"100%",lg:"40%"}}),t.jsx(Z,{label:r?"Rate":"",value:l?`${E(N)} ${n.symbol} per ${i.symbol}`:`${E(L)} ${i.symbol} per ${n.symbol}`,w:{base:"100%",lg:"calc(32% - 16px)"},direct:l,showDirectIcon:!!r,onChangeDirect:()=>b(!l)}),t.jsx(Z,{label:r?"Time (UTC)":"",value:t.jsxs(A,{h:"12px",children:[t.jsx(C,{fontSize:"12px",color:"text_caption",children:Me((D==null?void 0:D.time)*1e3,"YMDHM")}),t.jsx(je,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(T(D==null?void 0:D.tx,"tx"))}})]}),w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]},D==null?void 0:D.time)}),_(d).gt(p)&&t.jsx(pt,{w:"100%",children:t.jsx(Tt,{total:d,size:p,currentPage:j,onChange:se})})]})),F.value=="overview"&&t.jsxs(z,{align:"flex-start",gap:"20px",children:[(e==null?void 0:e.isShowTradeTips)&&(e==null?void 0:e.orderStatus)=="Active"&&s=="active"&&t.jsx(Ps,{}),t.jsxs(z,{w:"100%",borderRadius:"8px",p:"12px",bg:"card_bg",gap:"12px",children:[t.jsx(re,{isLoading:!1,label:`DCA  ${n==null?void 0:n.symbol} Balance`,value:`${E(e==null?void 0:e.inBalance,2)||"0"} ${n==null?void 0:n.symbol}`,skeletonStyle:{valueW:"128px"}}),t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsxs(C,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]}),t.jsxs(A,{children:[t.jsxs(C,{color:"text_caption",fontSize:"12px",children:[(e==null?void 0:e.outBalance)>0?E(e==null?void 0:e.outBalance):e==null?void 0:e.outBalance," ",i==null?void 0:i.symbol]}),s=="active"&&t.jsx(de,{isLoading:$,onClick:I,disabled:(e==null?void 0:e.outBalance)<=0||$,w:"60px",h:"20px",fontSize:"12px",borderRadius:"4px",variant:"outline",children:"Claim"})]})]}),t.jsx(re,{isLoading:!1,label:"Amount Withdrawn",value:s=="active"?`${E(e==null?void 0:e.outWithdraw,2)}`:(e==null?void 0:e.orderStatus)=="PartialDeal"||(e==null?void 0:e.orderStatus)=="Close"?_(e==null?void 0:e.outWithdraw).gt(0)?`${E(e==null?void 0:e.inWithdrawn)} ${n==null?void 0:n.symbol} ${E(e==null?void 0:e.outWithdraw)} ${i==null?void 0:i.symbol}`:`${E(e==null?void 0:e.inWithdrawn)} ${n==null?void 0:n.symbol}`:`${E(e==null?void 0:e.outWithdraw)} ${i==null?void 0:i.symbol}`,skeletonStyle:{valueW:"128px"}})]}),t.jsxs(A,{flexWrap:"wrap",p:{base:"0",lg:"0 12px"},mt:{base:"-12px",lg:"-28px"},sx:{">div":{mt:{base:"12px",lg:"28px"},w:{base:"100%",lg:"calc((100% - 66px)/3)"},"&:nth-child(3n+1)":{mr:{base:"0",lg:"50px"}}}},children:[t.jsx(Z,{label:"Invest Every",value:e==null?void 0:e.investEvery}),t.jsx(Z,{label:"# of Orders Left",value:e==null?void 0:e.ofOrderLeft}),t.jsx(Z,{label:"Each Order Size",value:`${e==null?void 0:e.eachOrderSize} ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right"}),t.jsx(Z,{label:"Minimum Price",value:c?`${e==null?void 0:e.minPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.minPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,direct:c,onChangeDirect:()=>m(!c)}),t.jsx(Z,{label:"Maximum Price",value:c?`${e==null?void 0:e.maxPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.maxPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,direct:c,onChangeDirect:()=>m(!c)}),s=="active"&&t.jsx(Z,{label:"Current Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>m(!c)}),s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"&&t.jsx(Z,{label:"Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>m(!c)}),s=="active"&&t.jsx(Z,{label:"Next Order (UTC)",value:e==null?void 0:e.nextCycleAt}),t.jsx(Z,{label:"Created (UTC)",value:e==null?void 0:e.createAt,align:s=="active"||s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"?"flex-start":"flex-end"})]})]})]})]})}const Z=({label:a,value:s,direct:e,onChangeDirect:S,textAlign:u="left",showDirectIcon:r=!0,...n})=>t.jsxs(z,{align:"flex-start",flexDirection:{base:"row",lg:"column"},w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"unset"},...n,children:[a!==""&&t.jsxs(A,{h:"12px",children:[t.jsx(C,{fontSize:"12px",children:a}),S&&r&&t.jsx(je,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:S})]}),s!==""&&t.jsx(ft,{fontSize:"12px",color:"text_caption",textAlign:u,children:s})]}),Ps=()=>t.jsxs(z,{p:"12px 12px 0",align:"flex-start",children:[t.jsx(A,{children:t.jsx(Re,{tips:"The system tried to execute your order multiple times but did not get it through. This is possibly because:",type:"warning",tipsFontSize:"12px",p:"0",bg:"none",svgW:"20px",svgH:"20px"})}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market price is not in your required price range"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market no longer exit"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market is extremely volatile"}),t.jsx(C,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"This DCA will continue to be attempted and the estimated end date may be extended until your order is fully executed."})]});function Ts({currentTabVal:a,orderInfo:s,handleRefresh:e}){const{isApp:S}=Ye(),{inCoin:u,outCoin:r}=s,[n,i]=g.useState(!1),[x,c]=g.useState(!1);g.useEffect(()=>{i(!1)},[a]);const{getTokenRank:m}=At(),[l,b]=g.useState(!1);g.useEffect(()=>{const v=m(u,r);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",r,u,v),b(!v)},[u==null?void 0:u.coin_type,r==null?void 0:r.coin_type]);const{dcaCloseOrderPayload:p}=Rt(),{signAndExecuteTransaction:y}=qe(),h=async()=>{c(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",s);const v=[{order_id:s==null?void 0:s.orderID,in_coin_type:s==null?void 0:s.inCoin.coin_type,out_coin_type:s==null?void 0:s.outCoin.coin_type}];console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-order-card.vue:280 ~ closeOrder ~ closeOrderParams:",v);const j=await p(v),H=await y(j,{getShowInfo:R=>{const f={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return R==="success"&&(f.modalDescriptionText="DCA Order Closed",f.toastDescriptionContent="",f.toastTitleText="DCA Order Closed"),f}});console.log("ðŸš€ ~ closeOrder ~ res:",H),H&&setTimeout(()=>{e()},2e3),c(!1)}catch(v){console.log("ðŸš€ ~ closeOrder ~ error:",v),c(!1)}},{getExplorerUrl:d}=Ot();return t.jsxs(z,{w:"100%",gap:"12px",align:"flex-start",children:[t.jsxs(A,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[t.jsxs(A,{children:[t.jsx(ss,{coinAIconUrl:u==null?void 0:u.logo_url,coinBIconUrl:r==null?void 0:r.logo_url,coinACoinType:u==null?void 0:u.coin_type,coinBCoinType:r==null?void 0:r.coin_type,w:"28px",h:"28px"}),t.jsxs(C,{color:"text_caption",children:[u==null?void 0:u.symbol," â†’ ",r==null?void 0:r.symbol]}),t.jsx(je,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(d(s==null?void 0:s.orderID,"poolAddress"))}})]}),!S&&t.jsx(vt,{currentTabVal:a,isCloseLoading:x,closeOrder:h,orderInfo:s,isDetail:n,onClickDetail:()=>i(!n)})]}),t.jsxs(A,{children:[t.jsxs(C,{color:"text_caption",fontSize:"12px",children:[E(s==null?void 0:s.inDepositedOut)," ",u==null?void 0:u.symbol]}),t.jsxs(C,{color:"primary_gray",fontSize:"12px",children:["/ ",E(s==null?void 0:s.inDeposited)," ",u==null?void 0:u.symbol]}),t.jsxs(C,{color:"primary_gray",fontSize:"12px",children:["(",s==null?void 0:s.inBalanceRatio,"%)"]}),t.jsx(zt,{w:"50px",h:"4px",value:s==null?void 0:s.inBalanceRatio,bg:"#282828",sx:{'div[role="progressbar"]':{bg:"primary"}}})]}),t.jsxs(A,{w:"100%",children:[t.jsx(C,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),t.jsx(Nt,{displayTokenA:r,displayTokenB:u,isRank:!0,priceInfo:{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,minPriceResever:s==null?void 0:s.minPriceResever,maxPriceResever:s==null?void 0:s.maxPriceResever},fontSize:"12px"})]}),S&&t.jsx(vt,{currentTabVal:a,isCloseLoading:x,closeOrder:h,orderInfo:s,isDetail:n,onClickDetail:()=>i(!n)}),n&&t.jsx(Os,{pageDirect:l,isDetail:n,currentTabVal:a,orderInfo:s,handleRefresh:e})]})}const vt=({currentTabVal:a,isCloseLoading:s,closeOrder:e,orderInfo:S,isDetail:u,onClickDetail:r})=>t.jsxs(A,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[a=="active"&&t.jsx(de,{w:{base:"100%",lg:"unset"},isLoading:s,disabled:s,onClick:e,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(S==null?void 0:S.outBalance)<=0?"Close":"Close and Withdraw"}),t.jsx(de,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:t.jsx(je,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:u?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:r,children:"Details"})]});function Dt({handleRefresh:a,activeList:s,pastList:e,isOrderLoading:S}){const[r,n]=g.useState([]),[i,x]=g.useState([]),[c,m]=g.useState(0),[l,b]=g.useState(1),{currentAccount:p,onWalletModal:y}=Ke(),[h,d]=g.useState({label:"Active DCAs",value:"active"}),v=g.useMemo(()=>[{label:"Active DCAs",value:"active",num:(s==null?void 0:s.length)>0?s==null?void 0:s.length:void 0},{label:"Past DCAs",value:"past",num:(e==null?void 0:e.length)>0?e==null?void 0:e.length:void 0}],[h==null?void 0:h.value,s,e]),j=O=>{b(1),d(O)};g.useEffect(()=>{const O=(h==null?void 0:h.value)==="active"?s:e;n(O),m(O==null?void 0:O.length)},[h==null?void 0:h.value,s,e]),g.useEffect(()=>{const O=(l-1)*10,W=O+10;x(r==null?void 0:r.slice(O,W))},[l,r,h==null?void 0:h.value]);const H=g.useMemo(()=>(h==null?void 0:h.value)==="past"||(r==null?void 0:r.length)===0?0:r==null?void 0:r.reduce((O,W)=>_(O).plus(W==null?void 0:W.outBalance),_(0)).toString(),[h==null?void 0:h.value,r]),[R,f]=g.useState(!1),[F,G]=g.useState(!1),{dcaWithdrawPayload:J}=Mt(),{dcaCloseOrderPayload:B}=Rt(),{signAndExecuteTransaction:se}=qe(),X=async()=>{G(!0);try{const O=r==null?void 0:r.map(T=>({order_id:T==null?void 0:T.orderID,in_coin_type:T==null?void 0:T.inCoin.coin_type,out_coin_type:T==null?void 0:T.outCoin.coin_type}));console.log("ðŸš€ ~ const closeOrderParams:any=pageList.map ~ closeOrderParams:",O);const W=await B(O),I=await se(W,{getShowInfo:T=>{const D={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return T==="success"&&(D.modalDescriptionText="DCA Order Closed",D.toastDescriptionContent="",D.toastTitleText="DCA Order Closed"),D}});console.log("ðŸš€ ~ closeAll ~ res:",I),I&&setTimeout(()=>{a(!0)},2e3),G(!1)}catch(O){console.log("ðŸš€ ~ closeAll ~ error:",O),G(!1)}},$=async()=>{f(!0);try{const O=r==null?void 0:r.map(T=>({order_id:T==null?void 0:T.orderID,in_coin_type:T==null?void 0:T.inCoin.coin_type,out_coin_type:T==null?void 0:T.outCoin.coin_type}));console.log("ðŸš€ ~ const claimOrderParams:any=pageList.map ~ claimOrderParams:",O);const W=await J(O),I=await se(W,{getShowInfo:T=>{const D={modalDescriptionText:"DCA Order Claimed",toastTitleText:"DCA Order Claimed"};return T==="success"&&(D.toastDescriptionContent=""),D}});console.log("ðŸš€ ~ claimAll ~ res:",I),I&&setTimeout(()=>{a(!0)},2e3),f(!1)}catch(O){console.log("ðŸš€ ~ claimAll ~ error:",O),f(!1)}},{isApp:k}=Ye();return t.jsxs(z,{w:"100%",children:[t.jsxs(A,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[t.jsxs(A,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[t.jsx(Pt,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:v,currentTab:h.label,handleChangeTab:j}),k&&t.jsx(yt,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),t.jsxs(A,{w:{base:"100%",lg:"unset"},children:[h.value==="active"&&(r==null?void 0:r.length)>0&&(p==null?void 0:p.address)&&t.jsx(de,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:R,disabled:Number(H)===0||R,onClick:$,leftIcon:t.jsx(je,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),h.value==="active"&&(r==null?void 0:r.length)>0&&(p==null?void 0:p.address)&&t.jsx(de,{w:{base:"50%",lg:"unset"},isLoading:F,disabled:(r==null?void 0:r.length)==0||F,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:X,children:"Close All"}),!k&&t.jsx(yt,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),p!=null&&p.address?S?t.jsx(De,{children:t.jsx(z,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((O,W)=>t.jsx(As,{},W))})}):(r==null?void 0:r.length)===0?t.jsx(ut,{type:"nodata",text:(h==null?void 0:h.value)==="active"?"No active orders":"No closed orders"}):t.jsxs(De,{h:(i==null?void 0:i.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[t.jsx(z,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:i==null?void 0:i.map(O=>t.jsx(Ts,{handleRefresh:()=>a(!0),currentTabVal:h.value,orderInfo:O},O==null?void 0:O.orderID))}),!S&&(r==null?void 0:r.length)>10&&t.jsx(pt,{mt:"28px",children:t.jsx(Tt,{total:c,size:10,currentPage:l,onChange:b})})]}):t.jsx(ut,{type:"nowallet",onboard:()=>y(!0)})]})}const As=()=>t.jsxs(z,{w:"100%",gap:"16px",align:"flex-start",children:[t.jsxs(A,{w:"100%",gap:"0",justify:"space-between",children:[t.jsxs(A,{gap:"0",children:[t.jsxs(A,{gap:"0px",mr:"8px",align:"flex-start",children:[t.jsx(gt,{size:"8"}),t.jsx(gt,{size:"8"})]}),t.jsx(Ve,{height:"4",width:"100px"})]}),t.jsx(Ve,{height:"4",width:"150px"})]}),t.jsx(Ve,{height:"4",width:"180px"})]});function Ns(){const{fetchByApi:a}=xt(),s=we("dca"),{setDcaConfig:e}=ie(),S=async()=>await a(as,"GET")||null,u=async()=>await s.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const n={};try{const i=await S();i&&(n.minCycleAmountInUsd=i==null?void 0:i.min_amount_in_usd)}catch(i){console.log("ðŸš€ ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",i)}try{const i=await u();n.minCycleCount=i==null?void 0:i.min_cycle_count,n.minCycleFrequency=i==null?void 0:i.min_cycle_frequency,n.whitelistMode=i==null?void 0:i.whitelist_mode}catch(i){console.log("ðŸš€ ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",i)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",n),e(n),n}}}function Et(){const{fetchByApi:a}=xt(),{setDcaQuote:s}=ie();return{getDcaQuote:async({inCoin:S,freq:u,count:r,sender:n})=>{try{const i=await a(is,"GET",{in_coin:S,freq:u,count:r,sender:n});if(i){const x={amountInLimitPerCycle:i==null?void 0:i.amount_in_limit_per_cycle,coinType:i==null?void 0:i.coin_type,feeRate:i==null?void 0:i.fee_rate,signature:i==null?void 0:i.signature,signer:i==null?void 0:i.signer,timestamp:i==null?void 0:i.timestamp};return s(x),x}}catch(i){console.log("getDcaQuote ~ error:",i)}return null}}}function ks(){var Q,Se;const{sellCoin:a,buyCoin:s,setSellCoin:e,setBuyCoin:S,sellAmount:u,buyAmount:r,setBuyAmount:n,setSellAmount:i,dcaConfig:x,setCurrentCoinKey:c,currentCoinKey:m,investNum:l,currentInvest:b,orderNum:p,dcaQuote:y,setInvestNum:h,setOrderNum:d,setCurrentInvest:v,setPageDirect:j,pageDirect:H,dcaMode:R,sellTotalAmount:f,setSellTotalAmount:F,setLowerPriceSize:G,setUpperPriceSize:J}=ie(),{currentAccount:B}=Ke(),{getDcaConfig:se}=Ns(),{getDcaQuote:X}=Et(),{coinPriceObj:$}=ns(),{fetchTokenPrices:k,getTokenAmountValue:O}=cs(),[W,I]=g.useState(""),T=g.useRef(W);g.useEffect(()=>{T.current=W},[W]);const D=()=>{console.log("ðŸš€ ~ initiaTokenSelect ~ setSellCoin:"),e(ht.clmm_swap.from_coin),S(ht.clmm_swap.to_coin)};g.useEffect(()=>(G("0%"),J("0%"),D(),se(),()=>{ce()}),[]);const[P,U]=g.useState(""),[N,L]=g.useState(""),{balanceInfo:Y}=St(a),{balanceInfo:ee}=St(s),ne=O(a==null?void 0:a.coin_type,u),he=o=>{c("sellCoin"),i(o),_e()};g.useEffect(()=>{+u&&+p?R=="total"?F(u):F(_(u).mul(p).toString()):F("")},[u,R,p]);const Qe=()=>{const o=H?a==null?void 0:a.decimals:s==null?void 0:s.decimals;if(j(!H),P&&N){const M=P,te=_(1).div(N).toString(),be=_(1).div(M).toString();U(ve(te,o,!0).toString()),L(ve(be,o,!0).toString())}},Xe=(o,M=!0)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useDcaHook.ts:143 ~ handleSelectToken ~ handleSelectToken:"),U(""),L(""),M?(Fe(o==null?void 0:o.coin_type)===Fe(s.coin_type)?fe():e(o),c("sellCoin")):(Fe(o==null?void 0:o.coin_type)===Fe(a.coin_type)?fe():S(o),c("buyCoin"))},ce=()=>{i(""),U(""),L(""),I(""),h("1"),d("2"),v("Hour")},fe=()=>{e(s),S(a)},Oe=g.useMemo(()=>{const o=x==null?void 0:x.whitelistMode;return console.log("ðŸš€ ~ useDcaHook ~ whitelistMode:",o),o===3?!0:o===0?!1:m==="sellCoin"?o===1:m==="buyCoin"?o===2:!1},[x==null?void 0:x.whitelistMode]),Pe=((Q=$[ls(a==null?void 0:a.coin_type).full_address])==null?void 0:Q.price)||0,V=g.useMemo(()=>f&&p?_(f).div(p).toString():0,[f,p]),Te=g.useMemo(()=>f&&p&&Pe&&_(f).div(p).mul(Pe).toString()||0,[f,p,Pe]),Ze=_(y==null?void 0:y.feeRate).div(me.pow(10,6)).mul(100).toString()+"%"||"0%",le=g.useMemo(()=>{if(y!=null&&y.amountInLimitPerCycle&&(a!=null&&a.decimals))return ot(y==null?void 0:y.amountInLimitPerCycle,a==null?void 0:a.decimals)},[y==null?void 0:y.amountInLimitPerCycle]),ge=g.useMemo(()=>(console.log("ðŸš€ ~ orderSizeError ~ sellPerOrder:",V,le),x!=null&&x.minCycleAmountInUsd&&p&&u&&le&&Number(V)<Number(le)?{status:!0,tips:`Each order size should be higher than $${x==null?void 0:x.minCycleAmountInUsd}.`}:u&&p&&Number(Te)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[R,le,p,V,u,Te,x==null?void 0:x.minCycleAmountInUsd]),Ae=g.useMemo(()=>(console.log("ðŸš€ ~ orderInputError ~ orderNum:",p,p&&Number(p)<Number(x==null?void 0:x.minCycleCount)),x!=null&&x.minCycleCount&&p&&Number(p)<Number(x==null?void 0:x.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${x==null?void 0:x.minCycleCount}.`}:p&&Number(l)<=0?{status:!0,tips:"Please enter an interval above 0"}:p&&l&&Number(l)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[p,x==null?void 0:x.minCycleCount,l]),Ne=g.useMemo(()=>P&&Number(P)==0||N&&Number(N)==0?{status:!0,tips:"Please enter a price greater than 0."}:P&&N&&Number(P)>=Number(N)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[P,N]),[Je,Ee]=g.useState(""),[ke,$e]=g.useState({status:!1,tips:""}),Ie=()=>{const o=new Date().getTime();let M=0;switch(console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",b),b){case"Minute":M=Number(l)*60*1e3*(Number(p)-1)+6e4;break;case"Hour":M=Number(l)*60*60*1e3*(Number(p)-1)+6e4;break;case"Day":M=Number(l)*60*60*24*1e3*(Number(p)-1)+6e4;break;case"Week":M=Number(l)*60*60*24*7*1e3*(Number(p)-1)+6e4;break;case"Month":M=Number(l)*60*60*24*30*1e3*(Number(p)-1)+6e4;break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",p,o,M,M>60*60*24*365*1e3);const te=Me(o+M,"YMDHM");console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",te),Ee(te),te=="NaN-NaN-NaN NaN:NaN"&&Ee("--"),M>60*60*24*365*1e3?$e({status:!0,tips:"The maximum execution period is 1 year"}):$e({status:!1,tips:"The maximum execution period is 1 year"})};g.useEffect(()=>{Ie()},[u,l,p,P,N,b]);const ue=g.useMemo(()=>{let o=0;switch(b){case"Minute":o=Number(l)*60;break;case"Hour":o=Number(l)*60*60;break;case"Day":o=Number(l)*60*60*24;break;case"Week":o=Number(l)*60*60*24*7;break;case"Month":o=Number(l)*60*60*24*30;break}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",o),o},[b,l]);g.useEffect(()=>{a!=null&&a.coin_type&&ue&&p&&Ce(a==null?void 0:a.coin_type,ue,p,B==null?void 0:B.address)},[a==null?void 0:a.coin_type,ue,p,B==null?void 0:B.address]);const ye=async(o,M,te,be)=>{const lt=be||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const He=await X({inCoin:o,freq:M,count:te,sender:lt});return console.log("ðŸš€ ~ queryDcaQuote ~ result:",He),He}catch(He){console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",He)}},Ce=Ue((o,M,te,be)=>{ye(o,M,te,be)},500),{findBestRouters:pe}=gs(),[et,ze]=g.useState(!1),[ae,Le]=g.useState(void 0),{getTokenRank:We}=At();g.useEffect(()=>{Be();const o=We(a,s);console.log("ðŸš€ ~ useEffect ~ direct:",o),j(o)},[a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]),g.useEffect(()=>{_e()},[V,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]);const _e=()=>{_(V).gt(0)&&(a!=null&&a.coin_type)&&(s!=null&&s.coin_type)&&(ze(!0),console.log("ðŸš€ ~ useDcaHook ~ sellAmountDebounce:",Number(V)>0,V,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,p),tt())},tt=Ue(()=>{st()},500),st=async()=>{if(console.log("ðŸš€ ~ findAvailableRouter ~ findAvailableRouter:",V),a&&s){const o=`${a.coin_type}_${s.coin_type}`;I(o);const M=Object.entries(ms).map(([be,lt])=>lt.id),te=await pe({fromToken:a,toToken:s,amount:rt(V||1,a==null?void 0:a.decimals).toFixed(0),providersKeys:M,by_amount_in:!0,uuid:o});console.log("ðŸš€ ~ findAvailableRouter ~ newUuid:",o,W,te),o===T.current&&(Le(te),n(te.toAmountUi),ze(!1))}},Be=()=>{const o=((a==null?void 0:a.coin_type)||(s==null?void 0:s.coin_type))&&Array.from(new Set([a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]));(o==null?void 0:o.length)>0&&k(o)},at=g.useMemo(()=>{console.log("ðŸš€ ~ btnStatus ~ routerData:",ae);const o={text:"Create DCA Order",disabled:!1};return B!=null&&B.address?!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)?(o.disabled=!0,o.text="Select a token",o):!u||Number(u)==0?(o.disabled=!0,o.text="Enter an amount",o):_(f).gt((Y==null?void 0:Y.balanceFormat)||0)?(o.disabled=!0,o.text=`Insufficient ${a==null?void 0:a.symbol} balance`,o):_(x==null?void 0:x.minCycleCount).gt(p||0)?(o.disabled=!0,o.text=`Minimum ${x==null?void 0:x.minCycleCount} orders`,o):_(le).gt(V||0)?(o.disabled=!0,o.text=`Minimum $${x==null?void 0:x.minCycleAmountInUsd} per order`,o):ge.status||Ae.status||Ne.status||ke.status||!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)||!p||!l||!P||!N?(o.disabled=!0,o.text="Create DCA Order",o):(console.log("ðŸš€ ~ btnStatus ~ routerData:",ae),ae&&ae.errorCode&&(ae.errorCode===_t.NoRouter||ae.errorCode===_t.HoneyPot)&&(o.text="No Available Route",o.disabled=!0),o):(o.text="Connect Wallet",o.disabled=!1,o)},[B==null?void 0:B.address,Y,ge,Ae,Ne,ke,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,f,l,p,P,N,(Se=ae==null?void 0:ae.routes)==null?void 0:Se.length]),it=g.useMemo(()=>{const o=[];return s&&o.push(s),a&&o.push(a),o},[s,a]),oe=g.useMemo(()=>H&&r&&V?E(_(r).div(V).toString(),s==null?void 0:s.decimals,!0):!H&&r&&V?E(_(V).div(r).toString(),a==null?void 0:a.decimals,!0):"",[H,V,r]),nt=Ue(o=>{U(o)},500),ct=Ue(o=>{L(o)},500),w=o=>{console.log("ðŸš€ ~ handleMinInputChange ~ val:",o),nt(o)},q=o=>{console.log("ðŸš€ ~ handleMaxInputChange ~ val:",o),ct(o)};g.useEffect(()=>{xe(P)},[P,oe]),g.useEffect(()=>{K(N)},[N,oe]);const xe=o=>{if(console.log("ðŸš€ ~ changeLowerPriceSize ~ val:",o),oe&&o){const M=_(o).div(oe).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",M),G(_(M).gt(1e4)?">10,000%":`${E(M,1,!1,me.ROUND_HALF_DOWN)}%`)}},K=o=>{if(oe&&o){const M=_(o).div(oe).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",M),J(_(M).gt(1e4)?">10,000%":`${E(M,1,!1,me.ROUND_HALF_DOWN)}%`)}};return{currentPrice:oe,handleMinInputChange:w,handleMaxInputChange:q,warningTokenList:it,resetInputAmount:ce,cycleFrequency:ue,btnStatus:at,fetchFindAvailableRouterDebounce:_e,queryDcaQuote:ye,findRouterLoading:et,platformFee:Ze,estEndDate:Je,sellPerOrder:V,isDcaSelect:Oe,onReverseClick:fe,sellBalanceInfo:Y,buyBalanceInfo:ee,sellAmountValue:ne,handleAmountChange:he,handleSelectToken:Xe,minPriceValue:P,maxPriceValue:N,handlePageToggleDirect:Qe,orderSizeError:ge,orderInputError:Ae,priceError:Ne,orderTimeError:ke}}function Cs(){const a=we("dca"),{getTokenListInfo:s}=kt(),{setFilterTokenLoading:e}=os(),{setInCoinWhiteList:S,setOutCoinWhiteList:u}=ie();return{getDcaCoinWhiteList:async n=>{var i,x;console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:");try{e(!0);const{in_coin_list:c,out_coin_list:m}=await a.Dca.getDcaCoinWhiteList(n);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",m),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",c);const l=[],b=[],p=c.map(v=>v),y=await s(p);if(y)for(let v=0;v<c.length;v++){const j=y.get(c[v]);l.push({...j,labels:((i=j==null?void 0:j.labels)==null?void 0:i.length)>0?j==null?void 0:j.labels:""})}const h=m.map(v=>v),d=await s(h);if(d)for(let v=0;v<m.length;v++){const j=d.get(m[v]);b.push({...j,labels:((x=j==null?void 0:j.labels)==null?void 0:x.length)>0?j==null?void 0:j.labels:""})}console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",b),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",l),S(l),u(b),e(!1)}catch(c){S([]),u([]),e(!1),console.log("ðŸš€ ~ file: useGetDcaTokenList.ts:35 ~ getDcaCoinWhiteList ~ error:",c)}}}}function Rs(){const a=we("dca"),{getDcaQuote:s}=Et(),e=(r,n,i,x,c,m)=>{const l=_(rt(r,i)).div(n),b=_(l).div(_(c)),p=_(l).div(_(m));let y,h;if(i>x){const d=me.pow(10,i-x);y=p.div(d).ceil().toString(),h=b.div(d).ceil().toString()}else if(i<x){const d=me.pow(10,x-i);y=p.mul(d).ceil().toString(),h=b.mul(d).ceil().toString()}else y=p.ceil().toString(),h=b.ceil().toString();return{perCycleMinOutAmount:y,perCycleMaxOutAmount:h,cycleCountAmount:l}},S=(r,n,i,x)=>{const{in_coin:c,in_coin_amount:m,freq:l,cycle_count:b,out_coin:p}=r;return{in_coin_amount:String(rt(m,c.decimals)),in_coin_type:c.coin_type,out_coin_type:p.coin_type,cycle_frequency:l,cycle_count:b,per_cycle_min_out_amount:i,per_cycle_max_out_amount:x,per_cycle_in_amount_limit:n.amountInLimitPerCycle,fee_rate:n.feeRate,timestamp:n.timestamp,signature:n.signature}};return{openDcaOrder:async r=>{const{in_coin:n,out_coin:i,in_coin_amount:x,cycle_count:c,min_price:m,max_price:l,freq:b}=r,p=await a.getSenderAddress()||"0x0000000000000000000000000000000000000000000000000000000000000000",y=await s({inCoin:n.coin_type,freq:b,count:c,sender:p});if(!y)throw new Error("Request timed out");const{perCycleMinOutAmount:h,perCycleMaxOutAmount:d}=e(x,c,n.decimals,i.decimals,m,l),v=S(r,y,h,d);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",v);const j=await a.Dca.dcaOpenOrderPayload(v);return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",j),j}}}function $t({detailsData:a,isConfirm:s=!1}){const{sellPerOrder:e,estEndDate:S,platformFee:u,minPriceValue:r,maxPriceValue:n,minPriceResever:i,maxPriceResever:x}=a,{sellCoin:c,buyCoin:m,sellTotalAmount:l,investNum:b,currentInvest:p,pageDirect:y}=ie();return console.log("ðŸš€ ~ DetailsBlock ~ investNum:",a,b),t.jsxs(z,{w:"100%",gap:s?"20px":"16px",children:[t.jsx(re,{isLoading:!1,label:"Sell total",value:l?`${E(l,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(re,{isLoading:!1,label:"Sell per order",value:e?`${E(e,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!s&&t.jsx(re,{isLoading:!1,label:"Receive",value:t.jsxs(A,{gap:"4px",children:[t.jsx(rs,{imageUrl:m==null?void 0:m.logo_url,w:"20px",h:"20px",coinType:m==null?void 0:m.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),t.jsx(C,{color:"text_caption",children:m==null?void 0:m.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsx(C,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),t.jsx(Nt,{displayTokenA:m,displayTokenB:c,isRank:!0,justify:"flex-end",priceInfo:{minPrice:Ge(r).toString(),maxPrice:Ge(n).toString(),minPriceResever:Ge(i).toString(),maxPriceResever:Ge(x).toString()},fontSize:"14px",color:"text_caption"})]}),t.jsx(re,{isLoading:!1,label:"Invest every",value:Number(b)>1?`${b} ${p}s`:`${b} ${p}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsx(re,{isLoading:!1,label:"Start date",value:String(Me(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(re,{isLoading:!1,label:"Est. end date(UTC)",value:S,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(re,{isLoading:!1,label:"Platform fee",value:u,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const Ms=({confirmData:a,isOpen:s,onClose:e,toOpenDca:S,toOpenDcaLoading:u})=>{const{sellCoin:r,buyCoin:n}=ie();return t.jsxs(Lt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:e,isCentered:!0,children:[t.jsx(Wt,{}),t.jsxs(Bt,{children:[t.jsx(Ht,{children:t.jsx(Ut,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),t.jsx(Ft,{}),t.jsx(Gt,{textAlign:"center",p:"0px",children:t.jsxs(z,{w:"100%",gap:"16px",p:"16px",children:[t.jsxs(De,{borderRadius:"12px",position:"relative",p:"0 12px",children:[t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsxs(z,{align:"flex-start",w:"calc(50% - 24px)",children:[t.jsx(C,{children:"Sell"}),t.jsx(bt,{token:r,haveName:!1,symbolEllipsesDecimals:10})]}),t.jsx(ft,{w:"1px",h:"100px",bg:"border"}),t.jsxs(z,{align:"flex-end",w:"calc(50% - 24px)",children:[t.jsx(C,{children:"Buy"}),t.jsx(bt,{token:n,haveName:!1,symbolEllipsesDecimals:10})]})]}),t.jsx(pt,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:t.jsx(je,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),t.jsx($t,{detailsData:a,isConfirm:!0}),t.jsx(de,{mt:"12px",onClick:()=>{S(),e()},disabled:u,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function Es({detailsData:a}){return t.jsx(De,{children:t.jsxs(z,{gap:"20px",children:[t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsx(C,{color:"text_caption",children:"Details"}),t.jsx(C,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),t.jsx($t,{detailsData:a})]})})}function wt({title:a,label:s,inputValue:e,inputChange:S=()=>{},list:u=[],onListItemClick:r=()=>{}}){const n=i=>{const x=i.target.value.replace(/[^\d]/g,"");S(x)};return t.jsx(Ct,{w:"50%",borderRadius:"16px",children:t.jsxs(z,{gap:"16px",align:"flex-start",children:[typeof a=="string"?t.jsx(C,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:a}):a,t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsx(Vt,{value:e,onChange:n,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),u.length>0?t.jsx(Xt,{label:s,list:u,onListItemClick:r}):t.jsx(C,{color:"text_caption",children:s})]})]})})}function jt({direct:a,text:s,align:e,inputValue:S,inputChange:u=()=>{}}){const{sellCoin:r,buyCoin:n}=ie();return t.jsx(Ct,{w:"unset",borderRadius:"8px",children:t.jsx(A,{children:t.jsxs(z,{align:e,children:[t.jsx(us,{value:S,placeholder:"0.0",decimals:18,onChange:i=>u(i),style:{width:"calc(100% - 8px)",textAlign:e=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),t.jsxs(A,{w:"100%",justify:"space-between",children:[t.jsx(C,{fontSize:"12px",fontWeight:"500",children:a?`${n==null?void 0:n.symbol} per ${r==null?void 0:r.symbol}`:`${r==null?void 0:r.symbol} per ${n==null?void 0:n.symbol}`}),s&&t.jsx(C,{fontSize:"12px",fontWeight:"500",children:s})]})]})})})}function $s({handleGetDcaOrderList:a}){const{sellCoin:s,buyCoin:e,sellAmount:S,buyAmount:u,setInvestNum:r,setOrderNum:n,investNum:i,orderNum:x,currentInvest:c,setCurrentInvest:m,pageDirect:l,isDcaRefresh:b,dcaMode:p,setDcaMode:y,sellTotalAmount:h,upperPriceSize:d,lowerPriceSize:v,setLowerPriceSize:j,setUpperPriceSize:H}=ie(),{currentPrice:R,btnStatus:f,findRouterLoading:F,sellBalanceInfo:G,buyBalanceInfo:J,sellAmountValue:B,handleAmountChange:se,handleSelectToken:X,minPriceValue:$,maxPriceValue:k,handleMinInputChange:O,handleMaxInputChange:W,handlePageToggleDirect:I,onReverseClick:T,orderSizeError:D,orderInputError:P,orderTimeError:U,priceError:N,sellPerOrder:L,estEndDate:Y,platformFee:ee,fetchFindAvailableRouterDebounce:ne,cycleFrequency:he,resetInputAmount:Qe,warningTokenList:Xe}=ks();g.useEffect(()=>{b&&ne()},[b]);const{currentAccount:ce,onWalletModal:fe}=Ke(),[Oe,Pe]=g.useState("#icon-a-icon_trade"),V=["Minute","Hour","Day","Week","Month"],Te=w=>Pe(w?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:Ze}=Rs(),[le,ge]=g.useState(!1),{fetchCoinBalance:Ae}=mt(),{signAndExecuteTransaction:Ne,transactionRejected:Je,transactionConfirmation:Ee}=qe(),{failedTsToast:ke}=ps(),{showInsufficientBalanceToast:$e}=xs(),Ie=async()=>{ge(!0);const w={getShowInfo:K=>{`${E(h)}${s==null?void 0:s.symbol}${e==null?void 0:e.symbol}${x}`;const Q={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return K==="success"&&(Q.modalDescriptionText="DCA Order Created",Q.toastDescriptionContent="",Q.toastTitleText="DCA Order Created"),Q}};Ee(w);const q=l?_(1).div(k).toString():$,xe=l?_(1).div($).toString():k;try{const K={in_coin:s,out_coin:e,in_coin_amount:h,cycle_count:x,min_price:q,max_price:xe,freq:he};console.log("ðŸš€ ~ toOpenDca ~ params:",!l,$,k,q,xe,K);const Q=await Ze(K);console.log("ðŸš€ ~ toOpenDca ~ tx:",Q);const Se=await Ne(Q,w);console.log("ðŸš€ ~ toOpenDca ~ res:",Se),Se&&(Qe(),setTimeout(()=>{Ae(ce==null?void 0:ce.address,s==null?void 0:s.coin_type),a(ce==null?void 0:ce.address)},2e3)),ge(!1)}catch(K){const Q={getShowInfo:Se=>{const o={};return String(K)==="Error: Each order size should be higher than $10"&&(o.toastTitleText="Transaction Submission Error",o.toastDescriptionContent="Each order size should be higher than $10."),String(K)==="Error: Request timed out"&&(o.toastTitleText="Request timed out",o.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(K)==="Error: minPrice error"&&(o.toastTitleText="DCA order submission failed",o.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),o}};console.log("ðŸš€ ~ toOpenDca ~ error:",K),console.error("Open DCA Order Error: ",K),$e(String(K)),Je(Q),ke(Q),ge(!1)}},{currentCoinKey:ue,inCoinWhiteList:ye,outCoinWhiteList:Ce,dcaConfig:pe}=ie(),{getDcaCoinWhiteList:et}=Cs(),[ze,ae]=g.useState([]);g.useEffect(()=>{ue=="sellCoin"?ae(ye):ae(Ce)},[ue,ye,Ce]),g.useEffect(()=>{pe&&(pe.whitelistMode||pe.whitelistMode==0)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",pe),et(pe.whitelistMode))},[pe]);const[Le,We]=g.useState(!1),_e=g.useMemo(()=>{const w=l?e==null?void 0:e.decimals:s==null?void 0:s.decimals;let q="",xe="",K="",Q="";return $&&k&&(q=l?ve(_(1).div(k).toString(),w,!0).toString():$,xe=l?ve(_(1).div($).toString(),w,!0).toString():k,K=l?$:ve(_(1).div(k).toString(),w,!0).toString(),Q=l?k:ve(_(1).div($).toString(),w,!0).toString()),{estEndDate:Y,sellPerOrder:L,platformFee:ee,minPriceValue:q,maxPriceValue:xe,minPriceResever:K,maxPriceResever:Q}},[l,Y,L,ee,$,k]),tt=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[st,Be]=g.useState([0,0]),[at,it]=g.useState(0),[oe,nt]=g.useState(0),ct=w=>{console.log("ðŸš€ ~ handleSlider ~ val:",w),Be(w),O(w[0].toString()),W(w[1].toString())};return g.useEffect(()=>{if($&&k){const w=Number($),q=Number(k);Be([w,q]),console.log("ðŸš€ ~ useEffect ~ start:",w,q)}$||j("0%"),k||H("0%")},[$,k]),g.useEffect(()=>{if(R){const w=_("-100").div(100).plus(1).mul(R).toNumber(),q=_("100").div(100).plus(1).mul(R).toNumber();console.log("ðŸš€ ~ useEffect ~ min:",w,q),it(w),nt(q)}},[R]),t.jsxs(z,{w:"100%",children:[t.jsx(_s,{onClick:T,currentCoinKey:ue,whiteTokenList:ze,from:{inputTabOptions:{type:"outlineTab",tabList:tt,currentTab:p=="total"?"Total":"Per Order",handleChangeTab:w=>{y(w==null?void 0:w.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(G==null?void 0:G.balanceFormat)||"",value:S,amountValue:B,loading:!1,onChange:se,selectable:!0,placeholder:"0.0",token:s,whiteTokenList:ye,onTokenChange:w=>X(w,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(J==null?void 0:J.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:e,whiteTokenList:Ce,onTokenChange:w=>X(w,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:Oe,svgFill:"text_caption",transform:Oe==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:Oe==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>Te(!0),onMouseLeave:()=>Te(!1)}}),(D==null?void 0:D.status)&&t.jsx(Re,{tips:D==null?void 0:D.tips,bg:"primary_red_bg"}),t.jsxs(A,{w:"100%",children:[t.jsx(wt,{title:"Invest Every",label:c,inputValue:i,list:V,onListItemClick:w=>{m(w)},inputChange:w=>{console.log("ðŸš€ ~ DcaInputBlock ~ item:",w),r(w)}}),t.jsx(wt,{title:t.jsx(ys,{tooltipCon:"How many orders your want to repeat in total.",children:t.jsx(C,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:x,inputChange:w=>{n(w),ne()}})]}),(P==null?void 0:P.status)&&t.jsx(Re,{tips:P==null?void 0:P.tips,bg:"primary_red_bg"}),(U==null?void 0:U.status)&&t.jsx(Re,{tips:U==null?void 0:U.tips,bg:"primary_red_bg"}),t.jsxs(De,{zIndex:"1",p:"16px",borderRadius:"16px",children:[t.jsxs(z,{align:"flex-start",children:[t.jsx(C,{color:"text_caption",children:"Set Price Range"}),t.jsx(C,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:S?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),S&&L&&t.jsxs(A,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[t.jsx(C,{children:"Current Rate"}),t.jsx(z,{align:{base:"flex-start",lg:"flex-end"},children:t.jsx(hs,{color:"text_caption",pageDirect:l,handlePageToggleDirect:I,fromToken:s,toToken:e,fromValue:L,toValue:u,isLoading:F||!u||!L})})]})]}),t.jsxs(A,{justify:"space-between",gap:"8px",mt:"20px",children:[t.jsx(jt,{direct:l,text:S&&$?v:"",inputValue:$,inputChange:w=>O(w),align:"flex-start"}),t.jsx(C,{color:"text_caption",children:"-"}),t.jsx(jt,{direct:l,text:S&&k?d:"",inputValue:k,inputChange:w=>W(w),align:"flex-start"})]}),!F&&S&&$&&k&&Number(k)>=Number($)&&(f==null?void 0:f.text)!=="No Available Route"&&t.jsxs(z,{w:"100%",gap:"0",mt:"20px",children:[t.jsxs(qt,{min:at,max:oe,step:.1,value:st,onChange:w=>{ct(w)},colorScheme:"teal",children:[t.jsx(Yt,{children:t.jsx(Kt,{})}),t.jsx(dt,{index:0}),t.jsx(dt,{index:1})]}),t.jsx(Qt,{src:ds,w:"32px",h:"32px"}),t.jsx(A,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:t.jsx(C,{children:"Current Rate"})})]})]}),(N==null?void 0:N.status)&&t.jsx(Re,{tips:N==null?void 0:N.tips,bg:"primary_red_bg"}),t.jsx(de,{isLoading:le,disabled:(f==null?void 0:f.disabled)||le,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",onClick:(f==null?void 0:f.text)=="Connect Wallet"?()=>fe(!0):()=>We(!0),children:f==null?void 0:f.text}),S&&t.jsx(Es,{detailsData:_e}),Le&&t.jsx(Ms,{confirmData:_e,isOpen:Le,onClose:()=>We(!1),toOpenDca:Ie,toOpenDcaLoading:le}),(e||s)&&t.jsx(Ss,{addToken:!0,tokensInfo:Xe,waringModalCancel:w=>{w.forEach(q=>{(q.coin_type===(e==null?void 0:e.coin_type)||q.coin_type===(s==null?void 0:s.coin_type))&&X(void 0,q.coin_type===(e==null?void 0:e.coin_type))})}})]})}function zs(a){const n=Math.floor(a/2592e3);a%=2592e3;const i=Math.floor(a/604800);a%=604800;const x=Math.floor(a/86400);a%=86400;const c=Math.floor(a/3600);a%=3600;const m=Math.floor(a/60);a%=60;const l=[];return n>0&&l.push(`${n} Month${n>1?"s":""}`),i>0&&l.push(`${i} Week${i>1?"s":""}`),x>0&&l.push(`${x} Day${x>1?"s":""}`),c>0&&l.push(`${c} Hour${c>1?"s":""}`),m>0&&l.push(`${m} Minute${m>1?"s":""}`),l.join(" ")}function Ls(){const{getTokenListInfo:a}=kt(),s=we("dca"),e=async c=>{var m;console.log("ðŸš€ ~ getDcaOrderList ~ walletAddress:",c);try{const l=await s.Dca.getDcaOrders(c);return console.log("ðŸš€ ~ getDcaOrderList ~ list:",l),l&&(l!=null&&l.data)&&((m=l==null?void 0:l.data)==null?void 0:m.length)>0?await x(l==null?void 0:l.data):{activeResult:[],pastResult:[]}}catch(l){return console.log("ðŸš€ ~ getDcaOrderList ~ error:",l),{activeResult:[],pastResult:[]}}},S=async c=>{try{const m=await a(c),l=new Map;return m==null||m.forEach((b,p)=>{const y=me.pow(10,b==null?void 0:b.decimals);l.set(p,{token:b,decimalsPow:y})}),l}catch(m){console.log("ðŸš€ ~ getTokenListDetails ~ error:",m)}},u=(c,m,l,b,p)=>{const y=_(c).div(m).div(_(b).div(l)).toString(),h=_(c).div(m).div(_(p).div(l)).toString();return{minPrice:y,maxPrice:h,minPriceResever:_(1).div(_(h)).toString(),maxPriceResever:_(1).div(_(y)).toString()}},r=c=>c.in_withdrawn>0&&c.in_withdrawn==c.in_deposited?"Close":c.in_withdrawn>0&&c.out_withdrawn>0?"PartialDeal":c.amount_left_next_cycle==0&&c.next_cycle_at==0?"AllDeal":"Active",n=(c,m,l,b,p,y,h)=>{const d=v=>v==="--"?"--":_(1).div(v).toString();switch(c){case"Close":return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"};case"PartialDeal":{const v=m.sub(l).div(y).toString(),j=m.sub(l).div(m).mul(100).toDP(2,me.ROUND_HALF_UP).toString();return console.log("ðŸš€ ~ useGetDcaOrderList ~ inDeposited:",l,m),{currentAvgPrice:v,currentAvgPriceResever:d(v),inBalanceRatio:j,inDepositedOut:m.sub(l).toString()}}case"AllDeal":{const v=m.div(y).toString();return{currentAvgPrice:v,currentAvgPriceResever:d(v),inBalanceRatio:"100",inDepositedOut:m.sub(b).toString()}}case"Active":{const v=p.gt(0)||y.gt(0)?m.sub(b).div(p.add(y)).toString():"--",j=m.sub(b).div(m).mul(100).toDP(2,me.ROUND_HALF_UP).toString();return{currentAvgPrice:v,currentAvgPriceResever:d(v),inBalanceRatio:j,inDepositedOut:m.sub(b).toString()}}default:return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"}}},i=(c,m,l,b)=>{const p=Date.now()/1e3,y=_(p).sub(c).div(m),h=l.lte(0)&&_(b).lte(0);return y.gt(3)&&h},x=async c=>{const m=[],l=[],b=[];c==null||c.forEach(d=>{b.push(d.in_coin_type),b.push(d.out_coin_type)});const p=await S(b);if(p)for(const d of c){const{token:v,decimalsPow:j}=p.get(d.in_coin_type),{token:H,decimalsPow:R}=p.get(d.out_coin_type),f=_(d.in_deposited).div(j);console.log("ðŸš€ ~ buildDcaOrderList ~ order.in_deposited:",d.in_deposited,j);const F=_(d.in_deposited).div(d.in_amount_per_cycle).floor().toString(),G=_(d.in_amount_per_cycle).div(j).toString(),J=_(d.in_balance).div(j),B=_(d.in_withdrawn).div(j),se=_(d.out_balance).gt(0)?_(d.out_balance).div(R):_(0),X=_(d.out_withdrawn).div(R),$=E(f.div(F).toString()),k=J.div(G).floor().toNumber(),{minPrice:O,maxPrice:W,minPriceResever:I,maxPriceResever:T}=u(d.in_amount_per_cycle,j,R,d.max_out_amount_per_cycle,d.min_out_amount_per_cycle),D=r(d),{currentAvgPrice:P,currentAvgPriceResever:U,inBalanceRatio:N,inDepositedOut:L}=n(D,f,B,J,se,X),Y=i(Number(d.created_at),Number(d.cycle_frequency),se,X),ee={createAt:Me(Number(d.created_at)*1e3,"YMDHM"),cycleFrequency:d.cycle_frequency,orderID:d.id,inAmountPerCycle:G,nextCycleAt:Me(Number(d.next_cycle_at)*1e3,"YMDHM"),inDeposited:f.toString(),cycleCount:F,inDepositedOut:L,inBalance:J.toString(),minPrice:E(O),maxPrice:E(W),minPriceResever:E(I),maxPriceResever:E(T),inCoin:v,outCoin:H,outBalance:se.toString(),inBalanceRatio:N,outWithdraw:X.toString(),investEvery:zs(Number(d.cycle_frequency)),eachOrderSize:$,currentAvgPrice:P==="--"?"--":E(P,H.decimals),currentAvgPriceResever:P==="--"?"--":E(U,v.decimals),orderStatus:D,inWithdrawn:B.toString(),ofOrderLeft:k,isShowTradeTips:Y,next_cycle_at:d.created_at+k*Number(d.cycle_frequency),created_at:d.created_at,version:d.version};D==="Active"?m.push(ee):l.push(ee)}const y=m==null?void 0:m.sort((d,v)=>v.version-d.version),h=l==null?void 0:l.sort((d,v)=>v.version-d.version);return console.log("ðŸš€ ~ buildDcaOrderList ~ activeResult, pastResult:",y,h,m,l),{activeResult:y,pastResult:h}};return{getDcaOrderList:e}}function wa(){const[a,s]=g.useState([]),[e,S]=g.useState([]),{currentAccount:u}=Ke(),{sellCoin:r,buyCoin:n,setIsDcaRefresh:i}=ie(),[x,c]=g.useState(!0),{isShowTradeChart:m,isShowTradeOrders:l}=vs(),{getDcaOrderList:b}=Ls(),{fetchAccountBalance:p}=mt(),y=async(R,f=!1)=>{if(!l)return;f&&c(!0);const{activeResult:F,pastResult:G}=await b(R);s(F),S(G),c(!1),console.log("ðŸš€ ~ handleGetDcaOrderList ~ list:",F,G)};g.useEffect(()=>{u!=null&&u.address?y(u==null?void 0:u.address,!0):(s([]),S([]))},[u==null?void 0:u.address,l]);const h=(R=!0)=>{H(0),i(!0),setTimeout(()=>{i(!1)},1e3),u!=null&&u.address&&(R||p(),y(u==null?void 0:u.address,R))};ws({onRpcChange:()=>{h()}}),g.useEffect(()=>{u!=null&&u.address&&p()},[u==null?void 0:u.address]);const{isApp:d,windowWidth:v}=Ye(),[j,H]=g.useState(0);return Ds({interval:1e3,callback:()=>{H(j+1),j>=20&&h(!1)}}),t.jsxs(A,{mt:v&&v<1024?"28px":"42px",className:d||m||l?"":"bg_img",w:"100%",gap:"16px",justify:"center",align:"flex-start",flexDirection:{base:"column",lg:"row"},children:[(l||m)&&t.jsxs(z,{w:{base:"100%",lg:"calc(100% - 470px)"},mt:d&&!m?"-16px":"0",children:[m&&t.jsx(bs,{baseToken:r,quoteToken:n}),l&&!d&&t.jsx(Dt,{handleRefresh:h,activeList:a,pastList:e,isOrderLoading:x})]}),t.jsxs(z,{w:{base:"100%",lg:"470px"},children:[t.jsxs(A,{w:"100%",justify:"space-between",mb:"8px",children:[t.jsx(Jt,{currTradeTab:It.DCA}),t.jsx(Zt,{})]}),t.jsx($s,{handleGetDcaOrderList:R=>y(R)})]}),d&&l&&t.jsx(z,{w:{base:"100%",lg:"calc(100% - 470px)"},children:t.jsx(Dt,{handleRefresh:h,activeList:a,pastList:e,isOrderLoading:x})})]})}export{wa as default};
//# sourceMappingURL=Dca-29Os9M_p.js.map

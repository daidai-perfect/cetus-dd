import{a as d,x as be,j as e,V as D,F as nt,a9 as ze,H as k,I as Se,T as m,C as K,q as N,f as q,W as ot,X as it,Y as at,Z as rt,$ as lt,a0 as ct,aa as Be,p as ae,P as Tt,h as kt,k as Pt,m as Lt,n as Ot,N as At,az as Dt,O as Rt,Q as Ft,aq as Ge}from"./vendor-BFGDaAdA.js";import{u as pt}from"./global-JZuWLvX4.js";import{k as X,aE as Ht,I as $,C as le,a as G,j as me,n as Te,o as ce,a2 as zt,d as V,s as Bt,e as he,f as I,O as oe,G as se,B as Z,h as dt,r as qe,aF as ve,F as ut,R as xt,M as re,q as Ut,W as Vt,c as gt,ak as Et,v as J,ap as te,ao as fe,l as ie,aG as Mt,aH as Ke,p as _e,aI as Wt,aJ as $t,aj as Nt,aK as Xt,$ as Gt,aL as qt,aM as Qe,aN as Ie,P as Kt}from"./index-CsPKGWlY.js";import{N as ee}from"./NoData-DtiZhmrM.js";import{u as Qt,R as ht,A as It}from"./RecentTransactions-Pd6bZdK-.js";import{A as Yt}from"./AccountSwitchDrawer-WYnIs2e6.js";import{a as je,u as Ue,e as Ve,i as Jt,j as Zt,f as es,c as ts,k as ss}from"./VaultsAprBlock-COxZSCte.js";import{a as pe,d as ns,u as os,g as is,e as as,f as rs,h as ls,c as cs,b as ps}from"./usePositionList-BPMsdwpb.js";import{a as ds,b as us,P as xs,u as gs}from"./PoolItem-Cl8qYqPm.js";import{u as Q}from"./activeOrders-uVChzjI-.js";import{P as hs,V as fs,H as Y}from"./PositionListLoading-71Tg5Kbk.js";import{C as bs}from"./CoinPairInfo-Cr8MhVyV.js";import{u as ft}from"./VaultsAction-BhAQPjr-.js";import{V as ms}from"./VaultsHoldings-B6hcABI3.js";import{H as ke,T as Pe}from"./Table--cX_ddxf.js";import{S as bt}from"./SortDropBlock-D8lZoOWf.js";import{T as ge}from"./TableSortTh-CbrZdTvU.js";import{u as mt,D as jt,g as js,e as ws,f as ys,W as Cs,b as _s,R as vs,a as Ss,d as Ts}from"./OverviewOrders-CumsVzW2.js";import{I as Re}from"./IconText-7r1g1qjW.js";import{u as ks}from"./RangeValue-C4l-pSlr.js";import{D as Le}from"./Drawer-EtlaKnAi.js";import{H as ne}from"./HTextLabelBox-B1Y-tnaP.js";import{P as Oe}from"./Pagination-CVXMK1J3.js";import{u as Ps}from"./useRpcListener-Z38ZXjg1.js";import{b as Ls,u as we,c as Os,C as As,P as Ds,F as Rs,E as Fs,S as Hs,O as zs,a as Bs}from"./useGetLimitOrderHistory-C3MD1nDc.js";import{R as Us}from"./RefreshButton-B6C3oAGm.js";import{u as Vs}from"./useAccountBalance-BABoQotY.js";import{u as wt}from"./useToken-CcYMprru.js";import{f as Ee,a as Es,b as Ms,u as Ws,X as $s,c as Ns,C as Xs,e as Gs,d as qs,g as Ks}from"./useXCetus-Coh6Dd_f.js";import{S as yt}from"./SingleTokenInfo-iqQSVf8-.js";import{u as Qs}from"./useTokenBalance-ggXN92gw.js";import{X as Is,a as Ys,b as Js,c as Zs}from"./useXCetusHelper-BZ3t3rLl.js";import{B as en}from"./BackButton-eJFmkwxU.js";import"./CopyButton-BZ6j01rh.js";import"./useGetPoolList-C5BbIRyA.js";import"./useWrapPoolData-CupRl2Mj.js";import"./useFavoritePool-BEjS1wEY.js";import"./CheckBox-wfhQYPt0.js";import"./SearchInputBlock-CUyjUB8A.js";import"./index-BBtpH8vb.js";import"./Loading-yKVeoG31.js";import"./TooltipIcon-DQSR-A2e.js";import"./PositionCurrentPrice-Db3c8a9-.js";import"./contract-helper-knphA12I.js";import"./msafe-oYBkW7LJ.js";import"./useTransaction-B4tl6mtG.js";import"./useTrack-4ZTqrnXN.js";import"./useSigner-J-p9il0w.js";import"./ExpendItem-CUAJ9ijH.js";import"./PositionStatus-D3krLqLX.js";import"./useInterval-BQqGpXj5.js";import"./PoweredByHaedal-Bke0Bj0w.js";import"./VTextLabelBox-C6ShXrtu.js";import"./useNotifiSubscription-DKxWk9JK.js";import"./useNotifiAlerts-DTB89ktP.js";import"./usePriceImpact-CE661CIo.js";import"./index-DXp154Wy.js";import"./useSwapHelper-BbV95UB1.js";import"./TradeConfirmAmountInfo-B6OswkDV.js";import"./TotalAmount-DWFQL572.js";import"./TradeInputGroup-DcEHIpjU.js";import"./_getAllKeysIn-W_NYUSqz.js";import"./RemoveBlock-CQ11xRGC.js";import"./DepositRatio-CLMaNzaq.js";import"./FreshProgressV2-D4fRsWvM.js";import"./ErrorTips-WU6uqrgJ.js";import"./index-CZrip_I0.js";import"./usePosAdd-DxbEA5Zh.js";import"./index-gw5hlumX.js";import"./useFindBestRouting-BKBIoNLc.js";import"./useVaultsHoldings-CZsdBuQx.js";import"./usePreviousValue-DoVr3Y3V.js";import"./HighlightText-fkyigc44.js";import"./index-D1m9ooSc.js";import"./debounce-B8kzHASh.js";import"./index-BLCSsYSf.js";function tn(t=100){const o=d.useRef([]),s=d.useRef(!1),a=d.useRef(void 0),l=d.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const i=o.current.shift();if(!i)continue;const{id:c,run:p,onStart:u,onSuccess:h,onError:v}=i;if(i._cancelled){console.log(`[task:${i.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),u==null||u(c);const b=await p(a.current,c);a.current=b,console.log(`[task:${c}] success`,b),h==null||h(b,c)}catch(b){console.error(`[task:${c}] failed`,b),v==null||v(b,c)}await new Promise(b=>setTimeout(b,t))}s.current=!1}},[t]),r=i=>{o.current.push(i),l()},n=i=>{const c=o.current.find(p=>p.id===i);c&&(c._cancelled=!0),o.current=o.current.filter(p=>p.id!==i)};return d.useEffect(()=>()=>{o.current=[],s.current=!1,a.current=void 0},[]),{addTask:r,removeTask:n}}function sn({totalValue:t,onRefreshTask:o,isLoading:s,children:a}){const[l,r]=d.useState(!1),{currentAccount:n,onWalletModal:i,accounts:c,accountServiceNameObj:p}=X(),{isShowProfileAssets:u,setIsShowProfileAssets:h}=pt(),[v,b]=d.useState(!1);d.useEffect(()=>{r(!0)},[]);const{isOpen:x,onClose:P,onToggle:O}=be(),{getServiceNames:H}=Qt(),T=d.useCallback(()=>{x||H(c),O(),console.log("AccountSwitch###handleClick###isOpen: ",x)},[x,c]);return console.log(n,p,c,"currentAccount-H5Main"),e.jsxs(D,{w:"100%",mt:"28px",children:[l?n!=null&&n.address?e.jsxs(D,{w:"100%",gap:"16px",alignItems:"flex-start",children:[e.jsxs(k,{w:"100%",children:[e.jsx(Se,{src:"/images/img_profile@2x.png",w:"72px",h:"72px"}),e.jsxs(D,{align:"flex-start",children:[e.jsxs(k,{w:"100%",borderRadius:"8px",justify:"space-between",children:[e.jsxs(k,{gap:"4px",cursor:"pointer",onClick:T,children:[e.jsxs(D,{align:"flex-start",children:[(n==null?void 0:n.label)&&e.jsx(m,{fontSize:"14px",lineHeight:"14px",children:nn(n==null?void 0:n.label)}),e.jsx(m,{color:"text_caption",fontSize:"16px",fontWeight:"500",lineHeight:"14px",children:(p==null?void 0:p[n==null?void 0:n.address])||Ht(n==null?void 0:n.address)})]}),e.jsx($,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),e.jsx(le,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(m,{fontSize:"12px",children:u?"Hide Value":"Show Value"}),children:e.jsx(K,{children:e.jsx($,{xlinkHref:u?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>h(!u)})})})]}),e.jsxs(k,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>b(!0),children:[e.jsx(m,{h:"16px",lineHeight:"16px",children:"Transactions"}),e.jsx($,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]})]}),a]}):e.jsx(ee,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>i(!0)}):e.jsx(nt,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})}),e.jsx(Yt,{isOpen:x,onClose:P}),v&&e.jsx(ht,{isOpen:v,onClose:()=>b(!1)})]})}const nn=t=>(t==null?void 0:t.length)>16?(t==null?void 0:t.substring(0,6))+"..."+(t==null?void 0:t.substring((t==null?void 0:t.length)-10)):t;function Me(t){const{type:o,children:s,wrapStyle:a,menuHeight:l="60px",haveActiveLine:r=!0,textStyle:n={fontSize:"16px"}}=t,i=(c,p)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(c,p):c===p.value;return G(),e.jsxs(k,{justify:"space-between",w:"100%",h:l,...a,sx:{">div":{p:{"&:before":{bg:r?"primary":"none"}}}},children:["title"in t?e.jsx(m,{color:"text_caption",...n,children:t==null?void 0:t.title}):e.jsx(me,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(c,p)=>i(c,p),wrapStyle:{h:l,border:"none",gap:"38px",...a},itemStyle:n}),s]})}function on({showPosListGroupByPool:t=[]}){var r;const{currentAccount:o,onWalletModal:s}=X(),{posBaseListLoading:a}=pe(),{isAutoRefresh:l}=Q();return e.jsxs(D,{w:"100%",children:[e.jsx(ds,{isProfile:!0}),o!=null&&o.address?!l&&a?[{},{},{},{}].map((n,i)=>e.jsx(hs,{},i)):((r=Object.values(t))==null?void 0:r.length)>0?Object.values(t).map((n,i)=>e.jsx(us,{poolInfo:n,isProfile:!0},i)):e.jsx(ee,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(ee,{type:"nowallet",onboard:()=>s(!0),noBorder:!0})]})}function an({poolInfo:t}){const{setProfileActionTab:o,isProfileOpenVaultModal:s,setIsProfileOpenVaultModal:a,clearVaultsActionData:l,setProfilePoolInfo:r}=ft();return d.useEffect(()=>{l()},[s]),e.jsx(e.Fragment,{children:e.jsxs(k,{justify:"flex-end",flexDirection:{base:"row-reverse",lg:"row"},w:{base:"100%",lg:"unset"},children:[e.jsx(N,{onClick:()=>{o("Deposit"),a(!0),r(t)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 26px)",lg:"unset"},children:"Deposit"}),e.jsx(N,{onClick:()=>{o("Withdraw"),a(!0),r(t)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 26px)",lg:"unset"},children:"Withdraw"})]})})}function rn({selectCoinList:t=[]}){const{vaultsPositionObj:o}=je(),{vaultPageList:s,vaultListLoading:a,setVaultListLoading:l}=Ue(),{filterVaultList:r,getCurrentTabNum:n}=Ve(),{profileActionTab:i,isProfileOpenVaultModal:c,setIsProfileOpenVaultModal:p,profilePoolInfo:u}=ft(),{coinPriceObj:h}=Te(),{getTokenAmountValue:v}=ce(),{getTokenAmountValueByPyth:b}=Jt(),{pythPriceMap:x}=Zt(),{isAutoRefresh:P}=Q(),{isApp:O}=G(),[H,T]=d.useState([]),[g,j]=d.useState("desc"),[f,L]=d.useState({label:"",value:""}),[R,z]=d.useState("all"),w=!0,A={sortRule:"desc",sortType:"tvl"},S=[{label:"Your Holdings",value:"holdings"},{label:"Share of Pool",value:"shareOfPool"}],_=Object.fromEntries(S.map(y=>[y.value,y])),F=(y,U,W)=>y.category==="haedal"?b(U,W):v(U,W,"--"),M=d.useMemo(()=>["all","cetus","haedal"].map(y=>({label:y[0].toUpperCase()+y.slice(1),value:y,num:n({sortOptions:A,currentTab:y,isYourHoldings:w,selectCoinList:t})||""})),[JSON.stringify(H),w,JSON.stringify(t)]);d.useEffect(()=>{f.value||T(s)},[s]),d.useEffect(()=>{zt(o)&&r({sortOptions:A,currentTab:R,isYourHoldings:w,selectCoinList:t})},[o,t]),d.useEffect(()=>{if((s==null?void 0:s.length)>0&&f.value){const y=s.map(U=>{const W=o[U==null?void 0:U.vaultId]||{},de=F(U,W.displayCoinTypeA,W.displayAmountA),ue=F(U,W.displayCoinTypeB,W.displayAmountB),xe=de==="--"||ue==="--"?"0":V(de).plus(ue||0).toString();return{...U,sharePoolRate:W==null?void 0:W.sharePoolRate,holdingAmount:parseFloat(xe||"0"),holdingAmountDisplay:Bt(xe,"$")}}).sort((U,W)=>g==="asc"?f.value==="holdings"?U.holdingAmount-W.holdingAmount:U.sharePoolRate-W.sharePoolRate:f.value==="holdings"?W.holdingAmount-U.holdingAmount:W.sharePoolRate-U.sharePoolRate);T(y)}},[s.length,f.value,g,h,x]);const B=y=>{y!==R&&!a&&(z(y),r({sortOptions:A,currentTab:y,isYourHoldings:w,selectCoinList:t}),l(!0),setTimeout(()=>l(!1),200))},E=y=>{(y==null?void 0:y.value)!==(f==null?void 0:f.value)?(L(y),j("desc")):O||j(U=>U==="desc"?"asc":"desc")},C=ln({isShowPowered:R!=="haedal",vaultsPositionObj:o,getAmountValue:F,sortRule:g,sortBy:f,sortByObject:_,clickSort:E});return e.jsxs(D,{w:"100%",align:"flex-start",children:[O&&e.jsx(bt,{sortText:"Sort by",minW:"calc(100vw - 76px)",boxHeight:"32px",currentSort:f,sortByList:S,onSortByChange:E,xlinkHref:g==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>j(y=>y==="desc"?"asc":"desc"),wrapStyle:{height:"30px"}}),e.jsx(me,{type:"outlineTab",tabList:M,currentTab:R,handleChangeTab:y=>B(y.value),isActive:(y,U)=>y===U.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),e.jsx(D,{w:"100%",gap:"20px",children:(P||!a)&&H.length===0?e.jsx(ee,{type:"nodata",text:"No vaults found",noBorder:!0}):O?e.jsx(ke,{rowKey:"clmmPoolAddress",columns:C,dataSource:H,loading:!P&&a,itemSkeletonLength:5,itemHeight:"30px",haveDividingLine:!1,rowStyle:()=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Pe,{rowKey:"clmmPoolAddress",columns:C,dataSource:H,loading:!P&&a,rowStyle:{h:"80px",cursor:"pointer"}})}),c&&e.jsx(fs,{isOpen:c,setIsOpen:p,...u,currentTab:i},u.vaultId)]})}const ln=({isShowPowered:t,vaultsPositionObj:o,getAmountValue:s,sortRule:a,sortBy:l,sortByObject:r,clickSort:n})=>[{title:e.jsx(m,{children:"Pools"}),key:"pools",thConfig:{pl:"0px !important"},render:i=>e.jsx(bs,{poolInfo:{...i,poolAddress:i==null?void 0:i.vaultId},isShowPowered:t,symbolFontSize:"15px"})},{title:e.jsx(ge,{labelInfo:r.holdings,sortBy:l,sortRule:a,clickSort:i=>n(i)}),key:"holdings",render:i=>{var h,v,b,x,P,O;const c=o[i==null?void 0:i.vaultId]||{},p=s(i,(h=i==null?void 0:i.displayTokenA)==null?void 0:h.coin_type,c==null?void 0:c.displayAmountA),u=s(i,(v=i==null?void 0:i.displayTokenB)==null?void 0:v.coin_type,c==null?void 0:c.displayAmountB);return e.jsx(le,{placement:"top",tooltip:e.jsxs(D,{gap:"8px",align:"flex-start",minW:"200px",children:[e.jsxs(k,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(k,{children:[e.jsx(he,{imageUrl:(b=i==null?void 0:i.displayTokenA)==null?void 0:b.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(m,{color:"text_caption",fontSize:"12px",children:(x=i==null?void 0:i.displayTokenA)==null?void 0:x.symbol})]}),e.jsx(Y,{children:e.jsxs(D,{align:"flex-end",children:[e.jsx(m,{color:"text_caption",fontSize:"12px",children:I(c==null?void 0:c.displayAmountA)}),e.jsx(m,{fontSize:"12px",children:!p||p=="--"?"$--":oe(p,2)})]})})]}),e.jsx(q,{w:"100%",height:"1px",bg:"border"}),e.jsxs(k,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(k,{children:[e.jsx(he,{imageUrl:(P=i==null?void 0:i.displayTokenB)==null?void 0:P.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(m,{color:"text_caption",fontSize:"12px",children:(O=i==null?void 0:i.displayTokenB)==null?void 0:O.symbol})]}),e.jsx(Y,{children:e.jsxs(D,{align:"flex-end",children:[e.jsx(m,{color:"text_caption",fontSize:"12px",children:I(c==null?void 0:c.displayAmountB)}),e.jsx(m,{fontSize:"12px",children:!u||u=="--"?"$--":oe(u,2)})]})})]})]}),children:e.jsx(K,{as:"button",ml:"4px",children:e.jsx(Y,{children:e.jsxs(k,{justifyContent:"flex-end",gap:"0",children:[e.jsx(m,{color:"text_caption",mr:"2px",textDecoration:"underline dotted",textUnderlineOffset:"3px",children:`${(c==null?void 0:c.balanceDisplay)||"0"} LP`}),e.jsx(m,{children:"("}),e.jsx(ms,{color:"text_paragraph",vaultId:i.vaultId,category:i.category}),e.jsx(m,{children:")"})]})})})})}},{title:e.jsx(ge,{labelInfo:r.shareOfPool,sortBy:l,sortRule:a,clickSort:i=>n(i)}),key:"shareOfPool",render:i=>{const c=o[i==null?void 0:i.vaultId]||{};return console.log("🚀 ~ vaultsPositionObj:",o,c),e.jsx(k,{justify:"flex-end",children:e.jsx(Y,{children:e.jsxs(m,{color:"text_caption",children:[" ",c==null?void 0:c.shartOfPoolDisplay]})})})}},{title:e.jsx(m,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,render:i=>e.jsx(an,{poolInfo:i})}];function Ye(){const{currentAccount:t}=X(),{vaultsPositionObj:o}=je(),{showPosListLength:s,posBaseListLoading:a,setShowPosListLength:l,posBaseListGroupByPool:r}=pe(),{getCurrentTabNum:n}=Ve(),[i,c]=d.useState([]),p=g=>{console.log("🚀 ~ onClickIncentiveTypes ~ tokenInfo:",g),c(j=>[...j,g])},u=g=>{console.log("🚀 ~ onClickIncentiveTypes ~ tokenInfo:",g),c(j=>j.filter(f=>(f==null?void 0:f.coin_type)!==(g==null?void 0:g.coin_type)))};d.useEffect(()=>{t!=null&&t.address||l("")},[t==null?void 0:t.address]),d.useEffect(()=>()=>{l("")},[]);const[h,v]=d.useState("positions"),b={sortRule:"desc",sortType:"tvl"},x=!0,P=d.useMemo(()=>{const g=h=="positions"?[]:i;return[{label:"Positions",value:"positions",num:a?"":Number(s)},{label:"Vaults",value:"vaults",num:n({sortOptions:b,currentTab:"all",isYourHoldings:x,selectCoinList:g})||""}]},[a,s,i,o]),[O,H]=d.useState([]);d.useEffect(()=>{var z,w,A,S;const g=h=="vaults"?[]:i,j=(z=g[0])!=null&&z.coin_type?se((w=g[0])==null?void 0:w.coin_type):void 0,f=(A=g[1])!=null&&A.coin_type?se((S=g[1])==null?void 0:S.coin_type):void 0,L=Object.values(r).filter(_=>j&&f?se(_.tokenA.coin_type)==j&&se(_.tokenB.coin_type)==f||se(_.tokenA.coin_type)==f&&se(_.tokenB.coin_type)==j:j?se(_.tokenA.coin_type)==j||se(_.tokenB.coin_type)==j:_);console.log("🚀 ~ useEffect ~ filterArr:",Object.values(r),L),H(L);const R=L.reduce((_,F)=>_+(F.list?F.list.length:0),0);t!=null&&t.address&&l(R.toString())},[i,r]);const{isApp:T}=G();return e.jsx(Z,{borderRadius:"16px",p:{base:"0",lg:"0px 16px 16px"},bg:{base:"none",lg:"bg_primary_opacity.90"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",children:e.jsxs(D,{gap:{base:"8px",lg:"16px"},w:"100%",children:[e.jsxs(k,{w:"100%",gap:"12px",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Me,{type:"tab",currentTab:h,tabs:P,menuHeight:T?"20px":"60px",haveActiveLine:!1,onTabChange:g=>{c([]),v(g.value)},textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(xs,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:i,onClickSelectCoinList:p,onDeleteSelectCoinList:u})]}),!T&&e.jsx(q,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),h==="positions"&&e.jsx(on,{showPosListGroupByPool:O}),h==="vaults"&&e.jsx(rn,{selectCoinList:i})]})})}function cn({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:a,outCoin:l}=t,{orderHistoryList:r,handleGetDcaOrderHistory:n,orderHistoryListLoading:i}=mt();d.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=dt(),[p,u]=d.useState(s),h=142,v=(r==null?void 0:r.length)||0,b=(r==null?void 0:r.length)==0?"0px":(r==null?void 0:r.length)<=1?`${h*v+8}px`:`${h*v+(v-1)*32+8}px`;return e.jsxs(D,{pb:"16px",align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(r==null?void 0:r.length)>=3?"460px":"unset",overflowY:"auto",children:[!i&&e.jsx(q,{w:"0px",h:b,borderRight:"1px dashed",borderColor:"border",position:"absolute",left:"6px",top:"8px"}),i?e.jsx(k,{h:"100px",w:"100%",justify:"center",children:e.jsx(ze,{})}):(r==null?void 0:r.length)===0?e.jsx(ee,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):r.map(x=>{const P=qe(x.inAmount,a==null?void 0:a.decimals),O=qe(x.outAmount,l==null?void 0:l.decimals),H=V(P).div(O).toString(),T=V(1).div(H).toString();return e.jsxs(D,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(k,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(m,{h:"20px",lineHeight:"20px",children:[ve((x==null?void 0:x.time)*1e3)," (UTC)"]}),e.jsx($,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(x==null?void 0:x.tx,"tx"))}}),e.jsx(k,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(q,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(Z,{p:"16px",borderRadius:"12px",children:e.jsxs(D,{align:"flex-start",gap:"20px",children:[e.jsxs(D,{gap:"0px",align:"flex-start",children:[e.jsx(m,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:p?`${I(H)} `:`${I(T)} `}),e.jsxs(k,{children:[e.jsxs(m,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",p?` ${a.symbol} per ${l.symbol}`:` ${l.symbol} per ${a.symbol}`,")"]}),e.jsx($,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>u(!p)})]})]}),e.jsxs(k,{w:"100%",gap:"4px",children:[e.jsx(he,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(m,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${I(P)}`}),e.jsx(m,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${a.symbol}`}),e.jsx(m,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" → "}),e.jsx(he,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(m,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${I(O)}`}),e.jsx(m,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${l.symbol}`})]})]})})]},x==null?void 0:x.tx)})]})}function pn({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:a=!1,toClaim:l}){const{inCoin:r,outCoin:n}=t;return e.jsxs(D,{pb:"24px",children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(dn,{}),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(jt,{orderInfo:t}),o&&l&&e.jsx(N,{isLoading:a,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(m,{fontSize:"16px",color:"text_caption",children:js(t,o,!0)}),e.jsx(m,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(k,{w:"100%",justify:"space-around",children:[e.jsxs(D,{children:[e.jsx(m,{fontSize:"16px",color:"text_caption",children:ws(t)}),e.jsxs(m,{fontSize:"12px",children:["DCA ",r==null?void 0:r.symbol," Balance"]})]}),e.jsx(q,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(D,{children:[e.jsx(m,{color:"text_caption",fontSize:"16px",children:ys(t)}),e.jsxs(m,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(D,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(ne,{label:"Invest Every",value:t==null?void 0:t.investEvery}),V(t==null?void 0:t.ofOrderLeft).gt("0")&&e.jsx(ne,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(ne,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${r==null?void 0:r.symbol}`}),o&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(ne,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${r==null?void 0:r.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${r==null?void 0:r.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(ne,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${r==null?void 0:r.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${r==null?void 0:r.symbol}`}),o&&e.jsx(ne,{label:"Next Order (UTC)",value:ve(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(ne,{label:"Created (UTC)",value:ve(t==null?void 0:t.createAt)||""})]})]})}const dn=()=>{const[t,o]=d.useState(!1);return e.jsxs(D,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(k,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(m,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx($,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(D,{align:"flex-start",w:"100%",children:[e.jsx(q,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Cs,{})]})]})};function un({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:a,isClaimLoading:l=!1,toClaim:r}){const{isApp:n}=G(),[i,c]=d.useState("overview"),{inCoin:p,outCoin:u}=s||{},h=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[v,b]=d.useState(!1),{getTokenRank:x}=ks();d.useEffect(()=>{if(p!=null&&p.coin_type&&(u!=null&&u.coin_type)){const H=x(p,u);console.log("🚀 ~ TokenRank:",u,p,H),b(!H)}},[p==null?void 0:p.coin_type,u==null?void 0:u.coin_type]);const P=e.jsx(q,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Me,{type:"tab",currentTab:i,tabs:h,onTabChange:H=>c(H.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})}),O=e.jsxs(e.Fragment,{children:[i==="overview"&&e.jsx(pn,{orderInfo:s,isActiveOrder:a,pageDirect:v,isClaimLoading:l,toClaim:r}),i==="orders"&&e.jsx(cn,{orderInfo:s,isActiveOrder:a,pageDirect:v})]});return n?e.jsx(xn,{isOpen:t,onClose:o,renderTabs:P,renderContent:O}):e.jsxs(ot,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(it,{}),e.jsxs(at,{minWidth:"482px",children:[e.jsx(rt,{children:P}),e.jsx(lt,{}),e.jsx(ct,{p:"0 16px 0px",textAlign:"center",children:O})]})]})}function xn({isOpen:t,onClose:o,renderTabs:s,renderContent:a}){return console.log("DetailDrawer rendered",t),e.jsxs(Le,{isOpen:t,onClose:o,placement:"bottom",haveCloseButton:!0,children:[s,e.jsx(q,{h:"20px"}),a]})}function gn({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=G(),[a,l]=d.useState(!1),{getExplorerUrl:r}=dt(),{isClaimLoading:n,toClaim:i,closeOrderAction:c,isCloseLoading:p}=mt(),{isOpen:u,onOpen:h,onClose:v}=be(),b=()=>l(!0),x=()=>{p||c(t)},P=(t==null?void 0:t.outBalance)<=0||n;return e.jsxs(e.Fragment,{children:[e.jsx(k,{justify:"flex-end",children:o?e.jsxs(e.Fragment,{children:[e.jsx(N,{isLoading:n,onClick:()=>i(t),disabled:P,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(100vw - 84px)",lg:"unset"},children:"Claim"}),e.jsx(le,{placement:"bottom-end",showTooltip:!s,tooltip:e.jsx(Ct,{getExplorerUrl:r,orderInfo:t,closeOrderAction:x,handleOpenDetail:b}),children:e.jsx(K,{children:e.jsx(N,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",onClick:s?h:void 0,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx($,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{w:{base:"calc(100vw - 84px)",lg:"unset"},onClick:b,h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(N,{onClick:O=>{ut(O),window.open(r(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx($,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]})}),a&&e.jsx(un,{isOpen:a,onClose:()=>l(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:i}),e.jsx(hn,{isOpen:u,onClose:v,getExplorerUrl:r,orderInfo:t,closeOrderAction:x,handleOpenDetail:b})]})}function Ct({getExplorerUrl:t,orderInfo:o,closeOrderAction:s,handleOpenDetail:a}){return e.jsxs(D,{align:"flex-start",children:[e.jsx(Re,{text:"View Details",onClick:a}),e.jsx(Re,{text:"View on Explorer",onClick:()=>{window.open(t(o.orderID,"poolAddress"))}}),e.jsx(Re,{text:(o==null?void 0:o.outBalance)<=0?"Close":"Close and Withdraw",onClick:s})]})}function hn({isOpen:t,onClose:o,getExplorerUrl:s,orderInfo:a,closeOrderAction:l,handleOpenDetail:r}){return e.jsx(Le,{isOpen:t,onClose:o,placement:"bottom",children:e.jsx(D,{align:"flex-start",sx:{">div":{w:"100%",">div":{justifyContent:"center",background:"none",p:{color:"text_caption",fontSize:"16px"}}}},children:e.jsx(Ct,{getExplorerUrl:s,orderInfo:a,closeOrderAction:l,handleOpenDetail:r})})})}function fn(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:a}=Q(),[l,r]=d.useState("activeDCAs"),n=l==="activeDCAs",i=10,c=d.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":a==null?void 0:a.length}],[t,o,s,a]),p=d.useMemo(()=>n?s:a,[n,s,a]),{isApp:u}=G(),{closeAll:h,claimAll:v,isClaimAllLoading:b,isCloseAllLoading:x}=_s(),{isOpen:P,onOpen:O,onClose:H}=be(),[T,g]=d.useState([]),[j,f]=d.useState(0),[L,R]=d.useState(1),z=d.useMemo(()=>!n||!(p!=null&&p.length)?"0":p.reduce((_,F)=>V(_).plus((F==null?void 0:F.outBalance)||0),V(0)).toString(),[n,p]),w=V(z).isZero()||b,A=!(p!=null&&p.length)||x,S=d.useMemo(()=>bn(n),[n]);return d.useEffect(()=>{const _=(p==null?void 0:p.length)||0,F=(L-1)*i,M=F+i;_>0?_<=F?R(1):(f(_),g(p.slice(F,M))):(g([]),f(0))},[p,L]),e.jsxs(D,{w:"100%",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:c,currentTab:l,handleChangeTab:_=>r(_==null?void 0:_.value),isActive:(_,F)=>_===F.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),n&&(p==null?void 0:p.length)>1&&(u?e.jsx(N,{bg:"card_bg",variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",onClick:O,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx($,{svgFill:"primary",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})}):e.jsx(_t,{isClaimAllLoading:b,claimDisabled:w,claimAll:()=>v(p),isCloseAllLoading:x,closeDisabled:A,closeAll:()=>h(p)}))]}),e.jsxs(D,{w:"100%",position:"relative",gap:"20px",children:[(t||!o)&&(p==null?void 0:p.length)===0?e.jsx(ee,{type:"nodata",text:n?"No active DCAs":"No past DCAs",noBorder:!0,style:{padding:"60px 0"}}):u?e.jsx(ke,{rowKey:"orderID",columns:S,dataSource:T,loading:!t&&o,itemSkeletonLength:3,itemHeight:"30px",haveDividingLine:!1,rowStyle:()=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Pe,{rowKey:"orderID",columns:S,dataSource:T,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(p==null?void 0:p.length)>i&&e.jsx(K,{children:e.jsx(Oe,{total:j,size:i,currentPage:L,onChange:R})})]}),e.jsx(mn,{isOpen:P,onClose:H,isClaimAllLoading:b,claimDisabled:w,claimAll:()=>v(p),isCloseAllLoading:x,closeDisabled:A,closeAll:()=>h(p)})]})}const bn=t=>[{title:e.jsx(m,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(jt,{orderInfo:s})},{title:e.jsx(m,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(vs,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(m,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Ss,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(m,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(m,{color:"text_caption",children:ve(s)})},{title:e.jsx(m,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,thConfig:{w:"15%"},render:s=>e.jsx(gn,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function _t({isClaimAllLoading:t,claimDisabled:o,claimAll:s,isCloseAllLoading:a,closeDisabled:l,closeAll:r}){return e.jsxs(k,{children:[e.jsx(N,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:t,disabled:o,onClick:s,children:"Claim All"}),e.jsx(N,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:a,disabled:l,onClick:r,children:"Close All"})]})}function mn({isOpen:t,onClose:o,isClaimAllLoading:s,claimDisabled:a,claimAll:l,isCloseAllLoading:r,closeDisabled:n,closeAll:i}){return e.jsx(Le,{isOpen:t,onClose:o,placement:"bottom",children:e.jsx(D,{align:"flex-start",sx:{">div":{w:"100%",flexDirection:"column",button:{w:"100%",bg:"none !important",border:"none !important",color:"text_caption",fontSize:"16px","&:disabled":{bg:"none !important","&:hover":{bg:"none !important"}},"&:hover":{bg:"none !important"}}}},children:e.jsx(_t,{isClaimAllLoading:s,claimDisabled:a,claimAll:l,isCloseAllLoading:r,closeDisabled:n,closeAll:i})})})}function jn(t,o,s){const a=t.length,l=(s-1)*o,r=l+o,n=a>l?t.slice(l,r):[];return{total:a,paginated:n}}function wn(){const{currentAccount:t}=X(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:a}=Ls(),{myOrderList:l,orderListLoading:r}=we(),{isAutoRefresh:n,autoRefreshCount:i}=Q(),{isApp:c}=G(),{handleCancelOrder:p,cancelOrderLoading:u}=Os(),{isOpen:h,onOpen:v,onClose:b}=be(),[x,P]=d.useState("openOrders"),[O,H]=d.useState(1),T=10,g=d.useMemo(()=>x==="openOrders"?l:s,[x,l,s]),j=d.useMemo(()=>x==="openOrders"?r:a,[x,r,a]),{total:f,paginated:L}=jn(g||[],T,O);d.useEffect(()=>{const S=(O-1)*T;g.length<=S&&H(1)},[g,O]);const R=S=>{t!=null&&t.address&&o(t.address,S)};d.useEffect(()=>{i>0&&R(!0)},[i]),d.useEffect(()=>{R(!1)},[x,t]),Ps({onRpcChange:()=>R(!0)});const z=(S,_)=>(n||!S)&&_.length===0?0:!n&&S?"":_.length,w=d.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:z(r,l)},{label:"Orders History",value:"ordersHistory",num:z(a,s)}],[n,r,a,l,s]),A=d.useMemo(()=>yn(x==="openOrders"),[x]);return e.jsxs(D,{w:"100%",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:w,currentTab:x,handleChangeTab:S=>P(S==null?void 0:S.value),isActive:(S,_)=>S===_.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),x==="openOrders"&&g.length>1&&(c?e.jsx(N,{variant:"outline",w:"32px",h:"32px",p:"0",bg:"card_bg",borderRadius:"8px",onClick:v,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx($,{svgFill:"primary",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})}):e.jsx(vt,{cancelOrderLoading:u,handleCancelOrder:()=>p(l)}))]}),e.jsxs(D,{w:"100%",position:"relative",gap:"20px",children:[(n||!j)&&g.length===0?e.jsx(ee,{type:"nodata",text:x==="openOrders"?"No open orders":"No history orders",noBorder:!0}):c?e.jsx(ke,{rowKey:"order_id",columns:A,dataSource:L,loading:!n&&j,itemSkeletonLength:4,itemHeight:"30px",haveDividingLine:!1,rowStyle:(S,_)=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Pe,{rowKey:"order_id",columns:A,dataSource:L,loading:!n&&j,rowStyle:{h:"80px",cursor:"pointer"}}),f>T&&e.jsx(K,{children:e.jsx(Oe,{total:f,size:T,currentPage:O,onChange:H})})]}),e.jsx(Cn,{isOpen:h,onClose:b,cancelOrderLoading:u,handleCancelOrder:()=>p(l)})]})}function yn(t){return[{title:e.jsx(m,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(As,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(m,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Ds,{info:s,isProfile:!0})},{title:e.jsx(m,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(Rs,{info:s,isProfile:!0})},{title:e.jsx(m,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Fs,{info:s,isProfile:!0})},!t&&{title:e.jsx(m,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Hs,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(m,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,thConfig:{w:"8%"},render:s=>e.jsx(zs,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean)}function vt({cancelOrderLoading:t,handleCancelOrder:o}){return e.jsx(N,{h:"32px",p:{base:"4px",lg:"8px"},fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:t,onClick:o,children:"Cancel All"})}function Cn({isOpen:t,onClose:o,cancelOrderLoading:s,handleCancelOrder:a}){return e.jsx(Le,{isOpen:t,onClose:o,placement:"bottom",children:e.jsx(D,{align:"flex-start",sx:{button:{w:"100%",bg:"none !important",border:"none !important",color:"text_caption",fontSize:"16px","&:disabled":{bg:"none !important","&:hover":{bg:"none !important"}},"&:hover":{bg:"none !important"}}},children:e.jsx(vt,{cancelOrderLoading:s,handleCancelOrder:a})})})}function Je(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=d.useState("limitOrders"),{isApp:a}=G();return e.jsx(Z,{borderRadius:"16px",p:{base:"0",lg:"0px 16px 16px"},bg:{base:"none",lg:"bg_primary_opacity.90"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",children:e.jsxs(D,{align:"flex-start",gap:{base:"12px",lg:"20px"},children:[e.jsx(q,{w:"100%",borderBottom:"1px solid",borderColor:{base:"transparent",lg:"border"},children:e.jsx(Me,{type:"tab",currentTab:o,tabs:t,onTabChange:l=>s(l.value),menuHeight:a?"20px":"60px",haveActiveLine:!1,textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(wn,{}),o==="dca"&&e.jsx(fn,{})]})})}function _n({handleRefresh:t,totalValue:o,isLoading:s}){const{isApp:a}=G(),{currentAccount:l,accounts:r}=X(),{isShowProfileAssets:n,setIsShowProfileAssets:i}=pt(),[c,p]=d.useState(!1),{onClose:u}=be();return e.jsxs(D,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsxs(k,{gap:"12px",children:[e.jsx(Se,{src:"/images/img_profile@2x.png",w:"72px",h:"72px"}),e.jsx(It,{currentAccount:l,accounts:r,onClose:u,isProfile:!0})]}),e.jsxs(k,{children:[e.jsxs(k,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{p(!0)},children:[e.jsx($,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(m,{children:"Transactions"})]}),e.jsx(k,{p:"6px 5px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{svg:{fill:"text_caption"}},onClick:()=>i(!n),children:e.jsx(le,{showTooltip:!a,placement:"top",tooltip:e.jsx(m,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(K,{children:e.jsx($,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes"})})})}),e.jsx(Us,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),c&&e.jsx(ht,{isOpen:c,onClose:()=>p(!1)})]})}function vn({tabList:t,tabData:o,onClickTab:s}){return e.jsx(D,{w:"100%",children:t==null?void 0:t.map(a=>e.jsx(Sn,{imgUrl:a.activeImgUrl,value:o[a.value].totalValue,title:a.title,url:a.route,tooltip:a==null?void 0:a.tooltip,onClick:()=>s(a.value),isLoading:o[a.value].isLoading},a.title))})}const Sn=({imgUrl:t,value:o,title:s,url:a,tooltip:l,isLoading:r,onClick:n})=>(Be(),G(),e.jsxs(k,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(k,{gap:"12px",children:[e.jsx(Se,{w:"36px",h:"36px",src:t}),e.jsxs(D,{gap:"2px",align:"flex-start",children:[e.jsx(ae,{h:"24px",isLoaded:!r,children:e.jsx(Y,{size:"l",children:e.jsx(m,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})})}),e.jsxs(k,{gap:"4px",children:[e.jsx(m,{fontSize:"14px",h:"15px",lineHeight:"15px",children:s}),l&&e.jsxs(Tt,{isLazy:!0,trigger:"click",autoFocus:!1,returnFocusOnClose:!1,gutter:4,children:[e.jsx(kt,{children:e.jsx(K,{onClick:i=>ut(i),mb:"-2px",children:e.jsx($,{xlinkHref:"#icon-icon_tips"})})}),e.jsx(Pt,{children:e.jsx(Lt,{w:"fit-content",children:e.jsx(Ot,{fontSize:"12px",w:"fit-content",children:l})})})]})]})]})]}),e.jsx(K,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx($,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function Tn({tabList:t,activeTab:o,tabData:s,onClickTab:a}){return e.jsx(k,{w:"100%",mt:"12px",gap:"12px",children:t.map(l=>{var r,n;return e.jsxs(Z,{w:"25%",p:"24px 16px",bgImage:o===l.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:o===l.value?"primary":"transparent",onClick:()=>a(l.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(D,{align:"flex-start",gap:"10px",children:[e.jsx(m,{fontSize:"14px",color:"primary_gray",children:l.title}),e.jsx(k,{h:"22px",children:e.jsx(Y,{size:"l",children:e.jsx(le,{placement:"top",tooltip:e.jsx(m,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:l.tooltip}),showTooltip:l.showTooltip,children:e.jsx(K,{as:"button",children:e.jsx(ae,{isLoaded:!((r=s[l.value])!=null&&r.isLoading),children:e.jsx(m,{fontSize:"20px",fontWeight:"500",color:"text_caption",children:(n=s[l.value])==null?void 0:n.totalValue})})})})})})]}),e.jsx(Se,{w:"38px",h:"38px",src:l.activeImgUrl,opacity:(o===l.value,"0.8")})]},l.value)})})}function Ze(t){const{isApp:o}=G();return o?e.jsx(vn,{...t}):e.jsx(Tn,{...t})}const kn=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),Ae=xt(kn);function St(){const{currentAccount:t}=X(),{fetchAccountBalance:o}=Vs(),{coinHoldingList:s,setCoinHoldingList:a,setIsCoinHoldingLoading:l,setIsCoinPriceLoading:r,setHoldingsTotalUsd:n,isCoinPriceLoading:i,setUnknownCoinCount:c}=Ae(),{getTokenListInfo:p}=wt(),{getTokenPrice:u}=ce(),{refreshCoinPriceInfo:h}=Ee(),v=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{v.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const b=async()=>{const T=v.current;if(T){l(!0);const g=await o(T,!0);if(g){const j=await p(g.filter(L=>V(L.totalBalance).gt(0)).map(L=>L.coinType));if(!j)throw l(!1),a([]),new Error("get token list info error");const f=[];return g.forEach(L=>{const R=j.get(L.coinType);if(R){const z=L.totalBalance,w=re(z,R.decimals).toString(),A=I(w,void 0,void 0,Ut.ROUND_DOWN).toString(),S={balance:z,balance_format:w,balance_display:A,balance_usd:void 0,coin:R,coin_type:R==null?void 0:R.coin_type,price:"",price_diff_24:""};f.push(S)}}),P(f),console.log("🚀 ~ fetchCoinHoldingList ~ owner:",T),console.log("🚀 ~ fetchCoinHoldingList ~ currentAccountRef.current:",v.current),T===v.current&&(a(f),x([...f])),l(!1),f}}else l(!1),a([]);return[]},x=async T=>{r(!0);try{await h(T.map(g=>g.coin.coin_type),!0)}catch(g){console.error("fetch coin price info error",g)}finally{r(!1)}},P=T=>{T.map(g=>{const{coin:j}=g,f=u(j.coin_type);f&&(g.price=f.price,g.price_diff_24=f.price_change||"",g.balance_usd=V(g.balance_format).mul(f.price).toString())})},O=async T=>{if(console.log("🚀 ~ getFilterCoinHoldingList ~ filter:",{filter:T,coinHoldingList:s,currentAccount:t}),t){const{search:g,current_sort:j,current_sort_order:f,is_show_unknown:L=!1,is_hide_small_balance:R=!0}=T;let z=[];if(L?z.push(...s):z=s.filter(A=>A.coin.is_verified),g){const A=g.toLowerCase();z=z.filter(S=>S.coin.coin_type.toLowerCase().includes(A)||S.coin.symbol.toLowerCase().includes(A)||S.coin.name.toLowerCase().includes(A))}P(z),R&&!i&&(z=z.filter(A=>V(A.balance_usd).gt(.01))),z.sort((A,S)=>{if(j==="balance"){const _=V(A.balance_format).cmp(V(S.balance_format));if(_!==0)return f==="desc"?-_:_}if(j==="value"){const _=V(A.balance_usd).cmp(V(S.balance_usd));return _!==0?f==="desc"?-_:_:V(S.balance_format).cmp(V(A.balance_format))}if(j==="price"){const _=V(A.price||"0").cmp(V(S.price||"0"));return _!==0?f==="desc"?-_:_:V(S.balance_format).cmp(V(A.balance_format))}return 0}),console.log("🚀 ~ getFilterCoinHoldingList ~ tempList:",z);const w=z.filter(A=>!A.coin.is_verified);return c(w==null?void 0:w.length),z}return[]};return d.useEffect(()=>{P(s);const T=s.reduce((g,j)=>g+Number(j.balance_usd||0),0);n(T.toString())},[s,i]),{getFilterCoinHoldingList:O,fetchCoinHoldingList:b,resetUserData:()=>{a([]),n("0"),c(0)}}}function Pn({inputValue:t,changeInputValue:o}){const s=d.useRef(null),[a,l]=d.useState(!1),{isApp:r}=G();return e.jsxs(At,{w:r?"100%":a?"203px":"32px",h:"32px",transition:"width 0.1s ease",border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(Dt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx($,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:n=>{var i;(i=s.current)==null||i.focus(),l(!0)}})}),e.jsx(Rt,{bg:{base:"bg_secondary",lg:"background"},ref:s,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:n=>{o(n.target.value)},onFocus:()=>{l(!0)},onBlur:()=>{o(""),l(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",placeholder:r?"Search by token or address":"",pr:a||r?"28px":"8px",pl:a||r?"28px":"8px"}),t?e.jsx(Ft,{right:"5px",children:e.jsx($,{xlinkHref:"#icon-icon_close",onMouseDown:n=>n.preventDefault(),onClick:n=>{o(""),setTimeout(()=>{var i;(i=s.current)==null||i.focus()},0)}})}):null]})}function Ln({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:a,isHideLowAsset:l,handleIsHideLowAsset:r,unknownCoinCount:n}){const{isApp:i}=G();return e.jsxs(k,{w:{base:"100%",lg:"unset"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Pn,{inputValue:t,changeInputValue:o}),e.jsxs(k,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[e.jsx(Z,{w:{base:"50%",lg:"unset"},borderRadius:"8px",p:{base:"0 4px",lg:"0px 8px"},h:"32px",onClick:i?()=>a(!s):()=>{},bg:i?s?"card_bg":"bg_secondary":"background",children:e.jsxs(k,{h:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(m,{whiteSpace:"nowrap",fontSize:"12px",color:i&&s?"primary":"text_caption",children:["Show Unknown Coin (",n,")"]}),!i&&e.jsx(Ge,{isChecked:s,onChange:a})]})}),e.jsx(Z,{w:{base:"50%",lg:"unset"},borderRadius:"8px",p:"0px 8px",h:"32px",onClick:i?()=>r(!l):()=>{},bg:i?l?"card_bg":"bg_secondary":"background",children:e.jsxs(k,{h:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsx(m,{whiteSpace:"nowrap",fontSize:"12px",color:i&&l?"primary":"text_caption",children:"Hide Low Asset"}),!i&&e.jsx(Ge,{isChecked:l,onChange:r})]})})]})]})}function et(){const{isApp:t}=G(),{getFilterCoinHoldingList:o}=St(),{isCoinHoldingLoading:s,isCoinPriceLoading:a,unknownCoinCount:l}=Ae(),{isAutoRefresh:r}=Q(),[n,i]=d.useState([]),[c,p]=d.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[u,h]=d.useState(!1),[v,b]=d.useState(!0),[x,P]=d.useState("desc"),[O,H]=d.useState(He[2]),T=C=>{console.log("🚀 ~ applyFilter ~ nextFilter:",C),r||_(1),p(C),o(C).then(i)},g=C=>{T({...c,search:C})},j=C=>{const y=(C==null?void 0:C.value)===(O==null?void 0:O.value),U=t||!y?"desc":x==="desc"?"asc":"desc";console.log("🚀 ~ handleSortClick ~ item:",U,C),H(C),P(U),T({...c,current_sort:C.value,current_sort_order:U})};d.useEffect(()=>{console.log("🚀 ~ useEffect ~ isCoinHoldingLoading:",s,a,n),!s&&!a&&T(c)},[s,a]);const f=Be(),L=C=>{f(`/swap/${C}/''`)},[R,z]=d.useState([]),[w,A]=d.useState(0),[S,_]=d.useState(1),F=10;d.useEffect(()=>{if((n==null?void 0:n.length)>0){const C=(S-1)*F;(n==null?void 0:n.length)<=C&&_(1)}},[n]),d.useEffect(()=>{if((n==null?void 0:n.length)>0){A(n==null?void 0:n.length);const C=(S-1)*F,y=C+F;console.log("🚀 ~ useEffect ~ start:",S,n.slice(0,y),C,y),(n==null?void 0:n.length)>C&&z(n.slice(C,y))}else z([])},[S,n]);const M=(C,y)=>{C==="is_show_unknown"&&h(y),C==="is_hide_small_balance"&&b(y)},B=C=>{let y;typeof C=="boolean"?y=C:y=C.target.checked,M("is_show_unknown",y),y||T({...c,is_show_unknown:!1}),y&&!u&&(M("is_hide_small_balance",!1),T({...c,is_show_unknown:!0,is_hide_small_balance:!1}))},E=C=>{let y;typeof C=="boolean"?y=C:y=C.target.checked,M("is_hide_small_balance",y),T({...c,is_hide_small_balance:y})};return e.jsx(Z,{width:"100%",p:{base:"0",lg:"14px 16px 16px"},bg:{base:"none",lg:"bg_primary_opacity.90"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",children:e.jsxs(D,{w:"100%",align:"flex-start",gap:{base:"8px",lg:"16px"},children:[e.jsxs(k,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(m,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),t&&e.jsx(bt,{sortText:"Sort by",minW:"148px",boxHeight:"32px",currentSort:O,sortByList:He,onSortByChange:j,xlinkHref:x==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>{T({...c,current_sort:O.value,current_sort_order:x==="desc"?"asc":"desc"}),P(C=>C==="desc"?"asc":"desc")},wrapStyle:{height:"30px"}})]}),e.jsx(Ln,{unknownCoinCount:l,inputValue:c.search||"",changeInputValue:g,isShowUnknownCoin:u,handleIsShowUnknownCoin:B,isHideLowAsset:v,handleIsHideLowAsset:E})]}),!t&&e.jsx(q,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(D,{w:"100%",position:"relative",gap:"20px",children:[(!s&&!a||r)&&(n==null?void 0:n.length)===0?e.jsx(ee,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsx(ke,{rowKey:"coin_type",columns:tt(x,O,j,L,!r&&a,n==null?void 0:n.length),dataSource:R,loading:!r&&(s||a),itemSkeletonLength:4,haveDividingLine:!1,onRowClick:C=>{L(C==null?void 0:C.coin_type)},itemHeight:"30px",rowStyle:(C,y)=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Pe,{rowKey:"coin_type",columns:tt(x,O,j,L,!r&&a,n==null?void 0:n.length),dataSource:R,skeletonLength:5,loading:!r&&(s||a),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:C=>{L(C==null?void 0:C.coin_type)}}),(n==null?void 0:n.length)>F&&e.jsx(K,{children:e.jsx(Oe,{total:w,size:F,currentPage:S,onChange:C=>{_(C)}})})]})]})})}const He=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Fe=Object.fromEntries(He.map(t=>[t.value,t])),tt=(t,o,s,a,l,r)=>[{title:e.jsxs(m,{children:["Token(",r,")"]}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:n})=>e.jsx(yt,{haveTooltip:!0,token:n,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(ge,{labelInfo:Fe.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"25%"},render:({coin:n,balance_display:i})=>e.jsx(k,{justify:"flex-end",children:e.jsx(Y,{children:e.jsxs(m,{color:"text_caption",children:[i," ",Vt(n==null?void 0:n.symbol,10)]})})})},{title:e.jsx(ge,{labelInfo:Fe.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"25%"},render:({price:n,price_diff_24:i})=>{const c=V(i).gt(0);return e.jsx(k,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!l,children:e.jsx(k,{gap:"2px",children:n===void 0||n===""?e.jsx(m,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(m,{color:"text_caption",children:["$",gt(n)]}),e.jsxs(m,{color:Number(i)===0?"text_caption":c?"primary_green":"primary_red",children:["(",c?"+":V(i).gt(-1e-4)&&V(i).lt(0)?"-":"",V(i).gt(-1e-4)&&V(i).lt(1e-4)?"0%":Et(V(i).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(ge,{labelInfo:Fe.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:n})=>(console.log(n,"balance_usd"),e.jsx(k,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!l,children:e.jsx(Y,{children:e.jsx(m,{color:"text_caption",children:n===void 0?"--":oe(n,2)})})})}))},{title:e.jsx(m,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:n=>e.jsx(N,{w:{base:"calc(100vw - 48px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{a(n==null?void 0:n.coin_type)},children:"Swap"})}],On=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),De=xt(On),An={cetus:{title:"CETUS Holdings",imgUrl:J.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:J.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function We({type:t,amount:o,amountUSD:s,isLoading:a,children:l}){const{title:r,imgUrl:n,bgUrl:i}=An[t];return e.jsx(Z,{border:"none",flex:"1",bg:`center / cover no-repeat url(${i})`,p:{base:"12px",lg:"20px"},borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(D,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(k,{children:[e.jsx(he,{imageUrl:n,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(m,{children:r})]}),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(Y,{children:e.jsxs(D,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(ae,{isLoaded:!a,h:"24px",children:e.jsx(m,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:o})}),s!==void 0&&e.jsx(ae,{isLoaded:!a,h:"17px",children:e.jsxs(m,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",gt(s,2)]})})]})}),l]})]})})}function Dn(){const{currentAccount:t}=X(),{balanceInfo:o}=Qs(J.cetus_coin),{getTokenAmountValue:s}=ce(),{coinPriceObj:a}=Te(),l=d.useMemo(()=>s(J.cetus_coin.coin_type,re((o==null?void 0:o.balance)||"0",J.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,a]),{setCurrentXCetusTab:r,setIsXCetusModalOpen:n}=De(),i=()=>{n(!0),r("Get xCETUS")},{veNFT:c,veNFTLoading:p,lockCetusListLoading:u}=te();return e.jsx(We,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:l,isLoading:(u||p)&&c!==void 0,children:e.jsx(N,{onClick:i,variant:"outline",color:"primary",flex:"0 0 120px",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",children:"Convert to xCETUS"})})}function Rn(){const{lockCetusList:t,lockCetusListLoading:o}=te(),[s,a]=d.useState([]),[l,r]=d.useState(0),[n,i]=d.useState(1),c=10;return d.useEffect(()=>{if((t==null?void 0:t.length)>0){const p=(n-1)*c;(t==null?void 0:t.length)<=p&&i(1)}},[t]),d.useEffect(()=>{if((t==null?void 0:t.length)>0){r(t==null?void 0:t.length);const p=(n-1)*c,u=p+c;console.log("🚀 ~ useEffect ~ start:",n,t.slice(0,u),p,u),(t==null?void 0:t.length)>p&&a(t.slice(p,u))}},[n,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(q,{w:"100%",h:"1px",bg:"border"}),e.jsxs(D,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(m,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(D,{w:"100%",gap:"12px",children:s==null?void 0:s.map(p=>e.jsx(Fn,{order:p},p==null?void 0:p.id))}),(t==null?void 0:t.length)>c&&e.jsx(K,{w:"100%",children:e.jsx(Oe,{total:l,size:c,currentPage:n,onChange:p=>{i(p)}})})]})]})}const Fn=({order:t})=>{const[o,s]=d.useState(!fe.isLocked(t));d.useEffect(()=>{s(!fe.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:a,handleCancelOrder:l}=Es(),{claimOrderLoading:r,handleClaimOrder:n}=Ms(),{days:i,hours:c,minutes:p,seconds:u}=Ws(t.locked_until_time*1e3,()=>{s(!0)},"days"),h=v=>{v?n(t.id):l(t)};return e.jsxs(k,{flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},justify:"space-between",w:"100%",h:{base:"unset",lg:"80px"},p:{base:"12px",lg:"0 20px"},bg:{base:"bg_seven",lg:"bg_nine"},borderRadius:"12px",children:[o?e.jsxs(k,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx($,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(m,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(k,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx($,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(q,{as:"div",children:[e.jsxs(m,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(m,{as:"span",color:"text_caption",fontSize:"13px",children:[i,"d : ",c,"h : ",p,"m : ",u,"s"]})]})]}),e.jsxs(k,{flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},w:{base:"100%",lg:"unset"},gap:"12px",children:[e.jsx($s,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(N,{onClick:()=>{a||r||h(o)},variant:"unstyled",border:"none",h:"28px",w:{base:"100%",lg:"80px"},borderRadius:"8px",fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:a||r,color:o?"background":"primary_gray",bg:o?"primary":"card_bg",_hover:{bg:o?"primary_hover":"button_ghost_hov_bg",color:o?"background":"text_caption"},children:o?"Claim":"Cancel"})]})]})};function Hn({totalRewardValue:t,rewardList:o,summaryRewardList:s}){const{currentAccount:a}=X(),{veNFTLoading:l}=te(),{claimRewardLoading:r,handleClaimReward:n}=Ns(),i=()=>{r||n(o)};return G(),e.jsx(We,{type:"rewards",amount:a?V(t).gt("0")?e.jsx(le,{tooltip:e.jsx(D,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(c=>e.jsxs(k,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(yt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(k,{gap:"4px",children:[e.jsx(m,{fontSize:"12px",color:"text_caption",children:I(c==null?void 0:c.amount,6)}),e.jsxs(m,{fontSize:"12px",children:["(",oe(c==null?void 0:c.value,2),")"]})]})]},c.coin_type))}),children:e.jsx(m,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:oe(t,2)})}):e.jsx(m,{textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:oe(t,2)}):"--",isLoading:l,children:s.length>0&&e.jsx(N,{onClick:i,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",children:"Claim"})})}function zn({availableXCetusAmount:t}){const{currentAccount:o}=X(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=te(),{getTokenAmountValue:r}=ce(),{coinPriceObj:n}=Te(),i=d.useMemo(()=>r(J.cetus_coin.coin_type,re(t||"0",J.x_cetus_coin.decimals)).toString(),[t,o==null?void 0:o.address,n]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:p}=De(),u=()=>{p(!0),c("Redeem CETUS")},h=(l||a)&&s!==void 0;return e.jsx(We,{type:"xcetus",amount:o?I(re(t||"0",9),9).toString():"--",amountUSD:i,isLoading:h,children:e.jsx(N,{onClick:u,variant:"outline",color:"primary",flex:"0 0 120px",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",children:"Redeem"})})}const ye=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function Bn({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:a,setCurrentXCetusTab:l}=De(),[r,n]=d.useState("#icon-a-icon_trade"),i=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},p=()=>{var h;const u=(h=ye==null?void 0:ye.find(v=>(v==null?void 0:v.value)!==a))==null?void 0:h.value;u&&l(u)};return e.jsxs(ot,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(it,{}),e.jsxs(at,{children:[e.jsx(rt,{p:"0 16px",children:e.jsx(q,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(me,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:ye,currentTab:a,handleChangeTab:u=>{l(u==null?void 0:u.value)}})})}),e.jsx(lt,{}),e.jsxs(ct,{p:"20px 16px 16px",children:[a==="Get xCETUS"&&e.jsx(Xs,{onClose:o,availableXCetusAmount:s,onIconClick:p,iconParams:{xlinkHref:r,svgFill:"text_caption",transform:r==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:r==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:i,onMouseLeave:c}}),a==="Redeem CETUS"&&e.jsx(Gs,{onClose:o,availableXCetusAmount:re(s,9),onIconClick:p,iconParams:{xlinkHref:r,svgFill:"text_caption",transform:r==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:r==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:i,onMouseLeave:c}})]})]})]})}function st(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=De(),{availableXCetusAmount:s,totalRewardValue:a,rewardList:l,summaryRewardList:r}=qs();return e.jsx(Z,{p:{base:"8px",lg:"20px"},border:"none",w:"100%",bg:"bg_primary_opacity.90",backdropFilter:"blur(20px)",children:e.jsxs(D,{w:"100%",gap:"16px",children:[e.jsxs(k,{w:"100%",gap:"10px",flexDirection:{base:"column",lg:"row"},children:[e.jsx(zn,{availableXCetusAmount:s}),e.jsx(Dn,{}),e.jsx(Hn,{totalRewardValue:a,rewardList:l,summaryRewardList:r})]}),e.jsx(Rn,{}),t&&e.jsx(Bn,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})})}function Un(){const{currentAccount:t}=X(),{orderListLoading:o,myOrderList:s}=we(),{isAutoRefresh:a,dcaOrderListLoading:l,dcaActiveOrderList:r}=Q(),{getTokenAmountValue:n,coinPriceObj:i}=ce(),c=d.useMemo(()=>{let h=V(0);if(a||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(v=>{const{pay_coin:b,target_coin:x,un_claimed_amount:P,remaining_amount:O}=v,H=n(b.coin_type,O),T=n(x.coin_type,P);h=V(h).plus(H).plus(T),console.log("🚀 ~ myOrderList.forEach ~ limitTotalTvl:",h.toString())}),h.toString()):"0"},[a,s,t==null?void 0:t.address,o,i]),p=d.useMemo(()=>{let h=V(0);if(a||!l)return(r==null?void 0:r.length)>0&&(t!=null&&t.address)?(r.forEach(v=>{const{inBalance:b,inCoin:x,outBalance:P,outCoin:O}=v,H=n(x.coin_type,b),T=n(O.coin_type,P);h=V(h).plus(H).plus(T),console.log("🚀 ~ dcaActiveOrderList.forEach ~ total:",h.toString())}),h):"0"},[a,r,t==null?void 0:t.address,l,i]),u=d.useMemo(()=>{if(console.log("🚀 ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",p,c),p&&c){let h=V(0);return h=V(h).plus(p).plus(c),h.toString()}return"--"},[p,c]);return{limitTotalTvl:c,dcaTotalTvl:p,orderTotalTvl:u}}function Vn(){const{currentAccount:t}=X(),{isAutoRefresh:o}=Q(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=te(),{getTokenAmountValue:r}=ce(),{coinPriceObj:n}=Te();return{xCetusTotalTvl:d.useMemo(()=>{if(o||!a&&!l)return t!=null&&t.address&&s?r(J.cetus_coin.coin_type,re(s==null?void 0:s.xcetus_balance,J.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,l,a,t==null?void 0:t.address,n])}}const En="fetch-coin-holding-list",Mn="fetch-owner-nft",Wn="fetch-active-order-list",$n="fetch-xcetus-base-info",Nn="fetch-vaults-position-list";function Xn(){const{currentAccount:t}=X(),{getTokenListInfo:o}=wt(),{getLimitUserIndexer:s,getDcaUserIndexer:a}=Ks(),{setOrderListLoading:l,setMyOrderList:r}=we(),{setDcaOrderListLoading:n,setDcaActiveOrderList:i,setDcaPastOrderList:c}=Q(),{refreshCoinPriceInfo:p}=Ee(),{buildDcaOrderList:u}=Ts(),h=ie("limit"),v=ie("dca"),{formatLimitOrderList:b}=Bs(),x=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{x.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const P=async()=>{if(t){l(!0);const g=await s(t.address);if(console.log("🚀 ~ fetchUserLimitOrderIds ~ indexer:",g),g)try{return(await h.FullClient.getDynamicFieldsByPage(g)).data.map(L=>L.name.value)}catch(j){console.log("🚀 ~ fetchUserLimitOrderIds ~ error:",j)}}return[]},O=async()=>{if(t){n(!0);const g=await a(t.address);if(console.log("🚀 ~ fetchUserDacOrderIds ~ indexer:",g),g)try{return(await v.FullClient.getDynamicFieldsByPage(g)).data.map(L=>L.name.value)}catch(j){console.log("🚀 ~ fetchUserDacOrderIds ~ error:",j)}}return[]};return{fetchActiveOrderList:async()=>{try{const g=await P(),j=await O(),f=await h.FullClient.batchGetObjects([...g,...j],{showType:!0,showContent:!0}),L=f.filter(B=>{var E,C;return(C=(E=B.data)==null?void 0:E.type)==null?void 0:C.includes("limit_order::LimitOrder")}),R=f.filter(B=>{var E,C;return(C=(E=B.data)==null?void 0:E.type)==null?void 0:C.includes("order::Order")}),w=L.map(B=>Mt.buildLimitOrderInfo(B)).filter(B=>B!==void 0).filter(B=>B.status===Ke.PartialCompleted||B.status===Ke.Running),A=R.map(B=>{var U,W,de,ue,xe,$e,Ne,Xe;const E=_e(((U=B.data)==null?void 0:U.type)||""),C=E.type_arguments[0],y=E.type_arguments[1];return{in_coin_type:C,out_coin_type:y,...(de=(W=B.data)==null?void 0:W.content)==null?void 0:de.fields,id:(Ne=($e=(xe=(ue=B.data)==null?void 0:ue.content)==null?void 0:xe.fields)==null?void 0:$e.id)==null?void 0:Ne.id,version:(Xe=B.data)==null?void 0:Xe.version}}),S=new Set;for(const B of w)S.add(B.pay_coin_type),S.add(B.target_coin_type);for(const B of A)S.add(B.in_coin_type),S.add(B.out_coin_type);await o(Array.from(S));const _=await b(w);r(_);const{activeResult:F,pastResult:M}=await u(A);x.current===(t==null?void 0:t.address)&&(i(F),c(M),console.log("🚀 ~ fetchActiveOrderList ~ limitOrderList:",_),console.log("🚀 ~ fetchActiveOrderList ~ dcaOrderList:",A)),p(Array.from(S))}catch(g){console.log("🚀 ~ fetchActiveOrderList ~ error:",g)}finally{l(!1),n(!1)}},resetUserData:()=>{console.log("🚀 ~ resetUserData ~ resetUserData"),r([]),i([]),c([])}}}function Gn(){const{currentAccount:t}=X(),o=ie("clmm"),s=ie("xcetus"),{buildFarmsPositionType:a,buildBurnPositionType:l}=ns(),{setPosBaseList:r,setFullRangePosBaseList:n,setPosBaseListLoading:i}=pe(),{setVeNFT:c,setVeNFTLoading:p,setLockCetusList:u,clearData:h,setLockCetusListLoading:v,setAvailableXCetusAmount:b}=te(),{formatPosBaseList:x}=os(),P=d.useRef(t==null?void 0:t.address);return d.useEffect(()=>{P.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const T=P.current;if(T){i(!0),p(!0);const g=await o.FullClient.getOwnedObjectsByPage(T,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:Wt.clmm_pool.package_id},{StructType:a},{StructType:l},{StructType:Is},{StructType:Ys}]}});let j=await x(g);r(j),i(!1),(j==null?void 0:j.length)==0&&n([]);const f=Js(g.data);if(f&&T===P.current){c(f,T);const L=await Zs(g.data,s);L.sort((R,z)=>R.locked_until_time-z.locked_until_time),console.log("🚀 ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:L,veNFT:f,availableXCetusAmount:fe.getAvailableXCetus(f,L)}),u(L),b(fe.getAvailableXCetus(f,L))}else v(!1);return{veNFT:f,posBaseList:j}}}catch(T){console.error("🚀 ~ fetchOwnerNFT ~ error:",T),T instanceof TypeError&&(i(!1),r([]))}finally{i(!1),v(!1),p(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{r([]),h()}}}function qn(){const t=ie("farms"),o=ie("clmm"),{getPosApiPoolData:s}=is(),{getPosPoolsOriginalObj:a,getPosPoolsRelatedData:l}=as(),{getPosLiquidityData:r}=rs(),{setPosLiquidityData:n,setFarmsPosRewardsData:i,setFarmsPosRewardsDataLoading:c,setPosRewardsData:p,setPosRewardsDataLoading:u,setPosFeeData:h,setPosFeeDataLoading:v}=pe(),{formatFarmsRewardsData:b}=ls(),{formatPosRewardsData:x}=cs(),{formatPosFeeData:P}=ps(),{refreshCoinPriceInfo:O}=Ee(),H=async j=>{var z;const f=j.filter(w=>w.posType==="farms"&&w.farmsPool),L=await a(j);if(l(j,L),((z=Object.keys(L))==null?void 0:z.length)===0)throw n({}),new Error("No pool data found");s(j),r(j,L);const R=new $t;f.length>0&&f.forEach(w=>{t.Farms.buildCalculateFarmingReward({pool_id:w.farmsPool,position_nft_id:w.id},R)}),j.forEach(w=>{o.Position.buildFetchPosFee({pool_id:w.clmmPool,position_id:w.posId,coin_type_a:w.coinTypeA,coin_type_b:w.coinTypeB},R)}),j.filter(w=>w.posType!=="farms").forEach(w=>{var S;const A=L[w.clmmPool];o.Rewarder.buildFetchPosReward({pool_id:w.clmmPool,position_id:w.posId,coin_type_a:w.coinTypeA,coin_type_b:w.coinTypeB,rewarder_types:(S=A.rewarder_infos)==null?void 0:S.map(_=>_.coinAddress)},R)});try{c(!0),u(!0),v(!0);const w=await o.FullClient.devInspectTransactionBlock({transactionBlock:R,sender:Nt("0x0")}),A=t.Farms.parsedPosRewardData(w),S=o.Rewarder.parsedPosRewardData(w),_=o.Position.parsedPosFeeData(w);console.log("🚀 ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:A,clmmRewardData:S,clmmFeeData:_});const F=await b(A);i(F);const M=await x(Object.values(S).map(E=>{const C=L[j.find(y=>y.posId===E.position_id).clmmPool];return{poolAddress:C.pool_address,positionId:E.position_id,rewarderAmountOwed:E.rewarder_amount.map((y,U)=>({coin_address:C.rewarder_infos[U].coinAddress,amount_owed:new Xt(y)}))}}));p(M);const B=await P(Object.values(_).map(E=>({position_id:E.position_id,fee_owned_a:E.fee_owned_a,fee_owned_b:E.fee_owned_b})),j);h(B),console.log("🚀 ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:B,posRewardsData:M,posFarmsRewardsObj:F}),T(j,M,F)}catch(w){console.error("🚀 ~ fetchPosRelatedData ~ error:",w)}finally{c(!1),u(!1),v(!1)}},T=async(j,f,L)=>{console.log("🚀 ~ fetchTokenPrice ~ posRewardsData:",j,f);const R=[];if(j.length>0){j.map(w=>{R.push(_e(w==null?void 0:w.coinTypeA).full_address),R.push(_e(w==null?void 0:w.coinTypeB).full_address);const A=f[w==null?void 0:w.posId]||[],S=L[w==null?void 0:w.id]||[],_=A.concat(S);_==null||_.map(F=>{var M;Gt(F==null?void 0:F.display_amount_owed).gt(0)&&R.push(_e((M=F==null?void 0:F.token)==null?void 0:M.coin_type).full_address)})}),console.log("🚀 ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(R)));const z=Array.from(new Set(R));console.log("🚀 ~ refreshTokenPrice ~ list:",z),O(z)}};return{fetchPosRelatedData:H,resetUserData:()=>{n({}),i({}),p({}),h({})}}}function Kn(){const{getVaultsTokenList:t,getVaultsLpTokenList:o}=Ve(),{getVaultsContractInfo:s}=es(),{getVaultsPosition:a}=ts(),{setVaultsPositionLoading:l,clearVaultsPositionObj:r}=je(),{setVaultListLoading:n}=Ue(),{getVaultPoolList:i}=ss();return{fetchVaultsPositionList:async()=>{l(!0),n(!0);const u=await i();console.log("🚀 ~ fetchVaultsPositionList ~ vaultsList:",u),t(u),o(u);const{lstVaultContractInfoObj:h,haedalVaultContractInfoObj:v,allClmmPoolContractInfoObj:b}=await s(u);a(u,h,v,b,!0)},resetUserData:()=>{console.log("🚀🚀🚀 ~ useProfileVaults.ts:39 ~ resetUserData ~ clearVaultsPositionObj:",r),r()}}}function Qn(){const{currentAccount:t}=X(),{setXCetusManager:o,setDividendManager:s}=te(),a=ie("xcetus");return{fetchXCetusBaseInfo:async r=>{try{const{xcetus:n,xcetus_dividends:i}=qt,{dividend_manager_id:c}=Qe(i),{xcetus_manager_id:p}=Qe(n),u=await a.FullClient.batchGetObjects([p,c],{showType:!0,showContent:!0}),h=u.find(b=>{var x,P;return(P=(x=b.data)==null?void 0:x.type)==null?void 0:P.includes("xcetus::XcetusManager")});if(h){const b=Ie(h),x={id:b.id.id,index:Number(b.index),has_venft:{handle:b.has_venft.fields.id.id,size:b.has_venft.fields.size},nfts:{handle:b.nfts.fields.id.id,size:b.nfts.fields.size},total_locked:b.total_locked,treasury:b.treasury.fields.total_supply.fields.value};console.log("🚀 ~ fetchXCetusBaseInfo ~ xCetusManager:",x),o(x)}const v=u.find(b=>{var x,P;return(P=(x=b.data)==null?void 0:x.type)==null?void 0:P.includes("dividend::DividendManager")});if(v){const b=Ie(v),x=fe.buildDividendManager(b);console.log("🚀 ~ fetchXCetusBaseInfo ~ dividendManager:",x),a.updateCache(`${c}_getDividendManager`,x),s(x)}}catch(n){console.log("🚀 ~ fetchXCetusBaseInfo ~ error:",n)}}}}function In(t){const{currentAccount:o}=X(),{fetchCoinHoldingList:s,resetUserData:a}=St(),{fetchPosRelatedData:l,resetUserData:r}=qn(),{fetchActiveOrderList:n,resetUserData:i}=Xn(),{fetchVaultsPositionList:c,resetUserData:p}=Kn(),{setAutoRefreshCount:u,setDcaOrderListLoading:h}=Q(),{fetchOwnerNFT:v,resetUserData:b}=Gn(),{fetchXCetusBaseInfo:x}=Qn(),{addTask:P,removeTask:O}=tn(),[H,T]=d.useState([]),g=d.useRef(o),{setOrderListLoading:j}=we(),{setLockCetusListLoading:f}=te(),{setPosBaseListLoading:L}=pe(),{setIsCoinHoldingLoading:R}=Ae(),{setVaultListLoading:z}=Ue(),{setVaultsPositionLoading:w}=je(),A=()=>{a(),r(),i(),b(),p()};d.useEffect(()=>{var y,U;o?((y=g.current)!=null&&y.address&&((U=g.current)==null?void 0:U.address)!==(o==null?void 0:o.address)&&(u(!1),A(),H.forEach(W=>{O(W.id)})),E()):(A(),H.forEach(W=>{O(W.id)})),g.current=o},[o==null?void 0:o.address]);const S={id:En,run:s},_={id:Mn,run:v,onSuccess:y=>{const{posBaseList:U}=y;l(U)}},F={id:$n,run:x},M={id:Wn,run:n},B={id:Nn,run:c},E=()=>{const y=[];j(!0),f(!0),L(!0),R(!0),w(!0),z(!0),h(!0),t==="wallet"?y.push(S,_,B,M,F):t==="liquidity"?y.push(_,B,S,M,F):t==="orders"?y.push(M,S,_,B,F):y.push(_,B,F,S,M),T(y),y.forEach(U=>{P(U)})};return{refreshTask:()=>{o&&(H.forEach(y=>{O(y.id)}),E())}}}const Ce=t=>t?oe(t,2):"$--",Yn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),V(0)).toString();function yi(){const{tab:t,tabDetail:o}=Kt(),{currentAccount:s,onWalletModal:a}=X(),l=Be(),{posBaseListLoading:r,posLiquidityDataLoading:n}=pe(),{holdingsTotalUsd:i,isCoinPriceLoading:c,isCoinHoldingLoading:p}=Ae(),{liquidityTotalTvl:u}=gs(),{orderTotalTvl:h}=Un(),{orderListLoading:v}=we(),{isAutoRefresh:b,dcaOrderListLoading:x,setAutoRefreshCount:P,resetAutoRefreshCount:O}=Q(),{xCetusTotalTvl:H}=Vn(),{vaultsPositionLoading:T}=je(),{lockCetusListLoading:g,veNFTLoading:j}=te(),f=d.useMemo(()=>t,[t]),{refreshTask:L}=In(f),R=!b&&(p||c),z=!b&&(r||n||c||T),w=!b&&(v||x||c),A=!b&&(g||j||c),S=d.useMemo(()=>({wallet:{totalValue:Ce(i),isLoading:R},liquidity:{totalValue:Ce(u),isLoading:z},orders:{totalValue:Ce(h),isLoading:w},xCetus:{totalValue:Ce(H),isLoading:A}}),[i,u,h,H,R,z,w,A]),_=[{title:"Wallet Holdings",value:"wallet",route:"/portfolio?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/portfolio?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/portfolio?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/portfolio?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],F=d.useMemo(()=>Yn(H,u,h,i),[H,u,h,i]);d.useEffect(()=>O(!1),[]);const[M,B]=d.useState(!1);d.useEffect(()=>{B(!0)},[]);const{isApp:E}=G();return E?o?e.jsxs(D,{width:{base:"100%",lg:"unset"},padding:"0",pb:"0",gap:"16px",mt:"-46px",align:"flex-start",children:[e.jsx(en,{onClick:()=>l("/portfolio?tab=wallet"),ml:"-4px",w:"unset",bg:"none",border:"none",svgFill:"text_caption",customTextStyle:{color:"text_caption",fontSize:"16px"}}),e.jsxs(D,{width:{base:"100%",lg:"unset"},children:[f==="wallet"&&e.jsx(et,{}),f==="liquidity"&&e.jsx(Ye,{}),f==="orders"&&e.jsx(Je,{}),f==="xCetus"&&e.jsx(st,{})]})]}):e.jsx(sn,{totalValue:F,onRefreshTask:L,isLoading:!b&&(j||r||v||x),children:e.jsx(Ze,{tabList:_,activeTab:f,tabData:S,onClickTab:C=>l(`/portfolio?tab=${C}&tabDetail=true`)})}):e.jsx(D,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:M?s!=null&&s.address?e.jsxs(D,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(_n,{handleRefresh:C=>{P(!C),L()},totalValue:F,isLoading:!b&&(j||r||v||x)}),e.jsx(Ze,{tabList:_,activeTab:f,tabData:S,onClickTab:C=>l(`/portfolio?tab=${C}`)}),f==="wallet"&&e.jsx(et,{}),f==="liquidity"&&e.jsx(Ye,{}),f==="orders"&&e.jsx(Je,{}),f==="xCetus"&&e.jsx(st,{})]}):e.jsx(ee,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>a(!0)}):e.jsx(nt,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})})})}export{yi as default};
//# sourceMappingURL=Profile-qJh99sI2.js.map

import{j as e,H as j,T as _,a as d,V as P,X as Ee,Y as Ae,Z as Re,$ as ze,a8 as lt,a0 as Fe,a1 as Ne,v as I,u as K,C as me,S as Ie,f as dt,R as ye,at as J,au as D,aw as pt,ax as xt,ay as Z,as as ut,ab as mt,az as Wt,O as et,aa as $t}from"./vendor-DsVemle5.js";import{C as Vt,m as $,t as De,as as gt,e as ht,a as ne,B as U,I as ee,J as Be,l as Me,k as jt,n as se,j as Se,at as fe,au as ie,av as bt,a2 as X,d as N,i as ft,N as _t,c as Yt,H as We,z as _e,r as $e,y as tt,$ as st,A as Gt,u as Ut,aw as Jt,V as be}from"./index-ptnn7YYs.js";import{P as Ce}from"./Pagination-D3S2cm5E.js";import{N as te}from"./NoData-HfG491EP.js";import{u as Qt}from"./RangeValue-rGit3VvP.js";import{u as ue}from"./useTransaction-_40Gj-Xj.js";import{u as Le}from"./useAccountBalance-BlkjpDIb.js";import{u as Ve}from"./useToken-D0Y8EMfE.js";import{S as Kt}from"./SingleTokenInfo-BK4bHte8.js";import{b as wt}from"./FarmsTable-DSWxDCc6.js";import{A as Zt}from"./aggregator-BE05R8Nv.js";import{A as it}from"./useSwapHelper-CkdGRiyG.js";import{u as nt}from"./useTokenBalance-BmzoUDH9.js";import{u as Xt}from"./useInsufficientBalanceToast-BjqRjKwn.js";import{u as qt}from"./useFindBestRouting-DsIA0n5P.js";import{T as It}from"./TradeInputGroup-cjeY54io.js";import{W as es}from"./WarningTokenTipModal-DgtdCV7o.js";import{M as ts,C as ss}from"./MenuDropBlock-Den2aKsR.js";import{T as is,a as ns}from"./TradeTab-JtLCjiGr.js";import"./index-p86JPiOx.js";import{u as rs}from"./global-XGPon1rE.js";import"./swap-aC0keGHZ.js";import"./AggregatorModal-BnBKyXGv.js";import"./FreshProgressV2-CujxstRu.js";import{T as as}from"./TradeConfirmAmountInfo-DPXgMlK5.js";import{I as we}from"./InputBox-B9mQGWx1.js";import{LimitPriceChart as os}from"./LimitPriceChart-1LW5B6UQ.js";import{u as cs}from"./useInterval-DHQ0XTt3.js";import{u as ls}from"./useRpcListener-zb5WjE9D.js";import{R as rt}from"./RefreshButton-WcxAkxJ5.js";import"./useTrack-DUPD-CMT.js";import"./useSigner-CA1OjupR.js";import"./CopyButton-BDbKvN3H.js";import"./usePositionList-DPh0B0ja.js";import"./useFavoritePool-BRmN064e.js";import"./useGetPoolList-BWUJTUb5.js";import"./useWrapPoolData-Dtc_nARB.js";import"./index-CI9BE_b8.js";import"./ExpendItem-DP88Bi04.js";import"./msafe-oYBkW7LJ.js";import"./PriceRange-Bbswl8vh.js";import"./PositionStatus-WnMSBgkX.js";import"./CoinPairInfo-CRvWBqVO.js";import"./PoweredByHaedal-CSYJZkP0.js";import"./_getAllKeysIn-BPxU3Eca.js";import"./CheckBox-DBtbKikX.js";import"./IconBg-DXu28HXx.js";import"./TooltipIcon-Cc-8Tse6.js";import"./usePreviousValue-CMQTRdbk.js";const ge=({info:t,imgSize:n="32px"})=>{const{pay_coin:r,target_coin:u,total_pay_amount:x,expect_obtain_amount:p}=t;return e.jsxs(j,{children:[e.jsx(Vt,{w:n,h:n,coinAIconUrl:r.logo_url,coinBIconUrl:u.logo_url}),e.jsxs(_,{color:"text_caption",children:[$(x)," ",r.symbol," â†’ ",$(p)," ",u.symbol]})]})},he=({info:t})=>e.jsx(j,{justifyContent:"end",gap:"2px",children:e.jsxs(_,{color:"text_caption",children:[De(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),je=({info:t})=>{const{pay_coin:n,total_pay_amount:r,deal_amount:u,deal_rate:x}=t;return e.jsxs(j,{justifyContent:"end",gap:"2px",children:[e.jsxs(_,{color:"text_caption",children:[$(u),"/",$(r)," ",n.symbol]}),e.jsxs(_,{color:"primary_gray",children:["(",gt(Number(x)*100),")"]})]})},yt=({historyInfo:t,type:n,...r})=>{const{getExplorerUrl:u}=ht(),{pay_coin:x,target_coin:p}=t,g=d.useMemo(()=>(t==null?void 0:t.events)||[],[t]),h=o=>{const l=o==null?void 0:o.event_type;return l.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:x,num:`+${$(Me(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`}:l.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:p,num:`+${$(Me(o==null?void 0:o.amount,p==null?void 0:p.decimals))}`}:l.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${$(Me(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`,tokenInfo:x}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},{isApp:a}=ne();return e.jsx(U,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...r,children:e.jsx(P,{align:"flex-start",children:g.map(o=>{const{tokenInfo:l,text:i,icon:s,color:c,num:b}=h(o);return e.jsxs(P,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(j,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(j,{gap:n=="card"?"4px":"8px",flexDirection:n=="card"?"column":"row",align:n=="card"?"flex-start":"center",children:[e.jsxs(j,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(ee,{svgW:"14px",xlinkHref:s,svgFill:c,svgHover:c}),e.jsx(_,{color:c,children:i})]}),!a&&e.jsxs(_,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[b,"Â ",l==null?void 0:l.symbol]})]}),e.jsxs(j,{gap:n=="card"?"4px":"20px",flexDirection:n=="card"&&!a?"column":"row",align:n=="card"?"flex-end":"center",children:[e.jsxs(_,{h:"20px",lineHeight:"20px",children:[De(Number(o.block_time),"")," (UTC)"]}),e.jsxs(j,{gap:"4px",cursor:"pointer",onClick:f=>{Be(f),window.open(u(o.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!a&&e.jsx(_,{color:"text_caption",children:"View Transaction"}),e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),a&&e.jsxs(_,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[b,"Â ",l==null?void 0:l.symbol]})]},o==null?void 0:o.tx)})})})},oe=({info:t})=>{const[n,r]=d.useState(!0),{getTokenRank:u}=Qt();d.useEffect(()=>{const a=u(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",a),r(a)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:x,target_coin:p,price:g,reseverPrice:h}=t;return e.jsxs(j,{justifyContent:"end",children:[n?e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(_,{color:"text_caption",lineHeight:"1",children:$(g)}),e.jsxs(_,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[p.symbol," per ",x.symbol]})]}):e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(_,{color:"text_caption",children:$(h)}),e.jsxs(_,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[x.symbol," per ",p.symbol]})]}),e.jsx(ee,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:a=>{Be(a),r(!n)}})]})},St=({historyInfo:t,openExpendItemObj:n})=>e.jsxs(j,{justifyContent:"end",gap:"4px",children:[(t==null?void 0:t.status)=="Cancelled"?e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(ee,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"}),e.jsx(_,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),e.jsx(ee,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:n[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),ds=(t,n)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:r=>{t(()=>({orderListLoading:r}))},setMyOrderList:r=>{t(()=>({myOrderList:r}))}}),Oe=jt(ds);function ve(){const{currentAccount:t,addressChangeVersion:n}=se(),{peripherySdk:r}=Se(),{setOrderListLoading:u,setMyOrderList:x,myOrderList:p,orderListLoading:g}=Oe(),{getTokenListInfo:h}=Ve(),a=async(l=t==null?void 0:t.address,i)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",l);try{if(!l){u(!1),x([]);return}i&&u(!0);const s=await r.LimitOrder.getOwnerLimitOrderList(l,"all"),c=await o(s.data.filter(b=>b.status===fe.PartialCompleted||b.status===fe.Running));x(c),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",c)}catch(s){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",s)}finally{u(!1)}},o=async l=>{const i=[],s=[];for(const b of l)s.push(b.pay_coin_type),s.push(b.target_coin_type);const c=await h(s);for(const b of l){const[f,L]=[c==null?void 0:c.get(b.pay_coin_type),c==null?void 0:c.get(b.target_coin_type)];if(f&&L){const{total_pay_amount:O,pay_balance:v,rate:M,obtained_amount:y,claimed_amount:S,target_balance:w,created_ts:H,expire_ts:B,status:E,id:Q}=b,W=ie(O,f.decimals).toString(),Y=ie(v,f.decimals).toString(),T=ie(y,L.decimals).toString(),V=ie(S,L.decimals).toString(),k=ie(w,L.decimals).toString(),C=bt.rateToPrice(M.toString(),f.decimals,L.decimals),q=X(1).div(C).toString(),ce=ie(X(O).sub(v).toFixed(0),f.decimals).toString(),Te={order_id:Q,pay_coin:f,target_coin:L,price:C,reseverPrice:q,total_pay_amount:W,expect_obtain_amount:X(W).mul(C).toString(),remaining_amount:Y,deal_amount:ce,deal_rate:X(ce).div(W).toString(),obtained_amount:T,claimed_amount:V,un_claimed_amount:X(k).sub(V).toString(),created_ts:H,expire_ts:B,status:E};i.push(Te)}}return i.sort((b,f)=>f.created_ts-b.created_ts)};return{fetchMyLimitOrder:a,orderListLoading:g,myOrderList:p}}function Ct(){const{fetchAccountBalance:t}=Le(),{fetchMyLimitOrder:n}=ve(),{signAndExecuteTransaction:r}=ue(),{peripherySdk:u}=Se(),[x,p]=d.useState(!1),{transactionConfirmation:g}=ue();return{handleCancelOrder:async a=>{p(!0);const o={getShowInfo:c=>{const b="Canceling order",f={modalDescriptionText:b,toastTitleText:b};return c==="success"&&(f.toastDescriptionContent="Order cancelled successfully",f.modalDescriptionText="Order cancelled successfully",f.toastTitleText="Order cancelled"),f}};g(o);const l=a.map(c=>({pay_coin_type:c.pay_coin.coin_type,target_coin_type:c.target_coin.coin_type,order_id:c.order_id})),i=await u.LimitOrder.cancelOrdersByOwner(l),s=await r(i,o);p(!1),s&&setTimeout(()=>{t(),n()},2e3)},cancelOrderLoading:x}}function ps(){const{fetchAccountBalance:t}=Le(),{fetchMyLimitOrder:n}=ve(),{signAndExecuteTransaction:r}=ue(),{peripherySdk:u}=Se(),[x,p]=d.useState(!1),[g,h]=d.useState(!1);return{handleClaimOrder:async(l,i)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",l),p(!0);const s={pay_coin_type:l.pay_coin.coin_type,target_coin_type:l.target_coin.coin_type,order_id:l.order_id},c=await u.LimitOrder.claimTargetCoin(s),b=await r(c,{getShowInfo:(f,L)=>{var M;const O=`Claim ${$(i)} ${(M=l==null?void 0:l.target_coin)==null?void 0:M.symbol}`,v={modalDescriptionText:O,toastTitleText:O};return f==="success"&&(v.toastDescriptionContent="",v.modalDescriptionText="",v.toastTitleText="Claim successfully"),v}});p(!1),b&&setTimeout(()=>{t(),n()},2e3)},getLimitOrderClaimHistory:async l=>{h(!0);const i=await u.LimitOrder.getLimitOrderClaimLogs(l.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",l,i),i?(h(!1),i.map(s=>{var b;const c=N(s.parsedJson.claimed_amount).div(Math.pow(10,(b=l.target_coin)==null?void 0:b.decimals));return{...s,...s.parsedJson,claimed_amount:c}})):[]},isClaimHistoryLoading:g,claimLoading:x}}const xs=({orderInfo:t,isOpen:n,onClose:r,handleClaim:u,claimLoading:x,getLimitOrderClaimHistory:p,isClaimHistoryLoading:g})=>{const{getExplorerUrl:h}=ht(),[a,o]=d.useState(""),[l,i]=d.useState([]),[s,c]=d.useState({label:"Claim",value:"claim"}),b=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],f=y=>{c(y),(y==null?void 0:y.value)=="history"&&L()},L=async()=>{const y=await p();y&&i(y)},O=d.useMemo(()=>!a||x?{disabled:!0,text:"Claim"}:N(a).gt(t.un_claimed_amount)||N(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[a,t.un_claimed_amount]),[v,M]=d.useState(!0);return d.useEffect(()=>{v&&(M(!1),o(t.un_claimed_amount))},[v,t.un_claimed_amount]),e.jsxs(Ee,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Ae,{}),e.jsxs(Re,{children:[e.jsx(ze,{children:e.jsx(lt,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(Fe,{}),e.jsx(Ne,{textAlign:"center",p:"0px",children:e.jsxs(P,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(U,{borderRadius:"8px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(ge,{info:t,imgSize:"28px"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(je,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(he,{info:t})]}),e.jsx(ft,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:b,currentTab:s.label,handleChangeTab:f}),(s==null?void 0:s.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(P,{gap:"16px",align:"flex-start",children:[e.jsx(_,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_t,{value:a?$(a).toString():"",onChange:y=>{o(y)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(j,{children:e.jsx(Kt,{portal:!1,token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(I,{onClick:()=>{u(a),r()},disabled:O.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:O.text})]}),(s==null?void 0:s.value)=="history"&&e.jsx(P,{w:"100%",gap:"12px",children:g?e.jsxs(U,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(j,{justify:"space-between",children:[e.jsx(K,{height:"4",width:"150px"}),e.jsx(K,{height:"4",width:"150px"})]}),e.jsxs(j,{justify:"space-between",mt:"16px",children:[e.jsx(K,{height:"4",width:"150px"}),e.jsx(K,{height:"4",width:"150px"})]})]},history==null?void 0:history.id):(l==null?void 0:l.length)==0?e.jsx(te,{type:"nodata",text:"No History.",p:"20px"}):l==null?void 0:l.map(y=>{var S,w;return e.jsx(U,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(P,{gap:"16px",align:"flex-start",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Amount"}),e.jsxs(j,{gap:"4px",children:[e.jsx(Yt,{imageUrl:(S=t==null?void 0:t.target_coin)==null?void 0:S.logo_url,w:"20px",h:"20px"}),e.jsxs(_,{color:"text_caption",lineHeight:"18px",children:[$(y==null?void 0:y.claimed_amount)," ",(w=t==null?void 0:t.target_coin)==null?void 0:w.symbol]})]})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Time"}),e.jsxs(j,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:H=>{Be(H),window.open(h(y.digest,"tx"))},children:[e.jsxs(_,{color:"text_caption",children:[De(Number(y==null?void 0:y.timestampMs),"")," (UTC)"]}),e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},y.digest)})})]})})]})]})},He=({orderInfo:t})=>{const{handleCancelOrder:n,cancelOrderLoading:r}=Ct(),{handleClaimOrder:u,claimLoading:x,getLimitOrderClaimHistory:p,isClaimHistoryLoading:g}=ps(),[h,a]=d.useState(),[o,l]=d.useState(!1),i=(s,c)=>{a(s),c==="cancel"&&n([s]),c==="claim"&&l(!0)};return ne(),e.jsxs(j,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:"space-between",gap:"8px",children:[N(t==null?void 0:t.obtained_amount).lte(0)&&N(t.un_claimed_amount).lte(0)?e.jsx(We,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."}),children:e.jsx(me,{w:{base:"calc(50vw - 28px)",lg:"80px"},children:e.jsx(I,{disabled:!0,w:"100%",h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",children:"Claim"})})}):e.jsx(I,{isLoading:x,disabled:x,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",onClick:()=>{x||i(t,"claim")},children:"Claim"}),e.jsx(I,{isLoading:r,disabled:r,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",color:"primary_gray",bg:"button_ghost_bg",onClick:()=>{r||i(t,"cancel")},children:"Cancel"}),o&&e.jsx(xs,{orderInfo:t,claimLoading:x,isOpen:o,onClose:()=>l(!1),handleClaim:s=>u(t,s),getLimitOrderClaimHistory:()=>p(t),isClaimHistoryLoading:g})]})};function at(){const{currentAccount:t,onWalletModal:n}=se(),{myOrderList:r,orderListLoading:u}=Oe();console.log("ðŸš€ ~ OrderTableList ~ myOrderList:",r);const x=10,[p,g]=d.useState([]),[h,a]=d.useState(0),[o,l]=d.useState(1);return d.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const i=(o-1)*x,s=i+x;g(r.slice(i,s))}},[o,r]),e.jsx(P,{w:"100%",children:t!=null&&t.address?u?e.jsx(U,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((i,s)=>e.jsx(Lt,{},s))})}):r.length===0?e.jsx(te,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"}):e.jsxs(U,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(p==null?void 0:p.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:p==null?void 0:p.map(i=>e.jsx(us,{orderInfo:i},i==null?void 0:i.order_id))}),!u&&(r==null?void 0:r.length)>x&&e.jsx(me,{mt:"12px",children:e.jsx(Ce,{total:h,size:x,currentPage:o,onChange:l})})]}):e.jsx(te,{type:"nowallet",onboard:()=>n(!0),borderRadius:"16px"})})}const us=({orderInfo:t})=>{const{isApp:n}=ne();return e.jsxs(P,{w:"100%",gap:"16px",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(ge,{info:t,imgSize:"28px"}),!n&&e.jsx(He,{orderInfo:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(je,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(he,{info:t})]}),n&&e.jsx(He,{orderInfo:t})]})},Lt=()=>e.jsxs(P,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsx(j,{w:"100%",gap:"0",justify:"space-between",children:e.jsxs(j,{gap:"0",children:[e.jsxs(j,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(Ie,{size:"8"}),e.jsx(Ie,{size:"8"})]}),e.jsx(K,{height:"4",width:"100px"})]})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(K,{height:"4",width:"180px"}),e.jsx(K,{height:"4",width:"150px"})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(K,{height:"4",width:"180px"}),e.jsx(K,{height:"4",width:"150px"})]})]});function ot(t){const{historyOrderList:n,historyOrderLoading:r}=t,{currentAccount:u,onWalletModal:x}=se();console.log("ðŸš€ ~ OrderTableList ~ historyOrderList:",n);const p=10,[g,h]=d.useState([]),[a,o]=d.useState(0),[l,i]=d.useState(1);return d.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const s=(l-1)*p,c=s+p;h(n.slice(s,c))}},[l,n]),e.jsx(P,{w:"100%",children:u!=null&&u.address?r?e.jsx(U,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((s,c)=>e.jsx(Lt,{},c))})}):n.length===0?e.jsx(te,{type:"nodata",text:"You don't have any order history.",borderRadius:"16px"}):e.jsxs(U,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(g==null?void 0:g.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:g==null?void 0:g.map(s=>e.jsx(ms,{historyInfo:s},s==null?void 0:s.order_id))}),!r&&(n==null?void 0:n.length)>p&&e.jsx(me,{mt:"12px",children:e.jsx(Ce,{total:a,size:p,currentPage:l,onChange:i})})]}):e.jsx(te,{type:"nowallet",onboard:()=>x(!0),borderRadius:"16px"})})}const ms=({historyInfo:t})=>{const[n,r]=d.useState({});return e.jsxs(P,{w:"100%",gap:"16px",children:[e.jsx(j,{w:"100%",justify:"space-between",children:e.jsx(ge,{info:t,imgSize:"28px"})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Limit Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(he,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(je,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Status"}),e.jsx(dt,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},children:e.jsx(St,{historyInfo:t,openExpendItemObj:n})})]}),n[t==null?void 0:t.order_id]&&e.jsx(yt,{historyInfo:t,p:"0",border:"none",type:"card"})]})};function gs({historyInfo:t}){const[n,r]=d.useState({});return e.jsxs(ye.Fragment,{children:[e.jsxs(J,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},sx:{td:{pb:n[t==null?void 0:t.order_id]?"20px !important":"16px !important"}},children:[e.jsx(D,{w:"30%",children:e.jsx(ge,{info:t})}),e.jsx(D,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(he,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(je,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(St,{historyInfo:t,openExpendItemObj:n})})]}),!n[t==null?void 0:t.order_id]&&e.jsx(J,{h:"16px"}),e.jsx(J,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:n[t==null?void 0:t.order_id]&&e.jsx(D,{colSpan:5,children:e.jsx(yt,{historyInfo:t})})})]},t==null?void 0:t.order_id)}function hs(t){const{historyOrderList:n,historyOrderLoading:r}=t;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",n);const{currentAccount:u,onWalletModal:x}=se(),p=10,[g,h]=d.useState([]),[a,o]=d.useState(0),[l,i]=d.useState(1);return d.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const s=(l-1)*p,c=s+p;h(n.slice(s,c))}},[l,n]),e.jsxs(pt,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(xt,{children:e.jsxs(J,{children:[e.jsx(Z,{children:"Order Info"}),e.jsx(Z,{textAlign:"right",children:"Limit Price"}),e.jsx(Z,{textAlign:"right",children:"Expiry"}),e.jsx(Z,{textAlign:"right",children:"Filled Size"}),e.jsx(Z,{textAlign:"right",children:"Status"})]})}),e.jsx(ut,{children:u!=null&&u.address?r?e.jsx(wt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):n.length===0?e.jsx(J,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(D,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(ye.Fragment,{children:[g.map(s=>e.jsx(gs,{historyInfo:s},s.order_id)),!r&&(n==null?void 0:n.length)>p&&e.jsx(D,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(Ce,{total:a,size:p,currentPage:l,onChange:i})})})]}):e.jsx(J,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(D,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nowallet",onboard:()=>{x(!0)}})})})})]})}const js=(t,n)=>({quoteToken:void 0,payCoin:_e.clmm_swap.from_coin,targetCoin:_e.clmm_swap.to_coin,setPayCoin:r=>{t(()=>({payCoin:r}))},setTargetCoin:r=>{t(()=>({targetCoin:r}))},setQuoteToken:r=>{t(()=>({quoteToken:r}))},expiresIn:"7 Days",setExpiresIn:r=>{t(()=>({expiresIn:r}))},customExpiresVal:null,setCustomExpiresVal:r=>{t(()=>({customExpiresVal:r}))},refreshPriceLoading:!1,setRefreshPriceLoading:r=>{t(()=>({refreshPriceLoading:r}))}}),re=jt(js);function bs(t,n){const{getTokenPrice:r}=$e(),u=r(t),x=r(n),p=d.useMemo(()=>{if(u&&x){const g=X(u.price).div(x.price).toString(),h=g.toString();return{price:g,displayPrice:h}}},[u,x]);return{price:p==null?void 0:p.price,displayPrice:p==null?void 0:p.displayPrice}}function Ot(){const{payCoin:t,targetCoin:n,setRefreshPriceLoading:r}=re(),{fetchTokenPrices:u}=$e();return{refreshCoinMarketPrice:()=>{const p=[];t&&p.push(t.coin_type),n&&p.push(n.coin_type),p.length>0&&(r(!0),u(p).finally(()=>{r(!1)}))}}}function fs(){const{refreshCoinMarketPrice:t}=Ot(),{fetchAccountBalance:n}=Le(),{fetchMyLimitOrder:r}=ve(),{signAndExecuteTransaction:u}=ue(),{peripherySdk:x}=Se(),{findBestRouters:p}=qt(),{getTokenAmountValue:g}=$e(),h=mt(),{pay:a,target:o}=Wt(),{getTokenListInfo:l}=Ve(),{payCoin:i,targetCoin:s,quoteToken:c,expiresIn:b,setPayCoin:f,setTargetCoin:L,setQuoteToken:O,customExpiresVal:v,setExpiresIn:M,setRefreshPriceLoading:y}=re(),[S,w]=d.useState(""),[H,B]=d.useState(""),[E,Q]=d.useState(!0),[W,Y]=d.useState(!0),[T,V]=d.useState(""),{displayPrice:k}=bs((c==null?void 0:c.coin_type)===(i==null?void 0:i.coin_type)?s==null?void 0:s.coin_type:i==null?void 0:i.coin_type,c==null?void 0:c.coin_type),{balanceInfo:C}=nt(i),{balanceInfo:q}=nt(s),ce=g(i==null?void 0:i.coin_type,S),Te=g(s==null?void 0:s.coin_type,H),[Pe,vt]=d.useState(""),Ye=d.useRef(Pe);d.useEffect(()=>{Ye.current=Pe},[Pe]);const[le,Ge]=d.useState(void 0),[de,Ue]=d.useState(""),Tt=d.useRef(S),Pt=d.useRef(H);d.useEffect(()=>{Tt.current=S},[S]),d.useEffect(()=>{Pt.current=H},[H]),d.useEffect(()=>{(async()=>{const A=[a,o].filter(Boolean),R=await l(A),z=R==null?void 0:R.get(a||"");f(z||_e.clmm_swap.from_coin);const G=R==null?void 0:R.get(o||"");L(G||_e.clmm_swap.to_coin)})()},[a,o]),d.useEffect(()=>{if(Ge(void 0),t(),kt(),i&&s){const m=i.extensions&&i.extensions.rank||"0",A=s.extensions&&s.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",i,s),N(m).gte(A)?O({...i}):O({...s})}},[i==null?void 0:i.coin_type,s==null?void 0:s.coin_type]);const kt=async()=>{if(i&&s){const m=`${i.coin_type}_${s.coin_type}`;vt(m);const A=Object.entries(Zt).map(([z,G])=>G.id),R=await p({fromToken:i,toToken:s,amount:tt(1,i.decimals).toFixed(0),providersKeys:A,by_amount_in:!0,uuid:m});m===Ye.current&&Ge(R)}};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",W,k),W?V(k||""):Qe()},[k]),d.useEffect(()=>{c&&!W&&+T&&V($(N(1).div(T).toFixed(c.decimals)).toString())},[c]),d.useEffect(()=>{Ke(E?S:H,E),Qe()},[T]);const[pe,Mt]=d.useState({tooltip:"",color:"",text:"",bg:""}),[Ht,Je]=d.useState(!1),Qe=()=>{var m,A;if(!W&&k&&T){Je(!0);const R=N(T).sub(k).div(k).mul(100).toFixed(2);Ue(R);const z=N(R).gt(0),G=z?R:R.split("-")[1],F={tooltip:"",color:"",text:"",bg:""};F.tooltip=`Limit order price is ${G}% ${z?"higher":"lower"} than the market.`,((m=c==null?void 0:c.coin_type)==null?void 0:m.toLowerCase())==((A=s==null?void 0:s.coin_type)==null?void 0:A.toLowerCase())?Number(T)>Number(k)?(F.text="",F.color="#68FFD8"):Number(k)>Number(T)&&(F.text=`Your limit order price is ${G}% ${z?"higher":"lower"} than market. You are selling at a much ${z?"higher":"lower"} rate. We recommend you to use`,F.color="#ffb62d",F.bg="rgba(255,202,104,0.1)"):Number(T)>Number(k)?(F.text=`Your limit order price is ${G}% ${z?"higher":"lower"} than market. You are buying at a much ${z?"higher":"lower"} rate. We recommend you to use`,F.color="#ffb62d",F.bg="rgba(255,202,104,0.1)"):Number(k)>Number(T)&&(F.text="",F.color="#68FFD8"),Mt(F),Je(!1);return}Ue("")},Et=(m=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",k),Y(m),m&&(V(k||""),t())},Ke=(m,A)=>{if(Q(A),A?w(m):B(m),c&&i&&s&&+T&&+m)if(A){c.coin_type===i.coin_type?B(N(m).div(T).toString().toString()):B(N(m).mul(T).toString().toString());return}else{c.coin_type===s.coin_type?w(N(m).div(T).toString().toString()):w(N(m).mul(T).toString().toString());return}A?B(""):w("")},Ze=(m,A)=>{Xe(),Q(A),Y(!0),A?m.coin_type===(s==null?void 0:s.coin_type)?h(`/limit/${m==null?void 0:m.coin_type}/${i==null?void 0:i.coin_type}`):h(`/limit/${m==null?void 0:m.coin_type}/${s==null?void 0:s.coin_type}`):m.coin_type===(i==null?void 0:i.coin_type)?h(`/limit/${s==null?void 0:s.coin_type}/${m==null?void 0:m.coin_type}`):h(`/limit/${i==null?void 0:i.coin_type}/${m==null?void 0:m.coin_type}`)},At=async()=>{V(k||""),s&&(Ze(s,!0),w(H),B(S))},Xe=()=>{w(""),B("")};d.useEffect(()=>()=>{M("7 Days")},[]);const[Rt,ke]=d.useState(!1),zt=m=>{switch(m){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:Ft}=Xt(),{transactionConfirmation:Nt}=ue(),Dt=async()=>{const m={getShowInfo:(z,G)=>{const F="Creating order",xe={modalDescriptionText:F,toastTitleText:F};return z==="success"&&(xe.toastDescriptionContent="",xe.modalDescriptionText="Created order successfully",xe.toastTitleText="Created order successfully"),z==="rejected"&&(xe.toastTitleText="Create order"),xe}};Nt(m);const A=Date.parse(new Date().toString())+(zt(b)||v);console.log(" ~ handleSubmitOrder ~ expired_ts:",A),ke(!0);let R;(c==null?void 0:c.coin_type)===(s==null?void 0:s.coin_type)?R=T:R=N(1).div(T).toFixed(s.decimals);try{const z={pay_coin_type:i.coin_type,target_coin_type:s.coin_type,expired_ts:A,target_decimal:s.decimals,pay_decimal:i.decimals,price:Number(R),pay_coin_amount:Number(tt(S,i.decimals).toFixed(0))},G=await x.LimitOrder.placeLimitOrder(z),F=await u(G,m);ke(!1),F&&(n(),r(),Xe())}catch(z){Ft(String(z)),ke(!1)}},{currentAccount:ae}=se(),qe=d.useMemo(()=>{const m=g(i==null?void 0:i.coin_type,S);return Number(m)==0&&Number(S)>0?!1:Number(m)<5},[i,S]),Bt=d.useMemo(()=>{const m={text:"Place Limit Order",disabled:!1};return ae!=null&&ae.address?!i||!s?(m.disabled=!0,m.text=" Select a token",m):!Number(S)||!Number(H)?(m.disabled=!0,m.text="Enter an amount",m):qe?(m.disabled=!0,m.text="Order size should be higher than $5",m):Number(S)>Number(C==null?void 0:C.balanceFormat)||!(C!=null&&C.balanceFormat)?(m.disabled=!0,m.text=`Insufficient ${i==null?void 0:i.symbol} balance`,m):le&&le.errorCode&&(le.errorCode===it.NoRouter||le.errorCode===it.HoneyPot)?(m.text="No Available Route",m.disabled=!0,m):(console.log("ðŸš€ ~ buttonTextStatus ~ priceImpact:",12,pe.color,pe,de),pe.color.toLowerCase()=="#ffb62d"&&(Number(de)<-10||Number(de)>10)&&(m.disabled=!0),m):(m.disabled=!1,m.text="Connect Wallet",m)},[ae==null?void 0:ae.address,i,s,le,S,H,qe,C,JSON.stringify(pe),de]);return{priceImpactInfoLoading:Ht,priceImpactInfo:pe,fixPayCoin:E,onReverseClick:At,handleSelectToken:Ze,marketPrice:k,payCoin:i,targetCoin:s,handleAmountChange:Ke,payAmount:S,targetAmount:H,payBalanceInfo:C,targetBalanceInfo:q,payAmountValue:ce,targetAmountValue:Te,useMarketPrice:W,handleMarketPriceClick:Et,inputPrice:T,setInputPrice:V,priceImpact:de,quoteToken:c,setQuoteToken:O,handleSubmitOrder:Dt,submitOrderLoading:Rt,buttonTextStatus:Bt}}const _s=({confirmData:t,isOpen:n,onClose:r,handleSubmitOrder:u,submitOrderLoading:x})=>{const{payAmount:p,targetAmount:g,payCoin:h,targetCoin:a,inputPrice:o,expiresIn:l,quoteToken:i}=t,s=d.useMemo(()=>{var b,f;return console.log("ðŸš€ ~ price ~ inputPrice:",o),o?((b=i==null?void 0:i.coin_type)==null?void 0:b.toLowerCase())==((f=a==null?void 0:a.coin_type)==null?void 0:f.toLowerCase())?o:N(1).div(o).toString():""},[i,a,o]),c=d.useMemo(()=>{var b,f;return o?((b=i==null?void 0:i.coin_type)==null?void 0:b.toLowerCase())==((f=a==null?void 0:a.coin_type)==null?void 0:f.toLowerCase())?N(1).div(o).toString():o:""},[i,a,o]);return e.jsxs(Ee,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Ae,{}),e.jsxs(Re,{children:[e.jsx(ze,{children:e.jsx(lt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(Fe,{}),e.jsx(Ne,{textAlign:"center",p:"0px",children:e.jsxs(P,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(as,{coinA:{amount:$(p,h==null?void 0:h.decimals).toString()||"0",...h},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:$(g,a==null?void 0:a.decimals).toString()||"0",...a}}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(K,{isLoaded:!!o,children:e.jsx(oe,{info:{pay_coin:h,target_coin:a,price:s,reseverPrice:c}})})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expires in"}),e.jsx(_,{color:"text_caption",children:l})]}),e.jsx(U,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(U,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(I,{onClick:()=>{u(),r()},disabled:x,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},ws=({isOpen:t,onClose:n})=>{const{isApp:r}=ne(),{setCustomExpiresVal:u,setExpiresIn:x}=re(),[p,g]=d.useState(""),[h,a]=d.useState(""),o=L=>{const O=L.target.value.replace(/[^\d]/g,"");g(O)},l=L=>{const O=L.target.value.replace(/[^\d]/g,"");a(O)},[i,s]=d.useState({}),c=(L,O)=>{const v=Number(L||0)*60+Number(O||0),M=Math.floor(v/(60*24)),y=Math.floor(v%(60*24)/60),S=v%60;let w="";M>0&&(w+=M+"d "),y>0&&(w+=y+"h "),S>0&&(w+=S+"m "),s({timeText:w.trim()||"0 m",time:v*60*1e3})};d.useEffect(()=>{c(p,h)},[p,h]);const b=d.useMemo(()=>!p&&!h||Number(p)==0&&!h||Number(h)==0&&!p||Number(p)==0&&Number(h)==0,[p,h]),f=()=>{x(i==null?void 0:i.timeText),u(i==null?void 0:i.time),n()};return e.jsxs(Ee,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Ae,{}),e.jsxs(Re,{maxW:"1200px",w:r?"calc(100vw - 32px)":"440px",children:[e.jsx(ze,{mr:"-10px",children:e.jsxs(j,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(j,{gap:"0",align:"center",children:e.jsx(Fe,{mt:"0",position:"static"})})]})}),e.jsx(Ne,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(P,{w:"100%",children:[e.jsx(we,{children:e.jsxs(j,{children:[e.jsx(et,{value:p,onChange:o,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Hours"})]})}),e.jsx(we,{children:e.jsxs(j,{children:[e.jsx(et,{value:h,onChange:l,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Minutes"})]})}),e.jsx(I,{onClick:f,disabled:b,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function ys(t){const{expiresIn:n,setExpiresIn:r}=re(),[u,x]=d.useState(!1),p=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(we,{w:"156px",borderRadius:"16px",children:[e.jsxs(P,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(We,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(j,{gap:"4px",children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(ee,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(ts,{label:n||"",list:p,onListItemClick:g=>{g=="Custom"?x(!0):r(g)}})]}),u&&e.jsx(ws,{isOpen:u,onClose:()=>x(!1)})]})}function Ss(t){ne();const{marketPrice:n,priceImpactInfo:r,priceImpactInfoLoading:u,priceImpact:x,inputPrice:p,handleMarketPriceClick:g,setInputPrice:h}=t,{payCoin:a,targetCoin:o,quoteToken:l,refreshPriceLoading:i,setQuoteToken:s}=re();return e.jsx(we,{w:"calc(100% - 156px)",children:e.jsxs(P,{w:"100%",gap:"20px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsxs(j,{children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:(l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?`Buy ${st(o==null?void 0:o.symbol,10)} at rate`:`Sell ${st(a==null?void 0:a.symbol,10)} at rate`}),Number(x)!==0&&!i&&(u?e.jsx($t,{size:"sm"}):e.jsx(We,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:r.tooltip}),children:e.jsxs(_,{color:r.color,children:[N(x).gt(0)?"+":"",Number(x)>1e4?">10000%":gt(x)]})}))]}),(n||i)&&e.jsx(I,{isLoading:i,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>g(!0),children:"Market"})]}),e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsx(_t,{value:p?Gt(p).toString():"",onChange:c=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",p,c),g(!1),h(c)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(_,{textColor:"text_caption",children:l==null?void 0:l.symbol}),e.jsx(ee,{xlinkHref:"#icon-icon_swap1",onClick:()=>{o&&a&&((l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?s(o):s(a))}})]})]})]})})}function Cs(){const{expiresIn:t}=re(),{buttonTextStatus:n,payBalanceInfo:r,targetBalanceInfo:u,payAmountValue:x,targetAmountValue:p,payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,marketPrice:l,handleAmountChange:i,handleMarketPriceClick:s,handleSelectToken:c,inputPrice:b,setInputPrice:f,priceImpact:L,quoteToken:O,handleSubmitOrder:v,submitOrderLoading:M,onReverseClick:y,priceImpactInfoLoading:S,priceImpactInfo:w}=fs(),H=d.useMemo(()=>({payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,inputPrice:b,expiresIn:t,quoteToken:O}),[g,h,a,o,b,t,O]),{onWalletModal:B}=se(),[E,Q]=d.useState("#icon-a-icon_trade"),W=C=>Q(C?"#icon-icon_swap1":"#icon-a-icon_trade"),[Y,T]=d.useState(!1),V=mt(),k=d.useMemo(()=>{const C=[];return a&&C.push(a),o&&C.push(o),C},[a,o]);return e.jsxs(P,{w:{base:"100%",lg:"470px"},gap:"8px",mb:"8px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(is,{currTradeTab:ns.Limit}),e.jsx(ss,{})]}),e.jsx(It,{onClick:y,from:{title:"You Pay",balance:(r==null?void 0:r.balanceFormat)||"",value:g,amountValue:x,onChange:C=>{i(C,!0)},selectable:!0,placeholder:"0.0",token:a,onTokenChange:C=>{c(C,!0)}},to:{title:"You Receive",balance:(u==null?void 0:u.balanceFormat)||"",value:h,amountValue:p,onTokenChange:C=>{c(C,!1)},onChange:C=>{i(C,!1)},selectable:!0,placeholder:"0.0",token:o,half:!1,max:!1},iconParams:{xlinkHref:E,svgFill:"text_caption",transform:E==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:E==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>W(!0),onMouseLeave:()=>W(!1)}}),e.jsxs(j,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(Ss,{marketPrice:l,priceImpactInfoLoading:S,priceImpactInfo:w,priceImpact:L,inputPrice:b,setInputPrice:f,handleMarketPriceClick:s}),e.jsx(ys,{})]}),(w==null?void 0:w.text)&&l&&Number(L)!==0&&b&&e.jsxs(_,{color:w==null?void 0:w.color,lineHeight:"20px",bg:w==null?void 0:w.bg,p:"12px",borderRadius:"8px",children:[w==null?void 0:w.text,"Â ",e.jsx(_,{color:w==null?void 0:w.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>V(`/swap/${a==null?void 0:a.coin_type}/${o==null?void 0:o.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(I,{disabled:(n==null?void 0:n.disabled)||M,isLoading:M,mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",onClick:(n==null?void 0:n.text)=="Connect Wallet"?()=>B(!0):()=>T(!0),children:n==null?void 0:n.text}),Y&&e.jsx(_s,{confirmData:H,isOpen:Y,onClose:()=>T(!1),handleSubmitOrder:v,submitOrderLoading:M}),(a||o)&&e.jsx(es,{addToken:!0,tokensInfo:k,waringModalCancel:C=>{C.forEach(q=>{(q.coin_type===(a==null?void 0:a.coin_type)||q.coin_type===(o==null?void 0:o.coin_type))&&c(void 0,q.coin_type===(a==null?void 0:a.coin_type))})}})]})}function Ls({orderInfo:t}){return e.jsxs(ye.Fragment,{children:[e.jsxs(J,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(D,{w:"30%",children:e.jsx(ge,{info:t})}),e.jsx(D,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(je,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(he,{info:t})}),e.jsx(D,{textAlign:"right",children:e.jsx(He,{orderInfo:t})})]}),e.jsx(J,{h:"16px"})]},t==null?void 0:t.order_id)}function Os(){const{currentAccount:t,onWalletModal:n}=se(),{myOrderList:r,orderListLoading:u}=Oe();console.log("ðŸš€ ~ OrderTableList ~ myOrderList:",r);const x=10,[p,g]=d.useState([]),[h,a]=d.useState(0),[o,l]=d.useState(1);return d.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const i=(o-1)*x,s=i+x;g(r.slice(i,s))}},[o,r]),e.jsxs(pt,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(xt,{children:e.jsxs(J,{children:[e.jsx(Z,{children:"Order Info"}),e.jsx(Z,{textAlign:"right",children:"Price"}),e.jsx(Z,{textAlign:"right",children:"Filled Size"}),e.jsx(Z,{textAlign:"right",children:"Expiry"}),e.jsx(Z,{textAlign:"right",children:"Action"})]})}),e.jsx(ut,{children:t!=null&&t.address?u?e.jsx(wt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):r.length===0?e.jsx(J,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(D,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(ye.Fragment,{children:[p.map(i=>e.jsx(Ls,{orderInfo:i},i.order_id)),!u&&(r==null?void 0:r.length)>x&&e.jsx(D,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(Ce,{total:h,size:x,currentPage:o,onChange:l})})})]}):e.jsx(J,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(D,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nowallet",onboard:()=>{n(!0)},borderRadius:"16px"})})})})]})}function vs(){const{fetchByApi:t}=Ut(),{getTokenListInfo:n}=Ve(),{currentAccount:r}=se(),[u,x]=d.useState(!1),[p,g]=d.useState([]);d.useEffect(()=>{g([])},[r==null?void 0:r.address]);const h=async(o,l)=>{var i;try{l&&x(!0);const s=await t(Jt,"GET",{wallet_address:o});if(console.log(s,"getLimitOrderHistory"),s!=null&&s.list&&((i=s==null?void 0:s.list)==null?void 0:i.length)>0){const c=await a((s==null?void 0:s.list)||[]);return g(c),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",c),c}return[]}catch(s){return console.log("getLimitOrderHistory ~ error:",s),[]}finally{x(!1)}},a=async o=>{const l=[],i=[];for(const c of o)i.push(be(c.pay_coin,!1)),i.push(be(c.target_coin,!1));const s=await n(i);for(const c of o){const[b,f]=[s==null?void 0:s.get(be(c.pay_coin,!1)),s==null?void 0:s.get(be(c.target_coin,!1))];if(b&&f){const{total_pay_amount:L,remaining_amount:O,rate:v,obtained_amount:M,claimed_amount:y,target_balance:S,created_ts:w,expire_ts:H,cancel_reason:B,events:E}=c,Q=E;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",c,Q),Q.sort((C,q)=>q.block_time-C.block_time);const W=ie(L,b.decimals).toString(),Y=bt.rateToPrice(v.toString(),b.decimals,f.decimals),T=X(1).div(Y).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",Y,T);const V=ie(X(L).sub(O).toFixed(0),b.decimals).toString(),k={order_id:c.order_id,pay_coin:b,target_coin:f,price:Y,reseverPrice:T,total_pay_amount:W,remaining_amount:O,deal_amount:V,deal_rate:X(V).div(W).toString(),expect_obtain_amount:X(W).mul(Y).toString(),obtained_amount:M,claimed_amount:y,un_claimed_amount:"0",created_ts:w,expire_ts:H,status:Number(B)===0?fe.Completed:fe.Cancelled,events:Q};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",k),l.push(k)}}return l.sort((c,b)=>b.created_ts=c.created_ts),l};return{getLimitOrderHistory:h,historyOrderLoading:u,historyOrderList:p}}function Si(){const{currentAccount:t}=se(),{getLimitOrderHistory:n,historyOrderList:r,historyOrderLoading:u}=vs(),{fetchMyLimitOrder:x}=ve(),{setMyOrderList:p,myOrderList:g,orderListLoading:h}=Oe(),{payCoin:a,targetCoin:o}=re(),{fetchAccountBalance:l}=Le();d.useEffect(()=>{t!=null&&t.address&&l()},[]);const{isShowTradeChart:i,isShowTradeOrders:s}=rs(),[c,b]=d.useState([]),[f,L]=d.useState({label:"Open Orders"}),O=d.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",g);const E=[];return E.push({label:"Open Orders",num:f.label==="Open Orders"&&g.length>0&&!h?g.length.toString():void 0}),E.push({label:"Order History",num:f.label==="Order History"&&c.length>0&&!u?c.length.toString():void 0}),E},[f.label,g,c,u,h]);d.useEffect(()=>{v(!0)},[f.label,t,s]),ls({onRpcChange:()=>{v(!0),t!=null&&t.address&&l()}});const v=E=>{s&&(B(0),console.log("ðŸš€  ~ currentAccount:",f.label==="Open Orders",t==null?void 0:t.address),t!=null&&t.address&&(f.label==="Open Orders"?x(t.address,E):(console.log("ðŸš€ ~  ~ currentAccount:",t),n(t.address,E))))};d.useEffect(()=>{t!=null&&t.address&&(r==null?void 0:r.length)>0?b(r):(b([]),p([]))},[r,t==null?void 0:t.address]);const M=E=>{L(E)},{windowWidth:y,isApp:S}=ne(),{refreshCoinMarketPrice:w}=Ot(),[H,B]=d.useState(0);return cs({interval:1e3,callback:()=>{B(H+1),H>=20&&(B(0),w(),t!=null&&t.address&&l(),v(!1))}}),e.jsxs(P,{mt:y&&y<1024?"28px":"42px",w:"100%",gap:"0px",className:S||i||s?"":"bg_img",children:[e.jsxs(j,{w:"100%",justifyContent:"center",alignItems:"start",gap:"16px",flexDirection:{base:i?"column":"column-reverse",lg:"row"},children:[(s||i)&&e.jsx(j,{gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:i?e.jsx(os,{baseToken:a,quoteToken:o}):e.jsxs(P,{w:"100%",children:[e.jsx(ct,{tabList:O,currTab:f,myOrderList:g,handleChangeTab:M,handleGetOrderList:v}),f.label==="Open Orders"&&e.jsx(at,{}),f.label==="Order History"&&e.jsx(ot,{historyOrderList:c,historyOrderLoading:u})]})}),e.jsx(Cs,{})]}),s&&i&&e.jsxs(P,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(ct,{handleGetOrderList:()=>v(!0),tabList:O,currTab:f,myOrderList:g,handleChangeTab:M}),S&&e.jsx(dt,{h:"16px"}),f.label==="Open Orders"&&(S?e.jsx(at,{}):e.jsx(Os,{})),f.label==="Order History"&&(S?e.jsx(ot,{historyOrderList:c,historyOrderLoading:u}):e.jsx(hs,{historyOrderList:c,historyOrderLoading:u}))]})]})}const ct=({tabList:t,currTab:n,myOrderList:r,handleChangeTab:u,handleGetOrderList:x})=>{const{handleCancelOrder:p,cancelOrderLoading:g}=Ct(),{isApp:h}=ne(),a=n.label==="Open Orders"&&r.length>1;return e.jsxs(j,{w:"100%",justifyContent:"space-between",flexDirection:{base:n.label==="Open Orders"&&r.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(j,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx(ft,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:t,currentTab:n.label,handleChangeTab:u}),h&&e.jsx(rt,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!h||a)&&e.jsxs(j,{gap:"8px",w:{base:"100%",lg:"unset"},children:[a&&e.jsx(I,{onClick:()=>{p(r)},disabled:g,isLoading:g,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"-8px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!h&&e.jsx(rt,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{Si as default};
//# sourceMappingURL=Limit-Bu9HQYcj.js.map

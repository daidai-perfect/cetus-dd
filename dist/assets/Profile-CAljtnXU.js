import{a as d,x as Je,j as e,V as O,F as Ze,a9 as Re,H as _,T as g,C as q,p as ne,q as N,f as $,W as Ie,X as et,Y as tt,Z as st,$ as nt,a0 as ot,aa as De,I as it,N as jt,az as mt,O as bt,Q as wt,aq as Ne,af as yt}from"./vendor-BFGDaAdA.js";import{u as at}from"./global-yjM38D_F.js";import{k as M,C as le,I as W,O as Y,aD as Ct,j as he,a as G,o as re,a1 as _t,e as xe,f as Q,G as te,B as Z,h as lt,r as Xe,d as z,aE as ye,F as vt,Q as rt,M as pe,q as St,V as Tt,c as ct,aj as kt,v as J,n as He,ao as ee,an as ge,Z as Ae,l as ie,aF as Pt,aG as $e,p as we,aH as Lt,aI as At,ai as Ot,aJ as Rt,aK as Dt,aL as Ge,aM as qe}from"./index-BPmJ2jpN.js";import{N as I}from"./NoData-DtiZhmrM.js";import{u as Ht,A as Ft,R as zt}from"./RecentTransactions-C415KciW.js";import{A as Bt}from"./AccountSwitchDrawer-tuBmcAJ6.js";import{a as de,u as Et,e as Fe,i as Vt,f as Ut,c as Mt,j as Wt}from"./VaultsAprBlock-aytfep-B.js";import{a as ae,d as Nt,u as pt,e as Xt,f as $t,g as Gt,c as qt,b as Kt}from"./usePositionList-CTKl_07Q.js";import{a as Qt,b as Yt,P as Jt,u as Zt}from"./PoolItem-ZKtV2SHs.js";import{u as K}from"./activeOrders-z0A42A1h.js";import{P as It,V as es,H as se,u as ts}from"./PositionListLoading-CCL0j2ZU.js";import{C as ss}from"./CoinPairInfo-CQyXMF--.js";import{u as ns}from"./VaultsAction-dGucgqf1.js";import{V as os}from"./VaultsHoldings-BrlDduR7.js";import{H as Ce,T as _e}from"./Table-BDT1sc4z.js";import{u as dt,D as ut,g as is,e as as,f as ls,W as rs,b as cs,R as ps,a as ds,d as us}from"./OverviewOrders-CNU3qeSD.js";import{I as ke}from"./IconText-CUnr4PU4.js";import{u as xs}from"./RangeValue-BqG1z_V1.js";import{H as oe}from"./HTextLabelBox-DQO0ByyL.js";import{P as ve}from"./Pagination-RR4bANG8.js";import{b as gs,u as fe,c as hs,C as fs,P as js,F as ms,E as bs,S as ws,O as ys,a as Cs}from"./useGetLimitOrderHistory-B2Bf7H6d.js";import{u as _s}from"./useRpcListener-BOXfllsv.js";import{R as vs}from"./RefreshButton-BOgQecBu.js";import{u as Ss}from"./useAccountBalance-WZgcKaPa.js";import{u as xt}from"./useToken-C2f3q8yb.js";import{f as ze,a as Ts,b as ks,u as Ps,X as Ls,c as As,C as Os,e as Rs,d as Ds,g as Hs}from"./useXCetus-Cb_zK_f4.js";import{S as gt}from"./SingleTokenInfo-CgvLp_Sh.js";import{S as Fs}from"./SortDropBlock-Czpq_VhW.js";import{T as Pe}from"./TableSortTh-D7suxDeZ.js";import{u as zs}from"./useTokenBalance-WptRK2XT.js";import{X as Bs,a as Es,b as Vs,c as Us}from"./useXCetusHelper-CTsvwzQJ.js";import"./CopyButton-RUcrU_X2.js";import"./Drawer-Dz9Aj4rR.js";import"./useGetPoolList-CUJyOk7M.js";import"./useWrapPoolData-9pXb8-BW.js";import"./useFavoritePool-BrmOgNO0.js";import"./CheckBox-DuDEoJH1.js";import"./SearchInputBlock-QSbA5ZWH.js";import"./index-B-57vaG1.js";import"./Loading-yKVeoG31.js";import"./TooltipIcon-BDSnzQ8w.js";import"./PositionCurrentPrice-BAm_NRyt.js";import"./contract-helper-JUlx1rqT.js";import"./msafe-oYBkW7LJ.js";import"./useTransaction-BEZ42Yzm.js";import"./useTrack-BDPSDLeN.js";import"./useSigner-BVdami60.js";import"./ExpendItem-fcr3Y3EF.js";import"./PositionStatus-2oFeK-h6.js";import"./useInterval-BQqGpXj5.js";import"./PoweredByHaedal-Bke0Bj0w.js";import"./VTextLabelBox-0gMFiLin.js";import"./useNotifiSubscription-D3iVod4I.js";import"./useNotifiAlerts-CBJqtWYW.js";import"./usePriceImpact-rVH3KIHM.js";import"./index-Bw4SoRb3.js";import"./useSwapHelper-BFNYB1_4.js";import"./TradeConfirmAmountInfo-BT7jk6QL.js";import"./TotalAmount-D8QyRJxy.js";import"./TradeInputGroup-ZleztP1o.js";import"./_getAllKeysIn-Bbl41Vsp.js";import"./RemoveBlock-D2zHbmME.js";import"./DepositRatio-DXaxgIOK.js";import"./FreshProgressV2-DkooO11p.js";import"./ErrorTips-BmkBKBdG.js";import"./index-7mst4o7q.js";import"./usePosAdd-BVvvD-k4.js";import"./index-gLcGr8Aw.js";import"./useFindBestRouting-C0FiqahY.js";import"./useVaultsHoldings-GXUfc-lR.js";import"./usePreviousValue-DoVr3Y3V.js";import"./HighlightText-fkyigc44.js";import"./index-D1m9ooSc.js";import"./debounce-B8kzHASh.js";import"./index-BLCSsYSf.js";function Ms(t=100){const i=d.useRef([]),n=d.useRef(!1),o=d.useRef(void 0),a=d.useCallback(async()=>{if(!n.current){for(n.current=!0;i.current.length>0;){const l=i.current.shift();if(!l)continue;const{id:c,run:u,onStart:x,onSuccess:p,onError:f}=l;if(l._cancelled){console.log(`[task:${l.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),x==null||x(c);const w=await u(o.current,c);o.current=w,console.log(`[task:${c}] success`,w),p==null||p(w,c)}catch(w){console.error(`[task:${c}] failed`,w),f==null||f(w,c)}await new Promise(w=>setTimeout(w,t))}n.current=!1}},[t]),r=l=>{i.current.push(l),a()},s=l=>{const c=i.current.find(u=>u.id===l);c&&(c._cancelled=!0),i.current=i.current.filter(u=>u.id!==l)};return d.useEffect(()=>()=>{i.current=[],n.current=!1,o.current=void 0},[]),{addTask:r,removeTask:s}}const ht=(t,i)=>i?t:"********";function Ws({totalValue:t,onRefreshTask:i,isLoading:n,children:o}){const[a,r]=d.useState(!1),{currentAccount:s,onWalletModal:l,accounts:c,accountServiceNameObj:u}=M(),{isShowProfileAssets:x,setIsShowProfileAssets:p}=at();d.useEffect(()=>{r(!0)},[]);const{isOpen:f,onClose:w,onToggle:b}=Je(),{getServiceNames:k}=Ht(),D=d.useCallback(()=>{f||k(c),b(),console.log("AccountSwitch###handleClick###isOpen: ",f)},[f,c]);return console.log(s,u,c,"currentAccount-H5Main"),e.jsxs(O,{w:"100%",mt:"28px",children:[a?s!=null&&s.address?e.jsxs(O,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(_,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(_,{h:"18px",children:[e.jsx(g,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(le,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:x?"Hide Value":"Show Value"}),children:e.jsx(q,{children:e.jsx(W,{xlinkHref:x?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>p(!x)})})})]}),e.jsxs(_,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(g,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(W,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(ne,{isLoaded:!n,h:"32px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Y(t,2),x)})}),c.length>1&&e.jsxs(_,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:D,cursor:"pointer",children:[e.jsxs(_,{children:[e.jsx(W,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(g,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[s!=null&&s.label?`${s==null?void 0:s.label} : `:"",(u==null?void 0:u[s==null?void 0:s.address])||Ct(s==null?void 0:s.address)]})]}),e.jsx(W,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),o]}):e.jsx(I,{type:"nowallet",mt:"20px",onboard:()=>l(!0)}):e.jsx(Ze,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Re,{})}),e.jsx(Bt,{isOpen:f,onClose:w})]})}function Be(t){const{type:i,children:n,wrapStyle:o={h:"60px"},textStyle:a={fontSize:"16px"}}=t,r=(s,l)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(s,l):s===l.value;return e.jsxs(_,{justify:"space-between",w:"100%",h:"60px",...o,children:["title"in t?e.jsx(g,{color:"text_caption",...a,children:t==null?void 0:t.title}):e.jsx(he,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(s,l)=>r(s,l),wrapStyle:{h:"60px",border:"none",gap:"38px",...o},itemStyle:a}),n]})}function Ns({showPosListGroupByPool:t=[]}){var r;const{currentAccount:i,onWalletModal:n}=M(),{posBaseListLoading:o}=ae(),{isAutoRefresh:a}=K();return e.jsxs(O,{w:"100%",children:[e.jsx(Qt,{isProfile:!0}),i!=null&&i.address?!a&&o?[{},{},{},{}].map((s,l)=>e.jsx(It,{},l)):((r=Object.values(t))==null?void 0:r.length)>0?Object.values(t).map((s,l)=>e.jsx(Yt,{poolInfo:s,isProfile:!0},l)):e.jsx(I,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(I,{type:"nowallet",onboard:()=>n(!0),noBorder:!0})]})}function Xs({poolInfo:t}){console.log("ðŸš€ ~ VaultsTableAction ~ poolInfo:",t);const[i,n]=d.useState("Deposit"),[o,a]=d.useState(!1),{clearVaultsActionData:r}=ns();return d.useEffect(()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ ActionsBlock.tsx:22 ~ useEffect ~ clearVaultsActionData:"),r()},[o]),e.jsxs(e.Fragment,{children:[e.jsxs(_,{justify:"flex-end",children:[e.jsx(N,{onClick:()=>{n("Deposit"),a(!0)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Deposit"}),e.jsx(N,{onClick:()=>{n("Withdraw"),a(!0)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Withdraw"})]}),o&&e.jsx(es,{isOpen:o,setIsOpen:a,displayTokenA:t.displayTokenA,displayTokenB:t.displayTokenB,feeDisplay:t.feeDisplay,clmmPool:t.clmmPoolAddress,category:t.category,vaultId:t.vaultId,isReverse:t.isReverse,currentTab:i},t.vaultId)]})}function $s({selectCoinList:t=[]}){const{vaultsPositionObj:i}=de(),{vaultPageList:n,vaultListLoading:o,setVaultListLoading:a}=Et(),{filterVaultList:r,getCurrentTabNum:s}=Fe(),l=d.useMemo(()=>n,[n]);console.log("ðŸš€ ~ ProfileVaults ~ pageList:",o,(l==null?void 0:l.length)===0,l);const{isAutoRefresh:c,autoRefreshCount:u}=K(),{isApp:x}=G(),p=!0,f={sortRule:"desc",sortType:"tvl"},w=d.useMemo(()=>[{label:"All Vault",value:"all",num:s({sortOptions:f,currentTab:"all",isYourHoldings:p,selectCoinList:t})||""},{label:"Cetus",value:"cetus",num:s({sortOptions:f,currentTab:"cetus",isYourHoldings:p,selectCoinList:t})||""},{label:"Haedal",value:"haedal",num:s({sortOptions:f,currentTab:"haedal",isYourHoldings:p,selectCoinList:t})||""}],[JSON.stringify(l),p,JSON.stringify(t)]),[b,k]=d.useState("all"),{getTokenAmountValue:D}=re(),B=Gs({isShowPowered:b!=="Haedal",vaultsPositionObj:i,getTokenAmountValue:D}),j=h=>{b===h||o||(k(h),r({sortOptions:f,currentTab:h,isYourHoldings:p,selectCoinList:t}),a(!0),setTimeout(()=>{a(!1)},200))};return d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ vaultsPositionObj:",i),_t(i)&&r({sortOptions:f,currentTab:b,isYourHoldings:p,selectCoinList:t})},[i,t]),e.jsxs(O,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",children:[e.jsx(he,{type:"outlineTab",tabList:w,currentTab:b,handleChangeTab:h=>j(h==null?void 0:h.value),isActive:(h,v)=>h===v.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),e.jsx(O,{w:"100%",position:"relative",gap:"20px",children:(c||!o)&&(l==null?void 0:l.length)===0?e.jsx(I,{type:"nodata",text:"No vaults found",noBorder:!0}):x?e.jsx(O,{w:"100%",gap:"4px",children:e.jsx(Ce,{rowKey:"lpTokenType",columns:B,dataSource:l,loading:!c&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(_e,{rowKey:"lpTokenType",columns:B,dataSource:l,loading:!c&&o,rowStyle:{h:"80px",cursor:"pointer"}})})]})}const Gs=({isShowPowered:t,vaultsPositionObj:i,getTokenAmountValue:n})=>[{title:e.jsx(g,{children:"Pools"}),thConfig:{pl:"0px !important"},render:o=>e.jsx(ss,{poolInfo:{...o,poolAddress:o==null?void 0:o.vaultId},isShowPowered:t,symbolFontSize:"15px"})},{title:e.jsx(g,{textAlign:"right",children:"Your Holdings"}),render:o=>{var l,c,u,x;const a=i[o==null?void 0:o.vaultId]||{},r=n((l=o==null?void 0:o.displayTokenA)==null?void 0:l.coin_type,a==null?void 0:a.displayAmountA,"--"),s=n((c=o==null?void 0:o.displayTokenB)==null?void 0:c.coin_type,a==null?void 0:a.displayAmountB,"--");return e.jsx(le,{placement:"top",tooltip:e.jsxs(O,{gap:"8px",align:"flex-start",minW:"200px",children:[e.jsxs(_,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(_,{children:[e.jsx(xe,{imageUrl:o.displayTokenA.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(g,{color:"text_caption",fontSize:"12px",children:(u=o==null?void 0:o.displayTokenA)==null?void 0:u.symbol})]}),e.jsx(se,{children:e.jsxs(O,{align:"flex-end",children:[e.jsx(g,{color:"text_caption",fontSize:"12px",children:Q(a==null?void 0:a.displayAmountA)}),e.jsx(g,{fontSize:"12px",children:r=="--"?"$--":Y(r,2)})]})})]}),e.jsx($,{w:"100%",height:"1px",bg:"border"}),e.jsxs(_,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(_,{children:[e.jsx(xe,{imageUrl:o.displayTokenB.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(g,{color:"text_caption",fontSize:"12px",children:(x=o==null?void 0:o.displayTokenB)==null?void 0:x.symbol})]}),e.jsx(se,{children:e.jsxs(O,{align:"flex-end",children:[e.jsx(g,{color:"text_caption",fontSize:"12px",children:Q(a==null?void 0:a.displayAmountB)}),e.jsx(g,{fontSize:"12px",children:s=="--"?"$--":Y(s,2)})]})})]})]}),children:e.jsx(q,{as:"button",ml:"4px",children:e.jsx(se,{children:e.jsxs(_,{justifyContent:"flex-end",gap:"0",children:[e.jsx(g,{color:"text_caption",mr:"2px",textDecoration:"underline dotted",textUnderlineOffset:"3px",children:`${(a==null?void 0:a.balanceDisplay)||"0"} LP`}),e.jsx(g,{children:"("}),e.jsx(os,{color:"text_paragraph",vaultId:o.vaultId,category:o.category}),e.jsx(g,{children:")"})]})})})})}},{title:e.jsx(g,{textAlign:"right",children:"Share of Pool"}),render:o=>{const a=i[o==null?void 0:o.vaultId]||{};return console.log("ðŸš€ ~ vaultsPositionObj:",i,a),e.jsx(_,{justify:"flex-end",children:e.jsx(se,{children:e.jsxs(g,{color:"text_caption",children:[" ",a==null?void 0:a.shartOfPoolDisplay]})})})}},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),render:o=>e.jsx(Xs,{poolInfo:o})}];function qs(){const{currentAccount:t}=M(),{vaultsPositionObj:i}=de(),{showPosListLength:n,posBaseListLoading:o,setShowPosListLength:a,posBaseListGroupByPool:r}=ae(),{getCurrentTabNum:s}=Fe(),[l,c]=d.useState([]),u=j=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",j),c(h=>[...h,j])},x=j=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",j),c(h=>h.filter(v=>(v==null?void 0:v.coin_type)!==(j==null?void 0:j.coin_type)))};d.useEffect(()=>{t!=null&&t.address||a("")},[t==null?void 0:t.address]),d.useEffect(()=>()=>{a("")},[]);const[p,f]=d.useState("positions"),w={sortRule:"desc",sortType:"tvl"},b=!0,k=d.useMemo(()=>{const j=p=="positions"?[]:l;return[{label:"Positions",value:"positions",num:o?"":Number(n)},{label:"Vaults",value:"vaults",num:s({sortOptions:w,currentTab:"all",isYourHoldings:b,selectCoinList:j})||""}]},[o,n,l,i]),[D,B]=d.useState([]);return d.useEffect(()=>{var T,R,y,L;const j=p=="vaults"?[]:l,h=(T=j[0])!=null&&T.coin_type?te((R=j[0])==null?void 0:R.coin_type):void 0,v=(y=j[1])!=null&&y.coin_type?te((L=j[1])==null?void 0:L.coin_type):void 0,A=Object.values(r).filter(P=>h&&v?te(P.tokenA.coin_type)==h&&te(P.tokenB.coin_type)==v||te(P.tokenA.coin_type)==v&&te(P.tokenB.coin_type)==h:h?te(P.tokenA.coin_type)==h||te(P.tokenB.coin_type)==h:P);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(r),A),B(A);const S=A.reduce((P,C)=>P+(C.list?C.list.length:0),0);t!=null&&t.address&&a(S.toString())},[l,r]),e.jsx(Z,{p:"0 16px 16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(O,{gap:"16px",w:"100%",children:[e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(Be,{type:"tab",currentTab:p,tabs:k,onTabChange:j=>{c([]),f(j.value)},textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(Jt,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:l,onClickSelectCoinList:u,onDeleteSelectCoinList:x})]}),e.jsx($,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),p==="positions"&&e.jsx(Ns,{showPosListGroupByPool:D}),p==="vaults"&&e.jsx($s,{selectCoinList:l})]})})}function Ks({orderInfo:t,isActiveOrder:i,pageDirect:n}){const{inCoin:o,outCoin:a}=t,{orderHistoryList:r,handleGetDcaOrderHistory:s,orderHistoryListLoading:l}=dt();d.useEffect(()=>{t!=null&&t.orderID&&s(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=lt(),[u,x]=d.useState(n),p=142,f=(r==null?void 0:r.length)||0,w=(r==null?void 0:r.length)<=1?`${p*f+8}px`:`${p*f+(f-1)*32+8}px`;return e.jsxs(O,{pb:"16px",align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(r==null?void 0:r.length)>=3?"460px":"unset",overflowY:"auto",children:[!l&&e.jsx($,{h:w,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),l?e.jsx(_,{h:"100px",w:"100%",justify:"center",children:e.jsx(Re,{})}):(r==null?void 0:r.length)===0?e.jsx(I,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):r.map(b=>{const k=Xe(b.inAmount,o==null?void 0:o.decimals),D=Xe(b.outAmount,a==null?void 0:a.decimals),B=z(k).div(D).toString(),j=z(1).div(B).toString();return e.jsxs(O,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(_,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(g,{h:"20px",lineHeight:"20px",children:[ye((b==null?void 0:b.time)*1e3)," (UTC)"]}),e.jsx(W,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(b==null?void 0:b.tx,"tx"))}}),e.jsx(_,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx($,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(Z,{p:"16px",borderRadius:"12px",children:e.jsxs(O,{align:"flex-start",gap:"20px",children:[e.jsxs(O,{gap:"0px",align:"flex-start",children:[e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:u?`${Q(B)} `:`${Q(j)} `}),e.jsxs(_,{children:[e.jsxs(g,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",u?` ${o.symbol} per ${a.symbol}`:` ${a.symbol} per ${o.symbol}`,")"]}),e.jsx(W,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>x(!u)})]})]}),e.jsxs(_,{w:"100%",gap:"4px",children:[e.jsx(xe,{imageUrl:o==null?void 0:o.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Q(k)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${o.symbol}`}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(xe,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Q(D)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${a.symbol}`})]})]})})]},b==null?void 0:b.tx)})]})}function Qs({orderInfo:t,isActiveOrder:i,pageDirect:n,isClaimLoading:o=!1,toClaim:a}){const{inCoin:r,outCoin:s}=t;return e.jsxs(O,{pb:"16px",children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&i&&e.jsx(Ys,{}),e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(ut,{orderInfo:t}),i&&a&&e.jsx(N,{isLoading:o,onClick:()=>a(t),disabled:(t==null?void 0:t.outBalance)<=0||o,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(g,{fontSize:"16px",color:"text_caption",children:is(t,i,!0)}),e.jsx(g,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(_,{w:"100%",justify:"space-around",children:[e.jsxs(O,{children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:as(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",r==null?void 0:r.symbol," Balance"]})]}),e.jsx($,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(O,{children:[e.jsx(g,{color:"text_caption",fontSize:"16px",children:ls(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",s==null?void 0:s.symbol," Balance "]})]})]}),e.jsxs(O,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(oe,{label:"Invest Every",value:t==null?void 0:t.investEvery}),z(t==null?void 0:t.ofOrderLeft).gt("0")&&e.jsx(oe,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(oe,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${r==null?void 0:r.symbol}`}),i&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(oe,{label:"Current Avg. Price",value:n?`${t==null?void 0:t.currentAvgPrice} ${r==null?void 0:r.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${r==null?void 0:r.symbol}`}),!i&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(oe,{label:"Avg. Price",value:n?`${t==null?void 0:t.currentAvgPrice} ${r==null?void 0:r.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${r==null?void 0:r.symbol}`}),i&&e.jsx(oe,{label:"Next Order (UTC)",value:ye(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(oe,{label:"Created (UTC)",value:ye(t==null?void 0:t.createAt)||""})]})]})}const Ys=()=>{const[t,i]=d.useState(!1);return e.jsxs(O,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(_,{align:"center",w:"100%",cursor:"pointer",onClick:()=>i(!t),children:[e.jsx(g,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(W,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(O,{align:"flex-start",w:"100%",children:[e.jsx($,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(rs,{})]})]})};function Js({isOpen:t,onClose:i,orderInfo:n,isActiveOrder:o,isClaimLoading:a=!1,toClaim:r}){const{isApp:s}=G(),l=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,u]=d.useState("overview"),{inCoin:x,outCoin:p}=n,[f,w]=d.useState(!1),{getTokenRank:b}=xs();return d.useEffect(()=>{const k=b(x,p);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",p,x,k),w(!k)},[x==null?void 0:x.coin_type,p==null?void 0:p.coin_type]),e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{minWidth:s?"300px":"482px",children:[e.jsx(st,{children:e.jsx($,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Be,{type:"tab",currentTab:c,tabs:l,onTabChange:k=>u(k.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"0 16px 0px",textAlign:"center",children:[c=="overview"&&e.jsx(Qs,{orderInfo:n,isActiveOrder:o,pageDirect:f,isClaimLoading:a,toClaim:r}),c=="orders"&&e.jsx(Ks,{orderInfo:n,isActiveOrder:o,pageDirect:f})]})]})]})}function Zs({orderInfo:t,isActiveOrder:i=!0}){const{isApp:n}=G(),[o,a]=d.useState(!1),{getExplorerUrl:r}=lt(),{isClaimLoading:s,toClaim:l,closeOrderAction:c,isCloseLoading:u}=dt();return e.jsxs(e.Fragment,{children:[i&&e.jsxs(_,{justify:"flex-end",children:[e.jsx(N,{isLoading:s,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||s,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(le,{placement:"bottom-end",tooltip:e.jsxs(O,{align:"flex-start",children:[e.jsx(ke,{text:"View Details",onClick:()=>{a(!0)}}),e.jsx(ke,{text:"View on Explorer",onClick:()=>{window.open(r(t.orderID,"poolAddress"))}}),e.jsx(ke,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:u?()=>{}:()=>{c(t)}})]}),children:e.jsx(q,{children:e.jsx(N,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(W,{svgFill:n?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!i&&e.jsxs(_,{justify:"flex-end",children:[e.jsx(N,{onClick:()=>{a(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(N,{onClick:x=>{vt(x),window.open(r(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(W,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),o&&e.jsx(Js,{isOpen:o,onClose:()=>a(!1),orderInfo:t,isActiveOrder:i,isClaimLoading:s,toClaim:l})]})}function Is(){const{isAutoRefresh:t,dcaOrderListLoading:i,dcaActiveOrderList:n,dcaPastOrderList:o}=K(),[a,r]=d.useState("activeDCAs"),s=d.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&i?"":n==null?void 0:n.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&i?"":o==null?void 0:o.length}],[i,o,n]),l=d.useMemo(()=>a=="activeDCAs"?n:o,[a,n,o]),{isApp:c}=G(),{closeAll:u,claimAll:x,isClaimAllLoading:p,isCloseAllLoading:f}=cs(),w=d.useMemo(()=>a==="pastDCAs"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((S,T)=>z(S).plus(T==null?void 0:T.outBalance),z(0)).toString(),[a,l]),[b,k]=d.useState([]),[D,B]=d.useState(0),[j,h]=d.useState(1),v=10,A=Ke(a=="activeDCAs");return d.useEffect(()=>{if((l==null?void 0:l.length)>0){const S=(j-1)*v;(l==null?void 0:l.length)<=S&&h(1)}},[l]),d.useEffect(()=>{if((l==null?void 0:l.length)>0){B(l==null?void 0:l.length);const S=(j-1)*v,T=S+v;console.log("ðŸš€ ~ useEffect ~ start:",j,l.slice(0,T),S,T),(l==null?void 0:l.length)>S&&k(l.slice(S,T))}},[j,l]),e.jsxs(O,{w:"100%",gap:"12px",children:[e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(he,{type:"outlineTab",tabList:s,currentTab:a,handleChangeTab:S=>r(S==null?void 0:S.value),isActive:(S,T)=>S===T.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(l==null?void 0:l.length)>1&&a=="activeDCAs"&&e.jsxs(_,{children:[e.jsx(N,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:p,disabled:Number(w)===0||p,onClick:()=>{x(l)},children:"Claim All"}),e.jsx(N,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:f,disabled:(l==null?void 0:l.length)==0||f,onClick:()=>{u(l)},children:"Close All"})]})]}),e.jsxs(O,{w:"100%",position:"relative",gap:"20px",children:[(t||!i)&&(l==null?void 0:l.length)===0?e.jsx(I,{type:"nodata",text:a==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(O,{w:"100%",gap:"4px",children:e.jsx(Ce,{rowKey:"orderID",columns:A,dataSource:b,loading:!t&&i,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(_e,{rowKey:"orderID",columns:Ke(a=="activeDCAs"),dataSource:b,loading:!t&&i,rowStyle:{h:"80px",cursor:"pointer"}}),(l==null?void 0:l.length)>v&&e.jsx(q,{children:e.jsx(ve,{total:D,size:v,currentPage:j,onChange:S=>{h(S)}})})]})]})}const Ke=t=>[{title:e.jsx(g,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:n=>e.jsx(ut,{orderInfo:n})},{title:e.jsx(g,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:n=>e.jsx(ps,{orderInfo:n,isProfile:!0,isRank:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:n=>e.jsx(ds,{orderInfo:n,isProfile:!0})},t&&{title:e.jsx(g,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:n})=>e.jsx(g,{color:"text_caption",children:ye(n)})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:n=>e.jsx(Zs,{orderInfo:n,isActiveOrder:t})}].filter(Boolean);function en(){const{currentAccount:t}=M(),{getLimitOrderHistory:i,historyOrderList:n,historyOrderLoading:o}=gs(),{myOrderList:a,orderListLoading:r}=fe(),{isAutoRefresh:s,autoRefreshCount:l}=K(),[c,u]=d.useState("openOrders"),x=d.useMemo(()=>c=="openOrders"?r:o,[c,r,o]),p=d.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",a,n),c=="openOrders"?a:n),[c,a,n]),f=d.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:(s||!x)&&(a==null?void 0:a.length)===0?0:!s&&r?"":a==null?void 0:a.length},{label:"Orders History",value:"ordersHistory",num:(s||!x)&&(n==null?void 0:n.length)===0?0:!s&&o?"":n==null?void 0:n.length}],[r,o,a,n]),w=y=>{t!=null&&t.address&&i(t.address,y)};d.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",l),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),l>0&&w(!0)},[l]),d.useEffect(()=>{w(!1)},[c,t]),_s({onRpcChange:()=>{w(!0)}});const{isApp:b}=G(),{handleCancelOrder:k,cancelOrderLoading:D}=hs(),[B,j]=d.useState([]),[h,v]=d.useState(0),[A,S]=d.useState(1),T=10,R=tn(c=="openOrders");return d.useEffect(()=>{if((p==null?void 0:p.length)>0){const y=(A-1)*T;(p==null?void 0:p.length)<=y&&S(1)}},[p]),d.useEffect(()=>{if((p==null?void 0:p.length)>0){v(p==null?void 0:p.length);const y=(A-1)*T,L=y+T;console.log("ðŸš€ ~ useEffect ~ start:",A,p.slice(0,L),y,L),(p==null?void 0:p.length)>y&&j(p.slice(y,L))}},[A,p]),e.jsxs(O,{w:"100%",gap:"12px",children:[e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(he,{type:"outlineTab",tabList:f,currentTab:c,handleChangeTab:y=>u(y==null?void 0:y.value),isActive:(y,L)=>y===L.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(p==null?void 0:p.length)>1&&c=="openOrders"&&e.jsx(_,{children:e.jsx(N,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:D,onClick:()=>{k(a)},children:"Cancel All"})})]}),e.jsxs(O,{w:"100%",position:"relative",gap:"20px",children:[(s||!x)&&(p==null?void 0:p.length)===0?e.jsx(I,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):b?e.jsx(O,{w:"100%",gap:"4px",children:e.jsx(Ce,{rowKey:"order_id",columns:R,dataSource:B,loading:!s&&x,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(_e,{rowKey:"order_id",columns:R,dataSource:B,loading:!s&&x,rowStyle:{h:"80px",cursor:"pointer"}}),(p==null?void 0:p.length)>T&&e.jsx(q,{children:e.jsx(ve,{total:h,size:T,currentPage:A,onChange:y=>{S(y)}})})]})]})}const tn=t=>[{title:e.jsx(g,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:n=>e.jsx(fs,{imgSize:"28px",info:n,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:n=>e.jsx(js,{info:n,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:n=>e.jsx(ms,{info:n,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:n=>e.jsx(bs,{info:n,isProfile:!0})},!t&&{title:e.jsx(g,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:n=>e.jsx(ws,{historyInfo:n,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:n=>e.jsx(ys,{orderInfo:n,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function sn(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[i,n]=d.useState("limitOrders");return e.jsx(Z,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(O,{align:"flex-start",gap:"20px",children:[e.jsx($,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Be,{type:"tab",currentTab:i,tabs:t,onTabChange:o=>n(o.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),i==="limitOrders"&&e.jsx(en,{}),i==="dca"&&e.jsx(Is,{})]})})}function nn({handleRefresh:t,totalValue:i,isLoading:n}){const{isApp:o}=G(),{currentAccount:a,accounts:r}=M(),{isShowProfileAssets:s,setIsShowProfileAssets:l}=at(),[c,u]=d.useState(!1),{onClose:x}=Je();return e.jsxs(O,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsxs(_,{gap:"4px",children:[e.jsx(g,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(le,{showTooltip:!o,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:s?"Hide Value":"Show Value"}),children:e.jsx(q,{children:e.jsx(W,{xlinkHref:s?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>l(!s)})})})]}),e.jsxs(_,{children:[e.jsxs(_,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{u(!0)},children:[e.jsx(W,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(g,{children:"Transactions"})]}),e.jsx(vs,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),e.jsx(_,{w:"100%",justify:"space-between",mt:"2px",children:e.jsx(ne,{isLoaded:!n,h:"22px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Y(i,2),s)})})}),r.length>1&&e.jsx(Ft,{currentAccount:a,accounts:r,onClose:x,isProfile:!0}),c&&e.jsx(zt,{isOpen:c,onClose:()=>u(!1)})]})}function on({tabList:t,tabData:i,onClickTab:n}){return e.jsx(O,{w:"100%",children:t==null?void 0:t.map(o=>e.jsx(an,{imgUrl:o.activeImgUrl,value:i[o.value].totalValue,title:o.title,url:o.route,tooltip:o==null?void 0:o.tooltip,onClick:()=>n(o.value),isLoading:i[o.value].isLoading},o.title))})}const an=({imgUrl:t,value:i,title:n,url:o,tooltip:a,isLoading:r,onClick:s})=>(De(),e.jsxs(_,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:s,children:[e.jsxs(_,{gap:"12px",children:[e.jsx(it,{w:"36px",h:"36px",src:t}),e.jsxs(O,{gap:"2px",align:"flex-start",children:[e.jsx(ne,{h:"24px",isLoaded:!r,children:e.jsx(g,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:i})}),e.jsxs(_,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",h:"15px",lineHeight:"15px",children:n}),a&&e.jsx(le,{tooltip:a,children:e.jsx($,{children:e.jsx(W,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(q,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(W,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function ln({tabList:t,activeTab:i,tabData:n,onClickTab:o}){return e.jsx(_,{w:"100%",mt:"12px",gap:"12px",children:t.map(a=>{var r,s;return e.jsxs(Z,{w:"25%",p:"28px 16px",bgImage:i===a.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:i===a.value?"primary":"border",onClick:()=>o(a.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(O,{align:"flex-start",gap:"10px",children:[e.jsx(g,{fontSize:"14px",color:"text_caption",children:a.title}),e.jsx(_,{h:"22px",children:e.jsx(se,{size:"l",children:e.jsx(le,{placement:"top",tooltip:e.jsx(g,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:a.tooltip}),showTooltip:a.showTooltip,children:e.jsx(q,{as:"button",children:e.jsx(ne,{isLoaded:!((r=n[a.value])!=null&&r.isLoading),children:e.jsx(g,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(s=n[a.value])==null?void 0:s.totalValue})})})})})})]}),e.jsx(it,{w:"38px",h:"38px",src:a.activeImgUrl,opacity:i===a.value?"0.8":"0.4"})]},a.value)})})}function Qe(t){const{isApp:i}=G();return i?e.jsx(on,{...t}):e.jsx(ln,{...t})}const rn=(t,i)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:n=>t({isCoinHoldingLoading:n}),setCoinHoldingList:n=>t({coinHoldingList:n}),isCoinPriceLoading:!0,setIsCoinPriceLoading:n=>t({isCoinPriceLoading:n}),holdingsTotalUsd:"0",setHoldingsTotalUsd:n=>t({holdingsTotalUsd:n}),unknownCoinCount:0,setUnknownCoinCount:n=>t({unknownCoinCount:n})}),Se=rt(rn);function ft(){const{currentAccount:t}=M(),{fetchAccountBalance:i}=Ss(),{coinHoldingList:n,setCoinHoldingList:o,setIsCoinHoldingLoading:a,setIsCoinPriceLoading:r,setHoldingsTotalUsd:s,isCoinPriceLoading:l,setUnknownCoinCount:c}=Se(),{getTokenListInfo:u}=xt(),{getTokenPrice:x}=re(),{refreshCoinPriceInfo:p}=ze(),f=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{f.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const w=async()=>{const j=f.current;if(j){a(!0);const h=await i(j,!0);if(h){const v=await u(h.filter(T=>z(T.totalBalance).gt(0)).map(T=>T.coinType));if(!v)throw a(!1),o([]),new Error("get token list info error");const A=[];let S=0;return h.forEach(T=>{const R=v.get(T.coinType);if(R){const y=T.totalBalance,L=pe(y,R.decimals).toString(),P=Q(L,void 0,void 0,St.ROUND_DOWN).toString(),C={balance:y,balance_format:L,balance_display:P,balance_usd:void 0,coin:R,coin_type:R==null?void 0:R.coin_type,price:"",price_diff_24:""};A.push(C),R.is_verified||S++}}),k(A),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",j),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",f.current),j===f.current&&(o(A),c(S),b([...A])),a(!1),A}}else a(!1),o([]);return[]},b=async j=>{r(!0);try{await p(j.filter(h=>h.coin.is_verified).map(h=>h.coin.coin_type),!0)}catch(h){console.error("fetch coin price info error",h)}finally{r(!1)}},k=j=>{j.map(h=>{const{coin:v}=h;if(v.is_verified){const A=x(v.coin_type);A&&(h.price=A.price,h.price_diff_24=A.price_change||"",h.balance_usd=z(h.balance_format).mul(A.price).toString())}})},D=async j=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:j,coinHoldingList:n,currentAccount:t}),t){const{search:h,current_sort:v,current_sort_order:A,is_show_unknown:S=!1,is_hide_small_balance:T=!0}=j;let R=[];if(S?R.push(...n):R=n.filter(y=>y.coin.is_verified),h){const y=h.toLowerCase();R=R.filter(L=>L.coin.coin_type.toLowerCase().includes(y)||L.coin.symbol.toLowerCase().includes(y)||L.coin.name.toLowerCase().includes(y))}return k(R),T&&!l&&(R=R.filter(y=>y.balance_usd===void 0||z(y.balance_usd).gt(.01))),R.sort((y,L)=>{if(v==="balance"){const P=z(y.balance_format).cmp(z(L.balance_format));if(P!==0)return A==="desc"?-P:P}if(v==="value"){const P=z(y.balance_usd).cmp(z(L.balance_usd));return P!==0?A==="desc"?-P:P:z(L.balance_format).cmp(z(y.balance_format))}if(v==="price"){const P=z(y.price||"0").cmp(z(L.price||"0"));return P!==0?A==="desc"?-P:P:z(L.balance_format).cmp(z(y.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",R),R}return[]};return d.useEffect(()=>{k(n);const j=n.reduce((h,v)=>h+Number(v.balance_usd||0),0);s(j.toString())},[n,l]),{getFilterCoinHoldingList:D,fetchCoinHoldingList:w,resetUserData:()=>{o([]),s("0"),c(0)}}}function cn({inputValue:t,changeInputValue:i}){const n=d.useRef(null),[o,a]=d.useState(!1);return G(),e.jsxs(jt,{w:o?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(mt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(W,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:r=>{var s;(s=n.current)==null||s.focus(),a(!0)}})}),e.jsx(bt,{bg:"background",ref:n,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:r=>{i(r.target.value)},onFocus:()=>{a(!0)},onBlur:()=>{i(""),a(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:o?"28px":"8px",pl:o?"28px":"8px"}),t?e.jsx(wt,{right:"5px",children:e.jsx(W,{xlinkHref:"#icon-icon_close",onMouseDown:r=>r.preventDefault(),onClick:r=>{i(""),setTimeout(()=>{var s;(s=n.current)==null||s.focus()},0)}})}):null]})}function pn({inputValue:t,changeInputValue:i,isShowUnknownCoin:n,handleIsShowUnknownCoin:o,isHideLowAsset:a,handleIsHideLowAsset:r,unknownCoinCount:s}){return G(),e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(_,{children:[e.jsx(cn,{inputValue:t,changeInputValue:i}),e.jsx(Z,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(_,{h:"100%",justify:"space-between",children:[e.jsxs(g,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",s,")"]}),e.jsx(Ne,{isChecked:n,onChange:o})]})}),e.jsx(Z,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(_,{h:"100%",justify:"space-between",children:[e.jsx(g,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Ne,{isChecked:a,onChange:r})]})})]})]})}function dn(){const{isApp:t}=G(),{getFilterCoinHoldingList:i}=ft(),{isCoinHoldingLoading:n,isCoinPriceLoading:o,unknownCoinCount:a}=Se(),{isAutoRefresh:r}=K(),[s,l]=d.useState([]),[c,u]=d.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[x,p]=d.useState(!1),[f,w]=d.useState(!0),[b,k]=d.useState("desc"),[D,B]=d.useState(Oe[2]),j=m=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",m),r||C(1),u(m),i(m).then(l)},h=m=>{j({...c,search:m})},v=m=>{const E=(m==null?void 0:m.value)===(D==null?void 0:D.value),X=t||!E?"desc":b==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",X,m),B(m),k(X),j({...c,current_sort:m.value,current_sort_order:X})};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",n,o,s),!n&&!o&&j(c)},[n,o]);const A=De(),S=m=>{A(`/swap/${m}/''`)},[T,R]=d.useState([]),[y,L]=d.useState(0),[P,C]=d.useState(1),V=10;d.useEffect(()=>{if((s==null?void 0:s.length)>0){const m=(P-1)*V;(s==null?void 0:s.length)<=m&&C(1)}},[s]),d.useEffect(()=>{if((s==null?void 0:s.length)>0){L(s==null?void 0:s.length);const m=(P-1)*V,E=m+V;console.log("ðŸš€ ~ useEffect ~ start:",P,s.slice(0,E),m,E),(s==null?void 0:s.length)>m&&R(s.slice(m,E))}else R([])},[P,s]);const U=(m,E)=>{m==="is_show_unknown"&&p(E),m==="is_hide_small_balance"&&w(E)},F=m=>{U("is_show_unknown",m.target.checked),m.target.checked||j({...c,is_show_unknown:!1}),m.target.checked&&!x&&(U("is_hide_small_balance",!1),j({...c,is_show_unknown:!0,is_hide_small_balance:!1}))},H=m=>{U("is_hide_small_balance",m.target.checked),j({...c,is_hide_small_balance:m.target.checked})};return e.jsx(Z,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(O,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(pn,{unknownCoinCount:a,inputValue:c.search||"",changeInputValue:h,isShowUnknownCoin:x,handleIsShowUnknownCoin:F,isHideLowAsset:f,handleIsHideLowAsset:H}),e.jsx($,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(O,{w:"100%",position:"relative",gap:"20px",children:[(!n&&!o||r)&&(s==null?void 0:s.length)===0?e.jsx(I,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(O,{w:"100%",gap:"4px",children:[e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Fs,{sortText:"Sort by",minW:"180px",currentSort:D,sortByList:Oe,onSortByChange:v,xlinkHref:b==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>k(m=>m==="desc"?"asc":"desc")})]}),e.jsx(Ce,{rowKey:"coin_type",columns:Ye(b,D,v,S,!r&&o,s==null?void 0:s.length),dataSource:T,loading:!r&&(n||o),itemSkeletonLength:5,itemHeight:"30px",onRowClick:m=>{S(m==null?void 0:m.coin_type)}})]}):e.jsx(_e,{rowKey:"coin_type",columns:Ye(b,D,v,S,!r&&o,s==null?void 0:s.length),dataSource:T,skeletonLength:5,loading:!r&&(n||o),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:m=>{S(m==null?void 0:m.coin_type)}}),(s==null?void 0:s.length)>V&&e.jsx(q,{children:e.jsx(ve,{total:y,size:V,currentPage:P,onChange:m=>{C(m)}})})]})]})})}const Oe=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Le=Object.fromEntries(Oe.map(t=>[t.value,t])),Ye=(t,i,n,o,a,r)=>[{title:e.jsxs(g,{children:["Token(",r,")"]}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:s})=>e.jsx(gt,{haveTooltip:!0,token:s,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(Pe,{labelInfo:Le.balance,sortRule:t,sortBy:i,clickSort:n}),key:"balance",thConfig:{w:"25%"},render:({coin:s,balance_display:l})=>e.jsx(_,{justify:"flex-end",children:e.jsx(se,{children:e.jsxs(g,{color:"text_caption",children:[l," ",Tt(s==null?void 0:s.symbol,10)]})})})},{title:e.jsx(Pe,{labelInfo:Le.price,sortRule:t,sortBy:i,clickSort:n}),key:"price",thConfig:{w:"25%"},render:({price:s,price_diff_24:l})=>{const c=z(l).gt(0);return e.jsx(_,{justify:"flex-end",children:e.jsx(ne,{isLoaded:!a,children:e.jsx(_,{gap:"2px",children:s===void 0||s===""?e.jsx(g,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{color:"text_caption",children:["$",ct(s)]}),e.jsxs(g,{color:Number(l)===0?"text_caption":c?"primary_green":"primary_red",children:["(",c?"+":z(l).gt(-1e-4)&&z(l).lt(0)?"-":"",z(l).gt(-1e-4)&&z(l).lt(1e-4)?"0%":kt(z(l).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(Pe,{labelInfo:Le.value,sortRule:t,sortBy:i,clickSort:n}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:s})=>(console.log(s,"balance_usd"),e.jsx(_,{justify:"flex-end",children:e.jsx(ne,{isLoaded:!a,children:e.jsx(se,{children:e.jsx(g,{color:"text_caption",children:s===void 0?"--":Y(s,2)})})})}))},{title:e.jsx(g,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:s=>e.jsx(N,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{o(s==null?void 0:s.coin_type)},children:"Swap"})}],un=(t,i)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:n=>t({isXCetusModalOpen:n}),isXCetusLoading:!1,setIsXCetusLoading:n=>t({isXCetusLoading:n}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:n=>t({currentXCetusTab:n})}),Te=rt(un),xn={cetus:{title:"CETUS Holdings",imgUrl:J.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:J.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function Ee({type:t,amount:i,amountUSD:n,isLoading:o,children:a}){const{title:r,imgUrl:s,bgUrl:l}=xn[t];return e.jsx(Z,{flex:"1",bg:`center / cover no-repeat url(${l})`,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(O,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(_,{children:[e.jsx(xe,{imageUrl:s,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(g,{children:r})]}),e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(se,{children:e.jsxs(O,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(ne,{isLoaded:!o,h:"24px",children:e.jsx(g,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:i})}),n!==void 0&&e.jsx(ne,{isLoaded:!o,h:"17px",children:e.jsxs(g,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ct(n,2)]})})]})}),a]})]})})}function gn(){const{currentAccount:t}=M(),{balanceInfo:i}=zs(J.cetus_coin),{getTokenAmountValue:n}=re(),{coinPriceObj:o}=He(),a=d.useMemo(()=>n(J.cetus_coin.coin_type,pe((i==null?void 0:i.balance)||"0",J.cetus_coin.decimals)).toString(),[i==null?void 0:i.balance,t==null?void 0:t.address,o]),{setCurrentXCetusTab:r,setIsXCetusModalOpen:s}=Te(),l=()=>{s(!0),r("Get xCETUS")},{veNFT:c,veNFTLoading:u,lockCetusListLoading:x}=ee();return e.jsx(Ee,{type:"cetus",amount:t?(i==null?void 0:i.balanceFormat)||"0":"--",amountUSD:a,isLoading:(x||u)&&c!==void 0,children:e.jsx(N,{onClick:l,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Convert to xCETUS"})})}function hn(){const{lockCetusList:t,lockCetusListLoading:i}=ee(),[n,o]=d.useState([]),[a,r]=d.useState(0),[s,l]=d.useState(1),c=10;return d.useEffect(()=>{if((t==null?void 0:t.length)>0){const u=(s-1)*c;(t==null?void 0:t.length)<=u&&l(1)}},[t]),d.useEffect(()=>{if((t==null?void 0:t.length)>0){r(t==null?void 0:t.length);const u=(s-1)*c,x=u+c;console.log("ðŸš€ ~ useEffect ~ start:",s,t.slice(0,x),u,x),(t==null?void 0:t.length)>u&&o(t.slice(u,x))}},[s,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(yt,{orientation:"horizontal"}),e.jsxs(O,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(g,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(O,{w:"100%",gap:"12px",children:n==null?void 0:n.map(u=>e.jsx(fn,{order:u},u==null?void 0:u.id))}),(t==null?void 0:t.length)>c&&e.jsx(q,{w:"100%",children:e.jsx(ve,{total:a,size:c,currentPage:s,onChange:u=>{l(u)}})})]})]})}const fn=({order:t})=>{const[i,n]=d.useState(!ge.isLocked(t));d.useEffect(()=>{n(!ge.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:o,handleCancelOrder:a}=Ts(),{claimOrderLoading:r,handleClaimOrder:s}=ks(),{days:l,hours:c,minutes:u,seconds:x}=Ps(t.locked_until_time*1e3,()=>{n(!0)},"days"),p=f=>{f?s(t.id):a(t)};return e.jsxs(_,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",bg:"bg_nine",borderRadius:"12px",children:[i?e.jsxs(_,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(W,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(g,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(_,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(W,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs($,{as:"div",children:[e.jsxs(g,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(g,{as:"span",color:"text_caption",fontSize:"13px",children:[l,"d : ",c,"h : ",u,"m : ",x,"s"]})]})]}),e.jsxs(_,{gap:"12px",children:[e.jsx(Ls,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(N,{onClick:()=>{o||r||p(i)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:o||r,color:i?"background":"primary_gray",bg:i?"primary":"card_bg",_hover:{bg:i?"primary_hover":"button_ghost_hov_bg",color:i?"background":"text_caption"},children:i?"Claim":"Cancel"})]})]})};function jn({totalRewardValue:t,rewardList:i,summaryRewardList:n}){const{currentAccount:o}=M(),{veNFTLoading:a}=ee(),{claimRewardLoading:r,handleClaimReward:s}=As(),l=()=>{r||s(i)};return G(),e.jsx(Ee,{type:"rewards",amount:o?z(t).gt("0")?e.jsx(le,{tooltip:e.jsx(O,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:n==null?void 0:n.map(c=>e.jsxs(_,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(gt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(_,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",color:"text_caption",children:Q(c==null?void 0:c.amount,6)}),e.jsxs(g,{fontSize:"12px",children:["(",Y(c==null?void 0:c.value,2),")"]})]})]},c.coin_type))}),children:e.jsx(g,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Y(t,2)})}):e.jsx(g,{textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Y(t,2)}):"--",isLoading:a,children:n.length>0&&e.jsx(N,{onClick:l,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Claim"})})}function mn({availableXCetusAmount:t}){const{currentAccount:i}=M(),{veNFT:n,veNFTLoading:o,lockCetusListLoading:a}=ee(),{getTokenAmountValue:r}=re(),{coinPriceObj:s}=He(),l=d.useMemo(()=>r(J.cetus_coin.coin_type,pe(t||"0",J.x_cetus_coin.decimals)).toString(),[t,i==null?void 0:i.address,s]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:u}=Te(),x=()=>{u(!0),c("Redeem CETUS")},p=(a||o)&&n!==void 0;return e.jsx(Ee,{type:"xcetus",amount:i?Q(pe(t||"0",9),9).toString():"--",amountUSD:l,isLoading:p,children:e.jsx(N,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Redeem"})})}const me=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function bn({isOpen:t,onClose:i,availableXCetusAmount:n}){const{currentXCetusTab:o,setCurrentXCetusTab:a}=Te(),[r,s]=d.useState("#icon-a-icon_trade"),l=()=>{s("#icon-icon_swap1")},c=()=>{s("#icon-a-icon_trade")},u=()=>{var p;const x=(p=me==null?void 0:me.find(f=>(f==null?void 0:f.value)!==o))==null?void 0:p.value;x&&a(x)};return e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{children:[e.jsx(st,{p:"0 16px",children:e.jsx($,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(he,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:me,currentTab:o,handleChangeTab:x=>{a(x==null?void 0:x.value)}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"20px 16px 16px",children:[o==="Get xCETUS"&&e.jsx(Os,{onClose:i,availableXCetusAmount:n,onIconClick:u,iconParams:{xlinkHref:r,svgFill:"text_caption",transform:r==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:r==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}}),o==="Redeem CETUS"&&e.jsx(Rs,{onClose:i,availableXCetusAmount:pe(n,9),onIconClick:u,iconParams:{xlinkHref:r,svgFill:"text_caption",transform:r==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:r==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}})]})]})]})}function wn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:i}=Te(),{availableXCetusAmount:n,totalRewardValue:o,rewardList:a,summaryRewardList:r}=Ds();return e.jsx(Z,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(O,{w:"100%",gap:"16px",children:[e.jsxs(_,{w:"100%",gap:"10px",children:[e.jsx(mn,{availableXCetusAmount:n}),e.jsx(gn,{}),e.jsx(jn,{totalRewardValue:o,rewardList:a,summaryRewardList:r})]}),e.jsx(hn,{}),t&&e.jsx(bn,{isOpen:t,onClose:()=>i(!1),availableXCetusAmount:n})]})})}function yn(){const{currentAccount:t}=M(),{orderListLoading:i,myOrderList:n}=fe(),{isAutoRefresh:o,dcaOrderListLoading:a,dcaActiveOrderList:r}=K(),{getTokenAmountValue:s,coinPriceObj:l}=re(),c=d.useMemo(()=>{let p=z(0);if(o||!i)return(n==null?void 0:n.length)>0&&(t!=null&&t.address)?(n.forEach(f=>{const{pay_coin:w,target_coin:b,un_claimed_amount:k,remaining_amount:D}=f,B=s(w.coin_type,D),j=s(b.coin_type,k);p=z(p).plus(B).plus(j),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",p.toString())}),p.toString()):"0"},[o,n,t==null?void 0:t.address,i,l]),u=d.useMemo(()=>{let p=z(0);if(o||!a)return(r==null?void 0:r.length)>0&&(t!=null&&t.address)?(r.forEach(f=>{const{inBalance:w,inCoin:b,outBalance:k,outCoin:D}=f,B=s(b.coin_type,w),j=s(D.coin_type,k);p=z(p).plus(B).plus(j),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",p.toString())}),p):"0"},[o,r,t==null?void 0:t.address,a,l]),x=d.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",u,c),u&&c){let p=z(0);return p=z(p).plus(u).plus(c),p.toString()}return"--"},[u,c]);return{limitTotalTvl:c,dcaTotalTvl:u,orderTotalTvl:x}}function Cn(){const{currentAccount:t}=M(),{vaultsPositionLoading:i,vaultsPositionObj:n}=de(),{getTokenAmountValue:o}=re(),{getTokenAmountValueByPyth:a}=Vt();return{vaultsTotalTvl:d.useMemo(()=>{let s=Ae(0);return i||Object.values(n).forEach(l=>{const{category:c,displayCoinTypeA:u,displayAmountA:x,displayCoinTypeB:p,displayAmountB:f}=l,w=c=="haedal"?a(u,x):o(u,x),b=c=="haedal"?a(p,f):o(p,f),k=Ae(w).plus(b||0);s=s.add(k)}),s.toString()},[n,i,t==null?void 0:t.address])}}function _n(){const{currentAccount:t}=M(),{isAutoRefresh:i}=K(),{veNFT:n,veNFTLoading:o,lockCetusListLoading:a}=ee(),{getTokenAmountValue:r}=re(),{coinPriceObj:s}=He();return{xCetusTotalTvl:d.useMemo(()=>{if(i||!o&&!a)return t!=null&&t.address&&n?r(J.cetus_coin.coin_type,pe(n==null?void 0:n.xcetus_balance,J.cetus_coin.decimals)).toString():"0"},[i,n==null?void 0:n.xcetus_balance,a,o,t==null?void 0:t.address,s])}}const vn="fetch-coin-holding-list",Sn="fetch-owner-nft",Tn="fetch-active-order-list",kn="fetch-xcetus-base-info",Pn="fetch-vaults-position-list";function Ln(){const{currentAccount:t}=M(),{getTokenListInfo:i}=xt(),{getLimitUserIndexer:n,getDcaUserIndexer:o}=Hs(),{setOrderListLoading:a,setMyOrderList:r}=fe(),{setDcaOrderListLoading:s,setDcaActiveOrderList:l,setDcaPastOrderList:c}=K(),{refreshCoinPriceInfo:u}=ze(),{buildDcaOrderList:x}=us(),p=ie("limit"),f=ie("dca"),{formatLimitOrderList:w}=Cs(),b=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const k=async()=>{if(t){a(!0);const h=await n(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",h),h)try{return(await p.FullClient.getDynamicFieldsByPage(h)).data.map(S=>S.name.value)}catch(v){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",v)}}return[]},D=async()=>{if(t){s(!0);const h=await o(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",h),h)try{return(await f.FullClient.getDynamicFieldsByPage(h)).data.map(S=>S.name.value)}catch(v){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",v)}}return[]};return{fetchActiveOrderList:async()=>{try{const h=await k(),v=await D(),A=await p.FullClient.batchGetObjects([...h,...v],{showType:!0,showContent:!0}),S=A.filter(F=>{var H,m;return(m=(H=F.data)==null?void 0:H.type)==null?void 0:m.includes("limit_order::LimitOrder")}),T=A.filter(F=>{var H,m;return(m=(H=F.data)==null?void 0:H.type)==null?void 0:m.includes("order::Order")}),y=S.map(F=>Pt.buildLimitOrderInfo(F)).filter(F=>F!==void 0).filter(F=>F.status===$e.PartialCompleted||F.status===$e.Running),L=T.map(F=>{var X,ue,ce,je,Ve,Ue,Me,We;const H=we(((X=F.data)==null?void 0:X.type)||""),m=H.type_arguments[0],E=H.type_arguments[1];return{in_coin_type:m,out_coin_type:E,...(ce=(ue=F.data)==null?void 0:ue.content)==null?void 0:ce.fields,id:(Me=(Ue=(Ve=(je=F.data)==null?void 0:je.content)==null?void 0:Ve.fields)==null?void 0:Ue.id)==null?void 0:Me.id,version:(We=F.data)==null?void 0:We.version}}),P=new Set;for(const F of y)P.add(F.pay_coin_type),P.add(F.target_coin_type);for(const F of L)P.add(F.in_coin_type),P.add(F.out_coin_type);await i(Array.from(P));const C=await w(y);r(C);const{activeResult:V,pastResult:U}=await x(L);b.current===(t==null?void 0:t.address)&&(l(V),c(U),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",C),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",L)),u(Array.from(P))}catch(h){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",h)}finally{a(!1),s(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),r([]),l([]),c([])}}}function An(){const{currentAccount:t}=M(),i=ie("clmm"),n=ie("xcetus"),{buildFarmsPositionType:o,buildBurnPositionType:a}=Nt(),{setPosBaseList:r,setFullRangePosBaseList:s,setPosBaseListLoading:l}=ae(),{setVeNFT:c,setVeNFTLoading:u,setLockCetusList:x,clearData:p,setLockCetusListLoading:f,setAvailableXCetusAmount:w}=ee(),{formatPosBaseList:b}=pt(),k=d.useRef(t==null?void 0:t.address);return d.useEffect(()=>{k.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const j=k.current;if(j){l(!0),u(!0);const h=await i.FullClient.getOwnedObjectsByPage(j,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:Lt.clmm_pool.package_id},{StructType:o},{StructType:a},{StructType:Bs},{StructType:Es}]}});let v=await b(h);r(v),l(!1),(v==null?void 0:v.length)==0&&s([]);const A=Vs(h.data);if(A&&j===k.current){c(A,j);const S=await Us(h.data,n);S.sort((T,R)=>T.locked_until_time-R.locked_until_time),console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:S,veNFT:A,availableXCetusAmount:ge.getAvailableXCetus(A,S)}),x(S),w(ge.getAvailableXCetus(A,S))}else f(!1);return{veNFT:A,posBaseList:v}}}catch(j){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",j),j instanceof TypeError&&(l(!1),r([]))}finally{l(!1),f(!1),u(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{r([]),p()}}}function On(){const{currentAccount:t}=M(),i=ie("farms"),n=ie("clmm");pt();const{getPosPoolsOriginalObj:o,getPosPoolsRelatedData:a}=Xt(),{getPosLiquidityData:r}=$t(),{setPosLiquidityData:s,setFarmsPosRewardsData:l,setFarmsPosRewardsDataLoading:c,setPosRewardsData:u,setPosRewardsDataLoading:x,setPosFeeData:p,setPosFeeDataLoading:f}=ae(),{formatFarmsRewardsData:w}=Gt(),{formatPosRewardsData:b}=qt(),{formatPosFeeData:k}=Kt(),{posBaseList:D,setShowPosListLength:B,setMyPosYieldValue:j}=ae(),{refreshCoinPriceInfo:h}=ze(),v=async T=>{var P;const R=T.filter(C=>C.posType==="farms"&&C.farmsPool),y=await o(T);if(a(T,y),((P=Object.keys(y))==null?void 0:P.length)===0)throw s({}),new Error("No pool data found");r(T,y);const L=new At;R.length>0&&R.forEach(C=>{i.Farms.buildCalculateFarmingReward({pool_id:C.farmsPool,position_nft_id:C.id},L)}),T.forEach(C=>{n.Position.buildFetchPosFee({pool_id:C.clmmPool,position_id:C.posId,coin_type_a:C.coinTypeA,coin_type_b:C.coinTypeB},L)}),T.filter(C=>C.posType!=="farms").forEach(C=>{var U;const V=y[C.clmmPool];n.Rewarder.buildFetchPosReward({pool_id:C.clmmPool,position_id:C.posId,coin_type_a:C.coinTypeA,coin_type_b:C.coinTypeB,rewarder_types:(U=V.rewarder_infos)==null?void 0:U.map(F=>F.coinAddress)},L)});try{c(!0),x(!0),f(!0);const C=await n.FullClient.devInspectTransactionBlock({transactionBlock:L,sender:Ot("0x0")}),V=i.Farms.parsedPosRewardData(C),U=n.Rewarder.parsedPosRewardData(C),F=n.Position.parsedPosFeeData(C);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:V,clmmRewardData:U,clmmFeeData:F});const H=await w(V);l(H);const m=await b(Object.values(U).map(X=>{const ue=y[T.find(ce=>ce.posId===X.position_id).clmmPool];return{poolAddress:ue.pool_address,positionId:X.position_id,rewarderAmountOwed:X.rewarder_amount.map((ce,je)=>({coin_address:ue.rewarder_infos[je].coinAddress,amount_owed:new Rt(ce)}))}}));u(m);const E=await k(Object.values(F).map(X=>({position_id:X.position_id,fee_owned_a:X.fee_owned_a,fee_owned_b:X.fee_owned_b})),T);p(E),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:E,posRewardsData:m,posFarmsRewardsObj:H}),A(T,m,H)}catch(C){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",C)}finally{c(!1),x(!1),f(!1)}},A=async(T,R,y)=>{console.log("ðŸš€ ~ fetchTokenPrice ~ posRewardsData:",T,R);const L=[];if(T.length>0){T.map(C=>{L.push(we(C==null?void 0:C.coinTypeA).full_address),L.push(we(C==null?void 0:C.coinTypeB).full_address);const V=R[C==null?void 0:C.posId]||[],U=y[C==null?void 0:C.id]||[],F=V.concat(U);F==null||F.map(H=>{var m;Ae(H==null?void 0:H.display_amount_owed).gt(0)&&L.push(we((m=H==null?void 0:H.token)==null?void 0:m.coin_type).full_address)})}),console.log("ðŸš€ ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(L)));const P=Array.from(new Set(L));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",P),h(P)}};return{fetchPosRelatedData:v,resetUserData:()=>{s({}),l({}),u({}),p({})}}}function Rn(){const{getVaultsTokenList:t,getVaultsLpTokenList:i}=Fe(),{getVaultsContractInfo:n}=Ut(),{getVaultsPosition:o}=Mt(),{setVaultsPositionLoading:a,clearVaultsPositionObj:r}=de(),{getVaultPoolList:s}=Wt();return{fetchVaultsPositionList:async()=>{console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:"),a(!0);const u=await s();console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:",u),t(u),i(u);const{lstVaultContractInfoObj:x,haedalVaultContractInfoObj:p,allClmmPoolContractInfoObj:f}=await n(u);o(u,x,p,f)},resetUserData:()=>{r()}}}function Dn(){const{currentAccount:t}=M(),{setXCetusManager:i,setDividendManager:n}=ee(),o=ie("xcetus");return{fetchXCetusBaseInfo:async r=>{try{const{xcetus:s,xcetus_dividends:l}=Dt,{dividend_manager_id:c}=Ge(l),{xcetus_manager_id:u}=Ge(s),x=await o.FullClient.batchGetObjects([u,c],{showType:!0,showContent:!0}),p=x.find(w=>{var b,k;return(k=(b=w.data)==null?void 0:b.type)==null?void 0:k.includes("xcetus::XcetusManager")});if(p){const w=qe(p),b={id:w.id.id,index:Number(w.index),has_venft:{handle:w.has_venft.fields.id.id,size:w.has_venft.fields.size},nfts:{handle:w.nfts.fields.id.id,size:w.nfts.fields.size},total_locked:w.total_locked,treasury:w.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",b),i(b)}const f=x.find(w=>{var b,k;return(k=(b=w.data)==null?void 0:b.type)==null?void 0:k.includes("dividend::DividendManager")});if(f){const w=qe(f),b=ge.buildDividendManager(w);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",b),o.updateCache(`${c}_getDividendManager`,b),n(b)}}catch(s){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",s)}}}}function Hn(t){const{currentAccount:i}=M(),{fetchCoinHoldingList:n,resetUserData:o}=ft(),{fetchPosRelatedData:a,resetUserData:r}=On(),{fetchActiveOrderList:s,resetUserData:l}=Ln(),{fetchVaultsPositionList:c,resetUserData:u}=Rn(),{setAutoRefreshCount:x}=K(),{fetchOwnerNFT:p,resetUserData:f}=An(),{fetchXCetusBaseInfo:w}=Dn(),{addTask:b,removeTask:k}=Ms(),[D,B]=d.useState([]),j=d.useRef(i),{setOrderListLoading:h}=fe(),{setLockCetusListLoading:v}=ee(),{setPosBaseListLoading:A}=ae(),{setIsCoinHoldingLoading:S}=Se(),{setVaultsPositionLoading:T}=de(),R=()=>{o(),r(),l(),f(),u()};d.useEffect(()=>{var H,m;i?((H=j.current)!=null&&H.address&&((m=j.current)==null?void 0:m.address)!==(i==null?void 0:i.address)&&(x(!1),R(),D.forEach(E=>{k(E.id)})),U()):(R(),D.forEach(E=>{k(E.id)})),j.current=i},[i==null?void 0:i.address]);const y={id:vn,run:n},L={id:Sn,run:p,onSuccess:H=>{const{posBaseList:m}=H;a(m)}},P={id:kn,run:w},C={id:Tn,run:s},V={id:Pn,run:c},U=()=>{const H=[];h(!0),v(!0),A(!0),S(!0),T(!0),t==="wallet"?H.push(y,L,V,C,P):t==="liquidity"?H.push(L,V,y,C,P):t==="orders"?H.push(C,y,L,V,P):H.push(L,V,P,y,C),B(H),H.forEach(m=>{b(m)})};return{refreshTask:()=>{i&&(D.forEach(H=>{k(H.id)}),U())}}}const be=t=>t?Y(t,2):"$--",Fn=(...t)=>t.reduce((i,n)=>i.plus(n&&+n?n:0),z(0)).toString();function oi(){const{tab:t}=ts(),{currentAccount:i,onWalletModal:n}=M(),o=De(),{posBaseListLoading:a,posLiquidityDataLoading:r}=ae(),{holdingsTotalUsd:s,isCoinPriceLoading:l,isCoinHoldingLoading:c}=Se(),{liquidityTotalTvl:u}=Zt(),{orderTotalTvl:x}=yn(),{orderListLoading:p}=fe(),{isAutoRefresh:f,dcaOrderListLoading:w,setAutoRefreshCount:b,resetAutoRefreshCount:k}=K(),{xCetusTotalTvl:D}=_n(),{vaultsTotalTvl:B}=Cn();console.log("ðŸš€ðŸš€ðŸš€ ~ Profile.tsx:47 ~ ProfilePage ~ vaultsTotalTvl:",B);const{vaultsPositionLoading:j}=de(),{lockCetusListLoading:h,veNFTLoading:v,veNFT:A}=ee(),S=d.useMemo(()=>t,[t]),{refreshTask:T}=Hn(S),R=!f&&(c||l),y=!f&&(a||r||l||j),L=!f&&(p||w||l),P=!f&&(h||v||l),C=d.useMemo(()=>({wallet:{totalValue:be(s),isLoading:R},liquidity:{totalValue:be(u),isLoading:y},orders:{totalValue:be(x),isLoading:L},xCetus:{totalValue:be(D),isLoading:P}}),[s,u,x,D,R,y,L,P,B]),V=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],U=d.useMemo(()=>Fn(D,u,x,s),[D,u,x,s]);d.useEffect(()=>k(!1),[]);const[F,H]=d.useState(!1);d.useEffect(()=>{H(!0)},[]);const{isApp:m}=G();return m?e.jsx(Ws,{totalValue:U,onRefreshTask:T,isLoading:!f&&(v||a||p||w),children:e.jsx(Qe,{tabList:V,activeTab:S,tabData:C,onClickTab:E=>o(`/profile?tab=${E}`)})}):e.jsx(O,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:F?i!=null&&i.address?e.jsxs(O,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(nn,{handleRefresh:E=>{b(!E),T()},totalValue:U,isLoading:!f&&(v||a||p||w)}),e.jsx(Qe,{tabList:V,activeTab:S,tabData:C,onClickTab:E=>o(`/profile?tab=${E}`)}),S==="wallet"&&e.jsx(dn,{}),S==="liquidity"&&e.jsx(qs,{}),S==="orders"&&e.jsx(sn,{}),S==="xCetus"&&e.jsx(wn,{})]}):e.jsx(I,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>n(!0)}):e.jsx(Ze,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Re,{})})})}export{oi as default};
//# sourceMappingURL=Profile-CAljtnXU.js.map

import{a as u,x as Je,j as e,V as R,F as Ze,a9 as Re,H as k,T as h,C as J,p as ee,q as W,f as G,W as Ie,X as et,Y as tt,Z as st,$ as nt,a0 as ot,aa as De,I as it,N as mt,az as jt,O as bt,Q as wt,aq as We,af as yt}from"./vendor-BFGDaAdA.js";import{u as at}from"./global-B2mCTGzM.js";import{j as M,C as re,I as N,O as ae,aD as Ct,i as xe,a as $,a1 as _t,G as I,B as Q,e as lt,q as Xe,d as z,aE as be,t as se,c as Le,F as vt,Q as rt,n as ce,M as le,p as St,V as Tt,f as ct,aj as kt,v as K,m as He,ao as Z,an as pe,Z as Oe,k as ne,aF as Pt,aG as $e,o as je,aH as Lt,aI as Ot,ai as At,aJ as Rt,aK as Dt,aL as Ge,aM as qe}from"./index-QNvgVKlA.js";import{N as Y}from"./NoData-DtiZhmrM.js";import{u as Ht,A as Ft,R as zt}from"./RecentTransactions-BRyI7Mxk.js";import{A as Et}from"./AccountSwitchDrawer-CvKRNAYH.js";import{u as Fe,V as Vt}from"./useVaultList-a-4c-vVC.js";import{a as oe,d as Bt,u as dt,e as Ut,f as Mt,g as Nt,c as Wt,b as Xt}from"./usePositionList-BaYucLl_.js";import{a as de,u as $t,h as Gt,e as qt,c as Kt,i as Qt}from"./VaultsAprBlock-D1GuVHob.js";import{a as Yt,b as Jt,P as Zt,u as It}from"./PoolItem-BWOkpwLS.js";import{u as q}from"./activeOrders-DqP3Ykrb.js";import{P as es,V as ts,H as we,u as ss}from"./PositionListLoading-zBwW5_W7.js";import{C as ns}from"./CoinPairInfo-DYRSTcir.js";import{u as os}from"./VaultsAction-BNCRfsCf.js";import{H as ye,T as Ce}from"./Table-BtGnvT0c.js";import{u as ut,D as pt,g as is,e as as,f as ls,W as rs,b as cs,R as ds,a as us,d as ps}from"./OverviewOrders-B1VLLokB.js";import{I as Te}from"./IconText-CPPPbqTI.js";import{u as xs}from"./RangeValue-CHhwkfJm.js";import{H as te}from"./HTextLabelBox-BtA_IlNt.js";import{P as _e}from"./Pagination-CEkqmVuP.js";import{b as gs,u as ge,c as hs,C as fs,P as ms,F as js,E as bs,S as ws,O as ys,a as Cs}from"./useGetLimitOrderHistory-J_JWWmxp.js";import{u as _s}from"./useRpcListener-BgulSPEI.js";import{R as vs}from"./RefreshButton-Bqj6ePwp.js";import{u as Ss}from"./useAccountBalance-dpDaMlfe.js";import{u as xt}from"./useToken-DOpzZ4jY.js";import{f as ze,a as Ts,b as ks,u as Ps,X as Ls,c as Os,C as As,e as Rs,d as Ds,g as Hs}from"./useXCetus-Cg86HkYz.js";import{S as gt}from"./SingleTokenInfo-Ce6-xjca.js";import{S as Fs}from"./SortDropBlock-Dq12Lr0D.js";import{T as ke}from"./TableSortTh-BsPCW77e.js";import{u as zs}from"./useTokenBalance-Bb797F7L.js";import{X as Es,a as Vs,b as Bs,c as Us}from"./useXCetusHelper-BEFW1sMX.js";import"./CopyButton-CMMk2izN.js";import"./Drawer-Dz9Aj4rR.js";import"./useVaultsHoldings-DCgYhjl3.js";import"./useFavoritePool-DqHLM_4q.js";import"./useGetPoolList-ByJZGCUe.js";import"./useWrapPoolData-CHCtGZRc.js";import"./CheckBox-BA2PcE7i.js";import"./SearchInputBlock-BQ_tOf7s.js";import"./index-CHhxlT8k.js";import"./Loading-yKVeoG31.js";import"./TooltipIcon-Bmng7kBJ.js";import"./PositionCurrentPrice-BXQH7zbJ.js";import"./contract-helper-VzIAinmS.js";import"./msafe-oYBkW7LJ.js";import"./useTransaction-D8x8EhDP.js";import"./useTrack-DgiixkZ_.js";import"./useSigner-NhmhdGMF.js";import"./ExpendItem-CQyEc2RF.js";import"./PositionStatus-DAHDqPot.js";import"./useInterval-BQqGpXj5.js";import"./PoweredByHaedal-BDxnuz9-.js";import"./VTextLabelBox-BtYRI_Uk.js";import"./useNotifiSubscription-Bnf-_NzT.js";import"./useNotifiAlerts-CoirGj-9.js";import"./usePriceImpact-DJ--uX3c.js";import"./index-DTh9ITUf.js";import"./useSwapHelper-Q9vgMLY5.js";import"./TradeConfirmAmountInfo-CT2s8_lq.js";import"./TotalAmount-CuHzhAl9.js";import"./TradeInputGroup-CgK4vFNA.js";import"./_getAllKeysIn-CBD6ibod.js";import"./RemoveBlock-C66QWwES.js";import"./DepositRatio-CzFcBpXy.js";import"./FreshProgressV2-Bvea63St.js";import"./ErrorTips-BY_r0Z3E.js";import"./index-CfStmzq_.js";import"./usePosAdd-DT_ux7ir.js";import"./index-DpoGqmhj.js";import"./useFindBestRouting-YU1qGFi4.js";import"./usePreviousValue-DoVr3Y3V.js";import"./HighlightText-fkyigc44.js";import"./index-D1m9ooSc.js";import"./debounce-B8kzHASh.js";import"./index-BLCSsYSf.js";function Ms(t=100){const o=u.useRef([]),s=u.useRef(!1),i=u.useRef(void 0),r=u.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const l=o.current.shift();if(!l)continue;const{id:c,run:p,onStart:x,onSuccess:d,onError:f}=l;if(l._cancelled){console.log(`[task:${l.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),x==null||x(c);const b=await p(i.current,c);i.current=b,console.log(`[task:${c}] success`,b),d==null||d(b,c)}catch(b){console.error(`[task:${c}] failed`,b),f==null||f(b,c)}await new Promise(b=>setTimeout(b,t))}s.current=!1}},[t]),a=l=>{o.current.push(l),r()},n=l=>{const c=o.current.find(p=>p.id===l);c&&(c._cancelled=!0),o.current=o.current.filter(p=>p.id!==l)};return u.useEffect(()=>()=>{o.current=[],s.current=!1,i.current=void 0},[]),{addTask:a,removeTask:n}}const ht=(t,o)=>o?t:"********";function Ns({totalValue:t,onRefreshTask:o,isLoading:s,children:i}){const[r,a]=u.useState(!1),{currentAccount:n,onWalletModal:l,accounts:c,accountServiceNameObj:p}=M(),{isShowProfileAssets:x,setIsShowProfileAssets:d}=at();u.useEffect(()=>{a(!0)},[]);const{isOpen:f,onClose:b,onToggle:j}=Je(),{getServiceNames:P}=Ht(),D=u.useCallback(()=>{f||P(c),j(),console.log("AccountSwitch###handleClick###isOpen: ",f)},[f,c]);return console.log(n,p,c,"currentAccount-H5Main"),e.jsxs(R,{w:"100%",mt:"28px",children:[r?n!=null&&n.address?e.jsxs(R,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(k,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(k,{h:"18px",children:[e.jsx(h,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(h,{fontSize:"12px",children:x?"Hide Value":"Show Value"}),children:e.jsx(J,{children:e.jsx(N,{xlinkHref:x?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>d(!x)})})})]}),e.jsxs(k,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(h,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(N,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(ee,{isLoaded:!s,h:"32px",children:e.jsx(h,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(ae(t,2),x)})}),c.length>1&&e.jsxs(k,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:D,cursor:"pointer",children:[e.jsxs(k,{children:[e.jsx(N,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(h,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[n!=null&&n.label?`${n==null?void 0:n.label} : `:"",(p==null?void 0:p[n==null?void 0:n.address])||Ct(n==null?void 0:n.address)]})]}),e.jsx(N,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),i]}):e.jsx(Y,{type:"nowallet",mt:"20px",onboard:()=>l(!0)}):e.jsx(Ze,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Re,{})}),e.jsx(Et,{isOpen:f,onClose:b})]})}function Ee(t){const{type:o,children:s,wrapStyle:i={h:"60px"},textStyle:r={fontSize:"16px"}}=t,a=(n,l)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(n,l):n===l.value;return e.jsxs(k,{justify:"space-between",w:"100%",h:"60px",...i,children:["title"in t?e.jsx(h,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(xe,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(n,l)=>a(n,l),wrapStyle:{h:"60px",border:"none",gap:"38px",...i},itemStyle:r}),s]})}function Ws({showPosListGroupByPool:t=[]}){var a;const{currentAccount:o,onWalletModal:s}=M(),{posBaseListLoading:i}=oe(),{isAutoRefresh:r}=q();return e.jsxs(R,{w:"100%",children:[e.jsx(Yt,{isProfile:!0}),o!=null&&o.address?!r&&i?[{},{},{},{}].map((n,l)=>e.jsx(es,{},l)):((a=Object.values(t))==null?void 0:a.length)>0?Object.values(t).map((n,l)=>e.jsx(Jt,{poolInfo:n,isProfile:!0},l)):e.jsx(Y,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(Y,{type:"nowallet",onboard:()=>s(!0),noBorder:!0})]})}function Xs({poolInfo:t}){console.log("ðŸš€ ~ VaultsTableAction ~ poolInfo:",t);const[o,s]=u.useState("Deposit"),[i,r]=u.useState(!1),{clearVaultsActionData:a}=os();return u.useEffect(()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ ActionsBlock.tsx:22 ~ useEffect ~ clearVaultsActionData:"),a()},[i]),e.jsxs(e.Fragment,{children:[e.jsxs(k,{justify:"flex-end",children:[e.jsx(W,{onClick:()=>{s("Deposit"),r(!0)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Deposit"}),e.jsx(W,{onClick:()=>{s("Withdraw"),r(!0)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Withdraw"})]}),i&&e.jsx(ts,{isOpen:i,setIsOpen:r,displayTokenA:t.displayTokenA,displayTokenB:t.displayTokenB,feeDisplay:t.feeDisplay,clmmPool:t.clmmPoolAddress,category:t.category,vaultId:t.vaultId,isReverse:t.isReverse,currentTab:o},t.vaultId)]})}function $s({selectCoinList:t=[]}){const{vaultsPositionObj:o}=de(),{vaultPageList:s,vaultListLoading:i,setVaultListLoading:r}=$t(),{filterVaultList:a,getCurrentTabNum:n}=Fe(),l=u.useMemo(()=>s,[s]);console.log("ðŸš€ ~ ProfileVaults ~ pageList:",i,(l==null?void 0:l.length)===0,l);const{isAutoRefresh:c,autoRefreshCount:p}=q(),{isApp:x}=$(),d=!0,f={sortRule:"desc",sortType:"tvl"},b=u.useMemo(()=>[{label:"All Vault",value:"all",num:n({sortOptions:f,currentTab:"all",isYourHoldings:d,selectCoinList:t})||""},{label:"Cetus",value:"cetus",num:n({sortOptions:f,currentTab:"cetus",isYourHoldings:d,selectCoinList:t})||""},{label:"Haedal",value:"haedal",num:n({sortOptions:f,currentTab:"haedal",isYourHoldings:d,selectCoinList:t})||""}],[JSON.stringify(l),d,JSON.stringify(t)]),[j,P]=u.useState("all"),D=Gs({isShowPowered:j!=="Haedal",vaultsPositionObj:o}),E=g=>{j===g||i||(P(g),a({sortOptions:f,currentTab:g,isYourHoldings:d,selectCoinList:t}),r(!0),setTimeout(()=>{r(!1)},200))};return u.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ vaultsPositionObj:",o),_t(o)&&a({sortOptions:f,currentTab:j,isYourHoldings:d,selectCoinList:t})},[o,t]),e.jsxs(R,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",children:[e.jsx(xe,{type:"outlineTab",tabList:b,currentTab:j,handleChangeTab:g=>E(g==null?void 0:g.value),isActive:(g,w)=>g===w.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),e.jsx(R,{w:"100%",position:"relative",gap:"20px",children:(c||!i)&&(l==null?void 0:l.length)===0?e.jsx(Y,{type:"nodata",text:"No data",noBorder:!0}):x?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(ye,{rowKey:"lpTokenType",columns:D,dataSource:l,loading:!c&&i,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ce,{rowKey:"lpTokenType",columns:D,dataSource:l,loading:!c&&i,rowStyle:{h:"80px",cursor:"pointer"}})})]})}const Gs=({isShowPowered:t,vaultsPositionObj:o})=>[{title:e.jsx(h,{children:"Pools"}),thConfig:{pl:"0px !important"},render:s=>e.jsx(ns,{poolInfo:{...s,poolAddress:s==null?void 0:s.vaultId},isShowPowered:t,symbolFontSize:"15px"})},{title:e.jsx(h,{textAlign:"right",children:"Your Holdings"}),render:s=>{const i=o[s==null?void 0:s.vaultId]||{};return e.jsxs(k,{justifyContent:"flex-end",gap:"0",children:[e.jsxs(h,{color:"text_caption",mr:"2px",children:[" ",`${(i==null?void 0:i.balanceDisplay)||"0"} LP`]}),e.jsx(h,{children:"("}),e.jsx(Vt,{color:"text_paragraph",vaultId:s.vaultId,category:s.category}),e.jsx(h,{children:")"})]})}},{title:e.jsx(h,{textAlign:"right",children:"Share of Pool"}),render:s=>{const i=o[s==null?void 0:s.vaultId]||{};return console.log("ðŸš€ ~ vaultsPositionObj:",o,i),e.jsxs(h,{color:"text_caption",children:[" ",i==null?void 0:i.shartOfPoolDisplay]})}},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),render:s=>e.jsx(Xs,{poolInfo:s})}];function qs(){const{currentAccount:t}=M(),{vaultsPositionObj:o}=de(),{showPosListLength:s,posBaseListLoading:i,setShowPosListLength:r,posBaseListGroupByPool:a}=oe(),{getCurrentTabNum:n}=Fe(),[l,c]=u.useState([]),p=g=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",g),c(w=>[...w,g])},x=g=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",g),c(w=>w.filter(v=>(v==null?void 0:v.coin_type)!==(g==null?void 0:g.coin_type)))};u.useEffect(()=>{t!=null&&t.address||r("")},[t==null?void 0:t.address]),u.useEffect(()=>()=>{r("")},[]);const[d,f]=u.useState("positions"),b={sortRule:"desc",sortType:"tvl"},j=!0,P=u.useMemo(()=>[{label:"Positions",value:"positions",num:i?"":Number(s)},{label:"Vaults",value:"vaults",num:n({sortOptions:b,currentTab:"all",isYourHoldings:j,selectCoinList:l})||""}],[i,s,o]),[D,E]=u.useState([]);return u.useEffect(()=>{var C,S,A,y;const g=(C=l[0])!=null&&C.coin_type?I((S=l[0])==null?void 0:S.coin_type):void 0,w=(A=l[1])!=null&&A.coin_type?I((y=l[1])==null?void 0:y.coin_type):void 0,v=Object.values(a).filter(T=>g&&w?I(T.tokenA.coin_type)==g&&I(T.tokenB.coin_type)==w||I(T.tokenA.coin_type)==w&&I(T.tokenB.coin_type)==g:g?I(T.tokenA.coin_type)==g||I(T.tokenB.coin_type)==g:T);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(a),v),E(v);const L=v.reduce((T,O)=>T+(O.list?O.list.length:0),0);t!=null&&t.address&&r(L.toString())},[l,a]),e.jsx(Q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{gap:"16px",w:"100%",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(Ee,{type:"tab",currentTab:d,tabs:P,onTabChange:g=>f(g.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(Zt,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:l,onClickSelectCoinList:p,onDeleteSelectCoinList:x})]}),e.jsx(G,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),d==="positions"&&e.jsx(Ws,{showPosListGroupByPool:D}),d==="vaults"&&e.jsx($s,{selectCoinList:l})]})})}function Ks({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:i,outCoin:r}=t,{orderHistoryList:a,handleGetDcaOrderHistory:n,orderHistoryListLoading:l}=ut();u.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=lt(),[p,x]=u.useState(s),d=142,f=(a==null?void 0:a.length)||0,b=(a==null?void 0:a.length)<=1?`${d*f-8}px`:`${d*f+(f-1)*32-8}px`;return e.jsxs(R,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(a==null?void 0:a.length)>=3?"460px":"unset",overflowY:"auto",children:[!l&&e.jsx(G,{h:b,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),l?e.jsx(k,{h:"100px",w:"100%",justify:"center",children:e.jsx(Re,{})}):(a==null?void 0:a.length)===0?e.jsx(Y,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):a.map(j=>{const P=Xe(j.inAmount,i==null?void 0:i.decimals),D=Xe(j.outAmount,r==null?void 0:r.decimals),E=z(P).div(D).toString(),g=z(1).div(E).toString();return e.jsxs(R,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(k,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(h,{h:"20px",lineHeight:"20px",children:[be((j==null?void 0:j.time)*1e3)," (UTC)"]}),e.jsx(N,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(j==null?void 0:j.tx,"tx"))}}),e.jsx(k,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(G,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(Q,{p:"16px",borderRadius:"12px",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsxs(R,{gap:"0px",align:"flex-start",children:[e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:p?`${se(E)} `:`${se(g)} `}),e.jsxs(k,{children:[e.jsxs(h,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",p?` ${i.symbol} per ${r.symbol}`:` ${r.symbol} per ${i.symbol}`,")"]}),e.jsx(N,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>x(!p)})]})]}),e.jsxs(k,{w:"100%",gap:"4px",children:[e.jsx(Le,{imageUrl:i==null?void 0:i.logo_url,w:"20px",h:"20px"}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(P)}`}),e.jsx(h,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${i.symbol}`}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(Le,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(D)}`}),e.jsx(h,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},j==null?void 0:j.tx)})]})}function Qs({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:i=!1,toClaim:r}){const{inCoin:a,outCoin:n}=t;return e.jsxs(R,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(Ys,{}),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(pt,{orderInfo:t}),o&&r&&e.jsx(W,{isLoading:i,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||i,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(h,{fontSize:"16px",color:"text_caption",children:is(t,o,!0)}),e.jsx(h,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(k,{w:"100%",justify:"space-around",children:[e.jsxs(R,{children:[e.jsx(h,{fontSize:"16px",color:"text_caption",children:as(t)}),e.jsxs(h,{fontSize:"12px",children:["DCA ",a==null?void 0:a.symbol," Balance"]})]}),e.jsx(G,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(R,{children:[e.jsx(h,{color:"text_caption",fontSize:"16px",children:ls(t)}),e.jsxs(h,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(R,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(te,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(te,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(te,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${a==null?void 0:a.symbol}`}),o&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(te,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${a==null?void 0:a.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(te,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${a==null?void 0:a.symbol}`}),o&&e.jsx(te,{label:"Next Order (UTC)",value:be(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(te,{label:"Created (UTC)",value:be(t==null?void 0:t.createdAt)||""})]})]})}const Ys=()=>{const[t,o]=u.useState(!1);return e.jsxs(R,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(k,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(h,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(N,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(R,{align:"flex-start",w:"100%",children:[e.jsx(G,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(rs,{})]})]})};function Js({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:i,isClaimLoading:r=!1,toClaim:a}){const{isApp:n}=$(),l=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,p]=u.useState("overview"),{inCoin:x,outCoin:d}=s,[f,b]=u.useState(!1),{getTokenRank:j}=xs();return u.useEffect(()=>{const P=j(x,d);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",d,x,P),b(!P)},[x==null?void 0:x.coin_type,d==null?void 0:d.coin_type]),e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{minWidth:n?"300px":"482px",children:[e.jsx(st,{children:e.jsx(G,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ee,{type:"tab",currentTab:c,tabs:l,onTabChange:P=>p(P.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(Qs,{orderInfo:s,isActiveOrder:i,pageDirect:f,isClaimLoading:r,toClaim:a}),c=="orders"&&e.jsx(Ks,{orderInfo:s,isActiveOrder:i,pageDirect:f})]})]})]})}function Zs({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=$(),[i,r]=u.useState(!1),{getExplorerUrl:a}=lt(),{isClaimLoading:n,toClaim:l,closeOrderAction:c,isCloseLoading:p}=ut();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(k,{justify:"flex-end",children:[e.jsx(W,{isLoading:n,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||n,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(re,{placement:"bottom-end",tooltip:e.jsxs(R,{align:"flex-start",children:[e.jsx(Te,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(Te,{text:"View on Explorer",onClick:()=>{window.open(a(t.orderID,"poolAddress"))}}),e.jsx(Te,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:p?()=>{}:()=>{c(t)}})]}),children:e.jsx(J,{children:e.jsx(W,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(k,{justify:"flex-end",children:[e.jsx(W,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(W,{onClick:x=>{vt(x),window.open(a(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(N,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),i&&e.jsx(Js,{isOpen:i,onClose:()=>r(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:l})]})}function Is(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:i}=q(),[r,a]=u.useState("activeDCAs"),n=u.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":i==null?void 0:i.length}],[o,i,s]),l=u.useMemo(()=>r=="activeDCAs"?s:i,[r,s,i]),{isApp:c}=$(),{closeAll:p,claimAll:x,isClaimAllLoading:d,isCloseAllLoading:f}=cs(),b=u.useMemo(()=>r==="pastDCAs"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((C,S)=>z(C).plus(S==null?void 0:S.outBalance),z(0)).toString(),[r,l]),[j,P]=u.useState([]),[D,E]=u.useState(0),[g,w]=u.useState(1),v=10,L=Ke(r=="activeDCAs");return u.useEffect(()=>{if((l==null?void 0:l.length)>0){const C=(g-1)*v;(l==null?void 0:l.length)<=C&&w(1)}},[l]),u.useEffect(()=>{if((l==null?void 0:l.length)>0){E(l==null?void 0:l.length);const C=(g-1)*v,S=C+v;console.log("ðŸš€ ~ useEffect ~ start:",g,l.slice(0,S),C,S),(l==null?void 0:l.length)>C&&P(l.slice(C,S))}},[g,l]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(xe,{type:"outlineTab",tabList:n,currentTab:r,handleChangeTab:C=>a(C==null?void 0:C.value),isActive:(C,S)=>C===S.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(l==null?void 0:l.length)>1&&r=="activeDCAs"&&e.jsxs(k,{children:[e.jsx(W,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:d,disabled:Number(b)===0||d,onClick:()=>{x(l)},children:"Claim All"}),e.jsx(W,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:f,disabled:(l==null?void 0:l.length)==0||f,onClick:()=>{p(l)},children:"Close All"})]})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(t||!o)&&(l==null?void 0:l.length)===0?e.jsx(Y,{type:"nodata",text:r==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(ye,{rowKey:"orderID",columns:L,dataSource:j,loading:!t&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ce,{rowKey:"orderID",columns:Ke(r=="activeDCAs"),dataSource:j,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(l==null?void 0:l.length)>v&&e.jsx(J,{children:e.jsx(_e,{total:D,size:v,currentPage:g,onChange:C=>{w(C)}})})]})]})}const Ke=t=>[{title:e.jsx(h,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(pt,{orderInfo:s})},{title:e.jsx(h,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(ds,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(h,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(us,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(h,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(h,{color:"text_caption",children:be(s)})},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(Zs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function en(){const{currentAccount:t}=M(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:i}=gs(),{myOrderList:r,orderListLoading:a}=ge(),{isAutoRefresh:n,autoRefreshCount:l}=q(),[c,p]=u.useState("openOrders"),x=u.useMemo(()=>c=="openOrders"?a:i,[c,a,i]),d=u.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,s),c=="openOrders"?r:s),[c,r,s]),f=u.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:(n||!x)&&(r==null?void 0:r.length)===0?0:!n&&a?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:(n||!x)&&(s==null?void 0:s.length)===0?0:!n&&i?"":s==null?void 0:s.length}],[a,i,r,s]),b=y=>{t!=null&&t.address&&o(t.address,y)};u.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",l),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),l>0&&b(!0)},[l]),u.useEffect(()=>{b(!1)},[c,t]),_s({onRpcChange:()=>{b(!0)}});const{isApp:j}=$(),{handleCancelOrder:P,cancelOrderLoading:D}=hs(),[E,g]=u.useState([]),[w,v]=u.useState(0),[L,C]=u.useState(1),S=10,A=tn(c=="openOrders");return u.useEffect(()=>{if((d==null?void 0:d.length)>0){const y=(L-1)*S;(d==null?void 0:d.length)<=y&&C(1)}},[d]),u.useEffect(()=>{if((d==null?void 0:d.length)>0){v(d==null?void 0:d.length);const y=(L-1)*S,T=y+S;console.log("ðŸš€ ~ useEffect ~ start:",L,d.slice(0,T),y,T),(d==null?void 0:d.length)>y&&g(d.slice(y,T))}},[L,d]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(xe,{type:"outlineTab",tabList:f,currentTab:c,handleChangeTab:y=>p(y==null?void 0:y.value),isActive:(y,T)=>y===T.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(k,{children:e.jsx(W,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:D,onClick:()=>{P(r)},children:"Cancel All"})})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(n||!x)&&(d==null?void 0:d.length)===0?e.jsx(Y,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):j?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(ye,{rowKey:"order_id",columns:A,dataSource:E,loading:!n&&x,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ce,{rowKey:"order_id",columns:A,dataSource:E,loading:!n&&x,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>S&&e.jsx(J,{children:e.jsx(_e,{total:w,size:S,currentPage:L,onChange:y=>{C(y)}})})]})]})}const tn=t=>[{title:e.jsx(h,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(fs,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(ms,{info:s,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(js,{info:s,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(bs,{info:s,isProfile:!0})},!t&&{title:e.jsx(h,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(ws,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(ys,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function sn(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=u.useState("limitOrders");return e.jsx(Q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsx(G,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ee,{type:"tab",currentTab:o,tabs:t,onTabChange:i=>s(i.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(en,{}),o==="dca"&&e.jsx(Is,{})]})})}function nn({handleRefresh:t,totalValue:o,isLoading:s}){const{isApp:i}=$(),{currentAccount:r,accounts:a}=M(),{isShowProfileAssets:n,setIsShowProfileAssets:l}=at(),[c,p]=u.useState(!1),{onClose:x}=Je();return e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsxs(k,{gap:"4px",children:[e.jsx(h,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!i,placement:"bottom-end",tooltip:e.jsx(h,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(J,{children:e.jsx(N,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>l(!n)})})})]}),e.jsxs(k,{children:[e.jsxs(k,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{p(!0)},children:[e.jsx(N,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(h,{children:"Transactions"})]}),e.jsx(vs,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),e.jsx(k,{w:"100%",justify:"space-between",mt:"2px",children:e.jsx(ee,{isLoaded:!s,h:"22px",children:e.jsx(h,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(ae(o,2),n)})})}),a.length>1&&e.jsx(Ft,{currentAccount:r,accounts:a,onClose:x,isProfile:!0}),c&&e.jsx(zt,{isOpen:c,onClose:()=>p(!1)})]})}function on({tabList:t,tabData:o,onClickTab:s}){return e.jsx(R,{w:"100%",children:t==null?void 0:t.map(i=>e.jsx(an,{imgUrl:i.activeImgUrl,value:o[i.value].totalValue,title:i.title,url:i.route,tooltip:i==null?void 0:i.tooltip,onClick:()=>s(i.value),isLoading:o[i.value].isLoading},i.title))})}const an=({imgUrl:t,value:o,title:s,url:i,tooltip:r,isLoading:a,onClick:n})=>(De(),e.jsxs(k,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(k,{gap:"12px",children:[e.jsx(it,{w:"36px",h:"36px",src:t}),e.jsxs(R,{gap:"2px",align:"flex-start",children:[e.jsx(ee,{h:"24px",isLoaded:!a,children:e.jsx(h,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})}),e.jsxs(k,{gap:"4px",children:[e.jsx(h,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),r&&e.jsx(re,{tooltip:r,children:e.jsx(G,{children:e.jsx(N,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(J,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(N,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function ln({tabList:t,activeTab:o,tabData:s,onClickTab:i}){return e.jsx(k,{w:"100%",mt:"12px",gap:"12px",children:t.map(r=>{var a,n;return e.jsxs(Q,{w:"25%",p:"27px 16px",bgImage:o===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:o===r.value?"primary":"border",onClick:()=>i(r.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(R,{align:"flex-start",gap:"10px",children:[e.jsx(h,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(k,{h:"22px",children:e.jsx(we,{size:"l",children:e.jsx(re,{placement:"top",tooltip:e.jsx(h,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:r.tooltip}),showTooltip:r.showTooltip,children:e.jsx(J,{as:"button",children:e.jsx(ee,{isLoaded:!((a=s[r.value])!=null&&a.isLoading),children:e.jsx(h,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(n=s[r.value])==null?void 0:n.totalValue})})})})})})]}),e.jsx(it,{w:"38px",h:"38px",src:r.activeImgUrl,opacity:o===r.value?"0.8":"0.4"})]},r.value)})})}function Qe(t){const{isApp:o}=$();return o?e.jsx(on,{...t}):e.jsx(ln,{...t})}const rn=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),ve=rt(rn);function ft(){const{currentAccount:t}=M(),{fetchAccountBalance:o}=Ss(),{coinHoldingList:s,setCoinHoldingList:i,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:a,setHoldingsTotalUsd:n,isCoinPriceLoading:l,setUnknownCoinCount:c}=ve(),{getTokenListInfo:p}=xt(),{getTokenPrice:x}=ce(),{refreshCoinPriceInfo:d}=ze(),f=u.useRef(t==null?void 0:t.address);u.useEffect(()=>{f.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const b=async()=>{const g=f.current;if(g){r(!0);const w=await o(g,!0);if(w){const v=await p(w.filter(S=>z(S.totalBalance).gt(0)).map(S=>S.coinType));if(!v)throw r(!1),i([]),new Error("get token list info error");const L=[];let C=0;return w.forEach(S=>{const A=v.get(S.coinType);if(A){const y=S.totalBalance,T=le(y,A.decimals).toString(),O=se(T,void 0,void 0,St.ROUND_DOWN).toString(),_={balance:y,balance_format:T,balance_display:O,balance_usd:void 0,coin:A,coin_type:A==null?void 0:A.coin_type,price:"",price_diff_24:""};L.push(_),A.is_verified||C++}}),P(L),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",g),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",f.current),g===f.current&&(i(L),c(C),j([...L])),r(!1),L}}else r(!1),i([]);return[]},j=async g=>{a(!0);try{await d(g.filter(w=>w.coin.is_verified).map(w=>w.coin.coin_type),!0)}catch(w){console.error("fetch coin price info error",w)}finally{a(!1)}},P=g=>{g.map(w=>{const{coin:v}=w;if(v.is_verified){const L=x(v.coin_type);L&&(w.price=L.price,w.price_diff_24=L.price_change||"",w.balance_usd=z(w.balance_format).mul(L.price).toString())}})},D=async g=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:g,coinHoldingList:s,currentAccount:t}),t){const{search:w,current_sort:v,current_sort_order:L,is_show_unknown:C=!1,is_hide_small_balance:S=!0}=g;let A=[];if(C?A.push(...s):A=s.filter(y=>y.coin.is_verified),w){const y=w.toLowerCase();A=A.filter(T=>T.coin.coin_type.toLowerCase().includes(y)||T.coin.symbol.toLowerCase().includes(y)||T.coin.name.toLowerCase().includes(y))}return P(A),S&&!l&&(A=A.filter(y=>y.balance_usd===void 0||z(y.balance_usd).gt(.01))),A.sort((y,T)=>{if(v==="balance"){const O=z(y.balance_format).cmp(z(T.balance_format));if(O!==0)return L==="desc"?-O:O}if(v==="value"){const O=z(y.balance_usd).cmp(z(T.balance_usd));return O!==0?L==="desc"?-O:O:z(T.balance_format).cmp(z(y.balance_format))}if(v==="price"){const O=z(y.price||"0").cmp(z(T.price||"0"));return O!==0?L==="desc"?-O:O:z(T.balance_format).cmp(z(y.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",A),A}return[]};return u.useEffect(()=>{P(s);const g=s.reduce((w,v)=>w+Number(v.balance_usd||0),0);n(g.toString())},[s,l]),{getFilterCoinHoldingList:D,fetchCoinHoldingList:b,resetUserData:()=>{i([]),n("0"),c(0)}}}function cn({inputValue:t,changeInputValue:o}){const s=u.useRef(null),[i,r]=u.useState(!1);return $(),e.jsxs(mt,{w:i?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(jt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:a=>{var n;(n=s.current)==null||n.focus(),r(!0)}})}),e.jsx(bt,{bg:"background",ref:s,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:a=>{o(a.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{o(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:i?"28px":"8px",pl:i?"28px":"8px"}),t?e.jsx(wt,{right:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_close",onMouseDown:a=>a.preventDefault(),onClick:a=>{o(""),setTimeout(()=>{var n;(n=s.current)==null||n.focus()},0)}})}):null]})}function dn({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:i,isHideLowAsset:r,handleIsHideLowAsset:a,unknownCoinCount:n}){return $(),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(h,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(k,{children:[e.jsx(cn,{inputValue:t,changeInputValue:o}),e.jsx(Q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(k,{h:"100%",justify:"space-between",children:[e.jsxs(h,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",n,")"]}),e.jsx(We,{isChecked:s,onChange:i})]})}),e.jsx(Q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(k,{h:"100%",justify:"space-between",children:[e.jsx(h,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(We,{isChecked:r,onChange:a})]})})]})]})}function un(){const{isApp:t}=$(),{getFilterCoinHoldingList:o}=ft(),{isCoinHoldingLoading:s,isCoinPriceLoading:i,unknownCoinCount:r}=ve(),{isAutoRefresh:a}=q(),[n,l]=u.useState([]),[c,p]=u.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[x,d]=u.useState(!1),[f,b]=u.useState(!0),[j,P]=u.useState("desc"),[D,E]=u.useState(Ae[2]),g=m=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",m),a||_(1),p(m),o(m).then(l)},w=m=>{g({...c,search:m})},v=m=>{const V=(m==null?void 0:m.value)===(D==null?void 0:D.value),X=t||!V?"desc":j==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",X,m),E(m),P(X),g({...c,current_sort:m.value,current_sort_order:X})};u.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,i,n),!s&&!i&&g(c)},[s,i]);const L=De(),C=m=>{L(`/swap/${m}/''`)},[S,A]=u.useState([]),[y,T]=u.useState(0),[O,_]=u.useState(1),B=10;u.useEffect(()=>{if((n==null?void 0:n.length)>0){const m=(O-1)*B;(n==null?void 0:n.length)<=m&&_(1)}},[n]),u.useEffect(()=>{if((n==null?void 0:n.length)>0){T(n==null?void 0:n.length);const m=(O-1)*B,V=m+B;console.log("ðŸš€ ~ useEffect ~ start:",O,n.slice(0,V),m,V),(n==null?void 0:n.length)>m&&A(n.slice(m,V))}else A([])},[O,n]);const U=(m,V)=>{m==="is_show_unknown"&&d(V),m==="is_hide_small_balance"&&b(V)},F=m=>{U("is_show_unknown",m.target.checked),m.target.checked||g({...c,is_show_unknown:!1}),m.target.checked&&!x&&(U("is_hide_small_balance",!1),g({...c,is_show_unknown:!0,is_hide_small_balance:!1}))},H=m=>{U("is_hide_small_balance",m.target.checked),g({...c,is_hide_small_balance:m.target.checked})};return e.jsx(Q,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(dn,{unknownCoinCount:r,inputValue:c.search||"",changeInputValue:w,isShowUnknownCoin:x,handleIsShowUnknownCoin:F,isHideLowAsset:f,handleIsHideLowAsset:H}),e.jsx(G,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(!s&&!i||a)&&(n==null?void 0:n.length)===0?e.jsx(Y,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(R,{w:"100%",gap:"4px",children:[e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(h,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Fs,{sortText:"Sort by",minW:"180px",currentSort:D,sortByList:Ae,onSortByChange:v,xlinkHref:j==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>P(m=>m==="desc"?"asc":"desc")})]}),e.jsx(ye,{rowKey:"coin_type",columns:Ye(j,D,v,C,!a&&i),dataSource:S,loading:!a&&(s||i),itemSkeletonLength:5,itemHeight:"30px",onRowClick:m=>{C(m==null?void 0:m.coin_type)}})]}):e.jsx(Ce,{rowKey:"coin_type",columns:Ye(j,D,v,C,!a&&i),dataSource:S,skeletonLength:5,loading:!a&&(s||i),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:m=>{C(m==null?void 0:m.coin_type)}}),(n==null?void 0:n.length)>B&&e.jsx(J,{children:e.jsx(_e,{total:y,size:B,currentPage:O,onChange:m=>{_(m)}})})]})]})})}const Ae=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Pe=Object.fromEntries(Ae.map(t=>[t.value,t])),Ye=(t,o,s,i,r)=>[{title:e.jsx(h,{children:"Token"}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:a})=>e.jsx(gt,{haveTooltip:!0,token:a,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(ke,{labelInfo:Pe.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"25%"},render:({coin:a,balance_display:n})=>e.jsx(k,{justify:"flex-end",children:e.jsx(we,{children:e.jsxs(h,{color:"text_caption",children:[n," ",Tt(a==null?void 0:a.symbol,10)]})})})},{title:e.jsx(ke,{labelInfo:Pe.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"25%"},render:({price:a,price_diff_24:n})=>{const l=z(n).gt(0);return e.jsx(k,{justify:"flex-end",children:e.jsx(ee,{isLoaded:!r,children:e.jsx(k,{gap:"2px",children:a===void 0?e.jsx(h,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{color:"text_caption",children:["$",ct(a)]}),e.jsxs(h,{color:Number(n)===0?"text_caption":l?"primary_green":"primary_red",children:["(",l?"+":z(n).gt(-1e-4)&&z(n).lt(0)?"-":"",z(n).gt(-1e-4)&&z(n).lt(1e-4)?"0%":kt(z(n).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(ke,{labelInfo:Pe.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:a})=>e.jsx(k,{justify:"flex-end",children:e.jsx(ee,{isLoaded:!r,children:e.jsx(we,{children:e.jsx(h,{color:"text_caption",children:ae(a,2)})})})})},{title:e.jsx(h,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:a=>e.jsx(W,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{i(a==null?void 0:a.coin_type)},children:"Swap"})}],pn=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),Se=rt(pn),xn={cetus:{title:"CETUS Holdings",imgUrl:K.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:K.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function Ve({type:t,amount:o,amountUSD:s,isLoading:i,children:r}){const{title:a,imgUrl:n,bgUrl:l}=xn[t];return e.jsx(Q,{flex:"1",bg:`center / cover no-repeat url(${l})`,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(R,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(k,{children:[e.jsx(Le,{imageUrl:n,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(h,{children:a})]}),e.jsxs(k,{w:"100%",justify:"space-between",children:[e.jsx(we,{children:e.jsxs(R,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(ee,{isLoaded:!i,h:"24px",children:e.jsx(h,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:o})}),s!==void 0&&e.jsx(ee,{isLoaded:!i,h:"17px",children:e.jsxs(h,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ct(s,2)]})})]})}),r]})]})})}function gn(){const{currentAccount:t}=M(),{balanceInfo:o}=zs(K.cetus_coin),{getTokenAmountValue:s}=ce(),{coinPriceObj:i}=He(),r=u.useMemo(()=>s(K.cetus_coin.coin_type,le((o==null?void 0:o.balance)||"0",K.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,i]),{setCurrentXCetusTab:a,setIsXCetusModalOpen:n}=Se(),l=()=>{n(!0),a("Get xCETUS")},{veNFT:c,veNFTLoading:p,lockCetusListLoading:x}=Z();return e.jsx(Ve,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:r,isLoading:(x||p)&&c!==void 0,children:e.jsx(W,{onClick:l,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Convert to xCETUS"})})}function hn(){const{lockCetusList:t,lockCetusListLoading:o}=Z(),[s,i]=u.useState([]),[r,a]=u.useState(0),[n,l]=u.useState(1),c=10;return u.useEffect(()=>{if((t==null?void 0:t.length)>0){const p=(n-1)*c;(t==null?void 0:t.length)<=p&&l(1)}},[t]),u.useEffect(()=>{if((t==null?void 0:t.length)>0){a(t==null?void 0:t.length);const p=(n-1)*c,x=p+c;console.log("ðŸš€ ~ useEffect ~ start:",n,t.slice(0,x),p,x),(t==null?void 0:t.length)>p&&i(t.slice(p,x))}},[n,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(yt,{orientation:"horizontal"}),e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(h,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(R,{w:"100%",gap:"12px",children:s==null?void 0:s.map(p=>e.jsx(fn,{order:p},p==null?void 0:p.id))}),(t==null?void 0:t.length)>c&&e.jsx(J,{w:"100%",children:e.jsx(_e,{total:r,size:c,currentPage:n,onChange:p=>{l(p)}})})]})]})}const fn=({order:t})=>{const[o,s]=u.useState(!pe.isLocked(t));u.useEffect(()=>{s(!pe.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:i,handleCancelOrder:r}=Ts(),{claimOrderLoading:a,handleClaimOrder:n}=ks(),{days:l,hours:c,minutes:p,seconds:x}=Ps(t.locked_until_time*1e3,()=>{s(!0)},"days"),d=f=>{f?n(t.id):r(t)};return e.jsxs(k,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",bg:"bg_nine",borderRadius:"12px",children:[o?e.jsxs(k,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(h,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(k,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(G,{as:"div",children:[e.jsxs(h,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(h,{as:"span",color:"text_caption",fontSize:"13px",children:[l,"d : ",c,"h : ",p,"m : ",x,"s"]})]})]}),e.jsxs(k,{gap:"12px",children:[e.jsx(Ls,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(W,{onClick:()=>{i||a||d(o)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:i||a,color:o?"background":"primary_gray",bg:o?"primary":"card_bg",_hover:{bg:o?"primary_hover":"button_ghost_hov_bg",color:o?"background":"text_caption"},children:o?"Claim":"Cancel"})]})]})};function mn({totalRewardValue:t,rewardList:o,summaryRewardList:s}){const{currentAccount:i}=M(),{veNFTLoading:r}=Z(),{claimRewardLoading:a,handleClaimReward:n}=Os(),l=()=>{a||n(o)};return $(),e.jsx(Ve,{type:"rewards",amount:i?e.jsx(re,{tooltip:e.jsx(R,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(c=>(console.log("ðŸš€ ~ {yieldList?.map ~ item:",c),e.jsxs(k,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(gt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(k,{gap:"4px",children:[e.jsx(h,{fontSize:"12px",color:"text_caption",children:se(c==null?void 0:c.amount,6)}),e.jsxs(h,{fontSize:"12px",children:["(",ae(c==null?void 0:c.value,2),")"]})]})]},c.coin_type)))}),children:e.jsx(h,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:ae(t,2)})}):"--",isLoading:r,children:s.length>0&&e.jsx(W,{onClick:l,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Claim"})})}function jn({availableXCetusAmount:t}){const{currentAccount:o}=M(),{veNFT:s,veNFTLoading:i,lockCetusListLoading:r}=Z(),{getTokenAmountValue:a}=ce(),{coinPriceObj:n}=He(),l=u.useMemo(()=>a(K.cetus_coin.coin_type,le(t||"0",K.x_cetus_coin.decimals)).toString(),[t,o==null?void 0:o.address,n]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:p}=Se(),x=()=>{p(!0),c("Redeem CETUS")},d=(r||i)&&s!==void 0;return e.jsx(Ve,{type:"xcetus",amount:o?se(le(t||"0",9),9).toString():"--",amountUSD:l,isLoading:d,children:e.jsx(W,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Redeem"})})}const fe=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function bn({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:i,setCurrentXCetusTab:r}=Se(),[a,n]=u.useState("#icon-a-icon_trade"),l=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},p=()=>{var d;const x=(d=fe==null?void 0:fe.find(f=>(f==null?void 0:f.value)!==i))==null?void 0:d.value;x&&r(x)};return e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{children:[e.jsx(st,{p:"0 16px",children:e.jsx(G,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(xe,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:fe,currentTab:i,handleChangeTab:x=>{r(x==null?void 0:x.value)}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"20px 16px 16px",children:[i==="Get xCETUS"&&e.jsx(As,{onClose:o,availableXCetusAmount:s,onIconClick:p,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}}),i==="Redeem CETUS"&&e.jsx(Rs,{onClose:o,availableXCetusAmount:le(s,9),onIconClick:p,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}})]})]})]})}function wn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=Se(),{availableXCetusAmount:s,totalRewardValue:i,rewardList:r,summaryRewardList:a}=Ds();return e.jsx(Q,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",gap:"16px",children:[e.jsxs(k,{w:"100%",gap:"10px",children:[e.jsx(jn,{availableXCetusAmount:s}),e.jsx(gn,{}),e.jsx(mn,{totalRewardValue:i,rewardList:r,summaryRewardList:a})]}),e.jsx(hn,{}),t&&e.jsx(bn,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})})}function yn(){const{currentAccount:t}=M(),{orderListLoading:o,myOrderList:s}=ge(),{isAutoRefresh:i,dcaOrderListLoading:r,dcaActiveOrderList:a}=q(),{getTokenAmountValue:n,coinPriceObj:l}=ce(),c=u.useMemo(()=>{let d=z(0);if(i||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(f=>{const{pay_coin:b,target_coin:j,un_claimed_amount:P,remaining_amount:D}=f,E=n(b.coin_type,D),g=n(j.coin_type,P);d=z(d).plus(E).plus(g),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",d.toString())}),d.toString()):"0"},[i,s,t==null?void 0:t.address,o,l]),p=u.useMemo(()=>{let d=z(0);if(i||!r)return(a==null?void 0:a.length)>0&&(t!=null&&t.address)?(a.forEach(f=>{const{inBalance:b,inCoin:j,outBalance:P,outCoin:D}=f,E=n(j.coin_type,b),g=n(D.coin_type,P);d=z(d).plus(E).plus(g),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",d.toString())}),d):"0"},[i,a,t==null?void 0:t.address,r,l]),x=u.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",p,c),p&&c){let d=z(0);return d=z(d).plus(p).plus(c),d.toString()}return"--"},[p,c]);return{limitTotalTvl:c,dcaTotalTvl:p,orderTotalTvl:x}}function Cn(){const{currentAccount:t}=M(),{vaultsPositionLoading:o,vaultsPositionObj:s}=de(),{getTokenAmountValue:i}=ce(),{getTokenAmountValueByPyth:r}=Gt();return{vaultsTotalTvl:u.useMemo(()=>{let n=Oe(0);return o||Object.values(s).forEach(l=>{const{category:c,displayCoinTypeA:p,displayAmountA:x,displayCoinTypeB:d,displayAmountB:f}=l,b=c=="haedal"?r(p,x):i(p,x),j=c=="haedal"?r(d,f):i(d,f),P=Oe(b).plus(j||0);n=n.add(P)}),n.toString()},[s,o,t==null?void 0:t.address])}}function _n(){const{currentAccount:t}=M(),{isAutoRefresh:o}=q(),{veNFT:s,veNFTLoading:i,lockCetusListLoading:r}=Z(),{getTokenAmountValue:a}=ce(),{coinPriceObj:n}=He();return{xCetusTotalTvl:u.useMemo(()=>{if(o||!i&&!r)return t!=null&&t.address&&s?a(K.cetus_coin.coin_type,le(s==null?void 0:s.xcetus_balance,K.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,r,i,t==null?void 0:t.address,n])}}const vn="fetch-coin-holding-list",Sn="fetch-owner-nft",Tn="fetch-active-order-list",kn="fetch-xcetus-base-info",Pn="fetch-vaults-position-list";function Ln(){const{currentAccount:t}=M(),{getTokenListInfo:o}=xt(),{getLimitUserIndexer:s,getDcaUserIndexer:i}=Hs(),{setOrderListLoading:r,setMyOrderList:a}=ge(),{setDcaOrderListLoading:n,setDcaActiveOrderList:l,setDcaPastOrderList:c}=q(),{refreshCoinPriceInfo:p}=ze(),{buildDcaOrderList:x}=ps(),d=ne("limit"),f=ne("dca"),{formatLimitOrderList:b}=Cs(),j=u.useRef(t==null?void 0:t.address);u.useEffect(()=>{j.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const P=async()=>{if(t){r(!0);const w=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",w),w)try{return(await d.FullClient.getDynamicFieldsByPage(w)).data.map(C=>C.name.value)}catch(v){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",v)}}return[]},D=async()=>{if(t){n(!0);const w=await i(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",w),w)try{return(await f.FullClient.getDynamicFieldsByPage(w)).data.map(C=>C.name.value)}catch(v){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",v)}}return[]};return{fetchActiveOrderList:async()=>{try{const w=await P(),v=await D(),L=await d.FullClient.batchGetObjects([...w,...v],{showType:!0,showContent:!0}),C=L.filter(F=>{var H,m;return(m=(H=F.data)==null?void 0:H.type)==null?void 0:m.includes("limit_order::LimitOrder")}),S=L.filter(F=>{var H,m;return(m=(H=F.data)==null?void 0:H.type)==null?void 0:m.includes("order::Order")}),y=C.map(F=>Pt.buildLimitOrderInfo(F)).filter(F=>F!==void 0).filter(F=>F.status===$e.PartialCompleted||F.status===$e.Running),T=S.map(F=>{var X,ue,ie,he,Be,Ue,Me,Ne;const H=je(((X=F.data)==null?void 0:X.type)||""),m=H.type_arguments[0],V=H.type_arguments[1];return{in_coin_type:m,out_coin_type:V,...(ie=(ue=F.data)==null?void 0:ue.content)==null?void 0:ie.fields,id:(Me=(Ue=(Be=(he=F.data)==null?void 0:he.content)==null?void 0:Be.fields)==null?void 0:Ue.id)==null?void 0:Me.id,version:(Ne=F.data)==null?void 0:Ne.version}}),O=new Set;for(const F of y)O.add(F.pay_coin_type),O.add(F.target_coin_type);for(const F of T)O.add(F.in_coin_type),O.add(F.out_coin_type);await o(Array.from(O));const _=await b(y);a(_);const{activeResult:B,pastResult:U}=await x(T);j.current===(t==null?void 0:t.address)&&(l(B),c(U),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",_),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",T)),p(Array.from(O))}catch(w){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",w)}finally{r(!1),n(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),a([]),l([]),c([])}}}function On(){const{currentAccount:t}=M(),o=ne("clmm"),s=ne("xcetus"),{buildFarmsPositionType:i,buildBurnPositionType:r}=Bt(),{setPosBaseList:a,setFullRangePosBaseList:n,setPosBaseListLoading:l}=oe(),{setVeNFT:c,setVeNFTLoading:p,setLockCetusList:x,clearData:d,setLockCetusListLoading:f,setAvailableXCetusAmount:b}=Z(),{formatPosBaseList:j}=dt(),P=u.useRef(t==null?void 0:t.address);return u.useEffect(()=>{P.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const g=P.current;if(g){l(!0),p(!0);const w=await o.FullClient.getOwnedObjectsByPage(g,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:Lt.clmm_pool.package_id},{StructType:i},{StructType:r},{StructType:Es},{StructType:Vs}]}});let v=await j(w);a(v),l(!1),(v==null?void 0:v.length)==0&&n([]);const L=Bs(w.data);if(L&&g===P.current){c(L,g);const C=await Us(w.data,s);C.sort((S,A)=>S.locked_until_time-A.locked_until_time),console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:C,veNFT:L,availableXCetusAmount:pe.getAvailableXCetus(L,C)}),x(C),b(pe.getAvailableXCetus(L,C))}else f(!1);return{veNFT:L,posBaseList:v}}}catch(g){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",g),g instanceof TypeError&&(l(!1),a([]))}finally{l(!1),f(!1),p(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{a([]),d()}}}function An(){const{currentAccount:t}=M(),o=ne("farms"),s=ne("clmm");dt();const{getPosPoolsOriginalObj:i,getPosPoolsRelatedData:r}=Ut(),{getPosLiquidityData:a}=Mt(),{setPosLiquidityData:n,setFarmsPosRewardsData:l,setFarmsPosRewardsDataLoading:c,setPosRewardsData:p,setPosRewardsDataLoading:x,setPosFeeData:d,setPosFeeDataLoading:f}=oe(),{formatFarmsRewardsData:b}=Nt(),{formatPosRewardsData:j}=Wt(),{formatPosFeeData:P}=Xt(),{posBaseList:D,setShowPosListLength:E,setMyPosYieldValue:g}=oe(),{refreshCoinPriceInfo:w}=ze(),v=async S=>{var O;const A=S.filter(_=>_.posType==="farms"&&_.farmsPool),y=await i(S);if(r(S,y),((O=Object.keys(y))==null?void 0:O.length)===0)throw n({}),new Error("No pool data found");a(S,y);const T=new Ot;A.length>0&&A.forEach(_=>{o.Farms.buildCalculateFarmingReward({pool_id:_.farmsPool,position_nft_id:_.id},T)}),S.forEach(_=>{s.Position.buildFetchPosFee({pool_id:_.clmmPool,position_id:_.posId,coin_type_a:_.coinTypeA,coin_type_b:_.coinTypeB},T)}),S.filter(_=>_.posType!=="farms").forEach(_=>{var U;const B=y[_.clmmPool];s.Rewarder.buildFetchPosReward({pool_id:_.clmmPool,position_id:_.posId,coin_type_a:_.coinTypeA,coin_type_b:_.coinTypeB,rewarder_types:(U=B.rewarder_infos)==null?void 0:U.map(F=>F.coinAddress)},T)});try{c(!0),x(!0),f(!0);const _=await s.FullClient.devInspectTransactionBlock({transactionBlock:T,sender:At("0x0")}),B=o.Farms.parsedPosRewardData(_),U=s.Rewarder.parsedPosRewardData(_),F=s.Position.parsedPosFeeData(_);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:B,clmmRewardData:U,clmmFeeData:F});const H=await b(B);l(H);const m=await j(Object.values(U).map(X=>{const ue=y[S.find(ie=>ie.posId===X.position_id).clmmPool];return{poolAddress:ue.pool_address,positionId:X.position_id,rewarderAmountOwed:X.rewarder_amount.map((ie,he)=>({coin_address:ue.rewarder_infos[he].coinAddress,amount_owed:new Rt(ie)}))}}));p(m);const V=await P(Object.values(F).map(X=>({position_id:X.position_id,fee_owned_a:X.fee_owned_a,fee_owned_b:X.fee_owned_b})),S);d(V),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:V,posRewardsData:m,posFarmsRewardsObj:H}),L(S,m,H)}catch(_){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",_)}finally{c(!1),x(!1),f(!1)}},L=async(S,A,y)=>{console.log("ðŸš€ ~ fetchTokenPrice ~ posRewardsData:",S,A);const T=[];if(S.length>0){S.map(_=>{T.push(je(_==null?void 0:_.coinTypeA).full_address),T.push(je(_==null?void 0:_.coinTypeB).full_address);const B=A[_==null?void 0:_.posId]||[],U=y[_==null?void 0:_.id]||[],F=B.concat(U);F==null||F.map(H=>{var m;Oe(H==null?void 0:H.display_amount_owed).gt(0)&&T.push(je((m=H==null?void 0:H.token)==null?void 0:m.coin_type).full_address)})}),console.log("ðŸš€ ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(T)));const O=Array.from(new Set(T));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",O),w(O)}};return{fetchPosRelatedData:v,resetUserData:()=>{n({}),l({}),p({}),d({})}}}function Rn(){const{getVaultsTokenList:t,getVaultsLpTokenList:o}=Fe(),{getVaultsContractInfo:s}=qt(),{getVaultsPosition:i}=Kt(),{setVaultsPositionLoading:r,clearVaultsPositionObj:a}=de(),{getVaultPoolList:n}=Qt();return{fetchVaultsPositionList:async()=>{console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:"),r(!0);const p=await n();console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:",p),t(p),o(p);const{lstVaultContractInfoObj:x,haedalVaultContractInfoObj:d,allClmmPoolContractInfoObj:f}=await s(p);i(p,x,d,f)},resetUserData:()=>{a()}}}function Dn(){const{currentAccount:t}=M(),{setXCetusManager:o,setDividendManager:s}=Z(),i=ne("xcetus");return{fetchXCetusBaseInfo:async a=>{try{const{xcetus:n,xcetus_dividends:l}=Dt,{dividend_manager_id:c}=Ge(l),{xcetus_manager_id:p}=Ge(n),x=await i.FullClient.batchGetObjects([p,c],{showType:!0,showContent:!0}),d=x.find(b=>{var j,P;return(P=(j=b.data)==null?void 0:j.type)==null?void 0:P.includes("xcetus::XcetusManager")});if(d){const b=qe(d),j={id:b.id.id,index:Number(b.index),has_venft:{handle:b.has_venft.fields.id.id,size:b.has_venft.fields.size},nfts:{handle:b.nfts.fields.id.id,size:b.nfts.fields.size},total_locked:b.total_locked,treasury:b.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",j),o(j)}const f=x.find(b=>{var j,P;return(P=(j=b.data)==null?void 0:j.type)==null?void 0:P.includes("dividend::DividendManager")});if(f){const b=qe(f),j=pe.buildDividendManager(b);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",j),i.updateCache(`${c}_getDividendManager`,j),s(j)}}catch(n){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",n)}}}}function Hn(t){const{currentAccount:o}=M(),{fetchCoinHoldingList:s,resetUserData:i}=ft(),{fetchPosRelatedData:r,resetUserData:a}=An(),{fetchActiveOrderList:n,resetUserData:l}=Ln(),{fetchVaultsPositionList:c,resetUserData:p}=Rn(),{setAutoRefreshCount:x}=q(),{fetchOwnerNFT:d,resetUserData:f}=On(),{fetchXCetusBaseInfo:b}=Dn(),{addTask:j,removeTask:P}=Ms(),[D,E]=u.useState([]),g=u.useRef(o),{setOrderListLoading:w}=ge(),{setLockCetusListLoading:v}=Z(),{setPosBaseListLoading:L}=oe(),{setIsCoinHoldingLoading:C}=ve(),{setVaultsPositionLoading:S}=de(),A=()=>{i(),a(),l(),f(),p()};u.useEffect(()=>{var H,m;o?((H=g.current)!=null&&H.address&&((m=g.current)==null?void 0:m.address)!==(o==null?void 0:o.address)&&(x(!1),A(),D.forEach(V=>{P(V.id)})),U()):(A(),D.forEach(V=>{P(V.id)})),g.current=o},[o==null?void 0:o.address]);const y={id:vn,run:s},T={id:Sn,run:d,onSuccess:H=>{const{posBaseList:m}=H;r(m)}},O={id:kn,run:b},_={id:Tn,run:n},B={id:Pn,run:c},U=()=>{const H=[];w(!0),v(!0),L(!0),C(!0),S(!0),t==="wallet"?H.push(y,T,B,_,O):t==="liquidity"?H.push(T,B,y,_,O):t==="orders"?H.push(_,y,T,B,O):H.push(T,B,O,y,_),E(H),H.forEach(m=>{j(m)})};return{refreshTask:()=>{o&&(D.forEach(H=>{P(H.id)}),U())}}}const me=t=>t?ae(t,2):"$--",Fn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),z(0)).toString();function oi(){const{tab:t}=ss(),{currentAccount:o,onWalletModal:s}=M(),i=De(),{posBaseListLoading:r,posLiquidityDataLoading:a}=oe(),{holdingsTotalUsd:n,isCoinPriceLoading:l,isCoinHoldingLoading:c}=ve(),{liquidityTotalTvl:p}=It(),{orderTotalTvl:x}=yn(),{orderListLoading:d}=ge(),{isAutoRefresh:f,dcaOrderListLoading:b,setAutoRefreshCount:j,resetAutoRefreshCount:P}=q(),{xCetusTotalTvl:D}=_n(),{vaultsTotalTvl:E}=Cn();console.log("ðŸš€ðŸš€ðŸš€ ~ Profile.tsx:47 ~ ProfilePage ~ vaultsTotalTvl:",E);const{vaultsPositionLoading:g}=de(),{lockCetusListLoading:w,veNFTLoading:v,veNFT:L}=Z(),C=u.useMemo(()=>t,[t]),{refreshTask:S}=Hn(C),A=!f&&(c||l),y=!f&&(r||a||l||g),T=!f&&(d||b||l),O=!f&&(w||v||l),_=u.useMemo(()=>({wallet:{totalValue:me(n),isLoading:A},liquidity:{totalValue:me(p),isLoading:y},orders:{totalValue:me(x),isLoading:T},xCetus:{totalValue:me(D),isLoading:O}}),[n,p,x,D,A,y,T,O,E]),B=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],U=u.useMemo(()=>Fn(D,p,x,n),[D,p,x,n]);u.useEffect(()=>P(!1),[]);const[F,H]=u.useState(!1);u.useEffect(()=>{H(!0)},[]);const{isApp:m}=$();return m?e.jsx(Ns,{totalValue:U,onRefreshTask:S,isLoading:!f&&(v||r||d||b),children:e.jsx(Qe,{tabList:B,activeTab:C,tabData:_,onClickTab:V=>i(`/profile?tab=${V}`)})}):e.jsx(R,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:F?o!=null&&o.address?e.jsxs(R,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(nn,{handleRefresh:V=>{j(!V),S()},totalValue:U,isLoading:!f&&(v||r||d||b)}),e.jsx(Qe,{tabList:B,activeTab:C,tabData:_,onClickTab:V=>i(`/profile?tab=${V}`)}),C==="wallet"&&e.jsx(un,{}),C==="liquidity"&&e.jsx(qs,{}),C==="orders"&&e.jsx(sn,{}),C==="xCetus"&&e.jsx(wn,{})]}):e.jsx(Y,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>s(!0)}):e.jsx(Ze,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Re,{})})})}export{oi as default};
//# sourceMappingURL=Profile-D1VkVPBg.js.map

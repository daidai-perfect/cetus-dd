import{a as p,D as Ke,j as e,V as E,F as Ye,aa as Oe,H as v,T as g,C as Q,u as I,f as W,v as X,X as Ie,Y as Qe,Z as Ze,$ as Je,a0 as et,a1 as tt,ab as Ae,I as st,N as mt,O as bt,Q as wt,ar as Me,ag as Pe}from"./vendor-DXHkIl66.js";import{u as nt}from"./global-BGM_JGXL.js";import{j as U,F as ae,I as M,O as oe,aU as Ct,i as je,e as ot,q as Xe,d as B,aV as fe,B as G,v as Y,c as Re,a as N,G as yt,z as ee,R as it,n as ce,M as te,p as _t,X as St,f as at,w as $,m as He,as as Z,aW as vt,ar as lt,am as Tt,k as me,aX as kt,aY as $e,Q as he,V as rt,aR as Lt,al as Pt,aI as Se,a0 as Rt,aZ as We,a_ as Ne}from"./index-6SCcgYCo.js";import{N as se}from"./NoData-CqJO7NcS.js";import{u as Dt,A as Ot,R as At}from"./RecentTransactions-C_Ieu0ZR.js";import{A as Ht}from"./AccountSwitchDrawer-BAwWqUgt.js";import{u as ct,D as dt,g as Et,e as zt,f as Ft,W as Bt,b as Ut,R as Mt,a as Xt,d as $t}from"./OverviewOrders-Btc7PDfz.js";import{I as ve}from"./IconText-Ca84nFiX.js";import{u as Wt}from"./RangeValue-Ss3qiXX0.js";import{H as K}from"./HTextLabelBox-xcnODRJZ.js";import{u as J}from"./activeOrders-DfzNP8l2.js";import{H as Ee,T as be}from"./Table-Bntheo_i.js";import{P as we}from"./Pagination-uSv8bjPo.js";import{b as Nt,u as de,c as Vt,C as Gt,P as qt,F as Kt,E as Yt,S as It,O as Qt,a as Zt}from"./useGetLimitOrderHistory-Dgejhbx_.js";import{u as Jt}from"./useRpcListener-CuE-zOjB.js";import{R as es}from"./RefreshButton-COqCzIun.js";import{a as ie,d as ts,u as pt,e as ss,f as ns,g as os,c as is,b as as}from"./usePositionList-DlEKPUwf.js";import{P as ls,a as rs,b as cs,u as ds}from"./PoolItem-0aB5mFvX.js";import{P as ps,u as xs}from"./PositionListLoading-Cdavjrpo.js";import{u as us}from"./useAccountBalance-Uh8Ya-Fn.js";import{u as xt}from"./useToken-D1jN84rx.js";import{f as ze,X as gs,a as hs,b as fs,u as js,c as ms,E as bs,C as ws,e as Cs,d as ys,g as _s}from"./useXCetus-CqvMERNG.js";import{S as ut}from"./SingleTokenInfo-OPtPhuNX.js";import{S as Ss}from"./SortDropBlock-DPh-dzVR.js";import{T as Te}from"./TableSortTh-BWqoD_ST.js";import{u as vs}from"./useTokenBalance-DJ7wgCGX.js";import{X as Ts,a as ks,b as Ls,c as Ps,u as Rs}from"./useXCetusHelper-DpWrRl5h.js";import"./CopyButton-B-PURlK7.js";import"./Drawer-D7NtzCa6.js";import"./useTransaction-DufWKloO.js";import"./useTrack-OU7tH1iH.js";import"./useSigner-2nCfXuGk.js";import"./ErrorTips-CrdD19ic.js";import"./usePreviousValue-BBpD8e7r.js";import"./useFavoritePool-ByIgXWRa.js";import"./useGetPoolList-BZIqv-Um.js";import"./useWrapPoolData-CRQowCn2.js";import"./CheckBox-BLFEyDiR.js";import"./SearchInputBlock-CRnGGafL.js";import"./index-DWcYicaR.js";import"./Loading-BH2b7hW0.js";import"./TooltipIcon-CzEfTakQ.js";import"./PositionCurrentPrice-BfeSJcrT.js";import"./useBurn-CInd-u5c.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-OwnHDZQ8.js";import"./PoweredByHaedal-990R--7x.js";import"./PriceRange-Yco8jozD.js";import"./PositionStatus-DFbVxoYR.js";import"./detail-DrjcdRWz.js";import"./TradeInputGroup-D2XrXVhF.js";import"./_getAllKeysIn-1vB-t5Te.js";import"./HighlightText-BLaAjUt8.js";import"./index-CptRizr3.js";import"./debounce-BgSgg6I6.js";import"./index-DKPh1ief.js";function Ds(t=100){const o=p.useRef([]),s=p.useRef(!1),a=p.useRef(void 0),l=p.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const r=o.current.shift();if(!r)continue;const{id:c,run:x,onStart:h,onSuccess:u,onError:m}=r;if(r._cancelled){console.log(`[task:${r.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),h==null||h(c);const d=await x(a.current,c);a.current=d,console.log(`[task:${c}] success`,d),u==null||u(d,c)}catch(d){console.error(`[task:${c}] failed`,d),m==null||m(d,c)}await new Promise(d=>setTimeout(d,t))}s.current=!1}},[t]),i=r=>{o.current.push(r),l()},n=r=>{const c=o.current.find(x=>x.id===r);c&&(c._cancelled=!0),o.current=o.current.filter(x=>x.id!==r)};return p.useEffect(()=>()=>{o.current=[],s.current=!1,a.current=void 0},[]),{addTask:i,removeTask:n}}const gt=(t,o)=>o?t:"********";function Os({totalValue:t,onRefreshTask:o,isLoading:s,children:a}){const[l,i]=p.useState(!1),{currentAccount:n,onWalletModal:r,accounts:c,accountServiceNameObj:x}=U(),{isShowProfileAssets:h,setIsShowProfileAssets:u}=nt();p.useEffect(()=>{i(!0)},[]);const{isOpen:m,onClose:d,onToggle:w}=Ke(),{getServiceNames:y}=Dt(),A=p.useCallback(()=>{m||y(c),w(),console.log("AccountSwitch###handleClick###isOpen: ",m)},[m,c]);return console.log(n,x,c,"currentAccount-H5Main"),e.jsxs(E,{w:"100%",mt:"28px",children:[l?n!=null&&n.address?e.jsxs(E,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(v,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(v,{h:"18px",children:[e.jsx(g,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ae,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:h?"Hide Value":"Show Value"}),children:e.jsx(Q,{children:e.jsx(M,{xlinkHref:h?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>u(!h)})})})]}),e.jsxs(v,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(g,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(M,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(I,{isLoaded:!s,h:"32px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(oe(t,2),h)})}),c.length>1&&e.jsxs(v,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:A,cursor:"pointer",children:[e.jsxs(v,{children:[e.jsx(M,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(g,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[n!=null&&n.label?`${n==null?void 0:n.label} : `:"",(x==null?void 0:x[n==null?void 0:n.address])||Ct(n==null?void 0:n.address)]})]}),e.jsx(M,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),a]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>r(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Oe,{})}),e.jsx(Ht,{isOpen:m,onClose:d})]})}function Ce(t){const{type:o,children:s,wrapStyle:a={h:"60px"},textStyle:l={fontSize:"16px"}}=t,i=(n,r)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(n,r):n===r.value;return e.jsxs(v,{justify:"space-between",w:"100%",h:"60px",...a,children:["title"in t?e.jsx(g,{color:"text_caption",...l,children:t==null?void 0:t.title}):e.jsx(je,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(n,r)=>i(n,r),wrapStyle:{h:"60px",border:"none",gap:"38px",...a},itemStyle:l}),s]})}function As({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:a,outCoin:l}=t,{orderHistoryList:i,handleGetDcaOrderHistory:n,orderHistoryListLoading:r}=ct();p.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=ot(),[x,h]=p.useState(s),u=142,m=(i==null?void 0:i.length)||0,d=(i==null?void 0:i.length)<=1?`${u*m-8}px`:`${u*m+(m-1)*32-8}px`;return e.jsxs(E,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(i==null?void 0:i.length)>=3?"460px":"unset",overflowY:"auto",children:[!r&&e.jsx(W,{h:d,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),r?e.jsx(v,{h:"100px",w:"100%",justify:"center",children:e.jsx(Oe,{})}):(i==null?void 0:i.length)===0?e.jsx(se,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):i.map(w=>{const y=Xe(w.inAmount,a==null?void 0:a.decimals),A=Xe(w.outAmount,l==null?void 0:l.decimals),S=B(y).div(A).toString(),b=B(1).div(S).toString();return e.jsxs(E,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(v,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(g,{h:"20px",lineHeight:"20px",children:[fe((w==null?void 0:w.time)*1e3)," (UTC)"]}),e.jsx(M,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(w==null?void 0:w.tx,"tx"))}}),e.jsx(v,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(W,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(G,{p:"16px",borderRadius:"12px",children:e.jsxs(E,{align:"flex-start",gap:"20px",children:[e.jsxs(E,{gap:"0px",align:"flex-start",children:[e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:x?`${Y(S)} `:`${Y(b)} `}),e.jsxs(v,{children:[e.jsxs(g,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",x?` ${a.symbol} per ${l.symbol}`:` ${l.symbol} per ${a.symbol}`,")"]}),e.jsx(M,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>h(!x)})]})]}),e.jsxs(v,{w:"100%",gap:"4px",children:[e.jsx(Re,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Y(y)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${a.symbol}`}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(Re,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Y(A)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${l.symbol}`})]})]})})]},w==null?void 0:w.tx)})]})}function Hs({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:a=!1,toClaim:l}){const{inCoin:i,outCoin:n}=t;return e.jsxs(E,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(Es,{}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(dt,{orderInfo:t}),o&&l&&e.jsx(X,{isLoading:a,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(g,{fontSize:"16px",color:"text_caption",children:Et(t,o,!0)}),e.jsx(g,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(v,{w:"100%",justify:"space-around",children:[e.jsxs(E,{children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:zt(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]})]}),e.jsx(W,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(E,{children:[e.jsx(g,{color:"text_caption",fontSize:"16px",children:Ft(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(E,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(K,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(K,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(K,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${i==null?void 0:i.symbol}`}),o&&e.jsx(K,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(K,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),o&&e.jsx(K,{label:"Next Order (UTC)",value:fe(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(K,{label:"Created (UTC)",value:fe(t==null?void 0:t.createdAt)||""})]})]})}const Es=()=>{const[t,o]=p.useState(!1);return e.jsxs(E,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(v,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(g,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(M,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(E,{align:"flex-start",w:"100%",children:[e.jsx(W,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Bt,{})]})]})};function zs({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:a,isClaimLoading:l=!1,toClaim:i}){const{isApp:n}=N(),r=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,x]=p.useState("overview"),{inCoin:h,outCoin:u}=s,[m,d]=p.useState(!1),{getTokenRank:w}=Wt();return p.useEffect(()=>{const y=w(h,u);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",u,h,y),d(!y)},[h==null?void 0:h.coin_type,u==null?void 0:u.coin_type]),e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{minWidth:n?"300px":"482px",children:[e.jsx(Je,{children:e.jsx(W,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ce,{type:"tab",currentTab:c,tabs:r,onTabChange:y=>x(y.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(Hs,{orderInfo:s,isActiveOrder:a,pageDirect:m,isClaimLoading:l,toClaim:i}),c=="orders"&&e.jsx(As,{orderInfo:s,isActiveOrder:a,pageDirect:m})]})]})]})}function Fs({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=N(),[a,l]=p.useState(!1),{getExplorerUrl:i}=ot(),{isClaimLoading:n,toClaim:r,closeOrderAction:c,isCloseLoading:x}=ct();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(X,{isLoading:n,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||n,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(ae,{placement:"bottom-end",tooltip:e.jsxs(E,{align:"flex-start",children:[e.jsx(ve,{text:"View Details",onClick:()=>{l(!0)}}),e.jsx(ve,{text:"View on Explorer",onClick:()=>{window.open(i(t.orderID,"poolAddress"))}}),e.jsx(ve,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:x?()=>{}:()=>{c(t)}})]}),children:e.jsx(Q,{children:e.jsx(X,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(M,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(X,{onClick:()=>{l(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(X,{onClick:h=>{yt(h),window.open(i(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(M,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),a&&e.jsx(zs,{isOpen:a,onClose:()=>l(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:r})]})}function Bs(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:a}=J(),[l,i]=p.useState("activeDCAs"),n=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":a==null?void 0:a.length}],[o,a,s]),r=p.useMemo(()=>l=="activeDCAs"?s:a,[l,s,a]),{isApp:c}=N(),{closeAll:x,claimAll:h,isClaimAllLoading:u,isCloseAllLoading:m}=Ut(),d=p.useMemo(()=>l==="pastDCAs"||(r==null?void 0:r.length)===0?0:r==null?void 0:r.reduce((H,_)=>B(H).plus(_==null?void 0:_.outBalance),B(0)).toString(),[l,r]),[w,y]=p.useState([]),[A,S]=p.useState(0),[b,C]=p.useState(1),k=10,L=Ve(l=="activeDCAs");return p.useEffect(()=>{if((r==null?void 0:r.length)>0){const H=(b-1)*k;(r==null?void 0:r.length)<=H&&C(1)}},[r]),p.useEffect(()=>{if((r==null?void 0:r.length)>0){S(r==null?void 0:r.length);const H=(b-1)*k,_=H+k;console.log("ðŸš€ ~ useEffect ~ start:",b,r.slice(0,_),H,_),(r==null?void 0:r.length)>H&&y(r.slice(H,_))}},[b,r]),e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:n,currentTab:l,handleChangeTab:H=>i(H==null?void 0:H.value),isActive:(H,_)=>H===_.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(r==null?void 0:r.length)>1&&l=="activeDCAs"&&e.jsxs(v,{children:[e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:u,disabled:Number(d)===0||u,onClick:()=>{h(r)},children:"Claim All"}),e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:m,disabled:(r==null?void 0:r.length)==0||m,onClick:()=>{x(r)},children:"Close All"})]})]}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!o&&(r==null?void 0:r.length)===0?e.jsx(se,{type:"nodata",text:l==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(E,{w:"100%",gap:"4px",children:e.jsx(Ee,{rowKey:"orderID",columns:L,dataSource:w,loading:!t&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"orderID",columns:Ve(l=="activeDCAs"),dataSource:w,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(r==null?void 0:r.length)>k&&e.jsx(Q,{children:e.jsx(we,{total:A,size:k,currentPage:b,onChange:H=>{C(H)}})})]})]})}const Ve=t=>[{title:e.jsx(g,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(dt,{orderInfo:s})},{title:e.jsx(g,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Mt,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Xt,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(g,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(g,{color:"text_caption",children:fe(s)})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(Fs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function Us(){const{currentAccount:t}=U(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:a}=Nt(),{myOrderList:l,orderListLoading:i}=de(),{isAutoRefresh:n,autoRefreshCount:r}=J(),[c,x]=p.useState("openOrders"),h=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:!n&&i?"":l==null?void 0:l.length},{label:"Orders History",value:"ordersHistory",num:!n&&a?"":s==null?void 0:s.length}],[i,a,l,s]),u=f=>{t!=null&&t.address&&o(t.address,f)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",r),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),r>0&&u(!0)},[r]),p.useEffect(()=>{u(!0)},[c,t]);const m=p.useMemo(()=>c=="openOrders"?i:a,[c,i,a]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",l,s),c=="openOrders"?l:s),[c,l,s]);Jt({onRpcChange:()=>{u(!0)}});const{isApp:w}=N(),{handleCancelOrder:y,cancelOrderLoading:A}=Vt(),[S,b]=p.useState([]),[C,k]=p.useState(0),[L,H]=p.useState(1),_=10,P=Ms(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const f=(L-1)*_;(d==null?void 0:d.length)<=f&&H(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){k(d==null?void 0:d.length);const f=(L-1)*_,T=f+_;console.log("ðŸš€ ~ useEffect ~ start:",L,d.slice(0,T),f,T),(d==null?void 0:d.length)>f&&b(d.slice(f,T))}},[L,d]),e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:h,currentTab:c,handleChangeTab:f=>x(f==null?void 0:f.value),isActive:(f,T)=>f===T.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(v,{children:e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:A,onClick:()=>{y(l)},children:"Cancel All"})})]}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!m&&(d==null?void 0:d.length)===0?e.jsx(se,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):w?e.jsx(E,{w:"100%",gap:"4px",children:e.jsx(Ee,{rowKey:"order_id",columns:P,dataSource:S,loading:!n&&m,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"order_id",columns:P,dataSource:S,loading:!n&&m,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>_&&e.jsx(Q,{children:e.jsx(we,{total:C,size:_,currentPage:L,onChange:f=>{H(f)}})})]})]})}const Ms=t=>[{title:e.jsx(g,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(Gt,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(qt,{info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(Kt,{info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Yt,{info:s,isProfile:!0})},!t&&{title:e.jsx(g,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(It,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(Qt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function Xs(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=p.useState("limitOrders");return e.jsx(G,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{align:"flex-start",gap:"20px",children:[e.jsx(W,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ce,{type:"tab",currentTab:o,tabs:t,onTabChange:a=>s(a.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(Us,{}),o==="dca"&&e.jsx(Bs,{})]})})}function $s({handleRefresh:t,totalValue:o,isLoading:s}){var m,d;const{isApp:a}=N(),{currentAccount:l,accounts:i}=U(),{isShowProfileAssets:n,setIsShowProfileAssets:r}=nt(),[c,x]=p.useState(!1),{onClose:h}=Ke(),u=i.reduce((w,y)=>(w[y.address]=y,w),{});return e.jsxs(E,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(v,{w:"100%",children:[e.jsx(g,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ae,{showTooltip:!a,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(Q,{children:e.jsx(M,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>r(!n)})})})]}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(I,{isLoaded:!s,h:"22px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(oe(o,2),n)})}),e.jsxs(v,{children:[e.jsxs(v,{p:"0 8px",h:"36px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{x(!0)},children:[e.jsx(M,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(g,{children:"Transactions"})]}),e.jsx(es,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),i.length>1&&e.jsxs(v,{children:[((m=u==null?void 0:u[l==null?void 0:l.address])==null?void 0:m.label)&&e.jsxs(g,{color:"primary_gray",children:[(d=u==null?void 0:u[l==null?void 0:l.address])==null?void 0:d.label," :"]}),e.jsx(Ot,{currentAccount:l,accounts:i,onClose:h,isProfile:!0})]}),c&&e.jsx(At,{isOpen:c,onClose:()=>x(!1)})]})}function Ws(){var A;const{currentAccount:t,onWalletModal:o}=U(),{showPosListLength:s,setShowPosListLength:a,posBaseListLoading:l,posBaseListGroupByPool:i}=ie(),[n,r]=p.useState([]),{isAutoRefresh:c}=J(),[x,h]=p.useState([]),u=S=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",S),h(b=>[...b,S])},m=S=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",S),h(b=>b.filter(C=>(C==null?void 0:C.coin_type)!==(S==null?void 0:S.coin_type)))};p.useEffect(()=>{t!=null&&t.address?console.log("ðŸš€ ~ useEffect ~ currentAccount?.address:",t==null?void 0:t.address):a("")},[t==null?void 0:t.address]),p.useEffect(()=>{var L,H,_,P;const S=(L=x[0])!=null&&L.coin_type?ee((H=x[0])==null?void 0:H.coin_type):void 0,b=(_=x[1])!=null&&_.coin_type?ee((P=x[1])==null?void 0:P.coin_type):void 0,C=Object.values(i).filter(f=>S&&b?ee(f.tokenA.coin_type)==S&&ee(f.tokenB.coin_type)==b||ee(f.tokenA.coin_type)==b&&ee(f.tokenB.coin_type)==S:S?ee(f.tokenA.coin_type)==S||ee(f.tokenB.coin_type)==S:f);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(i),C),r(C);const k=C.reduce((f,T)=>f+(T.list?T.list.length:0),0);t!=null&&t.address&&a(k.toString())},[x,i]),p.useEffect(()=>()=>{a("")},[]),p.useEffect(()=>{l&&a("")},[l]);const d=p.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[w,y]=p.useState("positions");return e.jsx(G,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{gap:"16px",w:"100%",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(Ce,{type:"tab",currentTab:w,tabs:d,onTabChange:S=>y(S.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(ls,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:x,onClickSelectCoinList:u,onDeleteSelectCoinList:m})]}),e.jsx(W,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(rs,{}),t!=null&&t.address?!c&&l?[{},{},{},{}].map((S,b)=>e.jsx(ps,{},b)):((A=Object.values(n))==null?void 0:A.length)>0?Object.values(n).map((S,b)=>e.jsx(cs,{poolInfo:S},b)):e.jsx(se,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(se,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})})}function Ns({tabList:t,tabData:o,onClickTab:s}){return e.jsx(E,{w:"100%",children:t==null?void 0:t.map(a=>e.jsx(Vs,{imgUrl:a.activeImgUrl,value:o[a.value].totalValue,title:a.title,url:a.route,tooltip:a==null?void 0:a.tooltip,onClick:()=>s(a.value),isLoading:o[a.value].isLoading},a.title))})}const Vs=({imgUrl:t,value:o,title:s,url:a,tooltip:l,isLoading:i,onClick:n})=>(Ae(),e.jsxs(v,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(v,{gap:"12px",children:[e.jsx(st,{w:"36px",h:"36px",src:t}),e.jsxs(E,{gap:"2px",align:"flex-start",children:[e.jsx(I,{h:"24px",isLoaded:!i,children:e.jsx(g,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})}),e.jsxs(v,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),l&&e.jsx(ae,{tooltip:l,children:e.jsx(W,{children:e.jsx(M,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(Q,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(M,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function Gs({tabList:t,activeTab:o,tabData:s,onClickTab:a}){return e.jsx(v,{w:"100%",mt:"10px",children:t.map(l=>{var i,n;return e.jsxs(G,{w:"25%",p:"24px 16px",h:"94px",bgImage:o===l.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",onClick:()=>a(l.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",img:{opacity:"0.8"}},children:[e.jsxs(E,{align:"flex-start",gap:"12px",children:[e.jsx(g,{fontSize:"14px",color:"text_caption",children:l.title}),e.jsx(v,{h:"22px",children:e.jsx(ae,{placement:"top",tooltip:e.jsx(g,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:l.tooltip}),showTooltip:l.showTooltip,children:e.jsx(Q,{as:"button",children:e.jsx(I,{isLoaded:!((i=s[l.value])!=null&&i.isLoading),children:e.jsx(g,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(n=s[l.value])==null?void 0:n.totalValue})})})})})]}),e.jsx(st,{w:"48px",h:"48px",src:l.activeImgUrl,opacity:o===l.value?"0.8":"0.4"})]},l.value)})})}function Ge(t){const{isApp:o}=N();return o?e.jsx(Ns,{...t}):e.jsx(Gs,{...t})}const qs=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),ye=it(qs);function ht(){const{currentAccount:t}=U(),{fetchAccountBalance:o}=us(),{coinHoldingList:s,setCoinHoldingList:a,setIsCoinHoldingLoading:l,setIsCoinPriceLoading:i,setHoldingsTotalUsd:n,isCoinPriceLoading:r,setUnknownCoinCount:c}=ye(),{getTokenListInfo:x}=xt(),{getTokenPrice:h}=ce(),{refreshCoinPriceInfo:u}=ze(),m=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{m.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const d=async()=>{const b=m.current;if(b){l(!0);const C=await o(b,!0);if(C){const k=await x(C.filter(_=>B(_.totalBalance).gt(0)).map(_=>_.coinType));if(!k)throw l(!1),a([]),new Error("get token list info error");const L=[];let H=0;return C.forEach(_=>{const P=k.get(_.coinType);if(P){const f=_.totalBalance,T=te(f,P.decimals).toString(),D=Y(T,void 0,void 0,_t.ROUND_DOWN).toString(),O={balance:f,balance_format:T,balance_display:D,balance_usd:"0",coin:P,coin_type:P==null?void 0:P.coin_type,price:"",price_diff_24:""};L.push(O),P.is_verified||H++}}),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",b),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",m.current),b===m.current&&(a(L),c(H),w([...L])),l(!1),L}}else l(!1),a([]);return[]},w=async b=>{i(!0);try{await u(b.filter(C=>C.coin.is_verified).map(C=>C.coin.coin_type))}catch(C){console.error("fetch coin price info error",C)}finally{i(!1)}},y=b=>{b.forEach(C=>{const{coin:k}=C;if(k.is_verified){const L=h(k.coin_type);L&&(C.price=L.price,C.price_diff_24="",C.balance_usd=B(C.balance_format).mul(L.price).toString())}})},A=async b=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:b,coinHoldingList:s,currentAccount:t}),t){const{search:C,current_sort:k,current_sort_order:L,is_show_unknown:H=!1,is_hide_small_balance:_=!0}=b;let P=[];if(H?P.push(...s):P=s.filter(f=>f.coin.is_verified),C){const f=C.toLowerCase();P=P.filter(T=>T.coin.coin_type.toLowerCase().includes(f)||T.coin.symbol.toLowerCase().includes(f)||T.coin.name.toLowerCase().includes(f))}return y(P),_&&!r&&(P=P.filter(f=>B(f.balance_usd).gt(.01))),P.sort((f,T)=>{if(k==="balance"){const D=B(f.balance_format).cmp(B(T.balance_format));if(D!==0)return L==="desc"?-D:D}if(k==="value"){const D=B(f.balance_usd).cmp(B(T.balance_usd));return D!==0?L==="desc"?-D:D:B(T.balance_format).cmp(B(f.balance_format))}if(k==="price"){const D=B(f.price).cmp(B(T.price));return D!==0?L==="desc"?-D:D:B(T.balance_format).cmp(B(f.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",P),P}return[]};return p.useEffect(()=>{y(s);const b=s.reduce((C,k)=>C+Number(k.balance_usd||0),0);n(b.toString())},[s,r]),{getFilterCoinHoldingList:A,fetchCoinHoldingList:d,resetUserData:()=>{a([]),n("0"),c(0)}}}function Ks({inputValue:t,changeInputValue:o}){const s=p.useRef(null),[a,l]=p.useState(!1);return N(),e.jsxs(mt,{children:[e.jsx(bt,{w:a?"203px":"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},bg:"bg_secondary",ref:s,borderRadius:"8px",h:"32px",border:"1px solid",borderColor:"border",variant:"outline",value:t,onChange:i=>{o(i.target.value)},onFocus:()=>{l(!0)},onBlur:()=>{o(""),l(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:"8px",pl:a?"28px":"8px"}),e.jsxs(wt,{children:[e.jsx(M,{position:"absolute",top:"6px",left:a?"-198px":"-26px",xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:i=>{var n;(n=s.current)==null||n.focus(),l(!0)}}),t?e.jsx(M,{xlinkHref:"#icon-icon_close",position:"absolute",top:"6px",right:"6px",onMouseDown:i=>i.preventDefault(),onClick:i=>{o(""),setTimeout(()=>{var n;(n=s.current)==null||n.focus()},0)}}):null]})]})}function Ys({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:a,isHideLowAsset:l,handleIsHideLowAsset:i,unknownCoinCount:n}){return N(),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(v,{children:[e.jsx(Ks,{inputValue:t,changeInputValue:o}),e.jsx(G,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsxs(g,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",n,")"]}),e.jsx(Me,{isChecked:s,onChange:a})]})}),e.jsx(G,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsx(g,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Me,{isChecked:l,onChange:i})]})})]})]})}function Is(){const{isApp:t}=N(),{getFilterCoinHoldingList:o}=ht(),{isCoinHoldingLoading:s,isCoinPriceLoading:a,unknownCoinCount:l}=ye(),{isAutoRefresh:i}=J(),[n,r]=p.useState([]),[c,x]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[h,u]=p.useState(!1),[m,d]=p.useState(!0),[w,y]=p.useState("desc"),[A,S]=p.useState(De[2]),b=j=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",j),i||F(1),x(j),o(j).then(r)},C=j=>{b({...c,search:j})},k=(j,z)=>{b({...c,[j]:z}),j==="is_show_unknown"&&u(z),j==="is_hide_small_balance"&&d(z)},L=j=>{const z=(j==null?void 0:j.value)===(A==null?void 0:A.value),q=t||!z?"desc":w==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",q,j),S(j),y(q),b({...c,current_sort:j.value,current_sort_order:q})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,a,n),!s&&!a&&b(c)},[s,a]);const H=Ae(),_=j=>{H(`/swap/${j}/''`)},[P,f]=p.useState([]),[T,D]=p.useState(0),[O,F]=p.useState(1),R=10;return p.useEffect(()=>{if((n==null?void 0:n.length)>0){const j=(O-1)*R;(n==null?void 0:n.length)<=j&&F(1)}},[n]),p.useEffect(()=>{if((n==null?void 0:n.length)>0){D(n==null?void 0:n.length);const j=(O-1)*R,z=j+R;console.log("ðŸš€ ~ useEffect ~ start:",O,n.slice(0,z),j,z),(n==null?void 0:n.length)>j&&f(n.slice(j,z))}},[O,n]),e.jsx(G,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Ys,{unknownCoinCount:l,inputValue:c.search||"",changeInputValue:C,isShowUnknownCoin:h,handleIsShowUnknownCoin:j=>k("is_show_unknown",j.target.checked),isHideLowAsset:m,handleIsHideLowAsset:j=>k("is_hide_small_balance",j.target.checked)}),e.jsx(W,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(E,{w:"100%",position:"relative",gap:"20px",children:[!s&&!a&&(n==null?void 0:n.length)===0?e.jsx(se,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(E,{w:"100%",gap:"4px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Ss,{sortText:"Sort by",minW:"180px",currentSort:A,sortByList:De,onSortByChange:L,xlinkHref:w==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>y(j=>j==="desc"?"asc":"desc")})]}),e.jsx(Ee,{rowKey:"coin_type",columns:qe(w,A,L,_,!i&&a),dataSource:P,loading:!i&&(s||a),itemSkeletonLength:5,itemHeight:"30px",onRowClick:j=>{_(j==null?void 0:j.coin_type)}})]}):e.jsx(be,{rowKey:"coin_type",columns:qe(w,A,L,_,!i&&a),dataSource:P,skeletonLength:5,loading:!i&&(s||a),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:j=>{_(j==null?void 0:j.coin_type)}}),(n==null?void 0:n.length)>R&&e.jsx(Q,{children:e.jsx(we,{total:T,size:R,currentPage:O,onChange:j=>{F(j)}})})]})]})})}const De=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],ke=Object.fromEntries(De.map(t=>[t.value,t])),qe=(t,o,s,a,l)=>[{title:e.jsx(g,{children:"Token"}),key:"pool",thConfig:{w:"22%"},showLabel:!1,render:({coin:i})=>e.jsx(ut,{haveTooltip:!0,token:i,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(Te,{labelInfo:ke.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"20%"},render:({coin:i,balance_display:n})=>e.jsxs(g,{color:"text_caption",children:[n," ",St(i==null?void 0:i.symbol,10)]})},{title:e.jsx(Te,{labelInfo:ke.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"20%"},render:({price:i})=>e.jsx(v,{justify:"flex-end",children:e.jsx(I,{isLoaded:!l,children:e.jsxs(g,{color:"text_caption",children:["$",at(i)]})})})},{title:e.jsx(Te,{labelInfo:ke.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"20%"},render:({balance_usd:i})=>e.jsx(v,{justify:"flex-end",children:e.jsx(I,{isLoaded:!l,children:e.jsx(g,{color:"text_caption",children:oe(i,2)})})})},{title:e.jsx(g,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"18%"},key:"actions",render:i=>e.jsx(X,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{a(i==null?void 0:i.coin_type)},children:"Swap"})}],Qs=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),_e=it(Qs);function ft(t){const{title:o,imgUrl:s}=t;return e.jsxs(v,{justify:"space-between",align:"flex-start",w:"100%",children:[e.jsxs(v,{children:[s&&e.jsx(Re,{imageUrl:s,p:"4px",imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(g,{children:o})]}),"btnTitle"in t&&t.btnTitle?e.jsx(X,{h:"32px",borderRadius:"8px",p:"8px",fontSize:"12px",onClick:t.onClick,fontWeight:"500",children:t.btnTitle}):e.jsx(W,{h:"32px"})]})}const Zs={cetus:{title:"CETUS",imgUrl:$.cetus_coin.logo_url,bgUrl:"/images/cetus_holding_bg.png"},xcetus:{title:"xCETUS",imgUrl:$.x_cetus_coin.logo_url,bgUrl:"/images/xcetus_holding_bg.png"}};function jt({type:t,amount:o,amountUSD:s,isLoading:a,onClick:l,btnTitle:i,children:n}){const{title:r,imgUrl:c,bgUrl:x}=Zs[t];return e.jsx(G,{flex:"1",bg:`right 0 bottom 60% / 86px 142px no-repeat url("${x}"), radial-gradient(40% 74% at 100% 100%,#1D342E 0%, rgba(22,27,48,0) 100%), rgba(0,0,0,0.5)`,backdropFilter:"blur(20px)",p:"16px",borderRadius:"16px",children:e.jsxs(E,{w:"100%",gap:"0",children:[e.jsx(ft,{title:`${r} Holdings`,imgUrl:c,onClick:l,btnTitle:i}),e.jsxs(E,{align:"flex-start",w:"100%",m:"31px 0 60px",children:[e.jsx(I,{isLoaded:!a,h:"26px",children:e.jsx(g,{color:"text_caption",h:"26px",lineHeight:"26px",fontSize:"22px",children:o})}),e.jsx(I,{isLoaded:!a,h:"17px",children:e.jsxs(g,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["Total ",r," (â‰ˆ $",at(s,2),")"]})})]}),n]})})}function Js(){const{currentAccount:t}=U(),{balanceInfo:o}=vs($.cetus_coin),{getTokenAmountValue:s}=ce(),{coinPriceObj:a}=He(),l=p.useMemo(()=>s($.cetus_coin.coin_type,te((o==null?void 0:o.balance)||"0",$.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,a]),{setCurrentXCetusTab:i,setIsXCetusModalOpen:n}=_e(),r=()=>{n(!0),i("Get xCETUS")},{veNFT:c,veNFTLoading:x,lockCetusListLoading:h}=Z();return e.jsx(jt,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:l,isLoading:(h||x)&&c!==void 0,children:e.jsx(X,{w:"100%",h:"48px",borderRadius:"12px",fontWeight:"500",fontSize:"16px",onClick:r,children:"Get xCETUS"})})}function en(){const{lockCetusList:t,lockCetusListLoading:o}=Z(),[s,a]=p.useState([]),[l,i]=p.useState(0),[n,r]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const x=(n-1)*c;(t==null?void 0:t.length)<=x&&r(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){i(t==null?void 0:t.length);const x=(n-1)*c,h=x+c;console.log("ðŸš€ ~ useEffect ~ start:",n,t.slice(0,h),x,h),(t==null?void 0:t.length)>x&&a(t.slice(x,h))}},[n,t]),console.log(t,"lockCetusList"),t&&t.length>0&&e.jsxs(G,{p:"0 16px 16px",w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:[e.jsx(Ce,{type:"title",title:"Redeeming xCETUS"}),e.jsx(Pe,{orientation:"horizontal"}),e.jsx(be,{rowKey:"id",mt:"10px",dataSource:s,columns:tn(),loading:o,skeletonLength:t==null?void 0:t.length,rowStyle:{h:"80px"}}),(t==null?void 0:t.length)>c&&e.jsx(Q,{children:e.jsx(we,{total:l,size:c,currentPage:n,onChange:x=>{r(x)}})})]})}const tn=()=>[{title:e.jsx(g,{children:"xCETUS To CETUS"}),key:"to",render:t=>e.jsx(gs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"})},{title:e.jsx(g,{textAlign:"right",children:"Vesting Duration (Day)"}),key:"lock_day",render:t=>e.jsx(g,{color:"text_caption",fontSize:"14px",children:t==null?void 0:t.lock_day})},{title:e.jsx(g,{textAlign:"right",children:"Available Claim Date"}),key:"date",render:t=>e.jsx(g,{color:"text_caption",fontSize:"14px",children:vt.unix(t==null?void 0:t.locked_until_time).format("MMM D, YYYY HH:mm")})},{title:e.jsx(g,{textAlign:"right",children:"Action"}),key:"action",render:t=>e.jsx(sn,{order:t})}],sn=({order:t})=>{const[o,s]=p.useState(!1),{cancelOrderLoading:a,handleCancelOrder:l}=hs(),{claimOrderLoading:i,handleClaimOrder:n}=fs(),r=c=>{c?n(t.id):l(t)};return p.useEffect(()=>{s(!lt.isLocked(t))},[t.id]),e.jsx(v,{justify:"flex-end",children:e.jsx(X,{onClick:()=>{a||i||r(o)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:a||i,color:o?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:o?"Claim":"Cancel"})})};function nn({cetusApr:t,myShare:o,totalRewardValue:s,nextStartTime:a,rewardList:l,summaryRewardList:i}){const{currentAccount:n}=U(),{days:r,hours:c,minutes:x,seconds:h}=js((a||0)*1e3),{veNFTLoading:u}=Z(),{claimRewardLoading:m,handleClaimReward:d}=ms(),w=()=>{m||d(l)};return N(),e.jsx(G,{flex:"1.46",p:"16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(E,{w:"100%",gap:"0",children:[e.jsx(ft,{title:"Staking Rewards",onClick:w,btnTitle:B(s).gt(0)?"Claim":""}),e.jsxs(E,{m:"36px 0 50px",h:"57px",children:[e.jsxs(v,{children:[e.jsx(xe,{value:r,type:"d"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(xe,{value:c,type:"h"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(xe,{value:x,type:"m"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(xe,{value:h,type:"s"})]}),e.jsx(g,{fontSize:"14px",h:"17px",lineHeight:"17px",children:"Reward Distribution In"})]}),e.jsxs(v,{justify:"space-between",w:"80%",mb:"12px",children:[e.jsx(Le,{title:"Est.APR",value:e.jsx(bs,{children:e.jsxs(g,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",cursor:"pointer",children:["â‰ˆ$",Tt(t,2)]})}),loading:t==="0"}),e.jsx(Pe,{orientation:"vertical"}),e.jsx(Le,{title:"Your Share",value:o!=="--"?`â‰ˆ${o}`:o,loading:u}),e.jsx(Pe,{orientation:"vertical"}),e.jsx(Le,{title:"Pending Yield",value:n?e.jsx(ae,{tooltip:e.jsx(E,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:i==null?void 0:i.map(y=>(console.log("ðŸš€ ~ {yieldList?.map ~ item:",y),e.jsxs(v,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(ut,{coinType:y.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(v,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",color:"text_caption",children:Y(y==null?void 0:y.amount,6)}),e.jsxs(g,{fontSize:"12px",children:["(",oe(y==null?void 0:y.value,2),")"]})]})]},y.coin_type)))}),children:e.jsx(g,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",cursor:"pointer",children:oe(s,2)})}):"--",loading:u})]})]})})}const on={d:"D",h:"H",m:"M",s:"S"},xe=({value:t,type:o})=>e.jsxs(v,{borderRadius:"8px",bg:"background",p:"4px 8px",justify:"center",align:"flex-end",w:"64px",h:"32px",gap:"2px",children:[e.jsx(g,{color:"text_caption",fontSize:"20px",textAlign:"center",children:t}),e.jsx(g,{fontSize:"12px",mb:"1px",children:on[o]})]}),Le=({title:t,value:o,loading:s})=>e.jsxs(E,{gap:"3px",children:[e.jsx(I,{isLoaded:!s,h:"17px",children:e.jsx(g,{color:"text_caption",fontSize:"14px",h:"17px",lineHeight:"1",children:o})}),e.jsx(g,{fontSize:"14px",h:"15px",lineHeight:"1",children:t})]});function an({availableXCetusAmount:t,redeemingXCetusAmount:o}){const{currentAccount:s}=U(),{veNFT:a,veNFTLoading:l,lockCetusListLoading:i}=Z(),{getTokenAmountValue:n}=ce(),{coinPriceObj:r}=He(),c=p.useMemo(()=>n($.cetus_coin.coin_type,te((a==null?void 0:a.xcetus_balance)||"0",$.x_cetus_coin.decimals)).toString(),[a==null?void 0:a.xcetus_balance,s==null?void 0:s.address,r]),{setCurrentXCetusTab:x,setIsXCetusModalOpen:h}=_e(),u=()=>{h(!0),x("Redeem CETUS")},m=(i||l)&&a!==void 0;return e.jsx(jt,{type:"xcetus",amount:s?Y(te((a==null?void 0:a.xcetus_balance)||"0",9),9).toString():"--",amountUSD:c,onClick:u,btnTitle:"Redeem",isLoading:m,children:e.jsxs(E,{w:"100%",gap:"16px",h:"48px",children:[e.jsx(K,{isLoading:m,label:"Available",value:s?Y(te(t,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}}),e.jsx(K,{isLoading:m,label:"Redeeming",value:s?Y(te(o,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}})]})})}const ue=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function ln({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:a,setCurrentXCetusTab:l}=_e(),[i,n]=p.useState("#icon-a-icon_trade"),r=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},x=()=>{var u;const h=(u=ue==null?void 0:ue.find(m=>(m==null?void 0:m.value)!==a))==null?void 0:u.value;h&&l(h)};return e.jsxs(Ie,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{children:[e.jsx(Je,{p:"0 16px",children:e.jsx(W,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:ue,currentTab:a,handleChangeTab:h=>{l(h==null?void 0:h.value)}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"20px 16px 16px",children:[a==="Get xCETUS"&&e.jsx(ws,{onClose:o,availableXCetusAmount:s,onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}}),a==="Redeem CETUS"&&e.jsx(Cs,{onClose:o,availableXCetusAmount:te(s,9),onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}})]})]})]})}function rn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=_e(),{availableXCetusAmount:s,redeemingXCetusAmount:a,cetusApr:l,myShare:i,totalRewardValue:n,nextStartTime:r,rewardList:c,summaryRewardList:x}=ys();return e.jsxs(E,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsx(nn,{cetusApr:l,myShare:i,totalRewardValue:n,nextStartTime:r,rewardList:c,summaryRewardList:x}),e.jsx(an,{availableXCetusAmount:s,redeemingXCetusAmount:a}),e.jsx(Js,{})]}),e.jsx(en,{}),t&&e.jsx(ln,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})}function cn(){const{currentAccount:t}=U(),{orderListLoading:o,myOrderList:s}=de(),{isAutoRefresh:a,dcaOrderListLoading:l,dcaActiveOrderList:i}=J(),{getTokenAmountValue:n,coinPriceObj:r}=ce(),c=p.useMemo(()=>{let u=B(0);if(a||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(m=>{const{pay_coin:d,target_coin:w,un_claimed_amount:y,remaining_amount:A}=m,S=n(d.coin_type,A),b=n(w.coin_type,y);u=B(u).plus(S).plus(b),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",u.toString())}),u.toString()):"0"},[a,s,t==null?void 0:t.address,o,r]),x=p.useMemo(()=>{let u=B(0);if(a||!l)return(i==null?void 0:i.length)>0&&(t!=null&&t.address)?(i.forEach(m=>{const{inBalance:d,inCoin:w,outBalance:y,outCoin:A}=m,S=n(w.coin_type,d),b=n(A.coin_type,y);u=B(u).plus(S).plus(b),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",u.toString())}),u):"0"},[a,i,t==null?void 0:t.address,l,r]),h=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",x,c),x&&c){let u=B(0);return u=B(u).plus(x).plus(c),u.toString()}return"--"},[x,c]);return{limitTotalTvl:c,dcaTotalTvl:x,orderTotalTvl:h}}function dn(){const{currentAccount:t}=U(),{isAutoRefresh:o}=J(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=Z(),{getTokenAmountValue:i}=ce(),{coinPriceObj:n}=He();return{xCetusTotalTvl:p.useMemo(()=>{if(o||!a&&!l)return t!=null&&t.address&&s?i($.cetus_coin.coin_type,te(s==null?void 0:s.xcetus_balance,$.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,l,a,t==null?void 0:t.address,n])}}const pn="fetch-coin-holding-list",xn="fetch-owner-nft",un="fetch-active-order-list",gn="fetch-xcetus-base-info";function hn(){const{currentAccount:t}=U(),{getTokenListInfo:o}=xt(),{getLimitUserIndexer:s,getDcaUserIndexer:a}=_s(),{setOrderListLoading:l,setMyOrderList:i}=de(),{setDcaOrderListLoading:n,setDcaActiveOrderList:r,setDcaPastOrderList:c}=J(),{refreshCoinPriceInfo:x}=ze(),{buildDcaOrderList:h}=$t(),{peripherySdk:u}=me(),{formatLimitOrderList:m}=Zt(),d=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{d.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const w=async()=>{if(t){l(!0);const b=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",b),b)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(b)).data.map(L=>L.name.value)}catch(C){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",C)}}return[]},y=async()=>{if(t){n(!0);const b=await a(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",b),b)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(b)).data.map(L=>L.name.value)}catch(C){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",C)}}return[]};return{fetchActiveOrderList:async()=>{try{const b=await w(),C=await y(),k=await u.ClmmSDK.fullClient.batchGetObjects([...b,...C],{showType:!0,showContent:!0}),L=k.filter(R=>{var j,z;return(z=(j=R.data)==null?void 0:j.type)==null?void 0:z.includes("limit_order::LimitOrder")}),H=k.filter(R=>{var j,z;return(z=(j=R.data)==null?void 0:j.type)==null?void 0:z.includes("order::Order")}),P=L.map(R=>kt.buildLimitOrderInfo(R)).filter(R=>R!==void 0).filter(R=>R.status===$e.PartialCompleted||R.status===$e.Running),f=H.map(R=>{var le,V,re,ne,pe,Fe,Be,Ue;const j=he(((le=R.data)==null?void 0:le.type)||""),z=j.type_arguments[0],q=j.type_arguments[1];return{in_coin_type:z,out_coin_type:q,...(re=(V=R.data)==null?void 0:V.content)==null?void 0:re.fields,id:(Be=(Fe=(pe=(ne=R.data)==null?void 0:ne.content)==null?void 0:pe.fields)==null?void 0:Fe.id)==null?void 0:Be.id,version:(Ue=R.data)==null?void 0:Ue.version}}),T=new Set;for(const R of P)T.add(R.pay_coin_type),T.add(R.target_coin_type);for(const R of f)T.add(R.in_coin_type),T.add(R.out_coin_type);await o(Array.from(T));const D=await m(P);i(D);const{activeResult:O,pastResult:F}=await h(f);d.current===(t==null?void 0:t.address)&&(r(O),c(F),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",D),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",f)),x(Array.from(T))}catch(b){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",b)}finally{l(!1),n(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),i([]),r([]),c([])}}}function fn(){const{currentAccount:t}=U(),{clmmSdk:o}=rt(),{xCetusSdk:s}=me(),{buildFarmsPositionType:a,buildBurnPositionType:l}=ts(),{setPosBaseList:i,setFullRangePosBaseList:n,setPosBaseListLoading:r}=ie(),{setVeNFT:c,setVeNFTLoading:x,setLockCetusList:h,clearData:u,setLockCetusListLoading:m}=Z(),{formatPosBaseList:d}=pt(),w=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{w.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const S=w.current;if(S){r(!0),x(!0);const b=await o.fullClient.getOwnedObjectsByPage(S,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:$.clmm_sdk_options.clmm_pool.package_id},{StructType:a},{StructType:l},{StructType:Ts},{StructType:ks}]}});let C=await d(b);i(C),r(!1),(C==null?void 0:C.length)==0&&n([]);const k=Ls(b.data);if(k&&S===w.current){c(k,S);const L=await Ps(b.data,s);console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList:",L),h(L)}else m(!1);return{veNFT:k,posBaseList:C}}}catch(S){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",S),S instanceof TypeError&&(r(!1),i([]))}finally{r(!1),x(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{i([]),u()}}}function jn(){const{currentAccount:t}=U(),{peripherySdk:o}=me(),{clmmSdk:s}=rt();pt();const{getPosPoolsOriginalObj:a,getPosPoolsRelatedData:l}=ss(),{getPosLiquidityData:i}=ns(),{setPosLiquidityData:n,setFarmsPosRewardsData:r,setFarmsPosRewardsDataLoading:c,setPosRewardsData:x,setPosRewardsDataLoading:h,setPosFeeData:u,setPosFeeDataLoading:m}=ie(),{formatFarmsRewardsData:d}=os(),{formatPosRewardsData:w}=is(),{formatPosFeeData:y}=as(),{posBaseList:A,setShowPosListLength:S,setMyPosYieldValue:b}=ie(),{refreshCoinPriceInfo:C}=ze(),k=async _=>{var D;const P=_.filter(O=>O.posType==="farms"&&O.farmsPool),f=await a(_);if(l(_,f),((D=Object.keys(f))==null?void 0:D.length)===0)throw n({}),new Error("No pool data found");i(_,f);const T=new Lt;P.length>0&&P.forEach(O=>{o.Farms.buildCalculateFarmingReward({pool_id:O.farmsPool,position_nft_id:O.id},T)}),_.forEach(O=>{s.Rewarder.buildFetchPosFee({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB},T)}),_.filter(O=>O.posType!=="farms").forEach(O=>{const F=f[O.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB,rewarderInfo:F.rewarder_infos},T)});try{c(!0),h(!0),m(!0);const O=await s.fullClient.devInspectTransactionBlock({transactionBlock:T,sender:Pt("0x0")}),F=o.Farms.parsedPosRewardData(O),R=s.Rewarder.parsedPosRewardData(O),j=s.Rewarder.parsedPosFeeData(O);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:F,clmmRewardData:R,clmmFeeData:j});const z=await d(F);r(z);const q=await w(Object.values(R).map(V=>{const re=f[_.find(ne=>ne.posId===V.position_id).clmmPool];return{poolAddress:re.pool_address,positionId:V.position_id,rewarderAmountOwed:V.rewarder_amount.map((ne,pe)=>({coin_address:re.rewarder_infos[pe].coinAddress,amount_owed:new Se(ne)}))}}));x(q);const le=await y(Object.values(j).map(V=>({position_id:V.position_id,feeOwedA:new Se(V.fee_owned_a),feeOwedB:new Se(V.fee_owned_b)})),_);u(le),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:le,posRewardsData:q,posFarmsRewardsObj:z}),L(q,z)}catch(O){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",O)}finally{c(!1),h(!1),m(!1)}},L=async(_,P)=>{const f=[];if(A.length>0){A.map(D=>{f.push(he(D==null?void 0:D.coinTypeA).full_address),f.push(he(D==null?void 0:D.coinTypeB).full_address);const O=_[D==null?void 0:D.posId]||[],F=P[D==null?void 0:D.id]||[],R=O.concat(F);R==null||R.map(j=>{var z;Rt(j==null?void 0:j.display_amount_owed).gt(0)&&f.push(he((z=j==null?void 0:j.token)==null?void 0:z.coin_type).full_address)})});const T=Array.from(new Set(f));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",T),C(T)}};return{fetchPosRelatedData:k,resetUserData:()=>{n({}),r({}),x({}),u({})}}}function mn(){const{currentAccount:t}=U(),{setXCetusManager:o,setDividendManager:s}=Z(),{xCetusSdk:a}=me();return{fetchXCetusBaseInfo:async i=>{try{const{xcetus:n,xcetus_dividends:r}=$.xcetus_sdk_options,{dividend_manager_id:c}=We(r),{xcetus_manager_id:x}=We(n),h=await a.fullClient.batchGetObjects([x,c],{showType:!0,showContent:!0}),u=h.find(d=>{var w,y;return(y=(w=d.data)==null?void 0:w.type)==null?void 0:y.includes("xcetus::XcetusManager")});if(u){const d=Ne(u),w={id:d.id.id,index:Number(d.index),has_venft:{handle:d.has_venft.fields.id.id,size:d.has_venft.fields.size},nfts:{handle:d.nfts.fields.id.id,size:d.nfts.fields.size},total_locked:d.total_locked,treasury:d.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",w),o(w)}const m=h.find(d=>{var w,y;return(y=(w=d.data)==null?void 0:w.type)==null?void 0:y.includes("dividend::DividendManager")});if(m){const d=Ne(m),w=lt.buildDividendManager(d);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",w),a.XCetusModule.updateCache(`${c}_getDividendManager`,w),s(w)}}catch(n){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",n)}}}}function bn(t){const{currentAccount:o}=U(),{fetchCoinHoldingList:s,resetUserData:a}=ht(),{fetchPosRelatedData:l,resetUserData:i}=jn(),{fetchActiveOrderList:n,resetUserData:r}=hn(),{setAutoRefreshCount:c}=J(),{fetchOwnerNFT:x,resetUserData:h}=fn(),{fetchXCetusBaseInfo:u}=mn(),{addTask:m,removeTask:d}=Ds(),[w,y]=p.useState([]),A=p.useRef(o),{fetchOwnerLockCetusList:S}=Rs(),{setOrderListLoading:b}=de(),{setLockCetusListLoading:C}=Z(),{setPosBaseListLoading:k}=ie(),{setIsCoinHoldingLoading:L}=ye(),H=()=>{a(),i(),r(),h()};p.useEffect(()=>{var F,R;o?((F=A.current)!=null&&F.address&&((R=A.current)==null?void 0:R.address)!==(o==null?void 0:o.address)&&(c(!1),H(),w.forEach(j=>{d(j.id)})),D()):(H(),w.forEach(j=>{d(j.id)})),A.current=o},[o==null?void 0:o.address]);const _={id:pn,run:s},P={id:xn,run:x,onSuccess:F=>{const{veNFT:R,posBaseList:j}=F;l(j),R&&(o!=null&&o.address)&&S(o==null?void 0:o.address)}},f={id:gn,run:u},T={id:un,run:n},D=()=>{const F=[];b(!0),C(!0),k(!0),L(!0),t==="wallet"?F.push(_,P,T,f):t==="liquidity"?F.push(P,_,T,f):t==="orders"?F.push(T,_,P,f):F.push(P,f,_,T),y(F),F.forEach(R=>{m(R)})};return{refreshTask:()=>{o&&(w.forEach(F=>{d(F.id)}),D())}}}const ge=t=>t?oe(t,2):"$--",wn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),B(0)).toString();function So(){const{tab:t}=xs(),{currentAccount:o,onWalletModal:s}=U(),a=Ae(),{posBaseListLoading:l,posLiquidityDataLoading:i}=ie(),{holdingsTotalUsd:n,isCoinPriceLoading:r,isCoinHoldingLoading:c}=ye(),{clmmTotalTvl:x}=ds(),{orderTotalTvl:h}=cn(),{orderListLoading:u}=de(),{isAutoRefresh:m,dcaOrderListLoading:d,setAutoRefreshCount:w,resetAutoRefreshCount:y}=J(),{xCetusTotalTvl:A}=dn(),{lockCetusListLoading:S,veNFTLoading:b,veNFT:C}=Z(),k=p.useMemo(()=>t||"wallet",[t]),{refreshTask:L}=bn(k),H=!m&&(c||r),_=!m&&(l||i),P=!m&&(u||d),f=!m&&(S||b),T=p.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",n,x,h,A),{wallet:{totalValue:ge(n),isLoading:H},liquidity:{totalValue:ge(x),isLoading:_},orders:{totalValue:ge(h),isLoading:P},xCetus:{totalValue:ge(A),isLoading:f}}),[n,x,h,A,H,_,P,f]),D=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],O=p.useMemo(()=>wn(A,x,h,n),[A,x,h,n]);p.useEffect(()=>y(!1),[]);const[F,R]=p.useState(!1);p.useEffect(()=>{R(!0)},[]);const{isApp:j}=N();return j?e.jsx(Os,{totalValue:O,onRefreshTask:L,isLoading:!m&&(b||l||u||d),children:e.jsx(Ge,{tabList:D,activeTab:k,tabData:T,onClickTab:z=>a(`/profile?tab=${z}`)})}):e.jsx(E,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:F?o!=null&&o.address?e.jsxs(E,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx($s,{handleRefresh:z=>{w(!z),L()},totalValue:O,isLoading:!m&&(b||l||u||d)}),e.jsx(Ge,{tabList:D,activeTab:k,tabData:T,onClickTab:z=>a(`/profile?tab=${z}`)}),k==="wallet"&&e.jsx(Is,{}),k==="liquidity"&&e.jsx(Ws,{}),k==="orders"&&e.jsx(Xs,{}),k==="xCetus"&&e.jsx(rn,{})]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>s(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Oe,{})})})}export{So as default};
//# sourceMappingURL=Profile-BMl0ZJp7.js.map

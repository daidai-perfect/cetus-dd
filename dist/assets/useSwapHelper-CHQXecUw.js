import{u as b}from"./useToken-CUbDlqoG.js";import{r as A,aO as e,aX as M}from"./index-CHLr8WBT.js";import{u as G}from"./global-kaoaUtz_.js";import{u as H}from"./useGetPoolList-CUnDlVFh.js";var r=(t=>(t.CETUS="CETUS",t.KRIYA="KRIYA",t.KRIYAV3="KRIYAV3",t.FLOWX="FLOWX",t.FLOWXV3="FLOWXV3",t.AFTERMATH="AFTERMATH",t.METASTABLE="METASTABLE",t.HAEDAL="HAEDAL",t.VOLO="VOLO",t.AFSUI="AFSUI",t.DEEPBOOKV3="DEEPBOOKV3",t.SCALLOP="SCALLOP",t.BLUEMOVE="BLUEMOVE",t.TURBOS="TURBOS",t.SPRINGSUI="SPRINGSUI",t.BLUEFIN="BLUEFIN",t.HAEDALPMM="HAEDALPMM",t.ALPHAFI="ALPHAFI",t.STEAMM="STEAMM",t.OBRIC="OBRIC",t))(r||{}),$=(t=>(t[t.CalculateError=1e4]="CalculateError",t[t.NumberTooLarge=10001]="NumberTooLarge",t[t.NoRouter=10002]="NoRouter",t[t.InsufficientLiquidity=10003]="InsufficientLiquidity",t[t.HoneyPot=10004]="HoneyPot",t))($||{}),K=(t=>(t.TradeInputPage="TradeInput",t.TradeStatus="TradeStatus",t.SelectTokenPage="SelectToken",t.TradeConfirmPage="TradeConfirm",t.RoutePage="Route",t.TradeSetting="TradeSetting",t.SlippageSetting="SlippageSetting",t))(K||{});function N(t=!0){const{poolApiMap:s,setPoolApiMap:i}=G(),{getPoolList:f,getLocalJsonPoolList:m,getLocalJsonPoolAddress:I}=H();return{getPoolListByCoinType:async(u,o)=>{if(u&&o){const T=[u,o].sort(),p=`${T[0]}_${T[1]}`,c=s[p];if(c)return c;const L={coin_type:`${u},${o}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0};let n=t?await m(L):void 0;(n===void 0||n.list.length===0)&&(n=await f(L));const l=n.list;if(l.length>0)return s[p]=l,i(p,l),l}return[]},getPoolAddressByCoinType:async(u,o)=>{if(u&&o){const T=[u,o].sort(),p=`${T[0]}_${T[1]}`;if(t){const n=await I(u,o);if(!n||n.length===0){const l=s[p];if(l)return l.map(d=>d.poolAddress)}else return n}const c={coin_type:`${u},${o}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0},L=await f(c);if(L){const n=L.list;if(n.length>0)return s[p]=n,i(p,n),n.map(l=>l.poolAddress)}}return[]}}}function q(t,s){return{priceAcceptRouterData:A.useMemo(()=>{if(s&&t){if(t.byAmountIn){if(!e(t.toAmountUi).eq(s.toAmountUi||"0"))return s}else if(!e(t.fromAmountUi).eq(s.fromAmountUi||"0"))return s;return}},[s,t])}}function Y(t,s){return{amountLimit:A.useMemo(()=>{if(s&&s.routerData){const{byAmountIn:f,fromAmountUi:m,toAmountUi:I}=s;return f?e(I).mul(e(1).sub(e(t))).toString():e(m).mul(e(1).add(e(t))).toString()}},[t,s])}}function J(t){const{getTokenInfo:s,fetchTokenInfo:i}=b(),[f,m]=A.useState({}),I=async()=>{var _,R,u;if(t&&t.routerData){const o=[],T=t.byAmountIn?t.routerData.amountIn.toString():t.routerData.amountOut.toString(),p=[],c=[];let L=e(0);const n=((_=t==null?void 0:t.routerData)==null?void 0:_.routes)||[];for(let d=0;d<n.length;d++){const y=n[d],h={},B=t.byAmountIn?y.amountIn.toString():y.amountOut.toString();d===t.routerData.routes.length-1?h.percentage=e(1).sub(L).toFixed(2):h.percentage=e(B).div(T).toFixed(2),L=e(L).add(h.percentage);const E=[];for(let F=0;F<((R=y==null?void 0:y.path)==null?void 0:R.length);F++){const a=(u=y==null?void 0:y.path)==null?void 0:u[F];o.includes(a.provider)||o.push(a.provider);const S=M(a.from).full_address,O=M(a.target).full_address,U=await i(S),P=await i(O);U||c.includes(S)&&c.push(S),P||c.includes(O)&&c.push(O);const V=a.provider===r.SCALLOP||a.provider===r.FLOWX||a.provider===r.FLOWXV3;E.push({from_type:S,to_type:O,pool_address:V?"":a.id,fee_rate:a.feeRate,provider:a.provider})}h.paths=E,p.push(h)}if(c.length>0)for(const d in c)i(d);const l={router_summery:`${t.routerData.routes.length} Streams`,providers:o,routers:p};m(l);return}m(void 0)};return A.useEffect(()=>{I()},[t]),{formatSwapRouter:f}}function j(){const{getPoolAddressByCoinType:t}=N(!0);return{getSwapPoolAddress:async(i,f)=>{if(i&&f){const m=await t(i.coin_type,f.coin_type);return console.log("ðŸš€ ~ getSwapPoolAddress ~ list:",m),m}return[]}}}function z(t,s){return A.useMemo(()=>t&&s&&+t&&+s?e(s).div(t).toString():"0",[t,s])}export{$ as A,K as S,r as a,Y as b,q as c,z as d,j as e,J as u};

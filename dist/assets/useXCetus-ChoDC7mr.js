import{a as p,j as e,X as ue,Y as fe,Z as xe,$ as me,a8 as pe,a0 as Ce,a1 as he,V as N,H as F,T as L,v as te,f as be,a2 as ge,a3 as Se,a4 as we,a5 as Te}from"./vendor-DXHkIl66.js";import{u as W}from"./useTransaction-B4SsAvX4.js";import{j as P,k as U,as as M,w as I,d as Z,t as ee,C as Q,M as A,p as se,i as ye,B as oe,am as ae,a as ve,c as K,v as z,n as ke,aY as Ie,aZ as je,aR as Me,al as De,ar as Re,a0 as Y,aK as _e}from"./index-kyUQkV0u.js";import{M as H}from"./msafe-oYBkW7LJ.js";import{u as B}from"./useAccountBalance-B_xeHqrX.js";import{u as re}from"./useTokenBalance-BzrxWKLg.js";import{u as q,d as G,e as ce,f as Le,g as Oe,h as Ae}from"./useXCetusHelper-CxP_Iahd.js";import{T as ie}from"./TradeInputGroup-ZMEoDzmO.js";import{H as Pe}from"./HTextLabelBox-MEowE9sl.js";import{C as Ue}from"./CheckBox-DQX8O2AC.js";import{H as Xe}from"./HighlightText-BLaAjUt8.js";import{u as Ee}from"./activeOrders-Du6enxqH.js";const nt=(x,i,c="seconds")=>{const s=()=>{const t=x-new Date().getTime();if(t<=0)return{years:0,months:0,days:0,hours:0,minutes:0,seconds:0};const r=Math.floor(t/1e3%60),d=Math.floor(t/1e3/60%60),n=Math.floor(t/(1e3*60*60)%24),a=Math.floor(t/(1e3*60*60*24)%30),C=Math.floor(t/(1e3*60*60*24*30)%12),b=Math.floor(t/(1e3*60*60*24*365));return c==="days"?{years:0,months:0,days:a+C*30+b*365,hours:n,minutes:d,seconds:r}:c==="months"?{years:0,months:C+b*12,days:a,hours:n,minutes:d,seconds:r}:{years:b,months:C,days:a,hours:n,minutes:d,seconds:r}},[o,l]=p.useState(s());return p.useEffect(()=>{const u=setInterval(()=>{const t=s();l(t),t.years===0&&t.months===0&&t.days===0&&t.hours===0&&t.minutes===0&&t.seconds===0&&(clearInterval(u),i&&i())},1e3);return()=>clearInterval(u)},[x]),o};function Fe(){const{fetchAccountBalance:x}=B(),{fetchOwnerLockCetusList:i}=q(),{signAndExecuteTransaction:c}=W(),{currentAccount:s}=P(),{fetchOwnerVeNFT:o}=G(),{xCetusSdk:l}=U(),{veNFT:u}=M(),[t,r]=p.useState(""),[d,n]=p.useState(""),{balanceInfo:a}=re(I.cetus_coin),C=f=>{r(f),n(f)},[b,y]=p.useState(!1),g=async()=>{y(!0);const f={venft_id:u==null?void 0:u.id,amount:ee(t,9).toFixed(0)},D=await l.XCetusModule.convertPayload(f),j=await c(D,{getShowInfo:v=>{const R=`Converting ${Q(t)} CETUS to ${Q(t)} xCETUS`,_={modalTitleText:"Convert",modalDescriptionText:R,toastDescriptionContent:R};if(v==="success"){const O=R.replace("Converting","Converted");_.modalDescriptionText=O,_.toastDescriptionContent=O}return _}},{msafeParams:{action:H.xCETUSConvert,txbParams:f}});y(!1),j&&(s&&o(s==null?void 0:s.address,!0),r(""),n(""),x(),i())},T=p.useMemo(()=>{const f={text:"Convert",disabled:!1};return s!=null&&s.address?+t?(+t&&Z(t).gt((a==null?void 0:a.balanceFormat)||0)&&(f.disabled=!0,f.text="Insufficient CETUS Balance"),f):(f.text="Enter an amount",f.disabled=!0,f):(f.text="Connect Wallet",f.disabled=!1,f)},[a==null?void 0:a.balanceFormat,s==null?void 0:s.address,t]);return{inputAmountFrom:t,inputAmountTo:d,handleInputChange:C,balanceInfoFrom:a,convertLoading:b,btnText:T.text,btnDisabled:T.disabled,handleConvertClick:g}}function le(x){const{isOpen:i,onClose:c,onSubmitClick:s}=x,{setShowConvertModel:o}=M(),[l,u]=p.useState(!1);return e.jsxs(ue,{autoFocus:!1,returnFocusOnClose:!1,isOpen:i,onClose:c,isCentered:!0,children:[e.jsx(fe,{}),e.jsxs(xe,{children:[e.jsx(me,{children:e.jsx(pe,{fontWeight:"500",fontSize:"16px"})}),e.jsx(Ce,{}),e.jsx(he,{textAlign:"center",p:"0px",children:e.jsxs(N,{w:"100%",gap:"20px",p:"20px",pb:"90px",pos:"relative",children:[e.jsx(Xe,{text_color:"text_caption",text_size:"14px",text:` Please note that after conversion, if you want to convert xCETUS back to CETUS, a vesting period will be applied & different vesting
              durations correspond to different redeem ratios. Learn more`,keywords:["Learn more"],onKeywordClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")}}),e.jsxs(F,{children:[e.jsx(Ue,{checked:l,onClick:()=>{u(!l)}}),e.jsx(L,{color:"text_caption",children:"Do not remind again."})]}),e.jsx(te,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{o(!l),s()},children:"Convert"})]})})]})]})}function st(x){const{availableXCetusAmount:i,iconParams:c,onIconClick:s}=x,{currentAccount:o,onWalletModal:l}=P(),{inputAmountFrom:u,inputAmountTo:t,handleInputChange:r,balanceInfoFrom:d,btnText:n,btnDisabled:a,handleConvertClick:C,convertLoading:b}=Fe(),{showConvertModel:y}=M(),[g,T]=p.useState(!1);return e.jsxs(N,{w:"100%",gap:"8px",children:[e.jsx(ie,{onClick:s,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:(d==null?void 0:d.balanceFormat)||"",value:u,amountValue:"",loading:!1,onChange:f=>{r(f)},selectable:!1,placeholder:"0.0",token:I.cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:A(i,9),value:t,half:!1,max:!1,amountValue:"",onChange:f=>{r(f)},selectable:!1,placeholder:"0.0",token:I.x_cetus_coin},iconParams:c}),e.jsx(te,{w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:a||b,isLoading:b,onClick:()=>{console.log(o,y,"showConvertModel"),o?y?T(!0):C():l(!0)},children:n}),g&&e.jsx(le,{isOpen:g,onClose:()=>{T(!1)},onSubmitClick:()=>{T(!1),C()}})]})}function Be(x){const{fetchAccountBalance:i}=B(),{fetchOwnerLockCetusList:c}=q(),{signAndExecuteTransaction:s}=W(),{currentAccount:o}=P(),{fetchOwnerVeNFT:l}=G(),{xCetusSdk:u}=U(),{veNFT:t}=M(),[r,d]=p.useState(""),[n,a]=p.useState(""),[C,b]=p.useState(180),[y,g]=p.useState(""),[T,f]=p.useState(!0),{balanceInfo:D}=re(I.cetus_coin),j=(h,k)=>{f(k),k?d(h):a(h),R(h,k,C)},v=h=>{b(h),R(T?r:n,T,h)},R=async(h,k,X)=>{if(+h){const E=ee(h,9);if(k){const S=await u.XCetusModule.redeemNum(E,X);a(A(S.amount_out,9)),g(Z(S.percent).mul(100).toFixed(2,se.ROUND_DOWN))}else{const S=await u.XCetusModule.reverseRedeemNum(E,X);d(A(S.amount_out,9)),g(Z(S.percent).mul(100).toFixed(2,se.ROUND_DOWN))}}else d(""),a(""),g("")},[_,O]=p.useState(!1),J=async()=>{if(!t)return;O(!0);const h={venft_id:t.id,amount:ee(r,9).toFixed(0),lock_day:C},k=u.XCetusModule.redeemLockPayload(h),X=await s(k,{getShowInfo:E=>{const S=`Redeeming ${Q(r)} xCETUS to ${Q(n)} CETUS`,V={modalTitleText:"Redeem",modalDescriptionText:S,toastDescriptionContent:S};if(E==="success"){const m=S.replace("Redeeming","Redeemed");V.modalDescriptionText=m,V.toastDescriptionContent=m}return V}},{msafeParams:{action:H.xCETUSRedeemLock,txbParams:h}});O(!1),X&&(o&&l(o==null?void 0:o.address,!0),d(""),a(""),i(),c())},$=p.useMemo(()=>{const h={text:"Redeem",disabled:!1};return o!=null&&o.address?+r?(+r&&Z(r).gt(x||0)&&(h.disabled=!0,h.text="Insufficient xCETUS Balance"),h):(h.text="Enter an amount",h.disabled=!0,h):(h.text="Connect Wallet",h.disabled=!1,h)},[x,o==null?void 0:o.address,r]);return{inputAmountFrom:r,inputAmountTo:n,handleInputChange:j,balanceInfoTo:D,convertLoading:_,btnText:$.text,btnDisabled:$.disabled,handleConvertClick:J,day:C,handleDayChange:v,percent:y}}function Ve(x){const{day:i,onChange:c}=x,s=p.useMemo(()=>`${i}D`,[i]),o=[{label:"15D"},{label:"30D"},{label:"90D"},{label:"180D"}];return e.jsxs(be,{children:[e.jsxs(F,{w:"100%",justifyContent:"space-between",m:"10px 0",children:[e.jsxs(L,{fontSize:"16px",color:"text_caption",whiteSpace:"nowrap",children:[i," Days"]}),e.jsx(ye,{type:"outlineTab",tabList:o,currentTab:s,handleChangeTab:l=>{l.label==="MAX"?c(100):c(l.label.replace("D",""))},wrapStyle:{flex:"1",maxW:"300px",h:"32px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),e.jsxs(ge,{"aria-label":"slider-ex-1",min:15,max:180,focusThumbOnChange:!1,value:Number(i),onChange:l=>c(l),children:[e.jsx(Se,{h:"8px",children:e.jsx(we,{h:"4px"})}),e.jsx(Te,{})]})]})}function ot(x){const{availableXCetusAmount:i,iconParams:c,onIconClick:s}=x,{currentAccount:o,onWalletModal:l}=P(),{inputAmountFrom:u,inputAmountTo:t,handleInputChange:r,balanceInfoTo:d,btnText:n,btnDisabled:a,handleConvertClick:C,day:b,handleDayChange:y,percent:g,convertLoading:T}=Be(i),{showConvertModel:f}=M(),[D,j]=p.useState(!1);return e.jsxs(N,{w:"100%",gap:"8px",children:[e.jsx(ie,{onClick:s,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:i,value:u,amountValue:"",loading:!1,onChange:v=>{r(v,!0)},selectable:!1,placeholder:"0.0",token:I.x_cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:(d==null?void 0:d.balanceFormat)||"",value:t,half:!1,max:!1,amountValue:"",onChange:v=>{r(v,!1)},selectable:!1,placeholder:"0.0",token:I.cetus_coin},iconParams:c}),e.jsxs(oe,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(L,{mb:"16px",color:"primary_gray",children:"Vesting duration"}),e.jsx(Ve,{day:b,onChange:v=>{y(Number(v))}})]}),e.jsx(oe,{borderRadius:"12px",p:"0px",border:"none",children:e.jsxs(N,{w:"100%",gap:"20px",children:[e.jsx(te,{mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:a||T,isLoading:T,onClick:()=>{o?f?j(!0):C():l(!0)},children:n}),+g&&e.jsx(F,{w:"100%",p:"34px 16px 20px",border:"1px solid",borderColor:"border",mt:"-34px",borderRadius:"12px",children:e.jsx(Pe,{label:"Redeem ratio",labelStyle:{fontSize:"14px"},value:ae(g),valueStyle:{fontSize:"14px"}})})]})}),D&&e.jsx(le,{isOpen:D,onClose:()=>{j(!1)},onSubmitClick:()=>{j(!1),C()}})]})}function at(){const{fetchAccountBalance:x}=B(),{fetchOwnerLockCetusList:i}=q(),{signAndExecuteTransaction:c}=W(),{xCetusSdk:s}=U(),{veNFT:o}=M(),{fetchOwnerVeNFT:l}=G(),{currentAccount:u}=P(),[t,r]=p.useState(!1);return{handleCancelOrder:async n=>{if(!o)return;r(!0);const a={venft_id:o.id,lock_id:n.id},C=s.XCetusModule.cancelRedeemPayload(a),b=await c(C,{},{msafeParams:{action:H.xCETUSCancelRedeem,txbParams:a}});r(!1),b&&(x(),i(),u&&l(u==null?void 0:u.address,!0))},cancelOrderLoading:t}}function rt(){const{fetchAccountBalance:x}=B(),{fetchOwnerLockCetusList:i}=q(),{signAndExecuteTransaction:c}=W(),{xCetusSdk:s}=U(),{veNFT:o}=M(),{fetchOwnerVeNFT:l}=G(),{currentAccount:u}=P(),[t,r]=p.useState(!1);return{handleClaimOrder:async n=>{if(r(!0),!o)return;const a={lock_id:n,venft_id:o.id},C=await s.XCetusModule.redeemPayload(a),b=await c(C,{},{useDevInspect:!1,msafeParams:{action:H.xCETUSRedeem,txbParams:a}});r(!1),b&&(x(),i(),u&&l(u==null?void 0:u.address,!0))},claimOrderLoading:t}}function ct({xcetus_amount:x,cetus_amount:i,imageSize:c="24px"}){const{isApp:s}=ve();return s?e.jsxs(N,{w:"100%",align:"center",gap:"8px",children:[e.jsxs(F,{children:[e.jsx(K,{imageUrl:I.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:c,h:c,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(L,{color:"text_caption",children:[z(A(x,9),9)," xCETUS"]})]}),e.jsx(L,{color:"text_caption",transform:"rotate(90deg)",children:"→"}),e.jsxs(F,{children:[e.jsx(K,{imageUrl:I.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:c,h:c,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(L,{color:"text_caption",children:[z(A(i,9),9)," CETUS "]})]})]}):e.jsxs(F,{children:[e.jsx(K,{imageUrl:I.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:c,h:c,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(L,{color:"text_caption",children:[z(A(x,9),9)," xCETUS →"]}),e.jsx(K,{imageUrl:I.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:c,h:c,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(L,{color:"text_caption",children:[z(A(i,9),9)," CETUS "]})]})}function it(){const{fetchAccountBalance:x}=B(),{signAndExecuteTransaction:i}=W(),{xCetusSdk:c}=U(),{veNFT:s}=M(),[o,l]=p.useState(!1),{fetchVeNFTDividendInfo:u}=ce();return{handleClaimReward:async r=>{if(s){l(!0),console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:23 ~ handleClaimReward ~ rewardList:",r);try{const d=c.XCetusModule.redeemDividendV3Payload(s.id,r),n=await i(d,{},{useDevInspect:!0,msafeParams:{action:H.xCETUSClaimStakingRwewards,txbParams:{veNftId:s.id,rewardList:r}}});l(!1),n&&(x(),u(s.id))}catch(d){console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:40 ~ handleClaimReward ~ error:",d)}finally{l(!1)}}},claimRewardLoading:o}}function Ne(){const{getTokenPrice:x,fetchTokenPrices:i}=ke();return{refreshCoinPriceInfo:async(s,o=!1)=>{const l=new Set;o||s.forEach(u=>{x(u,6e5)||l.add(u)}),console.log("🚀 ~ refreshCoinPriceInfo ~ notFetchCoinList:",{notFetchCoinList:l,coinTypeList:s}),l.size>0&&await i(Array.from(l),!1)}}}function lt(){const{limitUserIndexerObj:x,setLimitUserIndexerObj:i,dcaUserIndexerObj:c,setDcaUserIndexerObj:s}=Ee(),{peripherySdk:o}=U();return{getLimitUserIndexer:async t=>{const r=x[t];if(r)return r;try{const d=new Me;o.LimitOrder.buildGetUserIndexerHandle(t,d);const n=await o.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:d,sender:De("0x0")}),a=o.LimitOrder.parsedQueryUserIndexerEvent(n);if(a)return i(t,a),a}catch(d){throw console.log("🚀 ~ getLimitUserIndexer ~ error:",d),d}},getDcaUserIndexer:async t=>{const r=c[t];if(r)return r;try{const{dca:d}=o.sdkOptions,{user_indexer_id:n}=Ie(d),a=await o.ClmmSDK.fullClient.getDynamicFieldObject({parentId:n,name:{type:"address",value:t}}),C=je(a).value.fields.id.id;if(C)return s(t,C),C}catch(d){throw console.log("🚀 ~ getDcaUserIndexer ~ error:",d),d}}}}function dt(x=!1){const{xCetusSdk:i}=U(),{currentAccount:c}=P(),{fetchAccountBalance:s}=B(),{refreshCoinPriceInfo:o}=Ne(),{lockCetusList:l,veNFTLoading:u,lockCetusListLoading:t,clearData:r,owner:d,veNFT:n,XCetusManager:a,setXCetusManager:C,setDividendManager:b,setPhaseDividendInfoMap:y,phaseDividendInfoMap:g}=M(),{nextStartTime:T,currentPeriod:f,calculateCurrPeriod:D}=Le(),{summaryRewardList:j,rewardList:v,totalRewardValue:R}=Oe(f),{fetchVeNFTDividendInfo:_}=ce(),O=async m=>{try{const w=await i.XCetusModule.getXcetusManager(m);w&&C(w)}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},J=async m=>{try{const w=await i.XCetusModule.getPhaseDividendInfo(m.toString());if(w)y(w);else{const de=(m-1).toString();if(!g[de]){const ne=await i.XCetusModule.getPhaseDividendInfo(m.toString());ne&&y(ne)}}}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},$=async m=>{try{const w=await i.XCetusModule.getDividendManager(m);w&&b(w)}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},{fetchOwnerVeNFT:h}=G(),k=p.useMemo(()=>{if(n&&c&&!t){const m=Re.getAvailableXCetus(n,l);if(Y(m).gte(0))return m}return"0"},[n==null?void 0:n.xcetus_balance,l]),X=p.useMemo(()=>{if(n){const m=Y(n.xcetus_balance).sub(k);if(m.gte(0))return m.toFixed(0)}return"0"},[n==null?void 0:n.xcetus_balance,k]),E=p.useMemo(()=>{if(a&&n){const m=Y(n.xcetus_balance).div(a.treasury).mul(100);return Y(m).lt(.01)?"<0.01%":ae(m.toString(),3)}return c?"0%":"--"},[a==null?void 0:a.treasury,n==null?void 0:n.xcetus_balance]),S=p.useMemo(()=>{if(f){let m=g[f.toString()];return m===void 0&&(m=g[(f-1).toString()]),m}},[g,f]),{cetusApr:V}=Ae(S,a==null?void 0:a.treasury);return p.useEffect(()=>{if(S){const m=S.bonus_types.map(w=>_e(w,!1));m&&(m.push("0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),o(m))}},[S==null?void 0:S.id]),p.useEffect(()=>{f&&f>0&&J(f)},[f]),p.useEffect(()=>{n&&!x&&_(n.id)},[n==null?void 0:n.id]),{fetchOwnerVeNFT:h,fetchAccountBalance:s,fetchXCetusManager:O,fetchDividendManager:$,fetchVeNFTDividendInfo:_,veNFTLoading:u,lockCetusListLoading:t,redeemingXCetusAmount:X,availableXCetusAmount:k,veNFT:n,myShare:E,nextStartTime:T,cetusApr:V,summaryRewardList:j,rewardList:v,totalRewardValue:R,lockCetusList:l,calculateCurrPeriod:D}}export{st as C,ct as X,at as a,rt as b,it as c,dt as d,ot as e,Ne as f,lt as g,nt as u};
//# sourceMappingURL=useXCetus-ChoDC7mr.js.map

{"version":3,"file":"FreshProgressV2-CRfOEZz5.js","sources":["../../../../node_modules/.pnpm/ahooks@3.8.4_react@18.3.1/node_modules/ahooks/es/useInterval/index.js","../../src/components/swap/FreshProgressV2.tsx"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport { isNumber } from '../utils';\nvar useInterval = function (fn, delay, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  var timerCallback = useMemoizedFn(fn);\n  var timerRef = useRef(null);\n  var clear = useCallback(function () {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n  }, []);\n  useEffect(function () {\n    if (!isNumber(delay) || delay < 0) {\n      return;\n    }\n    if (options.immediate) {\n      timerCallback();\n    }\n    timerRef.current = setInterval(timerCallback, delay);\n    return clear;\n  }, [delay, options.immediate]);\n  return clear;\n};\nexport default useInterval;","import { cancelBubble } from '@cetus/utils'\nimport {\n  Center,\n  CircularProgress,\n  CircularProgressProps,\n  HTMLChakraProps,\n  Popover,\n  PopoverBody,\n  PopoverContent,\n  PopoverTrigger\n} from '@chakra-ui/react'\nimport { useInterval } from 'ahooks'\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react'\n\ninterface FreshProgressProps extends HTMLChakraProps<'div'> {\n  callbackInterval?: number\n  min: number\n  max: number\n  onClick: () => void\n  size?: string\n  noBg?: boolean\n  thickness?: CircularProgressProps['thickness']\n}\n\nexport interface FreshProgressRef {\n  reset: () => void\n}\n\nconst FreshProgressV2 = forwardRef<FreshProgressRef, FreshProgressProps>(\n  ({ callbackInterval = 20, min, max, onClick, size = '18px', noBg, thickness = '10px', ...rest }, ref) => {\n    const [refreshCount, setRefreshCount] = useState<number>(0)\n\n    // Expose reset method to parent via ref\n    useImperativeHandle(ref, () => ({\n      reset: () => setRefreshCount(0)\n    }))\n\n    // Interval for auto-increment\n\n    const clear = useInterval(() => {\n      setRefreshCount(prev => {\n        const newCount = prev + 1\n        if (newCount >= callbackInterval) {\n          onClick()\n          return 0 // Reset after calling onClick\n        }\n        return newCount\n      })\n    }, 1000)\n\n    useEffect(() => {\n      return () => {\n        clear()\n      }\n    }, [])\n\n    return (\n      <>\n        {noBg ? (\n          <Center\n            p=\"2px\"\n            cursor=\"pointer\"\n            onClick={e => {\n              cancelBubble(e)\n              setRefreshCount(0) // Reset on manual click\n              onClick()\n            }}\n          >\n            <CircularProgress\n              min={min}\n              max={max}\n              value={refreshCount}\n              size={size}\n              color=\"text_highlight\"\n              trackColor=\"circle_progress_track_color\"\n              thickness={thickness}\n            />\n          </Center>\n        ) : (\n          <Popover isLazy trigger=\"hover\" autoFocus={false} returnFocusOnClose={false} gutter={4}>\n            <PopoverTrigger>\n              <Center\n                w=\"28px\"\n                h=\"28px\"\n                border=\"1px solid\"\n                borderColor=\"border\"\n                borderRadius=\"8px\"\n                bg=\"bg_secondary\"\n                cursor=\"pointer\"\n                {...rest}\n                onClick={() => {\n                  setRefreshCount(0) // Reset on manual click\n                  onClick()\n                }}\n              >\n                <CircularProgress\n                  min={min}\n                  max={max}\n                  value={refreshCount}\n                  size={size}\n                  color=\"text_highlight\"\n                  trackColor=\"circle_progress_track_color\"\n                />\n              </Center>\n            </PopoverTrigger>\n            <PopoverContent>\n              <PopoverBody p=\"12px\" lineHeight=\"20px\" fontSize=\"12px\">\n                Auto refresh in {callbackInterval} seconds, you can click to update manually.\n              </PopoverBody>\n            </PopoverContent>\n          </Popover>\n        )}\n      </>\n    )\n  }\n)\n\nexport default FreshProgressV2\n"],"names":["useInterval","fn","delay","options","timerCallback","useMemoizedFn","timerRef","useRef","clear","useCallback","useEffect","isNumber","FreshProgressV2","forwardRef","callbackInterval","min","max","onClick","size","noBg","thickness","rest","ref","refreshCount","setRefreshCount","useState","useImperativeHandle","prev","newCount","jsx","Center","e","cancelBubble","CircularProgress","jsxs","Popover","PopoverTrigger","PopoverContent","PopoverBody"],"mappings":"kLAGA,IAAIA,EAAc,SAAUC,EAAIC,EAAOC,EAAS,CAC1CA,IAAY,SACdA,EAAU,CAAE,GAEd,IAAIC,EAAgBC,EAAcJ,CAAE,EAChCK,EAAWC,EAAM,OAAC,IAAI,EACtBC,EAAQC,EAAAA,YAAY,UAAY,CAC9BH,EAAS,SACX,cAAcA,EAAS,OAAO,CAEjC,EAAE,EAAE,EACLI,OAAAA,EAAAA,UAAU,UAAY,CACpB,GAAI,GAACC,EAAST,CAAK,GAAKA,EAAQ,GAGhC,OAAIC,EAAQ,WACVC,EAAe,EAEjBE,EAAS,QAAU,YAAYF,EAAeF,CAAK,EAC5CM,CACR,EAAE,CAACN,EAAOC,EAAQ,SAAS,CAAC,EACtBK,CACT,ECGA,MAAMI,EAAkBC,EAAA,WACtB,CAAC,CAAE,iBAAAC,EAAmB,GAAI,IAAAC,EAAK,IAAAC,EAAK,QAAAC,EAAS,KAAAC,EAAO,OAAQ,KAAAC,EAAM,UAAAC,EAAY,OAAQ,GAAGC,CAAA,EAAQC,IAAQ,CACvG,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SAAiB,CAAC,EAG1DC,EAAA,oBAAoBJ,EAAK,KAAO,CAC9B,MAAO,IAAME,EAAgB,CAAC,CAAA,EAC9B,EAII,MAAAhB,EAAQR,EAAY,IAAM,CAC9BwB,EAAwBG,GAAA,CACtB,MAAMC,EAAWD,EAAO,EACxB,OAAIC,GAAYd,GACNG,EAAA,EACD,GAEFW,CAAA,CACR,GACA,GAAI,EAEPlB,OAAAA,EAAAA,UAAU,IACD,IAAM,CACLF,EAAA,CACR,EACC,EAAE,oBAIA,SACCW,EAAAU,EAAA,IAACC,EAAA,CACC,EAAE,MACF,OAAO,UACP,QAAcC,GAAA,CACZC,EAAaD,CAAC,EACdP,EAAgB,CAAC,EACTP,EAAA,CACV,EAEA,SAAAY,EAAA,IAACI,EAAA,CACC,IAAAlB,EACA,IAAAC,EACA,MAAOO,EACP,KAAAL,EACA,MAAM,iBACN,WAAW,8BACX,UAAAE,CAAA,CAAA,CACF,CAGF,EAAAc,EAAA,KAACC,EAAQ,CAAA,OAAM,GAAC,QAAQ,QAAQ,UAAW,GAAO,mBAAoB,GAAO,OAAQ,EACnF,SAAA,CAAAN,MAACO,EACC,CAAA,SAAAP,EAAA,IAACC,EAAA,CACC,EAAE,OACF,EAAE,OACF,OAAO,YACP,YAAY,SACZ,aAAa,MACb,GAAG,eACH,OAAO,UACN,GAAGT,EACJ,QAAS,IAAM,CACbG,EAAgB,CAAC,EACTP,EAAA,CACV,EAEA,SAAAY,EAAA,IAACI,EAAA,CACC,IAAAlB,EACA,IAAAC,EACA,MAAOO,EACP,KAAAL,EACA,MAAM,iBACN,WAAW,6BAAA,CAAA,CACb,CAAA,EAEJ,EACAW,EAAAA,IAACQ,GACC,SAACH,EAAAA,KAAAI,EAAA,CAAY,EAAE,OAAO,WAAW,OAAO,SAAS,OAAO,SAAA,CAAA,mBACrCxB,EAAiB,6CAAA,CAAA,CACpC,CACF,CAAA,CAAA,CAAA,CACF,CAEJ,CAAA,CAAA,CAGN","x_google_ignoreList":[0]}
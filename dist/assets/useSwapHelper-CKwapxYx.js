import{u as b}from"./useToken-BlS8b5ft.js";import{r as A,aO as e,aX as M}from"./index-D49RffYW.js";import{u as G}from"./global-iZ7St_zm.js";import{u as H}from"./useGetPoolList-DBJielhS.js";var _=(t=>(t.CETUS="CETUS",t.KRIYA="KRIYA",t.KRIYAV3="KRIYAV3",t.FLOWX="FLOWX",t.FLOWXV3="FLOWXV3",t.AFTERMATH="AFTERMATH",t.METASTABLE="METASTABLE",t.HAEDAL="HAEDAL",t.VOLO="VOLO",t.AFSUI="AFSUI",t.DEEPBOOKV3="DEEPBOOKV3",t.SCALLOP="SCALLOP",t.BLUEMOVE="BLUEMOVE",t.TURBOS="TURBOS",t.SPRINGSUI="SPRINGSUI",t.BLUEFIN="BLUEFIN",t.HAEDALPMM="HAEDALPMM",t.ALPHAFI="ALPHAFI",t.STEAMM="STEAMM",t.OBRIC="OBRIC",t))(_||{}),$=(t=>(t[t.CalculateError=1e4]="CalculateError",t[t.NumberTooLarge=10001]="NumberTooLarge",t[t.NoRouter=10002]="NoRouter",t[t.InsufficientLiquidity=10003]="InsufficientLiquidity",t[t.HoneyPot=10004]="HoneyPot",t))($||{}),K=(t=>(t.TradeInputPage="TradeInput",t.TradeStatus="TradeStatus",t.SelectTokenPage="SelectToken",t.TradeConfirmPage="TradeConfirm",t.RoutePage="Route",t.TradeSetting="TradeSetting",t.SlippageSetting="SlippageSetting",t))(K||{});function N(t=!0){const{poolApiMap:s,setPoolApiMap:i}=G(),{getPoolList:f,getLocalJsonPoolList:T,getLocalJsonPoolAddress:I}=H();return{getPoolListByCoinType:async(u,o)=>{if(u&&o){const d=[u,o].sort(),p=`${d[0]}_${d[1]}`,c=s[p];if(c)return c;const m={coin_type:`${u},${o}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0};let n=t?await T(m):void 0;(n===void 0||n.list.length===0)&&(n=await f(m));const l=n.list;if(l.length>0)return s[p]=l,i(p,l),l}return[]},getPoolAddressByCoinType:async(u,o)=>{if(u&&o){const d=[u,o].sort(),p=`${d[0]}_${d[1]}`;if(t){const n=await I(u,o);if(!n||n.length===0){const l=s[p];if(l)return l.map(L=>L.poolAddress)}else return n}const c={coin_type:`${u},${o}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0},m=await f(c);if(m){const n=m.list;if(n.length>0)return s[p]=n,i(p,n),n.map(l=>l.poolAddress)}}return[]}}}function q(t,s){return{priceAcceptRouterData:A.useMemo(()=>{if(s&&t){if(t.byAmountIn){if(!e(t.toAmountUi).eq(s.toAmountUi||"0"))return s}else if(!e(t.fromAmountUi).eq(s.fromAmountUi||"0"))return s;return}},[s,t])}}function Y(t,s){return{amountLimit:A.useMemo(()=>{if(s&&s.routerData){const{byAmountIn:f,fromAmountUi:T,toAmountUi:I}=s;return f?e(I).mul(e(1).sub(e(t))).toString():e(T).mul(e(1).add(e(t))).toString()}},[t,s])}}function J(t){const{getTokenInfo:s,fetchTokenInfo:i}=b(),[f,T]=A.useState({}),I=async()=>{var r,R,u;if(t&&t.routerData){const o=[],d=t.byAmountIn?t.routerData.amountIn.toString():t.routerData.amountOut.toString(),p=[],c=[];let m=e(0);const n=((r=t==null?void 0:t.routerData)==null?void 0:r.routes)||[];for(let L=0;L<n.length;L++){const y=n[L],h={},B=t.byAmountIn?y.amountIn.toString():y.amountOut.toString();L===t.routerData.routes.length-1?h.percentage=e(1).sub(m).toFixed(2):h.percentage=e(B).div(d).toFixed(2),m=e(m).add(h.percentage);const E=[];for(let F=0;F<((R=y==null?void 0:y.path)==null?void 0:R.length);F++){const a=(u=y==null?void 0:y.path)==null?void 0:u[F];o.includes(a.provider)||o.push(a.provider);const S=M(a.from).full_address,O=M(a.target).full_address,U=await i(S),P=await i(O);U||c.includes(S)&&c.push(S),P||c.includes(O)&&c.push(O);const V=a.provider===_.SCALLOP||a.provider===_.FLOWX||a.provider===_.FLOWXV3;E.push({from_type:S,to_type:O,pool_address:V?"":a.id,fee_rate:a.feeRate,provider:a.provider})}h.paths=E,p.push(h)}if(c.length>0)for(const L in c)i(L);const l={router_summery:`${t.routerData.routes.length} Streams`,providers:o,routers:p};T(l);return}T(void 0)};return A.useEffect(()=>{I()},[t]),{formatSwapRouter:f}}function j(){const{getPoolAddressByCoinType:t}=N(!0);return{getSwapPoolAddress:async(i,f)=>i&&f?await t(i.coin_type,f.coin_type):[]}}function z(t,s){return A.useMemo(()=>t&&s&&+t&&+s?e(s).div(t).toString():"0",[t,s])}export{$ as A,K as S,_ as a,Y as b,q as c,z as d,j as e,J as u};

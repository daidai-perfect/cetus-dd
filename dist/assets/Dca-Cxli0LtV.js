import{n as dt,o as ts,p as ss,r as u,q as ft,v as jt,t as as,w as ns,x as is,y as ls,z as cs,A as os,D as Ye,E as gt,F as Pt,G as ht,J as rs,K as tt,L as us,M as ps,N as xs,j as t,O as Wt,P as st,Q as _t,R as Xe,U as ms,u as Dt,b as ot,e as Bt,V as q,k as Ht,W as Qe,S as ct,d as w,H as N,X as yt,Y as F,T as E,Z as Ie,I as Re,C as et,$ as He,B as Vt,a0 as ds,a1 as rt,a2 as gs,a3 as Tt,a4 as hs,a5 as ys,a6 as vs,a7 as Ce,a8 as nt,a9 as vt,aa as At,ab as Ke,ac as Ss,g as bs,ad as it,ae as _s,af as Ds,ag as ws,ah as fs,ai as js,aj as Ps,ak as Ts,al as As,am as ks,an as Os,ao as Cs}from"./index-B0zUQ3Cp.js";import{L as Rs,T as Ns,a as Ms}from"./LimitPriceChart-umAbN44O.js";import{P as Ft}from"./Pagination-9yxQC5wc.js";import{N as St}from"./NoData-JcjS0_6N.js";import{u as ut}from"./useTransaction-BROrwLEz.js";import{F as kt,M as Es}from"./MenuDropBlock-BHOi5WRK.js";import{u as Ut,R as Gt}from"./RangeValue-NtFLQRfu.js";import{D as $s,e as zs,g as Ls}from"./api-data-utils-CKHHanFA.js";import{H as we}from"./HTextLabelBox-BLoxKcLW.js";import{u as wt}from"./useAccountBalance-BdD7ybCo.js";import{P as Ws}from"./progress-EQkDASih.js";import{u as Bs}from"./useInsufficientBalanceToast-BsjyXDXZ.js";import{A as Hs}from"./aggregator-BM74sPf2.js";import{u as Vs,A as Ot}from"./useFindBestRouting-BMIUg35j.js";import{u as Ct}from"./useTokenBalance-DgQuOgL6.js";import{u as qt}from"./useToken-C-8_jnEM.js";import{i as Fs}from"./icon_currentprice@2x-DeObnx8l.js";import{C as Us}from"./CurrentPrice-ch5rOfzo.js";import{T as Gs}from"./TooltipIcon-DRix-q1H.js";import{T as qs}from"./TradeInputGroup-DjjU8vYj.js";import{W as Ys}from"./WarningTokenTipModal-DlcrUbmN.js";import{S as Rt}from"./SingleTokenInfo-wAYGafzz.js";import{I as Yt}from"./InputBox-Cq5tSrIS.js";import{u as Ks}from"./global-DtQVOJ6j.js";import{C as Nt}from"./CetusTooltip-Dg4BiRP-.js";import{I as Mt}from"./IconBg-DPqIKBNb.js";import{u as Qs}from"./useRpcListener-Bvg11thl.js";import"./circular-progress-CsRY95gg.js";import"./progress.utils-pwfPfuH5.js";import"./useGetPoolList-DmV38xks.js";import"./_getAllKeysIn-CgkQtMIs.js";import"./AddressCopyLink-Bd0Relyl.js";import"./AddressUnderline-u82jp59a.js";import"./usePreviousValue-ChmxO2Bf.js";function Xs(a){const{min:s=0,max:e=100,onChange:h,value:o,defaultValue:l,isReversed:i,direction:n="ltr",orientation:r="horizontal",id:c,isDisabled:m,isReadOnly:d,onChangeStart:_,onChangeEnd:g,step:p=1,getAriaValueText:v,"aria-valuetext":k,"aria-label":T,"aria-labelledby":R,name:U,focusThumbOnChange:B=!0,minStepsBetweenThumbs:O=0,...K}=a,X=dt(_),J=dt(g),H=dt(v),ee=ts({isReversed:i,direction:n,orientation:r}),[te,z]=ss({value:o,defaultValue:l??[25,75],onChange:h});if(!Array.isArray(te))throw new TypeError(`[range-slider] You passed an invalid value for \`value\` or \`defaultValue\`, expected \`Array\` but got \`${typeof te}\``);const[$,ce]=u.useState(!1),[se,ae]=u.useState(!1),[S,b]=u.useState(-1),M=!(m||d),D=u.useRef(te),f=te.map(y=>ft(y,s,e)),C=O*p,Z=Js(f,s,e,C),L=u.useRef({eventSource:null,value:[],valueBounds:[]});L.current.value=f,L.current.valueBounds=Z;const de=f.map(y=>e-y+s),Me=(ee?de:f).map(y=>jt(y,s,e)),Ee=r==="vertical",ge=u.useRef(null),fe=u.useRef(null),Se=u.useId(),Q=ls(c??Se),I=u.useCallback(y=>{var ne;if(!ge.current)return;L.current.eventSource="pointer";const j=ge.current.getBoundingClientRect(),{clientX:P,clientY:W}=((ne=y.touches)==null?void 0:ne[0])??y,G=Ee?j.bottom-W:P-j.left,me=Ee?j.height:j.width;let xe=G/me;return ee&&(xe=1-xe),as(xe,s,e)},[Ee,ee,e,s]),je=(e-s)/10,ye=p||(e-s)/100,Y=u.useMemo(()=>({setValueAtIndex(y,j){if(!M)return;const P=L.current.valueBounds[y];j=parseFloat(ns(j,P.min,ye)),j=ft(j,P.min,P.max);const W=[...L.current.value];W[y]=j,z(W)},setActiveIndex:b,stepUp(y,j=ye){const P=L.current.value[y],W=ee?P-j:P+j;Y.setValueAtIndex(y,W)},stepDown(y,j=ye){const P=L.current.value[y],W=ee?P+j:P-j;Y.setValueAtIndex(y,W)},reset(){z(D.current)}}),[ye,ee,z,M]),Pe=u.useCallback(y=>{const j=y.key,W={ArrowRight:()=>Y.stepUp(S),ArrowUp:()=>Y.stepUp(S),ArrowLeft:()=>Y.stepDown(S),ArrowDown:()=>Y.stepDown(S),PageUp:()=>Y.stepUp(S,je),PageDown:()=>Y.stepDown(S,je),Home:()=>{const{min:G}=Z[S];Y.setValueAtIndex(S,G)},End:()=>{const{max:G}=Z[S];Y.setValueAtIndex(S,G)}}[j];W&&(y.preventDefault(),y.stopPropagation(),W(y),L.current.eventSource="keyboard")},[Y,S,je,Z]),{getThumbStyle:Te,rootStyle:Ae,trackStyle:Ve,innerTrackStyle:$e}=u.useMemo(()=>is({isReversed:ee,orientation:r,thumbPercents:Me}),[ee,r,Me]),ke=u.useCallback(y=>{var P;const j=y??S;if(j!==-1&&B){const W=Q.getThumb(j),G=(P=fe.current)==null?void 0:P.ownerDocument.getElementById(W);G&&setTimeout(()=>G.focus())}},[B,S,Q]);cs(()=>{L.current.eventSource==="keyboard"&&(J==null||J(L.current.value))},[f,J]);const Fe=y=>{const j=I(y)||0,P=L.current.value.map(ne=>Math.abs(ne-j)),W=Math.min(...P);let G=P.indexOf(W);const me=P.filter(ne=>ne===W);me.length>1&&j>L.current.value[G]&&(G=G+me.length-1),b(G),Y.setValueAtIndex(G,j),ke(G)},ze=y=>{if(S==-1)return;const j=I(y)||0;b(S),Y.setValueAtIndex(S,j),ke(S)};os(fe,{onPanSessionStart(y){M&&(ce(!0),Fe(y),X==null||X(L.current.value))},onPanSessionEnd(){M&&(ce(!1),J==null||J(L.current.value))},onPan(y){M&&ze(y)}});const be=u.useCallback((y={},j=null)=>({...y,...K,id:Q.root,ref:Pt(j,fe),tabIndex:-1,"aria-disabled":gt(m),"data-focused":Ye(se),style:{...y.style,...Ae}}),[K,m,se,Ae,Q]),Le=u.useCallback((y={},j=null)=>({...y,ref:Pt(j,ge),id:Q.track,"data-disabled":Ye(m),style:{...y.style,...Ve}}),[m,Ve,Q]),_e=u.useCallback((y={},j=null)=>({...y,ref:j,id:Q.innerTrack,style:{...y.style,...$e}}),[$e,Q]),Je=u.useCallback((y,j=null)=>{const{index:P,...W}=y,G=f[P];if(G==null)throw new TypeError(`[range-slider > thumb] Cannot find value at index \`${P}\`. The \`value\` or \`defaultValue\` length is : ${f.length}`);const me=Z[P];return{...W,ref:j,role:"slider",tabIndex:M?0:void 0,id:Q.getThumb(P),"data-active":Ye($&&S===P),"aria-valuetext":(H==null?void 0:H(G))??(k==null?void 0:k[P]),"aria-valuemin":me.min,"aria-valuemax":me.max,"aria-valuenow":G,"aria-orientation":r,"aria-disabled":gt(m),"aria-readonly":gt(d),"aria-label":T==null?void 0:T[P],"aria-labelledby":T!=null&&T[P]||R==null?void 0:R[P],style:{...y.style,...Te(P)},onKeyDown:ht(y.onKeyDown,Pe),onFocus:ht(y.onFocus,()=>{ae(!0),b(P)}),onBlur:ht(y.onBlur,()=>{ae(!1),b(-1)})}},[Q,f,Z,M,$,S,H,k,r,m,d,T,R,Te,Pe,ae]),Ue=u.useCallback((y={},j=null)=>({...y,ref:j,id:Q.output,htmlFor:f.map((P,W)=>Q.getThumb(W)).join(" "),"aria-live":"off"}),[Q,f]),We=u.useCallback((y,j=null)=>{const{value:P,...W}=y,G=!(P<s||P>e),me=P>=f[0]&&P<=f[f.length-1];let xe=jt(P,s,e);xe=ee?100-xe:xe;const ne={position:"absolute",pointerEvents:"none",...rs({orientation:r,vertical:{bottom:`${xe}%`},horizontal:{left:`${xe}%`}})};return{...W,ref:j,id:Q.getMarker(y.value),role:"presentation","aria-hidden":!0,"data-disabled":Ye(m),"data-invalid":Ye(!G),"data-highlighted":Ye(me),style:{...y.style,...ne}}},[m,ee,e,s,r,f,Q]),pe=u.useCallback((y,j=null)=>{const{index:P,...W}=y;return{...W,ref:j,id:Q.getInput(P),type:"hidden",value:f[P],name:Array.isArray(U)?U[P]:`${U}-${P}`}},[U,f,Q]);return{state:{value:f,isFocused:se,isDragging:$,getThumbPercent:y=>Me[y],getThumbMinValue:y=>Z[y].min,getThumbMaxValue:y=>Z[y].max},actions:Y,getRootProps:be,getTrackProps:Le,getInnerTrackProps:_e,getThumbProps:Je,getMarkerProps:We,getInputProps:pe,getOutputProps:Ue}}function Js(a,s,e,h){return a.map((o,l)=>{const i=l===0?s:a[l-1]+h,n=l===a.length-1?e:a[l+1]-h;return{min:i,max:n}})}const[Zs,pt]=Wt({name:"SliderContext",errorMessage:"useSliderContext: `context` is undefined. Seems you forgot to wrap all slider components within <RangeSlider />"}),[Is,xt]=Wt({name:"RangeSliderStylesContext",errorMessage:`useRangeSliderStyles returned is 'undefined'. Seems you forgot to wrap the components in "<RangeSlider />" `}),Kt=tt(function(s,e){const h={orientation:"horizontal",...s},o=us("Slider",h),l=ps(h),{direction:i}=xs();l.direction=i;const{getRootProps:n,...r}=Xs(l),c=u.useMemo(()=>({...r,name:h.name}),[r,h.name]);return t.jsx(Zs,{value:c,children:t.jsx(Is,{value:o,children:t.jsx(st.div,{...n({},e),className:"chakra-slider",__css:o.container,children:h.children})})})});Kt.displayName="RangeSlider";const bt=tt(function(s,e){const{getThumbProps:h,getInputProps:o,name:l}=pt(),i=xt(),n=h(s,e);return t.jsxs(st.div,{...n,className:_t("chakra-slider__thumb",s.className),__css:i.thumb,children:[n.children,l&&t.jsx("input",{...o({index:s.index})})]})});bt.displayName="RangeSliderThumb";const Qt=tt(function(s,e){const{getTrackProps:h}=pt(),o=xt(),l=h(s,e);return t.jsx(st.div,{...l,className:_t("chakra-slider__track",s.className),__css:o.track,"data-testid":"chakra-range-slider-track"})});Qt.displayName="RangeSliderTrack";const Xt=tt(function(s,e){const{getInnerTrackProps:h}=pt(),o=xt(),l=h(s,e);return t.jsx(st.div,{...l,className:"chakra-slider__filled-track",__css:o.filledTrack})});Xt.displayName="RangeSliderFilledTrack";const ea=tt(function(s,e){const{getMarkerProps:h}=pt(),o=xt(),l=h(s,e);return t.jsx(st.div,{...l,className:_t("chakra-slider__marker",s.className),__css:o.mark})});ea.displayName="RangeSliderMark";function Jt(){const{peripherySdk:a}=Xe();return{dcaCloseOrderPayload:async e=>await a.Dca.dcaCloseOrderPayload(e)}}function Zt(){const{peripherySdk:a}=Xe();return{dcaWithdrawPayload:async e=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaClaim.ts:12 ~ params:",e),await a.Dca.withdrawAll(e))}}const ta=(a,s)=>({upperPriceSize:"0%",setUpperPriceSize:e=>{a(()=>({upperPriceSize:e}))},lowerPriceSize:"0%",setLowerPriceSize:e=>{a(()=>({lowerPriceSize:e}))},dcaMode:"total",setDcaMode:e=>{a(()=>({dcaMode:e}))},isDcaRefresh:!1,setIsDcaRefresh:e=>{a(()=>({isDcaRefresh:e}))},pageDirect:!1,setPageDirect:e=>{a(()=>({pageDirect:e}))},sellTotalAmount:"",setSellTotalAmount:e=>{a(()=>({sellTotalAmount:e}))},sellAmount:"",setSellAmount:e=>{a(()=>({sellAmount:e}))},buyAmount:"",setBuyAmount:e=>{a(()=>({buyAmount:e}))},sellCoin:void 0,setSellCoin:e=>{a(()=>({sellCoin:e}))},buyCoin:void 0,setBuyCoin:e=>{a(()=>({buyCoin:e}))},orderNum:"2",setOrderNum:e=>{a(()=>({orderNum:e}))},investNum:"1",setInvestNum:e=>{a(()=>({investNum:e}))},currentCoinKey:"sellCoin",setCurrentCoinKey:e=>{a(()=>({currentCoinKey:e}))},currentInvest:"Hour",setCurrentInvest:e=>{a(()=>({currentInvest:e}))},pageLoading:!0,setPageLoading:e=>{a(()=>({pageLoading:e}))},dcaConfig:{},setDcaConfig:e=>{a(()=>({dcaConfig:e}))},dcaQuote:{},setDcaQuote:e=>{a(()=>({dcaQuote:e}))},orderHistoryObj:{},setOrderHistoryObj:e=>{a(()=>({orderHistoryObj:{...s().orderHistoryObj,...e}}))},inCoinWhiteList:[],setInCoinWhiteList:e=>{a(()=>({inCoinWhiteList:e}))},outCoinWhiteList:[],setOutCoinWhiteList:e=>{a(()=>({outCoinWhiteList:e}))}}),he=ms(ta);function sa(){const{fetchByApi:a}=Dt(),{setOrderHistoryObj:s}=he();return{getDcaOrderHistory:async({orderId:h,limit:o,offset:l})=>{var n;const i=await a($s,"GET",{order_id:h,limit:o,offset:l});if(console.log("ðŸš€ ~ file: useGetDcaOrderHistory.ts:16 ~ useGetDcaOrderHistory ~ res:",i),i!=null&&i.list){const r={[h]:{list:((n=i==null?void 0:i.list)==null?void 0:n.map(c=>({inAmount:c==null?void 0:c.in_amount,outAmount:c==null?void 0:c.out_amount,inCoinType:c==null?void 0:c.in_coin,outCoinType:c==null?void 0:c.out_coin,time:c==null?void 0:c.execution_at,tx:c==null?void 0:c.tx})))||[],total:(i==null?void 0:i.total)||0}};return s(r),r}}}}function aa({isDetail:a,currentTabVal:s,orderInfo:e,handleRefresh:h,pageDirect:o}){const{isApp:l}=ot(),{inCoin:i,outCoin:n}=e,{getDcaOrderHistory:r}=sa(),[c,m]=u.useState(o),[d,_]=u.useState(o),g=10,[p,v]=u.useState([]),[k,T]=u.useState(0),[R,U]=u.useState(1),[B,O]=u.useState(!1),[K,X]=u.useState({label:"Overview",value:"overview"}),J=u.useMemo(()=>[{label:"Overview",value:"overview"},{label:B||Number(k)===0?"Orders":`Orders (${k})`,value:"orders"}],[k]),H=b=>{X(b),e!=null&&e.orderID&&te(e==null?void 0:e.orderID,g,0,!1)};u.useEffect(()=>{a&&(e!=null&&e.orderID)&&te(e==null?void 0:e.orderID,g,0,!1)},[e,a]);const ee=b=>{console.log("ðŸš€ ~ handleCurrentPage ~ page:",b);const M=(b-1)*g;te(e==null?void 0:e.orderID,g,M,!1),U(b)},te=async(b,M,D,f=!1)=>{var Z,L,de,Ne;console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ loading:",f),O(f);const C=await r({orderId:b,limit:M,offset:D});console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ res?.list:",C,C[b]),(Z=C[b])!=null&&Z.list&&v((L=C[b])==null?void 0:L.list),(de=C[b])!=null&&de.total&&T((Ne=C[b])==null?void 0:Ne.total),O(!1),console.log("ðŸš€ ~ file: TestData.tsx:170 ~ handleGetDcaOrderHistory ~ res:",C)},[z,$]=u.useState(!1),{dcaWithdrawPayload:ce}=Zt();wt();const{signAndExecuteTransaction:se}=ut(),ae=async()=>{$(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",e);const b=[],M={order_id:e==null?void 0:e.orderID,in_coin_type:e==null?void 0:e.inCoin.coin_type,out_coin_type:e==null?void 0:e.outCoin.coin_type};b.push(M),console.log("ðŸš€ ~ toClaim ~ claimOrderParams:",b);const D=await ce(b),f=await se(D,{getShowInfo:C=>{var L,de;const Z={modalDescriptionText:`${(L=e==null?void 0:e.outCoin)==null?void 0:L.symbol} Claimed`,toastTitleText:`${(de=e==null?void 0:e.outCoin)==null?void 0:de.symbol} Claimed`};return C==="success"&&(Z.toastDescriptionContent=""),Z}});f&&(console.log("ðŸš€ ~ toClaim ~ res:",f),setTimeout(()=>{h()},2e3)),$(!1)}catch(b){console.log("ðŸš€ ~ toClaim ~ error:",b),$(!1)}},{getExplorerUrl:S}=Bt();return t.jsxs(q,{w:"100%",gap:"20px",children:[t.jsx(Ht,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:J,currentTab:K.label,handleChangeTab:H}),t.jsxs(Qe,{p:"30px 8px 20px",mt:"-42px",borderRadius:"8px",zIndex:"0",bg:"bg_primary",children:[K.value=="orders"&&(B?t.jsx(ct,{height:"4",width:"100%"}):(p==null?void 0:p.length)===0?t.jsx(St,{type:"nodata",text:"No orders",noBorder:!0,p:"12px",bg:"none"}):t.jsxs(q,{w:"100%",align:"flex-start",gap:"16px",mt:"12px",children:[!l&&t.jsxs(N,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[t.jsx(ue,{label:"Order info",value:"",w:{base:"100%",lg:"40%"}}),t.jsx(ue,{label:"Rate",value:"",w:{base:"100%",lg:"calc(32% - 16px)"},direct:d,onChangeDirect:()=>_(!d)}),t.jsx(ue,{label:"Time (UTC)",value:"",w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]}),p==null?void 0:p.map(b=>{console.log("ðŸš€ ~ {orderHistoryList?.map ~ orderHistory:",b);const M=yt(b.inAmount,i==null?void 0:i.decimals),D=yt(b.outAmount,n==null?void 0:n.decimals),f=w(M).div(D).toString(),C=w(1).div(f).toString();return t.jsxs(N,{w:"100%",flexDirection:{base:"column",lg:"row"},borderBottom:l?"1px solid":"none",pb:l?"16px":"0",borderColor:"border",_last:{borderBottom:"none",pb:"0"},children:[t.jsx(ue,{label:l?"Order info":"",value:`${F(M)} ${i.symbol} â†’ ${F(D)} ${n.symbol}`,w:{base:"100%",lg:"40%"}}),t.jsx(ue,{label:l?"Rate":"",value:d?`${F(f)} ${i.symbol} per ${n.symbol}`:`${F(C)} ${n.symbol} per ${i.symbol}`,w:{base:"100%",lg:"calc(32% - 16px)"},direct:d,showDirectIcon:!!l,onChangeDirect:()=>_(!d)}),t.jsx(ue,{label:l?"Time (UTC)":"",value:t.jsxs(N,{h:"12px",children:[t.jsx(E,{fontSize:"12px",color:"text_caption",children:Ie((b==null?void 0:b.time)*1e3,"YMDHM")}),t.jsx(Re,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(S(b==null?void 0:b.tx,"tx"))}})]}),w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]},b==null?void 0:b.time)}),w(k).gt(g)&&t.jsx(et,{w:"100%",children:t.jsx(Ft,{total:k,size:g,currentPage:R,onChange:ee})})]})),K.value=="overview"&&t.jsxs(q,{align:"flex-start",gap:"20px",children:[(e==null?void 0:e.isShowTradeTips)&&(e==null?void 0:e.orderStatus)=="Active"&&s=="active"&&t.jsx(na,{}),t.jsxs(q,{w:"100%",borderRadius:"8px",p:"12px",bg:"card_bg",gap:"12px",children:[t.jsx(we,{isLoading:!1,label:`DCA  ${i==null?void 0:i.symbol} Balance`,value:`${F(e==null?void 0:e.inBalance,2)||"0"} ${i==null?void 0:i.symbol}`,skeletonStyle:{valueW:"128px"}}),t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsxs(E,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance"]}),t.jsxs(N,{children:[t.jsxs(E,{color:"text_caption",fontSize:"12px",children:[(e==null?void 0:e.outBalance)>0?F(e==null?void 0:e.outBalance):e==null?void 0:e.outBalance," ",n==null?void 0:n.symbol]}),s=="active"&&t.jsx(He,{isLoading:z,onClick:ae,disabled:(e==null?void 0:e.outBalance)<=0||z,w:"60px",h:"20px",fontSize:"12px",borderRadius:"4px",variant:"outline",children:"Claim"})]})]}),t.jsx(we,{isLoading:!1,label:"Amount Withdrawn",value:s=="active"?`${F(e==null?void 0:e.outWithdraw,2)}`:(e==null?void 0:e.orderStatus)=="PartialDeal"||(e==null?void 0:e.orderStatus)=="Close"?w(e==null?void 0:e.outWithdraw).gt(0)?`${F(e==null?void 0:e.inWithdrawn)} ${i==null?void 0:i.symbol} ${F(e==null?void 0:e.outWithdraw)} ${n==null?void 0:n.symbol}`:`${F(e==null?void 0:e.inWithdrawn)} ${i==null?void 0:i.symbol}`:`${F(e==null?void 0:e.outWithdraw)} ${n==null?void 0:n.symbol}`,skeletonStyle:{valueW:"128px"}})]}),t.jsxs(N,{flexWrap:"wrap",p:{base:"0",lg:"0 12px"},mt:{base:"-12px",lg:"-28px"},sx:{">div":{mt:{base:"12px",lg:"28px"},w:{base:"100%",lg:"calc((100% - 66px)/3)"},"&:nth-child(3n+1)":{mr:{base:"0",lg:"50px"}}}},children:[t.jsx(ue,{label:"Invest Every",value:e==null?void 0:e.investEvery}),t.jsx(ue,{label:"# of Orders Left",value:e==null?void 0:e.ofOrderLeft}),t.jsx(ue,{label:"Each Order Size",value:`${e==null?void 0:e.eachOrderSize} ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right"}),t.jsx(ue,{label:"Minimum Price",value:c?`${e==null?void 0:e.minPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.minPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,direct:c,onChangeDirect:()=>m(!c)}),t.jsx(ue,{label:"Maximum Price",value:c?`${e==null?void 0:e.maxPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.maxPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,direct:c,onChangeDirect:()=>m(!c)}),s=="active"&&t.jsx(ue,{label:"Current Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>m(!c)}),s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"&&t.jsx(ue,{label:"Avg. Price",value:c?`${e==null?void 0:e.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right",direct:c,onChangeDirect:()=>m(!c)}),s=="active"&&t.jsx(ue,{label:"Next Order (UTC)",value:e==null?void 0:e.nextCycleAt}),t.jsx(ue,{label:"Created (UTC)",value:e==null?void 0:e.createAt,align:s=="active"||s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"?"flex-start":"flex-end"})]})]})]})]})}const ue=({label:a,value:s,direct:e,onChangeDirect:h,textAlign:o="left",showDirectIcon:l=!0,...i})=>t.jsxs(q,{align:"flex-start",flexDirection:{base:"row",lg:"column"},w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"unset"},...i,children:[a!==""&&t.jsxs(N,{h:"12px",children:[t.jsx(E,{fontSize:"12px",children:a}),h&&l&&t.jsx(Re,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:h})]}),s!==""&&t.jsx(Vt,{fontSize:"12px",color:"text_caption",textAlign:o,children:s})]}),na=()=>t.jsxs(q,{p:"12px 12px 0",align:"flex-start",children:[t.jsxs(N,{children:[t.jsx(Re,{xlinkHref:"#icon-icon-warning",svgFill:"primary_yellow"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"})]}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market price is not in your required price range"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market no longer exit"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market is extremely volatile"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"This DCA will continue to be attempted and the estimated end date may be extended until your order is fully executed."})]});function ia({currentTabVal:a,orderInfo:s,handleRefresh:e}){const{isApp:h}=ot(),{inCoin:o,outCoin:l}=s,[i,n]=u.useState(!1),[r,c]=u.useState(!1);u.useEffect(()=>{n(!1)},[a]);const{getTokenRank:m}=Ut(),[d,_]=u.useState(!1);u.useEffect(()=>{const T=m(o,l);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",l,o,T),_(!T)},[o==null?void 0:o.coin_type,l==null?void 0:l.coin_type]);const{dcaCloseOrderPayload:g}=Jt(),{signAndExecuteTransaction:p}=ut(),v=async()=>{c(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",s);const T=[{order_id:s==null?void 0:s.orderID,in_coin_type:s==null?void 0:s.inCoin.coin_type,out_coin_type:s==null?void 0:s.outCoin.coin_type}];console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-order-card.vue:280 ~ closeOrder ~ closeOrderParams:",T);const R=await g(T),U=await p(R,{getShowInfo:B=>{const O={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return B==="success"&&(O.modalDescriptionText="DCA Order Closed",O.toastDescriptionContent="DCA Order Closed",O.toastTitleText="DCA Order Closed"),O}});console.log("ðŸš€ ~ closeOrder ~ res:",U),U&&setTimeout(()=>{e()},2e3),c(!1)}catch(T){console.log("ðŸš€ ~ closeOrder ~ error:",T),c(!1)}},{getExplorerUrl:k}=Bt();return t.jsxs(q,{w:"100%",gap:"12px",align:"flex-start",children:[t.jsxs(N,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[t.jsxs(N,{children:[t.jsx(ds,{coinAIconUrl:o==null?void 0:o.logo_url,coinBIconUrl:l==null?void 0:l.logo_url,coinACoinType:o==null?void 0:o.coin_type,coinBCoinType:l==null?void 0:l.coin_type,w:"28px",h:"28px"}),t.jsxs(E,{color:"text_caption",children:[o==null?void 0:o.symbol," â†’ ",l==null?void 0:l.symbol]}),t.jsx(Re,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(k(s==null?void 0:s.orderID,"poolAddress"))}})]}),!h&&t.jsx(Et,{currentTabVal:a,isCloseLoading:r,closeOrder:v,orderInfo:s,isDetail:i,onClickDetail:()=>n(!i)})]}),t.jsxs(N,{children:[t.jsxs(E,{color:"text_caption",fontSize:"12px",children:[F(s==null?void 0:s.inDepositedOut)," ",o==null?void 0:o.symbol]}),t.jsxs(E,{color:"primary_gray",fontSize:"12px",children:["/ ",F(s==null?void 0:s.inDeposited)," ",o==null?void 0:o.symbol]}),t.jsxs(E,{color:"primary_gray",fontSize:"12px",children:["(",s==null?void 0:s.inBalanceRatio,"%)"]}),t.jsx(Ws,{w:"50px",h:"4px",value:s==null?void 0:s.inBalanceRatio,bg:"#282828",sx:{'div[role="progressbar"]':{bg:"primary"}}})]}),t.jsxs(N,{w:"100%",children:[t.jsx(E,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),t.jsx(Gt,{displayTokenA:l,displayTokenB:o,isRank:!0,priceInfo:{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,minPriceResever:s==null?void 0:s.minPriceResever,maxPriceResever:s==null?void 0:s.maxPriceResever},fontSize:"12px"})]}),h&&t.jsx(Et,{currentTabVal:a,isCloseLoading:r,closeOrder:v,orderInfo:s,isDetail:i,onClickDetail:()=>n(!i)}),i&&t.jsx(aa,{pageDirect:d,isDetail:i,currentTabVal:a,orderInfo:s,handleRefresh:e})]})}const Et=({currentTabVal:a,isCloseLoading:s,closeOrder:e,orderInfo:h,isDetail:o,onClickDetail:l})=>t.jsxs(N,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[a=="active"&&t.jsx(He,{w:{base:"100%",lg:"unset"},isLoading:s,disabled:s,onClick:e,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(h==null?void 0:h.outBalance)<=0?"Close":"Close and Withdraw"}),t.jsx(He,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:t.jsx(Re,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:o?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:l,children:"Details"})]});function $t({handleRefresh:a,activeList:s,pastList:e,isOrderLoading:h}){const[l,i]=u.useState([]),[n,r]=u.useState([]),[c,m]=u.useState(0),[d,_]=u.useState(1),{currentAccount:g,onWalletModal:p}=rt(),[v,k]=u.useState({label:"Active DCAs",value:"active"}),T=u.useMemo(()=>[{label:"Active DCAs",value:"active",num:(s==null?void 0:s.length)>0?s==null?void 0:s.length:void 0},{label:"Past DCAs",value:"past",num:(e==null?void 0:e.length)>0?e==null?void 0:e.length:void 0}],[v==null?void 0:v.value,s,e]),R=S=>{_(1),k(S)};u.useEffect(()=>{const S=(v==null?void 0:v.value)==="active"?s:e;i(S),m(S==null?void 0:S.length)},[v==null?void 0:v.value,s,e]),u.useEffect(()=>{const S=(d-1)*10,b=S+10;r(l==null?void 0:l.slice(S,b))},[d,l,v==null?void 0:v.value]);const U=u.useMemo(()=>(v==null?void 0:v.value)==="past"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((S,b)=>w(S).plus(b==null?void 0:b.outBalance),w(0)).toString(),[v==null?void 0:v.value,l]),[B,O]=u.useState(!1),[K,X]=u.useState(!1),{dcaWithdrawPayload:J}=Zt(),{dcaCloseOrderPayload:H}=Jt(),{signAndExecuteTransaction:ee}=ut(),te=async()=>{X(!0);try{const S=l==null?void 0:l.map(D=>({order_id:D==null?void 0:D.orderID,in_coin_type:D==null?void 0:D.inCoin.coin_type,out_coin_type:D==null?void 0:D.outCoin.coin_type}));console.log("ðŸš€ ~ const closeOrderParams:any=pageList.map ~ closeOrderParams:",S);const b=await H(S),M=await ee(b,{getShowInfo:D=>{const f={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return D==="success"&&(f.modalDescriptionText="DCA Order Closed",f.toastDescriptionContent="DCA Order Closed",f.toastTitleText="DCA Order Closed"),f}});console.log("ðŸš€ ~ closeAll ~ res:",M),M&&setTimeout(()=>{a(!0)},2e3),X(!1)}catch(S){console.log("ðŸš€ ~ closeAll ~ error:",S),X(!1)}},z=async()=>{O(!0);try{const S=l==null?void 0:l.map(D=>({order_id:D==null?void 0:D.orderID,in_coin_type:D==null?void 0:D.inCoin.coin_type,out_coin_type:D==null?void 0:D.outCoin.coin_type}));console.log("ðŸš€ ~ const claimOrderParams:any=pageList.map ~ claimOrderParams:",S);const b=await J(S),M=await ee(b,{getShowInfo:D=>{const f={modalDescriptionText:"DCA Order Claimed",toastTitleText:"DCA Order Claimed"};return D==="success"&&(f.toastDescriptionContent=""),f}});console.log("ðŸš€ ~ claimAll ~ res:",M),M&&setTimeout(()=>{a(!0)},2e3),O(!1)}catch(S){console.log("ðŸš€ ~ claimAll ~ error:",S),O(!1)}},{isApp:$}=ot(),[ce,se]=u.useState(0);gs({interval:1e3,callback:()=>{se(ce+1),ce>=20&&ae(!1)}});const ae=(S=!0)=>{se(0),a(S)};return t.jsxs(q,{w:"100%",children:[t.jsxs(N,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[t.jsxs(N,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[t.jsx(Ht,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:T,currentTab:v.label,handleChangeTab:R}),$&&t.jsx(kt,{value:ce,min:0,max:20,onClick:ae})]}),t.jsxs(N,{w:{base:"100%",lg:"unset"},children:[v.value==="active"&&(l==null?void 0:l.length)>0&&(g==null?void 0:g.address)&&t.jsx(He,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:B,disabled:Number(U)===0||B,onClick:z,leftIcon:t.jsx(Re,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),v.value==="active"&&(l==null?void 0:l.length)>0&&(g==null?void 0:g.address)&&t.jsx(He,{w:{base:"50%",lg:"unset"},isLoading:K,disabled:(l==null?void 0:l.length)==0||K,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:te,children:"Close All"}),!$&&t.jsx(kt,{value:ce,min:0,max:20,onClick:ae})]})]}),g!=null&&g.address?h?t.jsx(Qe,{children:t.jsx(q,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((S,b)=>t.jsx(la,{},b))})}):(l==null?void 0:l.length)===0?t.jsx(St,{type:"nodata",text:(v==null?void 0:v.value)==="active"?"No active orders":"No closed orders"}):t.jsxs(Qe,{h:(n==null?void 0:n.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[t.jsx(q,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:n==null?void 0:n.map(S=>t.jsx(ia,{handleRefresh:()=>a(!0),currentTabVal:v.value,orderInfo:S},S==null?void 0:S.orderID))}),!h&&(l==null?void 0:l.length)>10&&t.jsx(et,{mt:"28px",children:t.jsx(Ft,{total:c,size:10,currentPage:d,onChange:_})})]}):t.jsx(St,{type:"nowallet",onboard:()=>p(!0)})]})}const la=()=>t.jsxs(q,{w:"100%",gap:"16px",align:"flex-start",children:[t.jsxs(N,{w:"100%",gap:"0",justify:"space-between",children:[t.jsxs(N,{gap:"0",children:[t.jsxs(N,{gap:"0px",mr:"8px",align:"flex-start",children:[t.jsx(Tt,{size:"8"}),t.jsx(Tt,{size:"8"})]}),t.jsx(ct,{height:"4",width:"100px"})]}),t.jsx(ct,{height:"4",width:"150px"})]}),t.jsx(ct,{height:"4",width:"180px"})]});function ca(){const{fetchByApi:a}=Dt(),{peripherySdk:s}=Xe(),{setDcaConfig:e}=he(),h=async()=>await a(zs,"GET")||null,o=async()=>await s.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const i={};try{const n=await h();n&&(i.minCycleAmountInUsd=n==null?void 0:n.min_amount_in_usd)}catch(n){console.log("ðŸš€ ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",n)}try{const n=await o();i.minCycleCount=n==null?void 0:n.min_cycle_count,i.minCycleFrequency=n==null?void 0:n.min_cycle_frequency,i.whitelistMode=n==null?void 0:n.whitelist_mode}catch(n){console.log("ðŸš€ ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",n)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",i),e(i),i}}}function It(){const{fetchByApi:a}=Dt(),{setDcaQuote:s}=he();return{getDcaQuote:async({inCoin:h,freq:o,count:l,sender:i})=>{try{const n=await a(Ls,"GET",{in_coin:h,freq:o,count:l,sender:i});if(n){const r={amountInLimitPerCycle:n==null?void 0:n.amount_in_limit_per_cycle,coinType:n==null?void 0:n.coin_type,feeRate:n==null?void 0:n.fee_rate,signature:n==null?void 0:n.signature,signer:n==null?void 0:n.signer,timestamp:n==null?void 0:n.timestamp};return s(r),r}}catch(n){console.log("getDcaQuote ~ error:",n)}return null}}}function oa(){var Ge,ve;const{sellCoin:a,buyCoin:s,setSellCoin:e,setBuyCoin:h,sellAmount:o,buyAmount:l,setBuyAmount:i,setSellAmount:n,dcaConfig:r,setCurrentCoinKey:c,currentCoinKey:m,investNum:d,currentInvest:_,orderNum:g,dcaQuote:p,setInvestNum:v,setOrderNum:k,setCurrentInvest:T,setPageDirect:R,pageDirect:U,dcaMode:B,sellTotalAmount:O,setSellTotalAmount:K,setLowerPriceSize:X,setUpperPriceSize:J}=he(),{currentAccount:H}=rt(),{getDcaConfig:ee}=ca(),{getDcaQuote:te}=It(),{coinPriceObj:z}=hs(),{fetchTokenPrices:$,getTokenAmountValue:ce}=ys(),[se,ae]=u.useState(""),S=u.useRef(se);u.useEffect(()=>{S.current=se},[se]);const b=async()=>{const x=await ee();console.log("ðŸš€ ~ handleGetDcaConfig ~ res:",x)},M=()=>{console.log("ðŸš€ ~ initiaTokenSelect ~ setSellCoin:"),e(At.clmm_swap.from_coin),h(At.clmm_swap.to_coin)};u.useEffect(()=>(X("0%"),J("0%"),M(),b(),()=>{fe()}),[]);const[D,f]=u.useState(""),[C,Z]=u.useState(""),{balanceInfo:L}=Ct(a),{balanceInfo:de}=Ct(s),Ne=ce(a==null?void 0:a.coin_type,o),Me=x=>{c("sellCoin"),n(x),j()};u.useEffect(()=>{+o&&+g?B=="total"?K(o):K(w(o).mul(g).toString()):K("")},[o,B,g]);const Ee=()=>{const x=U?a==null?void 0:a.decimals:s==null?void 0:s.decimals;if(R(!U),D&&C){const V=D,ie=w(1).div(C).toString(),De=w(1).div(V).toString();f(Ke(ie,x,!0).toString()),Z(Ke(De,x,!0).toString())}},ge=(x,V=!0)=>{var ie,De,qe,Be;f(""),Z(""),V?(((ie=x==null?void 0:x.coin_type)==null?void 0:ie.toLowerCase())===((De=s==null?void 0:s.coin_type)==null?void 0:De.toLowerCase())?Se():e(x),c("sellCoin")):(((qe=x==null?void 0:x.coin_type)==null?void 0:qe.toLowerCase())===((Be=a==null?void 0:a.coin_type)==null?void 0:Be.toLowerCase())?Se():h(x),c("buyCoin"))},fe=()=>{n(""),f(""),Z(""),ae(""),v("1"),k("2"),T("Hour")},Se=()=>{e(s),h(a)},at=u.useMemo(()=>{const x=r==null?void 0:r.whitelistMode;return console.log("ðŸš€ ~ useDcaHook ~ whitelistMode:",x),x===3?!0:x===0?!1:m==="sellCoin"?x===1:m==="buyCoin"?x===2:!1},[r==null?void 0:r.whitelistMode]),Q=((Ge=z[vs(a==null?void 0:a.coin_type).full_address])==null?void 0:Ge.price)||0,I=u.useMemo(()=>O&&g?w(O).div(g).toString():0,[O,g]),je=u.useMemo(()=>O&&g&&Q&&w(O).div(g).mul(Q).toString()||0,[O,g,Q]),ye=w(p==null?void 0:p.feeRate).div(Ce.pow(10,6)).mul(100).toString()+"%"||"0%",Y=u.useMemo(()=>{if(p!=null&&p.amountInLimitPerCycle&&(a!=null&&a.decimals))return yt(p==null?void 0:p.amountInLimitPerCycle,a==null?void 0:a.decimals)},[p==null?void 0:p.amountInLimitPerCycle]),Pe=u.useMemo(()=>(console.log("ðŸš€ ~ orderSizeError ~ sellPerOrder:",I,Y),r!=null&&r.minCycleAmountInUsd&&g&&o&&Y&&Number(I)<Number(Y)?{status:!0,tips:`Each order size should be higher than $${r==null?void 0:r.minCycleAmountInUsd}.`}:o&&g&&Number(je)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[B,Y,g,I,o,je,r==null?void 0:r.minCycleAmountInUsd]),Te=u.useMemo(()=>(console.log("ðŸš€ ~ orderInputError ~ orderNum:",g,g&&Number(g)<Number(r==null?void 0:r.minCycleCount)),r!=null&&r.minCycleCount&&g&&Number(g)<Number(r==null?void 0:r.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${r==null?void 0:r.minCycleCount}.`}:g&&Number(d)<=0?{status:!0,tips:"Please enter an interval above 0"}:g&&d&&Number(d)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[g,r==null?void 0:r.minCycleCount,d]),Ae=u.useMemo(()=>D&&Number(D)==0||C&&Number(C)==0?{status:!0,tips:"Please enter a price greater than 0."}:D&&C&&Number(D)>=Number(C)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[D,C]),[Ve,$e]=u.useState(""),[ke,Fe]=u.useState({status:!1,tips:""}),ze=()=>{const x=new Date().getTime();let V=0;switch(console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",_),_){case"Minute":V=Number(d)*60*1e3*(Number(g)-1)+6e4;break;case"Hour":V=Number(d)*60*60*1e3*(Number(g)-1)+6e4;break;case"Day":V=Number(d)*60*60*24*1e3*(Number(g)-1)+6e4;break;case"Week":V=Number(d)*60*60*24*7*1e3*(Number(g)-1)+6e4;break;case"Month":V=Number(d)*60*60*24*30*1e3*(Number(g)-1)+6e4;break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",g,x,V,V>60*60*24*365*1e3);const ie=Ie(x+V,"YMDHM");console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",ie),$e(ie),ie=="NaN-NaN-NaN NaN:NaN"&&$e("--"),V>60*60*24*365*1e3?Fe({status:!0,tips:"The maximum execution period is 1 year"}):Fe({status:!1,tips:"The maximum execution period is 1 year"})};u.useEffect(()=>{ze()},[o,d,g,D,C,_]);const be=u.useMemo(()=>{let x=0;switch(_){case"Minute":x=Number(d)*60;break;case"Hour":x=Number(d)*60*60;break;case"Day":x=Number(d)*60*60*24;break;case"Week":x=Number(d)*60*60*24*7;break;case"Month":x=Number(d)*60*60*24*30;break}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",x),x},[_,d]);u.useEffect(()=>{a!=null&&a.coin_type&&be&&g&&_e(a==null?void 0:a.coin_type,be,g,H==null?void 0:H.address)},[a==null?void 0:a.coin_type,be,g,H==null?void 0:H.address]);const Le=async(x,V,ie,De)=>{const qe=De||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const Be=await te({inCoin:x,freq:V,count:ie,sender:qe});return console.log("ðŸš€ ~ queryDcaQuote ~ result:",Be),Be}catch(Be){console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",Be)}},_e=nt((x,V,ie,De)=>{Le(x,V,ie,De)},500),{findBestRouters:Je}=Vs(),[Ue,We]=u.useState(!1),[pe,Ze]=u.useState(void 0),{getTokenRank:y}=Ut();u.useEffect(()=>{G();const x=y(a,s);console.log("ðŸš€ ~ useEffect ~ direct:",x),R(x)},[a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]),u.useEffect(()=>{j()},[I,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]);const j=()=>{w(I).gt(0)&&(a!=null&&a.coin_type)&&(s!=null&&s.coin_type)&&(We(!0),console.log("ðŸš€ ~ useDcaHook ~ sellAmountDebounce:",Number(I)>0,I,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,g),P())},P=nt(()=>{W()},500),W=async()=>{if(console.log("ðŸš€ ~ findAvailableRouter ~ findAvailableRouter:",I),a&&s){const x=`${a.coin_type}_${s.coin_type}`;ae(x);const V=Object.entries(Hs).map(([De,qe])=>qe.id),ie=await Je({fromToken:a,toToken:s,amount:vt(I||1,a==null?void 0:a.decimals).toFixed(0),providersKeys:V,by_amount_in:!0,uuid:x});console.log("ðŸš€ ~ findAvailableRouter ~ newUuid:",x,se,ie),x===S.current&&(Ze(ie),i(ie==null?void 0:ie.toAmountUi),We(!1))}},G=()=>{const x=((a==null?void 0:a.coin_type)||(s==null?void 0:s.coin_type))&&Array.from(new Set([a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]));$(x||[])},me=u.useMemo(()=>{console.log("ðŸš€ ~ btnStatus ~ routerData:",pe);const x={text:"Create DCA Order",disabled:!1};return H!=null&&H.address?!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)?(x.disabled=!0,x.text="Select a token",x):!o||Number(o)==0?(x.disabled=!0,x.text="Enter an amount",x):w(O).gt((L==null?void 0:L.balanceFormat)||0)?(x.disabled=!0,x.text=`Insufficient ${a==null?void 0:a.symbol} balance`,x):w(r==null?void 0:r.minCycleCount).gt(g||0)?(x.disabled=!0,x.text=`Minimum ${r==null?void 0:r.minCycleCount} orders`,x):w(Y).gt(I||0)?(x.disabled=!0,x.text=`Minimum $${r==null?void 0:r.minCycleAmountInUsd} per order`,x):Pe.status||Te.status||Ae.status||ke.status||!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)||!g||!d||!D||!C?(x.disabled=!0,x.text="Create DCA Order",x):(console.log("ðŸš€ ~ btnStatus ~ routerData:",pe),pe&&pe.errorCode&&(pe.errorCode===Ot.NoRouter||pe.errorCode===Ot.HoneyPot)&&(x.text="No Available Route",x.disabled=!0),x):(x.text="Connect Wallet",x.disabled=!1,x)},[H==null?void 0:H.address,L,Pe,Te,Ae,ke,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,O,d,g,D,C,(ve=pe==null?void 0:pe.routes)==null?void 0:ve.length]),xe=u.useMemo(()=>{const x=[];return s&&x.push(s),a&&x.push(a),x},[s,a]),ne=u.useMemo(()=>U&&l&&I?F(w(l).div(I).toString(),s==null?void 0:s.decimals,!0):!U&&l&&I?F(w(I).div(l).toString(),a==null?void 0:a.decimals,!0):"",[U,I,l]),mt=nt(x=>{f(x)},500),A=nt(x=>{Z(x)},500),le=x=>{console.log("ðŸš€ ~ handleMinInputChange ~ val:",x),mt(x)},Oe=x=>{console.log("ðŸš€ ~ handleMaxInputChange ~ val:",x),A(x)};u.useEffect(()=>{oe(D)},[D,ne]),u.useEffect(()=>{re(C)},[C,ne]);const oe=x=>{if(console.log("ðŸš€ ~ changeLowerPriceSize ~ val:",x),ne&&x){const V=w(x).div(ne).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",V),X(w(V).gt(1e4)?">10,000%":`${F(V,1,!1,Ce.ROUND_HALF_DOWN)}%`)}},re=x=>{if(ne&&x){const V=w(x).div(ne).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",V),J(w(V).gt(1e4)?">10,000%":`${F(V,1,!1,Ce.ROUND_HALF_DOWN)}%`)}};return{currentPrice:ne,handleMinInputChange:le,handleMaxInputChange:Oe,warningTokenList:xe,resetInputAmount:fe,cycleFrequency:be,btnStatus:me,fetchFindAvailableRouterDebounce:j,queryDcaQuote:Le,findRouterLoading:Ue,platformFee:ye,estEndDate:Ve,sellPerOrder:I,isDcaSelect:at,onReverseClick:Se,sellBalanceInfo:L,buyBalanceInfo:de,sellAmountValue:Ne,handleAmountChange:Me,handleSelectToken:ge,minPriceValue:D,maxPriceValue:C,handlePageToggleDirect:Ee,orderSizeError:Pe,orderInputError:Te,priceError:Ae,orderTimeError:ke}}function ra(){const{peripherySdk:a}=Xe(),{getTokenInfo:s}=qt(),{setFilterTokenLoading:e}=Ss(),{setInCoinWhiteList:h,setOutCoinWhiteList:o}=he();return{getDcaCoinWhiteList:async i=>{var d,_;console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:"),e(!0);const{inCoinList:n,outCoinList:r}=await a.Dca.getDcaCoinWhiteList(i);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",r),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",n);const c=[],m=[];for(let g=0;g<n.length;g++){const p=await s(n[g]);c.push({...p,labels:((d=p==null?void 0:p.labels)==null?void 0:d.length)>0?p.labels:""})}for(let g=0;g<r.length;g++){const p=await s(r[g]);m.push({...p,labels:((_=p==null?void 0:p.labels)==null?void 0:_.length)>0?p.labels:""})}console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",m),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",c),h(c),o(m),e(!1)}}}function ua(){const{peripherySdk:a}=Xe(),{getDcaQuote:s}=It(),e=(l,i,n,r,c,m)=>{const d=w(vt(l,n)).div(i),_=w(d).div(w(c)),g=w(d).div(w(m));let p,v;if(n>r){const k=Ce.pow(10,n-r);p=g.div(k).ceil().toString(),v=_.div(k).ceil().toString()}else if(n<r){const k=Ce.pow(10,r-n);p=g.mul(k).ceil().toString(),v=_.mul(k).ceil().toString()}else p=g.ceil().toString(),v=_.ceil().toString();return{perCycleMinOutAmount:p,perCycleMaxOutAmount:v,cycleCountAmount:d}},h=(l,i,n,r)=>{const{in_coin:c,in_coin_amount:m,freq:d,cycle_count:_,out_coin:g}=l;return{in_coin_amount:String(vt(m,c.decimals)),in_coin_type:c.coin_type,out_coin_type:g.coin_type,cycle_frequency:d,cycle_count:_,per_cycle_min_out_amount:n,per_cycle_max_out_amount:r,per_cycle_in_amount_limit:i.amountInLimitPerCycle,fee_rate:i.feeRate,timestamp:i.timestamp,signature:i.signature}};return{openDcaOrder:async l=>{const{in_coin:i,out_coin:n,in_coin_amount:r,cycle_count:c,min_price:m,max_price:d,freq:_}=l,g=a.ClmmSDK.senderAddress||"0x0000000000000000000000000000000000000000000000000000000000000000",p=await s({inCoin:i.coin_type,freq:_,count:c,sender:g});if(!p)throw new Error("Request timed out");const{perCycleMinOutAmount:v,perCycleMaxOutAmount:k}=e(r,c,i.decimals,n.decimals,m,d),T=h(l,p,v,k);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",T);const R=await a.Dca.dcaOpenOrderPayload(T);return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",R),R}}}function es({detailsData:a,isConfirm:s=!1}){const{sellPerOrder:e,estEndDate:h,platformFee:o,minPriceValue:l,maxPriceValue:i,minPriceResever:n,maxPriceResever:r}=a,{sellCoin:c,buyCoin:m,sellTotalAmount:d,investNum:_,currentInvest:g,pageDirect:p}=he();return console.log("ðŸš€ ~ DetailsBlock ~ investNum:",a,_),t.jsxs(q,{w:"100%",gap:s?"20px":"16px",children:[t.jsx(we,{isLoading:!1,label:"Sell total",value:d?`${F(d,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Sell per order",value:e?`${F(e,c==null?void 0:c.decimals)} ${c==null?void 0:c.symbol}`:`-- ${c==null?void 0:c.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!s&&t.jsx(we,{isLoading:!1,label:"Receive",value:t.jsxs(N,{gap:"4px",children:[t.jsx(bs,{imageUrl:m==null?void 0:m.logo_url,w:"20px",h:"20px",coinType:m==null?void 0:m.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),t.jsx(E,{color:"text_caption",children:m==null?void 0:m.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsx(E,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),t.jsx(Gt,{displayTokenA:m,displayTokenB:c,isRank:!0,justify:"flex-end",priceInfo:{minPrice:it(l).toString(),maxPrice:it(i).toString(),minPriceResever:it(n).toString(),maxPriceResever:it(r).toString()},fontSize:"14px",color:"text_caption"})]}),t.jsx(we,{isLoading:!1,label:"Invest every",value:Number(_)>1?`${_} ${g}s`:`${_} ${g}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsx(we,{isLoading:!1,label:"Start date",value:String(Ie(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Est. end date(UTC)",value:h,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Platform fee",value:o,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const pa=({confirmData:a,isOpen:s,onClose:e,toOpenDca:h,toOpenDcaLoading:o})=>{const{sellCoin:l,buyCoin:i}=he();return t.jsxs(_s,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:e,isCentered:!0,children:[t.jsx(Ds,{}),t.jsxs(ws,{children:[t.jsx(fs,{children:t.jsx(js,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),t.jsx(Ps,{}),t.jsx(Ts,{textAlign:"center",p:"0px",children:t.jsxs(q,{w:"100%",gap:"16px",p:"16px",children:[t.jsxs(Qe,{borderRadius:"8px",position:"relative",p:"0 12px",children:[t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsxs(q,{align:"flex-start",w:"calc(50% - 24px)",children:[t.jsx(E,{children:"Sell"}),t.jsx(Rt,{portal:!1,token:l,haveName:!1,symbolEllipsesDecimals:10})]}),t.jsx(Vt,{w:"1px",h:"100px",bg:"border"}),t.jsxs(q,{align:"flex-end",w:"calc(50% - 24px)",children:[t.jsx(E,{children:"Buy"}),t.jsx(Rt,{portal:!1,token:i,haveName:!1,symbolEllipsesDecimals:10})]})]}),t.jsx(et,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:t.jsx(Re,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),t.jsx(es,{detailsData:a,isConfirm:!0}),t.jsx(He,{mt:"12px",onClick:()=>{h(),e()},disabled:o,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function xa({detailsData:a}){return t.jsx(Qe,{children:t.jsxs(q,{gap:"20px",children:[t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsx(E,{color:"text_caption",children:"Details"}),t.jsx(E,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),t.jsx(es,{detailsData:a})]})})}function zt({title:a,label:s,inputValue:e,inputChange:h=()=>{},list:o=[],onListItemClick:l=()=>{}}){const i=n=>{const r=n.target.value.replace(/[^\d]/g,"");h(r)};return t.jsx(Yt,{w:"50%",borderRadius:"16px",children:t.jsxs(q,{gap:"16px",align:"flex-start",children:[typeof a=="string"?t.jsx(E,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:a}):a,t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsx(As,{value:e,onChange:i,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),o.length>0?t.jsx(Es,{label:s,list:o,onListItemClick:l}):t.jsx(E,{color:"text_caption",children:s})]})]})})}function Lt({direct:a,text:s,align:e,inputValue:h,inputChange:o=()=>{}}){const{sellCoin:l,buyCoin:i}=he();return t.jsx(Yt,{w:"unset",borderRadius:"8px",children:t.jsx(N,{children:t.jsxs(q,{align:e,children:[t.jsx(ks,{value:h,placeholder:"0.0",decimals:18,onChange:n=>o(n),style:{width:"calc(100% - 8px)",textAlign:e=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),t.jsxs(N,{w:"100%",justify:"space-between",children:[t.jsx(E,{fontSize:"12px",fontWeight:"500",children:a?`${i==null?void 0:i.symbol} per ${l==null?void 0:l.symbol}`:`${l==null?void 0:l.symbol} per ${i==null?void 0:i.symbol}`}),s&&t.jsx(E,{fontSize:"12px",fontWeight:"500",children:s})]})]})})})}function ma({handleGetDcaOrderList:a}){const{sellCoin:s,buyCoin:e,sellAmount:h,buyAmount:o,setInvestNum:l,setOrderNum:i,investNum:n,orderNum:r,currentInvest:c,setCurrentInvest:m,pageDirect:d,isDcaRefresh:_,dcaMode:g,setDcaMode:p,sellTotalAmount:v,upperPriceSize:k,lowerPriceSize:T,setLowerPriceSize:R,setUpperPriceSize:U}=he(),{currentPrice:B,btnStatus:O,findRouterLoading:K,sellBalanceInfo:X,buyBalanceInfo:J,sellAmountValue:H,handleAmountChange:ee,handleSelectToken:te,minPriceValue:z,maxPriceValue:$,handleMinInputChange:ce,handleMaxInputChange:se,handlePageToggleDirect:ae,onReverseClick:S,orderSizeError:b,orderInputError:M,orderTimeError:D,priceError:f,sellPerOrder:C,estEndDate:Z,platformFee:L,fetchFindAvailableRouterDebounce:de,cycleFrequency:Ne,resetInputAmount:Me,warningTokenList:Ee}=oa();u.useEffect(()=>{_&&de()},[_]);const{currentAccount:ge,onWalletModal:fe}=rt(),[Se,at]=u.useState("#icon-a-icon_trade"),Q=["Minute","Hour","Day","Week","Month"],I=A=>at(A?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:je}=ua(),[ye,Y]=u.useState(!1),{fetchCoinBalance:Pe}=wt(),{signAndExecuteTransaction:Te,transactionRejected:Ae,transactionConfirmation:Ve}=ut(),{failedTsToast:$e}=Os(),{showInsufficientBalanceToast:ke}=Bs(),Fe=async()=>{Y(!0);const A={getShowInfo:oe=>{`${F(v)}${s==null?void 0:s.symbol}${e==null?void 0:e.symbol}${r}`;const re={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return oe==="success"&&(re.modalDescriptionText="DCA Order Created",re.toastDescriptionContent="DCA Order Created",re.toastTitleText="DCA Order Created"),re}};Ve(A);const le=d?w(1).div($).toString():z,Oe=d?w(1).div(z).toString():$;try{const oe={in_coin:s,out_coin:e,in_coin_amount:v,cycle_count:r,min_price:le,max_price:Oe,freq:Ne};console.log("ðŸš€ ~ toOpenDca ~ params:",!d,z,$,le,Oe,oe);const re=await je(oe);console.log("ðŸš€ ~ toOpenDca ~ tx:",re);const Ge=await Te(re,A);console.log("ðŸš€ ~ toOpenDca ~ res:",Ge),Ge&&(Me(),setTimeout(()=>{Pe(ge==null?void 0:ge.address,s==null?void 0:s.coin_type),a(ge==null?void 0:ge.address)},2e3)),Y(!1)}catch(oe){const re={getShowInfo:Ge=>{const ve={};return String(oe)==="Error: Each order size should be higher than $10"&&(ve.toastTitleText="Transaction Submission Error",ve.toastDescriptionContent="Each order size should be higher than $10."),String(oe)==="Error: Request timed out"&&(ve.toastTitleText="Request timed out",ve.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(oe)==="Error: minPrice error"&&(ve.toastTitleText="DCA order submission failed",ve.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),ve}};console.log("ðŸš€ ~ toOpenDca ~ error:",oe),console.error("Open DCA Order Error: ",oe),ke(String(oe)),Ae(re),$e(re),Y(!1)}},{currentCoinKey:ze,inCoinWhiteList:be,outCoinWhiteList:Le,dcaConfig:_e}=he(),{getDcaCoinWhiteList:Je}=ra(),[Ue,We]=u.useState([]);u.useEffect(()=>{ze=="sellCoin"?We(be):We(Le),console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:104 ~ DcaInputBlock ~ whiteTokenList:",Ue)},[ze,be,Le]),u.useEffect(()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",_e),_e&&_e.whitelistMode&&Je(_e.whitelistMode)},[_e]);const[pe,Ze]=u.useState(!1),y=u.useMemo(()=>{const A=d?e==null?void 0:e.decimals:s==null?void 0:s.decimals;let le="",Oe="",oe="",re="";return z&&$&&(le=d?Ke(w(1).div($).toString(),A,!0).toString():z,Oe=d?Ke(w(1).div(z).toString(),A,!0).toString():$,oe=d?z:Ke(w(1).div($).toString(),A,!0).toString(),re=d?$:Ke(w(1).div(z).toString(),A,!0).toString()),{estEndDate:Z,sellPerOrder:C,platformFee:L,minPriceValue:le,maxPriceValue:Oe,minPriceResever:oe,maxPriceResever:re}},[d,Z,C,L,z,$]),j=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[P,W]=u.useState([0,0]),[G,me]=u.useState(0),[xe,ne]=u.useState(0),mt=A=>{console.log("ðŸš€ ~ handleSlider ~ val:",A),W(A),ce(A[0].toString()),se(A[1].toString())};return u.useEffect(()=>{if(z&&$){const A=Number(z),le=Number($);W([A,le]),console.log("ðŸš€ ~ useEffect ~ start:",A,le)}z||R("0%"),$||U("0%")},[z,$]),u.useEffect(()=>{if(B){const A=w("-100").div(100).plus(1).mul(B).toNumber(),le=w("100").div(100).plus(1).mul(B).toNumber();console.log("ðŸš€ ~ useEffect ~ min:",A,le),me(A),ne(le)}},[B]),t.jsxs(q,{w:"100%",children:[t.jsx(qs,{onClick:S,currentCoinKey:ze,whiteTokenList:Ue,from:{inputTabOptions:{type:"outlineTab",tabList:j,currentTab:g=="total"?"Total":"Per Order",handleChangeTab:A=>{p(A==null?void 0:A.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(X==null?void 0:X.balanceFormat)||"",value:h,amountValue:H,loading:!1,onChange:ee,selectable:!0,placeholder:"0.0",token:s,onTokenChange:A=>te(A,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(J==null?void 0:J.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:e,onTokenChange:A=>te(A,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:Se,svgFill:"text_caption",transform:Se==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:Se==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1)}}),(b==null?void 0:b.status)&&t.jsx(lt,{tips:b==null?void 0:b.tips}),t.jsxs(N,{w:"100%",children:[t.jsx(zt,{title:"Invest Every",label:c,inputValue:n,list:Q,onListItemClick:A=>{m(A)},inputChange:A=>{console.log("ðŸš€ ~ DcaInputBlock ~ item:",A),l(A)}}),t.jsx(zt,{title:t.jsx(Gs,{type:"over",children:t.jsx(E,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:r,inputChange:A=>{i(A),de()}})]}),(M==null?void 0:M.status)&&t.jsx(lt,{tips:M==null?void 0:M.tips}),(D==null?void 0:D.status)&&t.jsx(lt,{tips:D==null?void 0:D.tips}),t.jsxs(Qe,{zIndex:"1",p:"16px",borderRadius:"16px",children:[t.jsxs(q,{align:"flex-start",children:[t.jsx(E,{color:"text_caption",children:"Set Price Range"}),t.jsx(E,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:h?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),h&&C&&t.jsxs(N,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[t.jsx(E,{children:"Current Rate"}),t.jsx(q,{align:{base:"flex-start",lg:"flex-end"},children:t.jsx(Us,{color:"text_caption",pageDirect:d,handlePageToggleDirect:ae,fromToken:s,toToken:e,fromValue:C,toValue:o,isLoading:K||!o||!C})})]})]}),t.jsxs(N,{justify:"space-between",gap:"8px",mt:"20px",children:[t.jsx(Lt,{direct:d,text:h&&z?T:"",inputValue:z,inputChange:A=>ce(A),align:"flex-start"}),t.jsx(E,{color:"text_caption",children:"-"}),t.jsx(Lt,{direct:d,text:h&&$?k:"",inputValue:$,inputChange:A=>se(A),align:"flex-start"})]}),!K&&h&&z&&$&&Number($)>=Number(z)&&(O==null?void 0:O.text)!=="No Available Route"&&t.jsxs(q,{w:"100%",gap:"0",mt:"20px",children:[t.jsxs(Kt,{min:G,max:xe,step:.1,value:P,onChange:A=>{mt(A)},colorScheme:"teal",children:[t.jsx(Qt,{children:t.jsx(Xt,{})}),t.jsx(bt,{index:0}),t.jsx(bt,{index:1})]}),t.jsx(Cs,{src:Fs,w:"32px",h:"32px"}),t.jsx(N,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:t.jsx(E,{children:"Current Rate"})})]})]}),(f==null?void 0:f.status)&&t.jsx(lt,{tips:f==null?void 0:f.tips}),t.jsx(He,{isLoading:ye,disabled:(O==null?void 0:O.disabled)||ye,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",onClick:(O==null?void 0:O.text)=="Connect Wallet"?()=>fe(!0):()=>Ze(!0),children:O==null?void 0:O.text}),h&&t.jsx(xa,{detailsData:y}),pe&&t.jsx(pa,{confirmData:y,isOpen:pe,onClose:()=>Ze(!1),toOpenDca:Fe,toOpenDcaLoading:ye}),(e||s)&&t.jsx(Ys,{addToken:!0,tokensInfo:Ee,waringModalCancel:A=>{A.forEach(le=>{(le.coin_type===(e==null?void 0:e.coin_type)||le.coin_type===(s==null?void 0:s.coin_type))&&te(void 0,le.coin_type===(e==null?void 0:e.coin_type))})}})]})}const lt=({tips:a})=>t.jsxs(N,{w:"100%",bg:"primary_red_bg",p:"12px",borderRadius:"12px",children:[t.jsx(Re,{svgW:"16px",svgH:"16px",xlinkHref:"#icon-icon-warning",svgFill:"primary_red"}),t.jsx(E,{color:"primary_red",lineHeight:"20px",children:a})]});function da(a){const i=Math.floor(a/2592e3);a%=2592e3;const n=Math.floor(a/604800);a%=604800;const r=Math.floor(a/86400);a%=86400;const c=Math.floor(a/3600);a%=3600;const m=Math.floor(a/60);a%=60;const d=[];return i>0&&d.push(`${i} Month${i>1?"s":""}`),n>0&&d.push(`${n} Week${n>1?"s":""}`),r>0&&d.push(`${r} Day${r>1?"s":""}`),c>0&&d.push(`${c} Hour${c>1?"s":""}`),m>0&&d.push(`${m} Minute${m>1?"s":""}`),d.join(" ")}function ga(){const{getTokenInfo:a}=qt(),{peripherySdk:s}=Xe(),e=async c=>{console.log("ðŸš€ ~ getDcaOrderList ~ walletAddress:",c);try{const m=await s.Dca.getDcaOrders(c);return console.log("ðŸš€ ~ getDcaOrderList ~ list:",m),await r(m==null?void 0:m.data)}catch(m){console.log("ðŸš€ ~ getDcaOrderList ~ error:",m)}},h=async c=>{const m=await a(c),d=Ce.pow(10,m==null?void 0:m.decimals);return{token:m,decimalsPow:d}},o=(c,m,d,_,g)=>{const p=w(c).div(m).div(w(_).div(d)).toString(),v=w(c).div(m).div(w(g).div(d)).toString();return{minPrice:p,maxPrice:v,minPriceResever:w(1).div(w(v)).toString(),maxPriceResever:w(1).div(w(p)).toString()}},l=c=>c.in_withdrawn>0&&c.in_withdrawn==c.in_deposited?"Close":c.in_withdrawn>0&&c.out_withdrawn>0?"PartialDeal":c.amount_left_next_cycle==0&&c.next_cycle_at==0?"AllDeal":"Active",i=(c,m,d,_,g,p,v)=>{const k=T=>T==="--"?"--":w(1).div(T).toString();switch(c){case"Close":return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"};case"PartialDeal":{const T=m.sub(d).div(p).toString(),R=m.sub(d).div(m).mul(100).toDP(2,Ce.ROUND_HALF_UP).toString();return console.log("ðŸš€ ~ useGetDcaOrderList ~ inDeposited:",d,m),{currentAvgPrice:T,currentAvgPriceResever:k(T),inBalanceRatio:R,inDepositedOut:m.sub(d).toString()}}case"AllDeal":{const T=m.div(p).toString();return{currentAvgPrice:T,currentAvgPriceResever:k(T),inBalanceRatio:"100",inDepositedOut:m.sub(_).toString()}}case"Active":{const T=g.gt(0)||p.gt(0)?m.sub(_).div(g.add(p)).toString():"--",R=m.sub(_).div(m).mul(100).toDP(2,Ce.ROUND_HALF_UP).toString();return{currentAvgPrice:T,currentAvgPriceResever:k(T),inBalanceRatio:R,inDepositedOut:m.sub(_).toString()}}default:return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"}}},n=(c,m,d,_)=>{const g=Date.now()/1e3,p=w(g).sub(c).div(m),v=d.lte(0)&&w(_).lte(0);return p.gt(3)&&v},r=async c=>{const m=[],d=[];for(const p of c){const{token:v,decimalsPow:k}=await h(p.in_coin_type),{token:T,decimalsPow:R}=await h(p.out_coin_type),U=w(p.in_deposited).div(k);console.log("ðŸš€ ~ buildDcaOrderList ~ order.in_deposited:",p.in_deposited,k);const B=w(p.in_deposited).div(p.in_amount_per_cycle).floor().toString(),O=w(p.in_amount_per_cycle).div(k).toString(),K=w(p.in_balance).div(k),X=w(p.in_withdrawn).div(k),J=w(p.out_balance).gt(0)?w(p.out_balance).div(R):w(0),H=w(p.out_withdrawn).div(R),ee=F(U.div(B).toString()),te=K.div(O).floor().toNumber(),{minPrice:z,maxPrice:$,minPriceResever:ce,maxPriceResever:se}=o(p.in_amount_per_cycle,k,R,p.max_out_amount_per_cycle,p.min_out_amount_per_cycle),ae=l(p),{currentAvgPrice:S,currentAvgPriceResever:b,inBalanceRatio:M,inDepositedOut:D}=i(ae,U,X,K,J,H),f=n(p.created_at,p.cycle_frequency,J,H),C={createAt:Ie(p.created_at*1e3,"YMDHM"),cycleFrequency:p.cycle_frequency,orderID:p.id,inAmountPerCycle:O,nextCycleAt:Ie(p.next_cycle_at*1e3,"YMDHM"),inDeposited:U.toString(),cycleCount:B,inDepositedOut:D,inBalance:K.toString(),minPrice:F(z),maxPrice:F($),minPriceResever:F(ce),maxPriceResever:F(se),inCoin:v,outCoin:T,outBalance:J.toString(),inBalanceRatio:M,outWithdraw:H.toString(),investEvery:da(p.cycle_frequency),eachOrderSize:ee,currentAvgPrice:S==="--"?"--":F(S,T.decimals),currentAvgPriceResever:S==="--"?"--":F(b,v.decimals),orderStatus:ae,inWithdrawn:X.toString(),ofOrderLeft:te,isShowTradeTips:f,next_cycle_at:p.created_at+te*p.cycle_frequency,created_at:p.created_at,version:p.version};ae==="Active"?m.push(C):d.push(C)}const _=m==null?void 0:m.sort((p,v)=>v.version-p.version),g=d==null?void 0:d.sort((p,v)=>v.version-p.version);return console.log("ðŸš€ ~ buildDcaOrderList ~ activeResult, pastResult:",_,g,m,d),{activeResult:_,pastResult:g}};return{getDcaOrderList:e}}function Xa(){const[a,s]=u.useState([]),[e,h]=u.useState([]),{currentAccount:o}=rt(),{sellCoin:l,buyCoin:i,setIsDcaRefresh:n}=he(),[r,c]=u.useState(!0),{isShowTradeChart:m,setIsShowTradeChart:d,isShowTradeOrders:_,setIsShowTradeOrders:g}=Ks(),{getDcaOrderList:p}=ga(),{fetchAccountBalance:v}=wt(),k=async(B,O=!1)=>{O&&c(!0);const{activeResult:K,pastResult:X}=await p(B);s(K),h(X),c(!1),console.log("ðŸš€ ~ handleGetDcaOrderList ~ list:",K,X)};u.useEffect(()=>{o!=null&&o.address?k(o==null?void 0:o.address,!0):(s([]),h([]))},[o==null?void 0:o.address]);const T=(B=!0)=>{n(!0),setTimeout(()=>{n(!1)},1e3),o!=null&&o.address&&(v(),k(o==null?void 0:o.address,B))};Qs({onRpcChange:()=>{T()}}),u.useEffect(()=>{o!=null&&o.address&&v()},[]);const{isApp:R,windowWidth:U}=ot();return t.jsxs(N,{mt:U&&U<1024?"28px":"42px",className:R||m||_?"":"bg_img",w:"100%",gap:"16px",justify:"center",align:"flex-start",flexDirection:{base:"column",lg:"row"},children:[(_||m)&&t.jsxs(q,{w:{base:"100%",lg:"calc(100% - 470px)"},mt:R&&!m?"-16px":"0",children:[m&&t.jsx(Rs,{baseToken:l,quoteToken:i}),_&&!R&&t.jsx($t,{handleRefresh:T,activeList:a,pastList:e,isOrderLoading:r})]}),t.jsxs(q,{w:{base:"100%",lg:"470px"},children:[t.jsxs(N,{w:"100%",justify:"space-between",mb:"8px",children:[t.jsx(Ns,{currTradeTab:Ms.DCA}),t.jsxs(N,{children:[t.jsx(Nt,{placement:"bottom-end",showTooltip:!R,tooltip:t.jsx(E,{fontSize:"12px",children:m?"Hide reference price":"View reference price"}),children:t.jsx(et,{children:t.jsx(Mt,{w:"28px",h:"28px",borderRadius:"8px",variant:"",xlinkHref:"#icon-icon_kline",svgFill:m?"primary":"",svgHover:m?"primary":R?"text_paragraph":"text_caption",onClick:()=>d(!m)})})}),t.jsx(Nt,{showTooltip:!R,placement:"bottom-end",tooltip:t.jsx(E,{fontSize:"12px",children:_?"Hide Orders":"View Orders"}),children:t.jsx(et,{children:t.jsx(Mt,{w:"28px",h:"28px",borderRadius:"8px",variant:"",xlinkHref:"#icon-icon_order",svgFill:_?"primary":"",svgHover:_?"primary":R?"text_paragraph":"text_caption",onClick:()=>g(!_)})})})]})]}),t.jsx(ma,{handleGetDcaOrderList:B=>k(B)})]}),R&&_&&t.jsx(q,{w:{base:"100%",lg:"calc(100% - 470px)"},children:t.jsx($t,{handleRefresh:T,activeList:a,pastList:e,isOrderLoading:r})})]})}export{Xa as default};

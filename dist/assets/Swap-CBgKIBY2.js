import{j as e,W as le,X as pe,Y as ce,Z as de,a7 as xe,$ as ue,a0 as he,a as d,p as ge,H as g,P as me,h as fe,aL as je,aM as be,aq as ye,m as Se,n as we,q,aN as w,V as m,T as _,f as O,C as _e}from"./vendor-BowHGuwE.js";import{u as U,A as ve}from"./AggregatorModal-CNYwFF7C.js";import{c as Re,u as Te,a as Ae,S as Fe,P as ke,b as Ce}from"./SwapConfirmBlock-T5Eb8ced.js";import{u as Pe}from"./useSwapHelper-BpPOEjKt.js";import{u as We}from"./global-DdUKxaK0.js";import{u as K}from"./swap-CL4WNcXa.js";import{u as He,a8 as Le,bA as ze,Z as Oe,I as Ee,d as Y,bB as Be,c as Z,h as Me,r as De,e as Ve,n as Ge,a as Ne,J as Ye,f as $e,w as qe}from"./index-DOpwe9u0.js";import{H as Ue}from"./HTextLabelBox-DU2pSv5a.js";import{I as Ke}from"./IconBg-vYfcqmb_.js";import{u as Ze}from"./useAccountBalance-CdTImFR-.js";import{T as Je}from"./TradeInputGroup-B4LNcp9D.js";import{W as Xe}from"./WarningTokenTipModal-CUK_wYpz.js";import{M as Qe,S as Ie}from"./usePriceImpact-Dh4s63NF.js";import{u as et}from"./useRequest-DBZnBNhb.js";import{F as tt}from"./FreshProgressV2-DC5H_KC4.js";import{A as st}from"./SingleTokenInfo-BZhis0DU.js";import{T as rt}from"./TooltipIcon-Cp9kD6GX.js";import{R as at}from"./Ratio-CXAC8ug4.js";import{R as ot,Y as it}from"./YAxis-BobUWERj.js";import{a as nt,L as lt}from"./LineChart-FYMnUG18.js";import{T as pt}from"./generateCategoricalChart-CBEQ2F5q.js";import"./aggregator-BGaM2K0H.js";import"./swapConfig-BspJ5Cnt.js";import"./useTransaction-Chv0YO2G.js";import"./useTrack-O-kL3HFv.js";import"./useSigner-Cc1I2j_a.js";import"./useToken-7UZMCtYJ.js";import"./useTokenBalance-Cy1n8fHy.js";import"./useFindBestRouting-DN9VOeY2.js";import"./CurrentPrice-Dqk84xRQ.js";import"./HighlightText-DJrmlQd_.js";import"./index-DxMeIULW.js";import"./TradeConfirmAmountInfo-C6ILjegl.js";import"./useGetPoolList-lv_KbF-1.js";import"./useWrapPoolData-BZRG_RXy.js";import"./_getAllKeysIn-B6pKBYP7.js";import"./CheckBox-5uYHWkgj.js";import"./index-V0MTi46y.js";import"./debounce-0tBm08Ev.js";import"./CopyButton-aBrZMdjW.js";import"./linear-DYpwdEgO.js";function ct(s){const{isOpen:t,onClose:a,data:o,onSubmitClick:i}=s,{fromCoin:p,toCoin:r,routerData:f}=K();return e.jsxs(le,{autoFocus:!1,returnFocusOnClose:!1,trapFocus:!1,isOpen:t,onClose:a,isCentered:!0,children:[e.jsx(pe,{}),e.jsxs(ce,{children:[e.jsx(de,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",children:"Swap"})}),e.jsx(ue,{}),e.jsx(he,{textAlign:"center",p:"0px",children:e.jsx(Re,{onSubmitClick:i,onClose:a,data:o,lastRouterData:f,fromCoin:p,toCoin:r,isWidget:!1})})]})]})}function dt(){const{fetchByApi:s}=He(),{setProviders:t}=Le();return{fetchRouterConfig:async()=>{try{const o=await s(ze,"GET"),{providers:i}=o;i&&i.length>0&&t(i),console.log("ðŸš€ ~ file: useGetRouterConfig.ts:13 ~ fetchRouterConfig ~ res:",o)}catch(o){console.log("ðŸš€ ~ file: useGetRouterConfig.ts:18 ~ fetchRouterConfig ~ error:",o)}}}}function xt(){const[s,t]=d.useState(!1),a=d.useRef(null),o=()=>{t(!1)},{fetchRouterConfig:i}=dt(),{loading:p}=et(i),{handleSelectAllProviderClick:r,handleSaveClick:f,currProvidersSwitchStates:v,isOpenAggregatorMode:c}=U(),h=()=>{c||b(),r(!c)};Oe(()=>{f()},[v]);const b=()=>{var R;const j=window.innerWidth,u=window.innerHeight,l=(R=a.current)==null?void 0:R.getBoundingClientRect(),A=l==null?void 0:l.left,F=l==null?void 0:l.top,x=2,y=w.shapeFromText({text:"ðŸŸ¢",scalar:x}),k=w.shapeFromText({text:"ðŸ”µ",scalar:x}),C=w.shapeFromText({text:"ðŸ’š",scalar:x}),P=w.shapeFromText({text:"ðŸ’™",scalar:x});w({particleCount:40,spread:60,shapes:[y,k,C,P],scalar:x,origin:{x:A/j,y:F*1.2/u}})};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{isLoaded:!p,w:"178px",h:"28px",children:e.jsxs(g,{border:"1px solid",borderColor:"border",borderRadius:"8px",h:"28px",bg:"bg_secondary",gap:"8px",children:[e.jsxs(me,{isLazy:!0,trigger:"hover",autoFocus:!1,returnFocusOnClose:!1,children:[e.jsx(fe,{children:e.jsxs(je,{display:"flex",alignItems:"center",pl:"8px",children:[e.jsx(be,{htmlFor:"aggregator-mode",mb:"0",bg:"plus_mode_color",textFillColor:"transparent",backgroundClip:"text",h:"18px",lineHeight:"18px",fontSize:"12px",fontWeight:"500",fontStyle:"normal",mr:"8px",children:"Aggregator Mode"}),e.jsx(ye,{ref:a,id:"aggregator-mode",isChecked:c,onChange:h})]})}),e.jsx(Se,{children:e.jsx(we,{p:"12px",lineHeight:"20px",fontSize:"12px",children:"The Aggregator Mode will aggregate external liquidity sources"})})]}),e.jsx(q,{variant:"unstyled",mr:"-1px",minW:"20px",w:"20px",p:"7px 4px",h:"28px",bg:"border",borderRadius:"0 8px 8px 0",onClick:()=>t(!s),_hover:{svg:{fill:"text_caption"}},children:e.jsx(Ee,{xlinkHref:"#icon-icon_list_token",fontSize:"12px"})})]})}),s&&e.jsx(ve,{isOpen:s,onClose:o})]})}const ut=({active:s,payload:t,label:a})=>{var o,i;return s&&t&&t.length?e.jsxs("div",{style:{backgroundColor:"#121212",border:"1px solid border_secondary",padding:"12px",borderRadius:"8px",position:"relative",left:"0px",top:"-30px",fontSize:"12px"},children:[e.jsx("p",{style:{color:"#909CA4"},children:Be.unix((i=(o=t[0])==null?void 0:o.payload)==null?void 0:i.timestamp).format("MM/DD HH:mm")}),e.jsxs("p",{style:{color:"#fff",marginTop:"8px"},children:["$",Z(t[0].value)]})]}):null};function ht({data:s=[]}){const t=Y(Math.min(...s.map(o=>o.price))).mul(.99999).toNumber(),a=Y(Math.max(...s.map(o=>o.price))).mul(1.00001).toNumber();return e.jsx(ot,{width:"100%",height:"100%",children:e.jsxs(nt,{width:180,height:48,data:s,margin:{top:5,right:20,left:20,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"priceLine",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(117, 200, 255, 1)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(104, 255, 216, 1)"})]})}),e.jsx(it,{hide:!0,domain:[t,a]}),e.jsx(pt,{cursor:!1,content:e.jsx(ut,{})}),e.jsx(lt,{type:"linear",dot:!1,dataKey:"price",stroke:"url(#priceLine)",strokeWidth:2})]})})}function gt({fromCoin:s,toCoin:t}){return d.useMemo(()=>[s,t].filter(Boolean).filter(o=>!!((o==null?void 0:o.is_verified)===void 0?o!=null&&o.is_trusted:o!=null&&o.is_verified)),[s,t]).length?e.jsxs(m,{w:"100%",align:"flex-start",gap:"8px",children:[e.jsxs(g,{justify:"flex-start",h:"52px",align:"center",gap:"4px",children:[e.jsx(_,{fontSize:"14px",fontWeight:"500",color:"text_caption",h:"20px",lineHeight:"20px",children:"Price Reference"}),e.jsx(rt,{tooltipCon:"The following price is only an external reference from 3rd party data providers, which does not reflect actual data on Cetus."})]}),e.jsxs(m,{w:"100%",gap:"28px",children:[((s==null?void 0:s.is_verified)===void 0?s==null?void 0:s.is_trusted:s==null?void 0:s.is_verified)&&e.jsx($,{coin:s}),((t==null?void 0:t.is_verified)===void 0?t==null?void 0:t.is_trusted:t==null?void 0:t.is_verified)&&e.jsx($,{coin:t})]})]}):null}const $=({coin:s})=>{const{getExplorerUrl:t}=Me(),{getPriceKline:a,getTokenPrice:o}=De(),[i,p]=d.useState({price:[],daily_rate:""});d.useEffect(()=>{p({price:[],daily_rate:""})},[s]);const r=o(s==null?void 0:s.coin_type),f=async(v,c)=>{try{const h=await a(v,c);p(h)}catch(h){console.log(h,"error")}};return d.useEffect(()=>{r!=null&&r.base_symbol&&(r==null?void 0:r.market)!=="cetus"&&f(r==null?void 0:r.base_symbol,r==null?void 0:r.market)},[r==null?void 0:r.base_symbol,r==null?void 0:r.market,s==null?void 0:s.coin_type]),!i||i.price.length===0?e.jsx(e.Fragment,{}):e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-start",h:"32px",children:[e.jsxs(g,{children:[e.jsx(Ve,{imageUrl:s==null?void 0:s.logo_url,w:"28px",h:"28px"}),e.jsxs(m,{align:"flex-start",gap:"4px",children:[e.jsx(_,{fontSize:"14px",h:"16px",lineHeight:"16px",fontWeight:"600",color:"text_caption",children:s==null?void 0:s.symbol}),e.jsx(_,{fontSize:"12px",h:"12px",lineHeight:"12px",fontWeight:"500",children:s==null?void 0:s.name})]})]}),e.jsxs(g,{children:[(r==null?void 0:r.market)&&e.jsx(Qe,{market:r==null?void 0:r.market}),e.jsxs(_,{color:"text_caption",fontSize:"14px",fontWeight:"500",children:["$",(r==null?void 0:r.price)!==void 0?Z(r==null?void 0:r.price):"--"]}),(i==null?void 0:i.daily_rate)&&(r==null?void 0:r.price)!==void 0&&e.jsx(at,{value:i==null?void 0:i.daily_rate})]})]}),e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-end",gap:"0",children:[e.jsx(st,{address:s==null?void 0:s.coin_type,onClickLink:()=>window.open(t(s==null?void 0:s.coin_type,"coin")),wrapStyle:{border:"1px solid",borderColor:"border",h:"24px",borderRadius:"8px",p:"0 8px",bg:"bg_secondary"},fontWeight:"500"}),e.jsx(O,{flex:"0 0 210px",h:"24px",mr:"-13px",children:(r==null?void 0:r.price)!==void 0&&(i==null?void 0:i.price.length)>0&&e.jsx(ht,{data:i==null?void 0:i.price})})]})]})};function is(){const s=K(),{fromCoin:t,toCoin:a,setFromCoin:o,setToCoin:i,byAmountIn:p,setFromAmount:r,setToAmount:f,setByAmountIn:v,findRouterLoading:c,routerData:h}=s,{handleSelectToken:b,handleAmountChange:j,fromAmount:u,toAmount:l,fromAmountValue:A,toAmountValue:F,fromBalanceInfo:x,toBalanceInfo:y,amountLimit:k,getSwapSecondaryData:C,doSwapAction:P,reCalculateRouteData:R,scamsText:E,refreshMarketPrice:J,isOpenConfirmModel:W,setIsOpenConfirmModel:B,resetInputAmount:X,onReverseClick:Q}=Te(s,!1),{currentAccount:T,onWalletModal:I}=Ge(),{fetchAccountBalance:M}=Ze();d.useEffect(()=>{T!=null&&T.address&&M()},[]);const{btnText:ee,btnDisabled:te}=Ae(u,l,x==null?void 0:x.balanceFormat,t,a,h),D=d.useRef(null),{formatSwapRouter:se}=Pe(h),{isOpenAggregatorMode:H}=U(),re=()=>{var n;(n=D.current)==null||n.reset()},V=()=>{R(),M(),J()};d.useEffect(()=>{re()},[l,u,t==null?void 0:t.coin_type,a==null?void 0:a.coin_type]),d.useEffect(()=>{p||V()},[l,t==null?void 0:t.coin_type,a==null?void 0:a.coin_type]),d.useEffect(()=>{X()},[H]);const ae=d.useMemo(()=>{const n=[];return t&&n.push(t),a&&n.push(a),n},[t,a]),[L,G]=d.useState("#icon-a-icon_trade"),oe=()=>{G("#icon-icon_swap1")},ie=()=>{G("#icon-a-icon_trade")},{isApp:N}=Ne(),{isShowTradeChart:S,setIsShowTradeChart:ne,isShowTradeOrders:mt,setIsShowTradeOrders:ft}=We();return e.jsx(e.Fragment,{children:e.jsxs(m,{gap:{base:"16px",lg:"8px"},w:{base:"100%",lg:"470px"},children:[e.jsxs(g,{w:"100%",justify:"space-between",children:[e.jsx(xt,{}),e.jsxs(g,{children:[e.jsx(Ie,{}),e.jsx(Ye,{showTooltip:!N,placement:"bottom-end",tooltip:e.jsx(_,{fontSize:"12px",children:S?"Hide reference price":"View reference price"}),children:e.jsx(_e,{children:e.jsx(Ke,{w:"28px",h:"28px",borderRadius:"8px",variant:"",xlinkHref:"#icon-icon_kline",svgFill:S?"primary":"",svgHover:S?"primary":N?"text_paragraph":"text_caption",onClick:()=>ne(!S)})})}),e.jsx(tt,{callbackInterval:W?5:10,ref:D,min:0,max:10,onClick:V})]})]}),e.jsxs(O,{w:"100%",children:[e.jsx(Je,{wrapStyle:{gap:{base:"16px",lg:"8px"},mt:{base:"0px",lg:"4px"}},onClick:()=>Q(H),from:{title:"You Pay",balance:(x==null?void 0:x.balanceFormat)||"",value:u,amountValue:A,loading:!p&&c,onChange:n=>{j(n,!0)},selectable:!0,placeholder:"0.0",token:t,onFocusChange:n=>{n&&+u&&!p&&j(u,!0)},onTokenChange:n=>{b(n,!0)}},to:{title:"You Receive",balance:(y==null?void 0:y.balanceFormat)||"",value:l,amountValue:F,loading:p&&c,onFocusChange:n=>{n&&+l&&p&&j(l,!1)},onTokenChange:n=>{b(n,!1)},inputAllowed:!H,onChange:n=>{j(n,!1)},selectable:!0,placeholder:"0.0",token:a,half:!1,max:!1},iconParams:{xlinkHref:L,svgFill:"text_caption",transform:L==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:L==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:oe,onMouseLeave:ie}}),E&&e.jsx(O,{mt:"-32px",p:"48px 16px 16px",borderRadius:"20px",bg:"bg_secondary",border:"1px solid",borderColor:"border",children:e.jsx(Fe,{scamsText:E})})]}),(t||a)&&e.jsx(Xe,{addToken:!0,tokensInfo:ae,waringModalCancel:n=>{n.forEach(z=>{(z.coin_type===(t==null?void 0:t.coin_type)||z.coin_type===(a==null?void 0:a.coin_type))&&b(void 0,z.coin_type===(t==null?void 0:t.coin_type))})}}),e.jsxs(m,{p:+u&&+l?"0 8px 12px":"0 8px",w:"100%",gap:"8px",border:"1px solid",borderColor:"border",borderRadius:"20px",bg:"bg_secondary",children:[e.jsx(q,{w:"calc(100% + 18px)",h:"52px",margin:"-1px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:c||te,isLoading:c,onClick:()=>{T?B(!0):I(!0)},children:[t,a].filter(Boolean).length<2?"Select a token":ee}),!!+u&&!!+l&&e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsx(ke,{findRouterLoading:c,routerData:h,fromCoin:t,toCoin:a}),e.jsx(Ue,{isLoading:c,label:p?"Minimum Received":"Maximum Sold",value:`${$e(k,p?a==null?void 0:a.decimals:t==null?void 0:t.decimals,!1,qe.ROUND_DOWN)} ${p?a==null?void 0:a.symbol:t==null?void 0:t.symbol}`,labelStyle:{fontWeight:500,whiteSpace:"nowrap",fontSize:"14px"},valueStyle:{fontWeight:500,fontSize:"14px"},skeletonStyle:{valueW:"128px"},wrapStyle:{p:"0 8px",minH:"20px"}}),e.jsx(Ce,{formatSwapRouter:se,findRouterLoading:c,fromAmount:u,toAmount:l,fromCoin:t,toCoin:a})]})]}),!S&&e.jsx(gt,{fromCoin:t,toCoin:a}),W&&e.jsx(ct,{data:C(),isOpen:W,onSubmitClick:P,onClose:()=>{B(!1)}})]})})}export{is as default};
//# sourceMappingURL=Swap-CBgKIBY2.js.map

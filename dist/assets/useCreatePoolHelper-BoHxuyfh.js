import{u as R}from"./usePosAdd-vnaoQeks.js";import{g as b}from"./liquidity-C80wvFzz.js";import{u as N,b as B}from"./useGetPoolList-DBJielhS.js";import{d as v}from"./FeeTierSelect-D2y7F8IR.js";import{aH as W,bc as y,d as c,aV as C,aP as H,aQ as I,r as L}from"./index-D49RffYW.js";function G(){const{clmmSdk:n}=W(),{preAdd:f}=R(),{getPoolList:s}=N(),a=.05;return{preAddPool:m=>{const{tickSpacing:i,price:d,minPrice:r,maxPrice:l,amount:u,amountCoinType:e,realTokenA:t,realTokenB:o,needReverse:g}=m,P=y.priceToSqrtPriceX64(c(d),t.decimals,o.decimals).toString();y.priceToTickIndex(c(d),t.decimals,o.decimals).toString();const p=t.decimals,T=o.decimals;let A,_;if(r==="0"&&l==="âˆž")A=I.getMinIndex(i),_=I.getMaxIndex(i);else{const k=g?B(l):r,q=g?B(r):l;y.priceToTickIndex(c(k),t.decimals,o.decimals).toString(),A=C(y.priceToTickIndex(c(k),p,T),i),_=C(y.priceToTickIndex(c(q),p,T),i)}const S=e===(t==null?void 0:t.coin_type),M=H(u,S?p:T).toString();return{...f({amount:M,tokenA:t,tokenB:o,isTokenA:S,lowerTick:A,upperTick:_,curSqrtPrice:P,isReverse:g,roundUp:!0}),currentSqrtPrice:P,fixAmountA:S,lowerTick:A,upperTick:_,tickSpacing:i,coinTypeA:t.coin_type,coinTypeB:o.coin_type}},fetchFeeTierList:async(m,i)=>{var d;try{if(m&&i){const r=await s({coin_type:`${m},${i}`,is_vaults:!1,display_all_pools:!0,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",offset:0});if(r&&r.list&&r.list.length>0){const l=b(r.list);return(d=v)==null?void 0:d.map(u=>{const e=l.find(t=>t.feeRate===u.feeRate);return{...u,title:(e==null?void 0:e.title)||u.title,poolAddress:e==null?void 0:e.poolAddress,liquidity:e==null?void 0:e.liquidity,tvl:e==null?void 0:e.tvl}})}else return[...v]}}catch{}return[...v]},getCreatePoolTxPayload:async m=>{const{tickSpacing:i,currentSqrtPrice:d,fixAmountA:r,coinAmountAOrigin:l,coinAmountBOrigin:u,lowerTick:e,upperTick:t,coinTypeA:o,coinTypeB:g}=m,P=await n.fullClient.getCoinMetadata({coinType:o}),p=await n.fullClient.getCoinMetadata({coinType:g});return await n.Pool.createPoolTransactionPayload({tick_spacing:i,initialize_sqrt_price:d,uri:"",fix_amount_a:r,amount_a:l,amount_b:u,slippage:a,tick_lower:e,tick_upper:t,coinTypeA:o,coinTypeB:g,metadata_a:P==null?void 0:P.id,metadata_b:p==null?void 0:p.id})}}}function K(n,f,s,a){const x=L.useMemo(()=>{if(n)return!1;try{if(f!==void 0&&s!==void 0&&a!==void 0)return c(f).lt(s)||c(f).gt(a)}catch{}return!1},[a,f,s,n]),h=L.useMemo(()=>{if(n)return!1;try{if(s!==void 0&&a!==void 0)return c(s).gt(a)}catch{}return!1},[a,s,n]);return{showInputPriceWarn:x,showPriceRangeWarn:h}}export{G as a,K as u};

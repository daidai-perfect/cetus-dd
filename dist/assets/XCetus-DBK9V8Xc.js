import{r as f,a1 as B,R as K,bA as P,a9 as O,d as Y,a8 as re,j as e,ad as ye,ae as Te,af as ve,ag as ke,ah as Re,ai as Le,aj as Ae,V as w,H as _,av as Ee,T as x,$ as N,aJ as U,a6 as pe,B as ie,k as he,bB as Me,bC as Ie,bD as De,bE as ze,W as M,bp as le,C as ne,bF as ge,b as J,m as q,g as $,Y as W,I as Ue,S as ue,aA as ce,an as fe,a4 as Pe,aO as se,aC as Oe}from"./index-D49RffYW.js";import{M as Q}from"./msafe-oYBkW7LJ.js";import{u as H}from"./useAccountBalance-D-weOZgA.js";import{u as me}from"./useTokenBalance-Cc02jFZo.js";import{u as Z}from"./useTransaction-i5gFyneH.js";import{u as ee,a as te,b as be,c as Be,d as Fe,e as Xe}from"./useXCetusHelper-wuRv4yeo.js";import{T as Ce}from"./TradeInputGroup-C7m7R_Tz.js";import{H as Ve}from"./HighlightText-DSzYWpab.js";import{H as xe}from"./HTextLabelBox-DVxTk_Ir.js";import{V as Se}from"./VTextLabelBox-hTKeBwlM.js";import{C as We}from"./CetusTooltip-7TnGbJNH.js";import{u as Ne}from"./useToken-BlS8b5ft.js";import{u as He}from"./useRpcListener-D8tK2rVa.js";import"./_getAllKeysIn-Caqnu8Ck.js";import"./usePreviousValue-D4m5LJZe.js";const je=(s,t,n="seconds")=>{const i=()=>{const c=s-new Date().getTime();if(c<=0)return{years:0,months:0,days:0,hours:0,minutes:0,seconds:0};const p=Math.floor(c/1e3%60),h=Math.floor(c/1e3/60%60),o=Math.floor(c/(1e3*60*60)%24),d=Math.floor(c/(1e3*60*60*24)%30),b=Math.floor(c/(1e3*60*60*24*30)%12),C=Math.floor(c/(1e3*60*60*24*365));return n==="days"?{years:0,months:0,days:d+b*30+C*365,hours:o,minutes:h,seconds:p}:n==="months"?{years:0,months:b+C*12,days:d,hours:o,minutes:h,seconds:p}:{years:C,months:b,days:d,hours:o,minutes:h,seconds:p}},[a,r]=f.useState(i());return f.useEffect(()=>{const l=setInterval(()=>{const c=i();r(c),c.years===0&&c.months===0&&c.days===0&&c.hours===0&&c.minutes===0&&c.seconds===0&&(clearInterval(l),t&&t())},1e3);return()=>clearInterval(l)},[s]),a};function Ge(){const{fetchAccountBalance:s}=H(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{currentAccount:i}=B(),{fetchOwnerVeNFT:a}=te(),{xCetusSdk:r}=K(),{veNFT:l}=P(),[c,p]=f.useState(""),[h,o]=f.useState(""),{balanceInfo:d}=me(O.cetus_coin),b=u=>{p(u),o(u)},[C,y]=f.useState(!1),S=async()=>{y(!0);const u={venft_id:l==null?void 0:l.id,amount:re(c,9).toFixed(0)},I=await r.XCetusModule.convertPayload(u),E=await n(I,{getShowInfo:v=>{const D=`Converting ${c} CETUS to ${c} xCETUS`,z={modalTitleText:"Convert",modalDescriptionText:D,toastDescriptionContent:D};if(v==="success"){const k=D.replace("Converting","Converted");z.modalDescriptionText=k,z.toastDescriptionContent=k}return z}},{msafeParams:{action:Q.xCETUSConvert,txbParams:u}});y(!1),E&&(i&&a(i==null?void 0:i.address,!0),p(""),o(""),s(),t())},T=f.useMemo(()=>{const u={text:"Convert",disabled:!1};return i!=null&&i.address?+c?(+c&&Y(c).gt((d==null?void 0:d.balanceFormat)||0)&&(u.disabled=!0,u.text="Insufficient CETUS Balance"),u):(u.text="Enter an amount",u.disabled=!0,u):(u.text="Connect Wallet",u.disabled=!1,u)},[d==null?void 0:d.balanceFormat,i==null?void 0:i.address,c]);return{inputAmountFrom:c,inputAmountTo:h,handleInputChange:b,balanceInfoFrom:d,convertLoading:C,btnText:T.text,btnDisabled:T.disabled,handleConvertClick:S}}function we(s){const{isOpen:t,onClose:n,onSubmitClick:i}=s,{setShowConvertModel:a}=P(),[r,l]=f.useState(!1);return e.jsxs(ye,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(ve,{children:[e.jsx(ke,{children:e.jsx(Re,{fontWeight:"500",fontSize:"16px"})}),e.jsx(Le,{}),e.jsx(Ae,{textAlign:"center",p:"0px",children:e.jsxs(w,{w:"100%",gap:"20px",p:"20px",pb:"90px",pos:"relative",children:[e.jsx(Ve,{text_color:"text_caption",text_size:"14px",text:` Please note that after conversion, if you want to convert xCETUS back to CETUS, a vesting period will be applied & different vesting
              durations correspond to different redeem ratios. Learn more`,keywords:["Learn more"],onKeywordClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")}}),e.jsxs(_,{children:[e.jsx(Ee,{checked:r,onClick:()=>{l(!r)}}),e.jsx(x,{color:"text_caption",children:"Do not remind again."})]}),e.jsx(N,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{a(!r),i()},children:"Convert"})]})})]})]})}function $e(s){const{availableXCetusAmount:t,iconParams:n,onIconClick:i}=s,{currentAccount:a,onWalletModal:r}=B(),{inputAmountFrom:l,inputAmountTo:c,handleInputChange:p,balanceInfoFrom:h,btnText:o,btnDisabled:d,handleConvertClick:b,convertLoading:C}=Ge(),{showConvertModel:y}=P(),[S,T]=f.useState(!1);return e.jsxs(w,{w:"100%",gap:"8px",children:[e.jsx(Ce,{onClick:i,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:(h==null?void 0:h.balanceFormat)||"",value:l,amountValue:"",loading:!1,onChange:u=>{p(u)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:U(t,9),value:c,half:!1,max:!1,amountValue:"",onChange:u=>{p(u)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},iconParams:n}),e.jsx(N,{w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:d||C,isLoading:C,onClick:()=>{a?y?T(!0):b():r(!0)},children:o}),S&&e.jsx(we,{isOpen:S,onClose:()=>{T(!1)},onSubmitClick:()=>{T(!1),b()}})]})}function Ye(s){const{fetchAccountBalance:t}=H(),{fetchOwnerLockCetusList:n}=ee(),{signAndExecuteTransaction:i}=Z(),{currentAccount:a}=B(),{fetchOwnerVeNFT:r}=te(),{xCetusSdk:l}=K(),{veNFT:c}=P(),[p,h]=f.useState(""),[o,d]=f.useState(""),[b,C]=f.useState(180),[y,S]=f.useState(""),[T,u]=f.useState(!0),{balanceInfo:I}=me(O.cetus_coin),E=(g,R)=>{u(R),R?h(g):d(g),D(g,R,b)},v=g=>{C(g),D(T?p:o,T,g)},D=async(g,R,X)=>{if(+g){const L=re(g,9);if(R){const j=await l.XCetusModule.redeemNum(L,X);d(U(j.amount_out,9)),S(Y(j.percent).mul(100).toFixed(2,pe.ROUND_DOWN))}else{const j=await l.XCetusModule.reverseRedeemNum(L,X);h(U(j.amount_out,9)),S(Y(j.percent).mul(100).toFixed(2,pe.ROUND_DOWN))}}else h(""),d(""),S("")},[z,k]=f.useState(!1),G=async()=>{if(!c)return;k(!0);const g={venft_id:c.id,amount:re(p,9).toFixed(0),lock_day:b},R=l.XCetusModule.redeemLockPayload(g),X=await i(R,{getShowInfo:L=>{const j=`Redeeming ${p} xCETUS to ${o} CETUS`,F={modalTitleText:"Redeem",modalDescriptionText:j,toastDescriptionContent:j};if(L==="success"){const m=j.replace("Redeeming","Redeemed");F.modalDescriptionText=m,F.toastDescriptionContent=m}return F}},{msafeParams:{action:Q.xCETUSRedeemLock,txbParams:g}});k(!1),X&&(a&&r(a==null?void 0:a.address,!0),h(""),d(""),t(),n())},V=f.useMemo(()=>{const g={text:"Redeem",disabled:!1};return a!=null&&a.address?+p?(+p&&Y(p).gt(s||0)&&(g.disabled=!0,g.text="Insufficient xCETUS Balance"),g):(g.text="Enter an amount",g.disabled=!0,g):(g.text="Connect Wallet",g.disabled=!1,g)},[s,a==null?void 0:a.address,p]);return{inputAmountFrom:p,inputAmountTo:o,handleInputChange:E,balanceInfoTo:I,convertLoading:z,btnText:V.text,btnDisabled:V.disabled,handleConvertClick:G,day:b,handleDayChange:v,percent:y}}function Ke(s){const{day:t,onChange:n}=s,i=f.useMemo(()=>`${t}D`,[t]),a=[{label:"15D"},{label:"30D"},{label:"90D"},{label:"180D"}];return e.jsxs(ie,{children:[e.jsxs(_,{w:"100%",justifyContent:"space-between",m:"10px 0",children:[e.jsxs(x,{fontSize:"16px",color:"text_caption",whiteSpace:"nowrap",children:[t," Days"]}),e.jsx(he,{type:"outlineTab",tabList:a,currentTab:i,handleChangeTab:r=>{r.label==="MAX"?n(100):n(r.label.replace("D",""))},wrapStyle:{flex:"1",maxW:"300px",h:"32px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),e.jsxs(Me,{"aria-label":"slider-ex-1",min:15,max:180,focusThumbOnChange:!1,value:Number(t),onChange:r=>n(r),children:[e.jsx(Ie,{h:"8px",children:e.jsx(De,{h:"4px"})}),e.jsx(ze,{})]})]})}function Je(s){const{availableXCetusAmount:t,iconParams:n,onIconClick:i}=s,{currentAccount:a,onWalletModal:r}=B(),{inputAmountFrom:l,inputAmountTo:c,handleInputChange:p,balanceInfoTo:h,btnText:o,btnDisabled:d,handleConvertClick:b,day:C,handleDayChange:y,percent:S,convertLoading:T}=Ye(t),{showConvertModel:u}=P(),[I,E]=f.useState(!1);return e.jsxs(w,{w:"100%",gap:"8px",children:[e.jsx(Ce,{onClick:i,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:t,value:l,amountValue:"",loading:!1,onChange:v=>{p(v,!0)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:(h==null?void 0:h.balanceFormat)||"",value:c,half:!1,max:!1,amountValue:"",onChange:v=>{p(v,!1)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},iconParams:n}),e.jsxs(M,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(x,{mb:"16px",color:"primary_gray",children:"Vesting duration"}),e.jsx(Ke,{day:C,onChange:v=>{y(Number(v))}})]}),e.jsx(M,{borderRadius:"12px",p:"0px",children:e.jsxs(w,{w:"100%",gap:"20px",children:[e.jsx(N,{mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:d||T,isLoading:T,onClick:()=>{a?u?E(!0):b():r(!0)},children:o}),+S&&e.jsx(_,{w:"100%",pb:"20px",pl:"16px",pr:"16px",children:e.jsx(xe,{label:"Redeem ratio",labelStyle:{fontSize:"14px"},value:le(S),valueStyle:{fontSize:"14px"}})})]})}),I&&e.jsx(we,{isOpen:I,onClose:()=>{E(!1)},onSubmitClick:()=>{E(!1),b()}})]})}function qe({nextStartTime:s,refresh:t}){const{days:n,hours:i,minutes:a,seconds:r}=je(s*1e3,t);return e.jsxs(w,{w:"100%",gap:"16px",borderRadius:"16px",m:"-1px",p:{base:"24px 12px",lg:"24px"},sx:{backgroundImage:"url('/images/img_xcetus@2x.png')",backgroundPosition:"top center",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:[e.jsx(x,{fontSize:"16px",color:"text_caption",children:"Convert CETUS to xCETUS to start earning"}),e.jsx(x,{children:"Reward distribution in "}),e.jsxs(_,{children:[e.jsx(M,{borderRadius:"4px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ne,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(x,{fontSize:"16px",textColor:"text_caption",children:[n,"d"]})})}),e.jsx(x,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(M,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ne,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(x,{fontSize:"16px",textColor:"text_caption",children:[i,"h"]})})}),e.jsx(x,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(M,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ne,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(x,{fontSize:"16px",textColor:"text_caption",children:[a,"m"]})})}),e.jsx(x,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(M,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ne,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(x,{fontSize:"16px",textColor:"text_caption",children:[r,"s"]})})})]})]})}function Qe(){const{fetchAccountBalance:s}=H(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{xCetusSdk:i}=K(),{veNFT:a}=P(),{fetchOwnerVeNFT:r}=te(),{currentAccount:l}=B(),[c,p]=f.useState(!1);return{handleCancelOrder:async o=>{if(!a)return;p(!0);const d={venft_id:a.id,lock_id:o.id},b=i.XCetusModule.cancelRedeemPayload(d),C=await n(b,{},{msafeParams:{action:Q.xCETUSCancelRedeem,txbParams:d}});p(!1),C&&(s(),t(),l&&r(l==null?void 0:l.address,!0))},cancelOrderLoading:c}}function Ze(){const{fetchAccountBalance:s}=H(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{xCetusSdk:i}=K(),{veNFT:a}=P(),{fetchOwnerVeNFT:r}=te(),{currentAccount:l}=B(),[c,p]=f.useState(!1);return{handleClaimOrder:async o=>{if(p(!0),!a)return;const d={lock_id:o,venft_id:a.id},b=await i.XCetusModule.redeemPayload(d),C=await n(b,{},{useDevInspect:!1,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:Q.xCETUSRedeem,txbParams:d}});p(!1),C&&(s(),t(),l&&r(l==null?void 0:l.address,!0))},claimOrderLoading:c}}function et(s){const{lockCetusList:t}=s;return e.jsx(M,{p:{base:"16px 8px 8px",lg:"16px"},borderRadius:"16px",children:e.jsxs(w,{w:"100%",alignItems:"start",gap:"16px",children:[e.jsx(x,{fontSize:"16px",color:"text_caption",mt:"4px",children:"Vesting"}),t.map(n=>e.jsx(tt,{info:n},n.id))]})})}function tt(s){const{info:t}=s,[n,i]=f.useState(!1),{days:a,hours:r,minutes:l,seconds:c}=je(t.locked_until_time*1e3,()=>{i(!0)},"days");f.useEffect(()=>{i(!ge.isLocked(t))},[]);const{cancelOrderLoading:p,handleCancelOrder:h}=Qe(),{claimOrderLoading:o,handleClaimOrder:d}=Ze(),b=y=>{y?d(t.id):h(t)},{isApp:C}=J();return e.jsx(M,{borderRadius:"12px",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(q,{flexDir:{base:"column",lg:"row"},w:"100%",justifyContent:{base:"flex-start",lg:"space-between"},gap:{base:"20px",lg:"8px"},children:[e.jsxs(w,{gap:{base:"20px",lg:"8px"},alignItems:"start",children:[e.jsxs(_,{gap:"6px",children:[e.jsxs(x,{color:"primary_gray",children:["Available ",n?"":" in"," "]}),!n&&e.jsxs(x,{color:"text_caption",children:[a,"d : ",r,"h : ",l,"m : ",c,"s"]})]}),C?e.jsxs(w,{w:"100%",align:"center",gap:"8px",children:[e.jsxs(_,{children:[e.jsx($,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(x,{color:"text_caption",children:[W(U(t.xcetus_amount,9),9)," xCETUS"]})]}),e.jsx(x,{color:"text_caption",transform:"rotate(90deg)",children:"→"}),e.jsxs(_,{children:[e.jsx($,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(x,{color:"text_caption",children:[W(U(t.cetus_amount,9),9)," CETUS "]})]})]}):e.jsxs(_,{children:[e.jsx($,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(x,{color:"text_caption",children:[W(U(t.xcetus_amount,9),9)," xCETUS →"]}),e.jsx($,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(x,{color:"text_caption",children:[W(U(t.cetus_amount,9),9)," CETUS "]})]})]}),e.jsx(_,{w:{base:"100%",lg:"auto"},justify:"center",children:e.jsx(N,{onClick:()=>{p||o||b(!!n)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:p||o,color:n?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:n?"Claim":"Cancel"})})]})})}function nt(){const{fetchAccountBalance:s}=H(),{signAndExecuteTransaction:t}=Z(),{xCetusSdk:n}=K(),{veNFT:i}=P(),[a,r]=f.useState(!1),{fetchVeNFTDividendInfo:l}=be();return{handleClaimReward:async p=>{if(i){r(!0);try{const h=n.XCetusModule.redeemDividendV3Payload(i.id,p),o=await t(h,{},{useDevInspect:!0,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:Q.xCETUSClaimStakingRwewards,txbParams:{veNftId:i.id,rewardList:p}}});r(!1),o&&(s(),l(i.id))}catch{}finally{r(!1)}}},claimRewardLoading:a}}function st(s){const{myShare:t,cetusApr:n,totalRewardValue:i,summaryRewardList:a,rewardList:r}=s,{claimRewardLoading:l,handleClaimReward:c}=nt(),{currentAccount:p}=B(),{veNFTLoading:h}=P(),{isApp:o}=J();return e.jsxs(w,{w:"100%",alignItems:"start",p:{base:"4px 8px 8px",lg:"4px 16px 16px"},gap:"16px",children:[e.jsx(x,{fontSize:"16px",color:"text_caption",children:"xCETUS Staking Rewards"}),e.jsxs(q,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsx(M,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(_,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsxs(_,{gap:"4px",children:[e.jsx(x,{color:"primary_gray",children:"est.APR"}),e.jsx(We,{placement:o?"bottom-end":"top-start",maxW:{base:"calc(100vw - 16px)",lg:"unset"},tooltip:o?e.jsxs(ie,{as:"div",lineHeight:"20px",children:[e.jsx(x,{as:"span",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders. "}),e.jsx(x,{as:"span",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100% "}),e.jsx(x,{as:"span",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}):e.jsxs(w,{alignItems:"start",children:[e.jsx(x,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders."}),e.jsx(x,{whiteSpace:"nowrap",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100%"}),e.jsx(x,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}),children:e.jsx(ie,{children:e.jsx(Ue,{xlinkHref:"#icon-icon_tips"})})})]}),e.jsx(ue,{isLoaded:n!=="0",children:e.jsxs(x,{fontSize:"18px",color:"text_caption",children:["≈",le(n,2)]})})]})}),e.jsx(M,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(_,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsx(x,{color:"primary_gray",children:"Your Share"}),e.jsx(ue,{isLoaded:!h,children:e.jsx(x,{fontSize:"18px",color:"text_caption",children:t!=="--"?`≈${t}`:t})})]})})]}),"(",e.jsx(M,{borderRadius:"12px",w:"100%",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(w,{h:"100%",w:"100%",gap:{base:"20px",lg:"14px"},children:[e.jsxs(_,{w:"100%",justifyContent:"space-between",children:[e.jsx(x,{color:"primary_gray",children:"Pending Yield"}),e.jsxs(_,{justifyContent:"end",gap:"12px",children:[e.jsx(x,{fontSize:"18px",color:"text_caption",children:p?ce(i,2):"--"}),!o&&a.length>0&&e.jsx(N,{onClick:()=>{l||c(r)},variant:"outline",h:"28px",w:"80px",borderRadius:"8px",fontSize:"14px",disabled:l,isLoading:l,bg:"button_ghost_bg",children:"Claim"})]})]}),a.length>0&&e.jsx(q,{w:"100%",flexDir:{base:"column",lg:"row"},align:"center",justify:{base:"center",lg:"flex-start"},gap:{base:"20px",lg:"8px"},children:a.map(d=>e.jsx(at,{info:d},d.coin_type))}),o&&a.length>0&&e.jsx(N,{onClick:()=>{l||c(r)},variant:"outline",h:"40px",w:"168px",borderRadius:"12px",fontSize:"14px",disabled:l,isLoading:l,bg:"button_ghost_bg",children:"Claim"})]})}),")"]})}function at(s){const{info:t}=s,{tokenInfo:n}=Ne(t.coin_type),{isApp:i}=J();return i?e.jsx(xe,{label:e.jsxs(_,{children:[e.jsx($,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(x,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(w,{alignItems:"flex-end",gap:"4px",children:[e.jsx(x,{color:"text_caption",children:t.amount}),Y(t.value).gt("0")&&e.jsx(x,{children:ce(t.value,2)})]})}):e.jsx(Se,{wrapStyle:{gap:"10px",flex:1,alignItems:"flex-start"},title:e.jsxs(_,{children:[e.jsx($,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(x,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(w,{alignItems:"flex-start",gap:"4px",children:[e.jsx(x,{color:"text_caption",children:t.amount}),Y(t.value).gt("0")&&e.jsx(x,{children:ce(t.value,2)})]})})}function ot(s){const{totalAmount:t,availableAmount:n,redeemingAmount:i,isLoading:a}=s,{currentAccount:r}=B();return J(),e.jsxs(w,{w:{base:"100%",lg:"100%"},gap:{base:"20px",lg:"28px"},zIndex:"100",mt:{base:"20px",lg:"32px"},children:[e.jsxs(w,{w:"100%",h:"140px",gap:"20px",borderRadius:"20px",bg:{base:"none",lg:"center / cover no-repeat url('/images/xcetus_banner.png')"},align:"center",justify:"center",children:[e.jsxs(x,{h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_caption",children:["Manage your"," ",e.jsx(x,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_green",children:"CETUS"})," ","and"," ",e.jsx(x,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"primary",children:"xCETUS"})]}),e.jsx(N,{h:"28px",w:"132px",fontSize:"14px",fontWeight:"600",variant:"outline",bg:"transparent",borderRadius:"8px",borderColor:"text_highlight",color:"text_highlight",onClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")},children:"Learn more"})]}),e.jsxs(q,{flexDir:{base:"column",lg:"row"},w:{base:"100%",lg:"80%"},justifyContent:{base:"space-between",lg:"space-around"},align:{base:"flex-start",lg:"center"},gap:{base:"16px",lg:"40px"},children:[e.jsx(oe,{isLoading:a,icon:"/images/icon_my_total_xWHALE@2x.png",title:"My total xCETUS",amount:r?W(U(t,9),9).toString():"--",w:{base:"28px",lg:"42px"},h:{base:"24px",lg:"36px"},wrapStyle:{gap:"2px"}}),e.jsx(oe,{isLoading:a,icon:"/images/icon_available_xWHALE@2x.png",title:"Available xCETUS",amount:r?W(U(n,9),9).toString():"--",w:{base:"24px",lg:"36px"},h:{base:"24px",lg:"36px"}}),e.jsx(oe,{isLoading:a,icon:"/images/icon_redeeming_xWHALE@2x.png",title:"Redeeming xCETUS",amount:r?W(U(i,9),9).toString():"--",w:{base:"26px",lg:"38px"},h:{base:"26px",lg:"38px"}})]})]})}function oe(s){const{isLoading:t,icon:n,title:i,amount:a,w:r,h:l,wrapStyle:c={}}=s,{isApp:p}=J();return p?e.jsx(xe,{label:e.jsxs(_,{...c,children:[e.jsx(fe,{src:n,w:r,h:l}),e.jsx(x,{children:i})]}),value:a,isLoading:t,labelStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"14px"}}):e.jsxs(_,{gap:"6px",alignItems:"center",w:{base:"100%",lg:"auto"},...c,children:[e.jsx(fe,{src:n,w:r,h:l}),e.jsx(Se,{wrapStyle:{gap:"8px"},title:i,titleStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"16px",fontWeight:"500"},value:a,isLoading:t})]})}function rt(){const{xCetusSdk:s}=K(),{currentAccount:t}=B(),{fetchAccountBalance:n,isLoading:i}=H(),{fetchTokenPrices:a}=Pe(),{lockCetusList:r,veNFTLoading:l,lockCetusListLoading:c,clearData:p,owner:h,veNFT:o,XCetusManager:d,setXCetusManager:b,setDividendManager:C,setPhaseDividendInfoMap:y,phaseDividendInfoMap:S}=P(),{nextStartTime:T,currentPeriod:u,calculateCurrPeriod:I}=Be(),{summaryRewardList:E,rewardList:v,totalRewardValue:D}=Fe(u),{fetchVeNFTDividendInfo:z}=be(),k=async m=>{try{const A=await s.XCetusModule.getXcetusManager(m);A&&b(A)}catch{}},G=async m=>{try{const A=await s.XCetusModule.getPhaseDividendInfo(m.toString());if(A)y(A);else{const _e=(m-1).toString();if(!S[_e]){const de=await s.XCetusModule.getPhaseDividendInfo(m.toString());de&&y(de)}}}catch{}},V=async m=>{try{const A=await s.XCetusModule.getDividendManager(m);A&&C(A)}catch{}},{fetchOwnerVeNFT:g}=te(),R=f.useMemo(()=>{if(o&&t&&!c){const m=ge.getAvailableXCetus(o,r);if(se(m).gte(0))return m}return"0"},[o==null?void 0:o.xcetus_balance,r]),X=f.useMemo(()=>{if(o){const m=se(o.xcetus_balance).sub(R);if(m.gte(0))return m.toFixed(0)}return"0"},[o==null?void 0:o.xcetus_balance,R]),L=f.useMemo(()=>{if(d&&o){const m=se(o.xcetus_balance).div(d.treasury).mul(100);return se(m).lt(.01)?"<0.01%":le(m.toString(),3)}return t?"0%":"--"},[d==null?void 0:d.treasury,o==null?void 0:o.xcetus_balance]),j=f.useMemo(()=>{if(u){let m=S[u.toString()];return m===void 0&&(m=S[(u-1).toString()]),m}},[S,u]),{cetusApr:F}=Xe(j,d==null?void 0:d.treasury);return f.useEffect(()=>{if(j){const m=j.bonus_types.map(A=>Oe(A,!1));m&&(m.push("0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),a(m))}},[j==null?void 0:j.id]),f.useEffect(()=>{u&&u>0&&G(u)},[u]),f.useEffect(()=>{o&&z(o.id)},[o==null?void 0:o.id]),{fetchOwnerVeNFT:g,fetchAccountBalance:n,fetchXCetusManager:k,fetchDividendManager:V,fetchVeNFTDividendInfo:z,veNFTLoading:l,lockCetusListLoading:c,redeemingXCetusAmount:X,availableXCetusAmount:R,veNFT:o,myShare:L,nextStartTime:T,cetusApr:F,summaryRewardList:E,rewardList:v,totalRewardValue:D,lockCetusList:r,calculateCurrPeriod:I}}const ae=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function _t(){const{currentAccount:s}=B(),{fetchOwnerVeNFT:t,fetchXCetusManager:n,fetchVeNFTDividendInfo:i,availableXCetusAmount:a,veNFT:r,veNFTLoading:l,lockCetusListLoading:c,redeemingXCetusAmount:p,fetchDividendManager:h,myShare:o,nextStartTime:d,cetusApr:b,summaryRewardList:C,totalRewardValue:y,lockCetusList:S,rewardList:T,calculateCurrPeriod:u}=rt(),{dividendManager:I}=P(),{fetchOwnerLockCetusList:E}=ee(),[v,D]=f.useState("Get xCETUS"),{fetchAccountBalance:z}=H();He({onRpcChange:()=>{n(!1),h(!1),s&&(t(s.address,!0),E(s.address),z())}}),f.useEffect(()=>{s&&(t(s.address,!0),E(s.address))},[s==null?void 0:s.address]),f.useEffect(()=>{n(!1),h(!1),s!=null&&s.address&&z()},[]);const[k,G]=f.useState("#icon-a-icon_trade"),V=()=>{G("#icon-icon_swap1")},g=()=>{G("#icon-a-icon_trade")},R=()=>{var j;const L=(j=ae==null?void 0:ae.find(F=>(F==null?void 0:F.value)!==v))==null?void 0:j.value;L&&D(L)},{isApp:X}=J();return e.jsxs(w,{gap:"0px",w:"100%",pos:"relative",sx:X?{backgroundImage:"url('/images/xcetus_h5_bg.png')",backgroundPosition:"center 256px",backgroundRepeat:"no-repeat",backgroundSize:"375px 200px"}:{},children:[e.jsx(ot,{totalAmount:(r==null?void 0:r.xcetus_balance)||"0",availableAmount:a,redeemingAmount:p,isLoading:c||l}),e.jsxs(q,{flexDir:{base:"column-reverse",lg:"row"},mt:{base:"118px",lg:"28px"},zIndex:100,w:"100%",gap:"16px",alignItems:"start",justifyContent:"space-between",children:[e.jsxs(w,{w:"60%",gap:"16px",minW:{base:"100%",lg:"600px"},children:[e.jsx(M,{p:"0px",borderRadius:"16px",w:"100%",children:e.jsxs(w,{w:"100%",gap:"16px",children:[e.jsx(qe,{nextStartTime:d||0,refresh:()=>{r&&i(r.id),h(!0),I&&u(I)}}),e.jsx(st,{myShare:o.toString(),cetusApr:b,totalRewardValue:y,summaryRewardList:C,rewardList:T})]})}),S.length>0&&e.jsx(et,{lockCetusList:S})]}),e.jsxs(w,{w:"40%",gap:"8px",minW:{base:"100%",lg:"380px"},children:[e.jsx(he,{type:"borderTab",wrapStyle:{w:"100%",h:"60px"},itemStyle:{w:"50%",fontSize:"16px"},tabList:ae,currentTab:v,handleChangeTab:L=>{D(L==null?void 0:L.value)}}),v==="Get xCETUS"&&e.jsx($e,{availableXCetusAmount:a,onIconClick:R,iconParams:{xlinkHref:k,svgFill:"text_caption",transform:k==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:k==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:V,onMouseLeave:g}}),v==="Redeem CETUS"&&e.jsx(Je,{availableXCetusAmount:U(a,9),onIconClick:R,iconParams:{xlinkHref:k,svgFill:"text_caption",transform:k==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:k==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:V,onMouseLeave:g}})]})]})]})}export{_t as default};

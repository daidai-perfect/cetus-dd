import{j as e,W as le,X as pe,Y as ce,Z as de,a7 as xe,$ as ue,a0 as he,a as d,p as ge,H as g,P as me,h as fe,aM as je,aN as be,aq as Se,m as ye,n as we,q as $,aO as w,V as m,T as _,f as z,C as _e}from"./vendor-BFGDaAdA.js";import{u as U,A as ve}from"./AggregatorModal-BVnTPxx6.js";import{c as Re,u as Te,a as Ae,S as Fe,P as ke,b as Pe}from"./SwapConfirmBlock-D1Qmxwlo.js";import{u as We}from"./useSwapHelper-BbrB3cYm.js";import{u as Ce}from"./global-DcBmTUHf.js";import{u as K}from"./swap-DJIJTyN8.js";import{u as He,a9 as Le,bG as Oe,Y as ze,I as Ee,d as Y,bH as Be,c as X,h as Me,o as De,e as Ge,k as Ve,a as Ne,C as Ye,f as qe,q as $e}from"./index-Fe2tZAmL.js";import{H as Ue}from"./HTextLabelBox-a2CUIzAy.js";import{I as Ke}from"./IconBg-CNsrV97k.js";import{u as Xe}from"./useAccountBalance-Byib0voT.js";import{T as Ze}from"./TradeInputGroup-eK__EKBF.js";import{W as Je}from"./WarningTokenTipModal-CAOu4K2p.js";import{M as Qe,S as Ie}from"./usePriceImpact-Cr2BxG0A.js";import{u as et}from"./useRequest-CC9lBztJ.js";import{F as tt}from"./FreshProgressV2-Bnti4onk.js";import{A as st}from"./SingleTokenInfo-B9uwt8O4.js";import{T as rt}from"./TooltipIcon-CkpQwR2w.js";import{R as at}from"./Ratio-BLnARnRv.js";import{R as ot,Y as it}from"./YAxis-DVR7ZRxP.js";import{a as nt,L as lt}from"./LineChart-DXSeq3VE.js";import{T as pt}from"./generateCategoricalChart-hocsCG4y.js";import"./aggregator-D4sneHJ5.js";import"./index-DbIfZqWn.js";import"./useTransaction-C_My4i0J.js";import"./useTrack-BN91iIb4.js";import"./useSigner-x-lws_pV.js";import"./useToken-BKskvPZm.js";import"./useTokenBalance-DP5kgkCW.js";import"./useFindBestRouting-iZLE70Rn.js";import"./CurrentPrice-BC2rvqOV.js";import"./HighlightText-fkyigc44.js";import"./index-DRyIuzDp.js";import"./TradeConfirmAmountInfo-ieFyTpIb.js";import"./useGetPoolList-B1Mv5UcY.js";import"./useWrapPoolData-CAoAUewj.js";import"./_getAllKeysIn-DlEC7EaN.js";import"./CheckBox-CTFo1Bg1.js";import"./index-BLCSsYSf.js";import"./debounce-B8kzHASh.js";import"./CopyButton-CAzfUkNT.js";import"./linear-DYpwdEgO.js";function ct(s){const{isOpen:t,onClose:a,data:o,onSubmitClick:i}=s,{fromCoin:p,toCoin:r,routerData:f}=K();return e.jsxs(le,{autoFocus:!1,returnFocusOnClose:!1,trapFocus:!1,isOpen:t,onClose:a,isCentered:!0,children:[e.jsx(pe,{}),e.jsxs(ce,{children:[e.jsx(de,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",children:"Swap"})}),e.jsx(ue,{}),e.jsx(he,{textAlign:"center",p:"0px",children:e.jsx(Re,{onSubmitClick:i,onClose:a,data:o,lastRouterData:f,fromCoin:p,toCoin:r,isWidget:!1})})]})]})}function dt(){const{fetchByApi:s}=He(),{setProviders:t}=Le();return{fetchRouterConfig:async()=>{try{const o=await s(Oe,"GET"),{providers:i}=o;i&&i.length>0&&t(i),console.log("ðŸš€ ~ file: useGetRouterConfig.ts:13 ~ fetchRouterConfig ~ res:",o)}catch(o){console.log("ðŸš€ ~ file: useGetRouterConfig.ts:18 ~ fetchRouterConfig ~ error:",o)}}}}function xt(){const[s,t]=d.useState(!1),a=d.useRef(null),o=()=>{t(!1)},{fetchRouterConfig:i}=dt(),{loading:p}=et(i),{handleSelectAllProviderClick:r,handleSaveClick:f,currProvidersSwitchStates:v,isOpenAggregatorMode:c}=U(),h=()=>{c||b(),r(!c)};ze(()=>{f()},[v]);const b=()=>{var R;const j=window.innerWidth,u=window.innerHeight,l=(R=a.current)==null?void 0:R.getBoundingClientRect(),A=l==null?void 0:l.left,F=l==null?void 0:l.top,x=2,S=w.shapeFromText({text:"ðŸŸ¢",scalar:x}),k=w.shapeFromText({text:"ðŸ”µ",scalar:x}),P=w.shapeFromText({text:"ðŸ’š",scalar:x}),W=w.shapeFromText({text:"ðŸ’™",scalar:x});w({particleCount:40,spread:60,shapes:[S,k,P,W],scalar:x,origin:{x:A/j,y:F*1.2/u}})};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{isLoaded:!p,w:"178px",h:"28px",children:e.jsxs(g,{border:"1px solid",borderColor:"border",borderRadius:"8px",h:"28px",bg:"bg_secondary",gap:"8px",children:[e.jsxs(me,{isLazy:!0,trigger:"hover",autoFocus:!1,returnFocusOnClose:!1,children:[e.jsx(fe,{children:e.jsxs(je,{display:"flex",alignItems:"center",pl:"8px",children:[e.jsx(be,{htmlFor:"aggregator-mode",mb:"0",bg:"plus_mode_color",textFillColor:"transparent",backgroundClip:"text",h:"18px",lineHeight:"18px",fontSize:"12px",fontWeight:"500",fontStyle:"normal",mr:"8px",children:"Aggregator Mode"}),e.jsx(Se,{ref:a,id:"aggregator-mode",isChecked:c,onChange:h})]})}),e.jsx(ye,{children:e.jsx(we,{p:"12px",lineHeight:"20px",fontSize:"12px",children:"The Aggregator Mode will aggregate external liquidity sources"})})]}),e.jsx($,{variant:"unstyled",mr:"-1px",minW:"20px",w:"20px",p:"7px 4px",h:"28px",bg:"border",borderRadius:"0 8px 8px 0",onClick:()=>t(!s),_hover:{svg:{fill:"text_caption"}},children:e.jsx(Ee,{xlinkHref:"#icon-icon_list_token",fontSize:"12px"})})]})}),s&&e.jsx(ve,{isOpen:s,onClose:o})]})}const ut=({active:s,payload:t,label:a})=>{var o,i;return s&&t&&t.length?e.jsxs("div",{style:{backgroundColor:"#121212",border:"1px solid border_secondary",padding:"12px",borderRadius:"8px",position:"relative",left:"0px",top:"-30px",fontSize:"12px"},children:[e.jsx("p",{style:{color:"#909CA4"},children:Be.unix((i=(o=t[0])==null?void 0:o.payload)==null?void 0:i.timestamp).format("MM/DD HH:mm")}),e.jsxs("p",{style:{color:"#fff",marginTop:"8px"},children:["$",X(t[0].value)]})]}):null};function ht({data:s=[]}){const t=Y(Math.min(...s.map(o=>o.price))).mul(.99999).toNumber(),a=Y(Math.max(...s.map(o=>o.price))).mul(1.00001).toNumber();return e.jsx(ot,{width:"100%",height:"100%",children:e.jsxs(nt,{width:180,height:48,data:s,margin:{top:5,right:20,left:20,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"priceLine",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(117, 200, 255, 1)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(104, 255, 216, 1)"})]})}),e.jsx(it,{hide:!0,domain:[t,a]}),e.jsx(pt,{cursor:!1,content:e.jsx(ut,{})}),e.jsx(lt,{type:"linear",dot:!1,dataKey:"price",stroke:"url(#priceLine)",strokeWidth:2})]})})}function gt({fromCoin:s,toCoin:t}){return d.useMemo(()=>[s,t].filter(Boolean).filter(o=>!!((o==null?void 0:o.is_verified)===void 0?o!=null&&o.is_trusted:o!=null&&o.is_verified)),[s,t]).length?e.jsxs(m,{w:"100%",align:"flex-start",gap:"8px",children:[e.jsxs(g,{justify:"flex-start",h:"52px",align:"center",gap:"4px",children:[e.jsx(_,{fontSize:"14px",fontWeight:"500",color:"text_caption",h:"20px",lineHeight:"20px",children:"Price Reference"}),e.jsx(rt,{type:"priceReference"})]}),e.jsxs(m,{w:"100%",gap:"28px",children:[((s==null?void 0:s.is_verified)===void 0?s==null?void 0:s.is_trusted:s==null?void 0:s.is_verified)&&e.jsx(q,{coin:s}),((t==null?void 0:t.is_verified)===void 0?t==null?void 0:t.is_trusted:t==null?void 0:t.is_verified)&&e.jsx(q,{coin:t})]})]}):null}const q=({coin:s})=>{const{getExplorerUrl:t}=Me(),{getPriceKline:a,getTokenPrice:o}=De(),[i,p]=d.useState({price:[],daily_rate:""});d.useEffect(()=>{p({price:[],daily_rate:""})},[s]);const r=o(s==null?void 0:s.coin_type),f=async(v,c)=>{try{const h=await a(v,c);p(h)}catch(h){console.log(h,"error")}};return d.useEffect(()=>{r!=null&&r.base_symbol&&(r==null?void 0:r.market)!=="cetus"&&f(r==null?void 0:r.base_symbol,r==null?void 0:r.market)},[r==null?void 0:r.base_symbol,r==null?void 0:r.market,s==null?void 0:s.coin_type]),!i||i.price.length===0?e.jsx(e.Fragment,{}):e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-start",h:"32px",children:[e.jsxs(g,{children:[e.jsx(Ge,{imageUrl:s==null?void 0:s.logo_url,w:"28px",h:"28px"}),e.jsxs(m,{align:"flex-start",gap:"4px",children:[e.jsx(_,{fontSize:"14px",h:"16px",lineHeight:"16px",fontWeight:"600",color:"text_caption",children:s==null?void 0:s.symbol}),e.jsx(_,{fontSize:"12px",h:"12px",lineHeight:"12px",fontWeight:"500",children:s==null?void 0:s.name})]})]}),e.jsxs(g,{children:[(r==null?void 0:r.market)&&e.jsx(Qe,{market:r==null?void 0:r.market}),e.jsxs(_,{color:"text_caption",fontSize:"14px",fontWeight:"500",children:["$",(r==null?void 0:r.price)!==void 0?X(r==null?void 0:r.price):"--"]}),(i==null?void 0:i.daily_rate)&&(r==null?void 0:r.price)!==void 0&&e.jsx(at,{value:i==null?void 0:i.daily_rate})]})]}),e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-end",gap:"0",children:[e.jsx(st,{address:s==null?void 0:s.coin_type,onClickLink:()=>window.open(t(s==null?void 0:s.coin_type,"coin")),wrapStyle:{border:"1px solid",borderColor:"border",h:"24px",borderRadius:"8px",p:"0 8px",bg:"bg_secondary"},fontWeight:"500"}),e.jsx(z,{flex:"0 0 210px",h:"24px",mr:"-13px",children:(r==null?void 0:r.price)!==void 0&&(i==null?void 0:i.price.length)>0&&e.jsx(ht,{data:i==null?void 0:i.price})})]})]})};function is(){const s=K(),{fromCoin:t,toCoin:a,setFromCoin:o,setToCoin:i,byAmountIn:p,setFromAmount:r,setToAmount:f,setByAmountIn:v,findRouterLoading:c,routerData:h}=s,{handleSelectToken:b,handleAmountChange:j,fromAmount:u,toAmount:l,fromAmountValue:A,toAmountValue:F,fromBalanceInfo:x,toBalanceInfo:S,amountLimit:k,getSwapSecondaryData:P,doSwapAction:W,reCalculateRouteData:R,scamsText:E,refreshMarketPrice:Z,isOpenConfirmModel:C,setIsOpenConfirmModel:B,resetInputAmount:J,onReverseClick:Q}=Te(s,!1),{currentAccount:T,onWalletModal:I}=Ve(),{fetchAccountBalance:M}=Xe();d.useEffect(()=>{T!=null&&T.address&&M()},[]);const{btnText:ee,btnDisabled:te}=Ae(u,l,x==null?void 0:x.balanceFormat,t,a,h),D=d.useRef(null),{formatSwapRouter:se}=We(h),{isOpenAggregatorMode:H}=U(),re=()=>{var n;(n=D.current)==null||n.reset()},G=()=>{R(),M(),Z()};d.useEffect(()=>{re()},[l,u,t==null?void 0:t.coin_type,a==null?void 0:a.coin_type]),d.useEffect(()=>{p||G()},[l,t==null?void 0:t.coin_type,a==null?void 0:a.coin_type]),d.useEffect(()=>{J()},[H]);const ae=d.useMemo(()=>{const n=[];return t&&n.push(t),a&&n.push(a),n},[t,a]),[L,V]=d.useState("#icon-a-icon_trade"),oe=()=>{V("#icon-icon_swap1")},ie=()=>{V("#icon-a-icon_trade")},{isApp:N}=Ne(),{isShowTradeChart:y,setIsShowTradeChart:ne,isShowTradeOrders:mt,setIsShowTradeOrders:ft}=Ce();return e.jsx(e.Fragment,{children:e.jsxs(m,{gap:{base:"16px",lg:"8px"},w:{base:"100%",lg:"470px"},children:[e.jsxs(g,{w:"100%",justify:"space-between",children:[e.jsx(xt,{}),e.jsxs(g,{children:[e.jsx(Ie,{}),e.jsx(Ye,{showTooltip:!N,placement:"bottom-end",tooltip:e.jsx(_,{fontSize:"12px",children:y?"Hide reference price":"View reference price"}),children:e.jsx(_e,{children:e.jsx(Ke,{w:"28px",h:"28px",borderRadius:"8px",variant:"",xlinkHref:"#icon-icon_kline",svgFill:y?"primary":"",svgHover:y?"primary":N?"text_paragraph":"text_caption",onClick:()=>ne(!y)})})}),e.jsx(tt,{callbackInterval:C?5:10,ref:D,min:0,max:10,onClick:G})]})]}),e.jsxs(z,{w:"100%",children:[e.jsx(Ze,{wrapStyle:{gap:{base:"16px",lg:"8px"},mt:{base:"0px",lg:"4px"}},onClick:()=>Q(H),from:{title:"You Pay",balance:(x==null?void 0:x.balanceFormat)||"",value:u,amountValue:A,loading:!p&&c,onChange:n=>{j(n,!0)},selectable:!0,placeholder:"0.0",token:t,onFocusChange:n=>{n&&+u&&!p&&j(u,!0)},onTokenChange:n=>{b(n,!0)}},to:{title:"You Receive",balance:(S==null?void 0:S.balanceFormat)||"",value:l,amountValue:F,loading:p&&c,onFocusChange:n=>{n&&+l&&p&&j(l,!1)},onTokenChange:n=>{b(n,!1)},inputAllowed:!H,onChange:n=>{j(n,!1)},selectable:!0,placeholder:"0.0",token:a,half:!1,max:!1},iconParams:{xlinkHref:L,svgFill:"text_caption",transform:L==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:L==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:oe,onMouseLeave:ie}}),E&&e.jsx(z,{mt:"-32px",p:"48px 16px 16px",borderRadius:"20px",bg:"bg_secondary",border:"1px solid",borderColor:"border",children:e.jsx(Fe,{scamsText:E})})]}),(t||a)&&e.jsx(Je,{addToken:!0,tokensInfo:ae,waringModalCancel:n=>{n.forEach(O=>{(O.coin_type===(t==null?void 0:t.coin_type)||O.coin_type===(a==null?void 0:a.coin_type))&&b(void 0,O.coin_type===(t==null?void 0:t.coin_type))})}}),e.jsxs(m,{p:+u&&+l?"0 8px 12px":"0 8px",w:"100%",gap:"8px",border:"1px solid",borderColor:"border",borderRadius:"20px",bg:"bg_secondary",children:[e.jsx($,{w:"calc(100% + 18px)",h:"52px",margin:"-1px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:c||te,isLoading:c,onClick:()=>{T?B(!0):I(!0)},children:[t,a].filter(Boolean).length<2?"Select a token":ee}),!!+u&&!!+l&&e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsx(ke,{findRouterLoading:c,routerData:h,fromCoin:t,toCoin:a}),e.jsx(Ue,{isLoading:c,label:p?"Minimum Received":"Maximum Sold",value:`${qe(k,p?a==null?void 0:a.decimals:t==null?void 0:t.decimals,!1,$e.ROUND_DOWN)} ${p?a==null?void 0:a.symbol:t==null?void 0:t.symbol}`,labelStyle:{fontWeight:500,whiteSpace:"nowrap",fontSize:"14px"},valueStyle:{fontWeight:500,fontSize:"14px"},skeletonStyle:{valueW:"128px"},wrapStyle:{p:"0 8px",minH:"20px"}}),e.jsx(Pe,{formatSwapRouter:se,findRouterLoading:c,fromAmount:u,toAmount:l,fromCoin:t,toCoin:a})]})]}),!y&&e.jsx(gt,{fromCoin:t,toCoin:a}),C&&e.jsx(ct,{data:P(),isOpen:C,onSubmitClick:W,onClose:()=>{B(!1)}})]})})}export{is as default};
//# sourceMappingURL=Swap-SLzhb6Y2.js.map

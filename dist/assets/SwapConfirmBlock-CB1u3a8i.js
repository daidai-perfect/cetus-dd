import{A as K}from"./aggregator-DjHPQzBh.js";import{u as bs}from"./useTransaction-BbmVBjAH.js";import{u as Ce}from"./global-jK9B4_lU.js";import{i as js,u as ys}from"./index-CO8Vflca.js";import{u as ms}from"./useAccountBalance-xCFNREy3.js";import{o as ws,aW as _s,v as $e,bJ as We,t as Ss,G as B,E as vs,bK as he,aI as Rs,z as M,a2 as Fe,bL as As,k as zs,Z as Oe,V as De,C as Is,I as ee,d as Ts,a as ge,e as W,h as Hs,X as Ne,bM as Ve,Y as Ps,F as $s,f as Ws,q as Fs}from"./index-ChSVVHaJ.js";import{a,ar as Ls,aa as Es,j as e,H as d,T as h,C as Q,p as A,V as z,f as I,P as Ge,h as Ke,k as qe,m as Ye,n as ke,af as Bs,S as P,W as Ms,X as Us,Y as Cs,Z as Os,$ as Ds,a0 as Ns,q as pe}from"./vendor-BFGDaAdA.js";import{u as be}from"./useToken-DnukIxF2.js";import{u as Le}from"./useTokenBalance-D943AjPe.js";import{u as Vs}from"./useFindBestRouting-BOYs32yR.js";import{b as Je,A as fe,c as Gs}from"./useSwapHelper-BR8zHa8J.js";import{v as Ee,M as Ks,c as qs,u as Xe}from"./usePriceImpact-BcGZX8m-.js";import{C as je}from"./CurrentPrice-cW-gpIzN.js";import{H as Ys}from"./HighlightText-fkyigc44.js";import{g as le}from"./index-BmEYB-eP.js";import{A as Be}from"./SingleTokenInfo-DXxahmBV.js";import{H as Me}from"./HTextLabelBox-B-nKLdqZ.js";import{T as ks}from"./TradeConfirmAmountInfo-BVDhHIq2.js";import{b as Js}from"./TradeInputGroup-DXz0vdlf.js";var Xs=1,Zs=4;function Qs(t){return Js(t,Xs|Zs)}function Ue(t){const[p,s]=a.useState(),r=async l=>{if(l.is_verified===void 0?l.is_trusted:l.is_verified)return!1;try{const i=await js(l.coin_type);return console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:24 ~ checkIsScamsCoin ~ isScamsCoin:",i),i}catch(i){console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:19 ~ checkTokenScams ~ error:",i)}return!1};return a.useEffect(()=>{s(void 0),t&&r(t).then(l=>{s(l)})},[t==null?void 0:t.coin_type]),{isScamsCoin:p}}const er="0xeb863165a109f7791a3182be08aff1438ab2a429314fc135ae19d953afe1edd6";function zr(t,p){const{fromCoin:s,toCoin:r,setFromCoin:l,setToCoin:o,setToAmount:i,fromAmount:f,toAmount:n,setFromAmount:x,routerData:b,setFindRouterLoading:j,setRouterData:u,setByAmountIn:y,byAmountIn:m}=t,{from:S,to:g}=Ls(),{findBestRouters:v,checkProvidersKeys:R}=Vs(),{fetchTokenPrices:T,getTokenAmountValue:H}=ws(),{slippage:$,mevProtect:U,maxCapForGas:O,transactionMode:se,customGasPrice:xe}=Ce(),{aggregatorSDK:re}=_s(),w=Es(),{fetchTokenInfo:te}=be(),[ae,ie]=a.useState(!1),{signAndExecuteTransaction:ss,transactionConfirmation:rs}=bs(),{providersSwitchStates:ye,supportOrderSplit:or}=ys(),{fetchAccountBalance:ts}=ms(),{balanceInfo:is}=Le(s),{balanceInfo:os}=Le(r),ns=H(s==null?void 0:s.coin_type,f),cs=H(r==null?void 0:r.coin_type,n),[me,we]=a.useState(""),_e=a.useRef(""),oe=a.useRef(!0),q=a.useRef(""),Y=a.useRef(""),k=a.useRef(),J=a.useRef(),Se=a.useRef([]);a.useEffect(()=>{k.current=s},[s]),a.useEffect(()=>{J.current=r},[r]),a.useEffect(()=>{_e.current=me},[me]),a.useEffect(()=>{oe.current=m},[m]),a.useEffect(()=>{q.current=f},[f]),a.useEffect(()=>{Y.current=n},[n]);const ps=a.useMemo(()=>String(g)+String(S),[S,g]);a.useEffect(()=>{p||ls()},[ps]);const ls=a.useCallback(()=>{!S&&!g?(l($e.clmm_swap.from_coin),o($e.clmm_swap.to_coin),w("/swap")):(S&&We(S)?te(S).then(c=>{c?(c==null?void 0:c.coin_type)!==(s==null?void 0:s.coin_type)&&l(c):w(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{w(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):l(void 0),g&&We(g)?te(g).then(c=>{c?(c==null?void 0:c.coin_type)!==(r==null?void 0:r.coin_type)&&o(c):w(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{w(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):o(void 0))},[S,g]),ve=Ss(async(c,_,F)=>{if(k.current&&J.current&&+c){const C=p?Object.entries(K).map(([E,V])=>E):Object.entries(ye).filter(([E,V])=>V===!0).map(([E,V])=>E);(+q.current||+Y.current)&&j(!0);const N=await R(C),Ae=vs(c,_?k.current.decimals:J.current.decimals),L=await v({fromToken:k.current,toToken:J.current,amount:Ae.toString(),providersKeys:N,by_amount_in:_,uuid:F});j(!1),_e.current===F&&(Se.current=N,_?+q.current?(i(L.toAmountUi||""),u(L)):i(""):+Y.current?(x(L.fromAmountUi||"ÃŸ"),u(L)):x(""))}else X(!_)},500),xs=(c,_,F=!1)=>{if(y(_),_?(x(c),F&&i("")):(i(c),F&&x("")),+c){const C=Ee();we(C),ve(c,_,C)}else j(!1),u(void 0),c!=="0"?X():_?i(""):x("")},D=()=>{const c=oe.current?q.current:Y.current;if(console.log("ðŸš€ ~ file: useSwap.ts:273 ~ reCalculateRouteData ~ amount:",c,oe.current,q.current,Y.current),+c){const _=Ee();we(_),ve(c,oe.current,_)}};a.useEffect(()=>{D()},[JSON.stringify(ye)]);const as=a.useCallback((c,_=!0)=>{X(),p?_?(c&&B((c==null?void 0:c.coin_type)||"")===B((r==null?void 0:r.coin_type)||"")&&o(s),l(c)):(c&&B((c==null?void 0:c.coin_type)||"")===B((s==null?void 0:s.coin_type)||"")&&l(r),o(c)):_?c&&B((c==null?void 0:c.coin_type)||"")===B((r==null?void 0:r.coin_type)||"")?w(`/swap/${c==null?void 0:c.coin_type}/${s==null?void 0:s.coin_type}`):w(`/swap/${c==null?void 0:c.coin_type}/${r==null?void 0:r.coin_type}`):c&&B((c==null?void 0:c.coin_type)||"")===B((s==null?void 0:s.coin_type)||"")?w(`/swap/${r==null?void 0:r.coin_type}/${c==null?void 0:c.coin_type}`):w(`/swap/${s==null?void 0:s.coin_type}/${c==null?void 0:c.coin_type}`)},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),{amountLimit:us}=Je($,b),X=c=>{c===void 0?(x(""),i("")):c?x(""):i(""),j(!1),u(void 0)};a.useEffect(()=>{Re()},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const Re=()=>{const c=[];s&&c.push(s.coin_type),r&&c.push(r.coin_type),c.length>0&&T(c)},ds=()=>({...b}),hs=async c=>{var F,C;let _;try{const{routerData:N,byAmountIn:Ae,fromAmountUi:L,toAmountUi:E}=c,V=new Rs,G={routers:N,partner:er,txb:V,slippage:Number($),refreshAllCoins:!0};ie(!1),console.log("ðŸš€ ~ file: useSwap.ts:261 ~ doSwapAction ~ params:",G),_={isSwapWidget:p,actionType:"swap",getShowInfo:(Ie,ue)=>{const de=`Swapping ${M(L)} ${s==null?void 0:s.symbol} for ${M(E)} ${r==null?void 0:r.symbol}`,Z={modalDescriptionText:de,toastTitleText:de};if(Ie==="success"){let Te=L,He=E;ue&&(Te=Fe(ue,s)||L,He=Fe(ue,r)||E);const Pe=`Swapped ${M(Te)} ${s==null?void 0:s.symbol} for ${M(He)} ${r==null?void 0:r.symbol}`;Z.toastDescriptionContent=Pe,Z.modalDescriptionText=Pe,Z.toastTitleText="Swap Successful"}return Ie==="rejected"&&(Z.toastTitleText=de.replace("Swapping","Swap")),Z}},p||rs(_);const ze=await ss(async()=>(await re.fastRouterSwap(G),V),_,{useMev:U,useFastMode:se==="Fast Mode",maxCapForGas:O,customGasPrice:xe,msafeParams:{action:"AggregatorSwap",txbParams:{...G,routers:As(G==null?void 0:G.routers)}},otherParams:{routerData:t.routerData,providerKey:Se.current,from:(F=k.current)==null?void 0:F.coin_type,to:(C=J.current)==null?void 0:C.coin_type}});return console.log("ðŸš€ ~ file: useSwap.ts:272 ~ doSwapAction ~ res:",ze),ze?(X(),ts(),!0):(D(),!1)}catch(N){console.log("ðŸš€ ~ doSwapAction ~ error text:",N)}},{isScamsCoin:ne}=Ue(s),{isScamsCoin:ce}=Ue(r),fs=a.useMemo(()=>{if(!(!ne&&!ce)){if(ne&&ce&&(s!=null&&s.symbol)&&(r!=null&&r.symbol))return`${s==null?void 0:s.symbol} and ${r==null?void 0:r.symbol} are`;if(ne&&(s!=null&&s.symbol))return`${s==null?void 0:s.symbol} token is `;if(ce&&(r!=null&&r.symbol))return`${r==null?void 0:r.symbol} token is `}},[ne,ce,s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),gs=async c=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useSwap.ts:491 ~ onReverseClick ~ isOpenAggregatorMode:",c),c?(p?(l(r),o(s)):(l(r),o(s),w(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`)),x(n),i(""),y(!0),await he(200),D()):m?(p?(l(r),o(s)):w(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`),x(""),i(f),y(!1),await he(200),D()):(p?(l(r),o(s)):w(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`),x(n),i(""),y(!0),await he(200),D())};return a.useEffect(()=>()=>{p||(l(void 0),o(void 0)),x(""),i("")},[]),{handleSelectToken:as,handleAmountChange:xs,fromAmount:f,toAmount:n,fromAmountValue:ns,toAmountValue:cs,amountLimit:us,getSwapSecondaryData:ds,reCalculateRouteData:D,fromBalanceInfo:is,toBalanceInfo:os,doSwapAction:hs,scamsText:fs,refreshMarketPrice:Re,isOpenConfirmModel:ae,setIsOpenConfirmModel:ie,resetInputAmount:X,onReverseClick:gs}}function Ir(t,p,s,r,l,o){const{currentAccount:i}=zs(),f=a.useMemo(()=>{const n={text:"Swap",disabled:!1};if(!(i!=null&&i.address))return n.text="Connect Wallet",n.disabled=!1,n;if(!r||!l)return n.text="Select a token",n.disabled=!0,n;if(!+t&&!+p)return n.text="Enter an amount",n.disabled=!0,n;if(o&&o.errorCode){if(o.errorCode===fe.InsufficientLiquidity)return n.text="Insufficient liquidity for this trade",n.disabled=!0,n;if(o.errorCode===fe.NoRouter||o.errorCode===fe.HoneyPot)return n.text="No Available Route",n.disabled=!0,n}return+t&&Oe(t).gt(s||0)?(n.disabled=!0,n.text=`Insufficient ${De(r==null?void 0:r.symbol,10)} Balance`,n):((!+t||!+p)&&(n.disabled=!0),n)},[i==null?void 0:i.address,t,p,s,o==null?void 0:o.errorCode,r,l]);return{btnText:f.text,btnDisabled:f.disabled}}function Ze(t){const{fromToken:p,toToken:s,marketPrice:r,priceImpact:l,sources:o=[],isWidget:i=!1,isLoading:f}=t;return e.jsxs(d,{justify:"space-between",w:"100%",gap:"4px",flexWrap:"wrap",children:[e.jsxs(d,{w:"132px",alignItems:"end",gap:"4px",children:[e.jsx(h,{whiteSpace:"nowrap",fontSize:i?"12px":"14px",h:"20px",lineHeight:"20px",fontWeight:"500",children:"Price Difference"}),e.jsx(Is,{tooltip:e.jsx(sr,{marketPrice:r,sources:o,fromToken:p,toToken:s}),children:e.jsx(Q,{children:e.jsx(ee,{xlinkHref:"#icon-icon_tips",svgW:"20px",svgH:"20px"})})})]}),e.jsx(A,{isLoaded:!f,h:"20px",children:e.jsxs(d,{justify:"flex-end",children:[e.jsx(h,{maxW:i?`calc(90vw - 56px - ${24*((o==null?void 0:o.length)||0)}px)`:"unset",flex:"1",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:l==null?void 0:l.textColor,fontWeight:"500",fontSize:i?"12px":"14px",children:l!=null&&l.priceImpactText?l==null?void 0:l.priceImpactText:"Incalculable"}),o==null?void 0:o.map(n=>e.jsx(Ks,{market:n},n))]})})]})}function sr(t){const{marketPrice:p,sources:s,fromToken:r,toToken:l}=t;return e.jsxs(z,{className:"no-close-widget-flag",w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(h,{color:"content_text",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The difference between the market price and estimated price due to trade size."}),e.jsxs(z,{w:"100%",align:"flex-start",children:[e.jsx(h,{fontSize:"12px",color:"text_caption",children:"Market price sources:"}),p?e.jsx(je,{fontSize:"12px",fromToken:r,toToken:l,fromValue:"1",toValue:p,color:"text_caption"}):e.jsx(h,{color:"primary_yellow",fontSize:"12px",children:"Price is unknown"})]}),p&&e.jsxs(d,{w:"100%",children:[e.jsx(h,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:"Market price sources:"}),e.jsx(h,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:s.map(o=>qs[o]+"  ")})]})]})}function Tr(t){const{fromCoin:p,toCoin:s,findRouterLoading:r,isWidget:l=!1,routerData:o,bg:i="primary_opacity.10"}=t,{marketPrice:f,priceImpact:n,sources:x,priceImpactTextInfo:b,hideShowPriceImpact:j}=Xe(p,s,o==null?void 0:o.fromAmountUi,o==null?void 0:o.toAmountUi);return e.jsxs(z,{w:"100%",p:"8px",gap:"8px",bg:i,borderRadius:"12px",align:"flex-start",children:[e.jsx(je,{fromToken:p,toToken:s,fromValue:o==null?void 0:o.fromAmountUi,toValue:o==null?void 0:o.toAmountUi,isLoading:r,color:"text_caption",fontSize:l?"12px":"14px"}),!j&&Ts(n).lte(-30)&&e.jsxs(d,{w:"100%",justify:"flex-start",children:[e.jsx(ee,{xlinkHref:"#icon-warning",svgFill:"primary_red",svgHover:"primary_red",fontSize:"16px"}),e.jsx(h,{color:"primary_red",fontSize:"12px",lineHeight:"20px",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})]}),!j&&e.jsx(Ze,{fromToken:p,isWidget:l,toToken:s,marketPrice:f,priceImpact:b,isLoading:r,sources:x})]})}function Hr({scamsText:t}){return e.jsxs(z,{borderRadius:"8px",border:"1px solid",borderColor:"border",pt:"12px",maxW:"480px",children:[e.jsxs(d,{children:[e.jsx(ee,{xlinkHref:"#icon-icon_priceupdated",svgFill:"primary_yellow",svgHover:"primary_yellow",svgW:"20px",svgH:"20px"}),e.jsx(h,{color:"primary_yellow",children:"Alert"})]}),e.jsx(I,{bg:"card_bg",borderRadius:"8px",p:"11px",children:e.jsx(Ys,{text:`${t}  detected to have Deny List feature. It's an optional feature on Sui designed for regulated coins (learn more). However, it could be misused by HoneyPot scams, which may restrict users from selling the tokens after buying. Please be cautious.`,keywords:["learn more"],onKeywordClick:()=>{window.open("https://docs.sui.io/guides/developer/coin/regulated","_blank")}})})]})}const Qe=({data:t,children:p,loading:s,isSwapWidget:r})=>{var x,b,j;const{getTokenListInfo:l}=be(),{isApp:o}=ge(),[i,f]=a.useState(new Map),n=async()=>{var u,y,m;if(t&&(t!=null&&t.routers)&&((u=t==null?void 0:t.routers)==null?void 0:u.length)>0){const S=[];(m=(y=t==null?void 0:t.routers[0])==null?void 0:y.paths)==null||m.forEach(v=>{S.push(v==null?void 0:v.from_type),S.push(v==null?void 0:v.to_type)});const g=await l(S);g&&f(g)}};return a.useEffect(()=>{n()},[t==null?void 0:t.routers]),(t==null?void 0:t.providers)&&e.jsx(A,{isLoaded:!s,minW:"128px",minH:"20px",lineHeight:"20px",children:e.jsxs(d,{w:"100%",gap:"4px",align:"center",justify:"flex-end",wrap:"wrap",children:[(t==null?void 0:t.router_summery)!=="1 Streams"?e.jsx(h,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",overflowWrap:"break-word",children:t==null?void 0:t.router_summery}):e.jsx(e.Fragment,{children:e.jsx(h,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",textAlign:"right",overflowWrap:"break-word",children:(b=(x=t==null?void 0:t.routers[0])==null?void 0:x.paths)==null?void 0:b.map((u,y)=>{var m,S,g;return y===0?`${(m=i==null?void 0:i.get(u==null?void 0:u.from_type))==null?void 0:m.symbol} > ${(S=i==null?void 0:i.get(u==null?void 0:u.to_type))==null?void 0:S.symbol}`:(g=i==null?void 0:i.get(u==null?void 0:u.to_type))==null?void 0:g.symbol}).join(" > ")})}),(j=t==null?void 0:t.providers)==null?void 0:j.map(u=>o&&p?e.jsx(W,{w:"16px",h:"16px",imageUrl:K[u].logo}):e.jsxs(Ge,{isLazy:!0,trigger:o?"click":"hover",children:[e.jsx(Ke,{children:e.jsx(I,{children:e.jsx(W,{w:"16px",h:"16px",imageUrl:K[u].logo})})}),e.jsx(qe,{children:e.jsx(Ye,{w:"unset",children:e.jsx(ke,{fontSize:"12px",children:K[u].name})})})]},u)),p]})})};function es({children:t,fromToken:p,toToken:s,poolAddress:r}){const{isApp:l}=ge(),{getExplorerUrl:o}=Hs();return e.jsxs(Ge,{isLazy:!0,trigger:l?"click":"hover",children:[e.jsx(Ke,{children:t}),e.jsx(qe,{children:e.jsx(Ye,{w:"unset",minW:"unset",children:e.jsx(ke,{p:"12px",children:e.jsxs(z,{w:"100%",gap:"12px",className:"no-close-widget-flag",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{w:"100%",justify:"space-between",h:"20px",p:"0",children:[e.jsx(d,{children:e.jsx(h,{fontSize:"12px",color:"text_caption",children:"Pool"})}),e.jsx(Be,{address:r,color:"text_caption",showLink:!!l,onClickLink:()=>{window.open(o(r,"poolAddress"),"_blank")}})]}),e.jsx(Bs,{orientation:"horizontal",borderColor:"border"})]}),[p,s].map(i=>e.jsxs(d,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsxs(d,{children:[e.jsx(W,{imageUrl:i==null?void 0:i.logo_url,w:"24px",h:"24px",coinType:i?i==null?void 0:i.coin_type:"",showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(z,{align:"flex-start",gap:"0px",children:e.jsx(h,{fontSize:"12px",color:"text_caption",fontWeight:"500",children:De((i==null?void 0:i.symbol)||"",10)})})]}),e.jsx(Be,{color:"primary_gray",showLink:!!l,address:i==null?void 0:i.coin_type,onClickLink:()=>window.open(o(i==null?void 0:i.coin_type,"coin"))})]},i==null?void 0:i.coin_type))]})})})})]})}const rr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>e.jsxs(z,{w:"100%",align:"center",p:"20px 0 8px",children:[e.jsx(d,{children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(h,{color:"text_caption",children:M(s||"0")}),e.jsx(h,{children:t==null?void 0:t.symbol})]})}),e.jsx(I,{w:"100%",bg:"bg_secondary",p:"20px 8px",borderRadius:"8px",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"},_after:{content:'""',position:"absolute",bottom:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"}},children:e.jsx(z,{gap:o?"56px":"16px",border:"1px dashed",borderColor:"border",borderRadius:"8px",p:o?"36px 0":"16px 0",children:l==null?void 0:l.map((i,f)=>e.jsxs(d,{w:"100%",gap:"0",justify:"space-between",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}},children:[!o&&e.jsx(Q,{borderRadius:"12px",h:"24px",bg:"h5_router_percentage_bg",p:"6px 12px",ml:"20px",zIndex:2,children:e.jsx(h,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:le(i.percentage)})}),e.jsx(z,{w:"100%",align:"center",sx:i.paths.length>1&&!o?{position:"relative",_before:{content:'""',backgroundColor:"bg_secondary",position:"absolute",top:"20px",right:"16px",width:"calc(100% - 32px)",height:"calc(100% - 40px)",border:"1px dashed",borderColor:"border",borderRadius:"8px",zIndex:2}}:{},children:o?e.jsx(e.Fragment,{children:e.jsxs(d,{gap:"8px",position:"absolute",h:"40px",top:"-20px",borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:2,children:[e.jsxs(d,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):i.paths.map(n=>{var x,b,j,u,y;return e.jsx(es,{fromToken:n==null?void 0:n.fromToken,toToken:n==null?void 0:n.toToken,poolAddress:n==null?void 0:n.pool_address,children:e.jsxs(d,{borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:3,children:[e.jsx(Ne,{coinAIconUrl:(x=n.fromToken)==null?void 0:x.logo_url,coinBIconUrl:(b=n.toToken)==null?void 0:b.logo_url,w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(j=n.fromToken)==null?void 0:j.coin_type,coinBCoinType:(u=n.toToken)==null?void 0:u.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(h,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(y=K[n.provider])==null?void 0:y.name}),!!+n.fee_rate&&e.jsx(Q,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(h,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:le(Ve(n.fee_rate))})})]},n.to_type)},n.to_type)})})]},f))})}),e.jsx(d,{children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(h,{color:"text_caption",children:M(r||"0")}),e.jsx(h,{children:p==null?void 0:p.symbol})]})})]}),tr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>{var i;return e.jsxs(z,{w:"100%",gap:"12px",children:[e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(d,{borderRadius:"14px",h:"28px",p:"0 12px 0 0 ",children:o?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(h,{color:"text_caption",children:M(s||"0")}),e.jsx(h,{children:t==null?void 0:t.symbol})]})}),e.jsx(d,{borderRadius:"14px",h:"28px",p:"0 0 0 12px",children:o?e.jsxs(e.Fragment,{children:[e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]}),e.jsx(P,{w:"28px",h:"28px"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{color:"text_caption",children:M(r||"0")}),e.jsx(h,{children:p==null?void 0:p.symbol}),e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"})]})})]}),e.jsxs(I,{w:"100%",bg:"bg_secondary",p:"32px 24px",borderRadius:"12px",position:"relative",children:[e.jsx(I,{position:"absolute",left:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"0px 100px 100px 0px",zIndex:2,children:o?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"24px",h:"24px",coinType:t==null?void 0:t.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(I,{position:"absolute",right:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"100px 0px 0px 100px",zIndex:2,children:o?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"24px",h:"24px",coinType:p==null?void 0:p.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(z,{gap:"32px",border:"1px dashed",borderBottom:((i=l||[])==null?void 0:i.length)>1?"1px dashed":"none",borderColor:"border",borderRadius:"8px",children:l==null?void 0:l.map((f,n)=>e.jsxs(d,{mt:n===0?"-20px":0,mb:n===l.length-1?"-20px":0,w:"100%",justify:"space-between",gap:"0",sx:n>0&&n<l.length-1?{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}}:{position:"relative"},children:[!o&&e.jsx(Q,{borderRadius:"12px",h:"24px",bg:"card_bg",p:"8px 12px",ml:"40px",zIndex:2,position:"absolute",children:e.jsx(h,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:le(f.percentage)})}),e.jsx(d,{h:"40px",w:"100%",justify:"center",zIndex:2,children:o?e.jsx(e.Fragment,{children:e.jsxs(d,{gap:"8px",position:"absolute",h:"40px",borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsxs(d,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):f.paths.map(x=>{var b,j,u,y,m;return e.jsx(es,{fromToken:x==null?void 0:x.fromToken,toToken:x==null?void 0:x.toToken,poolAddress:x==null?void 0:x.pool_address,children:e.jsxs(d,{borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsx(Ne,{coinAIconUrl:(b=x.fromToken)==null?void 0:b.logo_url,coinBIconUrl:(j=x.toToken)==null?void 0:j.logo_url,variant:"",p:"0px",w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(u=x.fromToken)==null?void 0:u.coin_type,coinBCoinType:(y=x.toToken)==null?void 0:y.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(h,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(m=K[x.provider])==null?void 0:m.name}),!!+x.fee_rate&&e.jsx(Q,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(h,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:le(Ve(x.fee_rate))})})]})},x.to_type)})})]},n))})]})]})},ir=({isOpen:t,onClose:p,data:s,fromCoin:r,toCoin:l,fromAmount:o,toAmount:i})=>{const{isApp:f}=ge(),{getTokenListInfo:n}=be(),[x,b]=a.useState(new Map),j=async v=>{const R=await n(v);R&&(R==null?void 0:R.size)>0&&b(R)};Ps(()=>{var v,R;if(s!=null&&s.routers&&((v=s==null?void 0:s.routers)==null?void 0:v.length)>0){const T=[];(R=s==null?void 0:s.routers)==null||R.forEach(H=>{H.paths.forEach($=>{T.includes($.from_type)||T.push($.from_type),T.includes($.to_type)||T.push($.to_type)})}),j(T)}},[s==null?void 0:s.routers]);const u=a.useMemo(()=>{var v,R;return!(s!=null&&s.routers)||((v=s==null?void 0:s.routers)==null?void 0:v.length)===0||(x==null?void 0:x.size)===0?[]:(R=s==null?void 0:s.routers)==null?void 0:R.map(T=>({...T,paths:T.paths.map(H=>({...H,fromToken:x==null?void 0:x.get(H.from_type),toToken:x==null?void 0:x.get(H.to_type)}))}))},[s==null?void 0:s.routers,x]),y={fromToken:r,toToken:l,fromAmount:o,toAmount:i,routes:u},[m,S]=a.useState(!0),g=a.useRef(null);return a.useEffect(()=>(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{S(!1)},200),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),e.jsxs(Ms,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:p,isCentered:!0,children:[e.jsx(Us,{}),e.jsxs(Cs,{maxW:"1200px",w:f?"calc(100vw - 32px)":"880px",children:[e.jsx(Os,{mr:"-10px",children:e.jsxs(d,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(h,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Route"}),e.jsxs(d,{gap:"0",align:"center",children:[e.jsx(Qe,{data:s}),e.jsx(Ds,{mt:"0",position:"static"})]})]})}),e.jsx(Ns,{p:{base:"8px 16px",lg:"16px"},children:f?e.jsx(rr,{...y,loading:m}):e.jsx(tr,{...y,loading:m})})]})]})};function Pr(t){const{formatSwapRouter:p,findRouterLoading:s,fromAmount:r,toAmount:l,fromCoin:o,toCoin:i,isSwapWidget:f=!1,handleSwapWidgetRouterClick:n}=t,[x,b]=a.useState(!1);return console.log(p,"formatSwapRouter"),e.jsxs(e.Fragment,{children:[e.jsxs(d,{w:"100%",justify:"space-between",p:"0 8px",children:[e.jsx(h,{fontSize:f?"12px":"14px",fontWeight:"500",whiteSpace:"nowrap",children:"Auto Router"}),e.jsx(I,{onClick:j=>{$s(j),f?n&&n():b(!x)},cursor:"pointer",children:e.jsx(Qe,{data:p,loading:s,isSwapWidget:f,children:e.jsx(ee,{xlinkHref:"#icon-icon_spread",fontSize:"16px"})})})]}),x&&!f&&e.jsx(ir,{isOpen:x,onClose:()=>b(!1),fromCoin:o,toCoin:i,data:p,fromAmount:r,toAmount:l})]})}function $r(t){const{lastRouterData:p,fromCoin:s,toCoin:r,onClose:l,data:o,onSubmitClick:i,isWidget:f}=t,{slippage:n}=Ce(),x=a.useRef(!1),[b,j]=a.useState(o),{fromAmountUi:u,toAmountUi:y,byAmountIn:m}=b,{amountLimit:S}=Je(n,b),[g,v]=a.useState(!1),{priceImpactTextInfo:R,marketPrice:T,sources:H,showPriceImpactTips:$,showPriceImpactWarn:U}=Xe(s,r,u,y),{priceAcceptRouterData:O}=Gs(b,p),[se,xe]=a.useState(!1),re=a.useMemo(()=>O!==void 0,[O]),w=a.useMemo(()=>m?r:s,[m]),te=()=>{if(O){if(x.current)return;x.current=!0;const ie=Qs(O);j(ie),setTimeout(()=>{x.current=!1},300)}},ae=a.useMemo(()=>g?!1:!!U,[g,U]);return e.jsxs(z,{textAlign:"center",p:"0px",w:"100%",children:[e.jsxs(z,{w:"100%",gap:"16px",pl:"16px",pr:"16px",pb:"16px",children:[e.jsx(ks,{bg:f?"swap_bg_primary":"bg_primary",coinA:{amount:u||"0",...s},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:y||"0",...r}}),e.jsx(d,{w:"100%",minH:"48px",bg:f?"swap_bg_primary":"bg_primary",borderRadius:"8px",border:"1px solid",borderColor:"border",justifyContent:"center",zIndex:"100",children:e.jsx(je,{fromToken:s,toToken:r,fromValue:u,toValue:y,color:"text_caption"})}),$&&e.jsx(d,{zIndex:"99",w:"100%",mt:"-26px",bg:U?"primary_red_opacity.10":"primary_yellow_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"center",p:"18px 16px 10px",children:e.jsx(h,{color:U?"primary_red":"primary_yellow",fontSize:"12px",lineHeight:"20px",textAlign:"start",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})}),e.jsx(Me,{wrapStyle:{h:"20px",lineHeight:"20px"},label:"Slippage Tolerance",labelStyle:{fontSize:"14px"},value:`${Oe(n).mul(100)}%`,valueStyle:{fontSize:"14px"}}),e.jsx(Me,{wrapStyle:{h:"20px",lineHeight:"20px"},label:m?"Minimum Received":"Maximum Input",labelStyle:{fontSize:"14px"},value:`${Ws(S||0,w==null?void 0:w.decimals,!1,Fs.ROUND_DOWN).toString()} ${w==null?void 0:w.symbol}`,valueStyle:{fontSize:"14px"}}),e.jsx(Ze,{fromToken:s,toToken:r,sources:H,marketPrice:T,priceImpact:R}),U&&e.jsxs(z,{w:"100%",gap:"8px",children:[e.jsx(d,{w:"100%",bg:"primary_red_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"start",p:"10px 16px",children:e.jsx(h,{color:"primary_red",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?"})}),e.jsxs(d,{w:"100%",justifyContent:"space-between",gap:"16px",children:[e.jsx(pe,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:g?"text_highlight":"button_outline_border",onClick:()=>{v(!0)},children:"Yes, please continue."}),e.jsx(pe,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:"button_outline_border",onClick:l,children:"No,cancel it."})]})]}),re&&e.jsxs(d,{w:"100%",justifyContent:"space-between",children:[e.jsxs(d,{children:[e.jsx(ee,{xlinkHref:"#icon-icon_priceupdated1",svgW:"20px",svgH:"20px"}),e.jsx(h,{color:"text_caption",fontWeight:"500",fontSize:"14px",children:"Price updated"})]}),e.jsx(pe,{onClick:te,h:"40px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",p:"0 42px",children:"Accept"})]})]}),!re&&e.jsx(pe,{disabled:ae,isLoading:se,mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{se||(xe(!0),i(b))},children:"Confirm Swap"})]})}export{rr as H,Qe as O,Tr as P,Hr as S,Ir as a,Pr as b,$r as c,zr as u};
//# sourceMappingURL=SwapConfirmBlock-CB1u3a8i.js.map

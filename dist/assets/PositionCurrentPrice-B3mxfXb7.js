import{m as A,J as w,d as g,M as U,e as j,O as b,I as H,z as R}from"./index-DZworFuu.js";import{a as v,j as y,H as T,u as D,T as P}from"./vendor-_1sPVx0S.js";import{u as B}from"./useBurn-Cakh7uP7.js";import{M as E}from"./msafe-oYBkW7LJ.js";import{a as I}from"./usePositionList-DCRYUjtM.js";function K(){const{getTokenAmountValue:_}=A(),f=(u,a,r)=>{if(!(u!=null&&u.length))return{total:"0",rewardAndFeeList:[]};let e="0";const o=[];u.forEach(n=>{const m=a[n==null?void 0:n.posId],x=r[n==null?void 0:n.posId]||[];if(m){const c=d(n==null?void 0:n.displayTokenA,m==null?void 0:m.displayFeeOwedA),s=d(n==null?void 0:n.displayTokenB,m==null?void 0:m.displayFeeOwedB);c&&o.push(c),s&&o.push(s),e=p(e,c==null?void 0:c.amountUSD,s==null?void 0:s.amountUSD)}x.forEach(c=>{if(Number(c==null?void 0:c.display_amount_owed)>0){const s=d(c==null?void 0:c.token,c==null?void 0:c.display_amount_owed,c==null?void 0:c.coin_address);s&&(o.push(s),e=p(e,s==null?void 0:s.amountUSD))}})});const l=h(o);return console.log("ðŸš€ ~ calculatePendingYield ~  total,:",l,e,l.length==1&&(e=="--"||Number(e)==0)),{total:(l==null?void 0:l.length)>0&&Number(e)==0?"--":e,rewardAndFeeList:l}},d=(u,a,r)=>{if(!u||!a)return null;const e=r||u.coin_type,o=_(e,a);return{coin_address:w(e,!1),amount:a,amountUSD:g(a).gt(0)&&g(o).lte(0)?"--":o,token:u}},p=(u,...a)=>{console.log("ðŸš€ ~ useCalculatePendingYield ~ amounts:",a);let r=g(u);return a.forEach(e=>{e&&e!=="--"&&r!=="--"&&(r=r.plus(e))}),r.toString()},h=u=>{const a={};return u.forEach(r=>{var n,m;const{coin_address:e,amount:o,amountUSD:l}=r;a[e]||(a[e]={...r,amount:"0",amountUSD:"0"}),l=="--"?a[e].amountUSD="--":a[e].amountUSD=a[e].amountUSD=="--"?"--":g((n=a[e])==null?void 0:n.amountUSD).plus(l||0).toString(),a[e].amount=g((m=a[e])==null?void 0:m.amount).plus(o||0).toString()}),Object.values(a).filter(r=>Number(r.amount)>0).sort((r,e)=>g(e.amountUSD=="--"?0:e.amountUSD).minus(r.amountUSD=="--"?0:r.amountUSD).toNumber())};return{calculatePendingYield:f}}const C=_=>_.startsWith("0x")?_.slice(2):_;function z(){const{clmmSdk:_}=U(),{peripherySdk:f,burnSdk:d}=j(),{getBurnClaimTxPayload:p}=B();return{getPosClaimFeeAndRewardTxPayload:async a=>{const{posType:r,id:e,clmmPool:o,coinTypeA:l,coinTypeB:n,rewarderCoinTypes:m,account:x}=a;let c,s;if(r==="clmm"){const t={pool_id:o,pos_id:e,rewarder_coin_types:m,coinTypeA:l,coinTypeB:n,collect_fee:!0};c=await _.Rewarder.collectRewarderTransactionPayload(t),s={action:E.ClaimFeeAndMining,txbParams:t}}else if(r==="farms"){const t={coinTypeA:l,coinTypeB:n,clmm_pool_id:o,position_nft_id:e,clmm_rewarder_types:m,collect_fee:!0};c=await f.Farms.claimFeeAndClmmReward(t),s={action:"FarmingClaimFeeAndReward",txbParams:t}}else r==="burn"&&(c=p({poolAddress:o,posId:e,coinTypeA:l,coinTypeB:n,account:x,rewarderCoinTypes:m}));return{tx:c,msafeParams:s}},getBatchHarvestFeeAndRewardsTxPayload:async(a,r,e)=>{console.log("ðŸš€ ~ getBatchHarvestFeeAndRewardsTxPayload ~ posBaseList:",a,r,e);const o=[],l=[],n=[];a.forEach(t=>{var S;const i=((S=r[t.posId])==null?void 0:S.map(F=>F.coin_address))||[];console.log("ðŸš€ ~ getBatchHarvestFeeAndRewardsTxPayload ~ rewarderCoinTypes:",i),t.posType=="clmm"?o.push({pool_id:t.clmmPool,pos_id:t.id,collect_fee:!0,rewarder_coin_types:i,coinTypeA:C(t.coinTypeA),coinTypeB:C(t.coinTypeB)}):t.posType=="farms"?l.push({pool_id:t.farmsPool,position_nft_id:t.id,clmm_pool_id:t.clmmPool,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:i,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB}):n.push({pos:t==null?void 0:t.id,pool:t.clmmPool,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,rewarderCoinTypes:i,account:e})});const m=await f.Farms.batchHarvestAndClmmFeePayload(l,o),x=[];for(let t=0;t<n.length;t++){const i=n[t];(i==null?void 0:i.rewarderCoinTypes.length)>0&&x.push(i)}const c=d.Burn.createCollectFeesPaylaod(n,m),s=d.Burn.crateCollectRewardsPayload(x,c);return{txb:c,tx:s}}}}function J({posId:_,displayTokenA:f,displayTokenB:d,symbolEllipsesDecimals:p=10}){const[h,u]=v.useState(!0),{posPoolsRelatedData:a}=I(),r=a[_];return y.jsxs(T,{children:[y.jsx(D,{isLoaded:!!(r!=null&&r.currentPrice),children:y.jsx(P,{color:"text_caption",children:h?r==null?void 0:r.currentPrice:r==null?void 0:r.currentPriceReverse})}),y.jsxs(T,{gap:"0",children:[y.jsx(P,{color:"primary_gray",children:b(h?d==null?void 0:d.symbol:f==null?void 0:f.symbol,p)}),y.jsx(P,{color:"primary_gray",children:"Â perÂ "}),y.jsx(P,{color:"primary_gray",children:b(h?f==null?void 0:f.symbol:d==null?void 0:d.symbol,p)})]}),y.jsx(H,{xlinkHref:"#icon-icon_swap1",w:"16px",h:"16px",onClick:e=>{R(e),u(!h)}})]})}export{J as P,K as a,z as u};
//# sourceMappingURL=PositionCurrentPrice-B3mxfXb7.js.map

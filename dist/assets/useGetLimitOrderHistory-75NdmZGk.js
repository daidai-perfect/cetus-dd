import{j as e,H as d,T as p,V as O,ap as Le,a as b,f as le,W as ce,X as oe,Y as xe,Z as de,$ as pe,a0 as ue,a7 as me,q as B,p as $,x as ve,C as se}from"./vendor-BFGDaAdA.js";import{Y as Oe,f as L,aE as ge,w as I,a as Y,ak as ae,h as X,B as A,I as H,F as E,r as P,R as Se,k as he,l as ee,aH as q,aU as D,aG as je,$ as T,d as U,j as ke,N as He,e as Te,C as ie,u as De,aV as We}from"./index-R0MuIW_z.js";import{I as ne}from"./IconText-CXKmhDaq.js";import{D as _e}from"./Drawer-EtlaKnAi.js";import{u as Q}from"./useTransaction-Dzcjo88k.js";import{u as we}from"./useAccountBalance-BLVXJ9S1.js";import{u as be}from"./useToken-Cy6l2Y45.js";import{N as Be}from"./NoData-DtiZhmrM.js";import{S as Ee}from"./SingleTokenInfo-CaAfAkey.js";import{u as Fe}from"./RangeValue-D-e6K8Ax.js";const Ae=({info:t,imgSize:a="32px",isProfile:s=!1})=>{const{pay_coin:l,target_coin:c,total_pay_amount:u,expect_obtain_amount:x}=t;return e.jsxs(d,{children:[e.jsx(Oe,{w:a,h:a,coinAIconUrl:l==null?void 0:l.logo_url,coinBIconUrl:c==null?void 0:c.logo_url}),e.jsxs(d,{flexWrap:"wrap",children:[e.jsxs(d,{children:[!s&&e.jsx(p,{color:"text_caption",children:L(u)}),e.jsxs(p,{color:"text_caption",children:[l==null?void 0:l.symbol," â†’ "]})]}),e.jsxs(d,{children:[!s&&e.jsx(p,{color:"text_caption",children:L(x)}),e.jsx(p,{color:"text_caption",children:c==null?void 0:c.symbol})]})]})]})},Me=({info:t,isProfile:a=!1})=>e.jsx(d,{justifyContent:"end",gap:"2px",children:a?e.jsx(p,{color:"text_caption",children:ge(t==null?void 0:t.expire_ts)}):e.jsxs(p,{color:"text_caption",children:[I(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),Re=({info:t,isProfile:a=!1})=>{const{pay_coin:s,total_pay_amount:l,deal_amount:c,deal_rate:u}=t,{isApp:x}=Y();return e.jsxs(O,{align:"flex-end",gap:a?"4px":"8px",children:[e.jsxs(d,{justifyContent:"end",gap:"2px",children:[e.jsx(p,{color:"text_caption",children:L(c)}),e.jsxs(d,{justifyContent:"end",gap:"2px",children:[e.jsxs(p,{color:"text_caption",children:["/",L(l)," ",s==null?void 0:s.symbol]}),!a&&e.jsxs(p,{color:"primary_gray",children:["(",ae(Number(u)*100),")"]})]})]}),a&&!x&&e.jsxs(d,{w:"100%",justify:"flex-end",gap:"2px",children:[e.jsx(p,{color:"primary_gray",fontSize:"12px",children:ae(Number(u)*100)}),e.jsx(Le,{h:"4px",w:"40px",value:Number(u)*100,bg:"primary_opacity.10",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})},at=({historyInfo:t,type:a,...s})=>{const{getExplorerUrl:l}=X(),c=b.useMemo(()=>(t==null?void 0:t.events)||[],[t]),{isApp:u}=Y();return e.jsx(A,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...s,children:e.jsx(O,{align:"flex-start",children:c.map(x=>{const{tokenInfo:j,text:g,icon:h,color:n,num:m}=ye(x,t);return e.jsxs(O,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(d,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(d,{gap:a=="card"?"4px":"8px",flexDirection:a=="card"?"column":"row",align:a=="card"?"flex-start":"center",children:[e.jsxs(d,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(H,{svgW:"14px",xlinkHref:h,svgFill:n,svgHover:n}),e.jsx(p,{color:n,children:g})]}),!u&&e.jsxs(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",j==null?void 0:j.symbol]})]}),e.jsxs(d,{gap:a=="card"?"4px":"20px",flexDirection:a=="card"&&!u?"column":"row",align:a=="card"?"flex-end":"center",children:[e.jsxs(p,{h:"20px",lineHeight:"20px",children:[I(Number(x.block_time),"")," (UTC)"]}),e.jsxs(d,{gap:"4px",cursor:"pointer",onClick:i=>{E(i),window.open(l(x.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!u&&e.jsx(p,{color:"text_caption",children:"View Transaction"}),e.jsx(H,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),u&&e.jsxs(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",j==null?void 0:j.symbol]})]},x==null?void 0:x.tx)})})})},ye=(t,a)=>{const{pay_coin:s,target_coin:l}=a,c=t==null?void 0:t.event_type;return c.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:s,num:`+${L(P(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`}:c.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:l,num:`+${L(P(t==null?void 0:t.amount,l==null?void 0:l.decimals))}`}:c.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${L(P(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`,tokenInfo:s}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},ze=({info:t,isProfile:a=!1})=>{const[s,l]=b.useState(!0),{getTokenRank:c}=Fe();b.useEffect(()=>{const n=c(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",n),l(n)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:u,target_coin:x,price:j,reseverPrice:g}=t,h=a?"12px":"14px";return e.jsxs(O,{flexDirection:a?"column":"row",justify:"flex-end",align:a?"flex-end":"center",gap:a?"0px":"8px",children:[a&&(s?e.jsx(p,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(j)}):e.jsx(p,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(g)})),e.jsxs(d,{justifyContent:"end",children:[s?e.jsxs(d,{flexWrap:"wrap",justify:"flex-end",children:[!a&&e.jsx(p,{color:"text_caption",lineHeight:"1",children:L(j)}),e.jsxs(p,{fontSize:h,color:a?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[x==null?void 0:x.symbol," per ",u==null?void 0:u.symbol]})]}):e.jsxs(d,{flexWrap:"wrap",justify:"flex-end",children:[!a&&e.jsx(p,{color:"text_caption",children:L(g)}),e.jsxs(p,{fontSize:h,color:a?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[u==null?void 0:u.symbol," per ",x==null?void 0:x.symbol]})]}),e.jsx(H,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:n=>{E(n),l(!s)}})]})]})},it=({historyInfo:t,openExpendItemObj:a,isProfile:s=!1})=>e.jsxs(d,{justifyContent:"end",gap:"4px",children:[!s&&((t==null?void 0:t.status)=="Cancelled"?e.jsx(H,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(H,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"})),e.jsx(p,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),!s&&e.jsx(H,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:a[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),Ne=(t,a)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:s=>{t(()=>({orderListLoading:s}))},historyOrderList:[],setHistoryOrderList:s=>{t(()=>({historyOrderList:s}))},setMyOrderList:s=>{t(()=>({myOrderList:s}))}}),Ue=Se(Ne);function Ve({isOpen:t,onClose:a,historyInfo:s}){const{isApp:l}=Y(),c=b.useMemo(()=>(s==null?void 0:s.events)||[],[s]),{getExplorerUrl:u}=X(),x=e.jsx(me,{h:"44px",lineHeight:"24px",fontWeight:"500",fontSize:"16px",borderBottom:"1px solid",borderColor:"border",pb:"0px",children:"Trade Details"}),j=e.jsx(d,{h:"100%",gap:"12px",mt:"8px",children:e.jsx(O,{align:"flex-start",w:"100%",gap:"32px",ml:"4px",p:"0 0 16px 16px",borderLeft:"1px dashed",borderColor:"border",children:c.map(g=>{const{tokenInfo:h,text:n,icon:m,color:i,num:r}=ye(g,s);return e.jsxs(O,{align:"flex-start",w:"100%",mt:"-8px",children:[e.jsxs(d,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(p,{h:"20px",lineHeight:"20px",children:[ge(g.block_time)," (UTC)"]}),e.jsx(p,{color:i,children:n}),e.jsx(d,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-23px",top:"4px",borderRadius:"50%",children:e.jsx(le,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(A,{p:"16px",borderRadius:"12px",children:e.jsxs(d,{w:"100%",gap:"4px",justify:"space-between",children:[e.jsxs(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[r,"Â ",h==null?void 0:h.symbol]}),e.jsx(H,{svgW:"24px",svgH:"24px",minW:"24px",xlinkHref:"#icon-icon_link1",onClick:o=>{E(o),window.open(u(g.tx,"tx"))}})]})})]},g==null?void 0:g.tx)})})});return l?e.jsx(Ge,{isOpen:t,onClose:a,renderTabs:x,renderContent:j}):e.jsxs(ce,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:a,isCentered:!0,children:[e.jsx(oe,{}),e.jsxs(xe,{minWidth:"482px",children:[e.jsx(de,{children:x}),e.jsx(pe,{}),e.jsx(ue,{p:"0 16px 0px",textAlign:"center",children:j})]})]})}function Ge({isOpen:t,onClose:a,renderTabs:s,renderContent:l}){return console.log("DetailDrawer rendered",t),e.jsxs(_e,{isOpen:t,onClose:a,placement:"bottom",haveCloseButton:!0,children:[s,e.jsx(le,{h:"20px"}),l]})}function Ce(){const{currentAccount:t,addressChangeVersion:a}=he(),s=ee("limit"),{setOrderListLoading:l,setMyOrderList:c,myOrderList:u,orderListLoading:x}=Ue(),{getTokenListInfo:j}=be(),g=async(n=t==null?void 0:t.address,m)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",n);try{if(!n){l(!1),c([]);return}m&&l(!0);const i=await s.LimitOrder.getOwnerLimitOrderList(n,"all"),r=await h(i.data.filter(o=>o.status===q.PartialCompleted||o.status===q.Running));c(r),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",r)}catch(i){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",i)}finally{l(!1)}},h=async n=>{const m=[],i=[];for(const o of n)i.push(o.pay_coin_type),i.push(o.target_coin_type);const r=await j(i);for(const o of n){const[w,C]=[r==null?void 0:r.get(o.pay_coin_type),r==null?void 0:r.get(o.target_coin_type)];if(w&&C){const{total_pay_amount:v,pay_balance:f,rate:S,obtained_amount:_,claimed_amount:y,target_balance:k,created_ts:M,expire_ts:Z,status:J,id:R}=o,W=D(v,w.decimals).toString(),F=D(f,w.decimals).toString(),V=D(_,C.decimals).toString(),z=D(y,C.decimals).toString(),G=D(k,C.decimals).toString(),N=je.rateToPrice(S.toString(),w.decimals,C.decimals),K=T(1).div(N).toString(),te=D(T(v).sub(f).toFixed(0),w.decimals).toString(),fe={order_id:R,pay_coin:w,target_coin:C,price:N,reseverPrice:K,total_pay_amount:W,expect_obtain_amount:T(W).mul(N).toString(),remaining_amount:F,deal_amount:te,deal_rate:T(te).div(W).toString(),obtained_amount:V,claimed_amount:z,un_claimed_amount:T(G).sub(z).toString(),created_ts:M,expire_ts:Z,status:J};m.push(fe)}}return m.sort((o,w)=>w.created_ts-o.created_ts)};return{fetchMyLimitOrder:g,formatLimitOrderList:h,orderListLoading:x,myOrderList:u}}function $e(){const{fetchAccountBalance:t}=we(),{fetchMyLimitOrder:a}=Ce(),{signAndExecuteTransaction:s}=Q(),l=ee("limit"),[c,u]=b.useState(!1),{transactionConfirmation:x}=Q();return{handleCancelOrder:async g=>{u(!0);const h={getShowInfo:r=>{const o="Canceling order",w={modalDescriptionText:o,toastTitleText:o};return r==="success"&&(w.toastDescriptionContent="Order cancelled successfully",w.modalDescriptionText="Order cancelled successfully",w.toastTitleText="Order cancelled"),w}};x(h);const n=g.map(r=>({pay_coin_type:r.pay_coin.coin_type,target_coin_type:r.target_coin.coin_type,order_id:r.order_id})),m=await l.LimitOrder.cancelOrdersByOwner(n),i=await s(m,h);u(!1),i&&setTimeout(()=>{t(),a()},2e3)},cancelOrderLoading:c}}function qe(){const{fetchAccountBalance:t}=we(),{fetchMyLimitOrder:a}=Ce(),{signAndExecuteTransaction:s}=Q(),l=ee("limit"),[c,u]=b.useState(!1),[x,j]=b.useState(!1);return{handleClaimOrder:async(n,m)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",n),u(!0);const i={pay_coin_type:n.pay_coin.coin_type,target_coin_type:n.target_coin.coin_type,order_id:n.order_id},r=await l.LimitOrder.claimTargetCoin(i),o=await s(r,{getShowInfo:(w,C)=>{var S;const v=`Claim ${L(m)} ${(S=n==null?void 0:n.target_coin)==null?void 0:S.symbol}`,f={modalDescriptionText:v,toastTitleText:v};return w==="success"&&(f.toastDescriptionContent="",f.modalDescriptionText="",f.toastTitleText="Claim successfully"),f}});u(!1),o&&setTimeout(()=>{t(),a()},2e3)},getLimitOrderClaimHistory:async n=>{console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ order:",n),j(!0);const m=await l.LimitOrder.getLimitOrderClaimLogs(n.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",n,m),m?(j(!1),m.map(i=>{var o;const r=U(i.parsed_json.claimed_amount).div(Math.pow(10,(o=n.target_coin)==null?void 0:o.decimals));return{...i,...i.parsed_json,claimed_amount:r}})):[]},isClaimHistoryLoading:x,claimLoading:c}}const Ye=({orderInfo:t,isOpen:a,onClose:s,handleClaim:l,claimLoading:c,getLimitOrderClaimHistory:u,isClaimHistoryLoading:x})=>{const{getExplorerUrl:j}=X(),[g,h]=b.useState(""),[n,m]=b.useState([]),[i,r]=b.useState({label:"Claim",value:"claim"}),o=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],w=_=>{r(_),(_==null?void 0:_.value)=="history"&&C()},C=async()=>{const _=await u();_&&m(_)},v=b.useMemo(()=>!g||c?{disabled:!0,text:"Claim"}:U(g).gt(t.un_claimed_amount)||U(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[g,t.un_claimed_amount]),[f,S]=b.useState(!0);return b.useEffect(()=>{f&&(S(!1),h(t.un_claimed_amount))},[f,t.un_claimed_amount]),console.log("claimModal###history###",history),e.jsxs(ce,{autoFocus:!1,returnFocusOnClose:!1,isOpen:a,onClose:s,isCentered:!0,children:[e.jsx(oe,{}),e.jsxs(xe,{children:[e.jsx(de,{children:e.jsx(me,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(pe,{}),e.jsx(ue,{textAlign:"center",p:"0px",children:e.jsxs(O,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(A,{borderRadius:"8px",p:"8px",children:e.jsx(p,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(Ae,{info:t,imgSize:"28px"}),e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(p,{children:"Price"}),e.jsx(ze,{info:t})]}),e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(p,{children:"Filled Size"}),e.jsx(Re,{info:t})]}),e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(p,{children:"Expiry"}),e.jsx(Me,{info:t})]}),e.jsx(ke,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:o,currentTab:i.label,handleChangeTab:w}),(i==null?void 0:i.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(A,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(O,{gap:"16px",align:"flex-start",children:[e.jsx(p,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(He,{value:g?L(g).toString():"",onChange:_=>{h(_)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(d,{children:e.jsx(Ee,{token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(B,{onClick:()=>{l(g),s()},disabled:v.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:v.text})]}),(i==null?void 0:i.value)=="history"&&e.jsx(O,{w:"100%",gap:"12px",children:x?e.jsxs(A,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(d,{justify:"space-between",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]}),e.jsxs(d,{justify:"space-between",mt:"16px",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]})]}):(n==null?void 0:n.length)==0?e.jsx(Be,{type:"nodata",text:"No History.",p:"20px"}):n==null?void 0:n.map(_=>{var y,k;return e.jsx(A,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(O,{gap:"16px",align:"flex-start",children:[e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(p,{children:"Amount"}),e.jsxs(d,{gap:"4px",children:[e.jsx(Te,{imageUrl:(y=t==null?void 0:t.target_coin)==null?void 0:y.logo_url,w:"20px",h:"20px"}),e.jsxs(p,{color:"text_caption",lineHeight:"18px",children:[L(_==null?void 0:_.claimed_amount)," ",(k=t==null?void 0:t.target_coin)==null?void 0:k.symbol]})]})]}),e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(p,{children:"Time"}),e.jsxs(d,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:M=>{E(M),window.open(j(_.digest,"tx"))},children:[e.jsxs(p,{color:"text_caption",children:[I(Number(_==null?void 0:_.timestampMs),"")," (UTC)"]}),e.jsx(H,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},_.digest)})})]})})]})]})},nt=({orderInfo:t,isProfile:a=!1,isOpenOrder:s=!0})=>{const{handleCancelOrder:l,cancelOrderLoading:c}=$e(),{handleClaimOrder:u,claimLoading:x,getLimitOrderClaimHistory:j,isClaimHistoryLoading:g}=qe(),[h,n]=b.useState(!1),[m,i]=b.useState(!1),{isApp:r}=Y(),{getExplorerUrl:o}=X(),{isOpen:w,onOpen:C,onClose:v}=ve(),f=U(t==null?void 0:t.obtained_amount).gt(0)||U(t.un_claimed_amount).gt(0),S=(y,k)=>{E(y),k==="claim"&&n(!0),k==="cancel"&&!c&&l([t])},_=()=>{const y=a?"calc(100vw - 84px)":"calc(50vw - 28px)";return f?e.jsx(B,{isLoading:x,disabled:x,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:k=>S(k,"claim"),children:"Claim"}):e.jsx(ie,{placement:"top",tooltip:e.jsx(p,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or wait for the auto distribution."}),children:e.jsx(se,{w:{base:y,lg:"unset"},children:e.jsx(B,{w:"100%",disabled:!0,h:"28px",p:"0 8px",borderRadius:"8px",fontSize:"12px",children:"Claim"})})})};return e.jsxs(d,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:a&&r?"0px":"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:{base:"space-between",lg:"flex-end"},gap:"8px",children:[s&&e.jsxs(d,{justify:a&&r?"space-between":"flex-end",children:[_(),a&&e.jsx(ie,{placement:"bottom-end",showTooltip:!r,tooltip:e.jsx(re,{getExplorerUrl:o,orderInfo:t,cancelOrderLoading:c,onCancel:()=>l([t])}),children:e.jsx(se,{children:e.jsx(B,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",onClick:r?C:void 0,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(H,{svgFill:r?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!a&&s&&e.jsx(B,{isLoading:c,disabled:c,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",variant:"outline",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:y=>S(y,"cancel"),children:"Cancel"}),a&&!s&&e.jsxs(d,{children:[e.jsx(B,{w:{base:"calc(100vw - 84px)",lg:"unset"},h:"32px",variant:"outline",fontSize:"12px",p:"0 8px",borderRadius:"8px",fontWeight:"500",onClick:y=>{E(y),i(!0)},children:"Details"}),e.jsx(B,{onClick:y=>{E(y),window.open(o(t.order_id,"poolAddress"))},w:"32px",h:"32px",p:"0",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(H,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),h&&e.jsx(Ye,{orderInfo:t,claimLoading:x,isOpen:h,onClose:()=>n(!1),handleClaim:y=>u(t,y),getLimitOrderClaimHistory:()=>j(t),isClaimHistoryLoading:g}),m&&e.jsx(Ve,{isOpen:m,onClose:()=>i(!1),historyInfo:t}),e.jsx(_e,{isOpen:w,onClose:v,placement:"bottom",children:e.jsx(O,{align:"flex-start",sx:{">div":{w:"100%",">div":{justifyContent:"center",background:"none",p:{color:"text_caption",fontSize:"16px"}}}},children:e.jsx(re,{getExplorerUrl:o,orderInfo:t,cancelOrderLoading:c,onCancel:()=>l([t])})})})]})};function re({getExplorerUrl:t,orderInfo:a,cancelOrderLoading:s,onCancel:l}){return e.jsxs(O,{align:"flex-start",children:[e.jsx(ne,{text:"View on Explorer",onClick:()=>window.open(t(a.order_id,"poolAddress"))}),e.jsx(ne,{text:"Cancel",onClick:s?()=>{}:l})]})}function rt(){const{fetchByApi:t}=De(),{getTokenListInfo:a}=be(),{currentAccount:s}=he(),[l,c]=b.useState(!0),[u,x]=b.useState([]);b.useEffect(()=>{x([])},[s==null?void 0:s.address]);const j=async(h,n)=>{var m;try{n&&c(!0);const i=await t(We,"GET",{wallet_address:h});if(console.log(i,"getLimitOrderHistory"),i!=null&&i.list&&((m=i==null?void 0:i.list)==null?void 0:m.length)>0){const r=await g((i==null?void 0:i.list)||[]);return x(r),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",r),r}return[]}catch(i){return console.log("getLimitOrderHistory ~ error:",i),[]}finally{c(!1)}},g=async h=>{const n=[],m=[];for(const r of h)m.push(r.pay_coin),m.push(r.target_coin);const i=await a(m);for(const r of h){const[o,w]=[i==null?void 0:i.get(r.pay_coin),i==null?void 0:i.get(r.target_coin)];if(o&&w){const{total_pay_amount:C,remaining_amount:v,rate:f,obtained_amount:S,claimed_amount:_,target_balance:y,created_ts:k,expire_ts:M,cancel_reason:Z,events:J}=r,R=J;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",r,R),R.sort((N,K)=>K.block_time-N.block_time);const W=D(C,o.decimals).toString(),F=je.rateToPrice(f.toString(),o.decimals,w.decimals),V=T(1).div(F).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",F,V);const z=D(T(C).sub(v).toFixed(0),o.decimals).toString(),G={order_id:r.order_id,pay_coin:o,target_coin:w,price:F,reseverPrice:V,total_pay_amount:W,remaining_amount:v,deal_amount:z,deal_rate:T(z).div(W).toString(),expect_obtain_amount:T(W).mul(F).toString(),obtained_amount:S,claimed_amount:_,un_claimed_amount:"0",created_ts:k,expire_ts:M,status:Number(Z)===0?q.Completed:q.Cancelled,events:R};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",G),n.push(G)}}return n.sort((r,o)=>o.created_ts=r.created_ts),n};return{getLimitOrderHistory:j,historyOrderLoading:l,historyOrderList:u}}export{Ae as C,Me as E,Re as F,at as L,nt as O,ze as P,it as S,Ce as a,rt as b,$e as c,Ue as u};
//# sourceMappingURL=useGetLimitOrderHistory-75NdmZGk.js.map

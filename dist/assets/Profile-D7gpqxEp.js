import{a as p,D as Ke,j as e,V as A,F as Ie,aa as He,H as v,T as g,C as Z,u as Q,f as N,v as $,X as Ye,Y as Qe,Z as Ze,$ as Je,a0 as et,a1 as tt,ab as ze,I as st,N as mt,aA as bt,O as wt,Q as Ct,ar as Me,ag as De}from"./vendor-BulRdKUe.js";import{u as nt}from"./global-Lf-aHf3L.js";import{j as U,F as re,I as X,O as ae,aU as yt,i as be,e as ot,q as Xe,d as F,aV as me,B as q,v as Y,c as Oe,a as V,G as _t,z as te,R as it,n as pe,M as se,p as St,X as vt,f as at,w as W,m as Ee,as as J,aW as Tt,ar as lt,am as kt,k as we,aX as Lt,aY as $e,Q as je,V as rt,aR as Pt,al as Rt,aI as Te,a0 as Dt,aZ as We,a_ as Ne}from"./index-CLZsOITc.js";import{N as ne}from"./NoData-fdoVeTOA.js";import{u as Ot,A as At,R as Ht}from"./RecentTransactions-BlBx7FIQ.js";import{A as zt}from"./AccountSwitchDrawer-CvHqibPd.js";import{u as ct,D as dt,g as Et,e as Ft,f as Bt,W as Ut,b as Mt,R as Xt,a as $t,d as Wt}from"./OverviewOrders-DzwS8t40.js";import{I as ke}from"./IconText-Bqe7Szpe.js";import{u as Nt}from"./RangeValue-CeGmD9b8.js";import{H as I}from"./HTextLabelBox-vFxxeEh0.js";import{u as ee}from"./activeOrders-C3ZxZftn.js";import{H as Fe,T as Ce}from"./Table-CC-xUlSV.js";import{P as ye}from"./Pagination-KrChIsMx.js";import{b as Vt,u as xe,c as Gt,C as qt,P as Kt,F as It,E as Yt,S as Qt,O as Zt,a as Jt}from"./useGetLimitOrderHistory-YJyRXaHQ.js";import{u as es}from"./useRpcListener-Dld0STO6.js";import{R as ts}from"./RefreshButton-DJpQ_zRu.js";import{a as le,d as ss,u as pt,e as ns,f as os,g as is,c as as,b as ls}from"./usePositionList-CObkP_cm.js";import{P as rs,a as cs,b as ds,u as ps}from"./PoolItem-pxW2ZI5z.js";import{P as xs,u as us}from"./PositionListLoading-XsdjogbP.js";import{u as gs}from"./useAccountBalance-B5jGnKEc.js";import{u as xt}from"./useToken-CPqU19Ux.js";import{f as Be,X as hs,a as fs,b as js,u as ms,c as bs,E as ws,C as Cs,e as ys,d as _s,g as Ss}from"./useXCetus-3KScSnUu.js";import{S as ut}from"./SingleTokenInfo-xrDFKGFi.js";import{S as vs}from"./SortDropBlock-DKUgwqBt.js";import{T as Le}from"./TableSortTh-BbjoLifi.js";import{u as Ts}from"./useTokenBalance-DyFVzZGc.js";import{X as ks,a as Ls,b as Ps,c as Rs,u as Ds}from"./useXCetusHelper-CYzVxYUT.js";import"./CopyButton-CuKLDlt0.js";import"./Drawer-Cc85-wz0.js";import"./useTransaction-Bt3dLzgc.js";import"./useTrack-C59Tu8ii.js";import"./useSigner-BJM2wSbD.js";import"./ErrorTips-CA427N4E.js";import"./usePreviousValue-DJR5Z5zU.js";import"./useFavoritePool-CrAPnLWy.js";import"./useGetPoolList-1lIRMgQW.js";import"./useWrapPoolData-xiy8vY_6.js";import"./CheckBox-DprjLUMn.js";import"./SearchInputBlock-CxBj-mLW.js";import"./index-B9MfitwQ.js";import"./Loading-CEW9oCbv.js";import"./TooltipIcon-OWEZB6mz.js";import"./PositionCurrentPrice-CZUitPPX.js";import"./useBurn-DqQ8ibF8.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-wdI_SSB_.js";import"./PoweredByHaedal-DgLgYLeQ.js";import"./PriceRange-D3IHTWuA.js";import"./PositionStatus-dB6Y3IZ6.js";import"./detail-D8hpDMei.js";import"./TradeInputGroup-NFQ-LGVQ.js";import"./_getAllKeysIn-Dsxf5OjG.js";import"./HighlightText-Uv5QOqtT.js";import"./index-4kM3JsjZ.js";import"./debounce-Cta0IZrB.js";import"./index-e8NcK24v.js";function Os(t=100){const o=p.useRef([]),s=p.useRef(!1),a=p.useRef(void 0),l=p.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const r=o.current.shift();if(!r)continue;const{id:c,run:x,onStart:h,onSuccess:u,onError:m}=r;if(r._cancelled){console.log(`[task:${r.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),h==null||h(c);const d=await x(a.current,c);a.current=d,console.log(`[task:${c}] success`,d),u==null||u(d,c)}catch(d){console.error(`[task:${c}] failed`,d),m==null||m(d,c)}await new Promise(d=>setTimeout(d,t))}s.current=!1}},[t]),i=r=>{o.current.push(r),l()},n=r=>{const c=o.current.find(x=>x.id===r);c&&(c._cancelled=!0),o.current=o.current.filter(x=>x.id!==r)};return p.useEffect(()=>()=>{o.current=[],s.current=!1,a.current=void 0},[]),{addTask:i,removeTask:n}}const gt=(t,o)=>o?t:"********";function As({totalValue:t,onRefreshTask:o,isLoading:s,children:a}){const[l,i]=p.useState(!1),{currentAccount:n,onWalletModal:r,accounts:c,accountServiceNameObj:x}=U(),{isShowProfileAssets:h,setIsShowProfileAssets:u}=nt();p.useEffect(()=>{i(!0)},[]);const{isOpen:m,onClose:d,onToggle:b}=Ke(),{getServiceNames:y}=Ot(),O=p.useCallback(()=>{m||y(c),b(),console.log("AccountSwitch###handleClick###isOpen: ",m)},[m,c]);return console.log(n,x,c,"currentAccount-H5Main"),e.jsxs(A,{w:"100%",mt:"28px",children:[l?n!=null&&n.address?e.jsxs(A,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(v,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(v,{h:"18px",children:[e.jsx(g,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:h?"Hide Value":"Show Value"}),children:e.jsx(Z,{children:e.jsx(X,{xlinkHref:h?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>u(!h)})})})]}),e.jsxs(v,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(g,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(X,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(Q,{isLoaded:!s,h:"32px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(ae(t,2),h)})}),c.length>1&&e.jsxs(v,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:O,cursor:"pointer",children:[e.jsxs(v,{children:[e.jsx(X,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(g,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[n!=null&&n.label?`${n==null?void 0:n.label} : `:"",(x==null?void 0:x[n==null?void 0:n.address])||yt(n==null?void 0:n.address)]})]}),e.jsx(X,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),a]}):e.jsx(ne,{type:"nowallet",mt:"20px",onboard:()=>r(!0)}):e.jsx(Ie,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(He,{})}),e.jsx(zt,{isOpen:m,onClose:d})]})}function _e(t){const{type:o,children:s,wrapStyle:a={h:"60px"},textStyle:l={fontSize:"16px"}}=t,i=(n,r)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(n,r):n===r.value;return e.jsxs(v,{justify:"space-between",w:"100%",h:"60px",...a,children:["title"in t?e.jsx(g,{color:"text_caption",...l,children:t==null?void 0:t.title}):e.jsx(be,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(n,r)=>i(n,r),wrapStyle:{h:"60px",border:"none",gap:"38px",...a},itemStyle:l}),s]})}function Hs({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:a,outCoin:l}=t,{orderHistoryList:i,handleGetDcaOrderHistory:n,orderHistoryListLoading:r}=ct();p.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=ot(),[x,h]=p.useState(s),u=142,m=(i==null?void 0:i.length)||0,d=(i==null?void 0:i.length)<=1?`${u*m-8}px`:`${u*m+(m-1)*32-8}px`;return e.jsxs(A,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(i==null?void 0:i.length)>=3?"460px":"unset",overflowY:"auto",children:[!r&&e.jsx(N,{h:d,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),r?e.jsx(v,{h:"100px",w:"100%",justify:"center",children:e.jsx(He,{})}):(i==null?void 0:i.length)===0?e.jsx(ne,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):i.map(b=>{const y=Xe(b.inAmount,a==null?void 0:a.decimals),O=Xe(b.outAmount,l==null?void 0:l.decimals),S=F(y).div(O).toString(),f=F(1).div(S).toString();return e.jsxs(A,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(v,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(g,{h:"20px",lineHeight:"20px",children:[me((b==null?void 0:b.time)*1e3)," (UTC)"]}),e.jsx(X,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(b==null?void 0:b.tx,"tx"))}}),e.jsx(v,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(N,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(q,{p:"16px",borderRadius:"12px",children:e.jsxs(A,{align:"flex-start",gap:"20px",children:[e.jsxs(A,{gap:"0px",align:"flex-start",children:[e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:x?`${Y(S)} `:`${Y(f)} `}),e.jsxs(v,{children:[e.jsxs(g,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",x?` ${a.symbol} per ${l.symbol}`:` ${l.symbol} per ${a.symbol}`,")"]}),e.jsx(X,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>h(!x)})]})]}),e.jsxs(v,{w:"100%",gap:"4px",children:[e.jsx(Oe,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Y(y)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${a.symbol}`}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(Oe,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(g,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${Y(O)}`}),e.jsx(g,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${l.symbol}`})]})]})})]},b==null?void 0:b.tx)})]})}function zs({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:a=!1,toClaim:l}){const{inCoin:i,outCoin:n}=t;return e.jsxs(A,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(Es,{}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(dt,{orderInfo:t}),o&&l&&e.jsx($,{isLoading:a,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(g,{fontSize:"16px",color:"text_caption",children:Et(t,o,!0)}),e.jsx(g,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(v,{w:"100%",justify:"space-around",children:[e.jsxs(A,{children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:Ft(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]})]}),e.jsx(N,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(A,{children:[e.jsx(g,{color:"text_caption",fontSize:"16px",children:Bt(t)}),e.jsxs(g,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(A,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(I,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(I,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(I,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${i==null?void 0:i.symbol}`}),o&&e.jsx(I,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(I,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),o&&e.jsx(I,{label:"Next Order (UTC)",value:me(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(I,{label:"Created (UTC)",value:me(t==null?void 0:t.createdAt)||""})]})]})}const Es=()=>{const[t,o]=p.useState(!1);return e.jsxs(A,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(v,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(g,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(X,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(A,{align:"flex-start",w:"100%",children:[e.jsx(N,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Ut,{})]})]})};function Fs({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:a,isClaimLoading:l=!1,toClaim:i}){const{isApp:n}=V(),r=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,x]=p.useState("overview"),{inCoin:h,outCoin:u}=s,[m,d]=p.useState(!1),{getTokenRank:b}=Nt();return p.useEffect(()=>{const y=b(h,u);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",u,h,y),d(!y)},[h==null?void 0:h.coin_type,u==null?void 0:u.coin_type]),e.jsxs(Ye,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{minWidth:n?"300px":"482px",children:[e.jsx(Je,{children:e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(_e,{type:"tab",currentTab:c,tabs:r,onTabChange:y=>x(y.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(zs,{orderInfo:s,isActiveOrder:a,pageDirect:m,isClaimLoading:l,toClaim:i}),c=="orders"&&e.jsx(Hs,{orderInfo:s,isActiveOrder:a,pageDirect:m})]})]})]})}function Bs({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=V(),[a,l]=p.useState(!1),{getExplorerUrl:i}=ot(),{isClaimLoading:n,toClaim:r,closeOrderAction:c,isCloseLoading:x}=ct();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx($,{isLoading:n,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||n,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(re,{placement:"bottom-end",tooltip:e.jsxs(A,{align:"flex-start",children:[e.jsx(ke,{text:"View Details",onClick:()=>{l(!0)}}),e.jsx(ke,{text:"View on Explorer",onClick:()=>{window.open(i(t.orderID,"poolAddress"))}}),e.jsx(ke,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:x?()=>{}:()=>{c(t)}})]}),children:e.jsx(Z,{children:e.jsx($,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(X,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx($,{onClick:()=>{l(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx($,{onClick:h=>{_t(h),window.open(i(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(X,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),a&&e.jsx(Fs,{isOpen:a,onClose:()=>l(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:r})]})}function Us(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:a}=ee(),[l,i]=p.useState("activeDCAs"),n=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":a==null?void 0:a.length}],[o,a,s]),r=p.useMemo(()=>l=="activeDCAs"?s:a,[l,s,a]),{isApp:c}=V(),{closeAll:x,claimAll:h,isClaimAllLoading:u,isCloseAllLoading:m}=Mt(),d=p.useMemo(()=>l==="pastDCAs"||(r==null?void 0:r.length)===0?0:r==null?void 0:r.reduce((R,L)=>F(R).plus(L==null?void 0:L.outBalance),F(0)).toString(),[l,r]),[b,y]=p.useState([]),[O,S]=p.useState(0),[f,_]=p.useState(1),T=10,k=Ve(l=="activeDCAs");return p.useEffect(()=>{if((r==null?void 0:r.length)>0){const R=(f-1)*T;(r==null?void 0:r.length)<=R&&_(1)}},[r]),p.useEffect(()=>{if((r==null?void 0:r.length)>0){S(r==null?void 0:r.length);const R=(f-1)*T,L=R+T;console.log("ðŸš€ ~ useEffect ~ start:",f,r.slice(0,L),R,L),(r==null?void 0:r.length)>R&&y(r.slice(R,L))}},[f,r]),e.jsxs(A,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(be,{type:"outlineTab",tabList:n,currentTab:l,handleChangeTab:R=>i(R==null?void 0:R.value),isActive:(R,L)=>R===L.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(r==null?void 0:r.length)>1&&l=="activeDCAs"&&e.jsxs(v,{children:[e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:u,disabled:Number(d)===0||u,onClick:()=>{h(r)},children:"Claim All"}),e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:m,disabled:(r==null?void 0:r.length)==0||m,onClick:()=>{x(r)},children:"Close All"})]})]}),e.jsxs(A,{w:"100%",position:"relative",gap:"20px",children:[(t||!o)&&(r==null?void 0:r.length)===0?e.jsx(ne,{type:"nodata",text:l==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(A,{w:"100%",gap:"4px",children:e.jsx(Fe,{rowKey:"orderID",columns:k,dataSource:b,loading:!t&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ce,{rowKey:"orderID",columns:Ve(l=="activeDCAs"),dataSource:b,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(r==null?void 0:r.length)>T&&e.jsx(Z,{children:e.jsx(ye,{total:O,size:T,currentPage:f,onChange:R=>{_(R)}})})]})]})}const Ve=t=>[{title:e.jsx(g,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(dt,{orderInfo:s})},{title:e.jsx(g,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Xt,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx($t,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(g,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(g,{color:"text_caption",children:me(s)})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(Bs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function Ms(){const{currentAccount:t}=U(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:a}=Vt(),{myOrderList:l,orderListLoading:i}=xe(),{isAutoRefresh:n,autoRefreshCount:r}=ee(),[c,x]=p.useState("openOrders"),h=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:!n&&i?"":l==null?void 0:l.length},{label:"Orders History",value:"ordersHistory",num:!n&&a?"":s==null?void 0:s.length}],[i,a,l,s]),u=j=>{t!=null&&t.address&&o(t.address,j)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",r),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),r>0&&u(!0)},[r]),p.useEffect(()=>{u(!0)},[c,t]);const m=p.useMemo(()=>c=="openOrders"?i:a,[c,i,a]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",l,s),c=="openOrders"?l:s),[c,l,s]);es({onRpcChange:()=>{u(!0)}});const{isApp:b}=V(),{handleCancelOrder:y,cancelOrderLoading:O}=Gt(),[S,f]=p.useState([]),[_,T]=p.useState(0),[k,R]=p.useState(1),L=10,D=Xs(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const j=(k-1)*L;(d==null?void 0:d.length)<=j&&R(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){T(d==null?void 0:d.length);const j=(k-1)*L,P=j+L;console.log("ðŸš€ ~ useEffect ~ start:",k,d.slice(0,P),j,P),(d==null?void 0:d.length)>j&&f(d.slice(j,P))}},[k,d]),e.jsxs(A,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(be,{type:"outlineTab",tabList:h,currentTab:c,handleChangeTab:j=>x(j==null?void 0:j.value),isActive:(j,P)=>j===P.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(v,{children:e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:O,onClick:()=>{y(l)},children:"Cancel All"})})]}),e.jsxs(A,{w:"100%",position:"relative",gap:"20px",children:[(n||!m)&&(d==null?void 0:d.length)===0?e.jsx(ne,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):b?e.jsx(A,{w:"100%",gap:"4px",children:e.jsx(Fe,{rowKey:"order_id",columns:D,dataSource:S,loading:!n&&m,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ce,{rowKey:"order_id",columns:D,dataSource:S,loading:!n&&m,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>L&&e.jsx(Z,{children:e.jsx(ye,{total:_,size:L,currentPage:k,onChange:j=>{R(j)}})})]})]})}const Xs=t=>[{title:e.jsx(g,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(qt,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Kt,{info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(It,{info:s,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Yt,{info:s,isProfile:!0})},!t&&{title:e.jsx(g,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Qt,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(g,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(Zt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function $s(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=p.useState("limitOrders");return e.jsx(q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{align:"flex-start",gap:"20px",children:[e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(_e,{type:"tab",currentTab:o,tabs:t,onTabChange:a=>s(a.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(Ms,{}),o==="dca"&&e.jsx(Us,{})]})})}function Ws({handleRefresh:t,totalValue:o,isLoading:s}){var m,d;const{isApp:a}=V(),{currentAccount:l,accounts:i}=U(),{isShowProfileAssets:n,setIsShowProfileAssets:r}=nt(),[c,x]=p.useState(!1),{onClose:h}=Ke(),u=i.reduce((b,y)=>(b[y.address]=y,b),{});return e.jsxs(A,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(v,{w:"100%",children:[e.jsx(g,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!a,placement:"bottom-end",tooltip:e.jsx(g,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(Z,{children:e.jsx(X,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>r(!n)})})})]}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(Q,{isLoaded:!s,h:"22px",children:e.jsx(g,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(ae(o,2),n)})}),e.jsxs(v,{children:[e.jsxs(v,{p:"0 8px",h:"36px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{x(!0)},children:[e.jsx(X,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(g,{children:"Transactions"})]}),e.jsx(ts,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),i.length>1&&e.jsxs(v,{children:[((m=u==null?void 0:u[l==null?void 0:l.address])==null?void 0:m.label)&&e.jsxs(g,{color:"primary_gray",children:[(d=u==null?void 0:u[l==null?void 0:l.address])==null?void 0:d.label," :"]}),e.jsx(At,{currentAccount:l,accounts:i,onClose:h,isProfile:!0})]}),c&&e.jsx(Ht,{isOpen:c,onClose:()=>x(!1)})]})}function Ns(){var O;const{currentAccount:t,onWalletModal:o}=U(),{showPosListLength:s,setShowPosListLength:a,posBaseListLoading:l,posBaseListGroupByPool:i}=le(),[n,r]=p.useState([]),{isAutoRefresh:c}=ee(),[x,h]=p.useState([]),u=S=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",S),h(f=>[...f,S])},m=S=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",S),h(f=>f.filter(_=>(_==null?void 0:_.coin_type)!==(S==null?void 0:S.coin_type)))};p.useEffect(()=>{t!=null&&t.address||a("")},[t==null?void 0:t.address]),p.useEffect(()=>{var k,R,L,D;const S=(k=x[0])!=null&&k.coin_type?te((R=x[0])==null?void 0:R.coin_type):void 0,f=(L=x[1])!=null&&L.coin_type?te((D=x[1])==null?void 0:D.coin_type):void 0,_=Object.values(i).filter(j=>S&&f?te(j.tokenA.coin_type)==S&&te(j.tokenB.coin_type)==f||te(j.tokenA.coin_type)==f&&te(j.tokenB.coin_type)==S:S?te(j.tokenA.coin_type)==S||te(j.tokenB.coin_type)==S:j);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(i),_),r(_);const T=_.reduce((j,P)=>j+(P.list?P.list.length:0),0);t!=null&&t.address&&a(T.toString())},[x,i]),p.useEffect(()=>()=>{a("")},[]);const d=p.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[b,y]=p.useState("positions");return e.jsx(q,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{gap:"16px",w:"100%",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(_e,{type:"tab",currentTab:b,tabs:d,onTabChange:S=>y(S.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(rs,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:x,onClickSelectCoinList:u,onDeleteSelectCoinList:m})]}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(cs,{}),t!=null&&t.address?!c&&l?[{},{},{},{}].map((S,f)=>e.jsx(xs,{},f)):((O=Object.values(n))==null?void 0:O.length)>0?Object.values(n).map((S,f)=>e.jsx(ds,{poolInfo:S},f)):e.jsx(ne,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(ne,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})})}function Vs({tabList:t,tabData:o,onClickTab:s}){return e.jsx(A,{w:"100%",children:t==null?void 0:t.map(a=>e.jsx(Gs,{imgUrl:a.activeImgUrl,value:o[a.value].totalValue,title:a.title,url:a.route,tooltip:a==null?void 0:a.tooltip,onClick:()=>s(a.value),isLoading:o[a.value].isLoading},a.title))})}const Gs=({imgUrl:t,value:o,title:s,url:a,tooltip:l,isLoading:i,onClick:n})=>(ze(),e.jsxs(v,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(v,{gap:"12px",children:[e.jsx(st,{w:"36px",h:"36px",src:t}),e.jsxs(A,{gap:"2px",align:"flex-start",children:[e.jsx(Q,{h:"24px",isLoaded:!i,children:e.jsx(g,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})}),e.jsxs(v,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),l&&e.jsx(re,{tooltip:l,children:e.jsx(N,{children:e.jsx(X,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(Z,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(X,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function qs({tabList:t,activeTab:o,tabData:s,onClickTab:a}){return e.jsx(v,{w:"100%",mt:"10px",children:t.map(l=>{var i,n;return e.jsxs(q,{w:"25%",p:"24px 16px",h:"94px",bgImage:o===l.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",onClick:()=>a(l.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",img:{opacity:"0.8"}},children:[e.jsxs(A,{align:"flex-start",gap:"12px",children:[e.jsx(g,{fontSize:"14px",color:"text_caption",children:l.title}),e.jsx(v,{h:"22px",children:e.jsx(re,{placement:"top",tooltip:e.jsx(g,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:l.tooltip}),showTooltip:l.showTooltip,children:e.jsx(Z,{as:"button",children:e.jsx(Q,{isLoaded:!((i=s[l.value])!=null&&i.isLoading),children:e.jsx(g,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(n=s[l.value])==null?void 0:n.totalValue})})})})})]}),e.jsx(st,{w:"48px",h:"48px",src:l.activeImgUrl,opacity:o===l.value?"0.8":"0.4"})]},l.value)})})}function Ge(t){const{isApp:o}=V();return o?e.jsx(Vs,{...t}):e.jsx(qs,{...t})}const Ks=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),Se=it(Ks);function ht(){const{currentAccount:t}=U(),{fetchAccountBalance:o}=gs(),{coinHoldingList:s,setCoinHoldingList:a,setIsCoinHoldingLoading:l,setIsCoinPriceLoading:i,setHoldingsTotalUsd:n,isCoinPriceLoading:r,setUnknownCoinCount:c}=Se(),{getTokenListInfo:x}=xt(),{getTokenPrice:h}=pe(),{refreshCoinPriceInfo:u}=Be(),m=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{m.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const d=async()=>{const f=m.current;if(f){l(!0);const _=await o(f,!0);if(_){const T=await x(_.filter(L=>F(L.totalBalance).gt(0)).map(L=>L.coinType));if(!T)throw l(!1),a([]),new Error("get token list info error");const k=[];let R=0;return _.forEach(L=>{const D=T.get(L.coinType);if(D){const j=L.totalBalance,P=se(j,D.decimals).toString(),z=Y(P,void 0,void 0,St.ROUND_DOWN).toString(),B={balance:j,balance_format:P,balance_display:z,balance_usd:"0",coin:D,coin_type:D==null?void 0:D.coin_type,price:"",price_diff_24:""};k.push(B),D.is_verified||R++}}),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",f),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",m.current),f===m.current&&(a(k),c(R),b([...k])),l(!1),k}}else l(!1),a([]);return[]},b=async f=>{i(!0);try{await u(f.filter(_=>_.coin.is_verified).map(_=>_.coin.coin_type))}catch(_){console.error("fetch coin price info error",_)}finally{i(!1)}},y=f=>{f.forEach(_=>{const{coin:T}=_;if(T.is_verified){const k=h(T.coin_type);k&&(_.price=k.price,_.price_diff_24="",_.balance_usd=F(_.balance_format).mul(k.price).toString())}})},O=async f=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:f,coinHoldingList:s,currentAccount:t}),t){const{search:_,current_sort:T,current_sort_order:k,is_show_unknown:R=!1,is_hide_small_balance:L=!0}=f;let D=[];if(R?D.push(...s):D=s.filter(j=>j.coin.is_verified),_){const j=_.toLowerCase();D=D.filter(P=>P.coin.coin_type.toLowerCase().includes(j)||P.coin.symbol.toLowerCase().includes(j)||P.coin.name.toLowerCase().includes(j))}return y(D),L&&!r&&(D=D.filter(j=>F(j.balance_usd).gt(.01))),D.sort((j,P)=>{if(T==="balance"){const z=F(j.balance_format).cmp(F(P.balance_format));if(z!==0)return k==="desc"?-z:z}if(T==="value"){const z=F(j.balance_usd).cmp(F(P.balance_usd));return z!==0?k==="desc"?-z:z:F(P.balance_format).cmp(F(j.balance_format))}if(T==="price"){const z=F(j.price).cmp(F(P.price));return z!==0?k==="desc"?-z:z:F(P.balance_format).cmp(F(j.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",D),D}return[]};return p.useEffect(()=>{y(s);const f=s.reduce((_,T)=>_+Number(T.balance_usd||0),0);n(f.toString())},[s,r]),{getFilterCoinHoldingList:O,fetchCoinHoldingList:d,resetUserData:()=>{a([]),n("0"),c(0)}}}function Is({inputValue:t,changeInputValue:o}){const s=p.useRef(null),[a,l]=p.useState(!1);return V(),e.jsxs(mt,{w:a?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(bt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(X,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:i=>{var n;(n=s.current)==null||n.focus(),l(!0)}})}),e.jsx(wt,{bg:"bg_secondary",ref:s,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:i=>{o(i.target.value)},onFocus:()=>{l(!0)},onBlur:()=>{o(""),l(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:"28px",pl:a?"28px":"8px"}),t?e.jsx(Ct,{right:"5px",children:e.jsx(X,{xlinkHref:"#icon-icon_close",onMouseDown:i=>i.preventDefault(),onClick:i=>{o(""),setTimeout(()=>{var n;(n=s.current)==null||n.focus()},0)}})}):null]})}function Ys({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:a,isHideLowAsset:l,handleIsHideLowAsset:i,unknownCoinCount:n}){return V(),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(v,{children:[e.jsx(Is,{inputValue:t,changeInputValue:o}),e.jsx(q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsxs(g,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",n,")"]}),e.jsx(Me,{isChecked:s,onChange:a})]})}),e.jsx(q,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsx(g,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Me,{isChecked:l,onChange:i})]})})]})]})}function Qs(){const{isApp:t}=V(),{getFilterCoinHoldingList:o}=ht(),{isCoinHoldingLoading:s,isCoinPriceLoading:a,unknownCoinCount:l}=Se(),{isAutoRefresh:i}=ee(),[n,r]=p.useState([]),[c,x]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[h,u]=p.useState(!1),[m,d]=p.useState(!0),[b,y]=p.useState("desc"),[O,S]=p.useState(Ae[2]),f=C=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",C),i||H(1),x(C),o(C).then(r)},_=C=>{f({...c,search:C})},T=(C,E)=>{f({...c,[C]:E}),C==="is_show_unknown"&&u(E),C==="is_hide_small_balance"&&d(E)},k=C=>{const E=(C==null?void 0:C.value)===(O==null?void 0:O.value),M=t||!E?"desc":b==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",M,C),S(C),y(M),f({...c,current_sort:C.value,current_sort_order:M})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,a,n),!s&&!a&&f(c)},[s,a]);const R=ze(),L=C=>{R(`/swap/${C}/''`)},[D,j]=p.useState([]),[P,z]=p.useState(0),[B,H]=p.useState(1),w=10;return p.useEffect(()=>{if((n==null?void 0:n.length)>0){const C=(B-1)*w;(n==null?void 0:n.length)<=C&&H(1)}},[n]),p.useEffect(()=>{if((n==null?void 0:n.length)>0){z(n==null?void 0:n.length);const C=(B-1)*w,E=C+w;console.log("ðŸš€ ~ useEffect ~ start:",B,n.slice(0,E),C,E),(n==null?void 0:n.length)>C&&j(n.slice(C,E))}else j([])},[B,n]),e.jsx(q,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Ys,{unknownCoinCount:l,inputValue:c.search||"",changeInputValue:_,isShowUnknownCoin:h,handleIsShowUnknownCoin:C=>T("is_show_unknown",C.target.checked),isHideLowAsset:m,handleIsHideLowAsset:C=>T("is_hide_small_balance",C.target.checked)}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(A,{w:"100%",position:"relative",gap:"20px",children:[!s&&!a&&(n==null?void 0:n.length)===0?e.jsx(ne,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(A,{w:"100%",gap:"4px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(g,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(vs,{sortText:"Sort by",minW:"180px",currentSort:O,sortByList:Ae,onSortByChange:k,xlinkHref:b==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>y(C=>C==="desc"?"asc":"desc")})]}),e.jsx(Fe,{rowKey:"coin_type",columns:qe(b,O,k,L,!i&&a),dataSource:D,loading:!i&&(s||a),itemSkeletonLength:5,itemHeight:"30px",onRowClick:C=>{L(C==null?void 0:C.coin_type)}})]}):e.jsx(Ce,{rowKey:"coin_type",columns:qe(b,O,k,L,!i&&a),dataSource:D,skeletonLength:5,loading:!i&&(s||a),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:C=>{L(C==null?void 0:C.coin_type)}}),(n==null?void 0:n.length)>w&&e.jsx(Z,{children:e.jsx(ye,{total:P,size:w,currentPage:B,onChange:C=>{H(C)}})})]})]})})}const Ae=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Pe=Object.fromEntries(Ae.map(t=>[t.value,t])),qe=(t,o,s,a,l)=>[{title:e.jsx(g,{children:"Token"}),key:"pool",thConfig:{w:"22%"},showLabel:!1,render:({coin:i})=>e.jsx(ut,{haveTooltip:!0,token:i,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(Le,{labelInfo:Pe.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"20%"},render:({coin:i,balance_display:n})=>e.jsxs(g,{color:"text_caption",children:[n," ",vt(i==null?void 0:i.symbol,10)]})},{title:e.jsx(Le,{labelInfo:Pe.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"20%"},render:({price:i})=>e.jsx(v,{justify:"flex-end",children:e.jsx(Q,{isLoaded:!l,children:e.jsxs(g,{color:"text_caption",children:["$",at(i)]})})})},{title:e.jsx(Le,{labelInfo:Pe.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"20%"},render:({balance_usd:i})=>e.jsx(v,{justify:"flex-end",children:e.jsx(Q,{isLoaded:!l,children:e.jsx(g,{color:"text_caption",children:ae(i,2)})})})},{title:e.jsx(g,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"18%"},key:"actions",render:i=>e.jsx($,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{a(i==null?void 0:i.coin_type)},children:"Swap"})}],Zs=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),ve=it(Zs);function ft(t){const{title:o,imgUrl:s}=t;return e.jsxs(v,{justify:"space-between",align:"flex-start",w:"100%",children:[e.jsxs(v,{children:[s&&e.jsx(Oe,{imageUrl:s,p:"4px",imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(g,{children:o})]}),"btnTitle"in t&&t.btnTitle?e.jsx($,{h:"32px",borderRadius:"8px",p:"8px",fontSize:"12px",onClick:t.onClick,fontWeight:"500",children:t.btnTitle}):e.jsx(N,{h:"32px"})]})}const Js={cetus:{title:"CETUS",imgUrl:W.cetus_coin.logo_url,bgUrl:"/images/cetus_holding_bg.png"},xcetus:{title:"xCETUS",imgUrl:W.x_cetus_coin.logo_url,bgUrl:"/images/xcetus_holding_bg.png"}};function jt({type:t,amount:o,amountUSD:s,isLoading:a,onClick:l,btnTitle:i,children:n}){const{title:r,imgUrl:c,bgUrl:x}=Js[t];return e.jsx(q,{flex:"1",bg:`right 0 bottom 60% / 86px 142px no-repeat url("${x}"), radial-gradient(40% 74% at 100% 100%,#1D342E 0%, rgba(22,27,48,0) 100%), rgba(0,0,0,0.5)`,backdropFilter:"blur(20px)",p:"16px",borderRadius:"16px",children:e.jsxs(A,{w:"100%",gap:"0",children:[e.jsx(ft,{title:`${r} Holdings`,imgUrl:c,onClick:l,btnTitle:i}),e.jsxs(A,{align:"flex-start",w:"100%",m:"31px 0 60px",children:[e.jsx(Q,{isLoaded:!a,h:"26px",children:e.jsx(g,{color:"text_caption",h:"26px",lineHeight:"26px",fontSize:"22px",children:o})}),e.jsx(Q,{isLoaded:!a,h:"17px",children:e.jsxs(g,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["Total ",r," (â‰ˆ $",at(s,2),")"]})})]}),n]})})}function en(){const{currentAccount:t}=U(),{balanceInfo:o}=Ts(W.cetus_coin),{getTokenAmountValue:s}=pe(),{coinPriceObj:a}=Ee(),l=p.useMemo(()=>s(W.cetus_coin.coin_type,se((o==null?void 0:o.balance)||"0",W.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,a]),{setCurrentXCetusTab:i,setIsXCetusModalOpen:n}=ve(),r=()=>{n(!0),i("Get xCETUS")},{veNFT:c,veNFTLoading:x,lockCetusListLoading:h}=J();return e.jsx(jt,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:l,isLoading:(h||x)&&c!==void 0,children:e.jsx($,{w:"100%",h:"48px",borderRadius:"12px",fontWeight:"500",fontSize:"16px",onClick:r,children:"Get xCETUS"})})}function tn(){const{lockCetusList:t,lockCetusListLoading:o}=J(),[s,a]=p.useState([]),[l,i]=p.useState(0),[n,r]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const x=(n-1)*c;(t==null?void 0:t.length)<=x&&r(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){i(t==null?void 0:t.length);const x=(n-1)*c,h=x+c;console.log("ðŸš€ ~ useEffect ~ start:",n,t.slice(0,h),x,h),(t==null?void 0:t.length)>x&&a(t.slice(x,h))}},[n,t]),console.log(t,"lockCetusList"),t&&t.length>0&&e.jsxs(q,{p:"0 16px 16px",w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:[e.jsx(_e,{type:"title",title:"Redeeming xCETUS"}),e.jsx(De,{orientation:"horizontal"}),e.jsx(Ce,{rowKey:"id",mt:"10px",dataSource:s,columns:sn(),loading:o,skeletonLength:t==null?void 0:t.length,rowStyle:{h:"80px"}}),(t==null?void 0:t.length)>c&&e.jsx(Z,{children:e.jsx(ye,{total:l,size:c,currentPage:n,onChange:x=>{r(x)}})})]})}const sn=()=>[{title:e.jsx(g,{children:"xCETUS To CETUS"}),key:"to",render:t=>e.jsx(hs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"})},{title:e.jsx(g,{textAlign:"right",children:"Vesting Duration (Day)"}),key:"lock_day",render:t=>e.jsx(g,{color:"text_caption",fontSize:"14px",children:t==null?void 0:t.lock_day})},{title:e.jsx(g,{textAlign:"right",children:"Available Claim Date"}),key:"date",render:t=>e.jsx(g,{color:"text_caption",fontSize:"14px",children:Tt.unix(t==null?void 0:t.locked_until_time).format("MMM D, YYYY HH:mm")})},{title:e.jsx(g,{textAlign:"right",children:"Action"}),key:"action",render:t=>e.jsx(nn,{order:t})}],nn=({order:t})=>{const[o,s]=p.useState(!1),{cancelOrderLoading:a,handleCancelOrder:l}=fs(),{claimOrderLoading:i,handleClaimOrder:n}=js(),r=c=>{c?n(t.id):l(t)};return p.useEffect(()=>{s(!lt.isLocked(t))},[t.id]),e.jsx(v,{justify:"flex-end",children:e.jsx($,{onClick:()=>{a||i||r(o)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:a||i,color:o?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:o?"Claim":"Cancel"})})};function on({cetusApr:t,myShare:o,totalRewardValue:s,nextStartTime:a,rewardList:l,summaryRewardList:i}){const{currentAccount:n}=U(),{days:r,hours:c,minutes:x,seconds:h}=ms((a||0)*1e3),{veNFTLoading:u}=J(),{claimRewardLoading:m,handleClaimReward:d}=bs(),b=()=>{m||d(l)};return V(),e.jsx(q,{flex:"1.46",p:"16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{w:"100%",gap:"0",children:[e.jsx(ft,{title:"Staking Rewards",onClick:b,btnTitle:F(s).gt(0)?"Claim":""}),e.jsxs(A,{m:"36px 0 50px",h:"57px",children:[e.jsxs(v,{children:[e.jsx(ge,{value:r,type:"d"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(ge,{value:c,type:"h"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(ge,{value:x,type:"m"}),e.jsx(g,{color:"text_caption",children:":"}),e.jsx(ge,{value:h,type:"s"})]}),e.jsx(g,{fontSize:"14px",h:"17px",lineHeight:"17px",children:"Reward Distribution In"})]}),e.jsxs(v,{justify:"space-between",w:"80%",mb:"12px",children:[e.jsx(Re,{title:"Est.APR",value:e.jsx(ws,{children:e.jsxs(g,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",cursor:"pointer",children:["â‰ˆ$",kt(t,2)]})}),loading:t==="0"}),e.jsx(De,{orientation:"vertical"}),e.jsx(Re,{title:"Your Share",value:o!=="--"?`â‰ˆ${o}`:o,loading:u}),e.jsx(De,{orientation:"vertical"}),e.jsx(Re,{title:"Pending Yield",value:n?e.jsx(re,{tooltip:e.jsx(A,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:i==null?void 0:i.map(y=>(console.log("ðŸš€ ~ {yieldList?.map ~ item:",y),e.jsxs(v,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(ut,{coinType:y.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(v,{gap:"4px",children:[e.jsx(g,{fontSize:"12px",color:"text_caption",children:Y(y==null?void 0:y.amount,6)}),e.jsxs(g,{fontSize:"12px",children:["(",ae(y==null?void 0:y.value,2),")"]})]})]},y.coin_type)))}),children:e.jsx(g,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",cursor:"pointer",children:ae(s,2)})}):"--",loading:u})]})]})})}const an={d:"D",h:"H",m:"M",s:"S"},ge=({value:t,type:o})=>e.jsxs(v,{borderRadius:"8px",bg:"background",p:"4px 8px",justify:"center",align:"flex-end",w:"64px",h:"32px",gap:"2px",children:[e.jsx(g,{color:"text_caption",fontSize:"20px",textAlign:"center",children:t}),e.jsx(g,{fontSize:"12px",mb:"1px",children:an[o]})]}),Re=({title:t,value:o,loading:s})=>e.jsxs(A,{gap:"3px",children:[e.jsx(Q,{isLoaded:!s,h:"17px",children:e.jsx(g,{color:"text_caption",fontSize:"14px",h:"17px",lineHeight:"1",children:o})}),e.jsx(g,{fontSize:"14px",h:"15px",lineHeight:"1",children:t})]});function ln({availableXCetusAmount:t,redeemingXCetusAmount:o}){const{currentAccount:s}=U(),{veNFT:a,veNFTLoading:l,lockCetusListLoading:i}=J(),{getTokenAmountValue:n}=pe(),{coinPriceObj:r}=Ee(),c=p.useMemo(()=>n(W.cetus_coin.coin_type,se((a==null?void 0:a.xcetus_balance)||"0",W.x_cetus_coin.decimals)).toString(),[a==null?void 0:a.xcetus_balance,s==null?void 0:s.address,r]),{setCurrentXCetusTab:x,setIsXCetusModalOpen:h}=ve(),u=()=>{h(!0),x("Redeem CETUS")},m=(i||l)&&a!==void 0;return e.jsx(jt,{type:"xcetus",amount:s?Y(se((a==null?void 0:a.xcetus_balance)||"0",9),9).toString():"--",amountUSD:c,onClick:u,btnTitle:"Redeem",isLoading:m,children:e.jsxs(A,{w:"100%",gap:"16px",h:"48px",children:[e.jsx(I,{isLoading:m,label:"Available",value:s?Y(se(t,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}}),e.jsx(I,{isLoading:m,label:"Redeeming",value:s?Y(se(o,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}})]})})}const he=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function rn({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:a,setCurrentXCetusTab:l}=ve(),[i,n]=p.useState("#icon-a-icon_trade"),r=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},x=()=>{var u;const h=(u=he==null?void 0:he.find(m=>(m==null?void 0:m.value)!==a))==null?void 0:u.value;h&&l(h)};return e.jsxs(Ye,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Qe,{}),e.jsxs(Ze,{children:[e.jsx(Je,{p:"0 16px",children:e.jsx(N,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(be,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:he,currentTab:a,handleChangeTab:h=>{l(h==null?void 0:h.value)}})})}),e.jsx(et,{}),e.jsxs(tt,{p:"20px 16px 16px",children:[a==="Get xCETUS"&&e.jsx(Cs,{onClose:o,availableXCetusAmount:s,onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}}),a==="Redeem CETUS"&&e.jsx(ys,{onClose:o,availableXCetusAmount:se(s,9),onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}})]})]})]})}function cn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=ve(),{availableXCetusAmount:s,redeemingXCetusAmount:a,cetusApr:l,myShare:i,totalRewardValue:n,nextStartTime:r,rewardList:c,summaryRewardList:x}=_s();return e.jsxs(A,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsx(on,{cetusApr:l,myShare:i,totalRewardValue:n,nextStartTime:r,rewardList:c,summaryRewardList:x}),e.jsx(ln,{availableXCetusAmount:s,redeemingXCetusAmount:a}),e.jsx(en,{})]}),e.jsx(tn,{}),t&&e.jsx(rn,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})}function dn(){const{currentAccount:t}=U(),{orderListLoading:o,myOrderList:s}=xe(),{isAutoRefresh:a,dcaOrderListLoading:l,dcaActiveOrderList:i}=ee(),{getTokenAmountValue:n,coinPriceObj:r}=pe(),c=p.useMemo(()=>{let u=F(0);if(a||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(m=>{const{pay_coin:d,target_coin:b,un_claimed_amount:y,remaining_amount:O}=m,S=n(d.coin_type,O),f=n(b.coin_type,y);u=F(u).plus(S).plus(f),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",u.toString())}),u.toString()):"0"},[a,s,t==null?void 0:t.address,o,r]),x=p.useMemo(()=>{let u=F(0);if(a||!l)return(i==null?void 0:i.length)>0&&(t!=null&&t.address)?(i.forEach(m=>{const{inBalance:d,inCoin:b,outBalance:y,outCoin:O}=m,S=n(b.coin_type,d),f=n(O.coin_type,y);u=F(u).plus(S).plus(f),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",u.toString())}),u):"0"},[a,i,t==null?void 0:t.address,l,r]),h=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",x,c),x&&c){let u=F(0);return u=F(u).plus(x).plus(c),u.toString()}return"--"},[x,c]);return{limitTotalTvl:c,dcaTotalTvl:x,orderTotalTvl:h}}function pn(){const{currentAccount:t}=U(),{isAutoRefresh:o}=ee(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=J(),{getTokenAmountValue:i}=pe(),{coinPriceObj:n}=Ee();return{xCetusTotalTvl:p.useMemo(()=>{if(o||!a&&!l)return t!=null&&t.address&&s?i(W.cetus_coin.coin_type,se(s==null?void 0:s.xcetus_balance,W.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,l,a,t==null?void 0:t.address,n])}}const xn="fetch-coin-holding-list",un="fetch-owner-nft",gn="fetch-active-order-list",hn="fetch-xcetus-base-info";function fn(){const{currentAccount:t}=U(),{getTokenListInfo:o}=xt(),{getLimitUserIndexer:s,getDcaUserIndexer:a}=Ss(),{setOrderListLoading:l,setMyOrderList:i}=xe(),{setDcaOrderListLoading:n,setDcaActiveOrderList:r,setDcaPastOrderList:c}=ee(),{refreshCoinPriceInfo:x}=Be(),{buildDcaOrderList:h}=Wt(),{peripherySdk:u}=we(),{formatLimitOrderList:m}=Jt(),d=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{d.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const b=async()=>{if(t){l(!0);const f=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",f),f)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(f)).data.map(k=>k.name.value)}catch(_){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",_)}}return[]},y=async()=>{if(t){n(!0);const f=await a(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",f),f)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(f)).data.map(k=>k.name.value)}catch(_){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",_)}}return[]};return{fetchActiveOrderList:async()=>{try{const f=await b(),_=await y(),T=await u.ClmmSDK.fullClient.batchGetObjects([...f,..._],{showType:!0,showContent:!0}),k=T.filter(w=>{var C,E;return(E=(C=w.data)==null?void 0:C.type)==null?void 0:E.includes("limit_order::LimitOrder")}),R=T.filter(w=>{var C,E;return(E=(C=w.data)==null?void 0:C.type)==null?void 0:E.includes("order::Order")}),D=k.map(w=>Lt.buildLimitOrderInfo(w)).filter(w=>w!==void 0).filter(w=>w.status===$e.PartialCompleted||w.status===$e.Running),j=R.map(w=>{var K,oe,ce,G,de,ie,ue,Ue;const C=je(((K=w.data)==null?void 0:K.type)||""),E=C.type_arguments[0],M=C.type_arguments[1];return{in_coin_type:E,out_coin_type:M,...(ce=(oe=w.data)==null?void 0:oe.content)==null?void 0:ce.fields,id:(ue=(ie=(de=(G=w.data)==null?void 0:G.content)==null?void 0:de.fields)==null?void 0:ie.id)==null?void 0:ue.id,version:(Ue=w.data)==null?void 0:Ue.version}}),P=new Set;for(const w of D)P.add(w.pay_coin_type),P.add(w.target_coin_type);for(const w of j)P.add(w.in_coin_type),P.add(w.out_coin_type);await o(Array.from(P));const z=await m(D);i(z);const{activeResult:B,pastResult:H}=await h(j);d.current===(t==null?void 0:t.address)&&(r(B),c(H),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",z),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",j)),x(Array.from(P))}catch(f){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",f)}finally{l(!1),n(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),i([]),r([]),c([])}}}function jn(){const{currentAccount:t}=U(),{clmmSdk:o}=rt(),{xCetusSdk:s}=we(),{buildFarmsPositionType:a,buildBurnPositionType:l}=ss(),{setPosBaseList:i,setFullRangePosBaseList:n,setPosBaseListLoading:r}=le(),{setVeNFT:c,setVeNFTLoading:x,setLockCetusList:h,clearData:u,setLockCetusListLoading:m}=J(),{formatPosBaseList:d}=pt(),b=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const S=b.current;if(S){r(!0),x(!0);const f=await o.fullClient.getOwnedObjectsByPage(S,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:W.clmm_sdk_options.clmm_pool.package_id},{StructType:a},{StructType:l},{StructType:ks},{StructType:Ls}]}});let _=await d(f);i(_),r(!1),(_==null?void 0:_.length)==0&&n([]);const T=Ps(f.data);if(T&&S===b.current){c(T,S);const k=await Rs(f.data,s);console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList:",k),h(k)}else m(!1);return{veNFT:T,posBaseList:_}}}catch(S){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",S),S instanceof TypeError&&(r(!1),i([]))}finally{r(!1),x(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{i([]),u()}}}function mn(){const{currentAccount:t}=U(),{peripherySdk:o}=we(),{clmmSdk:s}=rt(),{getPosRelatedData:a,getPositionBaseList:l}=pt(),{getPosPoolsOriginalObj:i,getPosPoolsRelatedData:n}=ns(),{getPosLiquidityData:r}=os(),{setPosLiquidityData:c,setFarmsPosRewardsData:x,setFarmsPosRewardsDataLoading:h,setPosRewardsData:u,setPosRewardsDataLoading:m,setPosFeeData:d,setPosFeeDataLoading:b}=le(),{formatFarmsRewardsData:y}=is(),{formatPosRewardsData:O}=as(),{formatPosFeeData:S}=ls(),{posBaseList:f,setShowPosListLength:_,setMyPosYieldValue:T}=le(),{refreshCoinPriceInfo:k}=Be(),R=async j=>{var H;const P=j.filter(w=>w.posType==="farms"&&w.farmsPool),z=await i(j);if(n(j,z),t!=null&&t.address){const w=await l(t==null?void 0:t.address);a(w)}if(((H=Object.keys(z))==null?void 0:H.length)===0)throw c({}),new Error("No pool data found");r(j,z);const B=new Pt;P.length>0&&P.forEach(w=>{o.Farms.buildCalculateFarmingReward({pool_id:w.farmsPool,position_nft_id:w.id},B)}),j.forEach(w=>{s.Rewarder.buildFetchPosFee({poolAddress:w.clmmPool,positionId:w.posId,coinTypeA:w.coinTypeA,coinTypeB:w.coinTypeB},B)}),j.filter(w=>w.posType!=="farms").forEach(w=>{const C=z[w.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:w.clmmPool,positionId:w.posId,coinTypeA:w.coinTypeA,coinTypeB:w.coinTypeB,rewarderInfo:C.rewarder_infos},B)});try{h(!0),m(!0),b(!0);const w=await s.fullClient.devInspectTransactionBlock({transactionBlock:B,sender:Rt("0x0")}),C=o.Farms.parsedPosRewardData(w),E=s.Rewarder.parsedPosRewardData(w),M=s.Rewarder.parsedPosFeeData(w);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:C,clmmRewardData:E,clmmFeeData:M});const K=await y(C);x(K);const oe=await O(Object.values(E).map(G=>{const de=z[j.find(ie=>ie.posId===G.position_id).clmmPool];return{poolAddress:de.pool_address,positionId:G.position_id,rewarderAmountOwed:G.rewarder_amount.map((ie,ue)=>({coin_address:de.rewarder_infos[ue].coinAddress,amount_owed:new Te(ie)}))}}));u(oe);const ce=await S(Object.values(M).map(G=>({position_id:G.position_id,feeOwedA:new Te(G.fee_owned_a),feeOwedB:new Te(G.fee_owned_b)})),j);d(ce),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:ce,posRewardsData:oe,posFarmsRewardsObj:K}),L(oe,K)}catch(w){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",w)}finally{h(!1),m(!1),b(!1)}},L=async(j,P)=>{const z=[];if(f.length>0){f.map(H=>{z.push(je(H==null?void 0:H.coinTypeA).full_address),z.push(je(H==null?void 0:H.coinTypeB).full_address);const w=j[H==null?void 0:H.posId]||[],C=P[H==null?void 0:H.id]||[],E=w.concat(C);E==null||E.map(M=>{var K;Dt(M==null?void 0:M.display_amount_owed).gt(0)&&z.push(je((K=M==null?void 0:M.token)==null?void 0:K.coin_type).full_address)})});const B=Array.from(new Set(z));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",B),k(B)}};return{fetchPosRelatedData:R,resetUserData:()=>{c({}),x({}),u({}),d({})}}}function bn(){const{currentAccount:t}=U(),{setXCetusManager:o,setDividendManager:s}=J(),{xCetusSdk:a}=we();return{fetchXCetusBaseInfo:async i=>{try{const{xcetus:n,xcetus_dividends:r}=W.xcetus_sdk_options,{dividend_manager_id:c}=We(r),{xcetus_manager_id:x}=We(n),h=await a.fullClient.batchGetObjects([x,c],{showType:!0,showContent:!0}),u=h.find(d=>{var b,y;return(y=(b=d.data)==null?void 0:b.type)==null?void 0:y.includes("xcetus::XcetusManager")});if(u){const d=Ne(u),b={id:d.id.id,index:Number(d.index),has_venft:{handle:d.has_venft.fields.id.id,size:d.has_venft.fields.size},nfts:{handle:d.nfts.fields.id.id,size:d.nfts.fields.size},total_locked:d.total_locked,treasury:d.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",b),o(b)}const m=h.find(d=>{var b,y;return(y=(b=d.data)==null?void 0:b.type)==null?void 0:y.includes("dividend::DividendManager")});if(m){const d=Ne(m),b=lt.buildDividendManager(d);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",b),a.XCetusModule.updateCache(`${c}_getDividendManager`,b),s(b)}}catch(n){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",n)}}}}function wn(t){const{currentAccount:o}=U(),{fetchCoinHoldingList:s,resetUserData:a}=ht(),{fetchPosRelatedData:l,resetUserData:i}=mn(),{fetchActiveOrderList:n,resetUserData:r}=fn(),{setAutoRefreshCount:c}=ee(),{fetchOwnerNFT:x,resetUserData:h}=jn(),{fetchXCetusBaseInfo:u}=bn(),{addTask:m,removeTask:d}=Os(),[b,y]=p.useState([]),O=p.useRef(o),{fetchOwnerLockCetusList:S}=Ds(),{setOrderListLoading:f}=xe(),{setLockCetusListLoading:_}=J(),{setPosBaseListLoading:T}=le(),{setIsCoinHoldingLoading:k}=Se(),R=()=>{a(),i(),r(),h()};p.useEffect(()=>{var H,w;o?((H=O.current)!=null&&H.address&&((w=O.current)==null?void 0:w.address)!==(o==null?void 0:o.address)&&(c(!1),R(),b.forEach(C=>{d(C.id)})),z()):(R(),b.forEach(C=>{d(C.id)})),O.current=o},[o==null?void 0:o.address]);const L={id:xn,run:s},D={id:un,run:x,onSuccess:H=>{const{veNFT:w,posBaseList:C}=H;l(C),w&&(o!=null&&o.address)&&S(o==null?void 0:o.address)}},j={id:hn,run:u},P={id:gn,run:n},z=()=>{const H=[];f(!0),_(!0),T(!0),k(!0),t==="wallet"?H.push(L,D,P,j):t==="liquidity"?H.push(D,L,P,j):t==="orders"?H.push(P,L,D,j):H.push(D,j,L,P),y(H),H.forEach(w=>{m(w)})};return{refreshTask:()=>{o&&(b.forEach(H=>{d(H.id)}),z())}}}const fe=t=>t?ae(t,2):"$--",Cn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),F(0)).toString();function vo(){const{tab:t}=us(),{currentAccount:o,onWalletModal:s}=U(),a=ze(),{posBaseListLoading:l,posLiquidityDataLoading:i}=le(),{holdingsTotalUsd:n,isCoinPriceLoading:r,isCoinHoldingLoading:c}=Se(),{clmmTotalTvl:x}=ps(),{orderTotalTvl:h}=dn(),{orderListLoading:u}=xe(),{isAutoRefresh:m,dcaOrderListLoading:d,setAutoRefreshCount:b,resetAutoRefreshCount:y}=ee(),{xCetusTotalTvl:O}=pn(),{lockCetusListLoading:S,veNFTLoading:f,veNFT:_}=J(),T=p.useMemo(()=>t||"wallet",[t]),{refreshTask:k}=wn(T),R=!m&&(c||r),L=!m&&(l||i),D=!m&&(u||d),j=!m&&(S||f),P=p.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",n,x,h,O),{wallet:{totalValue:fe(n),isLoading:R},liquidity:{totalValue:fe(x),isLoading:L},orders:{totalValue:fe(h),isLoading:D},xCetus:{totalValue:fe(O),isLoading:j}}),[n,x,h,O,R,L,D,j]),z=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],B=p.useMemo(()=>Cn(O,x,h,n),[O,x,h,n]);p.useEffect(()=>y(!1),[]);const[H,w]=p.useState(!1);p.useEffect(()=>{w(!0)},[]);const{isApp:C}=V();return C?e.jsx(As,{totalValue:B,onRefreshTask:k,isLoading:!m&&(f||l||u||d),children:e.jsx(Ge,{tabList:z,activeTab:T,tabData:P,onClickTab:E=>a(`/profile?tab=${E}`)})}):e.jsx(A,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:H?o!=null&&o.address?e.jsxs(A,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Ws,{handleRefresh:E=>{b(!E),k()},totalValue:B,isLoading:!m&&(f||l||u||d)}),e.jsx(Ge,{tabList:z,activeTab:T,tabData:P,onClickTab:E=>a(`/profile?tab=${E}`)}),T==="wallet"&&e.jsx(Qs,{}),T==="liquidity"&&e.jsx(Ns,{}),T==="orders"&&e.jsx($s,{}),T==="xCetus"&&e.jsx(cn,{})]}):e.jsx(ne,{type:"nowallet",mt:"20px",onboard:()=>s(!0)}):e.jsx(Ie,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(He,{})})})}export{vo as default};
//# sourceMappingURL=Profile-D7gpqxEp.js.map

import{a as m,j as t,X as ue,Y as fe,Z as xe,$ as me,a8 as pe,a0 as he,a1 as Ce,V as B,H as X,T as A,v as ee,f as oe,a2 as be,a3 as ge,a4 as Se,a5 as Te}from"./vendor-C6OgHlW5.js";import{u as N}from"./useTransaction-DmUGgHnq.js";import{j as P,k as L,as as R,w as M,d as Z,t as J,C as Q,M as Y,p as ne,i as we,B as se,am as ae,a as ye,c as K,v as ve,n as Ie,aZ as ke,a_ as je,aR as Me,al as De,a0 as q,aK as Re}from"./index-BcaB9c-7.js";import{M as V}from"./msafe-oYBkW7LJ.js";import{u as F}from"./useAccountBalance-C2pgGwpm.js";import{u as re}from"./useTokenBalance-B7qMGQH9.js";import{u as W,d as ie,e as _e,f as Oe,g as Ae}from"./useXCetusHelper-CKgvisOr.js";import{T as ce}from"./TradeInputGroup-CImutm3p.js";import{H as Pe}from"./HTextLabelBox-BylzsszM.js";import{C as Le}from"./CheckBox-DsmyCmYu.js";import{H as Ue}from"./HighlightText-DidJZTw1.js";import{u as Ee}from"./activeOrders-CFOVuO72.js";const tt=(d,r,s="seconds")=>{const o=()=>{const n=d-new Date().getTime();if(n<=0)return{years:0,months:0,days:0,hours:0,minutes:0,seconds:0};const f=Math.floor(n/1e3%60),c=Math.floor(n/1e3/60%60),e=Math.floor(n/(1e3*60*60)%24),u=Math.floor(n/(1e3*60*60*24)%30),h=Math.floor(n/(1e3*60*60*24*30)%12),g=Math.floor(n/(1e3*60*60*24*365));return s==="days"?{years:0,months:0,days:u+h*30+g*365,hours:e,minutes:c,seconds:f}:s==="months"?{years:0,months:h+g*12,days:u,hours:e,minutes:c,seconds:f}:{years:g,months:h,days:u,hours:e,minutes:c,seconds:f}},[l,a]=m.useState(o());return m.useEffect(()=>{const i=setInterval(()=>{const n=o();a(n),n.years===0&&n.months===0&&n.days===0&&n.hours===0&&n.minutes===0&&n.seconds===0&&(clearInterval(i),r&&r())},1e3);return()=>clearInterval(i)},[d]),l};function Xe(){const{fetchAccountBalance:d}=F(),{signAndExecuteTransaction:r}=N(),{currentAccount:s}=P(),{fetchOwnerVeNFT:o}=W(),{xCetusSdk:l}=L(),{veNFT:a}=R(),[i,n]=m.useState(""),[f,c]=m.useState(""),{balanceInfo:e}=re(M.cetus_coin),u=x=>{n(x),c(x)},[h,g]=m.useState(!1),w=async()=>{try{g(!0);const x={venft_id:a==null?void 0:a.id,amount:J(i,9).toFixed(0)},v=await l.XCetusModule.convertPayload(x),b=await r(v,{getShowInfo:_=>{const I=`Converting ${Q(i)} CETUS to ${Q(i)} xCETUS`,y={modalTitleText:"Convert",modalDescriptionText:I,toastDescriptionContent:I};if(_==="success"){const O=I.replace("Converting","Converted");y.modalDescriptionText=O,y.toastDescriptionContent=O}return y}},{msafeParams:{action:V.xCETUSConvert,txbParams:x}});g(!1),b&&(s&&o(s==null?void 0:s.address,!0),n(""),c(""),setTimeout(()=>{d()},2e3))}catch{g(!1)}},T=m.useMemo(()=>{const x={text:"Convert",disabled:!1};return s!=null&&s.address?+i?(+i&&Z(i).gt((e==null?void 0:e.balanceFormat)||0)&&(x.disabled=!0,x.text="Insufficient CETUS Balance"),x):(x.text="Enter an amount",x.disabled=!0,x):(x.text="Connect Wallet",x.disabled=!1,x)},[e==null?void 0:e.balanceFormat,s==null?void 0:s.address,i]);return{inputAmountFrom:i,inputAmountTo:f,handleInputChange:u,balanceInfoFrom:e,convertLoading:h,btnText:T.text,btnDisabled:T.disabled,handleConvertClick:w}}function le(d){const{isOpen:r,onClose:s,onSubmitClick:o}=d,{setShowConvertModel:l}=R(),[a,i]=m.useState(!1);return t.jsxs(ue,{autoFocus:!1,returnFocusOnClose:!1,isOpen:r,onClose:s,isCentered:!0,children:[t.jsx(fe,{}),t.jsxs(xe,{children:[t.jsx(me,{children:t.jsx(pe,{fontWeight:"500",fontSize:"16px"})}),t.jsx(he,{}),t.jsx(Ce,{textAlign:"center",p:"0px",children:t.jsxs(B,{w:"100%",gap:"20px",p:"20px",pb:"90px",pos:"relative",children:[t.jsx(Ue,{text_color:"text_caption",text_size:"14px",text:` Please note that after conversion, if you want to convert xCETUS back to CETUS, a vesting period will be applied & different vesting
              durations correspond to different redeem ratios. Learn more`,keywords:["Learn more"],onKeywordClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")}}),t.jsxs(X,{children:[t.jsx(Le,{checked:a,onClick:()=>{i(!a)}}),t.jsx(A,{color:"text_caption",children:"Do not remind again."})]}),t.jsx(ee,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{l(!a),o()},children:"Convert"})]})})]})]})}function nt(d){const{availableXCetusAmount:r,iconParams:s,onIconClick:o,onClose:l}=d,{currentAccount:a,onWalletModal:i}=P(),{inputAmountFrom:n,inputAmountTo:f,handleInputChange:c,balanceInfoFrom:e,btnText:u,btnDisabled:h,handleConvertClick:g,convertLoading:w}=Xe(),{showConvertModel:T}=R(),[x,v]=m.useState(!1);return t.jsxs(B,{w:"100%",gap:"8px",children:[t.jsx(ce,{onClick:o,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:(e==null?void 0:e.balanceFormat)||"",value:n,amountValue:"",loading:!1,onChange:b=>{c(b)},selectable:!1,placeholder:"0.0",token:M.cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:Y(r,9),value:f,half:!1,max:!1,amountValue:"",onChange:b=>{c(b)},selectable:!1,placeholder:"0.0",token:M.x_cetus_coin},iconParams:s}),t.jsx(ee,{w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:h||w,isLoading:w,onClick:()=>{console.log(a,T,"showConvertModel"),a?T?v(!0):g().then(()=>{l&&l()}):i(!0)},children:u}),x&&t.jsx(le,{isOpen:x,onClose:()=>{v(!1)},onSubmitClick:()=>{v(!1),g().then(()=>{l&&l()})}})]})}function Fe(d){const{fetchAccountBalance:r}=F(),{signAndExecuteTransaction:s}=N(),{currentAccount:o}=P(),{fetchOwnerVeNFT:l}=W(),{xCetusSdk:a}=L(),{veNFT:i}=R(),[n,f]=m.useState(""),[c,e]=m.useState(""),[u,h]=m.useState(180),[g,w]=m.useState(""),[T,x]=m.useState(!0),{balanceInfo:v}=re(M.cetus_coin),b=(p,D)=>{x(D),D?f(p):e(p),I(p,D,u)},_=p=>{h(p),I(T?n:c,T,p)},I=async(p,D,U)=>{if(+p){const E=J(p,9);if(D){const k=await a.XCetusModule.redeemNum(E,U);e(Y(k.amount_out,9)),w(Z(k.percent).mul(100).toFixed(2,ne.ROUND_DOWN))}else{const k=await a.XCetusModule.reverseRedeemNum(E,U);f(Y(k.amount_out,9)),w(Z(k.percent).mul(100).toFixed(2,ne.ROUND_DOWN))}}else f(""),e(""),w("")},[y,O]=m.useState(!1),H=async()=>{if(!i)return;O(!0);const p={venft_id:i.id,amount:J(n,9).toFixed(0),lock_day:u},D=a.XCetusModule.redeemLockPayload(p),U=await s(D,{getShowInfo:E=>{const k=`Redeeming ${Q(n)} xCETUS to ${Q(c)} CETUS`,j={modalTitleText:"Redeem",modalDescriptionText:k,toastDescriptionContent:k};if(E==="success"){const $=k.replace("Redeeming","Redeemed");j.modalDescriptionText=$,j.toastDescriptionContent=$}return j}},{msafeParams:{action:V.xCETUSRedeemLock,txbParams:p}});O(!1),U&&(o&&l(o==null?void 0:o.address,!0),f(""),e(""),r())},G=m.useMemo(()=>{const p={text:"Redeem",disabled:!1};return o!=null&&o.address?+n?(+n&&Z(n).gt(d||0)&&(p.disabled=!0,p.text="Insufficient xCETUS Balance"),p):(p.text="Enter an amount",p.disabled=!0,p):(p.text="Connect Wallet",p.disabled=!1,p)},[d,o==null?void 0:o.address,n]);return{inputAmountFrom:n,inputAmountTo:c,handleInputChange:b,balanceInfoTo:v,convertLoading:y,btnText:G.text,btnDisabled:G.disabled,handleConvertClick:H,day:u,handleDayChange:_,percent:g}}function Be(d){const{day:r,onChange:s}=d,o=m.useMemo(()=>`${r}D`,[r]),l=[{label:"15D"},{label:"30D"},{label:"90D"},{label:"180D"}];return t.jsxs(oe,{children:[t.jsxs(X,{w:"100%",justifyContent:"space-between",m:"10px 0",children:[t.jsxs(A,{fontSize:"16px",color:"text_caption",whiteSpace:"nowrap",children:[r," Days"]}),t.jsx(we,{type:"outlineTab",tabList:l,currentTab:o,handleChangeTab:a=>{a.label==="MAX"?s(100):s(a.label.replace("D",""))},wrapStyle:{flex:"1",maxW:"300px",h:"32px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),t.jsxs(be,{"aria-label":"slider-ex-1",min:15,max:180,focusThumbOnChange:!1,value:Number(r),onChange:a=>s(a),children:[t.jsx(ge,{h:"8px",children:t.jsx(Se,{h:"4px"})}),t.jsx(Te,{})]})]})}function st(d){const{availableXCetusAmount:r,iconParams:s,onIconClick:o,onClose:l}=d,{currentAccount:a,onWalletModal:i}=P(),{inputAmountFrom:n,inputAmountTo:f,handleInputChange:c,balanceInfoTo:e,btnText:u,btnDisabled:h,handleConvertClick:g,day:w,handleDayChange:T,percent:x,convertLoading:v}=Fe(r),{showConvertModel:b}=R(),[_,I]=m.useState(!1);return t.jsxs(B,{w:"100%",gap:"8px",children:[t.jsx(ce,{onClick:o,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:r,value:n,amountValue:"",loading:!1,onChange:y=>{c(y,!0)},selectable:!1,placeholder:"0.0",token:M.x_cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:(e==null?void 0:e.balanceFormat)||"",value:f,half:!1,max:!1,amountValue:"",onChange:y=>{c(y,!1)},selectable:!1,placeholder:"0.0",token:M.cetus_coin},iconParams:s}),t.jsxs(se,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[t.jsx(A,{mb:"16px",color:"primary_gray",children:"Vesting duration"}),t.jsx(Be,{day:w,onChange:y=>{T(Number(y))}})]}),t.jsx(se,{borderRadius:"12px",p:"0px",border:"none",children:t.jsxs(B,{w:"100%",gap:"20px",children:[t.jsx(ee,{mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:h||v,isLoading:v,onClick:()=>{a?b?I(!0):g().then(()=>{l&&l()}):i(!0)},children:u}),+x&&t.jsx(X,{w:"100%",p:"34px 16px 20px",border:"1px solid",borderColor:"border",mt:"-34px",borderRadius:"12px",children:t.jsx(Pe,{label:"Redeem ratio",labelStyle:{fontSize:"14px"},value:ae(x),valueStyle:{fontSize:"14px"}})})]})}),_&&t.jsx(le,{isOpen:_,onClose:()=>{I(!1)},onSubmitClick:()=>{I(!1),g().then(()=>{l&&l()})}})]})}function ot(){const{fetchAccountBalance:d}=F(),{signAndExecuteTransaction:r}=N(),{xCetusSdk:s}=L(),{veNFT:o}=R(),{fetchOwnerVeNFT:l}=W(),{currentAccount:a}=P(),[i,n]=m.useState(!1);return{handleCancelOrder:async c=>{if(!o)return;n(!0);const e={venft_id:o.id,lock_id:c.id},u=s.XCetusModule.cancelRedeemPayload(e),h=await r(u,{},{msafeParams:{action:V.xCETUSCancelRedeem,txbParams:e}});n(!1),h&&(d(),a&&l(a==null?void 0:a.address,!0))},cancelOrderLoading:i}}function at(){const{fetchAccountBalance:d}=F(),{signAndExecuteTransaction:r}=N(),{xCetusSdk:s}=L(),{veNFT:o}=R(),{fetchOwnerVeNFT:l}=W(),{currentAccount:a}=P(),[i,n]=m.useState(!1);return{handleClaimOrder:async c=>{if(n(!0),!o)return;const e={lock_id:c,venft_id:o.id},u=await s.XCetusModule.redeemPayload(e),h=await r(u,{},{useDevInspect:!1,msafeParams:{action:V.xCETUSRedeem,txbParams:e}});n(!1),h&&setTimeout(()=>{d(),a&&l(a==null?void 0:a.address,!0)},2e3)},claimOrderLoading:i}}function rt({xcetus_amount:d,cetus_amount:r,imageSize:s="24px"}){const{isApp:o}=ye();return o?t.jsxs(B,{w:"100%",align:"center",gap:"8px",children:[t.jsxs(X,{children:[t.jsx(K,{imageUrl:M.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:s,h:s,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),t.jsx(z,{amount:d,token:"xCETUS"})]}),t.jsx(A,{color:"text_caption",transform:"rotate(90deg)",children:"→"}),t.jsxs(X,{children:[t.jsx(K,{imageUrl:M.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:s,h:s,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),t.jsx(z,{amount:r,token:"CETUS"})]})]}):t.jsxs(X,{children:[t.jsx(K,{imageUrl:M.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:s,h:s,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),t.jsx(z,{amount:d,token:"xCETUS"}),t.jsx(A,{color:"text_caption",children:" →"}),t.jsx(K,{imageUrl:M.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:s,h:s,bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),t.jsx(z,{amount:r,token:"CETUS"})]})}const z=({amount:d,token:r})=>t.jsxs(oe,{as:"div",children:[t.jsxs(A,{as:"span",color:"text_caption",children:[ve(Y(d,9),9)," "]}),t.jsx(A,{as:"span",color:"text_paragraph",children:r})]});function it(){const{fetchAccountBalance:d}=F(),{signAndExecuteTransaction:r}=N(),{xCetusSdk:s}=L(),{veNFT:o}=R(),[l,a]=m.useState(!1),{fetchVeNFTDividendInfo:i}=ie();return{handleClaimReward:async f=>{if(o){a(!0),console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:23 ~ handleClaimReward ~ rewardList:",f);try{const c=s.XCetusModule.redeemDividendV3Payload(o.id,f),e=await r(c,{},{useDevInspect:!0,msafeParams:{action:V.xCETUSClaimStakingRwewards,txbParams:{veNftId:o.id,rewardList:f}}});a(!1),e&&setTimeout(()=>{d(),i(o.id)},2e3)}catch(c){console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:40 ~ handleClaimReward ~ error:",c)}finally{a(!1)}}},claimRewardLoading:l}}function Ne(){const{getTokenPrice:d,fetchTokenPrices:r}=Ie();return{refreshCoinPriceInfo:async(o,l=!1,a=!1)=>{const i=new Set;a||o.forEach(n=>{const f=d(n,6e4);f?l&&!f.price_change&&i.add(n):i.add(n)}),console.log("🚀 ~ refreshCoinPriceInfo ~ notFetchCoinList:",{notFetchCoinList:i,coinTypeList:o}),i.size>0&&await r(Array.from(i),!0,!1)}}}function ct(){const{limitUserIndexerObj:d,setLimitUserIndexerObj:r,dcaUserIndexerObj:s,setDcaUserIndexerObj:o}=Ee(),{peripherySdk:l}=L();return{getLimitUserIndexer:async n=>{const f=d[n];if(f)return f;try{const c=new Me;l.LimitOrder.buildGetUserIndexerHandle(n,c);const e=await l.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:De("0x0")}),u=l.LimitOrder.parsedQueryUserIndexerEvent(e);if(u)return r(n,u),u}catch(c){throw console.log("🚀 ~ getLimitUserIndexer ~ error:",c),c}},getDcaUserIndexer:async n=>{const f=s[n];if(f)return f;try{const{dca:c}=l.sdkOptions,{user_indexer_id:e}=ke(c),u=await l.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:n}}),h=je(u).value.fields.id.id;if(h)return o(n,h),h}catch(c){throw console.log("🚀 ~ getDcaUserIndexer ~ error:",c),c}}}}function lt(d=!1){const{xCetusSdk:r}=L(),{currentAccount:s}=P(),{fetchAccountBalance:o}=F(),{refreshCoinPriceInfo:l}=Ne(),{lockCetusList:a,veNFTLoading:i,lockCetusListLoading:n,clearData:f,owner:c,veNFT:e,XCetusManager:u,setXCetusManager:h,setDividendManager:g,setPhaseDividendInfoMap:w,phaseDividendInfoMap:T,availableXCetusAmount:x}=R(),{nextStartTime:v,currentPeriod:b,calculateCurrPeriod:_}=_e(),{summaryRewardList:I,rewardList:y,totalRewardValue:O}=Oe(b),{fetchVeNFTDividendInfo:H}=ie(),G=async C=>{try{const S=await r.XCetusModule.getXcetusManager(C);S&&h(S)}catch(S){console.log("🚀 ~ fetchXCetusManager ~ error:",S)}},p=async C=>{try{const S=await r.XCetusModule.getPhaseDividendInfo(C.toString());if(S)w(S);else{const de=(C-1).toString();if(!T[de]){const te=await r.XCetusModule.getPhaseDividendInfo(C.toString());te&&w(te)}}}catch(S){console.log("🚀 ~ fetchXCetusManager ~ error:",S)}},D=async C=>{try{const S=await r.XCetusModule.getDividendManager(C);S&&g(S)}catch(S){console.log("🚀 ~ fetchXCetusManager ~ error:",S)}},{fetchOwnerVeNFT:U}=W(),E=m.useMemo(()=>{if(e){const C=q(e.xcetus_balance).sub(x);if(C.gte(0))return C.toFixed(0)}return"0"},[e==null?void 0:e.xcetus_balance]),k=m.useMemo(()=>{if(u&&e){const C=q(e.xcetus_balance).div(u.treasury).mul(100);return q(C).lt(.01)?"<0.01%":ae(C.toString(),3)}return s?"0%":"--"},[u==null?void 0:u.treasury,e==null?void 0:e.xcetus_balance]),j=m.useMemo(()=>{if(b){let C=T[b.toString()];return C===void 0&&(C=T[(b-1).toString()]),C}},[T,b]),{cetusApr:$}=Ae(j,u==null?void 0:u.treasury);return m.useEffect(()=>{if(j){const C=j.bonus_types.map(S=>Re(S,!1));C&&(C.push("0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),l(C))}},[j==null?void 0:j.id]),m.useEffect(()=>{b&&b>0&&p(b)},[b]),m.useEffect(()=>{e&&!d&&H(e.id)},[e==null?void 0:e.id]),{fetchOwnerVeNFT:U,fetchAccountBalance:o,fetchXCetusManager:G,fetchDividendManager:D,fetchVeNFTDividendInfo:H,veNFTLoading:i,lockCetusListLoading:n,redeemingXCetusAmount:E,availableXCetusAmount:x,veNFT:e,myShare:k,nextStartTime:v,cetusApr:$,summaryRewardList:I,rewardList:y,totalRewardValue:O,lockCetusList:a,calculateCurrPeriod:_}}export{nt as C,rt as X,ot as a,at as b,it as c,lt as d,st as e,Ne as f,ct as g,tt as u};
//# sourceMappingURL=useXCetus-DAKDumuS.js.map

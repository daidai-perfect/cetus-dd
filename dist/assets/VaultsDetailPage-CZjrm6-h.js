import{r as o,d as f,j as t,ar as Le,V as W,T as S,S as qe,H as C,bH as Ge,Y as E,a6 as Ye,B as Je,an as wt,C as $e,b as st,W as ce,bp as _t,g as de,aA as pe,as as ie,m as Te,aO as Ke,I as Ct,bk as je,br as Rt,ad as Pt,ae as zt,af as Dt,ag as Mt,ah as Lt,ai as Wt,aj as $t,a0 as rt,$ as Qe,a4 as it,R as ot,a7 as lt,aJ as ae,bI as We,a8 as Re,bJ as ve,aS as Fe,a1 as Oe,k as nt,e as Tt,bd as Ft,a_ as Et}from"./index-D49RffYW.js";import{S as Ot}from"./Slippage-C-5lq2_6.js";import{d as Ut,b as at,e as ct,f as he,g as ut,h as pt,i as Be,C as Ie,u as Ht,c as At}from"./useGetVaultList-DkTetwjT.js";import{R as Nt}from"./RefreshButton-C1kwCG7k.js";import{u as qt}from"./useAccountBalance-D-weOZgA.js";import{H as oe}from"./HTextLabelBox-DVxTk_Ir.js";import{V as me}from"./VTextLabelBox-hTKeBwlM.js";import{i as Gt}from"./icon_currentprice@2x-DeObnx8l.js";import{T as Yt}from"./TradeConfirmAmountInfo-BVFeG-79.js";import{u as Xe}from"./global-iZ7St_zm.js";import{M as xt}from"./msafe-oYBkW7LJ.js";import{u as ke}from"./useTokenBalance-Cc02jFZo.js";import{u as dt}from"./useTransaction-i5gFyneH.js";import{v as Ee}from"./index-BzKWeyUu.js";import{T as mt}from"./TradeInputGroup-C7m7R_Tz.js";import{P as Jt}from"./progress-C8tpxWAq.js";import{A as et}from"./AddressCopyLink-BnCAac35.js";import{C as tt}from"./CetusTooltip-7TnGbJNH.js";import{P as Kt}from"./RemoveBlock-Brnm7DVB.js";import{u as Qt}from"./useFindBestRouting-Bo95_EUn.js";import"./TooltipIcon-BGEWyiwk.js";import"./switch-Dw_sCPfe.js";import"./useGetPoolList-DBJielhS.js";import"./api-data-utils-D656F-wl.js";import"./useToken-BlS8b5ft.js";import"./_getAllKeysIn-Caqnu8Ck.js";import"./progress.utils-4THQPte7.js";import"./AddressUnderline-CPGiMg8E.js";import"./LockInput-D8hYvbJh.js";import"./icon_lock@2x-OdzkPjmc.js";import"./usePositionList-CyCzZNts.js";import"./useCurrentPos-CwMCqO3d.js";import"./usePosAdd-vnaoQeks.js";import"./useInsufficientBalanceToast-oZJ3kO4O.js";import"./index-BVFwDyvF.js";import"./ExpendItem-Dexzs6Wu.js";import"./SingleTokenInfo-Cvcahm1q.js";import"./PriceRange-BFhvNGCl.js";import"./PositionStatus-Cy2qCSNc.js";import"./RangeValue-B6IVaqEN.js";import"./RangeAlerts-CxanDQq5.js";import"./useNotifiSubscription-CuqMrTBs.js";import"./useXCetusHelper-wuRv4yeo.js";import"./useSwapHelper-CKwapxYx.js";function Xt(a){const{displayMaxPrice:i,displayMinPrice:e,displayPrice:r,isLoading:s}=a,[x,l]=o.useState(0),n=o.useRef(null);o.useEffect(()=>{const p=()=>{n.current&&l(n.current.offsetWidth)};p();const c=new ResizeObserver(p);return n.current&&c.observe(n.current),()=>{n.current&&c.unobserve(n.current)}},[]);const d=o.useMemo(()=>{if(i==="∞")return"center";if(r&&e&&i){if(f(r).greaterThanOrEqualTo(i))return"end";if(f(e).greaterThanOrEqualTo(r))return"start"}return"center"},[r,e,i]),u=o.useMemo(()=>{if(i==="∞")return"0px";if(r&&e&&i&&f(r).lessThanOrEqualTo(i)&&f(r).greaterThanOrEqualTo(e)){const p=f(i).add(e).div(2),c=f(r).gt(p);let b=f(0);if(c){const g=f(p).sub(e);b=f(r).sub(p).div(g)}else{const g=f(i).sub(p);b=f(r).sub(e).div(g)}return c?`${f(x).mul(b).toFixed(0)}px`:`-${f(x).mul(f(1).sub(b)).toFixed(0)}px`}return"0px"},[r,e,i,x]);return t.jsxs(Le,{w:"100%",direction:"column",alignItems:d,children:[t.jsxs(W,{w:{md:"100%",lg:"max-content"},justifyContent:"center",mb:"-22px",gap:"8px",ml:u,children:[t.jsxs(W,{p:"6px 24px",borderRadius:"8px",bg:"bg_secondary",gap:"4px",children:[t.jsx(S,{fontSize:"xs",h:"14px",children:"Current Price"}),s?t.jsx(Le,{h:"18px",align:"center",children:t.jsx(qe,{})}):t.jsx(C,{children:t.jsx(S,{fontSize:"16px",color:"text_highlight",children:t.jsx(Ge,{value:E(r,6,!0,Ye.ROUND_DOWN)})})})]}),d==="center"&&t.jsxs(W,{zIndex:"100",children:[t.jsx(Je,{w:"2px",h:"98px",bg:"#76C8FF"}),t.jsx(wt,{src:Gt,w:"30px",h:"30px",mt:"-18px"})]}),d!=="center"&&t.jsx(Je,{h:"25px"})]}),t.jsx($e,{zIndex:"99",mt:"-48px",ref:n,pl:"60px",pr:"60px",h:"50px",w:"90%",bg:"linear-gradient( 180deg, rgba(22,22,22,0) 0%, #191919 100%)",borderBottom:"1px solid",borderBottomColor:"border",children:t.jsx($e,{w:"100%",h:"48px",bg:"linear-gradient( 180deg, rgba(22,22,22,0) 0%, #1A5780 100%)"})}),t.jsxs(C,{justifyContent:"space-between",pl:{md:"0",lg:"14px"},pr:"2px",mt:"8px",w:"90%",children:[t.jsxs(W,{pl:"16px",pr:"16px",pt:"5px",pb:"5px",borderRadius:"8px",bg:"bg_secondary",gap:"6px",maxW:{md:"48%",lg:"auto"},children:[t.jsx(S,{fontSize:"12px",children:"Min Price"}),s?t.jsx(Le,{h:"18px",align:"center",children:t.jsx(qe,{})}):t.jsx(S,{fontSize:"14px",fontWeight:"500",color:"text_caption",maxW:{md:"100%",lg:"auto"},children:t.jsx(Ge,{value:E(e,6,!0,Ye.ROUND_DOWN)})})]}),t.jsxs(W,{pl:"16px",pr:"24px",pt:"5px",pb:"5px",borderRadius:"8px",bg:"bg_secondary",gap:"6px",maxW:{md:"48%",lg:"auto"},children:[t.jsx(S,{fontSize:"12px",children:"Max Price"}),s?t.jsx(Le,{h:"18px",align:"center",children:t.jsx(qe,{})}):t.jsx(S,{fontSize:"14px",fontWeight:"500",color:"text_caption",maxW:{md:"100%",lg:"auto"},children:t.jsx(Ge,{value:E(i,6,!0,Ye.ROUND_DOWN)})})]})]})]})}function Zt(a){const{getVaultList:i,getVaultListFromCache:e}=Ut(),[r,s]=o.useState(void 0),[x,l]=o.useState(!1),n=async(u,p)=>{var g;(r===void 0||p)&&l(!0);const c=await i({sortRule:"desc",sortType:"apr"}),b=((g=c==null?void 0:c.filter(w=>w.vaultsId===u))==null?void 0:g[0])||null;return l(!0),b&&s(b),b},d=u=>{var b;const p=e({sortRule:"desc",sortType:"apr"});return((b=p==null?void 0:p.filter(g=>g.vaultsId===u))==null?void 0:b[0])||null};return o.useEffect(()=>{if(a){const u=d(a);u&&s(u),n(a,!1)}},[a]),{vaultInfoLoading:x,apiVaultInfo:r,getApiVaultInfo:n}}function Vt(a){const{holdCoinAmounts:i,lpLogoUrl:e,displayTokenA:r,displayTokenB:s,sharePoolRate:x,balanceInfo:l,totalValue:n,isReverse:d,holdCoinAValue:u,holdCoinBValue:p,rewardPerA:c,rewardPerB:b}=a,g=o.useMemo(()=>d?p:u,[d,u,p]),w=o.useMemo(()=>d?u:p,[d,u,p]),{isApp:R}=st();return t.jsx(ce,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs(W,{w:"100%",gap:{base:"24px",lg:"8px"},children:[t.jsxs(C,{w:"100%",justifyContent:"space-between",children:[t.jsx(C,{children:t.jsx(S,{textAlign:"start",fontSize:"16px",color:"text_caption",children:"Your Liquidity"})}),t.jsxs(C,{gap:"8px",children:[t.jsx(S,{whiteSpace:"nowrap",children:"Your share of pool"}),t.jsx(S,{color:"text_highlight",fontWeight:"500",children:_t(x,6)})]})]}),R?t.jsxs(W,{w:"100%",gap:"16px",children:[t.jsx(oe,{label:"LP Token Balance",labelStyle:{fontSize:"13px"},value:t.jsxs(C,{children:[t.jsx(de,{imageUrl:e,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsxs(S,{color:"text_caption",ml:"4px",fontWeight:"500",fontSize:"13px",children:[E(l==null?void 0:l.balanceFormat,9)," LP"]})]}),subValue:t.jsx(S,{children:pe(n,2)}),subValueStyle:{fontSize:"13px"}}),t.jsx(oe,{label:ie(r==null?void 0:r.symbol,10),labelStyle:{fontSize:"13px"},value:t.jsxs(C,{children:[t.jsx(de,{imageUrl:r==null?void 0:r.logo_url,coinType:r==null?void 0:r.coin_type,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsx(S,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${E(i==null?void 0:i.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`})]}),subValue:pe(g,2),subValueStyle:{fontSize:"13px"}}),t.jsx(oe,{label:ie(s==null?void 0:s.symbol,10),labelStyle:{fontSize:"13px"},value:t.jsxs(C,{children:[t.jsx(de,{imageUrl:s==null?void 0:s.logo_url,coinType:s==null?void 0:s.coin_type,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsx(S,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${E(i==null?void 0:i.displayCoinB,6)} ${ie(s==null?void 0:s.symbol,10)}`})]}),subValue:pe(w,2),subValueStyle:{fontSize:"13px"}})]}):t.jsxs(t.Fragment,{children:[t.jsxs(Te,{flexDir:{base:"column",lg:"row"},mt:"16px",gap:{base:"8px",lg:"4px"},align:"center",children:[t.jsx(S,{children:"LP Token Balance"}),t.jsxs(S,{color:"text_caption",ml:"4px",fontWeight:"500",children:[E(l==null?void 0:l.balanceFormat,9)," LP"]}),t.jsx(S,{children:pe(n,2)})]}),t.jsxs(C,{w:{base:"100%",lg:"90%"},mt:"12px",justifyContent:"space-between",pos:"relative",bg:"linear-gradient(270deg, #0F0F0F 0%, #252525 50%, #0F0F0F 100%)",borderRadius:"69px",gap:"0",children:[t.jsxs(W,{flex:"1",h:"106px",justifyContent:"center",alignItems:"start",children:[t.jsxs(C,{children:[t.jsx(de,{imageUrl:r==null?void 0:r.logo_url,coinType:r==null?void 0:r.coin_type,imageStyle:{w:"28px",h:"28px"}}),t.jsx(S,{color:"text_caption",fontSize:"16px",fontWeight:"600",children:ie(r==null?void 0:r.symbol,10)})]}),t.jsx(me,{wrapStyle:{gap:"4px",w:"calc(100% - 60px)"},title:`${E(i==null?void 0:i.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500},value:pe(g,2),valueStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500}})]}),t.jsxs(W,{flex:"1",h:"106px",justifyContent:"center",alignItems:"end",children:[t.jsxs(C,{children:[t.jsx(S,{color:"text_caption",fontSize:"16px",fontWeight:"600",children:ie(s==null?void 0:s.symbol,10)}),t.jsx(de,{imageUrl:s==null?void 0:s.logo_url,coinType:s==null?void 0:s.coin_type,imageStyle:{w:"28px",h:"28px"}})]}),t.jsx(me,{wrapStyle:{gap:"4px",alignItems:"flex-end",w:"calc(100% - 60px)"},title:`${E(i==null?void 0:i.displayCoinB,6)} ${ie(s==null?void 0:s.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500},value:pe(w,2),valueStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500}})]}),t.jsx(ce,{pos:"absolute",left:"calc(50% - 52px)",w:"104px",h:"104px",borderRadius:"70px",p:"8px 0px",children:t.jsxs(W,{justify:"center",gap:"4px",children:[t.jsx(de,{imageUrl:e,imgBoxStyle:{w:"58px",h:"58px"}}),t.jsx(S,{color:"#8BAABE",fontSize:"12px",children:"Pooled Assets"})]})})]})]})]})})}function Bt(a){const{price:i,changeSide:e}=a;return{displayPrice:o.useMemo(()=>{if(i)return e?E(Ke(1).div(i).toString(),10,!0).toString():i},[i,e])}}function It(a){const{minPrice:i,maxPrice:e,changeSide:r}=a,s=o.useMemo(()=>{if(i&&e)return r?i==="0"||i==="∞"?"0":E(Ke(1).div(e).toString(),10,!0).toString():i},[i,e,r]),x=o.useMemo(()=>{if(i&&e)return r?e==="0"||e==="∞"?"∞":E(Ke(1).div(i).toString(),10,!0).toString():e},[i,e,r]);return{displayMinPrice:s,displayMaxPrice:x}}function kt(a){const[i,e]=o.useState(!1),{currentPrice:r,minPrice:s,maxPrice:x,displayTokenA:l,displayTokenB:n,isLoading:d,isReverse:u}=a,{displayPrice:p}=Bt({price:r,changeSide:i}),{displayMaxPrice:c,displayMinPrice:b}=It({minPrice:s,maxPrice:x,changeSide:i});o.useEffect(()=>{e(u)},[u]);const g=o.useMemo(()=>i?n:l,[l,n,i]);return t.jsx(ce,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs(W,{w:"100%",children:[t.jsxs(C,{w:"100%",justifyContent:"space-between",mb:"6px",children:[t.jsx(S,{fontSize:"16px",color:"text_caption",children:"Position Range"}),t.jsxs(C,{gap:"0px",children:[t.jsx(de,{imageUrl:g==null?void 0:g.logo_url,imageStyle:{w:"20px",h:"20px"}}),t.jsxs(S,{color:"text_caption",children:[" ",g==null?void 0:g.symbol]}),t.jsxs(C,{ml:"8px",gap:"4px",cursor:"pointer",onClick:()=>e(!i),children:[t.jsx(S,{fontSize:"12px",children:" Base coin"}),t.jsx(Ct,{xlinkHref:"#icon-icon_swap1"})]})]})]}),t.jsx(Xt,{displayPrice:p,displayMaxPrice:c,displayMinPrice:b})]})})}function ft(a){const{poolName:i,amountLimit:e,lpRate:r,inputTotalValue:s,preCalculateLoading:x}=a;return t.jsxs(W,{w:"100%",gap:"20px",children:[t.jsx(oe,{label:"Total Amount",labelStyle:{fontSize:"14px"},value:pe(s,2),valueStyle:{fontSize:"14px",h:"14px"},isLoading:x}),t.jsx(oe,{label:"Share of Pool",labelStyle:{fontSize:"14px"},value:r,isLoading:x,valueStyle:{fontSize:"14px",h:"14px"}}),t.jsx(oe,{label:"Minimum Received LP",labelStyle:{fontSize:"14px"},value:`${je(E(Rt(e||"0",9)).toString(),9)} ${i}`,valueStyle:{fontSize:"14px",h:"14px"},isLoading:x})]})}function es(a){const{isOpen:i,onClose:e,data:r,onSubmitClick:s}=a,{feeTier:x,displayTokenA:l,displayTokenB:n,displayAmountA:d,displayAmountB:u,totalAmountValue:p,sharePool:c,lpAmountLimit:b}=r;return t.jsxs(Pt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:i,onClose:e,isCentered:!0,children:[t.jsx(zt,{}),t.jsxs(Dt,{children:[t.jsx(Mt,{children:t.jsx(Lt,{fontWeight:"500",fontSize:"16px",children:"Deposit"})}),t.jsx(Wt,{}),t.jsx($t,{textAlign:"center",p:"0px",children:t.jsxs(W,{w:"100%",gap:"20px",p:"16px",pb:"0px",pos:"relative",children:[t.jsxs(C,{w:"100%",justifyContent:"space-between",children:[t.jsxs(C,{children:[t.jsx(rt,{coinAIconUrl:l==null?void 0:l.logo_url,coinBIconUrl:n==null?void 0:n.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),t.jsx(S,{fontSize:"16px",color:"text_caption",children:`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`})]}),t.jsx(ce,{w:"unset",p:"6px 8px",borderRadius:"12px",ml:"4px",children:t.jsxs(C,{children:[t.jsx(S,{children:"Fee Tier"}),t.jsx(S,{color:"primary",children:x})]})})]}),t.jsx(Yt,{coinA:{amount:d,...l},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},coinB:{amount:u,...n}}),t.jsx(ft,{amountLimit:b,inputTotalValue:p,preCalculateLoading:!1,lpRate:c,poolName:`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`}),t.jsx(Je,{h:"52px"}),t.jsx(Qe,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{s()},children:"Deposit"})]})})]})]})}function ts(a,i,e,r,s){const{fetchTokenPrices:x,getTokenAmountValue:l}=it(),{setDetailRefreshCount:n}=at(),{vaultsSdk:d}=ot(),{vaultsSlippage:u,mevProtect:p,maxCapForGas:c,transactionMode:b,customGasPrice:g}=Xe(),[w,R]=o.useState(""),[y,O]=o.useState(""),[z,$]=o.useState(!0),[_,D]=o.useState(""),U=o.useRef(""),M=o.useRef(!0),T=o.useRef(""),Q=o.useRef("");o.useEffect(()=>{U.current=_},[_]),o.useEffect(()=>{M.current=z},[z]),o.useEffect(()=>{T.current=w},[w]),o.useEffect(()=>{Q.current=y},[y]),o.useEffect(()=>{const h=[];r&&s&&(h.push(r.coin_type),h.push(s.coin_type)),h.length>0&&x(h)},[r==null?void 0:r.coin_type,s==null?void 0:s.coin_type]);const{balanceInfo:A}=ke(r),{balanceInfo:te}=ke(s),V=l(r==null?void 0:r.coin_type,w),X=l(s==null?void 0:s.coin_type,y),ue=o.useMemo(()=>f(V||"0").add(X||"0").toString(),[V,X]),[k,J]=o.useState(!1),[N,Z]=o.useState(void 0),q=lt(async(h,v,G)=>{if(r&&s&&e)try{J(!0),n(0);const I=Re(h,(v?r:s).decimals).toFixed(0),ne={vault_id:e,fix_amount_a:v,input_amount:I,slippage:Number(u),request_id:G,side:a==="both"?ve.Both:ve.OneSide},se=await d.Vaults.calculateDepositAmount(ne,!1,!0);U.current===G&&(a==="both"&&(v?+T.current?(O(ae(se.amount_b.toString(),s.decimals).toString()),Z(se)):O(""):+Q.current?(R(ae(se.amount_a.toString(),r.decimals).toString()),Z(se)):R("")),a!=="both"&&Z(se))}catch{Z(void 0)}finally{J(!1)}},500),L=(h,v,G=!0)=>{if($(v),v?(R(h),G&&O("")):(O(h),G&&R("")),+h){const Y=We.isSuiCoin(a);if(Y&&f(h).lt(3)){D(""),Z(void 0),J(!1);return}if(!Y){const ne=l(a,h);if(f(ne).gt(1e4)){D(""),Z(void 0),J(!1);return}}const I=Ee();D(I),a==="both"&&J(!0),q(h,v,I)}else Ce()},K=()=>{const h=M.current?T.current:Q.current;if(+h){const v=Ee();D(v),q(h,M.current,v)}};o.useEffect(()=>{Ce()},[a]);const[B,we]=o.useState(!1),{signAndExecuteTransaction:le,transactionConfirmation:ge,transactionRejected:xe}=dt(),_e=async()=>{if(e){we(!0);const h=Re(z?w:y,9),v={vault_id:e,side:a==="both"?ve.Both:ve.OneSide,fix_amount_a:z,input_amount:h.toString(),slippage:Number(u)},G={getShowInfo:(Y,I)=>{const ne="Deposit "+[he(w,r==null?void 0:r.symbol),he(y,s==null?void 0:s.symbol)].filter(Boolean).join(" and "),se={modalDescriptionText:ne,toastTitleText:ne};if(Y==="success"){let He=w,Pe=y;I&&(He=f(w).gt(0)?Fe(I,r)||w:"",Pe=f(y).gt(0)?Fe(I,s)||y:"");const ze="Deposit "+[he(He,r==null?void 0:r.symbol),he(Pe,s==null?void 0:s.symbol)].filter(Boolean).join(" and ");se.toastDescriptionContent=ze,se.modalDescriptionText=ze}return se}};try{await le(async()=>await d.Vaults.deposit(v),G,{useMev:p,txAction:"signTransactionBlock",useFastMode:b==="Fast Mode",maxCapForGas:c,customGasPrice:g,msafeParams:{action:xt.AddVaultsPosition,txbParams:v}})?(Ce(),i()):K()}catch{xe(G)}}},Ce=()=>{R(""),O(""),J(!1),Z(void 0),D("")},{stakeProtocolName:Ue}=ct(M.current?s==null?void 0:s.coin_type:r==null?void 0:r.coin_type),be=o.useMemo(()=>{if(a!=="both"&&r&&s){const h=M.current?w:y,v=M.current?r:s,G=M.current?s:r;if(N&&N.swap_result){const Y=ae(N.swap_result.swap_in_amount,v.decimals),I=ae(f(N.swap_result.swap_out_amount).mul(1-Number(u)).toString(),G.decimals);return We.isSuiCoin(v.coin_type)?`By depositing ${je(E(h,9).toString(),9)} SUI, ${je(E(Y,9).toString(),9)} SUI will be converted to ${G==null?void 0:G.symbol} via ${Ue} liquid staking and added to the pool together.`:`By depositing ${je(E(h,9).toString(),9)} ${v==null?void 0:v.symbol}, ${je(E(Y,9).toString(),9)} ${v==null?void 0:v.symbol} will be traded for ${je(E(I,9).toString(),9)} ${G==null?void 0:G.symbol} and then added to the pool together.`}else if(!We.isSuiCoin(a)){const Y=l(a,h);if(f(Y).gt(1e4))return"Single-asset deposit can't be higher than $10,000 at a time."}}},[a,N,w,y]);return{handleAmountInputChange:L,fixAmountA:z,amountInputA:w,amountInputB:y,balanceInfoA:A,balanceInfoB:te,amountValueA:V,amountValueB:X,preCalculateLoading:k,inputTotalValue:ue,calculateResult:N,showOnlySideTips:be,doAddAction:_e,reCalculateResult:K}}function gt(a,i,e,r,s,x,l,n,d){const{currentAccount:u}=Oe(),p=o.useMemo(()=>{const c={text:void 0,disabled:!1};if(!(u!=null&&u.address))return c.text="Connect Wallet",c.disabled=!1,c;if(!n||!d)return c.disabled=!0,c;if(a==="both"&&!+e&&!+r)return c.text="Enter an amount",c.disabled=!0,c;if(a!=="both"){if(!(+e||+r))return c.text="Enter an amount",c.disabled=!0,c;if(i){const b=We.isSuiCoin(a);if(b&&a===(n==null?void 0:n.coin_type)&&f(e).lt(3)||b&&a===(d==null?void 0:d.coin_type)&&f(r).lt(3))return c.text="Minimum deposit 3 SUI",c.disabled=!0,c}}if(a==="both"){if(f(e).gt(x||"0"))return c.disabled=!0,c.text=i?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",c;if(f(r).gt(l||"0"))return c.disabled=!0,c.text=i?`Insufficient ${d==null?void 0:d.symbol} Balance`:"Invalid Amount",c}if(a!=="both"){if(s&&f(e).gt(x||"0"))return c.disabled=!0,c.text=i?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",c;if(!s&&f(r).gt(l||"0"))return c.disabled=!0,c.text=i?`Insufficient ${d==null?void 0:d.symbol} Balance`:"Invalid Amount",c}return c},[u==null?void 0:u.address,a,e,r,x,l]);return{btnText:p.text,btnDisabled:p.disabled}}const ss="You can also choose to deposit in only one asset type. In that case,the vault will convert your asset to the required propositions using Cetus.Please note that trading fees & slippage will be applied. When slippage is involved,a certain amount of post-swap dust (no loss of funds) will be returned to you.",rs=(a,i)=>`When you deposit in only SUI tokens, a part of your SUI amount will be converted to ${i} via ${a} liquid staking services to match required liquidity compositions of the liquidity pool on Cetus. A certain amount of dust (no loss of funds) will be returned to you if slippage is involved.`;function ht(a){const{displayTokenA:i,displayTokenB:e,onSelectAssetTab:r,showAfterIcon:s=!1,label:x="Deposit Amounts",handleRefreshClick:l}=a,{stakeProtocolName:n}=ct(i==null?void 0:i.coin_type),d=o.useMemo(()=>i&&e?[{label:`${i.symbol}+${e.symbol}`,action:"both"},{label:`${i.symbol} only`,action:i.coin_type,afterIcon:s?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:ss},{label:`${e.symbol} only`,action:e.coin_type,afterIcon:s?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:rs(n,i==null?void 0:i.symbol)}]:[],[i,n]),[u,p]=o.useState("both"),c=o.useMemo(()=>{if(d.length!==0)return u===(i==null?void 0:i.coin_type)?d[1].label:u===(e==null?void 0:e.coin_type)?d[2].label:d[0].label},[u,d]);return t.jsx(ce,{borderRadius:"12px",p:{base:"16px 8px 8px",lg:"16px"},children:t.jsxs(W,{w:"100%",gap:"16px",children:[t.jsx(C,{w:"100%",justifyContent:"space-between",children:t.jsx(S,{fontWeight:"500",children:x})}),t.jsx(nt,{wrapStyle:{w:"100%",h:"48px",borderRadius:"8px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"6px",fontWeight:"500"},type:"outlineTab",currentTab:c,tabList:d,handleChangeTab:b=>{p(b.action),r(b.action)}})]})})}function is(a){const{apiVaultInfo:i,tokenA:e,tokenB:r,isReverse:s,vaultsId:x,totalLp:l,feeTier:n,handleRefreshClick:d}=a,[u,p]=o.useState("both"),{currentAccount:c,onWalletModal:b}=Oe(),{amountInputA:g,amountInputB:w,balanceInfoA:R,balanceInfoB:y,amountValueA:O,amountValueB:z,preCalculateLoading:$,fixAmountA:_,inputTotalValue:D,handleAmountInputChange:U,calculateResult:M,showOnlySideTips:T,doAddAction:Q,reCalculateResult:A}=ts(u,d,x,e,r),{vaultsSlippage:te}=Xe(),{btnText:V,btnDisabled:X}=gt(u,!0,g,w,_,R==null?void 0:R.balanceFormat,y==null?void 0:y.balanceFormat,e,r),{lpRate:ue}=ut(M==null?void 0:M.ft_amount,l),{amountLimit:k}=pt(Number(te),M==null?void 0:M.ft_amount,!1),[J,N]=o.useState(!1),Z=o.useMemo(()=>s?y:R,[R==null?void 0:R.balance,y==null?void 0:y.balance,s]),fe=o.useMemo(()=>s?R:y,[R==null?void 0:R.balance,y==null?void 0:y.balance,s]),q=o.useMemo(()=>s?r:e,[s,e,r]),L=o.useMemo(()=>s?e:r,[s,e,r]),K=()=>({feeTier:n||"",displayTokenA:q,displayTokenB:L,displayAmountA:s?w:g,displayAmountB:s?g:w,totalAmountValue:D,sharePool:ue,lpAmountLimit:k||"0"});return o.useEffect(()=>{A()},[i]),t.jsxs(W,{gap:"8px",w:"100%",align:"flex-start",children:[t.jsx(ht,{showAfterIcon:!0,displayTokenB:s?e:r,displayTokenA:s?r:e,onSelectAssetTab:p,handleRefreshClick:()=>{d(),A()}}),t.jsx(mt,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:u!=="both"&&u!==(q==null?void 0:q.coin_type),balance:(Z==null?void 0:Z.balanceFormat)||"",value:s?w:g,amountValue:s?z:O,loading:!_&&$,onChange:B=>{U(B,!s)},selectable:!1,placeholder:"0.0",token:q},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:u!=="both"&&u!==(L==null?void 0:L.coin_type),balance:(fe==null?void 0:fe.balanceFormat)||"",value:s?g:w,amountValue:s?O:z,loading:_&&$,onChange:B=>{U(B,s)},selectable:!1,placeholder:"0.0",token:L},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),t.jsx(ce,{borderRadius:"12px",p:"0px",children:t.jsxs(W,{w:"100%",gap:"20px",children:[t.jsx(Qe,{m:"-1px",isLoading:$,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",disabled:X||$,onClick:()=>{c?N(!0):b(!0)},children:V||"Deposit"}),(M||T)&&t.jsxs(W,{w:"100%",pb:"20px",pl:"16px",pr:"16px",gap:"20px",alignItems:"start",children:[u!=="both"&&t.jsx(S,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",children:T}),M&&t.jsx(ft,{amountLimit:k,inputTotalValue:D,preCalculateLoading:$,lpRate:ue,poolName:`${q==null?void 0:q.symbol} - ${L==null?void 0:L.symbol}`})]})]})}),J&&t.jsx(es,{data:K(),isOpen:J,onClose:()=>{N(!1)},onSubmitClick:()=>{N(!1),Q()}})]})}function os(a){const{vaultsCoinPercent:i,displayTokenB:e,displayTokenA:r,vaultCoinAmounts:s,vaultsCoinAValue:x,vaultsCoinBValue:l,isReverse:n}=a,d=o.useMemo(()=>n?l:x,[n,x,l]),u=o.useMemo(()=>n?x:l,[n,x,l]),p=o.useMemo(()=>n?i==null?void 0:i.percentB:i==null?void 0:i.percentA,[n,i]),c=o.useMemo(()=>n?i==null?void 0:i.percentA:i==null?void 0:i.percentB,[n,i]);return t.jsx(ce,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs(W,{w:"100%",gap:"0px",children:[t.jsx(S,{w:"100%",textAlign:"start",fontSize:"16px",color:"text_caption",children:"Vault Composition"}),t.jsxs(C,{w:{base:"96%",lg:"90%"},justifyContent:"space-between",mt:"20px",children:[t.jsxs(C,{children:[t.jsx(de,{imageUrl:r==null?void 0:r.logo_url,imageStyle:{w:"28px",h:"28px"}}),t.jsx(me,{wrapStyle:{gap:"4px"},title:ie(r==null?void 0:r.symbol,10)||"",titleStyle:{fontSize:"16px",color:"text_caption",fontWeight:"600"},value:`${p}%`,valueStyle:{fontSize:"12px",color:"text_paragraph",fontWeight:"500"}})]}),t.jsx(Jt,{ml:"16px",mr:"16px",flex:"1",h:"4px",value:p,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}}),t.jsxs(C,{children:[t.jsx(me,{wrapStyle:{gap:"4px",alignItems:"flex-end"},title:ie(e==null?void 0:e.symbol,10)||"",titleStyle:{fontSize:"16px",color:"text_caption",fontWeight:"600"},value:`${c}%`,valueStyle:{fontSize:"12px",color:"text_paragraph",fontWeight:"500"}}),t.jsx(de,{imageUrl:e==null?void 0:e.logo_url,coinType:e==null?void 0:e.coin_type})]})]}),t.jsxs(C,{w:{base:"100%",lg:"90%"},justifyContent:"space-between",mt:"12px",children:[t.jsx(me,{wrapStyle:{gap:{base:"8px",lg:"4px"}},title:`${E(s==null?void 0:s.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",fontWeight:"500"},value:pe(d,2),valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"14px"},fontWeight:"500"}}),t.jsx(me,{wrapStyle:{gap:{base:"8px",lg:"4px"},alignItems:"flex-end"},title:`${E(s==null?void 0:s.displayCoinB,6)} ${ie(e==null?void 0:e.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",fontWeight:"500"},value:pe(u,2),valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"14px"},fontWeight:"500"}})]})]})})}function ls(a){var s,x,l,n,d,u;const{isApp:i}=st(),{apiVaultInfo:e}=a,{getExplorerUrl:r}=Tt();return t.jsxs(Te,{flexDir:{base:"column",lg:"row"},w:"100%",justifyContent:"space-between",children:[t.jsxs(C,{children:[t.jsx(rt,{coinACoinType:(s=e==null?void 0:e.displayTokenA)==null?void 0:s.coin_type,coinBCoinType:(x=e==null?void 0:e.displayTokenB)==null?void 0:x.coin_type,coinAIconUrl:(l=e==null?void 0:e.displayTokenA)==null?void 0:l.logo_url,coinBIconUrl:(n=e==null?void 0:e.displayTokenB)==null?void 0:n.logo_url}),t.jsx(S,{fontSize:"16px",color:"text_caption",fontWeight:"500",children:(e==null?void 0:e.name)||`${(d=e==null?void 0:e.displayTokenA)==null?void 0:d.symbol} - ${(u=e==null?void 0:e.displayTokenB)==null?void 0:u.symbol}`}),t.jsx(ce,{w:"unset",p:{base:"8px 12px",lg:"4px 6px"},borderRadius:"12px",ml:"4px",children:t.jsx(C,{children:t.jsx(S,{fontSize:{base:"14px",lg:"12px"},color:"primary",children:e==null?void 0:e.feeDisplay})})}),!i&&t.jsxs(C,{ml:"12px",gap:"4px",children:[t.jsx(S,{fontSize:"14px",children:"Vault Address"}),t.jsx(et,{fontSize:"14px",address:(e==null?void 0:e.vaultsId)||"",onClickLink:()=>{window.open(r(e==null?void 0:e.vaultsId,"poolAddress"),"_blank")}})]})]}),t.jsx(Te,{flexDir:{base:"column",lg:"row"},gap:{base:"8px",lg:"60px"},children:i?t.jsxs(t.Fragment,{children:[t.jsx(oe,{label:"Vault Address",labelStyle:{fontSize:"14px"},value:t.jsx(et,{fontSize:"14px",color:"text_caption",address:(e==null?void 0:e.vaultsId)||"",onClickLink:()=>{window.open(r(e==null?void 0:e.vaultsId,"poolAddress"),"_blank")}})}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"APY",labelStyle:{fontSize:"14px"},rightValueTip:t.jsx(Be,{vaultsLstApyDisplay:e==null?void 0:e.vaultsLstApyDisplay,vaultsApyDisplay:e==null?void 0:e.vaultsApyDisplay,vaultsTotalApyDisplay:e==null?void 0:e.vaultsTotalApyDisplay}),value:(e==null?void 0:e.vaultsTotalApyDisplay)||"-",valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500"}}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"Rewards",labelStyle:{fontSize:"14px"},value:t.jsx(tt,{placement:"top",tooltip:t.jsx(S,{fontSize:"12px",lineHeight:"20px",maxW:"240px",children:"Rewards will be auto harvested and compounded to your position."}),children:t.jsx($e,{children:t.jsx(C,{w:"100px",justifyContent:"end",children:e==null?void 0:e.vaultsRewards.map(p=>t.jsx(Ie,{coinType:p},p))})})}),valueStyle:{h:"20px",lineHeight:"20px"}}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"TVL",labelStyle:{fontSize:"14px"},value:(e==null?void 0:e.vaultsTvlDisplay)||"-",valueStyle:{color:"text_caption",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500"}})]}):t.jsxs(t.Fragment,{children:[t.jsx(me,{wrapStyle:{alignItems:"flex-end",gap:"6px"},title:"APY",titleStyle:{fontSize:"12px"},valueTooltip:t.jsx(Be,{vaultsLstApyDisplay:e==null?void 0:e.vaultsLstApyDisplay,vaultsApyDisplay:e==null?void 0:e.vaultsApyDisplay,vaultsTotalApyDisplay:e==null?void 0:e.vaultsTotalApyDisplay}),value:(e==null?void 0:e.vaultsTotalApyDisplay)||"-",valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontWeight:"500"}}),t.jsx(me,{wrapStyle:{gap:"6px",alignItems:"flex-end"},title:"Rewards",titleStyle:{fontSize:"12px"},value:t.jsx(tt,{placement:"top",tooltip:t.jsx(S,{fontSize:"12px",lineHeight:"20px",maxW:"240px",children:"Rewards will be auto harvested and compounded to your position."}),children:t.jsx($e,{children:t.jsx(C,{w:"100px",justifyContent:"end",children:e==null?void 0:e.vaultsRewards.map(p=>t.jsx(Ie,{coinType:p},p))})})}),valueStyle:{h:"20px"}}),t.jsx(me,{wrapStyle:{alignItems:"flex-end",gap:"6px"},title:"TVL",titleStyle:{fontSize:"12px"},value:(e==null?void 0:e.vaultsTvlDisplay)||"-",valueStyle:{color:"text_caption",h:"20px",lineHeight:"20px",fontWeight:"500"}})]})})]})}function ns(a,i,e,r,s,x,l,n){const{setDetailRefreshCount:d}=at(),{fetchTokenPrices:u,getTokenAmountValue:p}=it(),{vaultsSdk:c}=ot(),{vaultsSlippage:b,mevProtect:g,maxCapForGas:w,transactionMode:R,customGasPrice:y}=Xe(),{findBestRouters:O}=Qt(),[z,$]=o.useState(""),[_,D]=o.useState(""),[U,M]=o.useState(!0),[T,Q]=o.useState(""),[A,te]=o.useState(!1),[V,X]=o.useState(0),ue=o.useRef(T),k=o.useRef(U),J=o.useRef(z),N=o.useRef(_),Z=o.useRef(A),fe=o.useRef(V);o.useEffect(()=>{fe.current=V},[V]),o.useEffect(()=>{Z.current=A},[A]),o.useEffect(()=>{ue.current=T},[T]),o.useEffect(()=>{k.current=U},[U]),o.useEffect(()=>{J.current=z},[z]),o.useEffect(()=>{N.current=_},[_]),o.useEffect(()=>{const m=[];l&&n&&(m.push(l.coin_type),m.push(n.coin_type)),m.length>0&&u(m)},[l==null?void 0:l.coin_type,n==null?void 0:n.coin_type]);const[q,L]=o.useState("0"),[K,B]=o.useState("0"),[we,le]=o.useState(!1);o.useEffect(()=>{De(),ge()},[a]),o.useEffect(()=>{ge()},[e.coinAmountA]);const ge=()=>{const{coinAmountA:m,coinAmountB:P}=e;if(le(!1),a==="both"){L(m),B(P);return}const j=a===(l==null?void 0:l.coin_type),H=j?P:m;let F=j?m:P;const re=j?n:l,Se=j?l:n;f(H).gt(0)?(le(!0),L("0"),B("0"),O({fromToken:re,toToken:Se,amount:Re(H,re.decimals).toString(),providersKeys:c.sdkOptions.aggregator.providers,by_amount_in:!0,uuid:T}).then(ye=>{ye.toAmountUi&&(F=f(F).add(ye.toAmountUi).toString()),j?L(F):B(F)}).finally(()=>{le(!1)})):j?L(F):B(F)},xe=p(l==null?void 0:l.coin_type,z),_e=p(n==null?void 0:n.coin_type,_),Ce=o.useMemo(()=>f(xe||"0").add(_e||"0").toString(),[xe,_e]),[Ue,be]=o.useState(!1),[h,v]=o.useState(void 0),Y=lt(async(m,P,j,H,F)=>{var re,Se;if(l&&n&&x&&s){if(!F){if(j){if(f(m).gt(q)){Q(""),v(void 0),be(!1);return}}else if(f(m).gt(K)){Q(""),v(void 0),be(!1);return}}d(0),(+J.current||+N.current||F)&&be(!0);const Me=P?m:Re(m,(j?l:n).decimals).toFixed(0),vt={vault_id:x,fix_amount_a:j,input_amount:Me,slippage:Number(b),request_id:H,side:a==="both"?ve.Both:ve.OneSide,is_ft_input:P,max_ft_amount:s};try{const ee=await c.Vaults.calculateWithdrawAmount(vt);if(ue.current===H){const Ae=ae(ee.amount_a.toString(),l.decimals).toString(),Ne=ae(ee.amount_b.toString(),n.decimals).toString();if(a==="both"&&(P?(D(Ne),$(Ae),F===100&&(L(Ae),B(Ne)),v(ee)):j?+J.current?(D(Ne),v(ee)):D(""):+N.current?($(Ae),v(ee)):$("")),a!=="both"){if(F){const Ze=ae(f(ee.amount_a).add(((re=ee.swap_result)==null?void 0:re.swap_out_amount)||"0").toString(),l.decimals).toString();if(j)$(Ze),D(""),F===100&&(ee.burn_ft_amount=s,L(Ze));else{const Ve=ae(f(ee.amount_b).add(((Se=ee.swap_result)==null?void 0:Se.swap_out_amount)||"0").toString(),n.decimals).toString();$(""),D(Ve),F===100&&(ee.burn_ft_amount=s,B(Ve))}}v(ee)}}}catch{v(void 0)}finally{be(!1)}}},500),I=(m,P,j=!1,H=!1,F=!0)=>{if(j){ne(100);return}if(H){ne(50);return}if(M(P),te(!1),P?($(m),F&&D("")):(D(m),F&&$("")),+m){const re=Ee();Q(re),Y(m,!1,P,re)}else De()},ne=m=>{if(te(!0),X(m),s&&+s)if(m===0)De();else{const P=a===(l==null?void 0:l.coin_type);if(M(P),m===100||a==="both"){const j=Ee();Q(j);const H=m===100?s:f(s).mul(m).div(100).toFixed(0);Y(H,!0,P,j,m)}else{M(P);const j=f(a===(l==null?void 0:l.coin_type)?q:K).mul(m).div(100).toFixed();Y(j,!1,P,T,m)}}},se=()=>{if(A)ne(V);else{const m=k.current?J.current:N.current;I(m,k.current)}};o.useEffect(()=>{if(!A)if(h&&s&&+s){let m=Number(f(h.burn_ft_amount).div(s).mul(100));m>100&&(m=100),X(m)}else X(0)},[h==null?void 0:h.burn_ft_amount]);const[He,Pe]=o.useState(!1),{signAndExecuteTransaction:ze,transactionConfirmation:bt,transactionRejected:St}=dt(),yt=async()=>{if(x&&h&&s){Pe(!0);let m;if(a==="both")m={vault_id:x,ft_amount:h==null?void 0:h.burn_ft_amount,slippage:Number(b)};else{const j=a===(l==null?void 0:l.coin_type);if(V===100)m={vault_id:x,is_ft_input:!0,input_amount:s,slippage:Number(b),max_ft_amount:s,fix_amount_a:j};else{const H=Re(U?z:_,9);m={vault_id:x,is_ft_input:!1,input_amount:H.toString(),slippage:Number(b),max_ft_amount:s,fix_amount_a:j}}}const P={getShowInfo:(j,H)=>{const F="Withdraw "+[he(z,l==null?void 0:l.symbol),he(_,n==null?void 0:n.symbol)].filter(Boolean).join(" and "),re={modalDescriptionText:F,toastDescriptionContent:F};if(j==="success"){let Se=z,ye=_;H&&(Se=f(z).gt(0)?Fe(H,l)||z:"",ye=f(_).gt(0)?Fe(H,n)||_:"");const Me="Removed "+[he(Se,l==null?void 0:l.symbol),he(ye,n==null?void 0:n.symbol)].filter(Boolean).join(" and ");re.toastDescriptionContent=Me,re.modalDescriptionText=Me}return re}};bt(P);try{const j=await c.Vaults.withdraw(m);await ze(j,P,{useMev:g,txAction:"signTransactionBlock",useFastMode:R==="Fast Mode",maxCapForGas:w,customGasPrice:y,msafeParams:{action:xt.RemoveVaultsPosition,txbParams:m}})?De():se(),i()}catch{St(P)}}},De=()=>{$(""),D(""),X(0),be(!1),v(void 0),Q("")},jt=o.useMemo(()=>{if(h&&h.swap_result&&a!=="both"&&l&&n){const m=U?z:_,P=k.current?l:n,j=k.current?n:l,H=ae(h.swap_result.swap_in_amount,P.decimals),F=ae(f(h.swap_result.swap_out_amount).mul(1-Number(b)).toString(),j.decimals);return`To withdraw ${m} ${P==null?void 0:P.symbol}, ${H} ${j==null?void 0:j.symbol} in the pool will be traded for ${F} ${P==null?void 0:P.symbol}`}},[a,h,z,_]);return{handleAmountInputChange:I,fixAmountA:U,amountInputA:z,amountInputB:_,availableAmountA:q,availableAmountB:K,amountValueA:xe,amountValueB:_e,preCalculateLoading:Ue,inputTotalValue:Ce,calculateResult:h,showOnlySideTips:jt,doRemoveAction:yt,handlePercentInputChange:ne,isPercentInput:A,removePercent:V,reCalculateResult:se,calculateAvailableAmount:ge,calculateAvailableLoading:we}}function as(a){const{apiVaultInfo:i,tokenA:e,tokenB:r,isReverse:s,vaultsId:x,totalLp:l,holdCoinAmounts:n,holdLpAmount:d,handleRefreshClick:u}=a,[p,c]=o.useState("both"),{currentAccount:b,onWalletModal:g}=Oe(),{amountInputA:w,amountInputB:R,availableAmountA:y,availableAmountB:O,amountValueA:z,amountValueB:$,preCalculateLoading:_,fixAmountA:D,inputTotalValue:U,handleAmountInputChange:M,calculateResult:T,showOnlySideTips:Q,doRemoveAction:A,handlePercentInputChange:te,removePercent:V,isPercentInput:X,reCalculateResult:ue,calculateAvailableLoading:k}=ns(p,u,n,l,d,x,e,r),{btnText:J,btnDisabled:N}=gt(p,!1,w,R,D,y,O,e,r);ut(T==null?void 0:T.burn_ft_amount,l);const{amountLimit:Z}=pt(0,T==null?void 0:T.burn_ft_amount,!1),fe=o.useMemo(()=>s?O:y,[O,y,s]),q=o.useMemo(()=>s?y:O,[y,O,s]),L=o.useMemo(()=>s?r:e,[s,e,r]),K=o.useMemo(()=>s?e:r,[s,e,r]),B=o.useMemo(()=>_?X?!0:s?D:!D:!1,[_,X]),we=o.useMemo(()=>_?X?!0:s?!D:D:!1,[_,X]);return o.useEffect(()=>{ue()},[i]),t.jsxs(W,{gap:"8px",w:"100%",align:"flex-start",children:[t.jsx(ht,{label:"Remove Amounts",displayTokenB:s?e:r,displayTokenA:s?r:e,onSelectAssetTab:c,handleRefreshClick:()=>{u(),ue()}}),t.jsx(mt,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},calculateAvailableLoading:k,hideSelf:p!=="both"&&p!==(L==null?void 0:L.coin_type),balance:fe||"",value:s?R:w,amountValue:s?$:z,loading:B,onChange:(le,ge,xe)=>{M(le,!s,ge,xe)},needRemainBalance:!1,selectable:!1,placeholder:"0.0",token:L,balanceLabel:"Available"},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},balanceLabel:"Available",calculateAvailableLoading:k,needRemainBalance:!1,hideSelf:p!=="both"&&p!==(K==null?void 0:K.coin_type),balance:q||"",value:s?w:R,amountValue:s?z:$,loading:we,onChange:(le,ge,xe)=>{M(le,s,ge,xe)},selectable:!1,placeholder:"0.0",token:K}}),t.jsxs(ce,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[t.jsx(S,{color:"primary_gray",children:"Amount"}),t.jsx(Kt,{percentage:V,onChange:le=>{te(Number(le.toString().replace("%","")))}})]}),t.jsx(ce,{borderRadius:"12px",p:"0px",children:t.jsxs(W,{w:"100%",gap:"20px",children:[t.jsx(Qe,{m:"-1px",isLoading:_,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",disabled:N||_,onClick:()=>{b?A():g(!0)},children:J||"Withdraw"}),T&&t.jsxs(W,{w:"100%",pb:"20px",pl:"16px",pr:"16px",gap:"20px",children:[p!=="both"&&t.jsx(S,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",children:Q}),t.jsxs(W,{w:"100%",gap:"20px",children:[t.jsx(oe,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:pe(U,2),valueStyle:{fontSize:"14px"},isLoading:_}),t.jsx(oe,{label:"LP Burn Amount",value:`${E(ae(Z||"0",9),9)} ${`${L==null?void 0:L.symbol} - ${K==null?void 0:K.symbol}`}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},isLoading:_})]})]})]})})]})}const cs=[{label:"Deposit",value:"Deposit"},{label:"Withdraw",value:"Withdraw"}];function er(){const{vaultId:a}=Ft(),{currentAccount:i}=Oe(),{apiVaultInfo:e,getApiVaultInfo:r}=Zt(a),{fetchAccountBalance:s}=qt(),{contractVault:x,lpTokenInfo:l,minPrice:n,maxPrice:d,vaultCoinAmounts:u,vaultsCoinAValue:p,vaultsCoinBValue:c,currPrice:b,balanceInfo:g,totalValue:w,fetchClmmPoolFromContract:R,fetchVaultInfoFromContract:y,vaultsCoinPercent:O,sharePoolRate:z,holdCoinAmounts:$,holdCoinAValue:_,holdCoinBValue:D}=Ht(e==null?void 0:e.vaultsId,e==null?void 0:e.clmmPoolAddress,e==null?void 0:e.tokenA,e==null?void 0:e.tokenB,e==null?void 0:e.isReverse),[U,M]=o.useState("Deposit"),{rewardPerA:T,rewardPerB:Q}=At(g==null?void 0:g.balanceFormat,e);o.useEffect(()=>{a&&y(a,!0)},[a]),o.useEffect(()=>{e&&R(e.clmmPoolAddress,!0)},[e==null?void 0:e.clmmPoolAddress]),o.useEffect(()=>{i!=null&&i.address&&s()},[]);const A=()=>{s(),e&&R(e.clmmPoolAddress,!0),a&&(y(a,!0),r(a,!0))};return t.jsxs(W,{gap:"20px",w:"100%",pt:"40px",align:"flex-start",children:[t.jsxs(C,{w:"100%",justify:"space-between",children:[t.jsx(Et,{}),t.jsx(Nt,{handleRefresh:A,isAutoRefresh:!0,refreshInterval:20,innerStyle:{bg:"background"},w:"32px",h:"32px",borderRadius:"8px",bg:"background"})]}),t.jsx(ls,{apiVaultInfo:e}),t.jsxs(Te,{flexDir:{base:"column-reverse",lg:"row"},w:"100%",justifyContent:"space-between",gap:"16px",alignItems:"start",children:[t.jsxs(W,{w:{base:"100%",lg:"auto"},flex:"1",gap:"8px",children:[t.jsx(kt,{minPrice:n,maxPrice:d,currentPrice:b,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,isReverse:(e==null?void 0:e.isReverse)||!1}),t.jsx(os,{vaultCoinAmounts:u,vaultsCoinAValue:p,vaultsCoinBValue:c,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsCoinPercent:O}),t.jsx(Vt,{sharePoolRate:z,balanceInfo:g,totalValue:w,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,lpLogoUrl:l==null?void 0:l.logo_url,holdCoinAmounts:$,holdCoinAValue:_,holdCoinBValue:D,isReverse:(e==null?void 0:e.isReverse)||!1,rewardPerA:T,rewardPerB:Q})]}),t.jsxs(W,{w:{base:"100%",lg:"40%"},justifyContent:"start",gap:"8px",children:[t.jsx(ce,{p:"0",borderRadius:"12px",children:t.jsxs(C,{w:"100%",p:{base:"0 8px",lg:"0 16px"},children:[t.jsx(nt,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{fontSize:"16px",mr:"28px"},tabList:cs,currentTab:U,handleChangeTab:te=>{M(te==null?void 0:te.value)}}),t.jsx(Ot,{slippageType:"vaults",compact:!0})]})}),U==="Deposit"&&t.jsx(is,{apiVaultInfo:e,feeTier:e==null?void 0:e.feeDisplay,tokenA:e==null?void 0:e.tokenA,tokenB:e==null?void 0:e.tokenB,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsId:e==null?void 0:e.vaultsId,totalLp:x==null?void 0:x.total_supply,handleRefreshClick:A}),U==="Withdraw"&&t.jsx(as,{apiVaultInfo:e,holdCoinAmounts:$,tokenA:e==null?void 0:e.tokenA,tokenB:e==null?void 0:e.tokenB,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsId:e==null?void 0:e.vaultsId,totalLp:x==null?void 0:x.total_supply,holdLpAmount:g==null?void 0:g.balance,handleRefreshClick:A})]})]})]})}export{er as default};

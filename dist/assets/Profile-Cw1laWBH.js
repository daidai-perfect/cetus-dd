import{a as p,D as Ge,j as e,V as F,F as qe,aa as Pe,H as S,T as C,C as I,u as J,f as N,v as X,X as Ke,Y as Ie,Z as Qe,$ as Ye,a0 as Ze,a1 as Je,ab as Re,I as et,N as gt,aA as ht,O as ft,Q as mt,ar as Ee,ag as jt}from"./vendor-BulRdKUe.js";import{u as tt}from"./global-DOQtmW25.js";import{j as M,F as le,I as U,O as ie,aU as bt,i as je,e as st,q as Ue,d as B,aV as me,B as K,v as se,c as ke,a as V,G as wt,z as Z,R as nt,n as pe,M as ae,p as Ct,X as yt,f as ot,am as _t,w as $,m as Oe,as as Q,ar as it,k as be,aW as St,aX as Me,Q as fe,V as at,aR as vt,al as Tt,aI as _e,a0 as kt,aY as We,aZ as Xe}from"./index-C9eB4n05.js";import{N as ee}from"./NoData-fdoVeTOA.js";import{u as Lt,A as Pt,R as Rt}from"./RecentTransactions-BNvffyGe.js";import{A as Ot}from"./AccountSwitchDrawer-DELI1Bch.js";import{u as rt,D as lt,g as Dt,e as At,f as Ht,W as Ft,b as zt,R as Bt,a as Et,d as Ut}from"./OverviewOrders-D-5wA_nH.js";import{I as Se}from"./IconText-CsV1E6HL.js";import{u as Mt}from"./RangeValue-D7b-YFqE.js";import{H as te}from"./HTextLabelBox-CRyapKB_.js";import{u as Y}from"./activeOrders-B_DQ4Rr1.js";import{H as De,T as Ae}from"./Table-Dw2kwPPO.js";import{P as we}from"./Pagination-Dd-2GMaB.js";import{b as Wt,u as xe,c as Xt,C as $t,P as Nt,F as Vt,E as Gt,S as qt,O as Kt,a as It}from"./useGetLimitOrderHistory-IArHn7rZ.js";import{u as Qt}from"./useRpcListener-D9jC1_QS.js";import{R as Yt}from"./RefreshButton-k-UP5oiv.js";import{a as re,d as Zt,u as ct,e as Jt,f as es,g as ts,c as ss,b as ns}from"./usePositionList-CM9xw-J5.js";import{P as os,a as is,b as as,u as rs}from"./PoolItem-A0mqLGQi.js";import{P as ls,u as cs}from"./PositionListLoading-VMvMvzit.js";import{u as ds}from"./useAccountBalance-CS3ca8rH.js";import{u as dt}from"./useToken-CSs04qtp.js";import{f as He,a as ps,b as xs,u as us,X as gs,c as hs,C as fs,e as ms,d as js,g as bs}from"./useXCetus-PdK_JF4O.js";import{S as pt}from"./SingleTokenInfo-DrnbDXGz.js";import{S as ws}from"./SortDropBlock-CQ4GpXaE.js";import{T as ve}from"./TableSortTh-CavCOuwa.js";import{u as Cs}from"./useTokenBalance-BoTga07n.js";import{X as ys,a as _s,b as Ss,c as vs,u as Ts}from"./useXCetusHelper-Dj67W-Ua.js";import"./CopyButton-BOubBhgx.js";import"./Drawer-Cc85-wz0.js";import"./useTransaction-CEDCgy0u.js";import"./useTrack-vdBG3X1y.js";import"./useSigner-3qOKnO9v.js";import"./ErrorTips-Alt-FfJI.js";import"./usePreviousValue-DJR5Z5zU.js";import"./useFavoritePool-DGv9LiJ7.js";import"./useGetPoolList-arI9iVq2.js";import"./useWrapPoolData-CyVbotlF.js";import"./CheckBox-C-vSoIAm.js";import"./SearchInputBlock-ByjgrLT2.js";import"./index-DZEhp6gr.js";import"./Loading-CEW9oCbv.js";import"./TooltipIcon-C94PfOPN.js";import"./PositionCurrentPrice-DFDLfJy2.js";import"./useBurn-ELpujfin.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-BFph4A5I.js";import"./PoweredByHaedal-DgLgYLeQ.js";import"./PriceRange-Cwf2Nmm6.js";import"./PositionStatus-C6YtjnbO.js";import"./detail-eWJDG1lG.js";import"./TradeInputGroup-BNI7CpwJ.js";import"./_getAllKeysIn-DRhE9cEE.js";import"./HighlightText-Uv5QOqtT.js";import"./index-4kM3JsjZ.js";import"./debounce-Cta0IZrB.js";import"./index-e8NcK24v.js";function ks(t=100){const o=p.useRef([]),s=p.useRef(!1),a=p.useRef(void 0),r=p.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const l=o.current.shift();if(!l)continue;const{id:c,run:x,onStart:g,onSuccess:u,onError:w}=l;if(l._cancelled){console.log(`[task:${l.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),g==null||g(c);const d=await x(a.current,c);a.current=d,console.log(`[task:${c}] success`,d),u==null||u(d,c)}catch(d){console.error(`[task:${c}] failed`,d),w==null||w(d,c)}await new Promise(d=>setTimeout(d,t))}s.current=!1}},[t]),i=l=>{o.current.push(l),r()},n=l=>{const c=o.current.find(x=>x.id===l);c&&(c._cancelled=!0),o.current=o.current.filter(x=>x.id!==l)};return p.useEffect(()=>()=>{o.current=[],s.current=!1,a.current=void 0},[]),{addTask:i,removeTask:n}}const xt=(t,o)=>o?t:"********";function Ls({totalValue:t,onRefreshTask:o,isLoading:s,children:a}){const[r,i]=p.useState(!1),{currentAccount:n,onWalletModal:l,accounts:c,accountServiceNameObj:x}=M(),{isShowProfileAssets:g,setIsShowProfileAssets:u}=tt();p.useEffect(()=>{i(!0)},[]);const{isOpen:w,onClose:d,onToggle:b}=Ge(),{getServiceNames:k}=Lt(),D=p.useCallback(()=>{w||k(c),b(),console.log("AccountSwitch###handleClick###isOpen: ",w)},[w,c]);return console.log(n,x,c,"currentAccount-H5Main"),e.jsxs(F,{w:"100%",mt:"28px",children:[r?n!=null&&n.address?e.jsxs(F,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(S,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(S,{h:"18px",children:[e.jsx(C,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(le,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(C,{fontSize:"12px",children:g?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(U,{xlinkHref:g?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>u(!g)})})})]}),e.jsxs(S,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(C,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(U,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(J,{isLoaded:!s,h:"32px",children:e.jsx(C,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:xt(ie(t,2),g)})}),c.length>1&&e.jsxs(S,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:D,cursor:"pointer",children:[e.jsxs(S,{children:[e.jsx(U,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(C,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[n!=null&&n.label?`${n==null?void 0:n.label} : `:"",(x==null?void 0:x[n==null?void 0:n.address])||bt(n==null?void 0:n.address)]})]}),e.jsx(U,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),a]}):e.jsx(ee,{type:"nowallet",mt:"20px",onboard:()=>l(!0)}):e.jsx(qe,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Pe,{})}),e.jsx(Ot,{isOpen:w,onClose:d})]})}function Fe(t){const{type:o,children:s,wrapStyle:a={h:"60px"},textStyle:r={fontSize:"16px"}}=t,i=(n,l)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(n,l):n===l.value;return e.jsxs(S,{justify:"space-between",w:"100%",h:"60px",...a,children:["title"in t?e.jsx(C,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(je,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(n,l)=>i(n,l),wrapStyle:{h:"60px",border:"none",gap:"38px",...a},itemStyle:r}),s]})}function Ps({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:a,outCoin:r}=t,{orderHistoryList:i,handleGetDcaOrderHistory:n,orderHistoryListLoading:l}=rt();p.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=st(),[x,g]=p.useState(s),u=142,w=(i==null?void 0:i.length)||0,d=(i==null?void 0:i.length)<=1?`${u*w-8}px`:`${u*w+(w-1)*32-8}px`;return e.jsxs(F,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(i==null?void 0:i.length)>=3?"460px":"unset",overflowY:"auto",children:[!l&&e.jsx(N,{h:d,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),l?e.jsx(S,{h:"100px",w:"100%",justify:"center",children:e.jsx(Pe,{})}):(i==null?void 0:i.length)===0?e.jsx(ee,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):i.map(b=>{const k=Ue(b.inAmount,a==null?void 0:a.decimals),D=Ue(b.outAmount,r==null?void 0:r.decimals),_=B(k).div(D).toString(),h=B(1).div(_).toString();return e.jsxs(F,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(S,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(C,{h:"20px",lineHeight:"20px",children:[me((b==null?void 0:b.time)*1e3)," (UTC)"]}),e.jsx(U,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(b==null?void 0:b.tx,"tx"))}}),e.jsx(S,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(N,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(K,{p:"16px",borderRadius:"12px",children:e.jsxs(F,{align:"flex-start",gap:"20px",children:[e.jsxs(F,{gap:"0px",align:"flex-start",children:[e.jsx(C,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:x?`${se(_)} `:`${se(h)} `}),e.jsxs(S,{children:[e.jsxs(C,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",x?` ${a.symbol} per ${r.symbol}`:` ${r.symbol} per ${a.symbol}`,")"]}),e.jsx(U,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>g(!x)})]})]}),e.jsxs(S,{w:"100%",gap:"4px",children:[e.jsx(ke,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(C,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(k)}`}),e.jsx(C,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${a.symbol}`}),e.jsx(C,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(ke,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(C,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(D)}`}),e.jsx(C,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},b==null?void 0:b.tx)})]})}function Rs({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:a=!1,toClaim:r}){const{inCoin:i,outCoin:n}=t;return e.jsxs(F,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(Os,{}),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(lt,{orderInfo:t}),o&&r&&e.jsx(X,{isLoading:a,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(C,{fontSize:"16px",color:"text_caption",children:Dt(t,o,!0)}),e.jsx(C,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(S,{w:"100%",justify:"space-around",children:[e.jsxs(F,{children:[e.jsx(C,{fontSize:"16px",color:"text_caption",children:At(t)}),e.jsxs(C,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]})]}),e.jsx(N,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(F,{children:[e.jsx(C,{color:"text_caption",fontSize:"16px",children:Ht(t)}),e.jsxs(C,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(F,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(te,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(te,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(te,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${i==null?void 0:i.symbol}`}),o&&e.jsx(te,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(te,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),o&&e.jsx(te,{label:"Next Order (UTC)",value:me(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(te,{label:"Created (UTC)",value:me(t==null?void 0:t.createdAt)||""})]})]})}const Os=()=>{const[t,o]=p.useState(!1);return e.jsxs(F,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(S,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(C,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(U,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(F,{align:"flex-start",w:"100%",children:[e.jsx(N,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Ft,{})]})]})};function Ds({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:a,isClaimLoading:r=!1,toClaim:i}){const{isApp:n}=V(),l=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,x]=p.useState("overview"),{inCoin:g,outCoin:u}=s,[w,d]=p.useState(!1),{getTokenRank:b}=Mt();return p.useEffect(()=>{const k=b(g,u);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",u,g,k),d(!k)},[g==null?void 0:g.coin_type,u==null?void 0:u.coin_type]),e.jsxs(Ke,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Ie,{}),e.jsxs(Qe,{minWidth:n?"300px":"482px",children:[e.jsx(Ye,{children:e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Fe,{type:"tab",currentTab:c,tabs:l,onTabChange:k=>x(k.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(Ze,{}),e.jsxs(Je,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(Rs,{orderInfo:s,isActiveOrder:a,pageDirect:w,isClaimLoading:r,toClaim:i}),c=="orders"&&e.jsx(Ps,{orderInfo:s,isActiveOrder:a,pageDirect:w})]})]})]})}function As({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=V(),[a,r]=p.useState(!1),{getExplorerUrl:i}=st(),{isClaimLoading:n,toClaim:l,closeOrderAction:c,isCloseLoading:x}=rt();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(S,{justify:"flex-end",children:[e.jsx(X,{isLoading:n,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||n,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(le,{placement:"bottom-end",tooltip:e.jsxs(F,{align:"flex-start",children:[e.jsx(Se,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(Se,{text:"View on Explorer",onClick:()=>{window.open(i(t.orderID,"poolAddress"))}}),e.jsx(Se,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:x?()=>{}:()=>{c(t)}})]}),children:e.jsx(I,{children:e.jsx(X,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(U,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(S,{justify:"flex-end",children:[e.jsx(X,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(X,{onClick:g=>{wt(g),window.open(i(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(U,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),a&&e.jsx(Ds,{isOpen:a,onClose:()=>r(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:l})]})}function Hs(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:a}=Y(),[r,i]=p.useState("activeDCAs"),n=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":a==null?void 0:a.length}],[o,a,s]),l=p.useMemo(()=>r=="activeDCAs"?s:a,[r,s,a]),{isApp:c}=V(),{closeAll:x,claimAll:g,isClaimAllLoading:u,isCloseAllLoading:w}=zt(),d=p.useMemo(()=>r==="pastDCAs"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((R,L)=>B(R).plus(L==null?void 0:L.outBalance),B(0)).toString(),[r,l]),[b,k]=p.useState([]),[D,_]=p.useState(0),[h,y]=p.useState(1),v=10,T=$e(r=="activeDCAs");return p.useEffect(()=>{if((l==null?void 0:l.length)>0){const R=(h-1)*v;(l==null?void 0:l.length)<=R&&y(1)}},[l]),p.useEffect(()=>{if((l==null?void 0:l.length)>0){_(l==null?void 0:l.length);const R=(h-1)*v,L=R+v;console.log("ðŸš€ ~ useEffect ~ start:",h,l.slice(0,L),R,L),(l==null?void 0:l.length)>R&&k(l.slice(R,L))}},[h,l]),e.jsxs(F,{w:"100%",gap:"12px",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:n,currentTab:r,handleChangeTab:R=>i(R==null?void 0:R.value),isActive:(R,L)=>R===L.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(l==null?void 0:l.length)>1&&r=="activeDCAs"&&e.jsxs(S,{children:[e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:u,disabled:Number(d)===0||u,onClick:()=>{g(l)},children:"Claim All"}),e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:w,disabled:(l==null?void 0:l.length)==0||w,onClick:()=>{x(l)},children:"Close All"})]})]}),e.jsxs(F,{w:"100%",position:"relative",gap:"20px",children:[(t||!o)&&(l==null?void 0:l.length)===0?e.jsx(ee,{type:"nodata",text:r==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(F,{w:"100%",gap:"4px",children:e.jsx(De,{rowKey:"orderID",columns:T,dataSource:b,loading:!t&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ae,{rowKey:"orderID",columns:$e(r=="activeDCAs"),dataSource:b,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(l==null?void 0:l.length)>v&&e.jsx(I,{children:e.jsx(we,{total:D,size:v,currentPage:h,onChange:R=>{y(R)}})})]})]})}const $e=t=>[{title:e.jsx(C,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(lt,{orderInfo:s})},{title:e.jsx(C,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Bt,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(C,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Et,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(C,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(C,{color:"text_caption",children:me(s)})},{title:e.jsx(C,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(As,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function Fs(){const{currentAccount:t}=M(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:a}=Wt(),{myOrderList:r,orderListLoading:i}=xe(),{isAutoRefresh:n,autoRefreshCount:l}=Y(),[c,x]=p.useState("openOrders"),g=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:!n&&i?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:!n&&a?"":s==null?void 0:s.length}],[i,a,r,s]),u=f=>{t!=null&&t.address&&o(t.address,f)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",l),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),l>0&&u(!0)},[l]),p.useEffect(()=>{u(!0)},[c,t]);const w=p.useMemo(()=>c=="openOrders"?i:a,[c,i,a]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,s),c=="openOrders"?r:s),[c,r,s]);Qt({onRpcChange:()=>{u(!0)}});const{isApp:b}=V(),{handleCancelOrder:k,cancelOrderLoading:D}=Xt(),[_,h]=p.useState([]),[y,v]=p.useState(0),[T,R]=p.useState(1),L=10,O=zs(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const f=(T-1)*L;(d==null?void 0:d.length)<=f&&R(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){v(d==null?void 0:d.length);const f=(T-1)*L,P=f+L;console.log("ðŸš€ ~ useEffect ~ start:",T,d.slice(0,P),f,P),(d==null?void 0:d.length)>f&&h(d.slice(f,P))}},[T,d]),e.jsxs(F,{w:"100%",gap:"12px",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:g,currentTab:c,handleChangeTab:f=>x(f==null?void 0:f.value),isActive:(f,P)=>f===P.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(S,{children:e.jsx(X,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:D,onClick:()=>{k(r)},children:"Cancel All"})})]}),e.jsxs(F,{w:"100%",position:"relative",gap:"20px",children:[(n||!w)&&(d==null?void 0:d.length)===0?e.jsx(ee,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):b?e.jsx(F,{w:"100%",gap:"4px",children:e.jsx(De,{rowKey:"order_id",columns:O,dataSource:_,loading:!n&&w,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ae,{rowKey:"order_id",columns:O,dataSource:_,loading:!n&&w,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>L&&e.jsx(I,{children:e.jsx(we,{total:y,size:L,currentPage:T,onChange:f=>{R(f)}})})]})]})}const zs=t=>[{title:e.jsx(C,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx($t,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(C,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Nt,{info:s,isProfile:!0})},{title:e.jsx(C,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(Vt,{info:s,isProfile:!0})},{title:e.jsx(C,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Gt,{info:s,isProfile:!0})},!t&&{title:e.jsx(C,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(qt,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(C,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(Kt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function Bs(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=p.useState("limitOrders");return e.jsx(K,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(F,{align:"flex-start",gap:"20px",children:[e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Fe,{type:"tab",currentTab:o,tabs:t,onTabChange:a=>s(a.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(Fs,{}),o==="dca"&&e.jsx(Hs,{})]})})}function Es({handleRefresh:t,totalValue:o,isLoading:s}){var w,d;const{isApp:a}=V(),{currentAccount:r,accounts:i}=M(),{isShowProfileAssets:n,setIsShowProfileAssets:l}=tt(),[c,x]=p.useState(!1),{onClose:g}=Ge(),u=i.reduce((b,k)=>(b[k.address]=k,b),{});return e.jsxs(F,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(S,{w:"100%",children:[e.jsx(C,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(le,{showTooltip:!a,placement:"bottom-end",tooltip:e.jsx(C,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(U,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>l(!n)})})})]}),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(J,{isLoaded:!s,h:"22px",children:e.jsx(C,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:xt(ie(o,2),n)})}),e.jsxs(S,{children:[e.jsxs(S,{p:"0 8px",h:"36px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{x(!0)},children:[e.jsx(U,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(C,{children:"Transactions"})]}),e.jsx(Yt,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),i.length>1&&e.jsxs(S,{children:[((w=u==null?void 0:u[r==null?void 0:r.address])==null?void 0:w.label)&&e.jsxs(C,{color:"primary_gray",children:[(d=u==null?void 0:u[r==null?void 0:r.address])==null?void 0:d.label," :"]}),e.jsx(Pt,{currentAccount:r,accounts:i,onClose:g,isProfile:!0})]}),c&&e.jsx(Rt,{isOpen:c,onClose:()=>x(!1)})]})}function Us(){var D;const{currentAccount:t,onWalletModal:o}=M(),{showPosListLength:s,setShowPosListLength:a,posBaseListLoading:r,posBaseListGroupByPool:i}=re(),[n,l]=p.useState([]),{isAutoRefresh:c}=Y(),[x,g]=p.useState([]),u=_=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",_),g(h=>[...h,_])},w=_=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",_),g(h=>h.filter(y=>(y==null?void 0:y.coin_type)!==(_==null?void 0:_.coin_type)))};p.useEffect(()=>{t!=null&&t.address||a("")},[t==null?void 0:t.address]),p.useEffect(()=>{var T,R,L,O;const _=(T=x[0])!=null&&T.coin_type?Z((R=x[0])==null?void 0:R.coin_type):void 0,h=(L=x[1])!=null&&L.coin_type?Z((O=x[1])==null?void 0:O.coin_type):void 0,y=Object.values(i).filter(f=>_&&h?Z(f.tokenA.coin_type)==_&&Z(f.tokenB.coin_type)==h||Z(f.tokenA.coin_type)==h&&Z(f.tokenB.coin_type)==_:_?Z(f.tokenA.coin_type)==_||Z(f.tokenB.coin_type)==_:f);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(i),y),l(y);const v=y.reduce((f,P)=>f+(P.list?P.list.length:0),0);t!=null&&t.address&&a(v.toString())},[x,i]),p.useEffect(()=>()=>{a("")},[]);const d=p.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[b,k]=p.useState("positions");return e.jsx(K,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(F,{gap:"16px",w:"100%",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(Fe,{type:"tab",currentTab:b,tabs:d,onTabChange:_=>k(_.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(os,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:x,onClickSelectCoinList:u,onDeleteSelectCoinList:w})]}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(is,{}),t!=null&&t.address?!c&&r?[{},{},{},{}].map((_,h)=>e.jsx(ls,{},h)):((D=Object.values(n))==null?void 0:D.length)>0?Object.values(n).map((_,h)=>e.jsx(as,{poolInfo:_},h)):e.jsx(ee,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(ee,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})})}function Ms({tabList:t,tabData:o,onClickTab:s}){return e.jsx(F,{w:"100%",children:t==null?void 0:t.map(a=>e.jsx(Ws,{imgUrl:a.activeImgUrl,value:o[a.value].totalValue,title:a.title,url:a.route,tooltip:a==null?void 0:a.tooltip,onClick:()=>s(a.value),isLoading:o[a.value].isLoading},a.title))})}const Ws=({imgUrl:t,value:o,title:s,url:a,tooltip:r,isLoading:i,onClick:n})=>(Re(),e.jsxs(S,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(S,{gap:"12px",children:[e.jsx(et,{w:"36px",h:"36px",src:t}),e.jsxs(F,{gap:"2px",align:"flex-start",children:[e.jsx(J,{h:"24px",isLoaded:!i,children:e.jsx(C,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})}),e.jsxs(S,{gap:"4px",children:[e.jsx(C,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),r&&e.jsx(le,{tooltip:r,children:e.jsx(N,{children:e.jsx(U,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(I,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(U,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function Xs({tabList:t,activeTab:o,tabData:s,onClickTab:a}){return e.jsx(S,{w:"100%",mt:"10px",children:t.map(r=>{var i,n;return e.jsxs(K,{w:"25%",p:"24px 16px",h:"94px",bgImage:o===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",onClick:()=>a(r.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",img:{opacity:"0.8"}},children:[e.jsxs(F,{align:"flex-start",gap:"12px",children:[e.jsx(C,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(S,{h:"22px",children:e.jsx(le,{placement:"top",tooltip:e.jsx(C,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:r.tooltip}),showTooltip:r.showTooltip,children:e.jsx(I,{as:"button",children:e.jsx(J,{isLoaded:!((i=s[r.value])!=null&&i.isLoading),children:e.jsx(C,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(n=s[r.value])==null?void 0:n.totalValue})})})})})]}),e.jsx(et,{w:"48px",h:"48px",src:r.activeImgUrl,opacity:o===r.value?"0.8":"0.4"})]},r.value)})})}function Ne(t){const{isApp:o}=V();return o?e.jsx(Ms,{...t}):e.jsx(Xs,{...t})}const $s=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),Ce=nt($s);function ut(){const{currentAccount:t}=M(),{fetchAccountBalance:o}=ds(),{coinHoldingList:s,setCoinHoldingList:a,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:i,setHoldingsTotalUsd:n,isCoinPriceLoading:l,setUnknownCoinCount:c}=Ce(),{getTokenListInfo:x}=dt(),{getTokenPrice:g}=pe(),{refreshCoinPriceInfo:u}=He(),w=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{w.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const d=async()=>{const h=w.current;if(h){r(!0);const y=await o(h,!0);if(y){const v=await x(y.filter(L=>B(L.totalBalance).gt(0)).map(L=>L.coinType));if(!v)throw r(!1),a([]),new Error("get token list info error");const T=[];let R=0;return y.forEach(L=>{const O=v.get(L.coinType);if(O){const f=L.totalBalance,P=ae(f,O.decimals).toString(),H=se(P,void 0,void 0,Ct.ROUND_DOWN).toString(),E={balance:f,balance_format:P,balance_display:H,balance_usd:"0",coin:O,coin_type:O==null?void 0:O.coin_type,price:"",price_diff_24:""};T.push(E),O.is_verified||R++}}),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",h),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",w.current),h===w.current&&(a(T),c(R),b([...T])),r(!1),T}}else r(!1),a([]);return[]},b=async h=>{i(!0);try{await u(h.filter(y=>y.coin.is_verified).map(y=>y.coin.coin_type),!0)}catch(y){console.error("fetch coin price info error",y)}finally{i(!1)}},k=h=>{h.forEach(y=>{const{coin:v}=y;if(v.is_verified){const T=g(v.coin_type);T&&(y.price=T.price,y.price_diff_24=T.price_change||"",y.balance_usd=B(y.balance_format).mul(T.price).toString())}})},D=async h=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:h,coinHoldingList:s,currentAccount:t}),t){const{search:y,current_sort:v,current_sort_order:T,is_show_unknown:R=!1,is_hide_small_balance:L=!0}=h;let O=[];if(R?O.push(...s):O=s.filter(f=>f.coin.is_verified),y){const f=y.toLowerCase();O=O.filter(P=>P.coin.coin_type.toLowerCase().includes(f)||P.coin.symbol.toLowerCase().includes(f)||P.coin.name.toLowerCase().includes(f))}return k(O),L&&!l&&(O=O.filter(f=>B(f.balance_usd).gt(.01))),O.sort((f,P)=>{if(v==="balance"){const H=B(f.balance_format).cmp(B(P.balance_format));if(H!==0)return T==="desc"?-H:H}if(v==="value"){const H=B(f.balance_usd).cmp(B(P.balance_usd));return H!==0?T==="desc"?-H:H:B(P.balance_format).cmp(B(f.balance_format))}if(v==="price"){const H=B(f.price).cmp(B(P.price));return H!==0?T==="desc"?-H:H:B(P.balance_format).cmp(B(f.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",O),O}return[]};return p.useEffect(()=>{k(s);const h=s.reduce((y,v)=>y+Number(v.balance_usd||0),0);n(h.toString())},[s,l]),{getFilterCoinHoldingList:D,fetchCoinHoldingList:d,resetUserData:()=>{a([]),n("0"),c(0)}}}function Ns({inputValue:t,changeInputValue:o}){const s=p.useRef(null),[a,r]=p.useState(!1);return V(),e.jsxs(gt,{w:a?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(ht,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(U,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:i=>{var n;(n=s.current)==null||n.focus(),r(!0)}})}),e.jsx(ft,{bg:"bg_secondary",ref:s,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:i=>{o(i.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{o(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:"28px",pl:a?"28px":"8px"}),t?e.jsx(mt,{right:"5px",children:e.jsx(U,{xlinkHref:"#icon-icon_close",onMouseDown:i=>i.preventDefault(),onClick:i=>{o(""),setTimeout(()=>{var n;(n=s.current)==null||n.focus()},0)}})}):null]})}function Vs({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:a,isHideLowAsset:r,handleIsHideLowAsset:i,unknownCoinCount:n}){return V(),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(C,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(S,{children:[e.jsx(Ns,{inputValue:t,changeInputValue:o}),e.jsx(K,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(S,{h:"100%",justify:"space-between",children:[e.jsxs(C,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",n,")"]}),e.jsx(Ee,{isChecked:s,onChange:a})]})}),e.jsx(K,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(S,{h:"100%",justify:"space-between",children:[e.jsx(C,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Ee,{isChecked:r,onChange:i})]})})]})]})}function Gs(){const{isApp:t}=V(),{getFilterCoinHoldingList:o}=ut(),{isCoinHoldingLoading:s,isCoinPriceLoading:a,unknownCoinCount:r}=Ce(),{isAutoRefresh:i}=Y(),[n,l]=p.useState([]),[c,x]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[g,u]=p.useState(!1),[w,d]=p.useState(!0),[b,k]=p.useState("desc"),[D,_]=p.useState(Le[2]),h=j=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",j),i||A(1),x(j),o(j).then(l)},y=j=>{h({...c,search:j})},v=(j,z)=>{h({...c,[j]:z}),j==="is_show_unknown"&&u(z),j==="is_hide_small_balance"&&d(z)},T=j=>{const z=(j==null?void 0:j.value)===(D==null?void 0:D.value),W=t||!z?"desc":b==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",W,j),_(j),k(W),h({...c,current_sort:j.value,current_sort_order:W})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,a,n),!s&&!a&&h(c)},[s,a]);const R=Re(),L=j=>{R(`/swap/${j}/''`)},[O,f]=p.useState([]),[P,H]=p.useState(0),[E,A]=p.useState(1),m=10;return p.useEffect(()=>{if((n==null?void 0:n.length)>0){const j=(E-1)*m;(n==null?void 0:n.length)<=j&&A(1)}},[n]),p.useEffect(()=>{if((n==null?void 0:n.length)>0){H(n==null?void 0:n.length);const j=(E-1)*m,z=j+m;console.log("ðŸš€ ~ useEffect ~ start:",E,n.slice(0,z),j,z),(n==null?void 0:n.length)>j&&f(n.slice(j,z))}else f([])},[E,n]),e.jsx(K,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(F,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Vs,{unknownCoinCount:r,inputValue:c.search||"",changeInputValue:y,isShowUnknownCoin:g,handleIsShowUnknownCoin:j=>v("is_show_unknown",j.target.checked),isHideLowAsset:w,handleIsHideLowAsset:j=>v("is_hide_small_balance",j.target.checked)}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(F,{w:"100%",position:"relative",gap:"20px",children:[!s&&!a&&(n==null?void 0:n.length)===0?e.jsx(ee,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(F,{w:"100%",gap:"4px",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(C,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(ws,{sortText:"Sort by",minW:"180px",currentSort:D,sortByList:Le,onSortByChange:T,xlinkHref:b==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>k(j=>j==="desc"?"asc":"desc")})]}),e.jsx(De,{rowKey:"coin_type",columns:Ve(b,D,T,L,!i&&a),dataSource:O,loading:!i&&(s||a),itemSkeletonLength:5,itemHeight:"30px",onRowClick:j=>{L(j==null?void 0:j.coin_type)}})]}):e.jsx(Ae,{rowKey:"coin_type",columns:Ve(b,D,T,L,!i&&a),dataSource:O,skeletonLength:5,loading:!i&&(s||a),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:j=>{L(j==null?void 0:j.coin_type)}}),(n==null?void 0:n.length)>m&&e.jsx(I,{children:e.jsx(we,{total:P,size:m,currentPage:E,onChange:j=>{A(j)}})})]})]})})}const Le=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Te=Object.fromEntries(Le.map(t=>[t.value,t])),Ve=(t,o,s,a,r)=>[{title:e.jsx(C,{children:"Token"}),key:"pool",thConfig:{w:"22%"},showLabel:!1,render:({coin:i})=>e.jsx(pt,{haveTooltip:!0,token:i,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(ve,{labelInfo:Te.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"20%"},render:({coin:i,balance_display:n})=>e.jsxs(C,{color:"text_caption",children:[n," ",yt(i==null?void 0:i.symbol,10)]})},{title:e.jsx(ve,{labelInfo:Te.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"20%"},render:({price:i,price_diff_24:n})=>{const l=B(n).gt(0);return e.jsx(S,{justify:"flex-end",children:e.jsx(J,{isLoaded:!r,children:e.jsxs(S,{gap:"2px",children:[e.jsxs(C,{color:"text_caption",children:["$",ot(i)]}),e.jsxs(C,{color:l?"primary_green":"primary_red",children:["(",l?"+":"",_t(B(n).mul(100).toString(),2,!1,!1),")"]})]})})})}},{title:e.jsx(ve,{labelInfo:Te.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"20%"},render:({balance_usd:i})=>e.jsx(S,{justify:"flex-end",children:e.jsx(J,{isLoaded:!r,children:e.jsx(C,{color:"text_caption",children:ie(i,2)})})})},{title:e.jsx(C,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"18%"},key:"actions",render:i=>e.jsx(X,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{a(i==null?void 0:i.coin_type)},children:"Swap"})}],qs=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),ye=nt(qs),Ks={cetus:{title:"CETUS Holdings",imgUrl:$.cetus_coin.logo_url,bg:"cetus_holding_bg"},xcetus:{title:"xCETUS Holdings",imgUrl:$.x_cetus_coin.logo_url,bg:"xcetus_holding_bg"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bg:"xcetus_rewards_bg"}};function ze({type:t,amount:o,amountUSD:s,isLoading:a,children:r}){const{title:i,imgUrl:n,bg:l}=Ks[t];return e.jsx(K,{flex:"1",bg:l,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(F,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(S,{children:[e.jsx(ke,{imageUrl:n,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(C,{children:i})]}),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsxs(F,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(J,{isLoaded:!a,h:"24px",children:e.jsx(C,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:o})}),s!==void 0&&e.jsx(J,{isLoaded:!a,h:"17px",children:e.jsxs(C,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ot(s,2)]})})]}),r]})]})})}function Is(){const{currentAccount:t}=M(),{balanceInfo:o}=Cs($.cetus_coin),{getTokenAmountValue:s}=pe(),{coinPriceObj:a}=Oe(),r=p.useMemo(()=>s($.cetus_coin.coin_type,ae((o==null?void 0:o.balance)||"0",$.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,a]),{setCurrentXCetusTab:i,setIsXCetusModalOpen:n}=ye(),l=()=>{n(!0),i("Get xCETUS")},{veNFT:c,veNFTLoading:x,lockCetusListLoading:g}=Q();return e.jsx(ze,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:r,isLoading:(g||x)&&c!==void 0,children:e.jsx(X,{onClick:l,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"12px",fontWeight:"500",children:"Convert to xCETUS"})})}function Qs(){const{lockCetusList:t,lockCetusListLoading:o}=Q(),[s,a]=p.useState([]),[r,i]=p.useState(0),[n,l]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const x=(n-1)*c;(t==null?void 0:t.length)<=x&&l(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){i(t==null?void 0:t.length);const x=(n-1)*c,g=x+c;console.log("ðŸš€ ~ useEffect ~ start:",n,t.slice(0,g),x,g),(t==null?void 0:t.length)>x&&a(t.slice(x,g))}},[n,t]),t&&t.length>0&&e.jsxs(F,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(C,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(F,{w:"100%",gap:"12px",children:s==null?void 0:s.map(x=>e.jsx(Ys,{order:x},x==null?void 0:x.id))}),(t==null?void 0:t.length)>c&&e.jsx(I,{children:e.jsx(we,{total:r,size:c,currentPage:n,onChange:x=>{l(x)}})})]})}const Ys=({order:t})=>{const[o,s]=p.useState(!1),{cancelOrderLoading:a,handleCancelOrder:r}=ps(),{claimOrderLoading:i,handleClaimOrder:n}=xs(),{days:l,hours:c,minutes:x,seconds:g}=us(t.locked_until_time*1e3,()=>{s(!0)},"days"),u=w=>{w?n(t.id):r(t)};return p.useEffect(()=>{s(!it.isLocked(t))},[t.id]),e.jsxs(S,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",children:[o?e.jsxs(S,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(U,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(C,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(S,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(U,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(N,{as:"div",children:[e.jsxs(C,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(C,{as:"span",color:"text_caption",fontSize:"13px",children:[l,"d : ",c,"h : ",x,"m : ",g,"s"]})]})]}),e.jsxs(S,{gap:"12px",children:[e.jsx(gs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(X,{onClick:()=>{a||i||u(o)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:a||i,color:o?"background":"primary_gray",bg:o?"primary":"card_bg",children:o?"Claim":"Cancel"})]})]})};function Zs({totalRewardValue:t,rewardList:o,summaryRewardList:s}){const{currentAccount:a}=M(),{veNFTLoading:r}=Q(),{claimRewardLoading:i,handleClaimReward:n}=hs(),l=()=>{i||n(o)};return V(),e.jsx(ze,{type:"rewards",amount:a?e.jsx(le,{tooltip:e.jsx(F,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(c=>(console.log("ðŸš€ ~ {yieldList?.map ~ item:",c),e.jsxs(S,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(pt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(S,{gap:"4px",children:[e.jsx(C,{fontSize:"12px",color:"text_caption",children:se(c==null?void 0:c.amount,6)}),e.jsxs(C,{fontSize:"12px",children:["(",ie(c==null?void 0:c.value,2),")"]})]})]},c.coin_type)))}),children:e.jsx(C,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:ie(t,2)})}):"--",isLoading:r,children:e.jsx(X,{onClick:l,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"12px",fontWeight:"500",children:"Claim"})})}function Js(){const{currentAccount:t}=M(),{veNFT:o,veNFTLoading:s,lockCetusListLoading:a}=Q(),{getTokenAmountValue:r}=pe(),{coinPriceObj:i}=Oe(),n=p.useMemo(()=>r($.cetus_coin.coin_type,ae((o==null?void 0:o.xcetus_balance)||"0",$.x_cetus_coin.decimals)).toString(),[o==null?void 0:o.xcetus_balance,t==null?void 0:t.address,i]),{setCurrentXCetusTab:l,setIsXCetusModalOpen:c}=ye(),x=()=>{c(!0),l("Redeem CETUS")},g=(a||s)&&o!==void 0;return e.jsx(ze,{type:"xcetus",amount:t?se(ae((o==null?void 0:o.xcetus_balance)||"0",9),9).toString():"--",amountUSD:n,isLoading:g,children:e.jsx(X,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"12px",fontWeight:"500",children:"Redeem"})})}const ge=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function en({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:a,setCurrentXCetusTab:r}=ye(),[i,n]=p.useState("#icon-a-icon_trade"),l=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},x=()=>{var u;const g=(u=ge==null?void 0:ge.find(w=>(w==null?void 0:w.value)!==a))==null?void 0:u.value;g&&r(g)};return e.jsxs(Ke,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Ie,{}),e.jsxs(Qe,{children:[e.jsx(Ye,{p:"0 16px",children:e.jsx(N,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:ge,currentTab:a,handleChangeTab:g=>{r(g==null?void 0:g.value)}})})}),e.jsx(Ze,{}),e.jsxs(Je,{p:"20px 16px 16px",children:[a==="Get xCETUS"&&e.jsx(fs,{onClose:o,availableXCetusAmount:s,onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}}),a==="Redeem CETUS"&&e.jsx(ms,{onClose:o,availableXCetusAmount:ae(s,9),onIconClick:x,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:l,onMouseLeave:c}})]})]})]})}function tn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=ye(),{availableXCetusAmount:s,totalRewardValue:a,rewardList:r,summaryRewardList:i}=js();return e.jsx(K,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(F,{w:"100%",gap:"16px",children:[e.jsxs(S,{w:"100%",gap:"10px",children:[e.jsx(Js,{}),e.jsx(Is,{}),e.jsx(Zs,{totalRewardValue:a,rewardList:r,summaryRewardList:i})]}),e.jsx(jt,{orientation:"horizontal"}),e.jsx(Qs,{}),t&&e.jsx(en,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})})}function sn(){const{currentAccount:t}=M(),{orderListLoading:o,myOrderList:s}=xe(),{isAutoRefresh:a,dcaOrderListLoading:r,dcaActiveOrderList:i}=Y(),{getTokenAmountValue:n,coinPriceObj:l}=pe(),c=p.useMemo(()=>{let u=B(0);if(a||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(w=>{const{pay_coin:d,target_coin:b,un_claimed_amount:k,remaining_amount:D}=w,_=n(d.coin_type,D),h=n(b.coin_type,k);u=B(u).plus(_).plus(h),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",u.toString())}),u.toString()):"0"},[a,s,t==null?void 0:t.address,o,l]),x=p.useMemo(()=>{let u=B(0);if(a||!r)return(i==null?void 0:i.length)>0&&(t!=null&&t.address)?(i.forEach(w=>{const{inBalance:d,inCoin:b,outBalance:k,outCoin:D}=w,_=n(b.coin_type,d),h=n(D.coin_type,k);u=B(u).plus(_).plus(h),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",u.toString())}),u):"0"},[a,i,t==null?void 0:t.address,r,l]),g=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",x,c),x&&c){let u=B(0);return u=B(u).plus(x).plus(c),u.toString()}return"--"},[x,c]);return{limitTotalTvl:c,dcaTotalTvl:x,orderTotalTvl:g}}function nn(){const{currentAccount:t}=M(),{isAutoRefresh:o}=Y(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:r}=Q(),{getTokenAmountValue:i}=pe(),{coinPriceObj:n}=Oe();return{xCetusTotalTvl:p.useMemo(()=>{if(o||!a&&!r)return t!=null&&t.address&&s?i($.cetus_coin.coin_type,ae(s==null?void 0:s.xcetus_balance,$.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,r,a,t==null?void 0:t.address,n])}}const on="fetch-coin-holding-list",an="fetch-owner-nft",rn="fetch-active-order-list",ln="fetch-xcetus-base-info";function cn(){const{currentAccount:t}=M(),{getTokenListInfo:o}=dt(),{getLimitUserIndexer:s,getDcaUserIndexer:a}=bs(),{setOrderListLoading:r,setMyOrderList:i}=xe(),{setDcaOrderListLoading:n,setDcaActiveOrderList:l,setDcaPastOrderList:c}=Y(),{refreshCoinPriceInfo:x}=He(),{buildDcaOrderList:g}=Ut(),{peripherySdk:u}=be(),{formatLimitOrderList:w}=It(),d=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{d.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const b=async()=>{if(t){r(!0);const h=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",h),h)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(h)).data.map(T=>T.name.value)}catch(y){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",y)}}return[]},k=async()=>{if(t){n(!0);const h=await a(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",h),h)try{return(await u.ClmmSDK.fullClient.getDynamicFieldsByPage(h)).data.map(T=>T.name.value)}catch(y){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",y)}}return[]};return{fetchActiveOrderList:async()=>{try{const h=await b(),y=await k(),v=await u.ClmmSDK.fullClient.batchGetObjects([...h,...y],{showType:!0,showContent:!0}),T=v.filter(m=>{var j,z;return(z=(j=m.data)==null?void 0:j.type)==null?void 0:z.includes("limit_order::LimitOrder")}),R=v.filter(m=>{var j,z;return(z=(j=m.data)==null?void 0:j.type)==null?void 0:z.includes("order::Order")}),O=T.map(m=>St.buildLimitOrderInfo(m)).filter(m=>m!==void 0).filter(m=>m.status===Me.PartialCompleted||m.status===Me.Running),f=R.map(m=>{var q,ne,ce,G,de,oe,ue,Be;const j=fe(((q=m.data)==null?void 0:q.type)||""),z=j.type_arguments[0],W=j.type_arguments[1];return{in_coin_type:z,out_coin_type:W,...(ce=(ne=m.data)==null?void 0:ne.content)==null?void 0:ce.fields,id:(ue=(oe=(de=(G=m.data)==null?void 0:G.content)==null?void 0:de.fields)==null?void 0:oe.id)==null?void 0:ue.id,version:(Be=m.data)==null?void 0:Be.version}}),P=new Set;for(const m of O)P.add(m.pay_coin_type),P.add(m.target_coin_type);for(const m of f)P.add(m.in_coin_type),P.add(m.out_coin_type);await o(Array.from(P));const H=await w(O);i(H);const{activeResult:E,pastResult:A}=await g(f);d.current===(t==null?void 0:t.address)&&(l(E),c(A),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",H),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",f)),x(Array.from(P))}catch(h){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",h)}finally{r(!1),n(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),i([]),l([]),c([])}}}function dn(){const{currentAccount:t}=M(),{clmmSdk:o}=at(),{xCetusSdk:s}=be(),{buildFarmsPositionType:a,buildBurnPositionType:r}=Zt(),{setPosBaseList:i,setFullRangePosBaseList:n,setPosBaseListLoading:l}=re(),{setVeNFT:c,setVeNFTLoading:x,setLockCetusList:g,clearData:u,setLockCetusListLoading:w}=Q(),{formatPosBaseList:d}=ct(),b=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const _=b.current;if(_){l(!0),x(!0);const h=await o.fullClient.getOwnedObjectsByPage(_,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:$.clmm_sdk_options.clmm_pool.package_id},{StructType:a},{StructType:r},{StructType:ys},{StructType:_s}]}});let y=await d(h);i(y),l(!1),(y==null?void 0:y.length)==0&&n([]);const v=Ss(h.data);if(v&&_===b.current){c(v,_);const T=await vs(h.data,s);console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList:",T),g(T)}else w(!1);return{veNFT:v,posBaseList:y}}}catch(_){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",_),_ instanceof TypeError&&(l(!1),i([]))}finally{l(!1),x(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{i([]),u()}}}function pn(){const{currentAccount:t}=M(),{peripherySdk:o}=be(),{clmmSdk:s}=at(),{getPosRelatedData:a,getPositionBaseList:r}=ct(),{getPosPoolsOriginalObj:i,getPosPoolsRelatedData:n}=Jt(),{getPosLiquidityData:l}=es(),{setPosLiquidityData:c,setFarmsPosRewardsData:x,setFarmsPosRewardsDataLoading:g,setPosRewardsData:u,setPosRewardsDataLoading:w,setPosFeeData:d,setPosFeeDataLoading:b}=re(),{formatFarmsRewardsData:k}=ts(),{formatPosRewardsData:D}=ss(),{formatPosFeeData:_}=ns(),{posBaseList:h,setShowPosListLength:y,setMyPosYieldValue:v}=re(),{refreshCoinPriceInfo:T}=He(),R=async f=>{var A;const P=f.filter(m=>m.posType==="farms"&&m.farmsPool),H=await i(f);if(n(f,H),t!=null&&t.address){const m=await r(t==null?void 0:t.address);a(m)}if(((A=Object.keys(H))==null?void 0:A.length)===0)throw c({}),new Error("No pool data found");l(f,H);const E=new vt;P.length>0&&P.forEach(m=>{o.Farms.buildCalculateFarmingReward({pool_id:m.farmsPool,position_nft_id:m.id},E)}),f.forEach(m=>{s.Rewarder.buildFetchPosFee({poolAddress:m.clmmPool,positionId:m.posId,coinTypeA:m.coinTypeA,coinTypeB:m.coinTypeB},E)}),f.filter(m=>m.posType!=="farms").forEach(m=>{const j=H[m.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:m.clmmPool,positionId:m.posId,coinTypeA:m.coinTypeA,coinTypeB:m.coinTypeB,rewarderInfo:j.rewarder_infos},E)});try{g(!0),w(!0),b(!0);const m=await s.fullClient.devInspectTransactionBlock({transactionBlock:E,sender:Tt("0x0")}),j=o.Farms.parsedPosRewardData(m),z=s.Rewarder.parsedPosRewardData(m),W=s.Rewarder.parsedPosFeeData(m);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:j,clmmRewardData:z,clmmFeeData:W});const q=await k(j);x(q);const ne=await D(Object.values(z).map(G=>{const de=H[f.find(oe=>oe.posId===G.position_id).clmmPool];return{poolAddress:de.pool_address,positionId:G.position_id,rewarderAmountOwed:G.rewarder_amount.map((oe,ue)=>({coin_address:de.rewarder_infos[ue].coinAddress,amount_owed:new _e(oe)}))}}));u(ne);const ce=await _(Object.values(W).map(G=>({position_id:G.position_id,feeOwedA:new _e(G.fee_owned_a),feeOwedB:new _e(G.fee_owned_b)})),f);d(ce),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:ce,posRewardsData:ne,posFarmsRewardsObj:q}),L(ne,q)}catch(m){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",m)}finally{g(!1),w(!1),b(!1)}},L=async(f,P)=>{const H=[];if(h.length>0){h.map(A=>{H.push(fe(A==null?void 0:A.coinTypeA).full_address),H.push(fe(A==null?void 0:A.coinTypeB).full_address);const m=f[A==null?void 0:A.posId]||[],j=P[A==null?void 0:A.id]||[],z=m.concat(j);z==null||z.map(W=>{var q;kt(W==null?void 0:W.display_amount_owed).gt(0)&&H.push(fe((q=W==null?void 0:W.token)==null?void 0:q.coin_type).full_address)})});const E=Array.from(new Set(H));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",E),T(E)}};return{fetchPosRelatedData:R,resetUserData:()=>{c({}),x({}),u({}),d({})}}}function xn(){const{currentAccount:t}=M(),{setXCetusManager:o,setDividendManager:s}=Q(),{xCetusSdk:a}=be();return{fetchXCetusBaseInfo:async i=>{try{const{xcetus:n,xcetus_dividends:l}=$.xcetus_sdk_options,{dividend_manager_id:c}=We(l),{xcetus_manager_id:x}=We(n),g=await a.fullClient.batchGetObjects([x,c],{showType:!0,showContent:!0}),u=g.find(d=>{var b,k;return(k=(b=d.data)==null?void 0:b.type)==null?void 0:k.includes("xcetus::XcetusManager")});if(u){const d=Xe(u),b={id:d.id.id,index:Number(d.index),has_venft:{handle:d.has_venft.fields.id.id,size:d.has_venft.fields.size},nfts:{handle:d.nfts.fields.id.id,size:d.nfts.fields.size},total_locked:d.total_locked,treasury:d.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",b),o(b)}const w=g.find(d=>{var b,k;return(k=(b=d.data)==null?void 0:b.type)==null?void 0:k.includes("dividend::DividendManager")});if(w){const d=Xe(w),b=it.buildDividendManager(d);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",b),a.XCetusModule.updateCache(`${c}_getDividendManager`,b),s(b)}}catch(n){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",n)}}}}function un(t){const{currentAccount:o}=M(),{fetchCoinHoldingList:s,resetUserData:a}=ut(),{fetchPosRelatedData:r,resetUserData:i}=pn(),{fetchActiveOrderList:n,resetUserData:l}=cn(),{setAutoRefreshCount:c}=Y(),{fetchOwnerNFT:x,resetUserData:g}=dn(),{fetchXCetusBaseInfo:u}=xn(),{addTask:w,removeTask:d}=ks(),[b,k]=p.useState([]),D=p.useRef(o),{fetchOwnerLockCetusList:_}=Ts(),{setOrderListLoading:h}=xe(),{setLockCetusListLoading:y}=Q(),{setPosBaseListLoading:v}=re(),{setIsCoinHoldingLoading:T}=Ce(),R=()=>{a(),i(),l(),g()};p.useEffect(()=>{var A,m;o?((A=D.current)!=null&&A.address&&((m=D.current)==null?void 0:m.address)!==(o==null?void 0:o.address)&&(c(!1),R(),b.forEach(j=>{d(j.id)})),H()):(R(),b.forEach(j=>{d(j.id)})),D.current=o},[o==null?void 0:o.address]);const L={id:on,run:s},O={id:an,run:x,onSuccess:A=>{const{veNFT:m,posBaseList:j}=A;r(j),m&&(o!=null&&o.address)&&_(o==null?void 0:o.address)}},f={id:ln,run:u},P={id:rn,run:n},H=()=>{const A=[];h(!0),y(!0),v(!0),T(!0),t==="wallet"?A.push(L,O,P,f):t==="liquidity"?A.push(O,L,P,f):t==="orders"?A.push(P,L,O,f):A.push(O,f,L,P),k(A),A.forEach(m=>{w(m)})};return{refreshTask:()=>{o&&(b.forEach(A=>{d(A.id)}),H())}}}const he=t=>t?ie(t,2):"$--",gn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),B(0)).toString();function jo(){const{tab:t}=cs(),{currentAccount:o,onWalletModal:s}=M(),a=Re(),{posBaseListLoading:r,posLiquidityDataLoading:i}=re(),{holdingsTotalUsd:n,isCoinPriceLoading:l,isCoinHoldingLoading:c}=Ce(),{clmmTotalTvl:x}=rs(),{orderTotalTvl:g}=sn(),{orderListLoading:u}=xe(),{isAutoRefresh:w,dcaOrderListLoading:d,setAutoRefreshCount:b,resetAutoRefreshCount:k}=Y(),{xCetusTotalTvl:D}=nn(),{lockCetusListLoading:_,veNFTLoading:h,veNFT:y}=Q(),v=p.useMemo(()=>t||"wallet",[t]),{refreshTask:T}=un(v),R=!w&&(c||l),L=!w&&(r||i),O=!w&&(u||d),f=!w&&(_||h),P=p.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",n,x,g,D),{wallet:{totalValue:he(n),isLoading:R},liquidity:{totalValue:he(x),isLoading:L},orders:{totalValue:he(g),isLoading:O},xCetus:{totalValue:he(D),isLoading:f}}),[n,x,g,D,R,L,O,f]),H=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],E=p.useMemo(()=>gn(D,x,g,n),[D,x,g,n]);p.useEffect(()=>k(!1),[]);const[A,m]=p.useState(!1);p.useEffect(()=>{m(!0)},[]);const{isApp:j}=V();return j?e.jsx(Ls,{totalValue:E,onRefreshTask:T,isLoading:!w&&(h||r||u||d),children:e.jsx(Ne,{tabList:H,activeTab:v,tabData:P,onClickTab:z=>a(`/profile?tab=${z}`)})}):e.jsx(F,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:A?o!=null&&o.address?e.jsxs(F,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Es,{handleRefresh:z=>{b(!z),T()},totalValue:E,isLoading:!w&&(h||r||u||d)}),e.jsx(Ne,{tabList:H,activeTab:v,tabData:P,onClickTab:z=>a(`/profile?tab=${z}`)}),v==="wallet"&&e.jsx(Gs,{}),v==="liquidity"&&e.jsx(Us,{}),v==="orders"&&e.jsx(Bs,{}),v==="xCetus"&&e.jsx(tn,{})]}):e.jsx(ee,{type:"nowallet",mt:"20px",onboard:()=>s(!0)}):e.jsx(qe,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Pe,{})})})}export{jo as default};
//# sourceMappingURL=Profile-Cw1laWBH.js.map

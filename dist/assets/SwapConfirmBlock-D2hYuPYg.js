import{A as K}from"./aggregator-BrDeYX5Q.js";import{u as gs}from"./useTransaction-DufWKloO.js";import{u as Oe}from"./global-BGM_JGXL.js";import{i as bs,u as js}from"./index-DlHtnhe7.js";import{u as ms}from"./useAccountBalance-Uh8Ya-Fn.js";import{n as ys,V as ws,w as Te,bN as We,r as _s,z as M,t as Ss,bO as he,aR as vs,C as U,a4 as Fe,bP as Rs,j as As,a0 as Ce,X as De,F as zs,I as ee,d as Is,a as ge,c as W,e as Ps,Z as Ne,$ as Hs,G as $s,v as Ts,p as Ws}from"./index-6SCcgYCo.js";import{a,as as Fs,ab as Ls,j as e,H as u,T as d,C as k,u as A,V as z,f as I,P as Ve,h as Ge,k as Ke,m as Ye,n as qe,ag as Es,S as $,X as Ms,Y as Us,Z as Bs,$ as Os,a0 as Cs,a1 as Ds,v as pe}from"./vendor-DXHkIl66.js";import{u as be}from"./useToken-D1jN84rx.js";import{u as Le}from"./useTokenBalance-DJ7wgCGX.js";import{u as Ns}from"./useFindBestRouting-WCMAadkq.js";import{b as Xe,A as fe,c as Vs}from"./useSwapHelper-DzQfyyBX.js";import{v as Ee}from"./v4-C6aID195.js";import{M as Gs,a as Ks,u as Ze}from"./usePriceImpact-D03-VFoK.js";import{C as je}from"./CurrentPrice-CcctJf4w.js";import{H as Ys}from"./HighlightText-BLaAjUt8.js";import{g as le}from"./index-BXsA8z0Q.js";import{A as Me}from"./SingleTokenInfo-OPtPhuNX.js";import{H as Ue}from"./HTextLabelBox-xcnODRJZ.js";import{T as qs}from"./TradeConfirmAmountInfo-DeBtR7LK.js";import{b as Xs}from"./TradeInputGroup-D2XrXVhF.js";var Zs=1,Js=4;function Qs(t){return Xs(t,Zs|Js)}function Be(t){const[p,s]=a.useState(),r=async l=>{if(l.is_verified===void 0?l.is_trusted:l.is_verified)return!1;try{const i=await bs(l.coin_type);return console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:24 ~ checkIsScamsCoin ~ isScamsCoin:",i),i}catch(i){console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:19 ~ checkTokenScams ~ error:",i)}return!1};return a.useEffect(()=>{s(void 0),t&&r(t).then(l=>{s(l)})},[t==null?void 0:t.coin_type]),{isScamsCoin:p}}const ks="0xeb863165a109f7791a3182be08aff1438ab2a429314fc135ae19d953afe1edd6";function zr(t,p){const{fromCoin:s,toCoin:r,setFromCoin:l,setToCoin:o,setToAmount:i,fromAmount:f,toAmount:c,setFromAmount:x,routerData:b,setFindRouterLoading:j,setRouterData:h,setByAmountIn:S,byAmountIn:v}=t,{from:w,to:g}=Fs(),{findBestRouters:_,checkProvidersKeys:R}=Ns(),{fetchTokenPrices:P,getTokenAmountValue:H}=ys(),{slippage:T,mevProtect:B,maxCapForGas:C,transactionMode:se,customGasPrice:xe}=Oe(),{aggregatorSDK:re}=ws(),m=Ls(),{fetchTokenInfo:te}=be(),[ae,ie]=a.useState(!1),{signAndExecuteTransaction:es,transactionConfirmation:ss}=gs(),{providersSwitchStates:me,supportOrderSplit:ir}=js(),{fetchAccountBalance:rs}=ms(),{balanceInfo:ts}=Le(s),{balanceInfo:is}=Le(r),os=H(s==null?void 0:s.coin_type,f),ns=H(r==null?void 0:r.coin_type,c),[ye,we]=a.useState(""),_e=a.useRef(""),oe=a.useRef(!0),Y=a.useRef(""),q=a.useRef(""),X=a.useRef(),Z=a.useRef(),Se=a.useRef([]);a.useEffect(()=>{X.current=s},[s]),a.useEffect(()=>{Z.current=r},[r]),a.useEffect(()=>{_e.current=ye},[ye]),a.useEffect(()=>{oe.current=v},[v]),a.useEffect(()=>{Y.current=f},[f]),a.useEffect(()=>{q.current=c},[c]);const cs=a.useMemo(()=>String(g)+String(w),[w,g]);a.useEffect(()=>{p||ps()},[cs]);const ps=a.useCallback(()=>{!w&&!g?(l(Te.clmm_swap.from_coin),o(Te.clmm_swap.to_coin),m("/swap")):(w&&We(w)?te(w).then(n=>{n?(n==null?void 0:n.coin_type)!==(s==null?void 0:s.coin_type)&&l(n):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):l(void 0),g&&We(g)?te(g).then(n=>{n?(n==null?void 0:n.coin_type)!==(r==null?void 0:r.coin_type)&&o(n):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):o(void 0))},[w,g]),ve=_s(async(n,y,F)=>{if(X.current&&Z.current&&+n){const O=p?Object.entries(K).map(([E,V])=>E):Object.entries(me).filter(([E,V])=>V===!0).map(([E,V])=>E);(+Y.current||+q.current)&&j(!0);const N=await R(O),Ae=Ss(n,y?X.current.decimals:Z.current.decimals),L=await _({fromToken:X.current,toToken:Z.current,amount:Ae.toString(),providersKeys:N,by_amount_in:y,uuid:F});j(!1),_e.current===F&&(Se.current=N,y?+Y.current?(i(L.toAmountUi||""),h(L)):i(""):+q.current?(x(L.fromAmountUi||"ÃŸ"),h(L)):x(""))}else J(!y)},500),ls=(n,y,F=!1)=>{if(S(y),y?(x(n),F&&i("")):(i(n),F&&x("")),+n){const O=Ee();we(O),ve(n,y,O)}else j(!1),h(void 0),n!=="0"?J():y?i(""):x("")},D=()=>{const n=oe.current?Y.current:q.current;if(console.log("ðŸš€ ~ file: useSwap.ts:273 ~ reCalculateRouteData ~ amount:",n,oe.current,Y.current,q.current),+n){const y=Ee();we(y),ve(n,oe.current,y)}};a.useEffect(()=>{D()},[JSON.stringify(me)]);const xs=a.useCallback((n,y=!0)=>{J(),p?y?(n&&M((n==null?void 0:n.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")&&o(s),l(n)):(n&&M((n==null?void 0:n.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")&&l(r),o(n)):y?n&&M((n==null?void 0:n.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")?m(`/swap/${n==null?void 0:n.coin_type}/${s==null?void 0:s.coin_type}`):m(`/swap/${n==null?void 0:n.coin_type}/${r==null?void 0:r.coin_type}`):n&&M((n==null?void 0:n.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")?m(`/swap/${r==null?void 0:r.coin_type}/${n==null?void 0:n.coin_type}`):m(`/swap/${s==null?void 0:s.coin_type}/${n==null?void 0:n.coin_type}`)},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),{amountLimit:as}=Xe(T,b),J=n=>{n===void 0?(x(""),i("")):n?x(""):i(""),j(!1),h(void 0)};a.useEffect(()=>{Re()},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const Re=()=>{const n=[];s&&n.push(s.coin_type),r&&n.push(r.coin_type),n.length>0&&P(n)},us=()=>({...b}),ds=async n=>{var F,O;let y;try{const{routerData:N,byAmountIn:Ae,fromAmountUi:L,toAmountUi:E}=n,V=new vs,G={routers:N,partner:ks,txb:V,slippage:Number(T),refreshAllCoins:!0};ie(!1),console.log("ðŸš€ ~ file: useSwap.ts:261 ~ doSwapAction ~ params:",G),y={isSwapWidget:p,actionType:"swap",getShowInfo:(Ie,ue)=>{const de=`Swapping ${U(L)} ${s==null?void 0:s.symbol} for ${U(E)} ${r==null?void 0:r.symbol}`,Q={modalDescriptionText:de,toastTitleText:de};if(Ie==="success"){let Pe=L,He=E;ue&&(Pe=Fe(ue,s)||L,He=Fe(ue,r)||E);const $e=`Swapped ${U(Pe)} ${s==null?void 0:s.symbol} for ${U(He)} ${r==null?void 0:r.symbol}`;Q.toastDescriptionContent=$e,Q.modalDescriptionText=$e,Q.toastTitleText="Swap Successful"}return Ie==="rejected"&&(Q.toastTitleText=de.replace("Swapping","Swap")),Q}},p||ss(y);const ze=await es(async()=>(await re.fastRouterSwap(G),V),y,{useMev:B,useFastMode:se==="Fast Mode",maxCapForGas:C,customGasPrice:xe,msafeParams:{action:"AggregatorSwap",txbParams:{...G,routers:Rs(G==null?void 0:G.routers)}},otherParams:{routerData:t.routerData,providerKey:Se.current,from:(F=X.current)==null?void 0:F.coin_type,to:(O=Z.current)==null?void 0:O.coin_type}});return console.log("ðŸš€ ~ file: useSwap.ts:272 ~ doSwapAction ~ res:",ze),ze?(J(),rs(),!0):(D(),!1)}catch(N){console.log("ðŸš€ ~ doSwapAction ~ error text:",N)}},{isScamsCoin:ne}=Be(s),{isScamsCoin:ce}=Be(r),hs=a.useMemo(()=>{if(!(!ne&&!ce)){if(ne&&ce&&(s!=null&&s.symbol)&&(r!=null&&r.symbol))return`${s==null?void 0:s.symbol} and ${r==null?void 0:r.symbol} are`;if(ne&&(s!=null&&s.symbol))return`${s==null?void 0:s.symbol} token is `;if(ce&&(r!=null&&r.symbol))return`${r==null?void 0:r.symbol} token is `}},[ne,ce,s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),fs=async n=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useSwap.ts:491 ~ onReverseClick ~ isOpenAggregatorMode:",n),n?(p?(l(r),o(s)):(l(r),o(s),m(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`)),x(c),i(""),S(!0),await he(200),D()):v?(p?(l(r),o(s)):m(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`),x(""),i(f),S(!1),await he(200),D()):(p?(l(r),o(s)):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`),x(c),i(""),S(!0),await he(200),D())};return a.useEffect(()=>()=>{p||(l(void 0),o(void 0)),x(""),i("")},[]),{handleSelectToken:xs,handleAmountChange:ls,fromAmount:f,toAmount:c,fromAmountValue:os,toAmountValue:ns,amountLimit:as,getSwapSecondaryData:us,reCalculateRouteData:D,fromBalanceInfo:ts,toBalanceInfo:is,doSwapAction:ds,scamsText:hs,refreshMarketPrice:Re,isOpenConfirmModel:ae,setIsOpenConfirmModel:ie,resetInputAmount:J,onReverseClick:fs}}function Ir(t,p,s,r,l,o){const{currentAccount:i}=As(),f=a.useMemo(()=>{const c={text:"Swap",disabled:!1};if(!(i!=null&&i.address))return c.text="Connect Wallet",c.disabled=!1,c;if(!r||!l)return c.text="Select a token",c.disabled=!0,c;if(!+t&&!+p)return c.text="Enter an amount",c.disabled=!0,c;if(o&&o.errorCode){if(o.errorCode===fe.InsufficientLiquidity)return c.text="Insufficient liquidity for this trade",c.disabled=!0,c;if(o.errorCode===fe.NoRouter||o.errorCode===fe.HoneyPot)return c.text="No Available Route",c.disabled=!0,c}return+t&&Ce(t).gt(s||0)?(c.disabled=!0,c.text=`Insufficient ${De(r==null?void 0:r.symbol,10)} Balance`,c):((!+t||!+p)&&(c.disabled=!0),c)},[i==null?void 0:i.address,t,p,s,o==null?void 0:o.errorCode,r,l]);return{btnText:f.text,btnDisabled:f.disabled}}function Je(t){const{fromToken:p,toToken:s,marketPrice:r,priceImpact:l,sources:o=[],isWidget:i=!1,isLoading:f}=t;return e.jsxs(u,{justify:"space-between",w:"100%",gap:"4px",flexWrap:"wrap",children:[e.jsxs(u,{w:"132px",alignItems:"end",gap:"4px",children:[e.jsx(d,{whiteSpace:"nowrap",fontSize:i?"12px":"14px",h:"20px",lineHeight:"20px",fontWeight:"500",children:"Price Difference"}),e.jsx(zs,{tooltip:e.jsx(er,{marketPrice:r,sources:o,fromToken:p,toToken:s}),children:e.jsx(k,{children:e.jsx(ee,{xlinkHref:"#icon-icon_tips",svgW:"20px",svgH:"20px"})})})]}),e.jsx(A,{isLoaded:!f,h:"20px",children:e.jsxs(u,{justify:"flex-end",children:[e.jsx(d,{maxW:i?`calc(90vw - 56px - ${24*((o==null?void 0:o.length)||0)}px)`:"unset",flex:"1",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:l==null?void 0:l.textColor,fontWeight:"500",fontSize:i?"12px":"14px",children:l!=null&&l.priceImpactText?l==null?void 0:l.priceImpactText:"Incalculable"}),o==null?void 0:o.map(c=>e.jsx(Gs,{market:c},c))]})})]})}function er(t){const{marketPrice:p,sources:s,fromToken:r,toToken:l}=t;return e.jsxs(z,{className:"no-close-widget-flag",w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(d,{color:"content_text",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The difference between the market price and estimated price due to trade size."}),e.jsxs(z,{w:"100%",align:"flex-start",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:"Market price sources:"}),p?e.jsx(je,{fontSize:"12px",fromToken:r,toToken:l,fromValue:"1",toValue:p,color:"text_caption"}):e.jsx(d,{color:"primary_yellow",fontSize:"12px",children:"Price is unknown"})]}),p&&e.jsxs(u,{w:"100%",children:[e.jsx(d,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:"Market price sources:"}),e.jsx(d,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:s.map(o=>Ks[o]+"  ")})]})]})}function Pr(t){const{fromCoin:p,toCoin:s,findRouterLoading:r,isWidget:l=!1,routerData:o,bg:i="primary_opacity.10"}=t,{marketPrice:f,priceImpact:c,sources:x,priceImpactTextInfo:b,hideShowPriceImpact:j}=Ze(p,s,o==null?void 0:o.fromAmountUi,o==null?void 0:o.toAmountUi);return e.jsxs(z,{w:"100%",p:"8px",gap:"8px",bg:i,borderRadius:"12px",align:"flex-start",children:[e.jsx(je,{fromToken:p,toToken:s,fromValue:o==null?void 0:o.fromAmountUi,toValue:o==null?void 0:o.toAmountUi,isLoading:r,color:"text_caption",fontSize:l?"12px":"14px"}),!j&&Is(c).lte(-30)&&e.jsxs(u,{w:"100%",justify:"flex-start",children:[e.jsx(ee,{xlinkHref:"#icon-warning",svgFill:"primary_red",svgHover:"primary_red",fontSize:"16px"}),e.jsx(d,{color:"primary_red",fontSize:"12px",lineHeight:"20px",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})]}),!j&&e.jsx(Je,{fromToken:p,isWidget:l,toToken:s,marketPrice:f,priceImpact:b,isLoading:r,sources:x})]})}function Hr({scamsText:t}){return e.jsxs(z,{borderRadius:"8px",border:"1px solid",borderColor:"border",pt:"12px",maxW:"480px",children:[e.jsxs(u,{children:[e.jsx(ee,{xlinkHref:"#icon-icon_priceupdated",svgFill:"primary_yellow",svgHover:"primary_yellow",svgW:"20px",svgH:"20px"}),e.jsx(d,{color:"primary_yellow",children:"Alert"})]}),e.jsx(I,{bg:"card_bg",borderRadius:"8px",p:"11px",children:e.jsx(Ys,{text:`${t}  detected to have Deny List feature. It's an optional feature on Sui designed for regulated coins (learn more). However, it could be misused by HoneyPot scams, which may restrict users from selling the tokens after buying. Please be cautious.`,keywords:["learn more"],onKeywordClick:()=>{window.open("https://docs.sui.io/guides/developer/coin/regulated","_blank")}})})]})}const Qe=({data:t,children:p,loading:s,isSwapWidget:r})=>{var x,b,j;const{getTokenListInfo:l}=be(),{isApp:o}=ge(),[i,f]=a.useState(new Map),c=async()=>{var h,S,v;if(t&&(t!=null&&t.routers)&&((h=t==null?void 0:t.routers)==null?void 0:h.length)>0){const w=[];(v=(S=t==null?void 0:t.routers[0])==null?void 0:S.paths)==null||v.forEach(_=>{w.push(_==null?void 0:_.from_type),w.push(_==null?void 0:_.to_type)});const g=await l(w);g&&f(g)}};return a.useEffect(()=>{c()},[t==null?void 0:t.routers]),(t==null?void 0:t.providers)&&e.jsx(A,{isLoaded:!s,minW:"128px",minH:"20px",lineHeight:"20px",children:e.jsxs(u,{w:"100%",gap:"4px",align:"center",justify:"flex-end",wrap:"wrap",children:[(t==null?void 0:t.router_summery)!=="1 Streams"?e.jsx(d,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",overflowWrap:"break-word",children:t==null?void 0:t.router_summery}):e.jsx(e.Fragment,{children:e.jsx(d,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",textAlign:"right",overflowWrap:"break-word",children:(b=(x=t==null?void 0:t.routers[0])==null?void 0:x.paths)==null?void 0:b.map((h,S)=>{var v,w,g;return S===0?`${(v=i==null?void 0:i.get(h==null?void 0:h.from_type))==null?void 0:v.symbol} > ${(w=i==null?void 0:i.get(h==null?void 0:h.to_type))==null?void 0:w.symbol}`:(g=i==null?void 0:i.get(h==null?void 0:h.to_type))==null?void 0:g.symbol}).join(" > ")})}),(j=t==null?void 0:t.providers)==null?void 0:j.map(h=>o&&p?e.jsx(W,{w:"16px",h:"16px",imageUrl:K[h].logo}):e.jsxs(Ve,{isLazy:!0,trigger:o?"click":"hover",children:[e.jsx(Ge,{children:e.jsx(I,{children:e.jsx(W,{w:"16px",h:"16px",imageUrl:K[h].logo})})}),e.jsx(Ke,{children:e.jsx(Ye,{w:"unset",children:e.jsx(qe,{fontSize:"12px",children:K[h].name})})})]},h)),p]})})};function ke({children:t,fromToken:p,toToken:s,poolAddress:r}){const{isApp:l}=ge(),{getExplorerUrl:o}=Ps();return e.jsxs(Ve,{isLazy:!0,trigger:l?"click":"hover",children:[e.jsx(Ge,{children:t}),e.jsx(Ke,{children:e.jsx(Ye,{w:"unset",minW:"unset",children:e.jsx(qe,{p:"12px",children:e.jsxs(z,{w:"100%",gap:"12px",className:"no-close-widget-flag",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{w:"100%",justify:"space-between",h:"20px",p:"0",children:[e.jsx(u,{children:e.jsx(d,{fontSize:"12px",color:"text_caption",children:"Pool"})}),e.jsx(Me,{address:r,color:"text_caption",showLink:!!l,onClickLink:()=>{window.open(o(r,"poolAddress"),"_blank")}})]}),e.jsx(Es,{orientation:"horizontal",borderColor:"border"})]}),[p,s].map(i=>e.jsxs(u,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsxs(u,{children:[e.jsx(W,{imageUrl:i==null?void 0:i.logo_url,w:"24px",h:"24px",coinType:i?i==null?void 0:i.coin_type:"",showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(z,{align:"flex-start",gap:"0px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",fontWeight:"500",children:De((i==null?void 0:i.symbol)||"",10)})})]}),e.jsx(Me,{color:"primary_gray",showLink:!!l,address:i==null?void 0:i.coin_type,onClickLink:()=>window.open(o(i==null?void 0:i.coin_type,"coin"))})]},i==null?void 0:i.coin_type))]})})})})]})}const sr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>e.jsxs(z,{w:"100%",align:"center",p:"20px 0 8px",children:[e.jsx(u,{children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:U(s||"0")}),e.jsx(d,{children:t==null?void 0:t.symbol})]})}),e.jsx(I,{w:"100%",bg:"bg_secondary",p:"20px 8px",borderRadius:"8px",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"},_after:{content:'""',position:"absolute",bottom:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"}},children:e.jsx(z,{gap:o?"56px":"16px",border:"1px dashed",borderColor:"border",borderRadius:"8px",p:o?"36px 0":"16px 0",children:l==null?void 0:l.map((i,f)=>e.jsxs(u,{w:"100%",gap:"0",justify:"space-between",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}},children:[!o&&e.jsx(k,{borderRadius:"12px",h:"24px",bg:"h5_router_percentage_bg",p:"6px 12px",ml:"20px",zIndex:2,children:e.jsx(d,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:le(i.percentage)})}),e.jsx(z,{w:"100%",align:"center",sx:i.paths.length>1&&!o?{position:"relative",_before:{content:'""',backgroundColor:"bg_secondary",position:"absolute",top:"20px",right:"16px",width:"calc(100% - 32px)",height:"calc(100% - 40px)",border:"1px dashed",borderColor:"border",borderRadius:"8px",zIndex:2}}:{},children:o?e.jsx(e.Fragment,{children:e.jsxs(u,{gap:"8px",position:"absolute",h:"40px",top:"-20px",borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:2,children:[e.jsxs(u,{gap:"0",children:[e.jsx($,{w:"24px",h:"24px"}),e.jsx($,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):i.paths.map(c=>{var x,b,j;return e.jsx(ke,{fromToken:c==null?void 0:c.fromToken,toToken:c==null?void 0:c.toToken,poolAddress:c==null?void 0:c.pool_address,children:e.jsxs(u,{borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:3,children:[e.jsx(Ne,{coinAIconUrl:(x=c.fromToken)==null?void 0:x.logo_url,coinBIconUrl:(b=c.toToken)==null?void 0:b.logo_url,w:"24px",h:"24px",imageStyle:{decoding:"async"}}),e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(j=K[c.provider])==null?void 0:j.name}),!!+c.fee_rate&&e.jsx(k,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:le(c.fee_rate)})})]},c.to_type)},c.to_type)})})]},f))})}),e.jsx(u,{children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:U(r||"0")}),e.jsx(d,{children:p==null?void 0:p.symbol})]})})]}),rr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>{var i;return e.jsxs(z,{w:"100%",gap:"12px",children:[e.jsxs(u,{w:"100%",justify:"space-between",children:[e.jsx(u,{borderRadius:"14px",h:"28px",p:"0 12px 0 0 ",children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:U(s||"0")}),e.jsx(d,{children:t==null?void 0:t.symbol})]})}),e.jsx(u,{borderRadius:"14px",h:"28px",p:"0 0 0 12px",children:o?e.jsxs(e.Fragment,{children:[e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]}),e.jsx($,{w:"28px",h:"28px"})]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{color:"text_caption",children:U(r||"0")}),e.jsx(d,{children:p==null?void 0:p.symbol}),e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"})]})})]}),e.jsxs(I,{w:"100%",bg:"bg_secondary",p:"32px 24px",borderRadius:"12px",position:"relative",children:[e.jsx(I,{position:"absolute",left:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"0px 100px 100px 0px",zIndex:2,children:o?e.jsx($,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"24px",h:"24px",coinType:t==null?void 0:t.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(I,{position:"absolute",right:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"100px 0px 0px 100px",zIndex:2,children:o?e.jsx($,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"24px",h:"24px",coinType:p==null?void 0:p.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(z,{gap:"32px",border:"1px dashed",borderBottom:((i=l||[])==null?void 0:i.length)>1?"1px dashed":"none",borderColor:"border",borderRadius:"8px",children:l==null?void 0:l.map((f,c)=>e.jsxs(u,{mt:c===0?"-20px":0,mb:c===l.length-1?"-20px":0,w:"100%",justify:"space-between",gap:"0",sx:c>0&&c<l.length-1?{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}}:{position:"relative"},children:[!o&&e.jsx(k,{borderRadius:"12px",h:"24px",bg:"card_bg",p:"8px 12px",ml:"40px",zIndex:2,position:"absolute",children:e.jsx(d,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:le(f.percentage)})}),e.jsx(u,{h:"40px",w:"100%",justify:"center",zIndex:2,children:o?e.jsx(e.Fragment,{children:e.jsxs(u,{gap:"8px",position:"absolute",h:"40px",borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsxs(u,{gap:"0",children:[e.jsx($,{w:"24px",h:"24px"}),e.jsx($,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):f.paths.map(x=>{var b,j,h;return e.jsx(ke,{fromToken:x==null?void 0:x.fromToken,toToken:x==null?void 0:x.toToken,poolAddress:x==null?void 0:x.pool_address,children:e.jsxs(u,{borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsx(Ne,{coinAIconUrl:(b=x.fromToken)==null?void 0:b.logo_url,coinBIconUrl:(j=x.toToken)==null?void 0:j.logo_url,variant:"",p:"0px",w:"24px",h:"24px",imageStyle:{decoding:"async"}}),e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(h=K[x.provider])==null?void 0:h.name}),!!+x.fee_rate&&e.jsx(k,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:le(x.fee_rate)})})]})},x.to_type)})})]},c))})]})]})},tr=({isOpen:t,onClose:p,data:s,fromCoin:r,toCoin:l,fromAmount:o,toAmount:i})=>{const{isApp:f}=ge(),{getTokenListInfo:c}=be(),[x,b]=a.useState(new Map),j=async _=>{const R=await c(_);R&&(R==null?void 0:R.size)>0&&b(R)};Hs(()=>{var _,R;if(s!=null&&s.routers&&((_=s==null?void 0:s.routers)==null?void 0:_.length)>0){const P=[];(R=s==null?void 0:s.routers)==null||R.forEach(H=>{H.paths.forEach(T=>{P.includes(T.from_type)||P.push(T.from_type),P.includes(T.to_type)||P.push(T.to_type)})}),j(P)}},[s==null?void 0:s.routers]);const h=a.useMemo(()=>{var _,R;return!(s!=null&&s.routers)||((_=s==null?void 0:s.routers)==null?void 0:_.length)===0||(x==null?void 0:x.size)===0?[]:(R=s==null?void 0:s.routers)==null?void 0:R.map(P=>({...P,paths:P.paths.map(H=>({...H,fromToken:x==null?void 0:x.get(H.from_type),toToken:x==null?void 0:x.get(H.to_type)}))}))},[s==null?void 0:s.routers,x]),S={fromToken:r,toToken:l,fromAmount:o,toAmount:i,routes:h},[v,w]=a.useState(!0),g=a.useRef(null);return a.useEffect(()=>(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{w(!1)},200),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),e.jsxs(Ms,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:p,isCentered:!0,children:[e.jsx(Us,{}),e.jsxs(Bs,{maxW:"1200px",w:f?"calc(100vw - 32px)":"880px",children:[e.jsx(Os,{mr:"-10px",children:e.jsxs(u,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(d,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Route"}),e.jsxs(u,{gap:"0",align:"center",children:[e.jsx(Qe,{data:s}),e.jsx(Cs,{mt:"0",position:"static"})]})]})}),e.jsx(Ds,{p:{base:"8px 16px",lg:"16px"},children:f?e.jsx(sr,{...S,loading:v}):e.jsx(rr,{...S,loading:v})})]})]})};function $r(t){const{formatSwapRouter:p,findRouterLoading:s,fromAmount:r,toAmount:l,fromCoin:o,toCoin:i,isSwapWidget:f=!1,handleSwapWidgetRouterClick:c}=t,[x,b]=a.useState(!1);return console.log(p,"formatSwapRouter"),e.jsxs(e.Fragment,{children:[e.jsxs(u,{w:"100%",justify:"space-between",p:"0 8px",children:[e.jsx(d,{fontSize:f?"12px":"14px",fontWeight:"500",whiteSpace:"nowrap",children:"Auto Router"}),e.jsx(I,{onClick:j=>{$s(j),f?c&&c():b(!x)},cursor:"pointer",children:e.jsx(Qe,{data:p,loading:s,isSwapWidget:f,children:e.jsx(ee,{xlinkHref:"#icon-icon_spread",fontSize:"16px"})})})]}),x&&!f&&e.jsx(tr,{isOpen:x,onClose:()=>b(!1),fromCoin:o,toCoin:i,data:p,fromAmount:r,toAmount:l})]})}function Tr(t){const{lastRouterData:p,fromCoin:s,toCoin:r,onClose:l,data:o,onSubmitClick:i,isWidget:f}=t,{slippage:c}=Oe(),x=a.useRef(!1),[b,j]=a.useState(o),{fromAmountUi:h,toAmountUi:S,byAmountIn:v}=b,{amountLimit:w}=Xe(c,b),[g,_]=a.useState(!1),{priceImpactTextInfo:R,marketPrice:P,sources:H,showPriceImpactTips:T,showPriceImpactWarn:B}=Ze(s,r,h,S),{priceAcceptRouterData:C}=Vs(b,p),[se,xe]=a.useState(!1),re=a.useMemo(()=>C!==void 0,[C]),m=a.useMemo(()=>v?r:s,[v]),te=()=>{if(C){if(x.current)return;x.current=!0;const ie=Qs(C);j(ie),setTimeout(()=>{x.current=!1},300)}},ae=a.useMemo(()=>g?!1:!!B,[g,B]);return e.jsxs(z,{textAlign:"center",p:"0px",w:"100%",children:[e.jsxs(z,{w:"100%",gap:"16px",pl:"16px",pr:"16px",pb:"16px",children:[e.jsx(qs,{bg:f?"swap_bg_primary":"bg_primary",coinA:{amount:h||"0",...s},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:S||"0",...r}}),e.jsx(u,{w:"100%",minH:"48px",bg:f?"swap_bg_primary":"bg_primary",borderRadius:"8px",border:"1px solid",borderColor:"border",justifyContent:"center",zIndex:"100",children:e.jsx(je,{fromToken:s,toToken:r,fromValue:h,toValue:S,color:"text_caption"})}),T&&e.jsx(u,{zIndex:"99",w:"100%",mt:"-26px",bg:B?"primary_red_opacity.10":"primary_yellow_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"center",p:"18px 16px 10px",children:e.jsx(d,{color:B?"primary_red":"primary_yellow",fontSize:"12px",lineHeight:"20px",textAlign:"start",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})}),e.jsx(Ue,{wrapStyle:{h:"20px",lineHeight:"20px"},label:"Slippage Tolerance",labelStyle:{fontSize:"14px"},value:`${Ce(c).mul(100)}%`,valueStyle:{fontSize:"14px"}}),e.jsx(Ue,{wrapStyle:{h:"20px",lineHeight:"20px"},label:v?"Minimum Received":"Maximum Input",labelStyle:{fontSize:"14px"},value:`${Ts(w||0,m==null?void 0:m.decimals,!1,Ws.ROUND_DOWN).toString()} ${m==null?void 0:m.symbol}`,valueStyle:{fontSize:"14px"}}),e.jsx(Je,{fromToken:s,toToken:r,sources:H,marketPrice:P,priceImpact:R}),B&&e.jsxs(z,{w:"100%",gap:"8px",children:[e.jsx(u,{w:"100%",bg:"primary_red_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"start",p:"10px 16px",children:e.jsx(d,{color:"primary_red",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?"})}),e.jsxs(u,{w:"100%",justifyContent:"space-between",gap:"16px",children:[e.jsx(pe,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:g?"text_highlight":"button_outline_border",onClick:()=>{_(!0)},children:"Yes, please continue."}),e.jsx(pe,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:"button_outline_border",onClick:l,children:"No,cancel it."})]})]}),re&&e.jsxs(u,{w:"100%",justifyContent:"space-between",children:[e.jsxs(u,{children:[e.jsx(ee,{xlinkHref:"#icon-icon_priceupdated1",svgW:"20px",svgH:"20px"}),e.jsx(d,{color:"text_caption",fontWeight:"500",fontSize:"14px",children:"Price updated"})]}),e.jsx(pe,{onClick:te,h:"40px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",p:"0 42px",children:"Accept"})]})]}),!re&&e.jsx(pe,{disabled:ae,isLoading:se,mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{se||(xe(!0),i(b))},children:"Confirm Swap"})]})}export{sr as H,Qe as O,Pr as P,Hr as S,Ir as a,$r as b,Tr as c,zr as u};
//# sourceMappingURL=SwapConfirmBlock-D2hYuPYg.js.map

import{j as e,X as le,Y as pe,Z as ce,$ as de,a8 as xe,a0 as ue,a1 as he,a as d,u as ge,H as g,P as me,h as fe,aM as je,aN as be,ar as Se,m as ye,n as we,v as K,aO as w,V as m,T as _,f as z,C as _e}from"./vendor-BulRdKUe.js";import{u as U,A as ve}from"./AggregatorModal-DY_i-6Xf.js";import{c as Re,u as Te,a as Fe,S as Ae,P as ke,b as Pe}from"./SwapConfirmBlock-DqXkQg7s.js";import{u as We}from"./useSwapHelper-6BcqaPeZ.js";import{u as Ce}from"./global-wiSqo_J2.js";import{u as q}from"./swap-B1bSaQCK.js";import{u as He,ab as Le,bK as Oe,$ as ze,I as Ee,d as $,bL as Me,f as X,e as Be,n as De,c as Ve,j as Ge,a as Ne,F as $e,v as Ye,p as Ke}from"./index-BnmCMmyx.js";import{H as Ue}from"./HTextLabelBox-BpcuJxcz.js";import{I as qe}from"./IconBg-DTAL07D2.js";import{u as Xe}from"./useAccountBalance-rsIdIWdA.js";import{T as Ze}from"./TradeInputGroup-DNnGe9S7.js";import{W as Je}from"./WarningTokenTipModal-SgGrLo24.js";import{S as Qe}from"./Slippage-BLsPjP2P.js";import{u as Ie}from"./useRequest-BMSxDAZJ.js";import{F as et}from"./FreshProgressV2-DNi3q56v.js";import{A as tt}from"./SingleTokenInfo-B8DVf7p2.js";import{M as st}from"./usePriceImpact-DikdqQOy.js";import{T as rt}from"./TooltipIcon-Pnq0PRW-.js";import{R as at}from"./Ratio-BKsPYAzg.js";import{R as ot,Y as it}from"./YAxis-B-i1zdME.js";import{a as nt,L as lt}from"./LineChart-_y-SaMJB.js";import{T as pt}from"./generateCategoricalChart-COzGi7lQ.js";import"./aggregator-BWT6nljD.js";import"./index-DIf-x9mE.js";import"./index-BYrW2Tah.js";import"./useTransaction-B2FYme2v.js";import"./useTrack-VSK7D-wq.js";import"./useSigner-BUnTeKmJ.js";import"./useToken-C59GtM4K.js";import"./useTokenBalance-CEc7kzw3.js";import"./useFindBestRouting-DDW_KTdC.js";import"./v4-C6aID195.js";import"./CurrentPrice-VyKDA1zY.js";import"./HighlightText-Uv5QOqtT.js";import"./index-DJeGDtcR.js";import"./TradeConfirmAmountInfo-CSLLS9CI.js";import"./useGetPoolList-C787wcBx.js";import"./useWrapPoolData-DQL-fMCs.js";import"./_getAllKeysIn-D_OrL7d0.js";import"./CheckBox-DyxibDoL.js";import"./index-e8NcK24v.js";import"./debounce-Cta0IZrB.js";import"./CopyButton-DTp8q2dZ.js";import"./linear-DYpwdEgO.js";function ct(s){const{isOpen:t,onClose:r,data:o,onSubmitClick:i}=s,{fromCoin:p,toCoin:a,routerData:f}=q();return e.jsxs(le,{autoFocus:!1,returnFocusOnClose:!1,trapFocus:!1,isOpen:t,onClose:r,isCentered:!0,children:[e.jsx(pe,{}),e.jsxs(ce,{children:[e.jsx(de,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",children:"Swap"})}),e.jsx(ue,{}),e.jsx(he,{textAlign:"center",p:"0px",children:e.jsx(Re,{onSubmitClick:i,onClose:r,data:o,lastRouterData:f,fromCoin:p,toCoin:a,isWidget:!1})})]})]})}function dt(){const{fetchByApi:s}=He(),{setProviders:t}=Le();return{fetchRouterConfig:async()=>{try{const o=await s(Oe,"GET"),{providers:i}=o;i&&i.length>0&&t(i),console.log("ðŸš€ ~ file: useGetRouterConfig.ts:13 ~ fetchRouterConfig ~ res:",o)}catch(o){console.log("ðŸš€ ~ file: useGetRouterConfig.ts:18 ~ fetchRouterConfig ~ error:",o)}}}}function xt(){const[s,t]=d.useState(!1),r=d.useRef(null),o=()=>{t(!1)},{fetchRouterConfig:i}=dt(),{loading:p}=Ie(i),{handleSelectAllProviderClick:a,handleSaveClick:f,currProvidersSwitchStates:v,isOpenAggregatorMode:c}=U(),h=()=>{c||b(),a(!c)};ze(()=>{f()},[v]);const b=()=>{var R;const j=window.innerWidth,u=window.innerHeight,l=(R=r.current)==null?void 0:R.getBoundingClientRect(),F=l==null?void 0:l.left,A=l==null?void 0:l.top,x=2,S=w.shapeFromText({text:"ðŸŸ¢",scalar:x}),k=w.shapeFromText({text:"ðŸ”µ",scalar:x}),P=w.shapeFromText({text:"ðŸ’š",scalar:x}),W=w.shapeFromText({text:"ðŸ’™",scalar:x});w({particleCount:40,spread:60,shapes:[S,k,P,W],scalar:x,origin:{x:F/j,y:A*1.2/u}})};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{isLoaded:!p,w:"178px",h:"28px",children:e.jsxs(g,{border:"1px solid",borderColor:"border",borderRadius:"8px",h:"28px",bg:"bg_secondary",gap:"8px",children:[e.jsxs(me,{isLazy:!0,trigger:"hover",autoFocus:!1,returnFocusOnClose:!1,children:[e.jsx(fe,{children:e.jsxs(je,{display:"flex",alignItems:"center",pl:"8px",children:[e.jsx(be,{htmlFor:"aggregator-mode",mb:"0",bg:"plus_mode_color",textFillColor:"transparent",backgroundClip:"text",h:"18px",lineHeight:"18px",fontSize:"12px",fontWeight:"500",fontStyle:"normal",mr:"8px",children:"Aggregator Mode"}),e.jsx(Se,{ref:r,id:"aggregator-mode",isChecked:c,onChange:h})]})}),e.jsx(ye,{children:e.jsx(we,{p:"12px",lineHeight:"20px",fontSize:"12px",children:"The Aggregator Mode will aggregate external liquidity sources"})})]}),e.jsx(K,{variant:"unstyled",mr:"-1px",minW:"20px",w:"20px",p:"7px 4px",h:"28px",bg:"border",borderRadius:"0 8px 8px 0",onClick:()=>t(!s),_hover:{svg:{fill:"text_caption"}},children:e.jsx(Ee,{xlinkHref:"#icon-icon_list_token",fontSize:"12px"})})]})}),s&&e.jsx(ve,{isOpen:s,onClose:o})]})}const ut=({active:s,payload:t,label:r})=>{var o,i;return s&&t&&t.length?e.jsxs("div",{style:{backgroundColor:"#121212",border:"1px solid border_secondary",padding:"12px",borderRadius:"8px",position:"relative",left:"0px",top:"-30px",fontSize:"12px"},children:[e.jsx("p",{style:{color:"#909CA4"},children:Me.unix((i=(o=t[0])==null?void 0:o.payload)==null?void 0:i.timestamp).format("MM/DD HH:mm")}),e.jsxs("p",{style:{color:"#fff",marginTop:"8px"},children:["$",X(t[0].value)]})]}):null};function ht({data:s=[]}){const t=$(Math.min(...s.map(o=>o.price))).mul(.99999).toNumber(),r=$(Math.max(...s.map(o=>o.price))).mul(1.00001).toNumber();return e.jsx(ot,{width:"100%",height:"100%",children:e.jsxs(nt,{width:180,height:48,data:s,margin:{top:5,right:20,left:20,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"priceLine",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(117, 200, 255, 1)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(104, 255, 216, 1)"})]})}),e.jsx(it,{hide:!0,domain:[t,r]}),e.jsx(pt,{cursor:!1,content:e.jsx(ut,{})}),e.jsx(lt,{type:"linear",dot:!1,dataKey:"price",stroke:"url(#priceLine)",strokeWidth:2})]})})}function gt({fromCoin:s,toCoin:t}){return d.useMemo(()=>[s,t].filter(Boolean).filter(o=>!!((o==null?void 0:o.is_verified)===void 0?o!=null&&o.is_trusted:o!=null&&o.is_verified)),[s,t]).length?e.jsxs(m,{w:"100%",align:"flex-start",gap:"8px",children:[e.jsxs(g,{justify:"flex-start",h:"52px",align:"center",gap:"4px",children:[e.jsx(_,{fontSize:"14px",fontWeight:"500",color:"text_caption",h:"20px",lineHeight:"20px",children:"Price Reference"}),e.jsx(rt,{type:"priceReference"})]}),e.jsxs(m,{w:"100%",gap:"28px",children:[((s==null?void 0:s.is_verified)===void 0?s==null?void 0:s.is_trusted:s==null?void 0:s.is_verified)&&e.jsx(Y,{coin:s}),((t==null?void 0:t.is_verified)===void 0?t==null?void 0:t.is_trusted:t==null?void 0:t.is_verified)&&e.jsx(Y,{coin:t})]})]}):null}const Y=({coin:s})=>{const{getExplorerUrl:t}=Be(),{getPriceKline:r,getTokenPrice:o}=De(),[i,p]=d.useState({price:[],daily_rate:""});d.useEffect(()=>{p({price:[],daily_rate:""})},[s]);const a=o(s==null?void 0:s.coin_type),f=async(v,c)=>{try{const h=await r(v,c);p(h)}catch(h){console.log(h,"error")}};return d.useEffect(()=>{a!=null&&a.base_symbol&&f(a==null?void 0:a.base_symbol,a==null?void 0:a.market)},[a==null?void 0:a.base_symbol,a==null?void 0:a.market,s==null?void 0:s.coin_type]),!i||i.price.length===0?e.jsx(e.Fragment,{}):e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-start",h:"32px",children:[e.jsxs(g,{children:[e.jsx(Ve,{imageUrl:s==null?void 0:s.logo_url,w:"28px",h:"28px"}),e.jsxs(m,{align:"flex-start",gap:"4px",children:[e.jsx(_,{fontSize:"14px",h:"16px",lineHeight:"16px",fontWeight:"600",color:"text_caption",children:s==null?void 0:s.symbol}),e.jsx(_,{fontSize:"12px",h:"12px",lineHeight:"12px",fontWeight:"500",children:s==null?void 0:s.name})]})]}),e.jsxs(g,{children:[(a==null?void 0:a.market)&&e.jsx(st,{market:a==null?void 0:a.market}),e.jsxs(_,{color:"text_caption",fontSize:"14px",fontWeight:"500",children:["$",(a==null?void 0:a.price)!==void 0?X(a==null?void 0:a.price):"--"]}),(i==null?void 0:i.daily_rate)&&(a==null?void 0:a.price)!==void 0&&e.jsx(at,{value:i==null?void 0:i.daily_rate})]})]}),e.jsxs(g,{w:"100%",justify:"space-between",align:"flex-end",gap:"0",children:[e.jsx(tt,{address:s==null?void 0:s.coin_type,onClickLink:()=>window.open(t(s==null?void 0:s.coin_type,"coin")),wrapStyle:{border:"1px solid",borderColor:"border",h:"24px",borderRadius:"8px",p:"0 8px",bg:"bg_secondary"},fontWeight:"500"}),e.jsx(z,{flex:"0 0 210px",h:"24px",mr:"-13px",children:(a==null?void 0:a.price)!==void 0&&(i==null?void 0:i.price.length)>0&&e.jsx(ht,{data:i==null?void 0:i.price})})]})]})};function ps(){const s=q(),{fromCoin:t,toCoin:r,setFromCoin:o,setToCoin:i,byAmountIn:p,setFromAmount:a,setToAmount:f,setByAmountIn:v,findRouterLoading:c,routerData:h}=s,{handleSelectToken:b,handleAmountChange:j,fromAmount:u,toAmount:l,fromAmountValue:F,toAmountValue:A,fromBalanceInfo:x,toBalanceInfo:S,amountLimit:k,getSwapSecondaryData:P,doSwapAction:W,reCalculateRouteData:R,scamsText:E,refreshMarketPrice:Z,isOpenConfirmModel:C,setIsOpenConfirmModel:M,resetInputAmount:J,onReverseClick:Q}=Te(s,!1),{currentAccount:T,onWalletModal:I}=Ge(),{fetchAccountBalance:B}=Xe();d.useEffect(()=>{T!=null&&T.address&&B()},[]);const{btnText:ee,btnDisabled:te}=Fe(u,l,x==null?void 0:x.balanceFormat,t,r,h),D=d.useRef(null),{formatSwapRouter:se}=We(h),{isOpenAggregatorMode:H}=U(),re=()=>{var n;(n=D.current)==null||n.reset()},V=()=>{R(),B(),Z()};d.useEffect(()=>{re()},[l,u,t==null?void 0:t.coin_type,r==null?void 0:r.coin_type]),d.useEffect(()=>{p||V()},[l,t==null?void 0:t.coin_type,r==null?void 0:r.coin_type]),d.useEffect(()=>{J()},[H]);const ae=d.useMemo(()=>{const n=[];return t&&n.push(t),r&&n.push(r),n},[t,r]),[L,G]=d.useState("#icon-a-icon_trade"),oe=()=>{G("#icon-icon_swap1")},ie=()=>{G("#icon-a-icon_trade")},{isApp:N}=Ne(),{isShowTradeChart:y,setIsShowTradeChart:ne,isShowTradeOrders:mt,setIsShowTradeOrders:ft}=Ce();return e.jsx(e.Fragment,{children:e.jsxs(m,{gap:{base:"16px",lg:"8px"},w:{base:"100%",lg:"470px"},children:[e.jsxs(g,{w:"100%",justify:"space-between",children:[e.jsx(xt,{}),e.jsxs(g,{children:[e.jsx(Qe,{}),e.jsx($e,{showTooltip:!N,placement:"bottom-end",tooltip:e.jsx(_,{fontSize:"12px",children:y?"Hide reference price":"View reference price"}),children:e.jsx(_e,{children:e.jsx(qe,{w:"28px",h:"28px",borderRadius:"8px",variant:"",xlinkHref:"#icon-icon_kline",svgFill:y?"primary":"",svgHover:y?"primary":N?"text_paragraph":"text_caption",onClick:()=>ne(!y)})})}),e.jsx(et,{callbackInterval:C?5:10,ref:D,min:0,max:10,onClick:V})]})]}),e.jsxs(z,{w:"100%",children:[e.jsx(Ze,{wrapStyle:{gap:{base:"16px",lg:"8px"},mt:{base:"0px",lg:"4px"}},onClick:()=>Q(H),from:{title:"You Pay",balance:(x==null?void 0:x.balanceFormat)||"",value:u,amountValue:F,loading:!p&&c,onChange:n=>{j(n,!0)},selectable:!0,placeholder:"0.0",token:t,onFocusChange:n=>{n&&+u&&!p&&j(u,!0)},onTokenChange:n=>{b(n,!0)}},to:{title:"You Receive",balance:(S==null?void 0:S.balanceFormat)||"",value:l,amountValue:A,loading:p&&c,onFocusChange:n=>{n&&+l&&p&&j(l,!1)},onTokenChange:n=>{b(n,!1)},inputAllowed:!H,onChange:n=>{j(n,!1)},selectable:!0,placeholder:"0.0",token:r,half:!1,max:!1},iconParams:{xlinkHref:L,svgFill:"text_caption",transform:L==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:L==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:oe,onMouseLeave:ie}}),E&&e.jsx(z,{mt:"-32px",p:"48px 16px 16px",borderRadius:"20px",bg:"bg_secondary",border:"1px solid",borderColor:"border",children:e.jsx(Ae,{scamsText:E})})]}),(t||r)&&e.jsx(Je,{addToken:!0,tokensInfo:ae,waringModalCancel:n=>{n.forEach(O=>{(O.coin_type===(t==null?void 0:t.coin_type)||O.coin_type===(r==null?void 0:r.coin_type))&&b(void 0,O.coin_type===(t==null?void 0:t.coin_type))})}}),e.jsxs(m,{p:+u&&+l?"0 8px 12px":"0 8px",w:"100%",gap:"8px",border:"1px solid",borderColor:"border",borderRadius:"20px",bg:"bg_secondary",children:[e.jsx(K,{w:"calc(100% + 18px)",h:"52px",margin:"-1px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:c||te,isLoading:c,onClick:()=>{T?M(!0):I(!0)},children:[t,r].filter(Boolean).length<2?"Select a token":ee}),!!+u&&!!+l&&e.jsxs(m,{w:"100%",gap:"12px",children:[e.jsx(ke,{findRouterLoading:c,routerData:h,fromCoin:t,toCoin:r}),e.jsx(Ue,{isLoading:c,label:p?"Minimum Received":"Maximum Sold",value:`${Ye(k,p?r==null?void 0:r.decimals:t==null?void 0:t.decimals,!1,Ke.ROUND_DOWN)} ${p?r==null?void 0:r.symbol:t==null?void 0:t.symbol}`,labelStyle:{fontWeight:500,whiteSpace:"nowrap",fontSize:"14px"},valueStyle:{fontWeight:500,fontSize:"14px"},skeletonStyle:{valueW:"128px"},wrapStyle:{p:"0 8px",minH:"20px"}}),e.jsx(Pe,{formatSwapRouter:se,findRouterLoading:c,fromAmount:u,toAmount:l,fromCoin:t,toCoin:r})]})]}),!y&&e.jsx(gt,{fromCoin:t,toCoin:r}),C&&e.jsx(ct,{data:P(),isOpen:C,onSubmitClick:W,onClose:()=>{M(!1)}})]})})}export{ps as default};
//# sourceMappingURL=Swap-BhhOQlxn.js.map

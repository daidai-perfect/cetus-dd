{"version":3,"file":"useXCetusHelper-BZ3t3rLl.js","sources":["../../src/hooks/xcetus/useXCetusHelper.ts"],"sourcesContent":["import useXCetusStore from '@/store/xcetus/useXCetus'\nimport { XCetusRewardInfo } from '@/types/xcetus'\nimport { useGetToken } from '@cetus/hooks/src/useToken'\nimport useTokenPrice from '@cetus/hooks/src/useTokenPrice'\nimport { useSdk } from '@cetus/sdk-factory'\nimport { useAccountStore } from '@cetus/stores'\nimport useTokenPriceStore from '@cetus/stores/src/tokenPrice'\nimport envConfigs, { xcetusConfig } from '@cetus/types/src/config/envConfigs'\nimport { d } from '@cetus/utils'\nimport { buildNFT, extractStructTagFromType, fixCoinType, fromDecimalsAmount, getMoveObjectType } from '@cetusprotocol/common-sdk'\nimport { CetusXcetusSDK, DividendManager, DividendReward, LockCetus, PhaseDividendInfo, VeNFT, XCetusUtil } from '@cetusprotocol/xcetus-sdk'\nimport { useDebounceEffect } from 'ahooks'\nimport { useCallback, useEffect, useRef, useState } from 'react'\n\n/**\n *  è·å–æˆ‘çš„xcetus è®¢å•\n * @returns\n */\nexport function useGetOwnerLockCetusList() {\n  const xCetusSdk = useSdk('xcetus')\n  const { currentAccount } = useAccountStore()\n\n  const addressRef = useRef(currentAccount?.address)\n\n  useEffect(() => {\n    addressRef.current = currentAccount?.address\n  }, [currentAccount?.address])\n\n  const { setLockCetusListLoading, clearData, setLockCetusList, setAvailableXCetusAmount, veNFT } = useXCetusStore()\n\n  const fetchOwnerLockCetusList = async (veNFT: VeNFT, address = currentAccount?.address) => {\n    if (!address) {\n      setLockCetusListLoading(false)\n      clearData()\n      return\n    }\n    try {\n      const lockList = await xCetusSdk!.XCetusModule.getOwnerRedeemLockList(address)\n      console.log('ğŸš€ ~ fetchOwnerLockCetusList ~ lockList:', {\n        lockList,\n        veNFT,\n        availableXCetusAmount: XCetusUtil.getAvailableXCetus(veNFT, lockList)\n      })\n      if (address === addressRef.current) {\n        lockList.sort((a, b) => a.locked_until_time - b.locked_until_time)\n        setLockCetusList(lockList)\n        if (veNFT) {\n          setAvailableXCetusAmount(XCetusUtil.getAvailableXCetus(veNFT, lockList))\n        }\n      }\n    } catch (error) {\n      console.log('ğŸš€ ~ fetchOwnerLockCetusList ~ error:', error)\n    } finally {\n      setLockCetusListLoading(false)\n    }\n  }\n\n  return {\n    fetchOwnerLockCetusList\n  }\n}\n\n/**\n *  è·å–ç”¨æˆ·çš„åˆ†çº¢ä¿¡æ¯\n */\nexport function useGetVeNFTDividendInfo() {\n  const xCetusSdk = useSdk('xcetus')\n\n  const { setDividendRewardList } = useXCetusStore()\n\n  const fetchVeNFTDividendInfo = async (veNftId: string) => {\n    try {\n      const dividendInfo = await xCetusSdk!.XCetusModule.getVeNFTDividendInfo(veNftId)\n      console.log('ğŸš€ ~ file: useXCetusHelper.ts:62 ~ fetchVeNFTDividendInfo ~ dividendInfo:', dividendInfo)\n\n      if (dividendInfo) {\n        setDividendRewardList(dividendInfo.rewards)\n      }\n    } catch (error) {\n      console.log('ğŸš€ ~ fetchVeNFTDividendInfo ~ error:', error, veNftId)\n    }\n  }\n\n  return { fetchVeNFTDividendInfo }\n}\n\nexport function useGetOwnerVeNFT() {\n  const xCetusSdk = useSdk('xcetus')\n  const { currentAccount } = useAccountStore()\n  const { fetchOwnerLockCetusList } = useGetOwnerLockCetusList()\n\n  const { setVeNFTLoading, clearData, setVeNFT } = useXCetusStore()\n\n  const fetchOwnerVeNFT = async (address = currentAccount?.address, forceRefresh?: boolean) => {\n    if (!address) {\n      setVeNFTLoading(false)\n      clearData()\n      return\n    }\n\n    setVeNFTLoading(true)\n\n    try {\n      const veNFT = await xCetusSdk!.XCetusModule.getOwnerVeNFT(address, forceRefresh)\n      console.log('ğŸš€ ~ fetchOwnerVeNFT ~ veNFT:', veNFT)\n      if (veNFT) {\n        setVeNFT(veNFT, address)\n        fetchOwnerLockCetusList(veNFT, address)\n        return veNFT\n      }\n    } catch (error) {\n      console.log('ğŸš€ ~ fetchOwnerVeNFT ~ error:', error)\n    } finally {\n      setVeNFTLoading(false)\n    }\n  }\n\n  return { fetchOwnerVeNFT }\n}\n\n/**\n * è·å–å½“å‰æœŸæ•°å’Œä¸‹ä¸€æœŸå¼€å§‹æ—¶é—´\n */\nexport function useGetCurrPeriod() {\n  const { dividendManager } = useXCetusStore()\n  const [currentPeriod, setCurrentPeriod] = useState<number | undefined>()\n  const [nextStartTime, setNextStartTime] = useState<number | undefined>()\n\n  const calculateCurrPeriod = (dividendManager: DividendManager) => {\n    const currentTime = Date.now() / 1000\n    const { start_time, interval_day } = dividendManager\n\n    const nextStartTime = Number(XCetusUtil.getNextStartTime(dividendManager).toString())\n\n    const currentPeriod =\n      envConfigs.env == 'testnet'\n        ? Math.ceil((currentTime - start_time) / (interval_day * 60))\n        : Math.ceil((currentTime - start_time) / (interval_day * 24 * 3600))\n\n    setCurrentPeriod(currentPeriod)\n    setNextStartTime(nextStartTime)\n  }\n\n  useEffect(() => {\n    if (dividendManager) {\n      calculateCurrPeriod(dividendManager)\n    }\n  }, [dividendManager])\n\n  return {\n    currentPeriod,\n    nextStartTime,\n    calculateCurrPeriod\n  }\n}\n\n/**\n * è®¡ç®—APR\n */\nexport function useGetXCetusApr(phaseDividendInfo?: PhaseDividendInfo, treasury?: string) {\n  const { fetchTokenInfo } = useGetToken()\n  const { getTokenAmountValue } = useTokenPrice()\n  const { coinPriceObj } = useTokenPriceStore()\n  const [cetusApr, setCetusApr] = useState<string>('0')\n  const calculateAPR = useCallback(async () => {\n    if (!phaseDividendInfo || !treasury) return\n\n    try {\n      const bonusList = phaseDividendInfo.bonus\n      const coinTypeList = bonusList.map(bonus => fixCoinType(bonus.name, false))\n      const tokenMap = await fetchTokenInfo<string[]>(coinTypeList)\n      // å¹¶è¡Œè·å–æ‰€æœ‰ä»£å¸ä¿¡æ¯å’Œé‡‘é¢ä»·å€¼\n      const totalBonusAmountValue = bonusList\n        .map(bonus => {\n          const coinType = fixCoinType(bonus.name, false)\n          const coinInfo = tokenMap?.get(coinType)\n          if (coinInfo) {\n            const amount = fromDecimalsAmount(bonus.value, coinInfo.decimals).toString()\n            const value = getTokenAmountValue(coinType, amount)\n            // console.log('ğŸš€ ---------------------------------------------------------------ğŸš€')\n            // console.log('ğŸš€ ~ file: useXCetusHelper.ts:158 ~ calculateAPR ~ value:', value, coinType)\n            // console.log('ğŸš€ ---------------------------------------------------------------ğŸš€')\n            return value\n          }\n          return '0'\n        })\n        .reduce((acc, value) => acc.add(value), d(0)) // æ±‡æ€»ä»·å€¼\n      // è·å– Cetus çš„æ€»ä»·å€¼\n      const cetusValue = getTokenAmountValue(envConfigs.cetus_coin.coin_type, fromDecimalsAmount(treasury, 9).toString())\n\n      // è®¡ç®— APR\n      const apr = d(cetusValue).gt(0) ? totalBonusAmountValue.div(7).mul(365).div(cetusValue).mul(100).toFixed(2) : '0'\n\n      setCetusApr(Number(apr) > 0 && Number(apr) < 0.01 ? '0.01' : apr.toString())\n    } catch (error) {\n      console.error('Error calculating APR:', error)\n      setCetusApr('0.01') // å¤„ç†é”™è¯¯æ—¶è®¾ç½®é»˜è®¤å€¼\n    }\n  }, [phaseDividendInfo?.bonus, treasury, coinPriceObj])\n\n  useDebounceEffect(() => {\n    calculateAPR()\n  }, [phaseDividendInfo?.bonus, treasury, coinPriceObj])\n\n  return { cetusApr }\n}\n\n/**\n * è·å–ç”¨æˆ·çš„å¥–åŠ±ä¿¡æ¯\n */\nexport function useGetUserRewards(currentPeriod?: number) {\n  const { dividendRewardList } = useXCetusStore()\n  const { fetchTokenInfo } = useGetToken()\n  const { getTokenAmountValue } = useTokenPrice()\n  const [summaryRewardList, setSummaryRewardList] = useState<XCetusRewardInfo[]>([])\n  const [rewardList, setRewardList] = useState<DividendReward[]>([])\n  const [totalRewardValue, setTotalRewardValue] = useState<string>('0')\n\n  const calculateRewards = useCallback(async () => {\n    let totalValue = d(0)\n\n    // è¿‡æ»¤æ‰å¥–åŠ±å…¨ä¸º0çš„ å’Œ  å½“æœŸçš„å¥–åŠ±\n    const filteredList = dividendRewardList.filter(item => {\n      if (item.period === currentPeriod) {\n        return false\n      }\n      if (item.rewards.find(reward => d(reward.amount).eq(0))) {\n        return false\n      }\n      return true\n    })\n\n    console.log('ğŸš€ ~ file: useXCetusHelper.ts:107 ~ calculateRewards ~ filteredList:', {\n      filteredList,\n      dividendRewardList,\n      currentPeriod\n    })\n\n    setRewardList(filteredList)\n\n    const rewardMap: Record<string, XCetusRewardInfo> = {}\n    const coinTypeList = filteredList.flatMap(item => item.rewards.map(reward => fixCoinType(reward.coin_type, false)))\n    const tokenMap = await fetchTokenInfo<string[]>(coinTypeList)\n\n    filteredList.forEach(item => {\n      for (const reward of item.rewards) {\n        const coinType = fixCoinType(reward.coin_type, false)\n        const coinInfo = tokenMap?.get(coinType)\n        if (coinInfo) {\n          const amount = fromDecimalsAmount(reward.amount, coinInfo.decimals).toString()\n\n          const amountValue = getTokenAmountValue(coinType, amount)\n          // console.log('ğŸš€ -------------------------------------------------------------------------------ğŸš€')\n          // console.log('ğŸš€ ~ file: useXCetusHelper.ts:213 ~ calculateRewards ~ amountValue:', amountValue, coinType)\n          // console.log('ğŸš€ -------------------------------------------------------------------------------ğŸš€')\n\n          totalValue = totalValue.add(amountValue)\n\n          // æ›´æ–° rewardMap\n          rewardMap[coinType] = rewardMap[coinType]\n            ? {\n                ...rewardMap[coinType],\n                amount: d(rewardMap[coinType].amount).add(amount).toString(),\n                value: d(rewardMap[coinType].value).add(amountValue).toString()\n              }\n            : {\n                amount,\n                coin_type: coinType,\n                value: amountValue\n              }\n        }\n      }\n    })\n    setSummaryRewardList(\n      Object.values(rewardMap)\n        .filter(item => d(item.amount).gt(0))\n        .sort((a, b) => d(b.value).sub(a.value).toNumber())\n    )\n\n    setTotalRewardValue(totalValue.toString())\n  }, [dividendRewardList, getTokenAmountValue, currentPeriod])\n\n  useEffect(() => {\n    if (currentPeriod) {\n      calculateRewards()\n    }\n  }, [dividendRewardList, currentPeriod])\n\n  return {\n    summaryRewardList,\n    rewardList,\n    totalRewardValue\n  }\n}\n\nexport const XCetusVeNFTType = `${xcetusConfig.xcetus.package_id}::xcetus::VeNFT`\nexport const XCetusLockCetusType = `${xcetusConfig.xcetus.package_id}::lock_coin::LockedCoin<${envConfigs.cetus_coin.coin_type}>`\n\nexport function buildVeNFT(dataList: any[]) {\n  let veNFT: VeNFT | undefined\n  dataList.forEach(item => {\n    if (item) {\n      const type = extractStructTagFromType(getMoveObjectType(item) as string).source_address\n      if (type === XCetusVeNFTType && item.data && item.data.content) {\n        const { fields } = item.data.content\n\n        veNFT = {\n          ...buildNFT(item),\n          id: fields.id.id,\n          index: fields.index,\n          type,\n          xcetus_balance: fields.xcetus_balance\n        }\n        return veNFT\n      }\n    }\n  })\n  return veNFT\n}\n\nexport async function buildLockCetus(dataList: any[], xCetusSdk: CetusXcetusSDK) {\n  const lockCetusList: LockCetus[] = []\n  for (let i = 0; i < dataList.length; i++) {\n    const item = dataList[i]\n    if (item) {\n      const type = extractStructTagFromType(getMoveObjectType(item) as string).source_address\n      if (type === XCetusLockCetusType && item.data) {\n        const lockCetus = XCetusUtil.buildLockCetus(item.data.content)\n        lockCetus.xcetus_amount = await xCetusSdk.XCetusModule.getXCetusAmount(lockCetus.id)\n        lockCetusList.push(lockCetus)\n      }\n    }\n  }\n  return lockCetusList\n}\n"],"names":["useGetOwnerLockCetusList","xCetusSdk","useSdk","currentAccount","useAccountStore","addressRef","useRef","useEffect","setLockCetusListLoading","clearData","setLockCetusList","setAvailableXCetusAmount","veNFT","useXCetusStore","address","lockList","XCetusUtil","a","b","error","useGetVeNFTDividendInfo","setDividendRewardList","veNftId","dividendInfo","useGetOwnerVeNFT","fetchOwnerLockCetusList","setVeNFTLoading","setVeNFT","forceRefresh","useGetCurrPeriod","dividendManager","currentPeriod","setCurrentPeriod","useState","nextStartTime","setNextStartTime","calculateCurrPeriod","currentTime","start_time","interval_day","envConfigs","useGetXCetusApr","phaseDividendInfo","treasury","fetchTokenInfo","useGetToken","getTokenAmountValue","useTokenPrice","coinPriceObj","useTokenPriceStore","cetusApr","setCetusApr","calculateAPR","useCallback","bonusList","coinTypeList","bonus","fixCoinType","tokenMap","totalBonusAmountValue","coinType","coinInfo","amount","fromDecimalsAmount","acc","value","d","cetusValue","apr","useDebounceEffect","useGetUserRewards","dividendRewardList","summaryRewardList","setSummaryRewardList","rewardList","setRewardList","totalRewardValue","setTotalRewardValue","calculateRewards","totalValue","filteredList","item","reward","rewardMap","amountValue","XCetusVeNFTType","xcetusConfig","XCetusLockCetusType","buildVeNFT","dataList","type","extractStructTagFromType","getMoveObjectType","fields","buildNFT","buildLockCetus","lockCetusList","i","lockCetus"],"mappings":"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"}
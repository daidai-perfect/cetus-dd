import{Q as I,aY as Z,b3 as Y,aV as ft,s as T,O as it,d as D,G as C,u as gt,b4 as Pt,k as st,a8 as E,Z as j,aJ as at,aQ as _t,M,j as xt,b5 as Vt,b6 as St,o as ot,aZ as vt,t as Tt,p as jt,a1 as lt,C as ht}from"./index-QNvgVKlA.js";import{a as H,j as x,V as X,H as nt,T as kt}from"./vendor-BFGDaAdA.js";import{u as Lt}from"./useFavoritePool-DqHLM_4q.js";import{c as Ot}from"./useGetPoolList-ByJZGCUe.js";import{u as wt}from"./useTokenBalance-Bb797F7L.js";import{H as F}from"./HTextLabelBox-BtA_IlNt.js";const rt=I(a=>({pythPriceMap:{},setPythPriceMap:t=>a({pythPriceMap:t})}));function It(){const{volatileVaultsSdk:a}=Z(),{setPythPriceMap:t}=rt();return{getPythLastPrice:async o=>{const b=o.map(p=>Y(p));console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPythLastPrice.ts:12 ~ getPythLastPrice ~ list:",b);try{const p=await a.PythPrice.getLatestPrice(b);return t(p),p}catch(p){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPythLastPrice.ts:16 ~ getPythLastPrice ~ error:",p)}}}}const At=(a,t)=>({vaultsList:[],setVaultList:e=>a({vaultsList:e}),vaultPageList:[],setVaultPageList:e=>a({vaultPageList:e}),vaultListObj:{},setVaultListObj:e=>a({vaultListObj:e}),vaultListLoading:!0,setVaultListLoading:e=>a({vaultListLoading:e}),vaultsTokenList:[],setVaultsTokenList:e=>a({vaultsTokenList:e}),lpTokenInfoObj:{},setLpTokenInfoObj:e=>a({lpTokenInfoObj:e}),vaultsTotalTvlDisplay:"",setVaultTotalTvlDisplay:e=>a({vaultsTotalTvlDisplay:e})}),ct=I(ft(At,{name:"useVaultsStoreV2",partialize:a=>{const{vaultsList:t,vaultsTokenList:e,lpTokenInfoObj:o}=a;return{vaultsList:t,vaultsTokenList:e,lpTokenInfoObj:o}}})),Ct=I((a,t)=>({lstVaultContractInfoObj:{},haedalVaultContractInfoObj:{},vaultClmmPoolContractInfoObj:{},setLstVaultContractInfoObj:e=>{const o=t().lstVaultContractInfoObj;a(()=>({lstVaultContractInfoObj:{...o,...e}}))},setHaedalVaultContractInfoObj:e=>{const o=t().haedalVaultContractInfoObj;a(()=>({haedalVaultContractInfoObj:{...o,...e}}))},setVaultClmmPoolContractInfoObj:e=>{const o=t().vaultClmmPoolContractInfoObj;a(()=>({vaultClmmPoolContractInfoObj:{...o,...e}}))}})),Bt=I(a=>({vaultsPositionObj:{},setVaultsPositionObj:t=>a(e=>({vaultsPositionObj:{...e.vaultsPositionObj,...t}})),clearVaultsPositionObj:()=>a(()=>({vaultsPositionObj:{}})),currentVaultPosition:{},setCurrentVaultPosition:t=>a(()=>({currentVaultPosition:t})),currentVaultPositionLoading:!0,setCurrentVaultPositionLoading:t=>a(()=>({currentVaultPositionLoading:t})),vaultsPositionLoading:!1,setVaultsPositionLoading:t=>a(()=>({vaultsPositionLoading:t})),vaultsTotalTvl:"",setVaultsTotalTvl:t=>a(()=>({vaultsTotalTvl:t}))})),Dt={"0xa528b26eae41bcfca488a9feaa3dca614b2a1d9b9b5c78c256918ced051d4c50":{vaults_id:"0xff4cc0af0ad9d50d4a3264dfaafd534437d8b66c8ebe9f92b4c39d898d6870a3",clmm_pool:"0xa528b26eae41bcfca488a9feaa3dca614b2a1d9b9b5c78c256918ced051d4c50",lpToken:{coin_type:"0x0c8a5fcbe32b9fc88fe1d758d33dd32586143998f68656f43f3a6ced95ea4dc3::lp_token::LP_TOKEN",decimals:9,description:"",logo_url:"https://j5w37hib4ojxo6bymogsbg5r5qkkdhuvfprizrw4kxakm3jxz24q.arweave.net/T22_nQHjk3d4OGONIJux7BShnpUr4ozG3FXApm03zrk",name:"",symbol:""}},"0x6c545e78638c8c1db7a48b282bb8ca79da107993fcb185f75cedc1f5adb2f535":{vaults_id:"0x5732b81e659bd2db47a5b55755743dde15be99490a39717abc80d62ec812bcb6",clmm_pool:"0x6c545e78638c8c1db7a48b282bb8ca79da107993fcb185f75cedc1f5adb2f535",lpToken:{coin_type:"0xb490d6fa9ead588a9d72da07a02914da42f6b5b1339b8118a90011a42b67a44f::lp_token::LP_TOKEN",decimals:9,logo_url:"https://tke7enjn3akurmshmxw2yr2yo4ru6joi6sxpnbsyk452k36vfdoa.arweave.net/monyNS3YFUiyR2XtrEdYdyNPJcj0rvaGWFc7pW_VKNw",description:"",name:"",symbol:""}},"0x871d8a227114f375170f149f7e9d45be822dd003eba225e83c05ac80828596bc":{vaults_id:"0xde97452e63505df696440f86f0b805263d8659b77b8c316739106009d514c270",clmm_pool:"0x871d8a227114f375170f149f7e9d45be822dd003eba225e83c05ac80828596bc",lpToken:{coin_type:"0x828b452d2aa239d48e4120c24f4a59f451b8cd8ac76706129f4ac3bd78ac8809::lp_token::LP_TOKEN",decimals:9,logo_url:"https://dzuxtnuvuq7xqcurpbk4udj74zm2h5c52ftpaxsmgvxdt3fxtgva.arweave.net/Hml5tpWkP3gKkXhVyg0_5lmj9F3RZvBeTDVuOey3mao",description:"",name:"",symbol:""}}};function Rt(){return{wrapVaultsPoolData:(t,e,o=!1)=>{var w,A,G,W;const{category:b,hard_cap_usd:p,tvl:V}=t,{displayTokenA:P,displayTokenB:_,feeDisplay:y,isReverse:l,tokenA:s,tokenB:n}=o?t:e,c=T(t.tvl||0),i=T(b=="cetus"?t.apr*100:t.apy*100,"%"),u=T(t.lst_apy*100,"%"),m=T(t.apr*100,"%"),r=T(V,"$"),f=it(p,2),d=t.category=="cetus"?D(t==null?void 0:t.apy).add(D(t.lst_apy)).mul(100).toString():D(t.apy).mul(100).toString(),g=T(d,"%"),h=[C(P==null?void 0:P.coin_type,!1),C(_==null?void 0:_.coin_type,!1)],k=((w=e==null?void 0:e.miningRewardList)==null?void 0:w.map(v=>C(v==null?void 0:v.coinType,!1)))||[],R=((A=e==null?void 0:e.miningRewardList)==null?void 0:A.map(v=>C(v==null?void 0:v.coinType,!1)))||[],z=Array.from(new Set([...h,...k,...R])),S=D(p).gt(0)?T(D(V).div(p).mul(100).toString(),""):0,L=T(S||0,"%"),O=o?t.clmmPoolAddress:e.poolAddress,B=t.category=="cetus"?(W=(G=Dt[O])==null?void 0:G.lpToken)==null?void 0:W.coin_type:t.lp_type,q=t==null?void 0:t.hard_cap_usd;return{tokenA:s,tokenB:n,displayTokenA:P,displayTokenB:_,feeDisplay:y,vaultsTvl:o?"--":V,tvlDisplay:o?"--":c,vaultsTvlDisplay:o?"--":r,vaultsApyDisplay:o?"--":i,vaultsAprDisplay:o?"--":m,vaultsLstApyDisplay:o?"--":u,vaultsTotalApy:o?"--":d,vaultsTotalApyDisplay:o?"--":g,vaultsRewards:o?t.vaultsRewards:z,category:b,depositRatio:S,depositRatioDisplay:L,vaultId:o?t.vaultId:t.id,clmmPoolAddress:O,hardCapUsdDisplay:f,lpTokenType:B,hardCapUSD:q,isReverse:l}}}}function Wt(){const{fetchByApi:a}=gt(),{wrapVaultsPoolData:t}=Rt(),{getFavoritePoolList:e}=Lt(),{vaultsList:o,setVaultList:b,setVaultTotalTvlDisplay:p,setVaultListObj:V}=ct(),P=async()=>{try{const y=await a(Pt,"GET");if(y.list){const l=y.list.map(n=>n.clmm_pool),s=await e({is_vaults:!1,display_all_pools:!1,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",limit:100,offset:0,pools:l});if(s!=null&&s.list){const n=Object.fromEntries(s==null?void 0:s.list.map(i=>[i.poolAddress,i])),c=y.list.map(i=>t(i,n[i.clmm_pool]));return b(c),V(c.reduce((i,u)=>(i[u.vaultId]=u,i),{})),p(it(y==null?void 0:y.total_tvl,2)),c}}}catch(y){return console.log("ðŸš€ðŸš€ðŸš€ ~ getVaultPoolList ~ error:",y),_(o)}},_=async y=>{const l=y.map(s=>t(s,{},!0));return console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultPoolList.ts:57 ~ poolList ~ poolList:",l),b(l),V(l.reduce((s,n)=>(s[n.vaultId]=n,s),{})),p("--"),l};return{getVaultPoolList:P}}const zt=I(a=>({vaultsPoolObj:{},setVaultsPoolObj:t=>a(e=>({vaultsPoolObj:{...e.vaultsPoolObj,...t}}))}));function Kt(){const{volatileVaultsSdk:a}=Z();st("clmm");const t=st("vaults"),{setLstVaultContractInfoObj:e,setHaedalVaultContractInfoObj:o,setVaultClmmPoolContractInfoObj:b}=Ct(),{setVaultsPoolObj:p}=zt(),V=async y=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:19 ~ getVaultsContractInfo ~ getVaultsContractInfo:");const l=[],s=[],n=[];y.forEach(d=>{d.category=="cetus"?l.push(d.vaultId):s.push(d.vaultId),n.push(d.clmmPoolAddress)});const{data:c}=await t.Vaults.getVaultList(),i=c.reduce((d,g)=>(d[g.id]=g,d),{});e(i);const{data:u}=await a.Vaults.getPoolList(),m=u.reduce((d,g)=>(d[g.id]=g,d),{});o(m);const f=(await a.CetusClmmSDK.Pool.getAssignPools(n)).reduce((d,g)=>(d[g.id]=g,d),{});return b(f),P(y,f,i,m),{lstVaultContractInfoObj:i,haedalVaultContractInfoObj:m,allClmmPoolContractInfoObj:f}},P=(y,l,s,n)=>{for(let c=0;c<y.length;c++){const i=y[c],u=i.category=="cetus"?s[i.vaultId]:n[i.vaultId],m=l[i.clmmPoolAddress],r=_(i,m,u);p(r)}},_=(y,l,s)=>{const{tokenA:n,tokenB:c,category:i,isReverse:u,vaultId:m}=y,r=i=="haedal"?s.clmm_vault.wrapped_position.tick_lower_index:s.position.tick_lower_index,f=i=="haedal"?s.clmm_vault.wrapped_position.tick_upper_index:s.position.tick_upper_index,d=E.tickIndexToPrice(r,n.decimals,c.decimals).toString(),g=E.tickIndexToPrice(f,n.decimals,c.decimals).toString(),h=i=="haedal"?s.clmm_vault.wrapped_position.liquidity:s.position.liquidity,k=j(1).div(j(g)).toString(),R=j(1).div(j(d)).toString(),z=new at(l.current_sqrt_price),S=E.sqrtPriceX64ToPrice(z,n.decimals,c.decimals).toString(),L=j(1).div(j(S)).toString(),O=E.tickIndexToSqrtPriceX64(r),B=E.tickIndexToSqrtPriceX64(f),q=_t.getCoinAmountFromLiquidity(new at(h),z,O,B,!1),w=M(q.coin_amount_a.toString(),n.decimals).toString(),A=M(q.coin_amount_b.toString(),c.decimals).toString(),G=u?A:w,W=u?w:A,{percentA:v,percentB:J}=Ot(w,A,S,!1),ut=u?J:v,dt=u?v:J,pt=T(j(s.protocol_fee_rate).div(1e4).mul(100).toString(),"%"),Q=C(n.coin_type,!1),$=C(c.coin_type,!1),yt=u?$:Q,bt=u?Q:$;let K,N,tt,U,et;i=="haedal"&&(K=s==null?void 0:s.quote_type,N=C(K,!1)==C(n.coin_type,!1)?n:c,tt=j(s==null?void 0:s.hard_cap).div(10**(N==null?void 0:N.decimals)).toString(),U=K==n.coin_type?c:n,et=U.coin_type);const mt=i=="cetus"?s==null?void 0:s.total_supply:s==null?void 0:s.lp_token_treasury;return{[m]:{minPrice:u?k:d,minPriceResever:u?d:k,maxPrice:u?R:g,maxPriceResever:u?g:R,liquidity:h,displayAmountA:G,displayAmountB:W,displayPercentA:ut,displayPercentB:dt,currentPrice:u?L:S,currentPriceReverse:u?S:L,disPlayProtocolFeeRate:pt,displayCoinTypeA:yt,displayCoinTypeB:bt,hardCap:tt,quoteCoinType:K,quoteCoin:N,baseCoin:U,baseCoinType:et,totalSupply:mt}}};return{getVaultsContractInfo:V,getVaultPool:P,wrapVaultPoolContractInfo:_}}function Ut(){const{lpTokenInfoObj:a}=ct(),{volatileVaultsSdk:t}=Z(),{currentAccount:e}=xt(),{setVaultsPositionObj:o,setVaultsPositionLoading:b}=Bt();wt();const p=H.useRef(e==null?void 0:e.address);H.useEffect(()=>{p.current=e==null?void 0:e.address},[e==null?void 0:e.address]);const V=async(l,s,n,c)=>{b(!0);const u=(await t.FullClient.getAllBalances({owner:e==null?void 0:e.address})).reduce((m,r)=>(m[r.coinType.toLowerCase()]=r,m),{});for(let m=0;m<l.length;m++){const r=l[m],f=r.category=="cetus"?s[r.vaultId]:n[r.vaultId],d=c[r.clmmPoolAddress],g=u[r.lpTokenType.toLowerCase()];P(r,d,f,g)}b(!1)},P=async(l,s,n,c,i=e==null?void 0:e.address)=>{const{category:u}=l;let m,r;c?r=c:r=await t.FullClient.getBalance({owner:i,coinType:l.lpTokenType}),u=="cetus"?m=Vt.buildVaultBalance(i,n,r,s):m=St(i,r.totalBalance,n,s);const f=_({...m,ownerAddress:p.current==i?i:void 0},l,n);return o(f),f},_=(l,s,n)=>{const c=a[s.lpTokenType],{amount_a:i,amount_b:u,ownerAddress:m}=l,{isReverse:r,tokenA:f,tokenB:d,category:g}=s,h=M(i,f.decimals).toString(),k=M(u,d.decimals).toString(),R=l.clmm_pool_id,z=l.liquidity,S=l.vault_id,L=ot(l.coin_type_a).full_address,O=ot(l.coin_type_b).full_address,B=y(c,l.lp_token_balance),q=g=="cetus"?D(B.balance).div(n.total_supply).mul(100).toString():D(B.balance).div(n.lp_token_treasury).mul(100).toString(),w=`${vt(q,2,6)}%`,A=r?d:f,G=r?f:d;return{[S]:{...B,amountA:h,amountB:k,displayAmountA:r?k:h,displayAmountB:r?h:k,coinTypeA:L,coinTypeB:O,displayCoinTypeA:r?O:L,displayCoinTypeB:r?L:O,liquidity:z,clmmPool:R,vaultId:S,shartOfPoolDisplay:w,tokenA:f,tokenB:d,displayTokenA:A,displayTokenB:G,ownerAddress:m}}},y=(l,s)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:99 ~ getVaultBalance ~ tokenInfo:",l);const n=M(s,l==null?void 0:l.decimals).toString();return{balance:s,balanceFormat:n,balanceDisplay:Tt(n,void 0,!1,jt.ROUND_DOWN).toString()}};return{getVaultPosition:P,getVaultsPosition:V}}function Xt(){const{pythPriceMap:a}=rt(),t=H.useMemo(()=>a,[a]),e=H.useCallback((b,p,V)=>{var _;const P=Number(p)==0?"0":V;if(p&&b&&+p&&lt(t)){const y=(_=t[Y(b)])==null?void 0:_.price;if(y)return j(p).mul(y).toString()}return P},[t]),o=H.useCallback(b=>{var p;return b&&lt(t)?(p=t[Y(b)])==null?void 0:p.price:0},[t]);return{getTokenAmountValueByPyth:e,getTokenPriceByPyth:o}}function Yt({vaultsLstApyDisplay:a,vaultsApyDisplay:t,vaultsTotalApyDisplay:e,category:o,vaultsAprDisplay:b}){return x.jsx(ht,{tooltip:x.jsx(qt,{vaultsApyDisplay:t,vaultsLstApyDisplay:a,vaultsTotalApyDisplay:e,vaultsAprDisplay:b,category:o}),children:x.jsx(kt,{textColor:"text_caption",textAlign:"right",fontWeight:"500",textDecoration:"underline dotted",color:"primary",children:o=="cetus"?e:t})})}const qt=({vaultsLstApyDisplay:a,vaultsApyDisplay:t,vaultsTotalApyDisplay:e,category:o,vaultsAprDisplay:b})=>x.jsx(X,{gap:"12px",w:"100%",pt:"8px",pb:"8px",children:o=="cetus"?x.jsxs(X,{children:[x.jsx(F,{label:"Total APY",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},wrapStyle:{gap:"16px"},value:e}),x.jsx(nt,{h:"1px",w:"100%",backgroundColor:"border"}),x.jsx(F,{label:"Fees and Rewards",labelStyle:{fontSize:"12px"},valueStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:t}),x.jsx(F,{label:"LST",labelStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:a,valueStyle:{fontSize:"12px"}})]}):x.jsxs(X,{children:[x.jsx(F,{label:"Cetus LP APR",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},wrapStyle:{gap:"16px"},value:b}),x.jsx(nt,{h:"1px",w:"100%",backgroundColor:"border"}),x.jsx(F,{label:"Vault APY",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},wrapStyle:{gap:"16px"},value:t}),x.jsx(F,{label:"(Compounding Cetus LP APR Multiple Times a Day)",labelStyle:{fontSize:"12px",lineHeight:"16px",maxW:"200px"},wrapStyle:{gap:"16px"},value:"",valueStyle:{fontSize:"12px"}})]})});export{qt as V,Bt as a,Yt as b,Ut as c,Ct as d,Kt as e,zt as f,It as g,Xt as h,Wt as i,rt as j,ct as u,Dt as v};
//# sourceMappingURL=VaultsAprBlock-D1GuVHob.js.map

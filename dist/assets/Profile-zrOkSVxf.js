import{a as m,j as e,H as R,T as p,V as A,f as N,aa as ct,v as M,X as Ve,Y as We,Z as Ne,$ as Ge,a0 as qe,a1 as Ie,C as Ke,D as dt,u as J,N as ut,O as pt,Q as xt,ar as Fe,ab as Ye,ag as Te,I as gt}from"./vendor-DXHkIl66.js";import{i as he,e as Pe,q as Ue,d as B,aU as ge,I as Q,B as V,v as $,c as ke,a as Z,F as Qe,G as ht,j as H,O as fe,z as K,R as Ze,n as ae,M as Y,p as ft,X as mt,f as Je,w as z,m as Re,as as G,aV as bt,ar as et,am as jt,k as me,aW as Ct,aX as Ee,Q as xe,V as tt,aR as wt,al as yt,aI as we,a0 as _t,aY as He,aZ as Me}from"./index-1pql7esm.js";import{u as st,D as nt,g as St,e as vt,f as Tt,b as kt,R as Lt,a as Pt,d as Rt}from"./OverviewOrders-BXSdyvuZ.js";import{I as ye}from"./IconText-BoC6CBk5.js";import{u as Ot}from"./RangeValue-CWje48WD.js";import{N as ee}from"./NoData-CqJO7NcS.js";import{H as W}from"./HTextLabelBox-BUAVAY0k.js";import{u as q}from"./activeOrders-DLCin0Mb.js";import{H as Oe,T as be}from"./Table-DgQWWpDa.js";import{b as At,u as re,c as Dt,C as Bt,P as Ft,F as Ut,E as Et,S as Ht,O as Mt,a as zt}from"./useGetLimitOrderHistory-Bq52Oo3W.js";import{u as Xt}from"./useRpcListener-ct19cNgt.js";import{u as $t}from"./global-BhEQOSwv.js";import{R as Vt}from"./RefreshButton-BHZks4q0.js";import{A as Wt,R as Nt}from"./RecentTransactions-QqeBUWDl.js";import{a as ne,d as Gt,u as ot,e as qt,f as It,g as Kt,c as Yt,b as Qt}from"./usePositionList-BulHo-5f.js";import{P as Zt,a as Jt,b as es,u as ts}from"./PoolItem-BJyExHJt.js";import{P as ss,u as ns}from"./PositionListLoading-pe9FaJCF.js";import{u as os}from"./useAccountBalance-C2Raiu99.js";import{u as it}from"./useToken-DQuh8vo3.js";import{e as Ae,X as is,a as as,b as rs,u as ls,C as cs,d as ds,c as us,f as ps}from"./useXCetus-g-ma6vvs.js";import{S as xs}from"./SingleTokenInfo-CIUspzmb.js";import{S as gs}from"./SortDropBlock-Dj4gnwlR.js";import{T as _e}from"./TableSortTh-BI2T_bnk.js";import{u as hs}from"./useTokenBalance-CuMCex55.js";import{X as fs,b as ms,c as bs,d as js,a as Cs}from"./useXCetusHelper-B8egdb_b.js";import"./useTransaction-HT-BOlou.js";import"./useTrack-CtIH4d6T.js";import"./useSigner-CFmwTogF.js";import"./Pagination-CSSNOfsX.js";import"./ErrorTips-CNrEhtPh.js";import"./usePreviousValue-BBpD8e7r.js";import"./CopyButton-DHFYRM3v.js";import"./useFavoritePool-DE7_4UZt.js";import"./useGetPoolList-B1dNsTr9.js";import"./useWrapPoolData-DbIflROk.js";import"./CheckBox-C4jUOy1k.js";import"./SearchInputBlock-CxfIwtLG.js";import"./index-CPJdQ42G.js";import"./Loading-BH2b7hW0.js";import"./TooltipIcon-C0_AzT63.js";import"./PositionCurrentPrice-A2W_iwn3.js";import"./useBurn-BCV4jC2K.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-18SnxIQd.js";import"./PoweredByHaedal-990R--7x.js";import"./PriceRange-C09QLmLc.js";import"./PositionStatus-gu0KkwGh.js";import"./detail-B3wKtpN6.js";import"./TradeInputGroup-CpiF2tC0.js";import"./_getAllKeysIn-Ds6Ic9w2.js";import"./HighlightText-BLaAjUt8.js";import"./index-CptRizr3.js";import"./debounce-BgSgg6I6.js";import"./index-DKPh1ief.js";function ws(t=100){const o=m.useRef([]),s=m.useRef(!1),i=m.useRef(void 0),r=m.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const c=o.current.shift();if(!c)continue;const{id:l,run:u,onStart:f,onSuccess:x,onError:b}=c;if(c._cancelled){console.log(`[task:${c.id}] skipped (cancelled)`);continue}try{console.log(`[task:${l}] start`),f==null||f(l);const g=await u(i.current,l);i.current=g,console.log(`[task:${l}] success`,g),x==null||x(g,l)}catch(g){console.error(`[task:${l}] failed`,g),b==null||b(g,l)}await new Promise(g=>setTimeout(g,t))}s.current=!1}},[t]),n=c=>{o.current.push(c),r()},a=c=>{const l=o.current.find(u=>u.id===c);l&&(l._cancelled=!0),o.current=o.current.filter(u=>u.id!==c)};return m.useEffect(()=>()=>{o.current=[],s.current=!1,i.current=void 0},[]),{addTask:n,removeTask:a}}function je(t){const{type:o,children:s,wrapStyle:i={h:"60px"},textStyle:r={fontSize:"16px"}}=t,n=(a,c)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(a,c):a===c.value;return e.jsxs(R,{justify:"space-between",w:"100%",h:"60px",...i,children:["title"in t?e.jsx(p,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(he,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(a,c)=>n(a,c),wrapStyle:{h:"60px",border:"none",gap:"38px",...i},itemStyle:r}),s]})}function ys({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:i,outCoin:r}=t,{orderHistoryList:n,handleGetDcaOrderHistory:a,orderHistoryListLoading:c}=st();m.useEffect(()=>{t!=null&&t.orderID&&a(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:l}=Pe(),[u,f]=m.useState(s),x=142,b=(n==null?void 0:n.length)||0,g=(n==null?void 0:n.length)<=1?`${x*b-8}px`:`${x*b+(b-1)*32-8}px`;return e.jsxs(A,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(n==null?void 0:n.length)>=3?"460px":"unset",overflowY:"auto",children:[!c&&e.jsx(N,{h:g,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),c?e.jsx(R,{h:"100px",w:"100%",justify:"center",children:e.jsx(ct,{})}):(n==null?void 0:n.length)===0?e.jsx(ee,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):n.map(w=>{const S=Ue(w.inAmount,i==null?void 0:i.decimals),v=Ue(w.outAmount,r==null?void 0:r.decimals),h=B(S).div(v).toString(),j=B(1).div(h).toString();return e.jsxs(A,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(R,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(p,{h:"20px",lineHeight:"20px",children:[ge((w==null?void 0:w.time)*1e3)," (UTC)"]}),e.jsx(Q,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(l(w==null?void 0:w.tx,"tx"))}}),e.jsx(R,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(N,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(V,{p:"16px",borderRadius:"12px",children:e.jsxs(A,{align:"flex-start",gap:"20px",children:[e.jsxs(A,{gap:"0px",align:"flex-start",children:[e.jsx(p,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:u?`${$(h)} `:`${$(j)} `}),e.jsxs(R,{children:[e.jsxs(p,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",u?` ${i.symbol} per ${r.symbol}`:` ${r.symbol} per ${i.symbol}`,")"]}),e.jsx(Q,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>f(!u)})]})]}),e.jsxs(R,{w:"100%",gap:"4px",children:[e.jsx(ke,{imageUrl:i==null?void 0:i.logo_url,w:"20px",h:"20px"}),e.jsx(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${$(S)}`}),e.jsx(p,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${i.symbol}`}),e.jsx(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(ke,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(p,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${$(v)}`}),e.jsx(p,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},w==null?void 0:w.tx)})]})}function _s({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:i=!1,toClaim:r}){const{inCoin:n,outCoin:a}=t;return e.jsxs(A,{children:[e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(nt,{orderInfo:t}),o&&r&&e.jsx(M,{isLoading:i,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||i,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(p,{fontSize:"16px",color:"text_caption",children:St(t,o,!0)}),e.jsx(p,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(R,{w:"100%",justify:"space-around",children:[e.jsxs(A,{children:[e.jsx(p,{fontSize:"16px",color:"text_caption",children:vt(t)}),e.jsxs(p,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance"]})]}),e.jsx(N,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(A,{children:[e.jsx(p,{color:"text_caption",fontSize:"16px",children:Tt(t)}),e.jsxs(p,{fontSize:"12px",children:["DCA ",a==null?void 0:a.symbol," Balance "]})]})]}),e.jsxs(A,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(W,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(W,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(W,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${n==null?void 0:n.symbol}`}),o&&e.jsx(W,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${n==null?void 0:n.symbol} per ${a==null?void 0:a.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${a==null?void 0:a.symbol} per ${n==null?void 0:n.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(W,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${n==null?void 0:n.symbol} per ${a==null?void 0:a.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${a==null?void 0:a.symbol} per ${n==null?void 0:n.symbol}`}),o&&e.jsx(W,{label:"Next Order (UTC)",value:ge(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(W,{label:"Created (UTC)",value:ge(t==null?void 0:t.createdAt)||""})]})]})}function Ss({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:i,isClaimLoading:r=!1,toClaim:n}){const{isApp:a}=Z(),c=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[l,u]=m.useState("overview"),{inCoin:f,outCoin:x}=s,[b,g]=m.useState(!1),{getTokenRank:w}=Ot();return m.useEffect(()=>{const S=w(f,x);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",x,f,S),g(!S)},[f==null?void 0:f.coin_type,x==null?void 0:x.coin_type]),e.jsxs(Ve,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(We,{}),e.jsxs(Ne,{minWidth:a?"300px":"482px",children:[e.jsx(Ge,{children:e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"tab",currentTab:l,tabs:c,onTabChange:S=>u(S.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(qe,{}),e.jsxs(Ie,{p:"0 16px 16px",textAlign:"center",children:[l=="overview"&&e.jsx(_s,{orderInfo:s,isActiveOrder:i,pageDirect:b,isClaimLoading:r,toClaim:n}),l=="orders"&&e.jsx(ys,{orderInfo:s,isActiveOrder:i,pageDirect:b})]})]})]})}function vs({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=Z(),[i,r]=m.useState(!1),{getExplorerUrl:n}=Pe(),{isClaimLoading:a,toClaim:c,closeOrderAction:l,isCloseLoading:u}=st();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(R,{justify:"flex-end",children:[e.jsx(M,{isLoading:a,onClick:()=>c(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(Qe,{placement:"bottom-end",tooltip:e.jsxs(A,{align:"flex-start",children:[e.jsx(ye,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(ye,{text:"View on Explorer",onClick:()=>{window.open(n(t.orderID,"poolAddress"))}}),e.jsx(ye,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:u?()=>{}:()=>{l(t)}})]}),children:e.jsx(Ke,{children:e.jsx(M,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(Q,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(R,{justify:"flex-end",children:[e.jsx(M,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(M,{onClick:f=>{ht(f),window.open(n(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(Q,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),i&&e.jsx(Ss,{isOpen:i,onClose:()=>r(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:a,toClaim:c})]})}function Ts(){const{currentAccount:t}=H(),{isAutoRefresh:o,dcaOrderListLoading:s,dcaActiveOrderList:i,dcaPastOrderList:r}=q(),[n,a]=m.useState("activeDCAs"),c=m.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!o&&s?"":i==null?void 0:i.length},{label:"Past DCAs",value:"pastDCAs",num:!o&&s?"":r==null?void 0:r.length}],[s,r,i]),l=m.useMemo(()=>n=="activeDCAs"?i:r,[n,i,r]),{isApp:u}=Z(),{closeAll:f,claimAll:x,isClaimAllLoading:b,isCloseAllLoading:g}=kt(),w=m.useMemo(()=>n==="pastDCAs"||(l==null?void 0:l.length)===0?0:l==null?void 0:l.reduce((S,v)=>B(S).plus(v==null?void 0:v.outBalance),B(0)).toString(),[n,l]);return e.jsxs(A,{w:"100%",children:[e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(he,{type:"outlineTab",tabList:c,currentTab:n,handleChangeTab:S=>a(S==null?void 0:S.value),isActive:(S,v)=>S===v.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(l==null?void 0:l.length)>1&&n=="activeDCAs"&&e.jsxs(R,{children:[e.jsx(M,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:b,disabled:Number(w)===0||b,onClick:()=>{x(l)},children:"Claim All"}),e.jsx(M,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:g,disabled:(l==null?void 0:l.length)==0||g,onClick:()=>{f(l)},children:"Close All"})]})]}),e.jsx(A,{w:"100%",position:"relative",gap:"20px",children:!s&&(l==null?void 0:l.length)===0?e.jsx(ee,{type:"nodata",noBorder:!0}):u?e.jsx(A,{w:"100%",gap:"4px",children:e.jsx(Oe,{rowKey:"orderId",columns:ze(n=="activeDCAs"),dataSource:l,loading:!o&&s,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"orderId",columns:ze(n=="activeDCAs"),dataSource:l,loading:!o&&s,rowStyle:{h:"80px",cursor:"pointer"}})})]})}const ze=t=>[{title:e.jsx(p,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(nt,{orderInfo:s})},{title:e.jsx(p,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Lt,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(p,{textAlign:"right",children:"Total"}),key:"total",thConfig:{w:"12%"},render:({inDeposited:s,inCoin:i})=>e.jsxs(p,{color:"text_caption",children:[$(s)," ",i==null?void 0:i.symbol]})},{title:e.jsx(p,{textAlign:"right",children:"Completed"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Pt,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(p,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(p,{color:"text_caption",children:ge(s)})},{title:e.jsx(p,{textAlign:"right",children:t?"Actions":"Action"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(vs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function ks(){const{currentAccount:t}=H(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:i}=At(),{myOrderList:r,orderListLoading:n}=re(),{isAutoRefresh:a,autoRefreshCount:c}=q(),[l,u]=m.useState("openOrders"),f=m.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:!a&&n?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:!a&&i?"":s==null?void 0:s.length}],[n,i,r,s]),x=h=>{t!=null&&t.address&&o(t.address,h)};m.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",c),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),c>0&&x(!0)},[c]),m.useEffect(()=>{x(!0)},[l,t]);const b=m.useMemo(()=>l=="openOrders"?n:i,[l,n,i]),g=m.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,s),l=="openOrders"?r:s),[l,r,s]);Xt({onRpcChange:()=>{x(!0)}});const{isApp:w}=Z(),{handleCancelOrder:S,cancelOrderLoading:v}=Dt();return Pe(),e.jsxs(A,{w:"100%",gap:"12px",children:[e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(he,{type:"outlineTab",tabList:f,currentTab:l,handleChangeTab:h=>u(h==null?void 0:h.value),isActive:(h,j)=>h===j.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(g==null?void 0:g.length)>1&&l=="openOrders"&&e.jsx(R,{children:e.jsx(M,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:v,onClick:()=>{S(r)},children:"Cancel All"})})]}),e.jsx(A,{w:"100%",position:"relative",gap:"20px",children:!b&&(g==null?void 0:g.length)===0?e.jsx(ee,{type:"nodata",noBorder:!0}):w?e.jsx(A,{w:"100%",gap:"4px",children:e.jsx(Oe,{rowKey:"order_id",columns:Xe(l=="openOrders"),dataSource:g,loading:!a&&b,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(be,{rowKey:"order_id",columns:Xe(l=="openOrders"),dataSource:g,loading:!a&&b,rowStyle:{h:"80px",cursor:"pointer"}})})]})}const Xe=t=>[{title:e.jsx(p,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(Bt,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(p,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Ft,{info:s,isProfile:!0})},{title:e.jsx(p,{textAlign:"right",children:"Total"}),key:"total",thConfig:{w:"16%"},render:({total_pay_amount:s,pay_coin:i})=>e.jsxs(p,{color:"text_caption",children:[$(s)," ",i.symbol]})},{title:e.jsx(p,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(Ut,{info:s,isProfile:!0})},{title:e.jsx(p,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Et,{info:s,isProfile:!0})},!t&&{title:e.jsx(p,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Ht,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(p,{textAlign:"right",children:t?"Actions":"Action"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(Mt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function Ls(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=m.useState("limitOrders");return e.jsx(V,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{align:"flex-start",gap:"20px",children:[e.jsx(N,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"tab",currentTab:o,tabs:t,onTabChange:i=>s(i.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(ks,{}),o==="dca"&&e.jsx(Ts,{})]})})}const Ps=(t,o)=>o?t:"********";function Rs({handleRefresh:t,totalValue:o,isLoading:s}){const{isApp:i}=Z(),{currentAccount:r,accounts:n}=H(),{isShowProfileAssets:a,setIsShowProfileAssets:c}=$t(),[l,u]=m.useState(!1),{onClose:f}=dt();return e.jsxs(A,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(R,{w:"100%",children:[e.jsx(p,{lineHeight:"20px",fontSize:"16px",color:"text_caption",children:"Total Value"}),e.jsx(Qe,{showTooltip:!i,placement:"bottom-end",tooltip:e.jsx(p,{fontSize:"12px",children:a?"Hide Value":"View Value"}),children:e.jsx(Ke,{children:e.jsx(Q,{xlinkHref:a?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>c(!a)})})})]}),e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(J,{isLoaded:!s,h:"22px",children:e.jsx(p,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:Ps(fe(o,2),a)})}),e.jsxs(R,{children:[e.jsxs(R,{p:"0 8px",h:"36px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{u(!0)},children:[e.jsx(Q,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(p,{children:"Transactions"})]}),e.jsx(Vt,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),n.length>1&&e.jsxs(R,{children:[e.jsx(p,{color:"primary_gray",children:"Roul : "}),e.jsx(Wt,{currentAccount:r,accounts:n,onClose:f,isProfile:!0})]}),l&&e.jsx(Nt,{isOpen:l,onClose:()=>u(!1)})]})}function Os(){var v;const{currentAccount:t,onWalletModal:o}=H(),{showPosListLength:s,setShowPosListLength:i,posBaseListLoading:r,posBaseListGroupByPool:n}=ne(),[a,c]=m.useState([]),{isAutoRefresh:l}=q(),[u,f]=m.useState([]),x=h=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",h),f(j=>[...j,h])},b=h=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",h),f(j=>j.filter(_=>(_==null?void 0:_.coin_type)!==(h==null?void 0:h.coin_type)))};m.useEffect(()=>{t!=null&&t.address?console.log("ðŸš€ ~ useEffect ~ currentAccount?.address:",t==null?void 0:t.address):i("")},[t==null?void 0:t.address]),m.useEffect(()=>{var D,E,T,d;const h=(D=u[0])!=null&&D.coin_type?K((E=u[0])==null?void 0:E.coin_type):void 0,j=(T=u[1])!=null&&T.coin_type?K((d=u[1])==null?void 0:d.coin_type):void 0,_=Object.values(n).filter(C=>h&&j?K(C.tokenA.coin_type)==h&&K(C.tokenB.coin_type)==j||K(C.tokenA.coin_type)==j&&K(C.tokenB.coin_type)==h:h?K(C.tokenA.coin_type)==h||K(C.tokenB.coin_type)==h:C);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(n),_),c(_);const P=_.reduce((C,k)=>C+(k.list?k.list.length:0),0);t!=null&&t.address&&i(P.toString())},[u,n]),m.useEffect(()=>()=>{i("")},[]),m.useEffect(()=>{r&&i("")},[r]);const g=m.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[w,S]=m.useState("positions");return e.jsx(V,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{gap:"16px",w:"100%",children:[e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"tab",currentTab:w,tabs:g,onTabChange:h=>S(h.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(Zt,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:u,onClickSelectCoinList:x,onDeleteSelectCoinList:b})]}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(Jt,{}),t!=null&&t.address?!l&&r?[{},{},{},{}].map((h,j)=>e.jsx(ss,{},j)):((v=Object.values(a))==null?void 0:v.length)>0?Object.values(a).map((h,j)=>e.jsx(es,{poolInfo:h},j)):e.jsx(ee,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(ee,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})})}const As=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),Ce=Ze(As);function at(){const{currentAccount:t}=H(),{fetchAccountBalance:o}=os(),{coinHoldingList:s,setCoinHoldingList:i,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:n,setHoldingsTotalUsd:a,isCoinPriceLoading:c,setUnknownCoinCount:l}=Ce(),{getTokenListInfo:u}=it(),{getTokenPrice:f}=ae(),{refreshCoinPriceInfo:x}=Ae(),b=m.useRef(t==null?void 0:t.address);m.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const g=async()=>{const j=b.current;if(j){r(!0);const _=await o(j,!0);if(_){const P=await u(_.filter(T=>B(T.totalBalance).gt(0)).map(T=>T.coinType));if(!P)throw r(!1),i([]),new Error("get token list info error");const D=[];let E=0;return _.forEach(T=>{const d=P.get(T.coinType);if(d){const C=T.totalBalance,k=Y(C,d.decimals).toString(),L=$(k,void 0,void 0,ft.ROUND_DOWN).toString(),O={balance:C,balance_format:k,balance_display:L,balance_usd:"0",coin:d,coin_type:d==null?void 0:d.coin_type,price:"",price_diff_24:""};D.push(O),d.is_verified||E++}}),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",j),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",b.current),j===b.current&&(i(D),l(E),w([...D])),r(!1),D}}else r(!1),i([]);return[]},w=async j=>{n(!0);try{await x(j.filter(_=>_.coin.is_verified).map(_=>_.coin.coin_type))}catch(_){console.error("fetch coin price info error",_)}finally{n(!1)}},S=j=>{j.forEach(_=>{const{coin:P}=_;if(P.is_verified){const D=f(P.coin_type);D&&(_.price=D.price,_.price_diff_24="",_.balance_usd=B(_.balance_format).mul(D.price).toString())}})},v=async j=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:j,coinHoldingList:s,currentAccount:t}),t){const{search:_,current_sort:P,current_sort_order:D,is_show_unknown:E=!1,is_hide_small_balance:T=!0}=j;let d=[];if(E?d.push(...s):d=s.filter(C=>C.coin.is_verified),_){const C=_.toLowerCase();d=d.filter(k=>k.coin.coin_type.toLowerCase().includes(C)||k.coin.symbol.toLowerCase().includes(C)||k.coin.name.toLowerCase().includes(C))}return S(d),T&&!c&&(d=d.filter(C=>B(C.balance_usd).gt(.01))),d.sort((C,k)=>{if(P==="balance"){const L=B(C.balance_format).cmp(B(k.balance_format));if(L!==0)return D==="desc"?-L:L}if(P==="value"){const L=B(C.balance_usd).cmp(B(k.balance_usd));return L!==0?D==="desc"?-L:L:B(k.balance_format).cmp(B(C.balance_format))}if(P==="price"){const L=B(C.price).cmp(B(k.price));return L!==0?D==="desc"?-L:L:B(k.balance_format).cmp(B(C.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",d),d}return[]};return m.useEffect(()=>{S(s);const j=s.reduce((_,P)=>_+Number(P.balance_usd||0),0);a(j.toString())},[s,c]),{getFilterCoinHoldingList:v,fetchCoinHoldingList:g,resetUserData:()=>{i([]),a("0"),l(0)}}}function Ds({inputValue:t,changeInputValue:o}){const s=m.useRef(null),[i,r]=m.useState(!1);return Z(),e.jsxs(ut,{children:[e.jsx(pt,{w:i?"203px":"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},bg:"bg_secondary",ref:s,borderRadius:"8px",h:"32px",border:"1px solid",borderColor:"border",variant:"outline",value:t,onChange:n=>{o(n.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{o(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:"8px",pl:i?"28px":"8px"}),e.jsxs(xt,{children:[e.jsx(Q,{position:"absolute",top:"6px",left:i?"-198px":"-26px",xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:n=>{var a;(a=s.current)==null||a.focus(),r(!0)}}),t?e.jsx(Q,{xlinkHref:"#icon-icon_close",position:"absolute",top:"6px",right:"6px",onMouseDown:n=>n.preventDefault(),onClick:n=>{o(""),setTimeout(()=>{var a;(a=s.current)==null||a.focus()},0)}}):null]})]})}function Bs({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:i,isHideLowAsset:r,handleIsHideLowAsset:n,unknownCoinCount:a}){return Z(),e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(p,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(R,{children:[e.jsx(Ds,{inputValue:t,changeInputValue:o}),e.jsx(V,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(R,{h:"100%",justify:"space-between",children:[e.jsxs(p,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",a,")"]}),e.jsx(Fe,{isChecked:s,onChange:i})]})}),e.jsx(V,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",children:e.jsxs(R,{h:"100%",justify:"space-between",children:[e.jsx(p,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Fe,{isChecked:r,onChange:n})]})})]})]})}function Fs(){const{isApp:t}=Z(),{getFilterCoinHoldingList:o}=at(),{isCoinHoldingLoading:s,isCoinPriceLoading:i,unknownCoinCount:r}=Ce(),{isAutoRefresh:n}=q(),[a,c]=m.useState([]),[l,u]=m.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[f,x]=m.useState(!1),[b,g]=m.useState(!0),[w,S]=m.useState("desc"),[v,h]=m.useState(Le[2]),j=d=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",d),u(d),o(d).then(c)},_=d=>{j({...l,search:d})},P=(d,C)=>{j({...l,[d]:C}),d==="is_show_unknown"&&x(C),d==="is_hide_small_balance"&&g(C)},D=d=>{const C=(d==null?void 0:d.value)===(v==null?void 0:v.value),k=t||!C?"desc":w==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",k,d),h(d),S(k),j({...l,current_sort:d.value,current_sort_order:k})};m.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,i,a),!s&&!i&&j(l)},[s,i]);const E=Ye(),T=d=>{E(`/swap/${d}/''`)};return e.jsx(V,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Bs,{unknownCoinCount:r,inputValue:l.search||"",changeInputValue:_,isShowUnknownCoin:f,handleIsShowUnknownCoin:d=>P("is_show_unknown",d.target.checked),isHideLowAsset:b,handleIsHideLowAsset:d=>P("is_hide_small_balance",d.target.checked)}),e.jsx(N,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsx(A,{w:"100%",position:"relative",gap:"20px",children:!s&&(a==null?void 0:a.length)===0?e.jsx(ee,{type:"nodata",noBorder:!0}):t?e.jsxs(A,{w:"100%",gap:"4px",children:[e.jsxs(R,{w:"100%",justify:"space-between",children:[e.jsx(p,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(gs,{sortText:"Sort by",minW:"180px",currentSort:v,sortByList:Le,onSortByChange:D,xlinkHref:w==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>S(d=>d==="desc"?"asc":"desc")})]}),e.jsx(Oe,{rowKey:"coin_type",columns:$e(w,v,D,T,!n&&i),dataSource:a,loading:!n&&s,itemSkeletonLength:5,itemHeight:"30px",onRowClick:d=>{T(d==null?void 0:d.coin_type)}})]}):e.jsx(be,{rowKey:"coin_type",columns:$e(w,v,D,T,!n&&i),dataSource:a,skeletonLength:10,loading:!n&&s,rowStyle:{h:"72px",cursor:"pointer"},onRowClick:d=>{T(d==null?void 0:d.coin_type)}})})]})})}const Le=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Se=Object.fromEntries(Le.map(t=>[t.value,t])),$e=(t,o,s,i,r)=>[{title:e.jsx(p,{children:"Token"}),key:"pool",thConfig:{w:"22%"},showLabel:!1,render:({coin:n})=>e.jsx(xs,{haveTooltip:!0,token:n,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(_e,{labelInfo:Se.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"20%"},render:({coin:n,balance_display:a})=>e.jsxs(p,{color:"text_caption",children:[a," ",mt(n==null?void 0:n.symbol,10)]})},{title:e.jsx(_e,{labelInfo:Se.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"20%"},render:({price:n})=>e.jsx(R,{justify:"flex-end",children:e.jsx(J,{isLoaded:!r,children:e.jsxs(p,{color:"text_caption",children:["$",Je(n)]})})})},{title:e.jsx(_e,{labelInfo:Se.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"20%"},render:({balance_usd:n})=>e.jsx(R,{justify:"flex-end",children:e.jsx(J,{isLoaded:!r,children:e.jsx(p,{color:"text_caption",children:fe(n,2)})})})},{title:e.jsx(p,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"18%"},key:"actions",render:n=>e.jsx(M,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{i(n==null?void 0:n.coin_type)},children:"Swap"})}],Us=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),le=Ze(Us);function rt({title:t,imgUrl:o,onClick:s,btnTitle:i}){return e.jsxs(R,{justify:"space-between",align:"flex-start",w:"100%",children:[e.jsxs(R,{children:[o&&e.jsx(ke,{imageUrl:o,p:"4px",imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(p,{children:t})]}),s?e.jsx(M,{h:"32px",borderRadius:"8px",p:"8px",fontSize:"12px",onClick:s,fontWeight:"500",children:i}):e.jsx(N,{h:"32px"})]})}const Es={cetus:{title:"CETUS",imgUrl:z.cetus_coin.logo_url,bgUrl:"/images/cetus_holding_bg.png"},xcetus:{title:"xCETUS",imgUrl:z.x_cetus_coin.logo_url,bgUrl:"/images/xcetus_holding_bg.png"}};function lt({type:t,amount:o,amountUSD:s,isLoading:i,onClick:r,btnTitle:n,children:a}){const{title:c,imgUrl:l,bgUrl:u}=Es[t];return e.jsx(V,{flex:"1",bg:`right 0 bottom 60% / 86px 142px no-repeat url("${u}"), radial-gradient(40% 74% at 100% 100%,#1D342E 0%, rgba(22,27,48,0) 100%), rgba(0,0,0,0.5)`,backdropFilter:"blur(20px)",p:"16px",borderRadius:"16px",children:e.jsxs(A,{w:"100%",gap:"0",children:[e.jsx(rt,{title:`${c} Holdings`,imgUrl:l,onClick:r,btnTitle:n}),e.jsxs(A,{align:"flex-start",w:"100%",m:"31px 0 60px",children:[e.jsx(J,{isLoaded:!i,h:"26px",children:e.jsx(p,{color:"text_caption",h:"26px",lineHeight:"26px",fontSize:"22px",children:o})}),e.jsx(J,{isLoaded:!i,h:"17px",children:e.jsxs(p,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["Total ",c," (â‰ˆ $",Je(s,2),")"]})})]}),a]})})}function Hs(){const{currentAccount:t}=H(),{balanceInfo:o}=hs(z.cetus_coin),{getTokenAmountValue:s}=ae(),{coinPriceObj:i}=Re(),r=m.useMemo(()=>s(z.cetus_coin.coin_type,Y((o==null?void 0:o.balance)||"0",z.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,i]),{setCurrentXCetusTab:n,setIsXCetusModalOpen:a}=le(),c=()=>{a(!0),n("Get xCETUS")},{veNFT:l,veNFTLoading:u,lockCetusListLoading:f}=G();return e.jsx(lt,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:r,isLoading:(f||u)&&l!==void 0,children:e.jsx(M,{w:"100%",h:"48px",borderRadius:"12px",fontWeight:"500",fontSize:"16px",onClick:c,children:"Get xCETUS"})})}function Ms(){const{lockCetusList:t,lockCetusListLoading:o}=G();return t&&t.length>0&&e.jsxs(V,{p:"0 16px 16px",w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:[e.jsx(je,{type:"title",title:"Redeeming xCETUS"}),e.jsx(Te,{orientation:"horizontal"}),e.jsx(be,{mt:"10px",dataSource:t,columns:zs(),loading:o,skeletonLength:t==null?void 0:t.length,rowStyle:{h:"80px"}})]})}const zs=()=>[{title:e.jsx(p,{children:"xCETUS To CETUS"}),key:"to",render:t=>e.jsx(is,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"})},{title:e.jsx(p,{textAlign:"right",children:"Vesting Duration (Day)"}),key:"lock_day",render:t=>e.jsx(p,{color:"text_caption",fontSize:"14px",children:t==null?void 0:t.lock_day})},{title:e.jsx(p,{textAlign:"right",children:"Available Claim Date"}),key:"date",render:t=>e.jsx(p,{color:"text_caption",fontSize:"14px",children:bt.unix(t==null?void 0:t.locked_until_time).format("MMM D, YYYY HH:mm")})},{title:e.jsx(p,{textAlign:"right",children:"Actions"}),key:"actions",render:t=>{const[o,s]=m.useState(!1),{cancelOrderLoading:i,handleCancelOrder:r}=as(),{claimOrderLoading:n,handleClaimOrder:a}=rs(),c=l=>{l?a(t.id):r(t)};return m.useEffect(()=>{s(!et.isLocked(t))},[]),e.jsx(R,{justify:"flex-end",children:e.jsx(M,{onClick:()=>{i||n||c(o)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:i||n,color:o?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:o?"Claim":"Cancel"})})}}];function Xs({cetusApr:t,myShare:o,totalRewardValue:s,nextStartTime:i}){const{currentAccount:r}=H(),{days:n,hours:a,minutes:c,seconds:l}=ls((i||0)*1e3),{setCurrentXCetusTab:u,setIsXCetusModalOpen:f}=le(),{veNFTLoading:x}=G(),b=()=>{f(!0),u("Get xCETUS")};return e.jsx(V,{flex:"1.46",p:"16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(A,{w:"100%",gap:"0",children:[e.jsx(rt,{title:"Staking Rewards",onClick:b,btnTitle:"Claim"}),e.jsxs(A,{m:"36px 0 50px",h:"57px",children:[e.jsxs(R,{children:[e.jsx(de,{value:n,type:"d"}),e.jsx(p,{color:"text_caption",children:":"}),e.jsx(de,{value:a,type:"h"}),e.jsx(p,{color:"text_caption",children:":"}),e.jsx(de,{value:c,type:"m"}),e.jsx(p,{color:"text_caption",children:":"}),e.jsx(de,{value:l,type:"s"})]}),e.jsx(p,{fontSize:"14px",h:"17px",lineHeight:"17px",children:"Reward Distribution In"})]}),e.jsxs(R,{justify:"space-between",w:"80%",mb:"12px",children:[e.jsx(ve,{title:"Est.APR",value:`â‰ˆ${jt(t,2)}`,loading:t==="0"}),e.jsx(Te,{orientation:"vertical"}),e.jsx(ve,{title:"Your Share",value:o!=="--"?`â‰ˆ${o}`:o,loading:x}),e.jsx(Te,{orientation:"vertical"}),e.jsx(ve,{title:"Pending Yield",value:r?fe(s,2):"--",loading:x})]})]})})}const $s={d:"D",h:"H",m:"M",s:"S"},de=({value:t,type:o})=>e.jsxs(R,{borderRadius:"8px",bg:"background",p:"4px 8px",justify:"center",align:"flex-end",w:"64px",h:"32px",gap:"2px",children:[e.jsx(p,{color:"text_caption",fontSize:"20px",textAlign:"center",children:t}),e.jsx(p,{fontSize:"12px",mb:"1px",children:$s[o]})]}),ve=({title:t,value:o,loading:s})=>e.jsxs(A,{gap:"3px",children:[e.jsx(J,{isLoaded:!s,h:"17px",children:e.jsx(p,{color:"text_caption",fontSize:"14px",h:"17px",lineHeight:"1",children:o})}),e.jsx(p,{fontSize:"14px",h:"15px",lineHeight:"1",children:t})]});function Vs({availableXCetusAmount:t,redeemingXCetusAmount:o}){const{currentAccount:s}=H(),{veNFT:i,veNFTLoading:r,lockCetusListLoading:n}=G(),{getTokenAmountValue:a}=ae(),{coinPriceObj:c}=Re(),l=m.useMemo(()=>a(z.cetus_coin.coin_type,Y((i==null?void 0:i.xcetus_balance)||"0",z.x_cetus_coin.decimals)).toString(),[i==null?void 0:i.xcetus_balance,s==null?void 0:s.address,c]),{setCurrentXCetusTab:u,setIsXCetusModalOpen:f}=le(),x=()=>{f(!0),u("Redeem CETUS")},b=(n||r)&&i!==void 0;return e.jsx(lt,{type:"xcetus",amount:s?$(Y((i==null?void 0:i.xcetus_balance)||"0",9),9).toString():"--",amountUSD:l,onClick:x,btnTitle:"Redeem",isLoading:b,children:e.jsxs(A,{w:"100%",gap:"16px",h:"48px",children:[e.jsx(W,{isLoading:b,label:"Available",value:s?$(Y(t,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}}),e.jsx(W,{isLoading:b,label:"Redeeming",value:s?$(Y(o,9),9).toString():"--",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px",h:"14px"}})]})})}const ue=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function Ws({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:i,setCurrentXCetusTab:r}=le(),[n,a]=m.useState("#icon-a-icon_trade"),c=()=>{a("#icon-icon_swap1")},l=()=>{a("#icon-a-icon_trade")},u=()=>{var x;const f=(x=ue==null?void 0:ue.find(b=>(b==null?void 0:b.value)!==i))==null?void 0:x.value;f&&r(f)};return e.jsxs(Ve,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(We,{}),e.jsxs(Ne,{children:[e.jsx(Ge,{p:"0 16px",children:e.jsx(N,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(he,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:ue,currentTab:i,handleChangeTab:f=>{r(f==null?void 0:f.value)}})})}),e.jsx(qe,{}),e.jsxs(Ie,{p:"20px 16px 16px",children:[i==="Get xCETUS"&&e.jsx(cs,{availableXCetusAmount:s,onIconClick:u,iconParams:{xlinkHref:n,svgFill:"text_caption",transform:n==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:n==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:c,onMouseLeave:l}}),i==="Redeem CETUS"&&e.jsx(ds,{availableXCetusAmount:Y(s,9),onIconClick:u,iconParams:{xlinkHref:n,svgFill:"text_caption",transform:n==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:n==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:c,onMouseLeave:l}})]})]})]})}function Ns(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=le(),{availableXCetusAmount:s,redeemingXCetusAmount:i,cetusApr:r,myShare:n,totalRewardValue:a,nextStartTime:c}=us();return e.jsxs(A,{w:"100%",gap:"12px",children:[e.jsxs(R,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsx(Xs,{cetusApr:r,myShare:n,totalRewardValue:a,nextStartTime:c}),e.jsx(Vs,{availableXCetusAmount:s,redeemingXCetusAmount:i}),e.jsx(Hs,{})]}),e.jsx(Ms,{}),t&&e.jsx(Ws,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})}function Gs(){const{currentAccount:t}=H(),{orderListLoading:o,myOrderList:s}=re(),{isAutoRefresh:i,dcaOrderListLoading:r,dcaActiveOrderList:n}=q(),{getTokenAmountValue:a,coinPriceObj:c}=ae(),l=m.useMemo(()=>{let x=B(0);if(i||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(b=>{const{pay_coin:g,target_coin:w,un_claimed_amount:S,remaining_amount:v}=b,h=a(g.coin_type,v),j=a(w.coin_type,S);x=B(x).plus(h).plus(j),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",x.toString())}),x.toString()):"0"},[i,s,t==null?void 0:t.address,o,c]),u=m.useMemo(()=>{let x=B(0);if(i||!r)return(n==null?void 0:n.length)>0&&(t!=null&&t.address)?(n.forEach(b=>{const{inBalance:g,sellCoin:w,outBalance:S,buyCoin:v}=b,h=a(g.coin_type,w),j=a(S.coin_type,v);x=B(x).plus(h).plus(j),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",x.toString())}),x):"0"},[i,n,t==null?void 0:t.address,r,c]),f=m.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",u,l),u&&l){let x=B(0);return x=B(x).plus(u).plus(l),x.toString()}return"--"},[u,l]);return{limitTotalTvl:l,dcaTotalTvl:u,orderTotalTvl:f}}function qs(){const{currentAccount:t}=H(),{isAutoRefresh:o}=q(),{veNFT:s,veNFTLoading:i,lockCetusListLoading:r}=G(),{getTokenAmountValue:n}=ae(),{coinPriceObj:a}=Re();return{xCetusTotalTvl:m.useMemo(()=>{if(o||!i&&!r)return t!=null&&t.address&&s?n(z.cetus_coin.coin_type,Y(s==null?void 0:s.xcetus_balance,z.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,r,i,t==null?void 0:t.address,a])}}const Is="fetch-coin-holding-list",Ks="fetch-owner-nft",Ys="fetch-active-order-list",Qs="fetch-xcetus-base-info";function Zs(){const{currentAccount:t}=H(),{getTokenListInfo:o}=it(),{getLimitUserIndexer:s,getDcaUserIndexer:i}=ps(),{setOrderListLoading:r,setMyOrderList:n}=re(),{setDcaOrderListLoading:a,setDcaActiveOrderList:c,setDcaPastOrderList:l}=q(),{refreshCoinPriceInfo:u}=Ae(),{buildDcaOrderList:f}=Rt(),{peripherySdk:x}=me(),{formatLimitOrderList:b}=zt(),g=async()=>{if(t){r(!0);const h=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",h),h)try{return(await x.ClmmSDK.fullClient.getDynamicFieldsByPage(h)).data.map(P=>P.name.value)}catch(j){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",j)}}return[]},w=async()=>{if(t){a(!0);const h=await i(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",h),h)try{return(await x.ClmmSDK.fullClient.getDynamicFieldsByPage(h)).data.map(P=>P.name.value)}catch(j){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",j)}}return[]};return{fetchActiveOrderList:async()=>{try{const h=await g(),j=await w(),_=await x.ClmmSDK.fullClient.batchGetObjects([...h,...j],{showType:!0,showContent:!0}),P=_.filter(y=>{var U,F;return(F=(U=y.data)==null?void 0:U.type)==null?void 0:F.includes("limit_order::LimitOrder")}),D=_.filter(y=>{var U,F;return(F=(U=y.data)==null?void 0:U.type)==null?void 0:F.includes("order::Order")}),T=P.map(y=>Ct.buildLimitOrderInfo(y)).filter(y=>y!==void 0).filter(y=>y.status===Ee.PartialCompleted||y.status===Ee.Running),d=D.map(y=>{var te,oe,X,ie,se,ce,De,Be;const U=xe(((te=y.data)==null?void 0:te.type)||""),F=U.type_arguments[0],I=U.type_arguments[1];return{in_coin_type:F,out_coin_type:I,...(X=(oe=y.data)==null?void 0:oe.content)==null?void 0:X.fields,id:(De=(ce=(se=(ie=y.data)==null?void 0:ie.content)==null?void 0:se.fields)==null?void 0:ce.id)==null?void 0:De.id,version:(Be=y.data)==null?void 0:Be.version}}),C=new Set;for(const y of T)C.add(y.pay_coin_type),C.add(y.target_coin_type);for(const y of d)C.add(y.in_coin_type),C.add(y.out_coin_type);await o(Array.from(C));const k=await b(T);n(k);const{activeResult:L,pastResult:O}=await f(d);c(L),l(O),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",k),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",d),u(Array.from(C))}catch(h){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",h)}finally{r(!1),a(!1)}},resetUserData:()=>{n([]),c([]),l([])}}}function Js(){const{currentAccount:t}=H(),{clmmSdk:o}=tt(),{xCetusSdk:s}=me(),{buildFarmsPositionType:i,buildBurnPositionType:r}=Gt(),{setPosBaseList:n,setFullRangePosBaseList:a,setPosBaseListLoading:c}=ne(),{setVeNFT:l,setVeNFTLoading:u,setLockCetusList:f,clearData:x,owner:b,setLockCetusListLoading:g}=G(),{formatPosBaseList:w}=ot();return{fetchOwnerNFT:async()=>{try{if(t){c(!0),u(!0);const h=await o.fullClient.getOwnedObjectsByPage(t.address,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:z.clmm_sdk_options.clmm_pool.package_id},{StructType:i},{StructType:r},{StructType:fs},{StructType:ms}]}});let j=await w(h);n(j),c(!1),(j==null?void 0:j.length)==0&&a([]);const _=bs(h.data);if(_){if(l(_,t.address),b===t.address){const P=await js(h.data,s);console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList:",P),f(P)}}else g(!1);return{veNFT:_,posBaseList:j}}}catch(h){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",h),h instanceof TypeError&&(c(!1),n([]))}finally{c(!1),u(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{n([]),x()}}}function en(){const{currentAccount:t}=H(),{peripherySdk:o}=me(),{clmmSdk:s}=tt();ot();const{getPosPoolsOriginalObj:i,getPosPoolsRelatedData:r}=qt(),{getPosLiquidityData:n}=It(),{setPosLiquidityData:a,setFarmsPosRewardsData:c,setFarmsPosRewardsDataLoading:l,setPosRewardsData:u,setPosRewardsDataLoading:f,setPosFeeData:x,setPosFeeDataLoading:b}=ne(),{formatFarmsRewardsData:g}=Kt(),{formatPosRewardsData:w}=Yt(),{formatPosFeeData:S}=Qt(),{posBaseList:v,setShowPosListLength:h,setMyPosYieldValue:j}=ne(),{refreshCoinPriceInfo:_}=Ae(),P=async T=>{var L;const d=T.filter(O=>O.posType==="farms"&&O.farmsPool),C=await i(T);if(r(T,C),((L=Object.keys(C))==null?void 0:L.length)===0)throw a({}),new Error("No pool data found");n(T,C);const k=new wt;d.length>0&&d.forEach(O=>{o.Farms.buildCalculateFarmingReward({pool_id:O.farmsPool,position_nft_id:O.id},k)}),T.forEach(O=>{s.Rewarder.buildFetchPosFee({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB},k)}),T.filter(O=>O.posType!=="farms").forEach(O=>{const y=C[O.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:O.clmmPool,positionId:O.posId,coinTypeA:O.coinTypeA,coinTypeB:O.coinTypeB,rewarderInfo:y.rewarder_infos},k)});try{l(!0),f(!0),b(!0);const O=await s.fullClient.devInspectTransactionBlock({transactionBlock:k,sender:yt("0x0")}),y=o.Farms.parsedPosRewardData(O),U=s.Rewarder.parsedPosRewardData(O),F=s.Rewarder.parsedPosFeeData(O);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:y,clmmRewardData:U,clmmFeeData:F});const I=await g(y);c(I);const te=await w(Object.values(U).map(X=>{const ie=C[T.find(se=>se.posId===X.position_id).clmmPool];return{poolAddress:ie.pool_address,positionId:X.position_id,rewarderAmountOwed:X.rewarder_amount.map((se,ce)=>({coin_address:ie.rewarder_infos[ce].coinAddress,amount_owed:new we(se)}))}}));u(te);const oe=await S(Object.values(F).map(X=>({position_id:X.position_id,feeOwedA:new we(X.fee_owned_a),feeOwedB:new we(X.fee_owned_b)})),T);x(oe),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:oe,posRewardsData:te,posFarmsRewardsObj:I}),D(te,I)}catch(O){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",O)}finally{l(!1),f(!1),b(!1)}},D=async(T,d)=>{const C=[];if(v.length>0){v.map(L=>{C.push(xe(L==null?void 0:L.coinTypeA).full_address),C.push(xe(L==null?void 0:L.coinTypeB).full_address);const O=T[L==null?void 0:L.posId]||[],y=d[L==null?void 0:L.id]||[],U=O.concat(y);U==null||U.map(F=>{var I;_t(F==null?void 0:F.display_amount_owed).gt(0)&&C.push(xe((I=F==null?void 0:F.token)==null?void 0:I.coin_type).full_address)})});const k=Array.from(new Set(C));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",k),_(k)}};return{fetchPosRelatedData:P,resetUserData:()=>{a({}),c({}),u({}),x({})}}}function tn(){const{currentAccount:t}=H(),{setXCetusManager:o,setDividendManager:s}=G(),{xCetusSdk:i}=me();return{fetchXCetusBaseInfo:async n=>{try{const{xcetus:a,xcetus_dividends:c}=z.xcetus_sdk_options,{dividend_manager_id:l}=He(c),{xcetus_manager_id:u}=He(a),f=await i.fullClient.batchGetObjects([u,l],{showType:!0,showContent:!0}),x=f.find(g=>{var w,S;return(S=(w=g.data)==null?void 0:w.type)==null?void 0:S.includes("xcetus::XcetusManager")});if(x){const g=Me(x),w={id:g.id.id,index:Number(g.index),has_venft:{handle:g.has_venft.fields.id.id,size:g.has_venft.fields.size},nfts:{handle:g.nfts.fields.id.id,size:g.nfts.fields.size},total_locked:g.total_locked,treasury:g.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",w),o(w)}const b=f.find(g=>{var w,S;return(S=(w=g.data)==null?void 0:w.type)==null?void 0:S.includes("dividend::DividendManager")});if(b){const g=Me(b),w=et.buildDividendManager(g);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",w),i.XCetusModule.updateCache(`${l}_getDividendManager`,w),s(w)}}catch(a){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",a)}}}}function sn(t){const{currentAccount:o}=H(),{fetchCoinHoldingList:s,resetUserData:i}=at(),{fetchPosRelatedData:r,resetUserData:n}=en(),{fetchActiveOrderList:a,resetUserData:c}=Zs(),{setAutoRefreshCount:l}=q(),{fetchOwnerNFT:u,resetUserData:f}=Js(),{fetchXCetusBaseInfo:x}=tn(),{addTask:b,removeTask:g}=ws(),[w,S]=m.useState([]),v=m.useRef(o),{fetchOwnerLockCetusList:h}=Cs(),{setOrderListLoading:j}=re(),{setLockCetusListLoading:_}=G(),{setPosBaseListLoading:P}=ne(),{setIsCoinHoldingLoading:D}=Ce(),E=()=>{i(),n(),c(),f()};m.useEffect(()=>{var y,U;o?((y=v.current)!=null&&y.address&&((U=v.current)==null?void 0:U.address)!==(o==null?void 0:o.address)&&(l(!1),E(),w.forEach(F=>{g(F.id)})),L()):(E(),w.forEach(F=>{g(F.id)})),v.current=o},[o==null?void 0:o.address]);const T={id:Is,run:s},d={id:Ks,run:u,onSuccess:y=>{const{veNFT:U,posBaseList:F}=y;r(F),U&&(o!=null&&o.address)&&h(o==null?void 0:o.address)}},C={id:Qs,run:x},k={id:Ys,run:a},L=()=>{const y=[];j(!0),_(!0),P(!0),D(!0),t==="wallet"?y.push(T,d,k,C):t==="liquidity"?y.push(d,T,k,C):t==="orders"?y.push(k,T,d,C):y.push(d,C,T,k),S(y),y.forEach(U=>{b(U)})};return{refreshTask:()=>{o&&(w.forEach(y=>{g(y.id)}),L())}}}const pe=t=>t?fe(t,2):"$--",nn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),B(0)).toString();function ao(){const{tab:t}=ns(),{currentAccount:o,onWalletModal:s}=H(),i=Ye(),{posBaseListLoading:r,posLiquidityDataLoading:n}=ne(),{holdingsTotalUsd:a,isCoinPriceLoading:c,isCoinHoldingLoading:l}=Ce(),{clmmTotalTvl:u}=ts(),{orderTotalTvl:f}=Gs(),{orderListLoading:x}=re(),{isAutoRefresh:b,dcaOrderListLoading:g,setAutoRefreshCount:w,resetAutoRefreshCount:S}=q(),{xCetusTotalTvl:v}=qs(),{lockCetusListLoading:h,veNFTLoading:j,veNFT:_}=G(),P=m.useMemo(()=>t||"wallet",[t]),{refreshTask:D}=sn(P),E=!b&&(l||c),T=!b&&(r||n),d=!b&&(x||g),C=!b&&(h||j),k=m.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",a,u,f,v),{wallet:{totalValue:pe(a),isLoading:E},liquidity:{totalValue:pe(u),isLoading:T},orders:{totalValue:pe(f),isLoading:d},xCetus:{totalValue:pe(v),isLoading:C}}),[a,u,f,v,E,T,d,C]),L=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png"},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png"},{title:"Active Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png"}],O=m.useMemo(()=>nn(v,u,f,a),[v,u,f,a]);return m.useEffect(()=>S(!1),[]),e.jsx(A,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:o!=null&&o.address?e.jsxs(A,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Rs,{handleRefresh:y=>{w(!y),D()},totalValue:O,isLoading:!b&&(j||r||x||g)}),e.jsx(on,{tabList:L,activeTab:P,tabData:k,onClickTab:y=>i(`/profile?tab=${y}`)}),P==="wallet"&&e.jsx(Fs,{}),P==="liquidity"&&e.jsx(Os,{}),P==="orders"&&e.jsx(Ls,{}),P==="xCetus"&&e.jsx(Ns,{})]}):e.jsx(ee,{type:"nowallet",mt:"20px",onboard:()=>s(!0)})})}function on({tabList:t,activeTab:o,tabData:s,onClickTab:i}){return e.jsx(R,{w:"100%",mt:"10px",children:t.map(r=>{var n,a;return e.jsxs(V,{w:"25%",p:"24px 16px",h:"94px",bgImage:o===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",onClick:()=>i(r.value),children:[e.jsxs(A,{align:"flex-start",gap:"12px",children:[e.jsx(p,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(R,{h:"22px",children:e.jsx(J,{isLoaded:!((n=s[r.value])!=null&&n.isLoading),children:e.jsx(p,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(a=s[r.value])==null?void 0:a.totalValue})})})]}),e.jsx(gt,{w:"48px",h:"48px",src:r.activeImgUrl,display:o===r.value?"block":"none"})]},r.value)})})}export{ao as default};
//# sourceMappingURL=Profile-zrOkSVxf.js.map

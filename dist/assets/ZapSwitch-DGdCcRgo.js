import{a as g,j as o,V as ne,v as Ue,f as ve,H,T as U,u as je,S as st,ar as Ge,P as nt,h as ot,m as rt,n as it}from"./vendor-DXHkIl66.js";import{u as Ee}from"./global-BdG6Ba89.js";import{an as at,az as Le,aG as ct,R as Xe,j as Fe,k as Ke,n as We,d as E,X as Je,r as $e,ap as De,y as fe,a4 as Te,q as ce,a as Qe,aH as Ye,I as ke,f as qe,c as lt,P as ut,aa as ze,aI as Pe,V as dt,a0 as Ze,i as pt,aJ as mt,B as xt}from"./index-z4pUiXVL.js";import{v as Me}from"./v4-C6aID195.js";import{D as ft}from"./DepositRatio-9OTevO03.js";import{F as gt}from"./FreshProgressV2-CBk2xMvX.js";import{u as ht,M as bt}from"./usePriceImpact-CZnhsTFC.js";import{d as yt,c as At,e as _t}from"./useGetPoolList-DZOzZEqD.js";import{E as Ne}from"./ErrorTips-DduTlMG8.js";import{S as wt}from"./Slippage-u5yjQ90x.js";import{b as Oe,u as St}from"./useNotifiSubscription-DEm03jwr.js";import{a as jt}from"./usePositionList-B_ysosd0.js";import{u as et}from"./index-BEL1GW0X.js";import{u as Rt}from"./useToken-AKkGKeik.js";import{u as Tt}from"./useTokenBalance-HeugYKlV.js";var vt=/\s/;function kt(t){for(var s=t.length;s--&&vt.test(t.charAt(s)););return s}var Zt=/^\s+/;function Bt(t){return t&&t.slice(0,kt(t)+1).replace(Zt,"")}var Ve=NaN,Lt=/^[-+]0x[0-9a-f]+$/i,Et=/^0b[01]+$/i,Ft=/^0o[0-7]+$/i,Wt=parseInt;function Ie(t){if(typeof t=="number")return t;if(at(t))return Ve;if(Le(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=Le(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=Bt(t);var e=Et.test(t);return e||Ft.test(t)?Wt(t.slice(2),e?2:8):Lt.test(t)?Ve:+t}var Be=function(){return ct.Date.now()},Ct="Expected a function",$t=Math.max,Dt=Math.min;function qt(t,s,e){var p,l,x,a,n,A,_=0,$=!1,F=!1,S=!0;if(typeof t!="function")throw new TypeError(Ct);s=Ie(s)||0,Le(e)&&($=!!e.leading,F="maxWait"in e,x=F?$t(Ie(e.maxWait)||0,s):x,S="trailing"in e?!!e.trailing:S);function h(u){var V=p,q=l;return p=l=void 0,_=u,a=t.apply(q,V),a}function m(u){return _=u,n=setTimeout(k,s),$?h(u):a}function f(u){var V=u-A,q=u-_,ee=s-V;return F?Dt(ee,x-q):ee}function i(u){var V=u-A,q=u-_;return A===void 0||V>=s||V<0||F&&q>=x}function k(){var u=Be();if(i(u))return N(u);n=setTimeout(k,f(u))}function N(u){return n=void 0,S&&p?h(u):(p=l=void 0,a)}function j(){n!==void 0&&clearTimeout(n),_=0,p=A=l=n=void 0}function O(){return n===void 0?a:N(Be())}function Y(){var u=Be(),V=i(u);if(p=arguments,l=this,A=u,V){if(n===void 0)return m(A);if(F)return clearTimeout(n),n=setTimeout(k,s),h(A)}return n===void 0&&(n=setTimeout(k,s)),a}return Y.cancel=j,Y.flush=O,Y}const Mt=(t,s)=>({fromAmount:"",setFromAmount:e=>{t(()=>({fromAmount:e}))},fromAmountValue:"",setFromAmountValue:e=>{t(()=>({fromAmountValue:e}))},toAmount:"",setToAmount:e=>{t(()=>({toAmount:e}))},toAmountValue:"",setToAmountValue:e=>{t(()=>({toAmountValue:e}))},liquidityAmount:"",setLiquidityAmount:e=>{t(()=>({liquidityAmount:e}))},tokenMaxA:"",setTokenMaxA:e=>{t(()=>({tokenMaxA:e}))},tokenMaxB:"",setTokenMaxB:e=>{t(()=>({tokenMaxB:e}))},byAmountIn:!0,setByAmountIn:e=>{t(()=>({byAmountIn:e}))},isTokenA:!0,setIsTokenA:e=>{t(()=>({isTokenA:e}))},percentMap:{percentA:"0",percentB:"0"},setPercentMap:e=>{t(()=>({percentMap:e}))},isFullRange:!1,setIsFullRange:e=>{t(()=>({isFullRange:e}))},fromToken:void 0,setFromToken:e=>{t(()=>({fromToken:e}))},fromTokenLock:!1,setFromTokenLock:e=>{t(()=>({fromTokenLock:e}))},toToken:void 0,setToToken:e=>{t(()=>({toToken:e}))},toTokenLock:!1,setToTokenLock:e=>{t(()=>({toTokenLock:e}))},totalAmount:void 0,setTotalAmount:e=>{t(()=>({totalAmount:e}))},autoStakePosition:!1,setAutoStakePosition:e=>{t(()=>({autoStakePosition:e}))},isFarmRewardsRange:!1,setIsFarmRewardsRange:e=>{t(()=>({isFarmRewardsRange:e}))},useZapIn:!1,setUseZapIn:e=>{t(()=>({useZapIn:e}))},confirmModalOpen:!1,setConfirmModalOpen:e=>{t(()=>({confirmModalOpen:e}))},nftOpen:!1,setNftOpen:e=>{t(()=>({nftOpen:e}))},relatedPosId:"",setRelatedPosId:e=>{t(()=>({relatedPosId:e}))},resetAddLiquidity:()=>{t(()=>({isFarmRewardsRange:!1,autoStakePosition:!1,totalAmount:void 0,fromTokenLock:!1,fromToken:void 0,toTokenLock:!1,toToken:void 0,isFullRange:!1,percentMap:{percentA:"0",percentB:"0"},fromAmount:"",toAmount:"",fromAmountValue:"",toAmountValue:"",liquidityAmount:"",byAmountIn:!0,isTokenA:!0,useZapIn:!1,nftOpen:!1,relatedPosId:""}))}}),tt=Xe(Mt),Nt=(t,s)=>({currentTokens:[],setCurrentTokens:e=>{t(()=>({currentTokens:e}))},zapAmount:"",setZapAmount:e=>{t(()=>({zapAmount:e}))},currentZapToken:void 0,setCurrentZapToken:e=>{t(()=>({currentZapToken:e}))},zapAmountRate:"",setZapAmountRate:e=>{t(()=>({zapAmountRate:e}))},zapTokenBalance:void 0,setZapTokenBalance:e=>{t(()=>({zapTokenBalance:e}))},isPreLoading:!1,setIsPreLoading:e=>{t(()=>({isPreLoading:e}))},preDepositeData:void 0,setPreDepositeData:e=>{t(()=>({preDepositeData:e,isPreLoading:!1}))},zapApiPool:void 0,setZapApiPool:e=>{t(()=>({zapApiPool:e}))},lower:0,setLower:e=>{t(()=>({lower:e}))},upper:0,setUpper:e=>{t(()=>({upper:e}))},liquidity:"",setLiquidity:e=>{t(()=>({liquidity:e}))},zapCurrPriceData:{},setZapCurrPriceData:e=>{t(()=>({zapCurrPriceData:e}))},zapSlideValue:0,setZapSlideValue:e=>{t(()=>({zapSlideValue:Number(e==="--"?0:e)}))},posOriginAmounts:{},setPosOriginAmounts:e=>{t(()=>({posOriginAmounts:e}))},resetZapData:()=>{t(()=>({zapAmount:"",zapAmountRate:"",lower:0,upper:0,preDepositeData:void 0,isPreLoading:!1,liquidity:"",zapSlideValue:0,posOriginAmounts:{}}))}}),Ce=Xe(Nt);function Ot(t="Deposit"){var be,ye;const{zapAmount:s,currentZapToken:e,zapAmountRate:p,zapTokenBalance:l,isPreLoading:x,preDepositeData:a,zapApiPool:n,setIsPreLoading:A,lower:_,upper:$,liquidity:F,zapCurrPriceData:S,setPreDepositeData:h,zapSlideValue:m}=Ce();console.log("ðŸš€ ~ useZapSubmit ~ zapCurrPriceData:",S);const{currentAccount:f,onWalletModal:i}=Fe(),{setConfirmModalOpen:k}=tt(),{zapSdk:N}=Ke(),{zapSlippage:j,slippage:O}=Ee(),[Y,u]=g.useState(""),[V,q]=g.useState(!1),{getTokenPrice:ee}=We(),G=ee((be=n==null?void 0:n.tokenA)==null?void 0:be.coin_type),b=ee((ye=n==null?void 0:n.tokenB)==null?void 0:ye.coin_type),ge=g.useMemo(()=>{if(G&&b)return E(G.price).div(b.price).toString()},[G==null?void 0:G.price,b==null?void 0:b.price]),he=g.useMemo(()=>{const c={text:t==="Withdraw"?"Zap Out":"Zap In",disabled:!1};return f!=null&&f.address?!s||s&&!+s?(c.text="Enter an amount",c.disabled=!0,c):E(s).gt((l==null?void 0:l.balanceFormat)||0)?(c.disabled=!0,c.text=`Insufficient ${Je(l==null?void 0:l.symbol,10)} Balance`,c):((E(p).gt(1e4)||E(p).gt(0)&&E(p).lt(1e-4))&&(c.disabled=!0),c):(c.text="Connect Wallet",c.disabled=!1,c)},[f==null?void 0:f.address,s,e==null?void 0:e.coin_type,x,t,l==null?void 0:l.balanceFormat]),te=qt(()=>{f?k(!0):i(!0)},300,{leading:!0,trailing:!1}),W=()=>{const c=a==null?void 0:a.amount_a,d=a==null?void 0:a.amount_b,r=n==null?void 0:n.tokenA,y=n==null?void 0:n.tokenB,X=n==null?void 0:n.displayTokenA,I=n==null?void 0:n.displayTokenB,C=ce(n!=null&&n.isReverse?d:c,n!=null&&n.isReverse?y==null?void 0:y.decimals:r==null?void 0:r.decimals),M=ce(n!=null&&n.isReverse?c:d,n!=null&&n.isReverse?r==null?void 0:r.decimals:y==null?void 0:y.decimals);return{amountA:c,amountB:d,tokenA:r,tokenB:y,displayTokenA:X,displayTokenB:I,dispalyAmountA:C,dispalyAmountB:M}},oe=()=>{const{displayTokenA:c,displayTokenB:d,dispalyAmountA:r,dispalyAmountB:y}=W();return{getShowInfo:(I,C)=>{const M=!r&&!y?`Add ${r} ${c==null?void 0:c.symbol} and ${y} ${d==null?void 0:d.symbol}`:r?y?"Add Liquidity":`Add ${y} ${d==null?void 0:d.symbol}`:`Add ${r} ${c==null?void 0:c.symbol}`,D={modalDescriptionText:M,toastTitleText:M};if(I==="success"){let Q=r,K=y;C&&(Q=Te(C,c)||r,K=Te(C,d)||y);const P=!r&&!y?`Add ${Q} ${c==null?void 0:c.symbol} and ${K} ${d==null?void 0:d.symbol}`:!r&&y?`Add ${Q} ${c==null?void 0:c.symbol}`:!y&&r?`Add ${K} ${d==null?void 0:d.symbol}`:"Add Liquidity";D.toastDescriptionContent=P,D.modalDescriptionText=P,D.toastTitleText="Supplied Successful"}return D}}},Z=async(c,d,r,y)=>{console.log("ðŸš€ ~ getZapDepositTx ~ isFarm:",r);const{tokenA:X,tokenB:I}=W(),C={deposit_obj:a,pool_id:n==null?void 0:n.poolAddress,coin_type_a:X==null?void 0:X.coin_type,coin_type_b:I==null?void 0:I.coin_type,tick_lower:c,tick_upper:d,slippage:Number(O),swap_slippage:Number(j)};y&&(C.pos_obj=y),r&&(C.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("getZapTx buildDepositPayload params: ",C);const M=await N.Zap.buildDepositPayload(C);return console.log("ðŸš€ ~ getZapTx ~ tx:",M),M},T=(c,d)=>{const{displayTokenA:r,displayTokenB:y,dispalyAmountA:X,dispalyAmountB:I}=W();return{getShowInfo:(M,D)=>{const Q=`Withdraw ${fe(s,e==null?void 0:e.decimals)} ${e==null?void 0:e.symbol}`,K={modalDescriptionText:Q,toastTitleText:Q};return M==="success"&&(D&&(Te(D,r),Te(D,y)),K.toastDescriptionContent="",K.modalDescriptionText="",K.toastTitleText="Remove Liquidity Successful"),K}}},le=async(c,d,r,y,X,I)=>{console.log("ðŸš€ ~ getZapWithdrawTx ~ isFarm:",I),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx preDepositeData:",a);const{tokenA:C,tokenB:M}=W(),D={withdraw_obj:a,pool_id:n==null?void 0:n.poolAddress,pos_id:c,close_pos:(a==null?void 0:a.burn_liquidity)===d,collect_fee:!0,collect_rewarder_types:X,coin_type_a:C==null?void 0:C.coin_type,coin_type_b:M==null?void 0:M.coin_type,tick_lower:r,tick_upper:y,slippage:Number(O),swap_slippage:Number(j)};return I&&(D.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx params:",D),await N.Zap.buildWithdrawPayload(D)},z=g.useRef({}),ue=g.useRef(null),J=g.useRef("");g.useEffect(()=>{z.current={currentZapToken:e,zapApiPool:n,zapAmount:s,currentSqrtPrice:S==null?void 0:S.currentSqrtPrice,lower:_,upper:$,liquidity:F,zapSlippage:j,zapAmountRate:p,marketPrice:ge}},[e==null?void 0:e.coin_type,n==null?void 0:n.poolAddress,s,S==null?void 0:S.currentSqrtPrice,_,$,F,j,p,ge]);const de=g.useMemo(()=>!!(e!=null&&e.decimals&&E(s).mul(Math.pow(10,e==null?void 0:e.decimals)).eq(1)),[e==null?void 0:e.decimals,s]),L=async c=>{var w,B,R,v,xe;console.log("ðŸš€ ~ preZapIn ~ preZapIn:",L);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:I,upper:C,liquidity:M,zapSlippage:D,marketPrice:Q}=z.current;A(!0);const P=(d==null?void 0:d.coin_type)===((w=r==null?void 0:r.tokenA)==null?void 0:w.coin_type)?"OnlyCoinA":"OnlyCoinB",pe=De(E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString(),0);console.log("ðŸš€ ~ preZapIn ~ options.zapSlippage:",O,D);const me={pool_id:r==null?void 0:r.poolAddress,tick_lower:I,tick_upper:C,current_sqrt_price:X,slippage:Number(O),swap_slippage:Number(D),mark_price:Q};console.log("ðŸš€ ~ preZapIn ~ options123:",me);const ae={mode:P,coin_amount:pe,coin_type_a:(B=r==null?void 0:r.tokenA)==null?void 0:B.coin_type,coin_type_b:(R=r==null?void 0:r.tokenB)==null?void 0:R.coin_type,coin_decimal_a:(v=r==null?void 0:r.tokenA)==null?void 0:v.decimals,coin_decimal_b:(xe=r==null?void 0:r.tokenB)==null?void 0:xe.decimals,max_remain_rate:.01};console.log("ðŸš€ ~ preZapIn ~ modeOptions:",ae);let se;try{se=await N.Zap.preCalculateDepositAmount(me,ae),console.log("ðŸš€ ~ preZapIn ~ res:",se)}catch(Ae){console.log("ðŸš€ ~ preZapIn ~ error:",Ae),q(!0)}c===J.current&&h(se),A(!1)},re=async c=>{var me,ae,se,w,B;A(!0);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:I,upper:C,liquidity:M,zapSlippage:D}=z.current,K=(d==null?void 0:d.coin_type)===((me=r==null?void 0:r.tokenA)==null?void 0:me.coin_type)?"OnlyCoinA":"OnlyCoinB";E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString();const P={mode:K,pool_id:r==null?void 0:r.poolAddress,tick_lower:I,tick_upper:C,current_sqrt_price:X,coin_type_a:(ae=r==null?void 0:r.tokenA)==null?void 0:ae.coin_type,coin_type_b:(se=r==null?void 0:r.tokenB)==null?void 0:se.coin_type,coin_decimal_a:(w=r==null?void 0:r.tokenA)==null?void 0:w.decimals,coin_decimal_b:(B=r==null?void 0:r.tokenB)==null?void 0:B.decimals};E(y).gte(l==null?void 0:l.balanceFormat)?P.burn_liquidity=M:P.burn_liquidity=De(E(M).mul(E(m).div(100)).toString(),0),console.log("ðŸš€ ~ preZapInRemove ~ options:",P);let pe;try{pe=await N.Zap.preCalculateWithdrawAmount(P),console.log("ðŸš€ ~ preZapInRemove ~ res:",pe)}catch(R){console.log("ðŸš€ ~ preZapOut ~ error:",R),q(!0)}c===J.current&&h(pe),A(!1)},we=$e(L,300),Se=$e(re,300);g.useEffect(()=>{Re()},[s,e==null?void 0:e.coin_type,S==null?void 0:S.currentSqrtPrice,_,$,m,p]);const ie=()=>{var c;(c=ue.current)==null||c.reset()},Re=()=>{q(!1);const{zapAmount:c,zapAmountRate:d}=z.current;if(console.log("ðŸš€ ~ reCalculateZapData ~ zapAmount:",c),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),!Number(c)||E(d).gt(1e4)||E(d).lt(1e-4)||de){const y=Me();J.current=y,h(void 0),A(!1);return}A(!0);const r=Me();J.current=r,t=="Deposit"?we(r):Se(r)};return g.useEffect(()=>{ie()},[s,n==null?void 0:n.poolAddress,t]),g.useEffect(()=>()=>{ie(),z.current=null},[]),{btnText:he.text,btnDisabled:he.disabled,handleZapIn:te,isPreLoading:x,getZapDepositToastInfo:oe,getZapDepositTx:Z,getZapWithdrawToastInfo:T,getZapWithdrawTx:le,zapProgressRef:ue,handleResetZapProgress:ie,reCalculateZapData:Re,isMinimumPrecision:de,zapNotAvailable:V}}function as({action:t,onClick:s,hideAmountInfo:e,otherLoading:p,isReverse:l,inConfirmModal:x,hideDepositRatio:a}){const{currentAccount:n,onWalletModal:A}=Fe(),{btnDisabled:_,btnText:$,handleZapIn:F,zapProgressRef:S,reCalculateZapData:h,isMinimumPrecision:m,zapNotAvailable:f}=Ot(t),i=()=>{if(!n){A(!0);return}s?s():F()},[k,N]=g.useState(!1),{zapSlippage:j}=Ee(),{getTokenAmountValue:O}=We(),{zapSlideValue:Y,preDepositeData:u,currentTokens:V,currentZapToken:q,zapAmount:ee,isPreLoading:G,zapApiPool:b,lower:ge,upper:he,zapCurrPriceData:te,posOriginAmounts:W,zapAmountRate:oe}=Ce(),{fromCoin:Z,toCoin:T}=g.useMemo(()=>{var R;const w=q,B=(R=V==null?void 0:V.filter(v=>(v==null?void 0:v.coin_type)!==(q==null?void 0:q.coin_type)))==null?void 0:R[0];return t==="Withdraw"?{fromCoin:B,toCoin:w}:{fromCoin:w,toCoin:B}},[q==null?void 0:q.coin_type,V,t]),{fromAmount:le,toAmount:z}=g.useMemo(()=>{var R,v;let w,B;return u&&(Z!=null&&Z.coin_type)&&(T!=null&&T.coin_type)&&(w=ce((R=u==null?void 0:u.swap_result)==null?void 0:R.swap_in_amount,Z==null?void 0:Z.decimals),B=ce((v=u==null?void 0:u.swap_result)==null?void 0:v.swap_out_amount,T==null?void 0:T.decimals)),{fromAmount:w,toAmount:B}},[u,Z==null?void 0:Z.coin_type,T==null?void 0:T.coin_type]),{sources:ue,priceImpactTextInfo:J,showPriceImpactTips:de}=ht(Z,T,le,z),[L,re]=g.useState(!1),we=()=>{re(!L)},Se=g.useMemo(()=>z?fe(E(z).sub(E(z).mul(j)).toString()):"--",[j,z]),ie=g.useMemo(()=>{var w;return(w=u==null?void 0:u.swap_result)==null?void 0:w.swap_price},[u]),Re=()=>{console.log("ZapRoute handleRefresh"),h()},{tokenA:be,tokenB:ye,coinAmountA:c,coinAmountB:d,displayCoinAmountA:r,displayCoinAmountB:y,displayTokenA:X,displayTokenB:I,displayAmountARate:C,displayAmountBRate:M,amountARate:D,amountBRate:Q}=g.useMemo(()=>{let w,B,R,v,xe,Ae;const _e=b==null?void 0:b.isReverse;return u&&(b!=null&&b.poolAddress)&&(R=b==null?void 0:b.tokenA,v=b==null?void 0:b.tokenB,w=ce(u==null?void 0:u.amount_a,R==null?void 0:R.decimals),B=ce(u==null?void 0:u.amount_b,v==null?void 0:v.decimals),xe=O(R==null?void 0:R.coin_type,w),Ae=O(v==null?void 0:v.coin_type,B)),{displayCoinAmountA:_e?B:w,displayCoinAmountB:_e?w:B,displayTokenA:_e?v:R,displayTokenB:_e?R:v,displayAmountARate:_e?Ae:xe,displayAmountBRate:_e?xe:Ae,tokenA:R,tokenB:v,coinAmountA:w,coinAmountB:B,amountARate:xe,amountBRate:Ae}},[u,b==null?void 0:b.poolAddress]),{originPosAmountA:K,originPosAmountB:P}=g.useMemo(()=>{let w="",B="";if(b!=null&&b.poolAddress&&(W!=null&&W.coinAmountA||W!=null&&W.coinAmountB)){const R=b==null?void 0:b.tokenA,v=b==null?void 0:b.tokenB;w=ce(W==null?void 0:W.coinAmountA,R==null?void 0:R.decimals),B=ce(W==null?void 0:W.coinAmountB,v==null?void 0:v.decimals)}return{originPosAmountA:w,originPosAmountB:B}},[W,b==null?void 0:b.poolAddress]),[pe,me]=g.useState({});g.useEffect(()=>{if(c||d){const w=yt(ge,he),B=At(c||0,d||0,te==null?void 0:te.currentPrice,w);me(B)}},[c,d,te==null?void 0:te.currentPrice]);const{isApp:ae}=Qe(),se=g.useMemo(()=>E(oe).gt(1e4)?"In Zap mode, each request should be within $10,000.":E(oe).gt(0)&&(E(oe).lt(1e-4)||m)?"The input is too small. Zap mode is not available.":f?"Zap mode is not available.":"",[oe,t,m,f]);return o.jsx(o.Fragment,{children:o.jsxs(ne,{gap:"0px",w:"100%",borderRadius:"16px",border:"1px solid",borderColor:x?"rgba(0,0,0,0)":"border",bg:x?"none":"bg_six",p:{base:x?"0px":"0px 8px",lg:x?"0px":"0px 16px"},children:[!x&&o.jsx(Ue,{w:{base:"calc(100% + 16px)",lg:"calc(100% + 34px)"},h:"52px",margin:"-1px -1px 0px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:(G||_||p||de||!!se)&&(n==null?void 0:n.address),isLoading:G||p,onClick:i,children:$}),!!Number(ee)&&o.jsx(ne,{w:"100%",gap:"0px",children:se?o.jsx(ve,{w:"100%",p:"12px 0px",children:o.jsx(Ne,{tips:se})}):o.jsxs(o.Fragment,{children:[de&&o.jsx(ve,{w:"100%",pt:"12px",children:o.jsx(Ne,{tips:"High price difference. Be cautious before submitting your order."})}),x&&o.jsxs(H,{w:"100%",justify:"space-between",children:[o.jsx(U,{fontSize:"14px",color:"text_paragraph",children:"Zap Amount"}),o.jsx(U,{fontSize:"14px",color:"text_caption",children:Ye(oe,2)})]}),Number(ee)>0&&Number(le)>0&&o.jsxs(ne,{w:"100%",gap:"12px",pt:"16px",pb:x?"0px":"16px",children:[o.jsx(H,{w:"100%",justify:"space-between",children:o.jsx(U,{fontSize:"14px",color:"text_paragraph",children:"Zap Route"})}),o.jsxs(ne,{w:"100%",bg:x?"bg_secondary":"none",borderRadius:"12px",p:x?"0px 12px":"0px",gap:x?"4px":"12px",border:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",flexDirection:t==="Withdraw"?"column-reverse":"column",children:[o.jsxs(ne,{w:"100%",align:"flex-start",bg:x?"none":"button_outline_hov_bg",p:x?"16px 0px":"16px 12px",borderRadius:x?"0px":"12px",borderBottom:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",children:[o.jsx(H,{w:"100%",align:"center",children:o.jsxs(ne,{w:"100%",align:"flex-start",onClick:()=>{N(!k)},children:[o.jsx(H,{w:"100%",justify:"flex-start",children:G?o.jsx(je,{w:"100%",h:"16px"}):o.jsxs(U,{w:"100%",fontSize:"12px",color:"text_caption",textAlign:"left",children:["Swap ",fe(le)," ",Z==null?void 0:Z.symbol," for ",Se," ",T==null?void 0:T.symbol]})}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(H,{w:"100%",justify:"space-between",align:{base:"flex-start",lg:"center"},flexDirection:{base:"column",lg:"row"},children:[o.jsxs(H,{gap:"4px",justify:"space-between",w:{base:"100%",lg:"unset"},children:[o.jsxs(H,{gap:"4px",children:[o.jsx(gt,{callbackInterval:20,ref:S,min:0,max:20,size:"14px",noBg:!0,thickness:"16px",onClick:Re}),o.jsxs(H,{flexWrap:"wrap",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Price Difference"}),o.jsx(U,{color:J==null?void 0:J.textColor,fontSize:"12px",children:J==null?void 0:J.priceImpactText}),ue==null?void 0:ue.map(w=>o.jsx(bt,{market:w},w))]})]}),ae&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:k?"rotate(180deg)":"rotate(0deg)"})]}),o.jsxs(H,{align:"center",gap:"2px",children:[x?o.jsxs(H,{gap:"4px",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Slippage"}),o.jsxs(U,{fontSize:"12px",color:"text_caption",children:[E(j).mul(100).toString(),"%"]})]}):o.jsx(wt,{slippageType:"zap",toolTipText:"Slippage Tolerance"}),!ae&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:k?"rotate(180deg)":"rotate(0deg)"})]})]})]})}),k&&o.jsxs(H,{w:"100%",justify:"space-between",bg:"bg_fifth",h:"52px",borderRadius:"12px",p:"0px 8px",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Swap Rate"}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(H,{children:[L?o.jsxs(U,{fontSize:"12px",color:"text_caption",children:["1 ",T==null?void 0:T.symbol," = ",qe(1/ie)," ",Z==null?void 0:Z.symbol]}):o.jsxs(U,{fontSize:"12px",color:"text_caption",children:["1 ",Z==null?void 0:Z.symbol," = ",qe(ie)," ",T==null?void 0:T.symbol]}),o.jsx(ke,{xlinkHref:"#icon-icon_swap1",svgW:"16px",svgH:"16px",onClick:we})]})]})]}),o.jsxs(ne,{w:"100%",p:x?"16px 0px":"16px 12px",bg:x?"none":"button_outline_hov_bg",borderRadius:"12px",gap:"12px",children:[a?o.jsx(U,{w:"100%",textAlign:"left",fontSize:"12px",color:"text_caption",children:t==="Withdraw"?"Expected Amounts of Remove":"Expected Amounts to Add"}):o.jsx(ft,{tokenA:be,tokenB:ye,percentMap:pe,type:"zap",isLoading:G,isReverse:l,label:"Expected Amounts to Add"}),o.jsxs(H,{bg:"text_highlight_opacity.10",w:"100%",h:"52px",justify:"space-between",align:"center",borderRadius:"12px",children:[o.jsx(He,{token:l?ye:be,amount:l?fe(Y==100?P:d):fe(Y==100?K:c),rate:l?Q:D,loading:G}),o.jsx(ve,{bg:"bg_fifth",w:"1px",h:"100%"}),o.jsx(He,{token:l?be:ye,amount:l?fe(Y==100?K:c):fe(Y==100?P:d),loading:G,rate:l?D:Q,align:"right"})]})]})]})]})]})})]})})}function He({token:t,amount:s,rate:e,loading:p,align:l="left"}){return o.jsxs(H,{flex:"1",gap:"8px",p:"12px",justify:"flex-start",flexDirection:l==="left"?"row":"row-reverse",children:[p?o.jsx(st,{size:"20px"}):o.jsx(lt,{imageUrl:t==null?void 0:t.logo_url,w:"20px",h:"20px"}),o.jsxs(ne,{align:`flex-${l==="left"?"start":"end"}`,gap:"4px",children:[p?o.jsx(je,{w:"50px",h:"14px"}):o.jsxs(U,{fontSize:"12px",color:"text_caption",textAlign:`${l==="left"?"left":"right"}`,children:[s," ",Je(t==null?void 0:t.symbol,10)]}),p?o.jsx(je,{w:{base:"70px",lg:"100px"},h:"12px"}):o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:Ye(e,2)})]})]})}const Vt="/assets/bg_alerts@2x-BsIoiXpE.png";function cs({subscriptionSource:t,title:s="Range Alerts",description:e="Receive alerts via Telegram, SMS, or email when this position goes out of range.",wrapStyle:p={}}){const{getPositionNotifiStatus:l}=Oe(),{isChecked:x,setIsChecked:a,notifiAuthenticated:n,notifiSourceGroups:A,setIsShowNotifi:_,notifiSubscriptionLoading:$,notifiStatus:F,notifiSources:S}=ut(),{currentAccount:h}=Fe(),{notifiUnSubscription:m,notifiSubscription:f}=St(),{currentPosBaseInfo:i}=jt();console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:29 ~ currentPosBaseInfo:",i),g.useEffect(()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: RangeAlerts.tsx:42 ~ notifiSubscriptionLoading:",$),h!=null&&h.address&&t=="PositionDetail"&&i&&F=="authenticated"&&!$){const{isSubscription:j}=l(i.posId,String(i.index));a(j)}},[h,t,i,n,A,$,S]);const{createNotifiSubscriptionVerify:k}=Oe(),N=async j=>{if(a(j),console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:46 ~ changeSwitch ~ checked:",j),j){const O=await k();if(console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:49 ~ changeSwitch ~ canSubscription:",O),!O)return a(!1),!1}if(t=="AddLiquidity")a(j);else if(t=="PositionDetail")if(console.log("ðŸš€ðŸš€ðŸš€ ~ changeSwitch ~ checked:",j),j){const O={subscriptionSource:"PositionDetail",position:i==null?void 0:i.posId,pool:i==null?void 0:i.clmmPool,posIndex:String(i==null?void 0:i.index)};f(O)}else m(i==null?void 0:i.posId,i==null?void 0:i.clmmPool,i==null?void 0:i.index)};return g.useEffect(()=>()=>{a(!1)},[]),o.jsx(H,{w:"100%",bgImage:Vt,bgSize:"100% 100%",p:"16px",borderRadius:"8px",...p,children:o.jsxs(ne,{w:"100%",gap:"8px",children:[o.jsxs(H,{w:"100%",justify:"space-between",children:[o.jsx(U,{color:"primary",children:s}),F=="authenticated"?o.jsx(Ge,{isChecked:x,disabled:$,onChange:j=>N(j.target.checked)}):o.jsx(Ue,{w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",onClick:()=>_(!0),children:"Set up"})]}),o.jsx(U,{color:"primary_gray",lineHeight:"20px",textAlign:"left",children:e})]})})}function It(){const{setCurrentPriceData:t}=et();return{getCurrentPrice:(e,p)=>{if(p.tokenA&&p.tokenB){const l=p.tokenA.decimals,x=p.tokenB.decimals,a=ze.sqrtPriceX64ToPrice(new Pe(e),l,x).toString(),n=E(1).div(a).toString(),A={currentPrice:a,reverseCurrentPrice:n,currentSqrtPrice:e,pool:p.poolAddress};t(A)}}}}function ls(){const{clmmSdk:t}=dt(),{getTokenListInfo:s}=Rt(),{contractPoolInfo:e,setContractPoolInfo:p,setContractPoolInfoLoading:l,apiPoolInfo:x,setApiPoolInfo:a,setApiPoolInfoLoading:n}=et(),{setFromToken:A,setToToken:_}=tt(),{getCurrentPrice:$}=It(),F=async h=>{l(!0);let m=null;try{if(m=await t.Pool.getPool(h),console.log(h,m,"poolAddress"),console.log("ðŸš€ ~ getContractPoolInfo ~ poolInfo:",{poolInfo:m,apiPoolInfo:x}),(x==null?void 0:x.displayTokenA)===void 0){const f=await S(m);f&&(a(f),n(!1),$(m==null?void 0:m.current_sqrt_price,f),A(f==null?void 0:f.displayTokenA),_(f==null?void 0:f.displayTokenB))}}catch(f){console.log("getContractPoolInfo ~ error:",f)}finally{l(!1)}return e?m?(p(m),m):e:(p(m||null),m)};async function S(h){const m=[h.coinTypeA,h.coinTypeB].filter(Boolean),f=await s(m),i=f==null?void 0:f.get(h.coinTypeA),k=f==null?void 0:f.get(h.coinTypeB);if(i&&k){const N=`${i==null?void 0:i.symbol} - ${k==null?void 0:k.symbol}`,j=Ze(h.fee_rate).div(100).toString(),O=Ze(h.fee_rate).div(1e4).toString(),Y=Ze(j).div(100).toString()+"%",u=!_t(h.coinTypeA,h.coinTypeB);return{poolAddress:h.poolAddress,name:N,isReverse:u,tokenA:i,tokenB:k,displayTokenA:u?k:i,displayTokenB:u?i:k,haveMining:!1,miningRewardList:null,miningAprList:null,haveFarming:!1,farmsRewarderList:null,farmsApr:"",farmingAprDisplay:"",feeApr:"",feeAprDisplay:"",miningAprTotal:"",feeAndMiningAprDisplay:"",totalAprDisplay:"",fee:O,feeRate:j,feeDisplay:Y,tvlDisplay:"0",volume24Display:"0",fees24Display:"0",isVaults:!1,tickSpacing:h.tickSpacing.toString()}}}return{getContractPoolInfo:F}}function Ht({tokens:t,current:s,onSelect:e}){const p=g.useMemo(()=>t==null?void 0:t.map(a=>({label:a==null?void 0:a.symbol,value:a==null?void 0:a.coin_type})),[t]),l=g.useMemo(()=>{var a;return(a=p==null?void 0:p.filter(n=>(n==null?void 0:n.value)===(s==null?void 0:s.coin_type)))==null?void 0:a[0]},[p,s==null?void 0:s.coin_type]),x=a=>{var A;const n=(A=t==null?void 0:t.filter(_=>(_==null?void 0:_.coin_type)===(a==null?void 0:a.value)))==null?void 0:A[0];e(n)};return o.jsx(ve,{w:"100%",mb:"8px",children:o.jsx(pt,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:l==null?void 0:l.label,tabList:p,handleChangeTab:x})})}function Ut(t,s,e,p,l,x,a,n,A,_){const{currentTokens:$,setCurrentTokens:F,zapAmount:S,setZapAmount:h,currentZapToken:m,setCurrentZapToken:f,zapAmountRate:i,setZapAmountRate:k,setZapTokenBalance:N,zapTokenBalance:j,setPreDepositeData:O,setIsPreLoading:Y,setZapApiPool:u,lower:V,upper:q,setLower:ee,setUpper:G,setZapCurrPriceData:b,resetZapData:ge,setLiquidity:he,setZapSlideValue:te,setPosOriginAmounts:W}=Ce(),{zapSdk:oe}=Ke(),{zapSlippage:Z}=Ee(),{balanceInfo:T}=Tt(m),{getTokenAmountValue:le}=We(),[z,ue]=g.useState("");g.useEffect(()=>{ee(p)},[p]),g.useEffect(()=>{G(l)},[l]),g.useEffect(()=>{he(n||"")},[n]),g.useEffect(()=>{te(A||0)},[A]),g.useEffect(()=>{W({coinAmountA:_==null?void 0:_.coinAmountA,coinAmountB:_==null?void 0:_.coinAmountB})},[_]),g.useEffect(()=>{var L,re;if(s!=null&&s.poolAddress&&e){const we=(L=s==null?void 0:s.tokenA)==null?void 0:L.decimals,Se=(re=s==null?void 0:s.tokenB)==null?void 0:re.decimals,ie=ze.sqrtPriceX64ToPrice(new Pe(e),we,Se).toString();b({currentPrice:ie,currentSqrtPrice:e})}},[e,s==null?void 0:s.poolAddress]),g.useEffect(()=>{let L=[];s!=null&&s.poolAddress&&(L=[s==null?void 0:s.displayTokenA,s==null?void 0:s.displayTokenB],f(s==null?void 0:s.displayTokenA)),F(L),u(s)},[s==null?void 0:s.poolAddress]);const J=L=>{h(L)},de=L=>{f(L),h("")};return g.useEffect(()=>{let L;S&&(m!=null&&m.coin_type)&&(L=le(m==null?void 0:m.coin_type,S)),k(L||"")},[S,m==null?void 0:m.coin_type]),g.useEffect(()=>{var L;if(t==="Deposit")N(T);else{const re=(m==null?void 0:m.coin_type)===((L=s==null?void 0:s.tokenA)==null?void 0:L.coin_type);N(re?{balanceFormat:x}:{balanceFormat:a})}},[t,T,x,a,m==null?void 0:m.coin_type,s==null?void 0:s.poolAddress]),g.useEffect(()=>()=>{ge()},[]),{currentTokens:$,zapAmount:S,zapAmountRate:i,handleChangeAmount:J,currentZapToken:m,handleChangeZapToken:de,zapTokenBalance:j,zapSlippage:Z}}function us({action:t,apiPoolInfo:s,currentSqrtPrice:e,lowerTick:p,upperTick:l,onlyAmountA:x,onlyAmountB:a,liquidity:n,slideValue:A,currentPosLiquidityData:_}){const{currentTokens:$,currentZapToken:F,handleChangeZapToken:S,zapAmount:h,zapAmountRate:m,handleChangeAmount:f,zapTokenBalance:i}=Ut(t,s,e,p,l,x,a,n,A,_);return g.useEffect(()=>{t==="Withdraw"&&E(h).gt((i==null?void 0:i.balanceFormat)||"0")&&f(i==null?void 0:i.balanceFormat)},[h,t,i==null?void 0:i.balanceFormat]),o.jsxs(ne,{w:"100%",children:[o.jsx(Ht,{tokens:$,current:F,onSelect:S}),o.jsx(mt,{wrapStyle:{h:"108px"},placeholder:"0.0",value:h,onChange:f,balance:(i==null?void 0:i.balanceFormat)||"",amountValue:m,token:F,needRemainBalance:t!=="Withdraw",balanceLabel:t==="Withdraw"?"Available":void 0})]})}function ds(t){const{value:s,action:e,onChange:p}=t,{isApp:l}=Qe();return o.jsx(xt,{padding:"6px 8px",borderRadius:"8px",width:"unset",children:o.jsxs(nt,{isLazy:!0,trigger:l?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[o.jsx(ot,{children:o.jsxs(H,{h:"14px",cursor:"pointer",children:[o.jsxs(U,{whiteSpace:"nowrap",fontSize:"14px",color:s?"primary":"",fontWeight:"500",children:["Zap ",e==="Deposit"?"In":"Out"]}),o.jsx(Ge,{isChecked:s,onChange:()=>{p()}})]})}),o.jsx(rt,{children:o.jsx(it,{p:"12px",lineHeight:"20px",fontSize:"12px",children:e=="Deposit"?"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ":"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."})})]})})}export{cs as R,as as Z,ls as a,It as b,Ot as c,qt as d,Ce as e,ds as f,us as g,tt as u};
//# sourceMappingURL=ZapSwitch-DGdCcRgo.js.map

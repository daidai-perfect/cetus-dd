import{a1 as te,r as h,aa as U,d as V,b as xe,j as e,W as G,m as le,T as o,V as L,H as x,g as ee,S as M,as as ae,aA as ge,$ as de,a$ as ue,e as he,a4 as be,aO as Ce,B as je,az as Se,aQ as ve,bc as Ae,Y as ke,a as Re,bd as Le,a_ as We,k as Ee}from"./index-CHLr8WBT.js";import{A as Fe}from"./index-DpYV1rxW.js";import{C as He}from"./CoinPairInfo-Djso5quW.js";import{S as Ve}from"./Slippage-D348yePR.js";import{u as ze,c as Me,L as fe,b as Ne,S as P}from"./useGetContractPoolInfo-DLLswoaS.js";import{u as De,a as Ge,P as Ue}from"./PositionCurrentPrice-CDPqH09K.js";import{u as ie,a as ye}from"./useCurrentPos-hcsN5k1R.js";import{e as Ye,f as Oe,c as J,b as qe}from"./usePositionList-COSCP2-2.js";import{A as we}from"./AddressCopyLink-CQIa6RW4.js";import{C as $e}from"./CetusTooltip-D6K7ROoy.js";import{u as Te}from"./useAccountBalance-C808azbd.js";import{u as Qe}from"./useTransaction-Cpn9lJJz.js";import{L as Je}from"./PriceRange-DrurIzCw.js";import{P as Ke}from"./progress-mbasB-pP.js";import{L as pe}from"./LockInput-i_ejckRl.js";import{u as Xe}from"./usePosAdd-ByIi6a4H.js";import{T as Ze}from"./TradeInputGroup-DMXrWAo6.js";import{F as Be,R as Ie}from"./RemoveBlock-BaUTMWFi.js";import{R as Pe}from"./RangeAlerts-IzwxhSoT.js";import{T as ei}from"./TooltipIcon--IGZm1TS.js";import{P as ii}from"./PositionStatus-BZDtjqPc.js";import{R as si}from"./RangeValue-qILU4Yqg.js";import{u as li}from"./index-CKtSmGUk.js";import{b as pi,u as ai}from"./useGetPoolList-CUnDlVFh.js";import{R as re}from"./RefreshButton-C1qwawBE.js";import{u as ti}from"./useRpcListener-BPWnNsjh.js";import"./global-kaoaUtz_.js";import"./index-DSOg8pVB.js";import"./useTokenBalance-ByvkZNF0.js";import"./switch-BiiHAgyb.js";import"./linear-Cl5vGKe1.js";import"./liquidity-D5dAnrBr.js";import"./usePreviousValue-Bt7rb2_J.js";import"./ActionButton-Caa7weYh.js";import"./HTextLabelBox-BFyStZLe.js";import"./VTextLabelBox-DkmtZjgn.js";import"./useToken-CUbDlqoG.js";import"./useBurn-7xY35hDE.js";import"./msafe-oYBkW7LJ.js";import"./api-data-utils-C7YZCm61.js";import"./AddressUnderline-W4FZ8DYL.js";import"./SingleTokenInfo-DSlHFcJf.js";import"./progress.utils-ByBnQfQc.js";import"./icon_lock@2x-OdzkPjmc.js";import"./useInsufficientBalanceToast-M7mNI8dt.js";import"./_getAllKeysIn-BdX03Ct2.js";import"./ExpendItem-BYhd_EZR.js";import"./useNotifiSubscription-C7AG3-6d.js";import"./useXCetusHelper-DDMnDS-o.js";function xi(){var X,Z,B,q,$,F;const{tokenAmountA:l,tokenAmountB:p,currentPosDetailTab:t,curPosContractPoolInfo:a}=ie(),{getPosFeeData:u}=Ye(),{getPosRewardsData:c}=Oe(),{currentAccount:n}=te(),{currentPosBaseInfo:i,posFeeData:m,posRewardsData:r,posLiquidityData:b,currentPosBaseInfoLoading:A,posFeeDataLoading:w,posRewardsDataLoading:C}=J();ye();const s=h.useMemo(()=>b[i==null?void 0:i.posId],[b,i==null?void 0:i.posId]),j=h.useMemo(()=>(console.log("ðŸš€ ~ currentPosFeeData ~ posFeeData[currentPosBaseInfo?.posId as string]:",m[i==null?void 0:i.posId]),m[i==null?void 0:i.posId]),[m,i==null?void 0:i.posId]),T=h.useMemo(()=>(console.log("ðŸš€ ~ currentPosRewardsData ~ posRewardsData[currentPosBaseInfo?.posId as string]:",r[i==null?void 0:i.posId]),r[i==null?void 0:i.posId]),[r,i==null?void 0:i.posId]),y=U(s==null?void 0:s.displayCoinAmountA,void 0,!0),W=U(s==null?void 0:s.displayCoinAmountB,void 0,!0),[S,k]=h.useState(!1),[v,H]=h.useState("--"),{signAndExecuteTransaction:_}=Qe(),{getPosClaimFeeAndRewardTxPayload:E}=De(),{calculatePendingYield:f}=Ge();h.useEffect(()=>{if(!A&&!w&&!C){const{total:g}=f([i],m,r);H(g)}},[A,w,C]);const{fetchAccountBalance:R}=Te(),z=async()=>{k(!0);try{const g=(T==null?void 0:T.map(se=>se.coin_address))||[],I={posType:i==null?void 0:i.posType,id:i==null?void 0:i.id,clmmPool:i==null?void 0:i.clmmPool,coinTypeA:i==null?void 0:i.coinTypeA,coinTypeB:i==null?void 0:i.coinTypeB,rewarderCoinTypes:g,account:n==null?void 0:n.address};console.log("ðŸš€ ~ toClaim ~ params.currentPosBaseInfo:",I,i);const{tx:ne,msafeParams:_e}=await E(I);console.log("ðŸš€ ~ toClaim ~ tx:",ne);const oe=await _(ne,{getShowInfo:se=>{const ce={modalDescriptionText:"",toastTitleText:""};return se==="success"&&(ce.toastTitleText="Claim Successful"),ce}},{msafeParams:_e});console.log("ðŸš€ ~ toClaim ~ res:",oe),oe&&setTimeout(()=>{R(),u([i]),c([i],{[a.poolAddress]:a})},2e3),k(!1)}catch(g){k(!1),console.log("ðŸš€ ~ toClaim ~ error:",g)}},N=l!==""||p!=="",D=V(+y).sub(+l).toString(),Y=N?V(y).eq(0)?"0":t=="increase"?V(l).plus(y).toString():V(D).gt(0)?D:"0":"",O=V(+W).sub(+p).toString(),K=N?V(W).eq(0)?"0":t=="increase"?V(p).plus(W).toString():V(O).gt(0)?O:"0":"",{isApp:d}=xe();return e.jsxs(G,{w:"100%",borderRadius:"16px",p:"0",children:[e.jsx(G,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"auto",lg:"80px"},p:{base:"20px 8px",lg:"20px 20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(le,{flexDir:{base:"column",lg:"row"},w:"100%",justify:{base:"center",lg:"space-between"},gap:{base:"16px",lg:"0"},children:[e.jsxs(le,{flexDir:{base:"row",lg:"column"},align:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},mt:{base:"-12px",lg:"0"},children:[e.jsx(o,{color:"primary_gray",mb:{base:"0",lg:"-12px"},children:"Liquidity"}),e.jsx(Je,{positionInfo:i,haveTooltip:!1})]}),e.jsxs(L,{minW:"200px",align:{base:"center",lg:"flex-end"},pb:{base:"0",lg:"12px"},gap:"12px",children:[e.jsxs(x,{w:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(x,{gap:"4px",children:[e.jsx(ee,{imageUrl:(X=i==null?void 0:i.displayTokenA)==null?void 0:X.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?(Z=i==null?void 0:i.displayTokenA)==null?void 0:Z.coin_type:""}),e.jsx(M,{isLoaded:!!i&&!!s,children:e.jsxs(x,{gap:"4px",children:[e.jsx(o,{color:"primary",children:ae((B=i==null?void 0:i.displayTokenA)==null?void 0:B.symbol)}),e.jsxs(o,{color:"primary",children:[s==null?void 0:s.displayPercentA,"%"]})]})})]}),e.jsxs(x,{gap:"4px",children:[e.jsx(ee,{imageUrl:(q=i==null?void 0:i.displayTokenB)==null?void 0:q.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?($=i==null?void 0:i.displayTokenB)==null?void 0:$.coin_type:""}),e.jsx(M,{isLoaded:!!i&&!!s,children:e.jsxs(x,{gap:"4px",children:[e.jsx(o,{color:"primary_green",children:ae((F=i==null?void 0:i.displayTokenB)==null?void 0:F.symbol)}),e.jsxs(o,{color:"primary_green",children:[s==null?void 0:s.displayPercentB,"%"]})]})})]})]}),e.jsx(Ke,{w:"200px",h:"4px",value:s==null?void 0:s.displayPercentA,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})}),e.jsxs(x,{gap:{base:"20px",lg:"8px"},p:{base:"20px 8px",lg:"40px 8px"},w:"100%",justify:"space-around",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Base",token:i==null?void 0:i.displayTokenA,amount:s==null?void 0:s.displayCoinAmountA,afterAmount:Y}),e.jsx(Q,{label:"Quote",token:i==null?void 0:i.displayTokenB,amount:s==null?void 0:s.displayCoinAmountB,afterAmount:K})]}),e.jsx(G,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"70px",lg:"80px"},p:{base:"20px 8px",lg:"20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(x,{w:"100%",justify:"space-between",children:[e.jsxs(le,{flexDir:{base:"row",lg:"column"},alignItems:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},w:{base:"100%",lg:"auto"},children:[e.jsx(o,{color:"primary_gray",children:"Pending Yield"}),e.jsx(M,{isLoaded:!!v&&!!i&&!!m&&!!r,children:e.jsx(o,{color:"text_caption",fontSize:"16px",children:ge(v,2)})})]}),e.jsx(de,{isLoading:S,disabled:Number(v)==0||w||C||S||!j,onClick:z,w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",children:"Claim"})]})}),e.jsxs(x,{p:{base:"20px 8px 0",lg:"40px 8px 20px"},w:"100%",justify:"space-between",flexWrap:"wrap",sx:{">div":{mb:{base:"12px",lg:"20px"}}},flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Fees",token:i==null?void 0:i.displayTokenA,amount:j==null?void 0:j.displayFeeOwedA,afterAmount:N?"0":""}),e.jsx(Q,{label:d?"":"Fees",token:i==null?void 0:i.displayTokenB,amount:j==null?void 0:j.displayFeeOwedB,afterAmount:N?"0":""}),T==null?void 0:T.map((g,I)=>e.jsx(ue.Fragment,{children:V(g.amount_owed).gt(0)&&e.jsx(Q,{label:d?I==0?"Mining Rewards":"":"Mining Rewards",token:g==null?void 0:g.token,amount:g==null?void 0:g.display_amount_owed,afterAmount:N?"0":""})},g==null?void 0:g.coin_address))]})]})}const Q=({label:l,token:p,amount:t,afterAmount:a,isLoading:u})=>{const{isApp:c}=xe(),{getExplorerUrl:n}=he();return e.jsxs(L,{align:{base:"flex-end",lg:"center"},gap:{base:"4px",lg:"8px"},w:{base:"100%",lg:"calc(50% - 4px)"},children:[e.jsxs(x,{w:"100%",justify:{base:"space-between"},flexDirection:{base:"row",lg:"column"},children:[e.jsx(o,{color:"primary_gray",children:l}),e.jsxs(x,{children:[e.jsx($e,{showTooltip:!c,placement:"top",tooltip:e.jsxs(x,{children:[e.jsx(ee,{imageUrl:p==null?void 0:p.logo_url,w:"20px",h:"20px",minH:"20px",minW:"20px",showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:""}),e.jsx(o,{color:"text_caption",children:p==null?void 0:p.symbol}),e.jsx(we,{address:p==null?void 0:p.coin_type,onClickLink:()=>window.open(n(p==null?void 0:p.coin_type,"coin"))})]}),children:e.jsx(ee,{imageUrl:p==null?void 0:p.logo_url,w:{base:"20px",lg:"28px"},h:{base:"20px",lg:"28px"},minH:{base:"20px",lg:"28px"},minW:{base:"20px",lg:"28px"},showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:"",onClick:c?()=>window.open(n(p==null?void 0:p.coin_type,"coin")):()=>{}})}),e.jsx(M,{isLoaded:!u&&!!t,children:e.jsx(o,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:U(t)})}),e.jsx(o,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:ae(p==null?void 0:p.symbol)})]})]}),a!==""&&a&&e.jsxs(x,{bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(o,{color:"primary",children:U(a)}),e.jsx(o,{color:"primary",children:"after"})]})]})};function di(){const{currentPosBaseInfo:l,posPoolsRelatedData:p}=J(),{currentAccount:t,onWalletModal:a}=te(),{tokenAmountA:u,tokenAmountB:c,isFixedDisplayTokenA:n,curPosContractPoolInfo:i}=ie(),{displayTokenA:m,displayTokenB:r,tokenABalanceInfo:b,tokenBBalanceInfo:A,tokenAmountValueA:w,tokenAmountValueB:C,handleAmountChange:s,preAddLoading:j,btnStatusText:T,toAdd:y,isAddLoading:W,showDisplayTokenALock:S,showDisplayTokenBLock:k,resetInputAmount:v}=Xe();h.useEffect(()=>()=>{v()},[]);const{getTokenAmountValue:H}=be(),_=H(m==null?void 0:m.coin_type,u,"--"),E=H(r==null?void 0:r.coin_type,c,"--"),f=_=="--"||E=="--"?"--":Ce(w).plus(C).toString(),R=p[l==null?void 0:l.posId];return e.jsxs(L,{w:"100%",gap:"8px",children:[e.jsxs(je,{w:"100%",position:"relative",children:[e.jsx(Ze,{from:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(b==null?void 0:b.balanceFormat)||"",value:u,amountValue:w,loading:!n&&j,onChange:z=>{s(z,!0)},placeholder:"0.0",token:m},to:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(A==null?void 0:A.balanceFormat)||"",value:c,amountValue:C,loading:n&&j,onChange:z=>{s(z,!1)},placeholder:"0.0",token:r},iconParams:S||k?void 0:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),(!l||!i)&&e.jsx(pe,{position:"absolute",top:"0px",left:"0",borderRadius:"12px",h:"224px",zIndex:9999}),l&&(l==null?void 0:l.posType)=="burn"&&e.jsx(pe,{position:"absolute",top:"0px",left:"0",h:"224px",borderRadius:"12px",text:"Your liquidity has been permanently locked",zIndex:9999}),l&&i&&(S||k)&&e.jsx(pe,{position:"absolute",top:S?"0px":"116px",borderRadius:"12px",h:"108px",left:"0"})]}),e.jsx(de,{onClick:()=>{t?y():a(!0)},isLoading:W,disabled:T.disabled||W,w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:T.text}),+f&&e.jsx(G,{borderRadius:"0 0 12px 12px",pt:"36px",mt:"-28px",children:e.jsxs(x,{w:"100%",justify:"space-between",children:[e.jsx(o,{children:"Total Amount"}),e.jsx(o,{color:"text_caption",children:ge(f,2)})]})}),(l==null?void 0:l.posType)!=="burn"&&e.jsx(Be,{}),R&&(R==null?void 0:R.minPrice)!=="0"&&(R==null?void 0:R.maxPrice)!=="âˆž"&&e.jsx(Pe,{subscriptionSource:"PositionDetail"})]})}function ni(){const{currentPosBaseInfo:l}=J(),{currentPosPoolInfo:p,curPosContractPoolInfo:t}=ie(),{setContractPoolInfo:a,setApiPoolInfo:u}=li(),{lowerTickData:c,upperTickData:n,setLowerTickData:i,setUpperTickData:m}=ze();Se(()=>{u(p)},[p]);const r=(w,C,s)=>{var H,_;const j=(H=s==null?void 0:s.tokenA)==null?void 0:H.decimals,T=(_=s==null?void 0:s.tokenB)==null?void 0:_.decimals;let y;Math.abs(w)==Math.abs(ve.getMinIndex(Number(s.tickSpacing)))?y=C==="lower"?"0":"âˆž":y=Ae.tickIndexToPrice(w,j,T).toString();const W=y==="âˆž"?"âˆž":U(y,6),S=pi(y),k=S==="âˆž"?"âˆž":U(S,6),v={id:C,tokenA:s==null?void 0:s.tokenA,tokenB:s==null?void 0:s.tokenB,tick:w,price:y,displayPrice:W,reversePrice:S,displayReversePrice:k,tickSpacing:s==null?void 0:s.tickSpacing,pool:s==null?void 0:s.poolAddress};C==="lower"?i({...v}):m({...v})},{getCurrentPrice:b}=Me();h.useEffect(()=>{l!=null&&l.lowerTick&&(t!=null&&t.current_sqrt_price)&&(p!=null&&p.poolAddress)&&(r(l==null?void 0:l.lowerTick,"lower",p),r(l==null?void 0:l.upperTick,"upper",p),b(t==null?void 0:t.current_sqrt_price,p),a(t))},[l==null?void 0:l.lowerTick,t==null?void 0:t.current_sqrt_price,p==null?void 0:p.poolAddress]);const A=h.useMemo(()=>(l==null?void 0:l.posId)&&(c==null?void 0:c.pool)&&(n==null?void 0:n.pool),[c==null?void 0:c.pool,n==null?void 0:n.pool,l==null?void 0:l.posId]);return e.jsx(je,{className:"chart-block",w:{base:"100%",lg:"200px"},h:"85px",mb:"8px",overflow:"hidden",children:A&&e.jsx(fe,{isFrom:"position",handleClickRefresh:()=>{},direct:!(l!=null&&l.isReverse),minPriceData:l!=null&&l.isReverse?n:c,maxPriceData:l!=null&&l.isReverse?c:n,readonly:!0})})}function oi(){const{currentPosBaseInfo:l,posPoolsRelatedData:p,posPoolsOriginalData:t}=J(),a=p[l==null?void 0:l.posId],{getClmmPosName:u}=qe(),c=h.useMemo(()=>{var r;if(l!=null&&l.tokenName)return l==null?void 0:l.tokenName;{const b=(r=t==null?void 0:t[l==null?void 0:l.clmmPool])==null?void 0:r.index;return u(l==null?void 0:l.index,b)}},[l==null?void 0:l.tokenName,l==null?void 0:l.index,l==null?void 0:l.clmmPool,t]);(a==null?void 0:a.displayFee)+"";const n=(a==null?void 0:a.currentStatus)=="Active",i=h.useMemo(()=>{console.log("ðŸš€ ~ leverage ~ currentPosPoolsRelatedData:",a);const r=a==null?void 0:a.minPriceOrigin,b=a==null?void 0:a.maxPriceOrigin;return r!=="0"&&b!=="âˆž"?ke(1/(1-Number((r/b)**.25)),2)+"x":"1x"},[a==null?void 0:a.minPriceOrigin,a==null?void 0:a.maxPriceOrigin]),{getExplorerUrl:m}=he();return e.jsxs(G,{w:"100%",borderRadius:"20px 20px 16px 16px",children:[e.jsx(G,{p:{base:"16px 8px",lg:"16px"},w:"calc(100% + 34px)",ml:"-17px",mt:"-21px",bg:"bg_primary",children:e.jsxs(x,{justify:"space-between",children:[e.jsxs(x,{h:{base:"40px",lg:"32px"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(o,{children:"Position ID"}),e.jsx(M,{isLoaded:!!c,children:e.jsx(o,{color:"text_caption",children:c==null?void 0:c.split("|")[1]})})]}),e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(o,{children:"Position NFT"}),e.jsx(M,{isLoaded:!!(l!=null&&l.id),children:e.jsx(we,{fontWeight:"500",color:"text_caption",fontSize:"14px",address:l==null?void 0:l.id,showLink:!1,onClickLink:()=>{window.open(m(l==null?void 0:l.id,"nftAddress"),"_blank")}})})]})]}),a&&e.jsx(ii,{isActive:n,isLoading:(a==null?void 0:a.currentStatus)=="",h:"32px",p:"0 12px",w:"unset",isRow:!0,imgStyle:{imgW:"30px",imgH:"16px"}})]})}),e.jsxs(x,{gap:{base:"20px",lg:"8px"},w:"100%",justify:"space-between",p:"28px 0 20px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(L,{gap:{base:"16px",lg:"32px"},children:[e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(o,{color:"primary_gray",children:"Current Price"}),e.jsx(Ue,{posId:(l==null?void 0:l.posId)||"",displayTokenA:l==null?void 0:l.displayTokenA,displayTokenB:l==null?void 0:l.displayTokenB})]}),e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(o,{color:"primary_gray",children:"Position Range"}),e.jsx(si,{displayTokenA:l==null?void 0:l.displayTokenA,displayTokenB:l==null?void 0:l.displayTokenB,justify:"center",priceInfo:{minPrice:a==null?void 0:a.minPrice,maxPrice:a==null?void 0:a.maxPrice,minPriceResever:a==null?void 0:a.minPriceResever,maxPriceResever:a==null?void 0:a.maxPriceResever},fontSize:"14px"})]})]}),e.jsxs(L,{gap:"0",children:[e.jsx(ni,{}),e.jsx(L,{zIndex:"9",children:e.jsxs(x,{gap:"2px",bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(o,{color:"primary",fontSize:"12px",children:"Leverage"}),e.jsx(ei,{type:"leverage"}),e.jsx(M,{ml:"4px",isLoaded:!!i&&!!a,children:e.jsx(o,{color:"primary",children:i})})]})})]})]})]})}function ts(){var O,K;const l=Re(),{fetchAccountBalance:p}=Te(),{currentAccount:t}=te(),{position_nft_id:a}=Le(),{getCurrentPosBaseInfo:u,getCurrentPosHistory:c}=ye(),{currentPosDetailTab:n,currentPosPoolInfo:i,setCurrentPosDetailTab:m,setCurrentPosPoolInfo:r,setCurrentPoolSqrtPrice:b,setCurPosContractPoolInfo:A,setIsPosDetailRefresh:w}=ie(),{posPoolsRelatedData:C,currentPosBaseInfo:s,setCurrentPosBaseInfo:j,farmsPosRewardsData:T,posRewardsData:y}=J(),W=(((O=C[s==null?void 0:s.posId])==null?void 0:O.displayFee)||"--")+"%",S=[{label:"Increase",value:"increase"},{label:"Remove",value:"remove"}],k=()=>{console.log("ðŸš€ ~ handleRefresh ~ handleRefresh:"),w(!0),v(!0),z(),f(),p(),D(),setTimeout(()=>{w(!1)},1e3)},v=(d=!1)=>{t!=null&&t.address&&a&&u(t==null?void 0:t.address,a,d)};h.useEffect(()=>{console.log("ðŸš€ ~ PositionDetail ~ position_nft_id:",a),v()},[t==null?void 0:t.address,a]),h.useEffect(()=>{console.log("ðŸš€ ~ PositionHistory ~ currentPosBaseInfo?.id:",s==null?void 0:s.id)},[s==null?void 0:s.id]);const{fetchTokenPrices:H}=be(),_=T[s==null?void 0:s.id],E=y[s==null?void 0:s.posId],f=()=>{var q,$;const d=(E==null?void 0:E.map(F=>F==null?void 0:F.coin_address))||[],X=(_==null?void 0:_.map(F=>F==null?void 0:F.rewarder_type))||[],Z=[(q=s==null?void 0:s.tokenA)==null?void 0:q.coin_type,($=s==null?void 0:s.tokenB)==null?void 0:$.coin_type].filter(Boolean),B=Array.from(new Set([...d,...Z,...X]));H(B)};h.useEffect(()=>{f()},[s==null?void 0:s.posId,E==null?void 0:E.length,_==null?void 0:_.length]);const{getPoolList:R}=ai(),z=async()=>{if(!(s!=null&&s.clmmPool))return;const d=await R({pool:s==null?void 0:s.clmmPool});if(console.log("ðŸš€ ~ getPoolData ~ poolInfo:",s,d),d)return r(d==null?void 0:d.list[0])},{getContractPoolInfo:N}=Ne(),D=async()=>{if(console.log("ðŸš€ ~ handleGetPrice ~ currentPosBaseInfo?.clmmPool:",s==null?void 0:s.clmmPool),s!=null&&s.clmmPool){const d=await N(s==null?void 0:s.clmmPool);console.log("ðŸš€ ~ handleGetPrice ~ contractPoolInfo:",d),d&&(b(d.current_sqrt_price),A(d))}};h.useEffect(()=>{z(),D();let d;return s!=null&&s.clmmPool&&(d=setInterval(()=>{D()},2e4)),()=>{clearInterval(d)}},[s==null?void 0:s.clmmPool]),h.useEffect(()=>(m("increase"),t!=null&&t.address&&p(),()=>{A(null),j(null),r(null)}),[]),ti({onRpcChange:()=>{v(!0),D(),t!=null&&t.address&&p()}});const{isApp:Y}=xe();return e.jsxs(L,{gap:"12px",w:"100%",pt:"20px",align:"flex-start",children:[e.jsxs(x,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(x,{w:{base:"100%",lg:"unset"},justifyContent:"space-between",children:[e.jsx(We,{}),Y&&e.jsxs(x,{children:[e.jsx(me,{}),e.jsx(re,{handleRefresh:k,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(de,{w:{base:"100%",lg:"unset"},bg:"bg_secondary",fontSize:"14px",p:"0 16px",h:"32px",borderRadius:"8px",fontWeight:"500",variant:"outline",onClick:d=>{l(`/liquidity?poolAddress=${s==null?void 0:s.clmmPool}`)},children:"Create a new position"}),!Y&&e.jsx(re,{handleRefresh:k,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(x,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(M,{w:{base:"100%",lg:"unset"},isLoaded:!!(s!=null&&s.clmmPool),children:e.jsx(He,{symbolFontWeight:"600",haveName:!0,poolInfo:{feeDisplay:W,poolAddress:s==null?void 0:s.clmmPool,...s},symbolEllipsesDecimals:10,nameEllipsesDecimals:20,placement:"bottom-start"})}),e.jsxs(x,{w:{base:"100%",lg:"unset"},gap:{base:"12px",lg:"28px"},flexDirection:{base:"column",lg:"row"},children:[e.jsx(P,{label:"Pool APR",value:e.jsx(Fe,{poolInfo:i,children:e.jsxs(x,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsx(o,{as:"span",fontSize:"14px",color:"text_caption",fontWeight:"500",cursor:i!=null&&i.farmingAprDisplay||((K=i==null?void 0:i.miningAprList)==null?void 0:K.length)>0?"help":"text",children:i==null?void 0:i.feeAndMiningAprDisplay}),(i==null?void 0:i.haveFarming)&&e.jsxs(o,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",i==null?void 0:i.farmingAprDisplay]})]})}),loading:!(i!=null&&i.poolAddress)}),e.jsx(P,{label:"TVL",value:(i==null?void 0:i.tvlDisplay)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(P,{label:"Volume (24H)",value:(i==null?void 0:i.volume24Display)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(P,{label:"Fees (24H)",value:(i==null?void 0:i.fees24Display)||"",loading:!(i!=null&&i.poolAddress)})]})]}),e.jsxs(x,{w:"100%",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(L,{w:{base:"100%",lg:"60%"},gap:"8px",children:[e.jsx(oi,{}),e.jsx(xi,{})]},`${s==null?void 0:s.posId}-posInfo`),e.jsxs(L,{w:{base:"100%",lg:"40%"},children:[e.jsx(G,{p:"0",borderRadius:"12px",children:e.jsxs(x,{w:"100%",p:"0 16px",children:[e.jsx(Ee,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{w:{base:"50%",lg:"unset"},fontSize:"16px",mr:"28px"},tabList:S,currentTab:n=="increase"?"Increase":"Remove",handleChangeTab:d=>{m(d==null?void 0:d.value)}}),!Y&&e.jsx(me,{})]})}),n=="increase"&&e.jsx(di,{}),n=="remove"&&e.jsx(Ie,{})]})]})]})}const me=()=>e.jsx(x,{children:e.jsx(Ve,{})});export{ts as default};

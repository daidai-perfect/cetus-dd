import{r as g,a1 as F,R as K,bz as P,aa as O,d as Y,a9 as oe,j as e,ae as ye,af as Te,ag as ve,ah as ke,ai as Re,aj as Ae,ak as Le,V as j,H as _,av as Me,T as c,$ as H,aA as U,a7 as pe,B as re,k as ge,bA as Ee,bB as Ie,bC as De,bD as ze,W as E,bo as le,C as te,bE as he,b as q,m as J,g as $,Y as V,I as Ue,S as ue,aB as ie,ao as fe,a5 as Pe,aO as ne,aD as Oe}from"./index-RYgVkSoi.js";import{M as Q}from"./msafe-oYBkW7LJ.js";import{u as N}from"./useAccountBalance-BUWq9RBG.js";import{u as me}from"./useTokenBalance-vtY7zrJ1.js";import{u as Z}from"./useTransaction-DkW_b1hC.js";import{u as ee,a as ce,b as be,c as Xe,d as Be,e as Fe}from"./useXCetusHelper-Cpnl8TUt.js";import{T as Ce}from"./TradeInputGroup-DGwEtzcn.js";import{H as We}from"./HighlightText-DO2CIL1-.js";import{H as xe}from"./HTextLabelBox-BkFjgGJ6.js";import{V as Se}from"./VTextLabelBox-PjY7x2HH.js";import{C as Ve}from"./CetusTooltip-BD_tZI8A.js";import{u as He}from"./useToken-ptIKZ0M9.js";import{u as Ne}from"./useRpcListener-CjnFDV_L.js";import"./_getAllKeysIn-DhN3vCUi.js";import"./usePreviousValue-CyWk0cbo.js";const je=(s,t,n="seconds")=>{const i=()=>{const l=s-new Date().getTime();if(l<=0)return{years:0,months:0,days:0,hours:0,minutes:0,seconds:0};const p=Math.floor(l/1e3%60),u=Math.floor(l/1e3/60%60),o=Math.floor(l/(1e3*60*60)%24),d=Math.floor(l/(1e3*60*60*24)%30),b=Math.floor(l/(1e3*60*60*24*30)%12),w=Math.floor(l/(1e3*60*60*24*365));return n==="days"?{years:0,months:0,days:d+b*30+w*365,hours:o,minutes:u,seconds:p}:n==="months"?{years:0,months:b+w*12,days:d,hours:o,minutes:u,seconds:p}:{years:w,months:b,days:d,hours:o,minutes:u,seconds:p}},[a,r]=g.useState(i());return g.useEffect(()=>{const x=setInterval(()=>{const l=i();r(l),l.years===0&&l.months===0&&l.days===0&&l.hours===0&&l.minutes===0&&l.seconds===0&&(clearInterval(x),t&&t())},1e3);return()=>clearInterval(x)},[s]),a};function Ge(){const{fetchAccountBalance:s}=N(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{currentAccount:i}=F(),{fetchOwnerVeNFT:a}=ce(),{xCetusSdk:r}=K(),{veNFT:x}=P(),[l,p]=g.useState(""),[u,o]=g.useState(""),{balanceInfo:d}=me(O.cetus_coin),b=f=>{p(f),o(f)},[w,y]=g.useState(!1),C=async()=>{y(!0);const f={venft_id:x==null?void 0:x.id,amount:oe(l,9).toFixed(0)},I=await r.XCetusModule.convertPayload(f),M=await n(I,{getShowInfo:v=>{const D=`Converting ${l} CETUS to ${l} xCETUS`,z={modalTitleText:"Convert",modalDescriptionText:D,toastDescriptionContent:D};if(v==="success"){const R=D.replace("Converting","Converted");z.modalDescriptionText=R,z.toastDescriptionContent=R}return z}},{msafeParams:{action:Q.xCETUSConvert,txbParams:f}});y(!1),M&&(i&&a(i==null?void 0:i.address,!0),p(""),o(""),s(),t())},T=g.useMemo(()=>{const f={text:"Convert",disabled:!1};return i!=null&&i.address?+l?(+l&&Y(l).gt((d==null?void 0:d.balanceFormat)||0)&&(f.disabled=!0,f.text="Insufficient CETUS Balance"),f):(f.text="Enter an amount",f.disabled=!0,f):(f.text="Connect Wallet",f.disabled=!1,f)},[d==null?void 0:d.balanceFormat,i==null?void 0:i.address,l]);return{inputAmountFrom:l,inputAmountTo:u,handleInputChange:b,balanceInfoFrom:d,convertLoading:w,btnText:T.text,btnDisabled:T.disabled,handleConvertClick:C}}function we(s){const{isOpen:t,onClose:n,onSubmitClick:i}=s,{setShowConvertModel:a}=P(),[r,x]=g.useState(!1);return e.jsxs(ye,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(ve,{children:[e.jsx(ke,{children:e.jsx(Re,{fontWeight:"500",fontSize:"16px"})}),e.jsx(Ae,{}),e.jsx(Le,{textAlign:"center",p:"0px",children:e.jsxs(j,{w:"100%",gap:"20px",p:"20px",pb:"90px",pos:"relative",children:[e.jsx(We,{text_color:"text_caption",text_size:"14px",text:` Please note that after conversion, if you want to convert xCETUS back to CETUS, a vesting period will be applied & different vesting
              durations correspond to different redeem ratios. Learn more`,keywords:["Learn more"],onKeywordClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")}}),e.jsxs(_,{children:[e.jsx(Me,{checked:r,onClick:()=>{x(!r)}}),e.jsx(c,{color:"text_caption",children:"Do not remind again."})]}),e.jsx(H,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{a(!r),i()},children:"Convert"})]})})]})]})}function $e(s){const{availableXCetusAmount:t,iconParams:n,onIconClick:i}=s,{currentAccount:a,onWalletModal:r}=F(),{inputAmountFrom:x,inputAmountTo:l,handleInputChange:p,balanceInfoFrom:u,btnText:o,btnDisabled:d,handleConvertClick:b,convertLoading:w}=Ge(),{showConvertModel:y}=P(),[C,T]=g.useState(!1);return e.jsxs(j,{w:"100%",gap:"8px",children:[e.jsx(Ce,{onClick:i,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:(u==null?void 0:u.balanceFormat)||"",value:x,amountValue:"",loading:!1,onChange:f=>{p(f)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:U(t,9),value:l,half:!1,max:!1,amountValue:"",onChange:f=>{p(f)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},iconParams:n}),e.jsx(H,{w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:d||w,isLoading:w,onClick:()=>{console.log(a,y,"showConvertModel"),a?y?T(!0):b():r(!0)},children:o}),C&&e.jsx(we,{isOpen:C,onClose:()=>{T(!1)},onSubmitClick:()=>{T(!1),b()}})]})}function Ye(s){const{fetchAccountBalance:t}=N(),{fetchOwnerLockCetusList:n}=ee(),{signAndExecuteTransaction:i}=Z(),{currentAccount:a}=F(),{fetchOwnerVeNFT:r}=ce(),{xCetusSdk:x}=K(),{veNFT:l}=P(),[p,u]=g.useState(""),[o,d]=g.useState(""),[b,w]=g.useState(180),[y,C]=g.useState(""),[T,f]=g.useState(!0),{balanceInfo:I}=me(O.cetus_coin),M=(h,A)=>{f(A),A?u(h):d(h),D(h,A,b)},v=h=>{w(h),D(T?p:o,T,h)},D=async(h,A,B)=>{if(+h){const L=oe(h,9);if(A){const S=await x.XCetusModule.redeemNum(L,B);d(U(S.amount_out,9)),C(Y(S.percent).mul(100).toFixed(2,pe.ROUND_DOWN))}else{const S=await x.XCetusModule.reverseRedeemNum(L,B);u(U(S.amount_out,9)),C(Y(S.percent).mul(100).toFixed(2,pe.ROUND_DOWN))}}else u(""),d(""),C("")},[z,R]=g.useState(!1),G=async()=>{if(!l)return;R(!0);const h={venft_id:l.id,amount:oe(p,9).toFixed(0),lock_day:b},A=x.XCetusModule.redeemLockPayload(h),B=await i(A,{getShowInfo:L=>{const S=`Redeeming ${p} xCETUS to ${o} CETUS`,X={modalTitleText:"Redeem",modalDescriptionText:S,toastDescriptionContent:S};if(L==="success"){const m=S.replace("Redeeming","Redeemed");X.modalDescriptionText=m,X.toastDescriptionContent=m}return X}},{msafeParams:{action:Q.xCETUSRedeemLock,txbParams:h}});R(!1),B&&(a&&r(a==null?void 0:a.address,!0),u(""),d(""),t(),n())},W=g.useMemo(()=>{const h={text:"Redeem",disabled:!1};return a!=null&&a.address?+p?(+p&&Y(p).gt(s||0)&&(h.disabled=!0,h.text="Insufficient xCETUS Balance"),h):(h.text="Enter an amount",h.disabled=!0,h):(h.text="Connect Wallet",h.disabled=!1,h)},[s,a==null?void 0:a.address,p]);return{inputAmountFrom:p,inputAmountTo:o,handleInputChange:M,balanceInfoTo:I,convertLoading:z,btnText:W.text,btnDisabled:W.disabled,handleConvertClick:G,day:b,handleDayChange:v,percent:y}}function Ke(s){const{day:t,onChange:n}=s,i=g.useMemo(()=>`${t}D`,[t]),a=[{label:"15D"},{label:"30D"},{label:"90D"},{label:"180D"}];return e.jsxs(re,{children:[e.jsxs(_,{w:"100%",justifyContent:"space-between",m:"10px 0",children:[e.jsxs(c,{fontSize:"16px",color:"text_caption",whiteSpace:"nowrap",children:[t," Days"]}),e.jsx(ge,{type:"outlineTab",tabList:a,currentTab:i,handleChangeTab:r=>{r.label==="MAX"?n(100):n(r.label.replace("D",""))},wrapStyle:{flex:"1",maxW:"300px",h:"32px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),e.jsxs(Ee,{"aria-label":"slider-ex-1",min:15,max:180,focusThumbOnChange:!1,value:Number(t),onChange:r=>n(r),children:[e.jsx(Ie,{h:"8px",children:e.jsx(De,{h:"4px"})}),e.jsx(ze,{})]})]})}function qe(s){const{availableXCetusAmount:t,iconParams:n,onIconClick:i}=s,{currentAccount:a,onWalletModal:r}=F(),{inputAmountFrom:x,inputAmountTo:l,handleInputChange:p,balanceInfoTo:u,btnText:o,btnDisabled:d,handleConvertClick:b,day:w,handleDayChange:y,percent:C,convertLoading:T}=Ye(t),{showConvertModel:f}=P(),[I,M]=g.useState(!1);return e.jsxs(j,{w:"100%",gap:"8px",children:[e.jsx(Ce,{onClick:i,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:t,value:x,amountValue:"",loading:!1,onChange:v=>{p(v,!0)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:(u==null?void 0:u.balanceFormat)||"",value:l,half:!1,max:!1,amountValue:"",onChange:v=>{p(v,!1)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},iconParams:n}),e.jsxs(E,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(c,{mb:"16px",color:"primary_gray",children:"Vesting duration"}),e.jsx(Ke,{day:w,onChange:v=>{y(Number(v))}})]}),e.jsx(E,{borderRadius:"12px",p:"0px",children:e.jsxs(j,{w:"100%",gap:"20px",children:[e.jsx(H,{mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:d||T,isLoading:T,onClick:()=>{a?f?M(!0):b():r(!0)},children:o}),+C&&e.jsx(_,{w:"100%",pb:"20px",pl:"16px",pr:"16px",children:e.jsx(xe,{label:"Redeem ratio",labelStyle:{fontSize:"14px"},value:le(C),valueStyle:{fontSize:"14px"}})})]})}),I&&e.jsx(we,{isOpen:I,onClose:()=>{M(!1)},onSubmitClick:()=>{M(!1),b()}})]})}function Je({nextStartTime:s,refresh:t}){const{days:n,hours:i,minutes:a,seconds:r}=je(s*1e3,t);return e.jsxs(j,{w:"100%",gap:"16px",borderRadius:"16px",m:"-1px",p:{base:"24px 12px",lg:"24px"},sx:{backgroundImage:"url('/images/img_xcetus@2x.png')",backgroundPosition:"top center",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:[e.jsx(c,{fontSize:"16px",color:"text_caption",children:"Convert CETUS to xCETUS to start earning"}),e.jsx(c,{children:"Reward distribution in "}),e.jsxs(_,{children:[e.jsx(E,{borderRadius:"4px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(te,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[n,"d"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(E,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(te,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[i,"h"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(E,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(te,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[a,"m"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(E,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(te,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[r,"s"]})})})]})]})}function Qe(){const{fetchAccountBalance:s}=N(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{xCetusSdk:i}=K(),{veNFT:a}=P(),[r,x]=g.useState(!1);return{handleCancelOrder:async p=>{if(!a)return;x(!0);const u={venft_id:a.id,lock_id:p.id},o=i.XCetusModule.cancelRedeemPayload(u),d=await n(o,{},{msafeParams:{action:Q.xCETUSCancelRedeem,txbParams:u}});x(!1),d&&(s(),t())},cancelOrderLoading:r}}function Ze(){const{fetchAccountBalance:s}=N(),{fetchOwnerLockCetusList:t}=ee(),{signAndExecuteTransaction:n}=Z(),{xCetusSdk:i}=K(),{veNFT:a}=P(),[r,x]=g.useState(!1);return{handleClaimOrder:async p=>{if(x(!0),!a)return;const u={lock_id:p,venft_id:a.id},o=await i.XCetusModule.redeemPayload(u),d=await n(o,{},{useDevInspect:!1,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:Q.xCETUSRedeem,txbParams:u}});x(!1),d&&(s(),t())},claimOrderLoading:r}}function et(s){const{lockCetusList:t}=s;return e.jsx(E,{p:{base:"16px 8px 8px",lg:"16px"},borderRadius:"16px",children:e.jsxs(j,{w:"100%",alignItems:"start",gap:"16px",children:[e.jsx(c,{fontSize:"16px",color:"text_caption",mt:"4px",children:"Vesting"}),t.map(n=>e.jsx(tt,{info:n},n.id))]})})}function tt(s){const{info:t}=s,[n,i]=g.useState(!1),{days:a,hours:r,minutes:x,seconds:l}=je(t.locked_until_time*1e3,()=>{i(!0)},"days");g.useEffect(()=>{i(!he.isLocked(t))},[]);const{cancelOrderLoading:p,handleCancelOrder:u}=Qe(),{claimOrderLoading:o,handleClaimOrder:d}=Ze(),b=y=>{y?d(t.id):u(t)},{isApp:w}=q();return e.jsx(E,{borderRadius:"12px",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:"100%",justifyContent:{base:"flex-start",lg:"space-between"},gap:{base:"20px",lg:"8px"},children:[e.jsxs(j,{gap:{base:"20px",lg:"8px"},alignItems:"start",children:[e.jsxs(_,{gap:"6px",children:[e.jsxs(c,{color:"primary_gray",children:["Available ",n?"":" in"," "]}),!n&&e.jsxs(c,{color:"text_caption",children:[a,"d : ",r,"h : ",x,"m : ",l,"s"]})]}),w?e.jsxs(j,{w:"100%",align:"center",gap:"8px",children:[e.jsxs(_,{children:[e.jsx($,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[V(U(t.xcetus_amount,9),9)," xCETUS"]})]}),e.jsx(c,{color:"text_caption",transform:"rotate(90deg)",children:"→"}),e.jsxs(_,{children:[e.jsx($,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[V(U(t.cetus_amount,9),9)," CETUS "]})]})]}):e.jsxs(_,{children:[e.jsx($,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[V(U(t.xcetus_amount,9),9)," xCETUS →"]}),e.jsx($,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[V(U(t.cetus_amount,9),9)," CETUS "]})]})]}),e.jsx(_,{w:{base:"100%",lg:"auto"},justify:"center",children:e.jsx(H,{onClick:()=>{p||o||b(!!n)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:p||o,color:n?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:n?"Claim":"Cancel"})})]})})}function nt(){const{fetchAccountBalance:s}=N(),{signAndExecuteTransaction:t}=Z(),{xCetusSdk:n}=K(),{veNFT:i}=P(),[a,r]=g.useState(!1),{fetchVeNFTDividendInfo:x}=be();return{handleClaimReward:async p=>{if(i){r(!0),console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:23 ~ handleClaimReward ~ rewardList:",p);try{const u=n.XCetusModule.redeemDividendV3Payload(i.id,p),o=await t(u,{},{useDevInspect:!0,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:Q.xCETUSClaimStakingRwewards,txbParams:{veNftId:i.id,rewardList:p}}});r(!1),o&&(s(),x(i.id))}catch(u){console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:40 ~ handleClaimReward ~ error:",u)}finally{r(!1)}}},claimRewardLoading:a}}function st(s){const{myShare:t,cetusApr:n,totalRewardValue:i,summaryRewardList:a,rewardList:r}=s,{claimRewardLoading:x,handleClaimReward:l}=nt(),{currentAccount:p}=F(),{veNFTLoading:u}=P(),{isApp:o}=q();return e.jsxs(j,{w:"100%",alignItems:"start",p:{base:"4px 8px 8px",lg:"4px 16px 16px"},gap:"16px",children:[e.jsx(c,{fontSize:"16px",color:"text_caption",children:"xCETUS Staking Rewards"}),e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsx(E,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(_,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsxs(_,{gap:"4px",children:[e.jsx(c,{color:"primary_gray",children:"est.APR"}),e.jsx(Ve,{placement:o?"bottom-end":"top-start",maxW:{base:"calc(100vw - 16px)",lg:"unset"},tooltip:o?e.jsxs(re,{as:"div",lineHeight:"20px",children:[e.jsx(c,{as:"span",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders. "}),e.jsx(c,{as:"span",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100% "}),e.jsx(c,{as:"span",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}):e.jsxs(j,{alignItems:"start",children:[e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders."}),e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100%"}),e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}),children:e.jsx(re,{children:e.jsx(Ue,{xlinkHref:"#icon-icon_tips"})})})]}),e.jsx(ue,{isLoaded:n!=="0",children:e.jsxs(c,{fontSize:"18px",color:"text_caption",children:["≈",le(n,2)]})})]})}),e.jsx(E,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(_,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsx(c,{color:"primary_gray",children:"Your Share"}),e.jsx(ue,{isLoaded:!u,children:e.jsx(c,{fontSize:"18px",color:"text_caption",children:t!=="--"?`≈${t}`:t})})]})})]}),"(",e.jsx(E,{borderRadius:"12px",w:"100%",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(j,{h:"100%",w:"100%",gap:{base:"20px",lg:"14px"},children:[e.jsxs(_,{w:"100%",justifyContent:"space-between",children:[e.jsx(c,{color:"primary_gray",children:"Pending Yield"}),e.jsxs(_,{justifyContent:"end",gap:"12px",children:[e.jsx(c,{fontSize:"18px",color:"text_caption",children:p?ie(i,2):"--"}),!o&&a.length>0&&e.jsx(H,{onClick:()=>{x||l(r)},variant:"outline",h:"28px",w:"80px",borderRadius:"8px",fontSize:"14px",disabled:x,isLoading:x,bg:"button_ghost_bg",children:"Claim"})]})]}),a.length>0&&e.jsx(J,{w:"100%",flexDir:{base:"column",lg:"row"},align:"center",justify:{base:"center",lg:"flex-start"},gap:{base:"20px",lg:"8px"},children:a.map(d=>e.jsx(at,{info:d},d.coin_type))}),o&&a.length>0&&e.jsx(H,{onClick:()=>{x||l(r)},variant:"outline",h:"40px",w:"168px",borderRadius:"12px",fontSize:"14px",disabled:x,isLoading:x,bg:"button_ghost_bg",children:"Claim"})]})}),")"]})}function at(s){const{info:t}=s,{tokenInfo:n}=He(t.coin_type),{isApp:i}=q();return i?e.jsx(xe,{label:e.jsxs(_,{children:[e.jsx($,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(c,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(j,{alignItems:"flex-end",gap:"4px",children:[e.jsx(c,{color:"text_caption",children:t.amount}),Y(t.value).gt("0")&&e.jsx(c,{children:ie(t.value,2)})]})}):e.jsx(Se,{wrapStyle:{gap:"10px",flex:1,alignItems:"flex-start"},title:e.jsxs(_,{children:[e.jsx($,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(c,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(j,{alignItems:"flex-start",gap:"4px",children:[e.jsx(c,{color:"text_caption",children:t.amount}),Y(t.value).gt("0")&&e.jsx(c,{children:ie(t.value,2)})]})})}function ot(s){const{totalAmount:t,availableAmount:n,redeemingAmount:i,isLoading:a}=s,{currentAccount:r}=F();return q(),e.jsxs(j,{w:{base:"100%",lg:"100%"},gap:{base:"20px",lg:"28px"},zIndex:"100",mt:{base:"20px",lg:"32px"},children:[e.jsxs(j,{w:"100%",h:"140px",gap:"20px",borderRadius:"20px",bg:{base:"none",lg:"center / cover no-repeat url('/images/xcetus_banner.png')"},align:"center",justify:"center",children:[e.jsxs(c,{h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_caption",children:["Manage your"," ",e.jsx(c,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_green",children:"CETUS"})," ","and"," ",e.jsx(c,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"primary",children:"xCETUS"})]}),e.jsx(H,{h:"28px",w:"132px",fontSize:"14px",fontWeight:"600",variant:"outline",bg:"transparent",borderRadius:"8px",borderColor:"text_highlight",color:"text_highlight",onClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")},children:"Learn more"})]}),e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:{base:"100%",lg:"80%"},justifyContent:{base:"space-between",lg:"space-around"},align:{base:"flex-start",lg:"center"},gap:{base:"16px",lg:"40px"},children:[e.jsx(ae,{isLoading:a,icon:"/images/icon_my_total_xWHALE@2x.png",title:"My total xCETUS",amount:r?V(U(t,9),9).toString():"--",w:{base:"28px",lg:"42px"},h:{base:"24px",lg:"36px"},wrapStyle:{gap:"2px"}}),e.jsx(ae,{isLoading:a,icon:"/images/icon_available_xWHALE@2x.png",title:"Available xCETUS",amount:r?V(U(n,9),9).toString():"--",w:{base:"24px",lg:"36px"},h:{base:"24px",lg:"36px"}}),e.jsx(ae,{isLoading:a,icon:"/images/icon_redeeming_xWHALE@2x.png",title:"Redeeming xCETUS",amount:r?V(U(i,9),9).toString():"--",w:{base:"26px",lg:"38px"},h:{base:"26px",lg:"38px"}})]})]})}function ae(s){const{isLoading:t,icon:n,title:i,amount:a,w:r,h:x,wrapStyle:l={}}=s,{isApp:p}=q();return p?e.jsx(xe,{label:e.jsxs(_,{...l,children:[e.jsx(fe,{src:n,w:r,h:x}),e.jsx(c,{children:i})]}),value:a,isLoading:t,labelStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"14px"}}):e.jsxs(_,{gap:"6px",alignItems:"center",w:{base:"100%",lg:"auto"},...l,children:[e.jsx(fe,{src:n,w:r,h:x}),e.jsx(Se,{wrapStyle:{gap:"8px"},title:i,titleStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"16px",fontWeight:"500"},value:a,isLoading:t})]})}function rt(){const{xCetusSdk:s}=K(),{currentAccount:t}=F(),{fetchAccountBalance:n,isLoading:i}=N(),{fetchTokenPrices:a}=Pe(),{lockCetusList:r,veNFTLoading:x,lockCetusListLoading:l,clearData:p,owner:u,veNFT:o,XCetusManager:d,setXCetusManager:b,setDividendManager:w,setPhaseDividendInfoMap:y,phaseDividendInfoMap:C}=P(),{nextStartTime:T,currentPeriod:f,calculateCurrPeriod:I}=Xe(),{summaryRewardList:M,rewardList:v,totalRewardValue:D}=Be(f),{fetchVeNFTDividendInfo:z}=be(),R=async m=>{try{const k=await s.XCetusModule.getXcetusManager(m);k&&b(k)}catch(k){console.log("🚀 ~ fetchXCetusManager ~ error:",k)}},G=async m=>{try{const k=await s.XCetusModule.getPhaseDividendInfo(m.toString());if(k)y(k);else{const _e=(m-1).toString();if(!C[_e]){const de=await s.XCetusModule.getPhaseDividendInfo(m.toString());de&&y(de)}}}catch(k){console.log("🚀 ~ fetchXCetusManager ~ error:",k)}},W=async m=>{try{const k=await s.XCetusModule.getDividendManager(m);k&&w(k)}catch(k){console.log("🚀 ~ fetchXCetusManager ~ error:",k)}},{fetchOwnerVeNFT:h}=ce(),A=g.useMemo(()=>{if(o&&t&&!l){const m=he.getAvailableXCetus(o,r);if(ne(m).gte(0))return m}return"0"},[o==null?void 0:o.xcetus_balance,r]),B=g.useMemo(()=>{if(o){const m=ne(o.xcetus_balance).sub(A);if(m.gte(0))return m.toFixed(0)}return"0"},[o==null?void 0:o.xcetus_balance,A]),L=g.useMemo(()=>{if(d&&o){const m=ne(o.xcetus_balance).div(d.treasury).mul(100);return ne(m).lt(.01)?"<0.01%":le(m.toString(),3)}return t?"0%":"--"},[d==null?void 0:d.treasury,o==null?void 0:o.xcetus_balance]),S=g.useMemo(()=>{if(f){let m=C[f.toString()];return m===void 0&&(m=C[(f-1).toString()]),m}},[C,f]),{cetusApr:X}=Fe(S,d==null?void 0:d.treasury);return g.useEffect(()=>{if(S){const m=S.bonus_types.map(k=>Oe(k,!1));m&&(m.push("0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),a(m))}},[S==null?void 0:S.id]),g.useEffect(()=>{f&&f>0&&G(f)},[f]),g.useEffect(()=>{o&&z(o.id)},[o==null?void 0:o.id]),{fetchOwnerVeNFT:h,fetchAccountBalance:n,fetchXCetusManager:R,fetchDividendManager:W,fetchVeNFTDividendInfo:z,veNFTLoading:x,lockCetusListLoading:l,redeemingXCetusAmount:B,availableXCetusAmount:A,veNFT:o,myShare:L,nextStartTime:T,cetusApr:X,summaryRewardList:M,rewardList:v,totalRewardValue:D,lockCetusList:r,calculateCurrPeriod:I}}const se=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function _t(){const{currentAccount:s}=F(),{fetchOwnerVeNFT:t,fetchXCetusManager:n,fetchVeNFTDividendInfo:i,availableXCetusAmount:a,veNFT:r,veNFTLoading:x,lockCetusListLoading:l,redeemingXCetusAmount:p,fetchDividendManager:u,myShare:o,nextStartTime:d,cetusApr:b,summaryRewardList:w,totalRewardValue:y,lockCetusList:C,rewardList:T,calculateCurrPeriod:f}=rt(),{dividendManager:I}=P(),{fetchOwnerLockCetusList:M}=ee(),[v,D]=g.useState("Get xCETUS"),{fetchAccountBalance:z}=N();Ne({onRpcChange:()=>{n(!1),u(!1),s&&(t(s.address,!0),M(s.address),z())}}),g.useEffect(()=>{s&&(t(s.address,!0),M(s.address))},[s==null?void 0:s.address]),g.useEffect(()=>{n(!1),u(!1),s!=null&&s.address&&z()},[]);const[R,G]=g.useState("#icon-a-icon_trade"),W=()=>{G("#icon-icon_swap1")},h=()=>{G("#icon-a-icon_trade")},A=()=>{var S;const L=(S=se==null?void 0:se.find(X=>(X==null?void 0:X.value)!==v))==null?void 0:S.value;L&&D(L)},{isApp:B}=q();return e.jsxs(j,{gap:"0px",w:"100%",pos:"relative",sx:B?{backgroundImage:"url('/images/xcetus_h5_bg.png')",backgroundPosition:"center 256px",backgroundRepeat:"no-repeat",backgroundSize:"375px 200px"}:{},children:[e.jsx(ot,{totalAmount:(r==null?void 0:r.xcetus_balance)||"0",availableAmount:a,redeemingAmount:p,isLoading:l||x}),e.jsxs(J,{flexDir:{base:"column-reverse",lg:"row"},mt:{base:"118px",lg:"28px"},zIndex:100,w:"100%",gap:"16px",alignItems:"start",justifyContent:"space-between",children:[e.jsxs(j,{w:"60%",gap:"16px",minW:{base:"100%",lg:"600px"},children:[e.jsx(E,{p:"0px",borderRadius:"16px",w:"100%",children:e.jsxs(j,{w:"100%",gap:"16px",children:[e.jsx(Je,{nextStartTime:d||0,refresh:()=>{r&&i(r.id),u(!0),I&&f(I)}}),e.jsx(st,{myShare:o.toString(),cetusApr:b,totalRewardValue:y,summaryRewardList:w,rewardList:T})]})}),C.length>0&&e.jsx(et,{lockCetusList:C})]}),e.jsxs(j,{w:"40%",gap:"8px",minW:{base:"100%",lg:"380px"},children:[e.jsx(ge,{type:"borderTab",wrapStyle:{w:"100%",h:"60px"},itemStyle:{w:"50%",fontSize:"16px"},tabList:se,currentTab:v,handleChangeTab:L=>{D(L==null?void 0:L.value)}}),v==="Get xCETUS"&&e.jsx($e,{availableXCetusAmount:a,onIconClick:A,iconParams:{xlinkHref:R,svgFill:"text_caption",transform:R==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:R==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:W,onMouseLeave:h}}),v==="Redeem CETUS"&&e.jsx(qe,{availableXCetusAmount:U(a,9),onIconClick:A,iconParams:{xlinkHref:R,svgFill:"text_caption",transform:R==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:R==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:W,onMouseLeave:h}})]})]})]})}export{_t as default};

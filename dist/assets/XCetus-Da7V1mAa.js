import{r as f,a1 as B,R as Y,bA as U,a9 as O,d as $,a8 as oe,j as e,ad as _e,ae as ye,af as Te,ag as ve,ah as ke,ai as Re,aj as Ae,V as _,H as T,av as Le,T as c,$ as V,aJ as z,a6 as de,B as ae,k as fe,bB as Me,bC as Ee,bD as Ie,bE as De,W as I,bp as ie,C as ee,bF as ge,b as K,m as J,g as G,Y as W,I as ze,S as pe,aA as re,an as ue,a4 as Ue,aO as te,aC as Pe}from"./index-8zEobv_C.js";import{M as q}from"./msafe-oYBkW7LJ.js";import{u as H}from"./useAccountBalance-MOm8YR3h.js";import{u as he}from"./useTokenBalance-Cv7UaRfD.js";import{u as Q}from"./useTransaction-hzHCwfqB.js";import{u as Z,a as le,b as me,c as Oe,d as Xe,e as Be}from"./useXCetusHelper-Bb8je4OF.js";import{T as be}from"./TradeInputGroup-CwnoIKAN.js";import{H as Fe}from"./HighlightText-CqFsG_La.js";import{H as ce}from"./HTextLabelBox-B6-CM_oa.js";import{V as Ce}from"./VTextLabelBox-B_lpl3e3.js";import{C as We}from"./CetusTooltip-DpTNWNg7.js";import{u as Ve}from"./useToken-DgcnCKyw.js";import{u as He}from"./useRpcListener-CIXvvHWB.js";import"./_getAllKeysIn-Dkb1ARgz.js";import"./usePreviousValue-DxoB5pWj.js";const Se=(a,t,n="seconds")=>{const r=()=>{const l=a-new Date().getTime();if(l<=0)return{years:0,months:0,days:0,hours:0,minutes:0,seconds:0};const d=Math.floor(l/1e3%60),s=Math.floor(l/1e3/60%60),p=Math.floor(l/(1e3*60*60)%24),u=Math.floor(l/(1e3*60*60*24)%30),C=Math.floor(l/(1e3*60*60*24*30)%12),S=Math.floor(l/(1e3*60*60*24*365));return n==="days"?{years:0,months:0,days:u+C*30+S*365,hours:p,minutes:s,seconds:d}:n==="months"?{years:0,months:C+S*12,days:u,hours:p,minutes:s,seconds:d}:{years:S,months:C,days:u,hours:p,minutes:s,seconds:d}},[o,i]=f.useState(r());return f.useEffect(()=>{const x=setInterval(()=>{const l=r();i(l),l.years===0&&l.months===0&&l.days===0&&l.hours===0&&l.minutes===0&&l.seconds===0&&(clearInterval(x),t&&t())},1e3);return()=>clearInterval(x)},[a]),o};function Ne(){const{fetchAccountBalance:a}=H(),{fetchOwnerLockCetusList:t}=Z(),{signAndExecuteTransaction:n}=Q(),{currentAccount:r}=B(),{fetchOwnerVeNFT:o}=le(),{xCetusSdk:i}=Y(),{veNFT:x}=U(),[l,d]=f.useState(""),[s,p]=f.useState(""),{balanceInfo:u}=he(O.cetus_coin),C=m=>{d(m),p(m)},[S,j]=f.useState(!1),v=async()=>{j(!0);const m={venft_id:x==null?void 0:x.id,amount:oe(l,9).toFixed(0)},D=await i.XCetusModule.convertPayload(m),L=await n(D,{getShowInfo:k=>{const M=`Converting ${l} CETUS to ${l} xCETUS`,P={modalTitleText:"Convert",modalDescriptionText:M,toastDescriptionContent:M};if(k==="success"){const R=M.replace("Converting","Converted");P.modalDescriptionText=R,P.toastDescriptionContent=R}return P}},{msafeParams:{action:q.xCETUSConvert,txbParams:m}});j(!1),L&&(r&&o(r==null?void 0:r.address,!0),d(""),p(""),a(),t())},b=f.useMemo(()=>{const m={text:"Convert",disabled:!1};return r!=null&&r.address?+l?(+l&&$(l).gt((u==null?void 0:u.balanceFormat)||0)&&(m.disabled=!0,m.text="Insufficient CETUS Balance"),m):(m.text="Enter an amount",m.disabled=!0,m):(m.text="Connect Wallet",m.disabled=!1,m)},[u==null?void 0:u.balanceFormat,r==null?void 0:r.address,l]);return{inputAmountFrom:l,inputAmountTo:s,handleInputChange:C,balanceInfoFrom:u,convertLoading:S,btnText:b.text,btnDisabled:b.disabled,handleConvertClick:v}}function je(a){const{isOpen:t,onClose:n,onSubmitClick:r}=a,{setShowConvertModel:o}=U(),[i,x]=f.useState(!1);return e.jsxs(_e,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(ye,{}),e.jsxs(Te,{children:[e.jsx(ve,{children:e.jsx(ke,{fontWeight:"500",fontSize:"16px"})}),e.jsx(Re,{}),e.jsx(Ae,{textAlign:"center",p:"0px",children:e.jsxs(_,{w:"100%",gap:"20px",p:"20px",pb:"90px",pos:"relative",children:[e.jsx(Fe,{text_color:"text_caption",text_size:"14px",text:` Please note that after conversion, if you want to convert xCETUS back to CETUS, a vesting period will be applied & different vesting
              durations correspond to different redeem ratios. Learn more`,keywords:["Learn more"],onKeywordClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")}}),e.jsxs(T,{children:[e.jsx(Le,{checked:i,onClick:()=>{x(!i)}}),e.jsx(c,{color:"text_caption",children:"Do not remind again."})]}),e.jsx(V,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{o(!i),r()},children:"Convert"})]})})]})]})}function Ge(a){const{availableXCetusAmount:t,iconParams:n,onIconClick:r}=a,{currentAccount:o,onWalletModal:i}=B(),{inputAmountFrom:x,inputAmountTo:l,handleInputChange:d,balanceInfoFrom:s,btnText:p,btnDisabled:u,handleConvertClick:C,convertLoading:S}=Ne(),{showConvertModel:j}=U(),[v,b]=f.useState(!1);return e.jsxs(_,{w:"100%",gap:"8px",children:[e.jsx(be,{onClick:r,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:(s==null?void 0:s.balanceFormat)||"",value:x,amountValue:"",loading:!1,onChange:m=>{d(m)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:z(t,9),value:l,half:!1,max:!1,amountValue:"",onChange:m=>{d(m)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},iconParams:n}),e.jsx(V,{w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:u||S,isLoading:S,onClick:()=>{console.log(o,j,"showConvertModel"),o?j?b(!0):C():i(!0)},children:p}),v&&e.jsx(je,{isOpen:v,onClose:()=>{b(!1)},onSubmitClick:()=>{b(!1),C()}})]})}function $e(a){const{fetchAccountBalance:t}=H(),{fetchOwnerLockCetusList:n}=Z(),{signAndExecuteTransaction:r}=Q(),{currentAccount:o}=B(),{fetchOwnerVeNFT:i}=le(),{xCetusSdk:x}=Y(),{veNFT:l}=U(),[d,s]=f.useState(""),[p,u]=f.useState(""),[C,S]=f.useState(180),[j,v]=f.useState(""),[b,m]=f.useState(!0),{balanceInfo:D}=he(O.cetus_coin),L=(h,E)=>{m(E),E?s(h):u(h),M(h,E,C)},k=h=>{S(h),M(b?d:p,b,h)},M=async(h,E,X)=>{if(+h){const y=oe(h,9);if(E){const A=await x.XCetusModule.redeemNum(y,X);u(z(A.amount_out,9)),v($(A.percent).mul(100).toFixed(2,de.ROUND_DOWN))}else{const A=await x.XCetusModule.reverseRedeemNum(y,X);s(z(A.amount_out,9)),v($(A.percent).mul(100).toFixed(2,de.ROUND_DOWN))}}else s(""),u(""),v("")},[P,R]=f.useState(!1),N=async()=>{if(!l)return;R(!0);const h={venft_id:l.id,amount:oe(d,9).toFixed(0),lock_day:C},E=x.XCetusModule.redeemLockPayload(h),X=await r(E,{getShowInfo:y=>{const A=`Redeeming ${d} xCETUS to ${p} CETUS`,g={modalTitleText:"Redeem",modalDescriptionText:A,toastDescriptionContent:A};if(y==="success"){const w=A.replace("Redeeming","Redeemed");g.modalDescriptionText=w,g.toastDescriptionContent=w}return g}},{msafeParams:{action:q.xCETUSRedeemLock,txbParams:h}});R(!1),X&&(o&&i(o==null?void 0:o.address,!0),s(""),u(""),t(),n())},F=f.useMemo(()=>{const h={text:"Redeem",disabled:!1};return o!=null&&o.address?+d?(+d&&$(d).gt(a||0)&&(h.disabled=!0,h.text="Insufficient xCETUS Balance"),h):(h.text="Enter an amount",h.disabled=!0,h):(h.text="Connect Wallet",h.disabled=!1,h)},[a,o==null?void 0:o.address,d]);return{inputAmountFrom:d,inputAmountTo:p,handleInputChange:L,balanceInfoTo:D,convertLoading:P,btnText:F.text,btnDisabled:F.disabled,handleConvertClick:N,day:C,handleDayChange:k,percent:j}}function Ye(a){const{day:t,onChange:n}=a,r=f.useMemo(()=>`${t}D`,[t]),o=[{label:"15D"},{label:"30D"},{label:"90D"},{label:"180D"}];return e.jsxs(ae,{children:[e.jsxs(T,{w:"100%",justifyContent:"space-between",m:"10px 0",children:[e.jsxs(c,{fontSize:"16px",color:"text_caption",whiteSpace:"nowrap",children:[t," Days"]}),e.jsx(fe,{type:"outlineTab",tabList:o,currentTab:r,handleChangeTab:i=>{i.label==="MAX"?n(100):n(i.label.replace("D",""))},wrapStyle:{flex:"1",maxW:"300px",h:"32px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),e.jsxs(Me,{"aria-label":"slider-ex-1",min:15,max:180,focusThumbOnChange:!1,value:Number(t),onChange:i=>n(i),children:[e.jsx(Ee,{h:"8px",children:e.jsx(Ie,{h:"4px"})}),e.jsx(De,{})]})]})}function Ke(a){const{availableXCetusAmount:t,iconParams:n,onIconClick:r}=a,{currentAccount:o,onWalletModal:i}=B(),{inputAmountFrom:x,inputAmountTo:l,handleInputChange:d,balanceInfoTo:s,btnText:p,btnDisabled:u,handleConvertClick:C,day:S,handleDayChange:j,percent:v,convertLoading:b}=$e(t),{showConvertModel:m}=U(),[D,L]=f.useState(!1);return e.jsxs(_,{w:"100%",gap:"8px",children:[e.jsx(be,{onClick:r,borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px"},title:"From",balance:t,value:x,amountValue:"",loading:!1,onChange:k=>{d(k,!0)},selectable:!1,placeholder:"0.0",token:O.x_cetus_coin},to:{wrapStyle:{borderRadius:"12px"},title:"To",balance:(s==null?void 0:s.balanceFormat)||"",value:l,half:!1,max:!1,amountValue:"",onChange:k=>{d(k,!1)},selectable:!1,placeholder:"0.0",token:O.cetus_coin},iconParams:n}),e.jsxs(I,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(c,{mb:"16px",color:"primary_gray",children:"Vesting duration"}),e.jsx(Ye,{day:S,onChange:k=>{j(Number(k))}})]}),e.jsx(I,{borderRadius:"12px",p:"0px",children:e.jsxs(_,{w:"100%",gap:"20px",children:[e.jsx(V,{mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",disabled:u||b,isLoading:b,onClick:()=>{o?m?L(!0):C():i(!0)},children:p}),+v&&e.jsx(T,{w:"100%",pb:"20px",pl:"16px",pr:"16px",children:e.jsx(ce,{label:"Redeem ratio",labelStyle:{fontSize:"14px"},value:ie(v),valueStyle:{fontSize:"14px"}})})]})}),D&&e.jsx(je,{isOpen:D,onClose:()=>{L(!1)},onSubmitClick:()=>{L(!1),C()}})]})}function Je({nextStartTime:a,refresh:t}){const{days:n,hours:r,minutes:o,seconds:i}=Se(a*1e3,t);return e.jsxs(_,{w:"100%",gap:"16px",borderRadius:"16px",m:"-1px",p:{base:"24px 12px",lg:"24px"},sx:{backgroundImage:"url('/images/img_xcetus@2x.png')",backgroundPosition:"top center",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:[e.jsx(c,{fontSize:"16px",color:"text_caption",children:"Convert CETUS to xCETUS to start earning"}),e.jsx(c,{children:"Reward distribution in "}),e.jsxs(T,{children:[e.jsx(I,{borderRadius:"4px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ee,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[n,"d"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(I,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ee,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[r,"h"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(I,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ee,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[o,"m"]})})}),e.jsx(c,{fontSize:"16px",textColor:"text_caption",children:":"}),e.jsx(I,{borderRadius:"4px",w:"40px",h:"40px",p:"0px",bg:"block_color",borderColor:"transparent",children:e.jsx(ee,{w:"40px",h:"40px",textAlign:"center",children:e.jsxs(c,{fontSize:"16px",textColor:"text_caption",children:[i,"s"]})})})]})]})}function qe(){const{fetchAccountBalance:a}=H(),{fetchOwnerLockCetusList:t}=Z(),{signAndExecuteTransaction:n}=Q(),{xCetusSdk:r}=Y(),{veNFT:o}=U(),[i,x]=f.useState(!1);return{handleCancelOrder:async d=>{if(!o)return;x(!0);const s={venft_id:o.id,lock_id:d.id},p=r.XCetusModule.cancelRedeemPayload(s),u=await n(p,{},{msafeParams:{action:q.xCETUSCancelRedeem,txbParams:s}});x(!1),u&&(a(),t())},cancelOrderLoading:i}}function Qe(){const{fetchAccountBalance:a}=H(),{fetchOwnerLockCetusList:t}=Z(),{signAndExecuteTransaction:n}=Q(),{xCetusSdk:r}=Y(),{veNFT:o}=U(),[i,x]=f.useState(!1);return{handleClaimOrder:async d=>{if(x(!0),!o)return;const s={lock_id:d,venft_id:o.id},p=await r.XCetusModule.redeemPayload(s),u=await n(p,{},{useDevInspect:!1,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:q.xCETUSRedeem,txbParams:s}});x(!1),u&&(a(),t())},claimOrderLoading:i}}function Ze(a){const{lockCetusList:t}=a;return e.jsx(I,{p:{base:"16px 8px 8px",lg:"16px"},borderRadius:"16px",children:e.jsxs(_,{w:"100%",alignItems:"start",gap:"16px",children:[e.jsx(c,{fontSize:"16px",color:"text_caption",mt:"4px",children:"Vesting"}),t.map(n=>e.jsx(et,{info:n},n.id))]})})}function et(a){const{info:t}=a,[n,r]=f.useState(!1),{days:o,hours:i,minutes:x,seconds:l}=Se(t.locked_until_time*1e3,()=>{r(!0)},"days");f.useEffect(()=>{r(!ge.isLocked(t))},[]);const{cancelOrderLoading:d,handleCancelOrder:s}=qe(),{claimOrderLoading:p,handleClaimOrder:u}=Qe(),C=j=>{j?u(t.id):s(t)},{isApp:S}=K();return e.jsx(I,{borderRadius:"12px",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:"100%",justifyContent:{base:"flex-start",lg:"space-between"},gap:{base:"20px",lg:"8px"},children:[e.jsxs(_,{gap:{base:"20px",lg:"8px"},alignItems:"start",children:[e.jsxs(T,{gap:"6px",children:[e.jsxs(c,{color:"primary_gray",children:["Available ",n?"":" in"," "]}),!n&&e.jsxs(c,{color:"text_caption",children:[o,"d : ",i,"h : ",x,"m : ",l,"s"]})]}),S?e.jsxs(_,{w:"100%",align:"center",gap:"8px",children:[e.jsxs(T,{children:[e.jsx(G,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[W(z(t.xcetus_amount,9),9)," xCETUS"]})]}),e.jsx(c,{color:"text_caption",transform:"rotate(90deg)",children:"→"}),e.jsxs(T,{children:[e.jsx(G,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[W(z(t.cetus_amount,9),9)," CETUS "]})]})]}):e.jsxs(T,{children:[e.jsx(G,{imageUrl:O.x_cetus_coin.logo_url,p:"4px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[W(z(t.xcetus_amount,9),9)," xCETUS →"]}),e.jsx(G,{imageUrl:O.cetus_coin.logo_url,p:"2px",imgBoxStyle:{w:"24px",h:"24px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsxs(c,{color:"text_caption",children:[W(z(t.cetus_amount,9),9)," CETUS "]})]})]}),e.jsx(T,{w:{base:"100%",lg:"auto"},justify:"center",children:e.jsx(V,{onClick:()=>{d||p||C(!!n)},variant:"outline",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"14px",isLoading:d||p,color:n?"text_highlight":"primary_gray",bg:"button_ghost_bg",children:n?"Claim":"Cancel"})})]})})}function tt(){const{fetchAccountBalance:a}=H(),{signAndExecuteTransaction:t}=Q(),{xCetusSdk:n}=Y(),{veNFT:r}=U(),[o,i]=f.useState(!1),{fetchVeNFTDividendInfo:x}=me();return{handleClaimReward:async d=>{if(r){i(!0),console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:23 ~ handleClaimReward ~ rewardList:",d);try{const s=n.XCetusModule.redeemDividendV3Payload(r.id,d),p=await t(s,{},{useDevInspect:!0,txAction:"signAndExecuteTransactionBlock",msafeParams:{action:q.xCETUSClaimStakingRwewards,txbParams:{veNftId:r.id,rewardList:d}}});i(!1),p&&(a(),x(r.id))}catch(s){console.log("🚀 ~ file: useXCetusClaimRewardAction.ts:40 ~ handleClaimReward ~ error:",s)}finally{i(!1)}}},claimRewardLoading:o}}function nt(a){const{myShare:t,cetusApr:n,totalRewardValue:r,summaryRewardList:o,rewardList:i}=a,{claimRewardLoading:x,handleClaimReward:l}=tt(),{currentAccount:d}=B(),{veNFTLoading:s}=U(),{isApp:p}=K();return e.jsxs(_,{w:"100%",alignItems:"start",p:{base:"4px 8px 8px",lg:"4px 16px 16px"},gap:"16px",children:[e.jsx(c,{fontSize:"16px",color:"text_caption",children:"xCETUS Staking Rewards"}),e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsx(I,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(T,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsxs(T,{gap:"4px",children:[e.jsx(c,{color:"primary_gray",children:"est.APR"}),e.jsx(We,{placement:p?"bottom-end":"top-start",maxW:{base:"calc(100vw - 16px)",lg:"unset"},tooltip:p?e.jsxs(ae,{as:"div",lineHeight:"20px",children:[e.jsx(c,{as:"span",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders. "}),e.jsx(c,{as:"span",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100% "}),e.jsx(c,{as:"span",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}):e.jsxs(_,{alignItems:"start",children:[e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"The estimated APR of the current epoch for all xCETUS holders."}),e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_highlight",children:"APR = ($ Rewards of the upcoming week * 52) / $ Total xCETUS staked * 100%"}),e.jsx(c,{whiteSpace:"nowrap",fontSize:"12px",color:"text_caption",children:"Both real-time value of rewards and CETUS price will affect the APR fluctuation."})]}),children:e.jsx(ae,{children:e.jsx(ze,{xlinkHref:"#icon-icon_tips"})})})]}),e.jsx(pe,{isLoaded:n!=="0",children:e.jsxs(c,{fontSize:"18px",color:"text_caption",children:["≈",ie(n,2)]})})]})}),e.jsx(I,{h:{base:"60px",lg:"88px"},p:{base:"20px 12px",lg:"20px 24px"},borderRadius:"12px",w:"100%",bg:"bg_primary",children:e.jsxs(T,{h:"100%",w:"100%s",justifyContent:"space-between",children:[e.jsx(c,{color:"primary_gray",children:"Your Share"}),e.jsx(pe,{isLoaded:!s,children:e.jsx(c,{fontSize:"18px",color:"text_caption",children:t!=="--"?`≈${t}`:t})})]})})]}),"(",e.jsx(I,{borderRadius:"12px",w:"100%",p:{base:"20px 12px",lg:"20px 24px"},bg:"bg_primary",children:e.jsxs(_,{h:"100%",w:"100%",gap:{base:"20px",lg:"14px"},children:[e.jsxs(T,{w:"100%",justifyContent:"space-between",children:[e.jsx(c,{color:"primary_gray",children:"Pending Yield"}),e.jsxs(T,{justifyContent:"end",gap:"12px",children:[e.jsx(c,{fontSize:"18px",color:"text_caption",children:d?re(r,2):"--"}),!p&&o.length>0&&e.jsx(V,{onClick:()=>{x||l(i)},variant:"outline",h:"28px",w:"80px",borderRadius:"8px",fontSize:"14px",disabled:x,isLoading:x,bg:"button_ghost_bg",children:"Claim"})]})]}),o.length>0&&e.jsx(J,{w:"100%",flexDir:{base:"column",lg:"row"},align:"center",justify:{base:"center",lg:"flex-start"},gap:{base:"20px",lg:"8px"},children:o.map(u=>e.jsx(st,{info:u},u.coin_type))}),p&&o.length>0&&e.jsx(V,{onClick:()=>{x||l(i)},variant:"outline",h:"40px",w:"168px",borderRadius:"12px",fontSize:"14px",disabled:x,isLoading:x,bg:"button_ghost_bg",children:"Claim"})]})}),")"]})}function st(a){const{info:t}=a,{tokenInfo:n}=Ve(t.coin_type),{isApp:r}=K();return r?e.jsx(ce,{label:e.jsxs(T,{children:[e.jsx(G,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(c,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(_,{alignItems:"flex-end",gap:"4px",children:[e.jsx(c,{color:"text_caption",children:t.amount}),$(t.value).gt("0")&&e.jsx(c,{children:re(t.value,2)})]})}):e.jsx(Ce,{wrapStyle:{gap:"10px",flex:1,alignItems:"flex-start"},title:e.jsxs(T,{children:[e.jsx(G,{imageUrl:n==null?void 0:n.logo_url,imageStyle:{w:"24px",h:"24px"}}),e.jsx(c,{children:n==null?void 0:n.symbol})]}),value:e.jsxs(_,{alignItems:"flex-start",gap:"4px",children:[e.jsx(c,{color:"text_caption",children:t.amount}),$(t.value).gt("0")&&e.jsx(c,{children:re(t.value,2)})]})})}function ot(a){const{totalAmount:t,availableAmount:n,redeemingAmount:r,isLoading:o}=a,{currentAccount:i}=B();return K(),e.jsxs(_,{w:{base:"100%",lg:"100%"},gap:{base:"20px",lg:"28px"},zIndex:"100",mt:{base:"20px",lg:"32px"},children:[e.jsxs(_,{w:"100%",h:"140px",gap:"20px",borderRadius:"20px",bg:{base:"none",lg:"center / cover no-repeat url('/images/xcetus_banner.png')"},align:"center",justify:"center",children:[e.jsxs(c,{h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_caption",children:["Manage your"," ",e.jsx(c,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"text_green",children:"CETUS"})," ","and"," ",e.jsx(c,{as:"span",h:{base:"28px",lg:"32px"},fontSize:{base:"22px",lg:"32px"},lineHeight:{base:"28px",lg:"32px"},fontWeight:"600",fontStyle:"normal",color:"primary",children:"xCETUS"})]}),e.jsx(V,{h:"28px",w:"132px",fontSize:"14px",fontWeight:"600",variant:"outline",bg:"transparent",borderRadius:"8px",borderColor:"text_highlight",color:"text_highlight",onClick:()=>{window.open("https://cetus-1.gitbook.io/cetus-docs/tokenomics/xcetus","_blank")},children:"Learn more"})]}),e.jsxs(J,{flexDir:{base:"column",lg:"row"},w:{base:"100%",lg:"80%"},justifyContent:{base:"space-between",lg:"space-around"},align:{base:"flex-start",lg:"center"},gap:{base:"16px",lg:"40px"},children:[e.jsx(se,{isLoading:o,icon:"/images/icon_my_total_xWHALE@2x.png",title:"My total xCETUS",amount:i?W(z(t,9),9).toString():"--",w:{base:"28px",lg:"42px"},h:{base:"24px",lg:"36px"},wrapStyle:{gap:"2px"}}),e.jsx(se,{isLoading:o,icon:"/images/icon_available_xWHALE@2x.png",title:"Available xCETUS",amount:i?W(z(n,9),9).toString():"--",w:{base:"24px",lg:"36px"},h:{base:"24px",lg:"36px"}}),e.jsx(se,{isLoading:o,icon:"/images/icon_redeeming_xWHALE@2x.png",title:"Redeeming xCETUS",amount:i?W(z(r,9),9).toString():"--",w:{base:"26px",lg:"38px"},h:{base:"26px",lg:"38px"}})]})]})}function se(a){const{isLoading:t,icon:n,title:r,amount:o,w:i,h:x,wrapStyle:l={}}=a,{isApp:d}=K();return d?e.jsx(ce,{label:e.jsxs(T,{...l,children:[e.jsx(ue,{src:n,w:i,h:x}),e.jsx(c,{children:r})]}),value:o,isLoading:t,labelStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"14px"}}):e.jsxs(T,{gap:"6px",alignItems:"center",w:{base:"100%",lg:"auto"},...l,children:[e.jsx(ue,{src:n,w:i,h:x}),e.jsx(Ce,{wrapStyle:{gap:"8px"},title:r,titleStyle:{fontSize:"14px",color:"primary_gray"},valueStyle:{fontSize:"16px",fontWeight:"500"},value:o,isLoading:t})]})}function at(){const{xCetusSdk:a}=Y(),{currentAccount:t}=B(),{fetchAccountBalance:n}=H(),{fetchTokenPrices:r}=Ue(),{lockCetusList:o,veNFTLoading:i,lockCetusListLoading:x,clearData:l,owner:d,veNFT:s,XCetusManager:p,setXCetusManager:u,setDividendManager:C,setPhaseDividendInfoMap:S,phaseDividendInfoMap:j}=U(),{nextStartTime:v,currentPeriod:b,calculateCurrPeriod:m}=Oe(),{summaryRewardList:D,rewardList:L,totalRewardValue:k}=Xe(b),{fetchVeNFTDividendInfo:M}=me(),P=async g=>{try{const w=await a.XCetusModule.getXcetusManager(g);w&&u(w)}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},R=async g=>{try{const w=await a.XCetusModule.getPhaseDividendInfo(g.toString());if(w)S(w);else{const we=(g-1).toString();if(!j[we]){const xe=await a.XCetusModule.getPhaseDividendInfo(g.toString());xe&&S(xe)}}}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},N=async g=>{try{const w=await a.XCetusModule.getDividendManager(g);w&&C(w)}catch(w){console.log("🚀 ~ fetchXCetusManager ~ error:",w)}},{fetchOwnerVeNFT:F}=le(),h=f.useMemo(()=>{if(s&&t&&!x){const g=ge.getAvailableXCetus(s,o);if(te(g).gte(0))return g}return"0"},[s==null?void 0:s.xcetus_balance,o]),E=f.useMemo(()=>{if(s){const g=te(s.xcetus_balance).sub(h);if(g.gte(0))return g.toFixed(0)}return"0"},[s==null?void 0:s.xcetus_balance,h]),X=f.useMemo(()=>{if(p&&s){const g=te(s.xcetus_balance).div(p.treasury).mul(100);return te(g).lt(.01)?"<0.01%":ie(g.toString(),3)}return t?"0%":"--"},[p==null?void 0:p.treasury,s==null?void 0:s.xcetus_balance]),y=f.useMemo(()=>{if(b){let g=j[b.toString()];return g===void 0&&(g=j[(b-1).toString()]),g}},[j,b]),{cetusApr:A}=Be(y,p==null?void 0:p.treasury);return f.useEffect(()=>{if(y){const g=y.bonus_types.map(w=>Pe(w,!1));g&&(g.push("0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),r(g))}},[y==null?void 0:y.id]),f.useEffect(()=>{b&&b>0&&R(b)},[b]),f.useEffect(()=>{s&&M(s.id)},[s==null?void 0:s.id]),{fetchOwnerVeNFT:F,fetchAccountBalance:n,fetchXCetusManager:P,fetchDividendManager:N,fetchVeNFTDividendInfo:M,veNFTLoading:i,lockCetusListLoading:x,redeemingXCetusAmount:E,availableXCetusAmount:h,veNFT:s,myShare:X,nextStartTime:v,cetusApr:A,summaryRewardList:D,rewardList:L,totalRewardValue:k,lockCetusList:o,calculateCurrPeriod:m}}const ne=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function wt(){const{currentAccount:a}=B(),{fetchOwnerVeNFT:t,fetchXCetusManager:n,fetchVeNFTDividendInfo:r,availableXCetusAmount:o,veNFT:i,veNFTLoading:x,lockCetusListLoading:l,redeemingXCetusAmount:d,fetchDividendManager:s,myShare:p,nextStartTime:u,cetusApr:C,summaryRewardList:S,totalRewardValue:j,lockCetusList:v,rewardList:b,calculateCurrPeriod:m}=at(),{dividendManager:D}=U(),{fetchOwnerLockCetusList:L}=Z(),[k,M]=f.useState("Get xCETUS"),{fetchAccountBalance:P}=H();He({onRpcChange:()=>{n(!1),s(!1),a&&(t(a.address,!0),L(a.address),P())}}),f.useEffect(()=>{a&&(t(a.address,!0),L(a.address))},[a==null?void 0:a.address]),f.useEffect(()=>{n(!1),s(!1),a!=null&&a.address&&P()},[]);const[R,N]=f.useState("#icon-a-icon_trade"),F=()=>{N("#icon-icon_swap1")},h=()=>{N("#icon-a-icon_trade")},E=()=>{var A;const y=(A=ne==null?void 0:ne.find(g=>(g==null?void 0:g.value)!==k))==null?void 0:A.value;y&&M(y)},{isApp:X}=K();return e.jsxs(_,{gap:"0px",w:"100%",pos:"relative",sx:X?{backgroundImage:"url('/images/xcetus_h5_bg.png')",backgroundPosition:"center 256px",backgroundRepeat:"no-repeat",backgroundSize:"375px 200px"}:{},children:[e.jsx(ot,{totalAmount:(i==null?void 0:i.xcetus_balance)||"0",availableAmount:o,redeemingAmount:d,isLoading:l||x}),e.jsxs(J,{flexDir:{base:"column-reverse",lg:"row"},mt:{base:"118px",lg:"28px"},zIndex:100,w:"100%",gap:"16px",alignItems:"start",justifyContent:"space-between",children:[e.jsxs(_,{w:"60%",gap:"16px",minW:{base:"100%",lg:"600px"},children:[e.jsx(I,{p:"0px",borderRadius:"16px",w:"100%",children:e.jsxs(_,{w:"100%",gap:"16px",children:[e.jsx(Je,{nextStartTime:u||0,refresh:()=>{i&&r(i.id),s(!0),D&&m(D)}}),e.jsx(nt,{myShare:p.toString(),cetusApr:C,totalRewardValue:j,summaryRewardList:S,rewardList:b})]})}),v.length>0&&e.jsx(Ze,{lockCetusList:v})]}),e.jsxs(_,{w:"40%",gap:"8px",minW:{base:"100%",lg:"380px"},children:[e.jsx(fe,{type:"borderTab",wrapStyle:{w:"100%",h:"60px"},itemStyle:{w:"50%",fontSize:"16px"},tabList:ne,currentTab:k,handleChangeTab:y=>{M(y==null?void 0:y.value)}}),k==="Get xCETUS"&&e.jsx(Ge,{availableXCetusAmount:o,onIconClick:E,iconParams:{xlinkHref:R,svgFill:"text_caption",transform:R==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:R==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:F,onMouseLeave:h}}),k==="Redeem CETUS"&&e.jsx(Ke,{availableXCetusAmount:z(o,9),onIconClick:E,iconParams:{xlinkHref:R,svgFill:"text_caption",transform:R==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:R==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:F,onMouseLeave:h}})]})]})]})}export{wt as default};

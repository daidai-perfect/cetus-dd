import{a,j as e,V as k,C as me,H as j,S as He,p as X,T as _,f as Xe,R as he,at as D,au as v,av as qe,aw as Ie,ax as $,ay as et,aa as tt,ar as Rt,W as st,X as nt,Y as rt,Z as it,a7 as At,$ as ot,a0 as at,q as ie,O as De,a9 as Nt}from"./vendor-BFGDaAdA.js";import{k as U,B as q,a as oe,Q as zt,v as xe,o as Pe,Z as Ft,l as We,d as B,E as $e,f as ye,J as Bt,G as de,C as ct,I as lt,V as Ve,aj as Ht,N as Dt,x as Wt,j as $t}from"./index-BPmJ2jpN.js";import{P as ge}from"./Pagination-RR4bANG8.js";import{N as G}from"./NoData-DtiZhmrM.js";import{u as Te,C as je,O as Ce,P as ae,F as fe,E as be,S as pt,L as dt,a as xt,b as Vt,c as Yt}from"./useGetLimitOrderHistory-B2Bf7H6d.js";import{b as ut}from"./FarmsTable-MehzxTbL.js";import{A as Gt}from"./aggregator-2j2pAfwJ.js";import{u as Ye}from"./useTransaction-BEZ42Yzm.js";import{A as Ge}from"./useSwapHelper-BFNYB1_4.js";import{u as mt}from"./useAccountBalance-WZgcKaPa.js";import{u as Qt}from"./useToken-C2f3q8yb.js";import{u as Qe}from"./useTokenBalance-WptRK2XT.js";import{u as Ut}from"./useInsufficientBalanceToast-Jp69YGOU.js";import{u as Zt}from"./useFindBestRouting-C0FiqahY.js";import{T as Jt}from"./TradeInputGroup-ZleztP1o.js";import{W as Kt}from"./WarningTokenTipModal-B3yibDc_.js";import{M as Xt,C as qt}from"./MenuDropBlock-BuXGGLNX.js";import{T as It,a as es}from"./TradeTab-DzLsgyZh.js";import"./index-D4tNEZjH.js";import{u as ts}from"./global-yjM38D_F.js";import"./swap-D3PlwPKh.js";import"./AggregatorModal-Bq0NuDI_.js";import"./FreshProgressV2-DkooO11p.js";import{T as ss}from"./TradeConfirmAmountInfo-BT7jk6QL.js";import{I as ue}from"./InputBox-Cs7zlVAb.js";import{LimitPriceChart as ns}from"./LimitPriceChart-oiKPzOE4.js";import{u as rs}from"./useInterval-BQqGpXj5.js";import{u as is}from"./useRpcListener-BOXfllsv.js";import{R as Ue}from"./RefreshButton-BOgQecBu.js";import"./IconText-CUnr4PU4.js";import"./SingleTokenInfo-CgvLp_Sh.js";import"./CopyButton-RUcrU_X2.js";import"./RangeValue-BqG1z_V1.js";import"./usePositionList-CTKl_07Q.js";import"./useFavoritePool-BrmOgNO0.js";import"./useGetPoolList-CUJyOk7M.js";import"./useWrapPoolData-9pXb8-BW.js";import"./index-gLcGr8Aw.js";import"./ExpendItem-fcr3Y3EF.js";import"./msafe-oYBkW7LJ.js";import"./PositionStatus-2oFeK-h6.js";import"./CoinPairInfo-CQyXMF--.js";import"./PoweredByHaedal-Bke0Bj0w.js";import"./useTrack-BDPSDLeN.js";import"./useSigner-BVdami60.js";import"./_getAllKeysIn-Bbl41Vsp.js";import"./CheckBox-DuDEoJH1.js";import"./IconBg-C_qGsuiN.js";import"./TooltipIcon-BDSnzQ8w.js";import"./LoadingChart-46yMfTnx.js";import"./usePreviousValue-DoVr3Y3V.js";function Ze(){const{currentAccount:t,onWalletModal:n}=U(),{myOrderList:i,orderListLoading:u}=Te(),h=10,[l,d]=a.useState([]),[m,c]=a.useState(0),[p,g]=a.useState(1);return a.useEffect(()=>{if((i==null?void 0:i.length)>0){c(i==null?void 0:i.length);const s=(p-1)*h,r=s+h;d(i.slice(s,r))}},[p,i]),e.jsx(k,{w:"100%",children:t!=null&&t.address?u?e.jsx(q,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(k,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((s,r)=>e.jsx(ht,{},r))})}):i.length===0?e.jsx(G,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"}):e.jsxs(q,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(l==null?void 0:l.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(k,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:l==null?void 0:l.map(s=>e.jsx(os,{orderInfo:s},s==null?void 0:s.order_id))}),!u&&(i==null?void 0:i.length)>h&&e.jsx(me,{mt:"12px",children:e.jsx(ge,{total:m,size:h,currentPage:p,onChange:g})})]}):e.jsx(G,{type:"nowallet",onboard:()=>n(!0),borderRadius:"16px"})})}const os=({orderInfo:t})=>{const{isApp:n}=oe();return e.jsxs(k,{w:"100%",gap:"16px",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(je,{info:t,imgSize:"28px"}),!n&&e.jsx(Ce,{orderInfo:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(ae,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),n&&e.jsx(Ce,{orderInfo:t})]})},ht=()=>e.jsxs(k,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsx(j,{w:"100%",gap:"0",justify:"space-between",children:e.jsxs(j,{gap:"0",children:[e.jsxs(j,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(He,{size:"8"}),e.jsx(He,{size:"8"})]}),e.jsx(X,{height:"4",width:"100px"})]})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(X,{height:"4",width:"180px"}),e.jsx(X,{height:"4",width:"150px"})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(X,{height:"4",width:"180px"}),e.jsx(X,{height:"4",width:"150px"})]})]});function Je(t){const{historyOrderList:n,historyOrderLoading:i}=t,{currentAccount:u,onWalletModal:h}=U(),l=10,[d,m]=a.useState([]),[c,p]=a.useState(0),[g,s]=a.useState(1);return a.useEffect(()=>{if((n==null?void 0:n.length)>0){p(n==null?void 0:n.length);const r=(g-1)*l,x=r+l;m(n.slice(r,x))}},[g,n]),e.jsx(k,{w:"100%",children:u!=null&&u.address?i?e.jsx(q,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(k,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((r,x)=>e.jsx(ht,{},x))})}):n.length===0?e.jsx(G,{type:"nodata",text:"You don't have any order history.",borderRadius:"16px"}):e.jsxs(q,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(d==null?void 0:d.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(k,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:d==null?void 0:d.map(r=>e.jsx(as,{historyInfo:r},r==null?void 0:r.order_id))}),!i&&(n==null?void 0:n.length)>l&&e.jsx(me,{mt:"12px",children:e.jsx(ge,{total:c,size:l,currentPage:g,onChange:s})})]}):e.jsx(G,{type:"nowallet",onboard:()=>h(!0),borderRadius:"16px"})})}const as=({historyInfo:t})=>{const[n,i]=a.useState({});return e.jsxs(k,{w:"100%",gap:"16px",children:[e.jsx(j,{w:"100%",justify:"space-between",children:e.jsx(je,{info:t,imgSize:"28px"})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Limit Price"}),e.jsx(ae,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Status"}),e.jsx(Xe,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,i({...n})},children:e.jsx(pt,{historyInfo:t,openExpendItemObj:n})})]}),n[t==null?void 0:t.order_id]&&e.jsx(dt,{historyInfo:t,p:"0",border:"none",type:"card"})]})};function cs({historyInfo:t}){const[n,i]=a.useState({});return e.jsxs(he.Fragment,{children:[e.jsxs(D,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,i({...n})},sx:{td:{pb:n[t==null?void 0:t.order_id]?"20px !important":"16px !important"}},children:[e.jsx(v,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(v,{w:"20%",textAlign:"right",children:e.jsx(ae,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(pt,{historyInfo:t,openExpendItemObj:n})})]}),!n[t==null?void 0:t.order_id]&&e.jsx(D,{h:"16px"}),e.jsx(D,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:n[t==null?void 0:t.order_id]&&e.jsx(v,{colSpan:5,children:e.jsx(dt,{historyInfo:t})})})]},t==null?void 0:t.order_id)}function ls(t){const{historyOrderList:n,historyOrderLoading:i}=t;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",n);const{currentAccount:u,onWalletModal:h}=U(),l=10,[d,m]=a.useState([]),[c,p]=a.useState(0),[g,s]=a.useState(1);return a.useEffect(()=>{if((n==null?void 0:n.length)>0){p(n==null?void 0:n.length);const r=(g-1)*l,x=r+l;m(n.slice(r,x))}},[g,n]),e.jsxs(qe,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(Ie,{children:e.jsxs(D,{children:[e.jsx($,{children:"Order Info"}),e.jsx($,{textAlign:"right",children:"Limit Price"}),e.jsx($,{textAlign:"right",children:"Expiry"}),e.jsx($,{textAlign:"right",children:"Filled Size"}),e.jsx($,{textAlign:"right",children:"Status"})]})}),e.jsx(et,{children:u!=null&&u.address?i?e.jsx(ut,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):n.length===0?e.jsx(D,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(he.Fragment,{children:[d.map(r=>e.jsx(cs,{historyInfo:r},r.order_id)),!i&&(n==null?void 0:n.length)>l&&e.jsx(v,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(ge,{total:c,size:l,currentPage:g,onChange:s})})})]}):e.jsx(D,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nowallet",onboard:()=>{h(!0)}})})})})]})}const ps=(t,n)=>({quoteToken:void 0,payCoin:xe.clmm_swap.from_coin,targetCoin:xe.clmm_swap.to_coin,setPayCoin:i=>{t(()=>({payCoin:i}))},setTargetCoin:i=>{t(()=>({targetCoin:i}))},setQuoteToken:i=>{t(()=>({quoteToken:i}))},expiresIn:"7 Days",setExpiresIn:i=>{t(()=>({expiresIn:i}))},customExpiresVal:null,setCustomExpiresVal:i=>{t(()=>({customExpiresVal:i}))},refreshPriceLoading:!1,setRefreshPriceLoading:i=>{t(()=>({refreshPriceLoading:i}))}}),Z=zt(ps);function ds(t,n){const{getTokenPrice:i}=Pe(),u=i(t),h=i(n),l=a.useMemo(()=>{if(u&&h){const d=Ft(u.price).div(h.price).toString(),m=d.toString();return{price:d,displayPrice:m}}},[u,h]);return{price:l==null?void 0:l.price,displayPrice:l==null?void 0:l.displayPrice}}function gt(){const{payCoin:t,targetCoin:n,setRefreshPriceLoading:i}=Z(),{fetchTokenPrices:u}=Pe();return{refreshCoinMarketPrice:()=>{const l=[];t&&l.push(t.coin_type),n&&l.push(n.coin_type),l.length>0&&(i(!0),u(l).finally(()=>{i(!1)}))}}}function xs(){const{refreshCoinMarketPrice:t}=gt(),{fetchAccountBalance:n}=mt(),{fetchMyLimitOrder:i}=xt(),{signAndExecuteTransaction:u}=Ye(),h=We("limit"),{findBestRouters:l}=Zt(),{getTokenAmountValue:d}=Pe(),m=tt(),{pay:c,target:p}=Rt(),{getTokenListInfo:g}=Qt(),{payCoin:s,targetCoin:r,quoteToken:x,expiresIn:P,setPayCoin:b,setTargetCoin:R,setQuoteToken:E,customExpiresVal:A,setExpiresIn:H,setRefreshPriceLoading:V}=Z(),[w,f]=a.useState(""),[N,z]=a.useState(""),[M,ce]=a.useState(!0),[Y,I]=a.useState(!0),[y,Q]=a.useState(""),{displayPrice:L}=ds((x==null?void 0:x.coin_type)===(s==null?void 0:s.coin_type)?r==null?void 0:r.coin_type:s==null?void 0:s.coin_type,x==null?void 0:x.coin_type),{balanceInfo:S}=Qe(s),{balanceInfo:ee}=Qe(r),ve=d(s==null?void 0:s.coin_type,w),jt=d(r==null?void 0:r.coin_type,N),[we,ft]=a.useState(""),ke=a.useRef(we);a.useEffect(()=>{ke.current=we},[we]);const[te,Me]=a.useState(void 0),[se,Le]=a.useState(""),bt=a.useRef(w),wt=a.useRef(N);a.useEffect(()=>{bt.current=w},[w]),a.useEffect(()=>{wt.current=N},[N]),a.useEffect(()=>{(async()=>{const C=[c,p].filter(Boolean),O=await g(C),F=O==null?void 0:O.get(c||"");b(F||xe.clmm_swap.from_coin);const W=O==null?void 0:O.get(p||"");R(W||xe.clmm_swap.to_coin)})()},[c,p]),a.useEffect(()=>{if(Me(void 0),t(),St(),s&&r){const o=s.extensions&&s.extensions.rank||"0",C=r.extensions&&r.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",s,r),B(o).gte(C)?E({...s}):E({...r})}},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const St=async()=>{if(s&&r){const o=`${s.coin_type}_${r.coin_type}`;ft(o);const C=Object.entries(Gt).map(([F,W])=>W.id),O=await l({fromToken:s,toToken:r,amount:$e(1,s.decimals).toFixed(0),providersKeys:C,by_amount_in:!0,uuid:o});o===ke.current&&Me(O)}};a.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",Y,L),Y?Q(L||""):Ee()},[L]),a.useEffect(()=>{x&&!Y&&+y&&Q(ye(B(1).div(y).toFixed(x.decimals)).toString())},[x]),a.useEffect(()=>{Re(M?w:N,M),Ee()},[y]);const[ne,_t]=a.useState({tooltip:"",color:"",text:"",bg:""}),[yt,Oe]=a.useState(!1),Ee=()=>{var o,C;if(!Y&&L&&y){Oe(!0);const O=B(y).sub(L).div(L).mul(100).toFixed(2);Le(O);const F=B(O).gt(0),W=F?O:O.split("-")[1],T={tooltip:"",color:"",text:"",bg:""};T.tooltip=`Limit order price is ${W}% ${F?"higher":"lower"} than the market.`,((o=x==null?void 0:x.coin_type)==null?void 0:o.toLowerCase())==((C=r==null?void 0:r.coin_type)==null?void 0:C.toLowerCase())?Number(y)>Number(L)?(T.text="",T.color="#68FFD8"):Number(L)>Number(y)&&(T.text=`Your limit order price is ${W}% ${F?"higher":"lower"} than market. You are selling at a much ${F?"higher":"lower"} rate. We recommend you to use`,T.color="#ffb62d",T.bg="rgba(255,202,104,0.1)"):Number(y)>Number(L)?(T.text=`Your limit order price is ${W}% ${F?"higher":"lower"} than market. You are buying at a much ${F?"higher":"lower"} rate. We recommend you to use`,T.color="#ffb62d",T.bg="rgba(255,202,104,0.1)"):Number(L)>Number(y)&&(T.text="",T.color="#68FFD8"),_t(T),Oe(!1);return}Le("")},Ct=(o=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",L),I(o),o&&(Q(L||""),t())},Re=(o,C)=>{if(ce(C),C?f(o):z(o),x&&s&&r&&+y&&+o)if(C){x.coin_type===s.coin_type?z(B(o).div(y).toString().toString()):z(B(o).mul(y).toString().toString());return}else{x.coin_type===r.coin_type?f(B(o).div(y).toString().toString()):f(B(o).mul(y).toString().toString());return}C?z(""):f("")},Ae=(o,C)=>{Ne(),ce(C),I(!0),C?de(o==null?void 0:o.coin_type)===de(r.coin_type)?m(`/limit/${o==null?void 0:o.coin_type}/${s==null?void 0:s.coin_type}`):m(`/limit/${o==null?void 0:o.coin_type}/${r==null?void 0:r.coin_type}`):de(o==null?void 0:o.coin_type)===de(s.coin_type)?m(`/limit/${r==null?void 0:r.coin_type}/${o==null?void 0:o.coin_type}`):m(`/limit/${s==null?void 0:s.coin_type}/${o==null?void 0:o.coin_type}`)},Pt=async()=>{Q(L||""),r&&(Ae(r,!0),f(N),z(w))},Ne=()=>{f(""),z("")};a.useEffect(()=>()=>{H("7 Days")},[]);const[Tt,Se]=a.useState(!1),vt=o=>{switch(o){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:kt}=Ut(),{transactionConfirmation:Mt}=Ye(),Lt=We("clmm"),{addToken:ze}=Bt(),Ot=async()=>{const o={getShowInfo:(K,Be)=>{const pe="Creating order",re={modalDescriptionText:pe,toastTitleText:pe};return K==="success"&&(re.toastDescriptionContent="",re.modalDescriptionText="Created order successfully",re.toastTitleText="Created order successfully"),K==="rejected"&&(re.toastTitleText="Create order"),re}};Mt(o);const C=Date.parse(new Date().toString())+(vt(P)||A);console.log(" ~ handleSubmitOrder ~ expired_ts:",C),Se(!0);const O=await Lt.CetusConfig.getTokenListByCoinTypes([s.coin_type,r.coin_type]),F=s.decimals,W=r.decimals,T=O[s.coin_type].decimals,le=O[r.coin_type].decimals;s&&F!==T&&ze({...s,decimals:T}),r&&W!==le&&ze({...r,decimals:le});let _e;(x==null?void 0:x.coin_type)===(r==null?void 0:r.coin_type)?_e=y:_e=B(1).div(y).toFixed(le);try{const K={pay_coin_type:s.coin_type,target_coin_type:r.coin_type,expired_ts:C,target_decimal:le,pay_decimal:T,price:Number(_e),pay_coin_amount:Number($e(w,T).toFixed(0))},Be=await h.LimitOrder.placeLimitOrder(K),pe=await u(Be,o);Se(!1),pe&&(n(),i(),Ne())}catch(K){kt(String(K)),Se(!1)}},{currentAccount:J}=U(),Fe=a.useMemo(()=>{const o=d(s==null?void 0:s.coin_type,w);return Number(o)==0&&Number(w)>0?!1:Number(o)<5},[s,w]),Et=a.useMemo(()=>{const o={text:"Place Limit Order",disabled:!1};return J!=null&&J.address?!s||!r?(o.disabled=!0,o.text=" Select a token",o):!Number(w)||!Number(N)?(o.disabled=!0,o.text="Enter an amount",o):Fe?(o.disabled=!0,o.text="Order size should be higher than $5",o):Number(w)>Number(S==null?void 0:S.balanceFormat)||!(S!=null&&S.balanceFormat)?(o.disabled=!0,o.text=`Insufficient ${s==null?void 0:s.symbol} balance`,o):te&&te.errorCode&&(te.errorCode===Ge.NoRouter||te.errorCode===Ge.HoneyPot)?(o.text="No Available Route",o.disabled=!0,o):(console.log("ðŸš€ ~ buttonTextStatus ~ priceImpact:",12,ne.color,ne,se),ne.color.toLowerCase()=="#ffb62d"&&(Number(se)<-10||Number(se)>10)&&(o.disabled=!0),o):(o.disabled=!1,o.text="Connect Wallet",o)},[J==null?void 0:J.address,s,r,te,w,N,Fe,S,JSON.stringify(ne),se]);return{priceImpactInfoLoading:yt,priceImpactInfo:ne,fixPayCoin:M,onReverseClick:Pt,handleSelectToken:Ae,marketPrice:L,payCoin:s,targetCoin:r,handleAmountChange:Re,payAmount:w,targetAmount:N,payBalanceInfo:S,targetBalanceInfo:ee,payAmountValue:ve,targetAmountValue:jt,useMarketPrice:Y,handleMarketPriceClick:Ct,inputPrice:y,setInputPrice:Q,priceImpact:se,quoteToken:x,setQuoteToken:E,handleSubmitOrder:Ot,submitOrderLoading:Tt,buttonTextStatus:Et}}const us=({confirmData:t,isOpen:n,onClose:i,handleSubmitOrder:u,submitOrderLoading:h})=>{const{payAmount:l,targetAmount:d,payCoin:m,targetCoin:c,inputPrice:p,expiresIn:g,quoteToken:s}=t,r=a.useMemo(()=>{var P,b;return console.log("ðŸš€ ~ price ~ inputPrice:",p),p?((P=s==null?void 0:s.coin_type)==null?void 0:P.toLowerCase())==((b=c==null?void 0:c.coin_type)==null?void 0:b.toLowerCase())?p:B(1).div(p).toString():""},[s,c,p]),x=a.useMemo(()=>{var P,b;return p?((P=s==null?void 0:s.coin_type)==null?void 0:P.toLowerCase())==((b=c==null?void 0:c.coin_type)==null?void 0:b.toLowerCase())?B(1).div(p).toString():p:""},[s,c,p]);return e.jsxs(st,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:i,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(rt,{children:[e.jsx(it,{children:e.jsx(At,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(ot,{}),e.jsx(at,{textAlign:"center",p:"0px",children:e.jsxs(k,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(ss,{coinA:{amount:ye(l,m==null?void 0:m.decimals).toString()||"0",...m},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:ye(d,c==null?void 0:c.decimals).toString()||"0",...c}}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(X,{isLoaded:!!p,children:e.jsx(ae,{info:{pay_coin:m,target_coin:c,price:r,reseverPrice:x}})})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expires in"}),e.jsx(_,{color:"text_caption",children:g})]}),e.jsx(q,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(q,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(ie,{onClick:()=>{u(),i()},disabled:h,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},ms=({isOpen:t,onClose:n})=>{const{isApp:i}=oe(),{setCustomExpiresVal:u,setExpiresIn:h}=Z(),[l,d]=a.useState(""),[m,c]=a.useState(""),p=R=>{const E=R.target.value.replace(/[^\d]/g,"");d(E)},g=R=>{const E=R.target.value.replace(/[^\d]/g,"");c(E)},[s,r]=a.useState({}),x=(R,E)=>{const A=Number(R||0)*60+Number(E||0),H=Math.floor(A/(60*24)),V=Math.floor(A%(60*24)/60),w=A%60;let f="";H>0&&(f+=H+"d "),V>0&&(f+=V+"h "),w>0&&(f+=w+"m "),r({timeText:f.trim()||"0 m",time:A*60*1e3})};a.useEffect(()=>{x(l,m)},[l,m]);const P=a.useMemo(()=>!l&&!m||Number(l)==0&&!m||Number(m)==0&&!l||Number(l)==0&&Number(m)==0,[l,m]),b=()=>{h(s==null?void 0:s.timeText),u(s==null?void 0:s.time),n()};return e.jsxs(st,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(rt,{maxW:"1200px",w:i?"calc(100vw - 32px)":"440px",children:[e.jsx(it,{mr:"-10px",children:e.jsxs(j,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(j,{gap:"0",align:"center",children:e.jsx(ot,{mt:"0",position:"static"})})]})}),e.jsx(at,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(k,{w:"100%",children:[e.jsx(ue,{children:e.jsxs(j,{children:[e.jsx(De,{value:l,onChange:p,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Hours"})]})}),e.jsx(ue,{children:e.jsxs(j,{children:[e.jsx(De,{value:m,onChange:g,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Minutes"})]})}),e.jsx(ie,{onClick:b,disabled:P,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function hs(t){const{expiresIn:n,setExpiresIn:i}=Z(),[u,h]=a.useState(!1),l=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(ue,{w:"156px",borderRadius:"16px",children:[e.jsxs(k,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(ct,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(j,{gap:"4px",children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(lt,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(Xt,{label:n||"",list:l,onListItemClick:d=>{d=="Custom"?h(!0):i(d)}})]}),u&&e.jsx(ms,{isOpen:u,onClose:()=>h(!1)})]})}function gs(t){oe();const{marketPrice:n,priceImpactInfo:i,priceImpactInfoLoading:u,priceImpact:h,inputPrice:l,handleMarketPriceClick:d,setInputPrice:m}=t,{payCoin:c,targetCoin:p,quoteToken:g,refreshPriceLoading:s,setQuoteToken:r}=Z();return e.jsx(ue,{w:"calc(100% - 156px)",children:e.jsxs(k,{w:"100%",gap:"20px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsxs(j,{children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:(g==null?void 0:g.coin_type)===(c==null?void 0:c.coin_type)?`Buy ${Ve(p==null?void 0:p.symbol,10)} at rate`:`Sell ${Ve(c==null?void 0:c.symbol,10)} at rate`}),Number(h)!==0&&!s&&(u?e.jsx(Nt,{size:"sm"}):e.jsx(ct,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:i.tooltip}),children:e.jsxs(_,{color:i.color,children:[B(h).gt(0)?"+":"",Number(h)>1e4?">10000%":Ht(h)]})}))]}),(n||s)&&e.jsx(ie,{isLoading:s,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>d(!0),children:"Market"})]}),e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsx(Dt,{value:l?Wt(l).toString():"",onChange:x=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",l,x),d(!1),m(x)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(_,{textColor:"text_caption",children:g==null?void 0:g.symbol}),e.jsx(lt,{xlinkHref:"#icon-icon_swap1",onClick:()=>{p&&c&&((g==null?void 0:g.coin_type)===(c==null?void 0:c.coin_type)?r(p):r(c))}})]})]})]})})}function js(){const{expiresIn:t}=Z(),{buttonTextStatus:n,payBalanceInfo:i,targetBalanceInfo:u,payAmountValue:h,targetAmountValue:l,payAmount:d,targetAmount:m,payCoin:c,targetCoin:p,marketPrice:g,handleAmountChange:s,handleMarketPriceClick:r,handleSelectToken:x,inputPrice:P,setInputPrice:b,priceImpact:R,quoteToken:E,handleSubmitOrder:A,submitOrderLoading:H,onReverseClick:V,priceImpactInfoLoading:w,priceImpactInfo:f}=xs(),N=a.useMemo(()=>({payAmount:d,targetAmount:m,payCoin:c,targetCoin:p,inputPrice:P,expiresIn:t,quoteToken:E}),[d,m,c,p,P,t,E]),{onWalletModal:z}=U(),[M,ce]=a.useState("#icon-a-icon_trade"),Y=S=>ce(S?"#icon-icon_swap1":"#icon-a-icon_trade"),[I,y]=a.useState(!1),Q=tt(),L=a.useMemo(()=>{const S=[];return c&&S.push(c),p&&S.push(p),S},[c,p]);return e.jsxs(k,{w:{base:"100%",lg:"470px"},gap:"8px",mb:"8px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(It,{currTradeTab:es.Limit}),e.jsx(qt,{})]}),e.jsx(Jt,{onClick:V,from:{title:"You Pay",balance:(i==null?void 0:i.balanceFormat)||"",value:d,amountValue:h,onChange:S=>{s(S,!0)},selectable:!0,placeholder:"0.0",token:c,onTokenChange:S=>{x(S,!0)}},to:{title:"You Receive",balance:(u==null?void 0:u.balanceFormat)||"",value:m,amountValue:l,onTokenChange:S=>{x(S,!1)},onChange:S=>{s(S,!1)},selectable:!0,placeholder:"0.0",token:p,half:!1,max:!1},iconParams:{xlinkHref:M,svgFill:"text_caption",transform:M==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:M==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>Y(!0),onMouseLeave:()=>Y(!1)}}),e.jsxs(j,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(gs,{marketPrice:g,priceImpactInfoLoading:w,priceImpactInfo:f,priceImpact:R,inputPrice:P,setInputPrice:b,handleMarketPriceClick:r}),e.jsx(hs,{})]}),(f==null?void 0:f.text)&&g&&Number(R)!==0&&P&&e.jsxs(_,{color:f==null?void 0:f.color,lineHeight:"20px",bg:f==null?void 0:f.bg,p:"12px",borderRadius:"8px",children:[f==null?void 0:f.text,"Â ",e.jsx(_,{color:f==null?void 0:f.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>Q(`/swap/${c==null?void 0:c.coin_type}/${p==null?void 0:p.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(ie,{disabled:(n==null?void 0:n.disabled)||H,isLoading:H,mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",onClick:(n==null?void 0:n.text)=="Connect Wallet"?()=>z(!0):()=>y(!0),children:n==null?void 0:n.text}),I&&e.jsx(us,{confirmData:N,isOpen:I,onClose:()=>y(!1),handleSubmitOrder:A,submitOrderLoading:H}),(c||p)&&e.jsx(Kt,{addToken:!0,tokensInfo:L,waringModalCancel:S=>{S.forEach(ee=>{(ee.coin_type===(c==null?void 0:c.coin_type)||ee.coin_type===(p==null?void 0:p.coin_type))&&x(void 0,ee.coin_type===(c==null?void 0:c.coin_type))})}})]})}function fs({orderInfo:t}){return e.jsxs(he.Fragment,{children:[e.jsxs(D,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(v,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(v,{w:"20%",textAlign:"right",children:e.jsx(ae,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(Ce,{orderInfo:t})})]}),e.jsx(D,{h:"16px"})]},t==null?void 0:t.order_id)}function bs(){const{currentAccount:t,onWalletModal:n}=U(),{myOrderList:i,orderListLoading:u}=Te(),h=10,[l,d]=a.useState([]),[m,c]=a.useState(0),[p,g]=a.useState(1);return a.useEffect(()=>{if((i==null?void 0:i.length)>0){c(i==null?void 0:i.length);const s=(p-1)*h,r=s+h;d(i.slice(s,r))}},[p,i]),e.jsxs(qe,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(Ie,{children:e.jsxs(D,{children:[e.jsx($,{children:"Order Info"}),e.jsx($,{textAlign:"right",children:"Price"}),e.jsx($,{textAlign:"right",children:"Filled Size"}),e.jsx($,{textAlign:"right",children:"Expiry"}),e.jsx($,{textAlign:"right",children:"Action"})]})}),e.jsx(et,{children:t!=null&&t.address?u?e.jsx(ut,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):i.length===0?e.jsx(D,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(he.Fragment,{children:[l.map(s=>e.jsx(fs,{orderInfo:s},s.order_id)),!u&&(i==null?void 0:i.length)>h&&e.jsx(v,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(ge,{total:m,size:h,currentPage:p,onChange:g})})})]}):e.jsx(D,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nowallet",onboard:()=>{n(!0)},borderRadius:"16px"})})})})]})}function fn(){const{currentAccount:t}=U(),{getLimitOrderHistory:n,historyOrderList:i,historyOrderLoading:u}=Vt(),{fetchMyLimitOrder:h}=xt(),{setMyOrderList:l,myOrderList:d,orderListLoading:m}=Te(),{payCoin:c,targetCoin:p}=Z(),{fetchAccountBalance:g}=mt();a.useEffect(()=>{t!=null&&t.address&&g()},[]);const{isShowTradeChart:s,isShowTradeOrders:r}=ts(),[x,P]=a.useState([]),[b,R]=a.useState({label:"Open Orders"}),E=a.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",d);const M=[];return M.push({label:"Open Orders",num:b.label==="Open Orders"&&d.length>0&&!m?d.length.toString():void 0}),M.push({label:"Order History",num:b.label==="Order History"&&x.length>0&&!u?x.length.toString():void 0}),M},[b.label,d,x,u,m]);a.useEffect(()=>{A(!0)},[b.label,t,r]),is({onRpcChange:()=>{A(!0),t!=null&&t.address&&g()}});const A=M=>{r&&(z(0),console.log("ðŸš€  ~ currentAccount:",b.label==="Open Orders",t==null?void 0:t.address),t!=null&&t.address&&(b.label==="Open Orders"?h(t.address,M):(console.log("ðŸš€ ~  ~ currentAccount:",t),n(t.address,M))))};a.useEffect(()=>{t!=null&&t.address&&(i==null?void 0:i.length)>0?P(i):(P([]),l([]))},[i,t==null?void 0:t.address]);const H=M=>{R(M)},{windowWidth:V,isApp:w}=oe(),{refreshCoinMarketPrice:f}=gt(),[N,z]=a.useState(0);return rs({interval:1e3,callback:()=>{z(N+1),N>=20&&(z(0),f(),t!=null&&t.address&&g(),A(!1))}}),e.jsxs(k,{mt:V&&V<1024?"28px":"42px",w:"100%",gap:"0px",className:w||s||r?"":"bg_img",children:[e.jsxs(j,{w:"100%",justifyContent:"center",alignItems:"start",gap:"16px",flexDirection:{base:s?"column":"column-reverse",lg:"row"},children:[(r||s)&&e.jsx(j,{gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:s?e.jsx(ns,{baseToken:c,quoteToken:p}):e.jsxs(k,{w:"100%",children:[e.jsx(Ke,{tabList:E,currTab:b,myOrderList:d,handleChangeTab:H,handleGetOrderList:A}),b.label==="Open Orders"&&e.jsx(Ze,{}),b.label==="Order History"&&e.jsx(Je,{historyOrderList:x,historyOrderLoading:u})]})}),e.jsx(js,{})]}),r&&s&&e.jsxs(k,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(Ke,{handleGetOrderList:()=>A(!0),tabList:E,currTab:b,myOrderList:d,handleChangeTab:H}),w&&e.jsx(Xe,{h:"16px"}),b.label==="Open Orders"&&(w?e.jsx(Ze,{}):e.jsx(bs,{})),b.label==="Order History"&&(w?e.jsx(Je,{historyOrderList:x,historyOrderLoading:u}):e.jsx(ls,{historyOrderList:x,historyOrderLoading:u}))]})]})}const Ke=({tabList:t,currTab:n,myOrderList:i,handleChangeTab:u,handleGetOrderList:h})=>{const{handleCancelOrder:l,cancelOrderLoading:d}=Yt(),{isApp:m}=oe(),c=n.label==="Open Orders"&&i.length>1;return e.jsxs(j,{w:"100%",justifyContent:"space-between",flexDirection:{base:n.label==="Open Orders"&&i.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(j,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx($t,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:t,currentTab:n.label,handleChangeTab:u}),m&&e.jsx(Ue,{handleRefresh:h,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!m||c)&&e.jsxs(j,{gap:"8px",w:{base:"100%",lg:"unset"},children:[c&&e.jsx(ie,{onClick:()=>{l(i)},disabled:d,isLoading:d,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"-8px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!m&&e.jsx(Ue,{handleRefresh:h,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{fn as default};
//# sourceMappingURL=Limit-u-PlnxQh.js.map

import{a as o,j as e,V as M,C as me,H as j,S as We,u as Z,T as _,f as qe,R as he,au as H,av as v,aw as Ie,ax as et,ay as $,az as tt,ab as st,as as At,X as rt,Y as nt,Z as it,$ as at,a8 as Nt,a0 as ot,a1 as ct,v as ie,O as $e,aa as zt}from"./vendor-DXHkIl66.js";import{j as Q,B as q,a as ae,R as Ft,w as xe,n as Ce,a0 as Dt,k as Bt,d as D,t as Ve,v as ye,V as Ht,J as Wt,z as de,F as lt,I as pt,X as Ye,am as $t,N as Vt,y as Yt,i as Gt}from"./index-1pql7esm.js";import{P as ge}from"./Pagination-CSSNOfsX.js";import{N as G}from"./NoData-CqJO7NcS.js";import{u as Te,C as je,O as Pe,P as oe,F as fe,E as be,S as dt,L as xt,a as ut,b as Kt,c as Qt}from"./useGetLimitOrderHistory-Bq52Oo3W.js";import{b as mt}from"./FarmsTable-C2DIRrKZ.js";import{A as Ut}from"./aggregator-CYRAqVBD.js";import{u as Ge}from"./useTransaction-HT-BOlou.js";import{A as Ke}from"./useSwapHelper-BaLkqCYA.js";import{u as ht}from"./useAccountBalance-C2Raiu99.js";import{u as Jt}from"./useToken-DQuh8vo3.js";import{u as Qe}from"./useTokenBalance-CuMCex55.js";import{u as Xt}from"./useInsufficientBalanceToast-rFjqpLYC.js";import{u as Zt}from"./useFindBestRouting-DIT_sTee.js";import{T as qt}from"./TradeInputGroup-CpiF2tC0.js";import{W as It}from"./WarningTokenTipModal-B2I_VVBy.js";import{M as es,C as ts}from"./MenuDropBlock-_Iek8qIC.js";import{T as ss,a as rs}from"./TradeTab-LpWmA4O5.js";import"./index-D1I5og1_.js";import{u as ns}from"./global-BhEQOSwv.js";import"./swap-Dx0DML5z.js";import"./AggregatorModal-nD379nN8.js";import"./FreshProgressV2-25htpobb.js";import{T as is}from"./TradeConfirmAmountInfo-CP6yIblk.js";import{I as ue}from"./InputBox-Dlz8xsDZ.js";import{LimitPriceChart as as}from"./LimitPriceChart-BC2yhNMe.js";import{u as os}from"./useInterval-Cb1zlf7x.js";import{u as cs}from"./useRpcListener-ct19cNgt.js";import{R as Ue}from"./RefreshButton-BHZks4q0.js";import"./IconText-BoC6CBk5.js";import"./SingleTokenInfo-CIUspzmb.js";import"./CopyButton-DHFYRM3v.js";import"./RangeValue-CWje48WD.js";import"./usePositionList-BulHo-5f.js";import"./useFavoritePool-DE7_4UZt.js";import"./useGetPoolList-B1dNsTr9.js";import"./useWrapPoolData-DbIflROk.js";import"./index-9YMM8VLO.js";import"./ExpendItem-Bf0lMQPF.js";import"./msafe-oYBkW7LJ.js";import"./PriceRange-C09QLmLc.js";import"./PositionStatus-gu0KkwGh.js";import"./CoinPairInfo-18SnxIQd.js";import"./PoweredByHaedal-990R--7x.js";import"./useTrack-CtIH4d6T.js";import"./useSigner-CFmwTogF.js";import"./_getAllKeysIn-Ds6Ic9w2.js";import"./CheckBox-C4jUOy1k.js";import"./IconBg-zdP5f7VE.js";import"./TooltipIcon-C0_AzT63.js";import"./index-Ct3YeWBa.js";import"./usePreviousValue-BBpD8e7r.js";function Je(){const{currentAccount:t,onWalletModal:n}=Q(),{myOrderList:i,orderListLoading:u}=Te(),h=10,[l,d]=o.useState([]),[m,c]=o.useState(0),[p,g]=o.useState(1);return o.useEffect(()=>{if((i==null?void 0:i.length)>0){c(i==null?void 0:i.length);const s=(p-1)*h,r=s+h;d(i.slice(s,r))}},[p,i]),e.jsx(M,{w:"100%",children:t!=null&&t.address?u?e.jsx(q,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(M,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((s,r)=>e.jsx(gt,{},r))})}):i.length===0?e.jsx(G,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"}):e.jsxs(q,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(l==null?void 0:l.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(M,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:l==null?void 0:l.map(s=>e.jsx(ls,{orderInfo:s},s==null?void 0:s.order_id))}),!u&&(i==null?void 0:i.length)>h&&e.jsx(me,{mt:"12px",children:e.jsx(ge,{total:m,size:h,currentPage:p,onChange:g})})]}):e.jsx(G,{type:"nowallet",onboard:()=>n(!0),borderRadius:"16px"})})}const ls=({orderInfo:t})=>{const{isApp:n}=ae();return e.jsxs(M,{w:"100%",gap:"16px",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(je,{info:t,imgSize:"28px"}),!n&&e.jsx(Pe,{orderInfo:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),n&&e.jsx(Pe,{orderInfo:t})]})},gt=()=>e.jsxs(M,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsx(j,{w:"100%",gap:"0",justify:"space-between",children:e.jsxs(j,{gap:"0",children:[e.jsxs(j,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(We,{size:"8"}),e.jsx(We,{size:"8"})]}),e.jsx(Z,{height:"4",width:"100px"})]})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(Z,{height:"4",width:"180px"}),e.jsx(Z,{height:"4",width:"150px"})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(Z,{height:"4",width:"180px"}),e.jsx(Z,{height:"4",width:"150px"})]})]});function Xe(t){const{historyOrderList:n,historyOrderLoading:i}=t,{currentAccount:u,onWalletModal:h}=Q(),l=10,[d,m]=o.useState([]),[c,p]=o.useState(0),[g,s]=o.useState(1);return o.useEffect(()=>{if((n==null?void 0:n.length)>0){p(n==null?void 0:n.length);const r=(g-1)*l,x=r+l;m(n.slice(r,x))}},[g,n]),e.jsx(M,{w:"100%",children:u!=null&&u.address?i?e.jsx(q,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(M,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((r,x)=>e.jsx(gt,{},x))})}):n.length===0?e.jsx(G,{type:"nodata",text:"You don't have any order history.",borderRadius:"16px"}):e.jsxs(q,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(d==null?void 0:d.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(M,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:d==null?void 0:d.map(r=>e.jsx(ps,{historyInfo:r},r==null?void 0:r.order_id))}),!i&&(n==null?void 0:n.length)>l&&e.jsx(me,{mt:"12px",children:e.jsx(ge,{total:c,size:l,currentPage:g,onChange:s})})]}):e.jsx(G,{type:"nowallet",onboard:()=>h(!0),borderRadius:"16px"})})}const ps=({historyInfo:t})=>{const[n,i]=o.useState({});return e.jsxs(M,{w:"100%",gap:"16px",children:[e.jsx(j,{w:"100%",justify:"space-between",children:e.jsx(je,{info:t,imgSize:"28px"})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Limit Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Status"}),e.jsx(qe,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,i({...n})},children:e.jsx(dt,{historyInfo:t,openExpendItemObj:n})})]}),n[t==null?void 0:t.order_id]&&e.jsx(xt,{historyInfo:t,p:"0",border:"none",type:"card"})]})};function ds({historyInfo:t}){const[n,i]=o.useState({});return e.jsxs(he.Fragment,{children:[e.jsxs(H,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,i({...n})},sx:{td:{pb:n[t==null?void 0:t.order_id]?"20px !important":"16px !important"}},children:[e.jsx(v,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(v,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(dt,{historyInfo:t,openExpendItemObj:n})})]}),!n[t==null?void 0:t.order_id]&&e.jsx(H,{h:"16px"}),e.jsx(H,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:n[t==null?void 0:t.order_id]&&e.jsx(v,{colSpan:5,children:e.jsx(xt,{historyInfo:t})})})]},t==null?void 0:t.order_id)}function xs(t){const{historyOrderList:n,historyOrderLoading:i}=t;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",n);const{currentAccount:u,onWalletModal:h}=Q(),l=10,[d,m]=o.useState([]),[c,p]=o.useState(0),[g,s]=o.useState(1);return o.useEffect(()=>{if((n==null?void 0:n.length)>0){p(n==null?void 0:n.length);const r=(g-1)*l,x=r+l;m(n.slice(r,x))}},[g,n]),e.jsxs(Ie,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(et,{children:e.jsxs(H,{children:[e.jsx($,{children:"Order Info"}),e.jsx($,{textAlign:"right",children:"Limit Price"}),e.jsx($,{textAlign:"right",children:"Expiry"}),e.jsx($,{textAlign:"right",children:"Filled Size"}),e.jsx($,{textAlign:"right",children:"Status"})]})}),e.jsx(tt,{children:u!=null&&u.address?i?e.jsx(mt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):n.length===0?e.jsx(H,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(he.Fragment,{children:[d.map(r=>e.jsx(ds,{historyInfo:r},r.order_id)),!i&&(n==null?void 0:n.length)>l&&e.jsx(v,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(ge,{total:c,size:l,currentPage:g,onChange:s})})})]}):e.jsx(H,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nowallet",onboard:()=>{h(!0)}})})})})]})}const us=(t,n)=>({quoteToken:void 0,payCoin:xe.clmm_swap.from_coin,targetCoin:xe.clmm_swap.to_coin,setPayCoin:i=>{t(()=>({payCoin:i}))},setTargetCoin:i=>{t(()=>({targetCoin:i}))},setQuoteToken:i=>{t(()=>({quoteToken:i}))},expiresIn:"7 Days",setExpiresIn:i=>{t(()=>({expiresIn:i}))},customExpiresVal:null,setCustomExpiresVal:i=>{t(()=>({customExpiresVal:i}))},refreshPriceLoading:!1,setRefreshPriceLoading:i=>{t(()=>({refreshPriceLoading:i}))}}),U=Ft(us);function ms(t,n){const{getTokenPrice:i}=Ce(),u=i(t),h=i(n),l=o.useMemo(()=>{if(u&&h){const d=Dt(u.price).div(h.price).toString(),m=d.toString();return{price:d,displayPrice:m}}},[u,h]);return{price:l==null?void 0:l.price,displayPrice:l==null?void 0:l.displayPrice}}function jt(){const{payCoin:t,targetCoin:n,setRefreshPriceLoading:i}=U(),{fetchTokenPrices:u}=Ce();return{refreshCoinMarketPrice:()=>{const l=[];t&&l.push(t.coin_type),n&&l.push(n.coin_type),l.length>0&&(i(!0),u(l).finally(()=>{i(!1)}))}}}function hs(){const{refreshCoinMarketPrice:t}=jt(),{fetchAccountBalance:n}=ht(),{fetchMyLimitOrder:i}=ut(),{signAndExecuteTransaction:u}=Ge(),{peripherySdk:h}=Bt(),{findBestRouters:l}=Zt(),{getTokenAmountValue:d}=Ce(),m=st(),{pay:c,target:p}=At(),{getTokenListInfo:g}=Jt(),{payCoin:s,targetCoin:r,quoteToken:x,expiresIn:C,setPayCoin:b,setTargetCoin:R,setQuoteToken:E,customExpiresVal:A,setExpiresIn:B,setRefreshPriceLoading:V}=U(),[w,f]=o.useState(""),[N,z]=o.useState(""),[k,ce]=o.useState(!0),[Y,I]=o.useState(!0),[y,K]=o.useState(""),{displayPrice:L}=ms((x==null?void 0:x.coin_type)===(s==null?void 0:s.coin_type)?r==null?void 0:r.coin_type:s==null?void 0:s.coin_type,x==null?void 0:x.coin_type),{balanceInfo:S}=Qe(s),{balanceInfo:ee}=Qe(r),ve=d(s==null?void 0:s.coin_type,w),ft=d(r==null?void 0:r.coin_type,N),[we,bt]=o.useState(""),Me=o.useRef(we);o.useEffect(()=>{Me.current=we},[we]);const[te,ke]=o.useState(void 0),[se,Le]=o.useState(""),wt=o.useRef(w),St=o.useRef(N);o.useEffect(()=>{wt.current=w},[w]),o.useEffect(()=>{St.current=N},[N]),o.useEffect(()=>{(async()=>{const P=[c,p].filter(Boolean),O=await g(P),F=O==null?void 0:O.get(c||"");b(F||xe.clmm_swap.from_coin);const W=O==null?void 0:O.get(p||"");R(W||xe.clmm_swap.to_coin)})()},[c,p]),o.useEffect(()=>{if(ke(void 0),t(),_t(),s&&r){const a=s.extensions&&s.extensions.rank||"0",P=r.extensions&&r.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",s,r),D(a).gte(P)?E({...s}):E({...r})}},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const _t=async()=>{if(s&&r){const a=`${s.coin_type}_${r.coin_type}`;bt(a);const P=Object.entries(Ut).map(([F,W])=>W.id),O=await l({fromToken:s,toToken:r,amount:Ve(1,s.decimals).toFixed(0),providersKeys:P,by_amount_in:!0,uuid:a});a===Me.current&&ke(O)}};o.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",Y,L),Y?K(L||""):Ee()},[L]),o.useEffect(()=>{x&&!Y&&+y&&K(ye(D(1).div(y).toFixed(x.decimals)).toString())},[x]),o.useEffect(()=>{Re(k?w:N,k),Ee()},[y]);const[re,yt]=o.useState({tooltip:"",color:"",text:"",bg:""}),[Pt,Oe]=o.useState(!1),Ee=()=>{var a,P;if(!Y&&L&&y){Oe(!0);const O=D(y).sub(L).div(L).mul(100).toFixed(2);Le(O);const F=D(O).gt(0),W=F?O:O.split("-")[1],T={tooltip:"",color:"",text:"",bg:""};T.tooltip=`Limit order price is ${W}% ${F?"higher":"lower"} than the market.`,((a=x==null?void 0:x.coin_type)==null?void 0:a.toLowerCase())==((P=r==null?void 0:r.coin_type)==null?void 0:P.toLowerCase())?Number(y)>Number(L)?(T.text="",T.color="#68FFD8"):Number(L)>Number(y)&&(T.text=`Your limit order price is ${W}% ${F?"higher":"lower"} than market. You are selling at a much ${F?"higher":"lower"} rate. We recommend you to use`,T.color="#ffb62d",T.bg="rgba(255,202,104,0.1)"):Number(y)>Number(L)?(T.text=`Your limit order price is ${W}% ${F?"higher":"lower"} than market. You are buying at a much ${F?"higher":"lower"} rate. We recommend you to use`,T.color="#ffb62d",T.bg="rgba(255,202,104,0.1)"):Number(L)>Number(y)&&(T.text="",T.color="#68FFD8"),yt(T),Oe(!1);return}Le("")},Ct=(a=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",L),I(a),a&&(K(L||""),t())},Re=(a,P)=>{if(ce(P),P?f(a):z(a),x&&s&&r&&+y&&+a)if(P){x.coin_type===s.coin_type?z(D(a).div(y).toString().toString()):z(D(a).mul(y).toString().toString());return}else{x.coin_type===r.coin_type?f(D(a).div(y).toString().toString()):f(D(a).mul(y).toString().toString());return}P?z(""):f("")},Ae=(a,P)=>{Ne(),ce(P),I(!0),P?de(a==null?void 0:a.coin_type)===de(r==null?void 0:r.coin_type)?m(`/limit/${a==null?void 0:a.coin_type}/${s==null?void 0:s.coin_type}`):m(`/limit/${a==null?void 0:a.coin_type}/${r==null?void 0:r.coin_type}`):de(a==null?void 0:a.coin_type)===de(s==null?void 0:s.coin_type)?m(`/limit/${r==null?void 0:r.coin_type}/${a==null?void 0:a.coin_type}`):m(`/limit/${s==null?void 0:s.coin_type}/${a==null?void 0:a.coin_type}`)},Tt=async()=>{K(L||""),r&&(Ae(r,!0),f(N),z(w))},Ne=()=>{f(""),z("")};o.useEffect(()=>()=>{B("7 Days")},[]);const[vt,Se]=o.useState(!1),Mt=a=>{switch(a){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:kt}=Xt(),{transactionConfirmation:Lt}=Ge(),{clmmSdk:Ot}=Ht(),{addToken:ze}=Wt(),Et=async()=>{var De,Be;const a={getShowInfo:(X,He)=>{const pe="Creating order",ne={modalDescriptionText:pe,toastTitleText:pe};return X==="success"&&(ne.toastDescriptionContent="",ne.modalDescriptionText="Created order successfully",ne.toastTitleText="Created order successfully"),X==="rejected"&&(ne.toastTitleText="Create order"),ne}};Lt(a);const P=Date.parse(new Date().toString())+(Mt(C)||A);console.log(" ~ handleSubmitOrder ~ expired_ts:",P),Se(!0);const O=await Ot.CetusConfig.getTokenListByCoinTypes([s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),F=s==null?void 0:s.decimals,W=r==null?void 0:r.decimals,T=(De=O[s==null?void 0:s.coin_type])==null?void 0:De.decimals,le=(Be=O[r==null?void 0:r.coin_type])==null?void 0:Be.decimals;F!==T&&ze({...s,decimals:T}),W!==le&&ze({...r,decimals:le});let _e;(x==null?void 0:x.coin_type)===(r==null?void 0:r.coin_type)?_e=y:_e=D(1).div(y).toFixed(le);try{const X={pay_coin_type:s.coin_type,target_coin_type:r.coin_type,expired_ts:P,target_decimal:le,pay_decimal:T,price:Number(_e),pay_coin_amount:Number(Ve(w,T).toFixed(0))},He=await h.LimitOrder.placeLimitOrder(X),pe=await u(He,a);Se(!1),pe&&(n(),i(),Ne())}catch(X){kt(String(X)),Se(!1)}},{currentAccount:J}=Q(),Fe=o.useMemo(()=>{const a=d(s==null?void 0:s.coin_type,w);return Number(a)==0&&Number(w)>0?!1:Number(a)<5},[s,w]),Rt=o.useMemo(()=>{const a={text:"Place Limit Order",disabled:!1};return J!=null&&J.address?!s||!r?(a.disabled=!0,a.text=" Select a token",a):!Number(w)||!Number(N)?(a.disabled=!0,a.text="Enter an amount",a):Fe?(a.disabled=!0,a.text="Order size should be higher than $5",a):Number(w)>Number(S==null?void 0:S.balanceFormat)||!(S!=null&&S.balanceFormat)?(a.disabled=!0,a.text=`Insufficient ${s==null?void 0:s.symbol} balance`,a):te&&te.errorCode&&(te.errorCode===Ke.NoRouter||te.errorCode===Ke.HoneyPot)?(a.text="No Available Route",a.disabled=!0,a):(console.log("ðŸš€ ~ buttonTextStatus ~ priceImpact:",12,re.color,re,se),re.color.toLowerCase()=="#ffb62d"&&(Number(se)<-10||Number(se)>10)&&(a.disabled=!0),a):(a.disabled=!1,a.text="Connect Wallet",a)},[J==null?void 0:J.address,s,r,te,w,N,Fe,S,JSON.stringify(re),se]);return{priceImpactInfoLoading:Pt,priceImpactInfo:re,fixPayCoin:k,onReverseClick:Tt,handleSelectToken:Ae,marketPrice:L,payCoin:s,targetCoin:r,handleAmountChange:Re,payAmount:w,targetAmount:N,payBalanceInfo:S,targetBalanceInfo:ee,payAmountValue:ve,targetAmountValue:ft,useMarketPrice:Y,handleMarketPriceClick:Ct,inputPrice:y,setInputPrice:K,priceImpact:se,quoteToken:x,setQuoteToken:E,handleSubmitOrder:Et,submitOrderLoading:vt,buttonTextStatus:Rt}}const gs=({confirmData:t,isOpen:n,onClose:i,handleSubmitOrder:u,submitOrderLoading:h})=>{const{payAmount:l,targetAmount:d,payCoin:m,targetCoin:c,inputPrice:p,expiresIn:g,quoteToken:s}=t,r=o.useMemo(()=>{var C,b;return console.log("ðŸš€ ~ price ~ inputPrice:",p),p?((C=s==null?void 0:s.coin_type)==null?void 0:C.toLowerCase())==((b=c==null?void 0:c.coin_type)==null?void 0:b.toLowerCase())?p:D(1).div(p).toString():""},[s,c,p]),x=o.useMemo(()=>{var C,b;return p?((C=s==null?void 0:s.coin_type)==null?void 0:C.toLowerCase())==((b=c==null?void 0:c.coin_type)==null?void 0:b.toLowerCase())?D(1).div(p).toString():p:""},[s,c,p]);return e.jsxs(rt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:i,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(it,{children:[e.jsx(at,{children:e.jsx(Nt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(ot,{}),e.jsx(ct,{textAlign:"center",p:"0px",children:e.jsxs(M,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(is,{coinA:{amount:ye(l,m==null?void 0:m.decimals).toString()||"0",...m},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:ye(d,c==null?void 0:c.decimals).toString()||"0",...c}}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(Z,{isLoaded:!!p,children:e.jsx(oe,{info:{pay_coin:m,target_coin:c,price:r,reseverPrice:x}})})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expires in"}),e.jsx(_,{color:"text_caption",children:g})]}),e.jsx(q,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(q,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(ie,{onClick:()=>{u(),i()},disabled:h,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},js=({isOpen:t,onClose:n})=>{const{isApp:i}=ae(),{setCustomExpiresVal:u,setExpiresIn:h}=U(),[l,d]=o.useState(""),[m,c]=o.useState(""),p=R=>{const E=R.target.value.replace(/[^\d]/g,"");d(E)},g=R=>{const E=R.target.value.replace(/[^\d]/g,"");c(E)},[s,r]=o.useState({}),x=(R,E)=>{const A=Number(R||0)*60+Number(E||0),B=Math.floor(A/(60*24)),V=Math.floor(A%(60*24)/60),w=A%60;let f="";B>0&&(f+=B+"d "),V>0&&(f+=V+"h "),w>0&&(f+=w+"m "),r({timeText:f.trim()||"0 m",time:A*60*1e3})};o.useEffect(()=>{x(l,m)},[l,m]);const C=o.useMemo(()=>!l&&!m||Number(l)==0&&!m||Number(m)==0&&!l||Number(l)==0&&Number(m)==0,[l,m]),b=()=>{h(s==null?void 0:s.timeText),u(s==null?void 0:s.time),n()};return e.jsxs(rt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(it,{maxW:"1200px",w:i?"calc(100vw - 32px)":"440px",children:[e.jsx(at,{mr:"-10px",children:e.jsxs(j,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(j,{gap:"0",align:"center",children:e.jsx(ot,{mt:"0",position:"static"})})]})}),e.jsx(ct,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(M,{w:"100%",children:[e.jsx(ue,{children:e.jsxs(j,{children:[e.jsx($e,{value:l,onChange:p,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Hours"})]})}),e.jsx(ue,{children:e.jsxs(j,{children:[e.jsx($e,{value:m,onChange:g,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Minutes"})]})}),e.jsx(ie,{onClick:b,disabled:C,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function fs(t){const{expiresIn:n,setExpiresIn:i}=U(),[u,h]=o.useState(!1),l=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(ue,{w:"156px",borderRadius:"16px",children:[e.jsxs(M,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(lt,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(j,{gap:"4px",children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(pt,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(es,{label:n||"",list:l,onListItemClick:d=>{d=="Custom"?h(!0):i(d)}})]}),u&&e.jsx(js,{isOpen:u,onClose:()=>h(!1)})]})}function bs(t){ae();const{marketPrice:n,priceImpactInfo:i,priceImpactInfoLoading:u,priceImpact:h,inputPrice:l,handleMarketPriceClick:d,setInputPrice:m}=t,{payCoin:c,targetCoin:p,quoteToken:g,refreshPriceLoading:s,setQuoteToken:r}=U();return e.jsx(ue,{w:"calc(100% - 156px)",children:e.jsxs(M,{w:"100%",gap:"20px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsxs(j,{children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:(g==null?void 0:g.coin_type)===(c==null?void 0:c.coin_type)?`Buy ${Ye(p==null?void 0:p.symbol,10)} at rate`:`Sell ${Ye(c==null?void 0:c.symbol,10)} at rate`}),Number(h)!==0&&!s&&(u?e.jsx(zt,{size:"sm"}):e.jsx(lt,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:i.tooltip}),children:e.jsxs(_,{color:i.color,children:[D(h).gt(0)?"+":"",Number(h)>1e4?">10000%":$t(h)]})}))]}),(n||s)&&e.jsx(ie,{isLoading:s,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>d(!0),children:"Market"})]}),e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsx(Vt,{value:l?Yt(l).toString():"",onChange:x=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",l,x),d(!1),m(x)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(_,{textColor:"text_caption",children:g==null?void 0:g.symbol}),e.jsx(pt,{xlinkHref:"#icon-icon_swap1",onClick:()=>{p&&c&&((g==null?void 0:g.coin_type)===(c==null?void 0:c.coin_type)?r(p):r(c))}})]})]})]})})}function ws(){const{expiresIn:t}=U(),{buttonTextStatus:n,payBalanceInfo:i,targetBalanceInfo:u,payAmountValue:h,targetAmountValue:l,payAmount:d,targetAmount:m,payCoin:c,targetCoin:p,marketPrice:g,handleAmountChange:s,handleMarketPriceClick:r,handleSelectToken:x,inputPrice:C,setInputPrice:b,priceImpact:R,quoteToken:E,handleSubmitOrder:A,submitOrderLoading:B,onReverseClick:V,priceImpactInfoLoading:w,priceImpactInfo:f}=hs(),N=o.useMemo(()=>({payAmount:d,targetAmount:m,payCoin:c,targetCoin:p,inputPrice:C,expiresIn:t,quoteToken:E}),[d,m,c,p,C,t,E]),{onWalletModal:z}=Q(),[k,ce]=o.useState("#icon-a-icon_trade"),Y=S=>ce(S?"#icon-icon_swap1":"#icon-a-icon_trade"),[I,y]=o.useState(!1),K=st(),L=o.useMemo(()=>{const S=[];return c&&S.push(c),p&&S.push(p),S},[c,p]);return e.jsxs(M,{w:{base:"100%",lg:"470px"},gap:"8px",mb:"8px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(ss,{currTradeTab:rs.Limit}),e.jsx(ts,{})]}),e.jsx(qt,{onClick:V,from:{title:"You Pay",balance:(i==null?void 0:i.balanceFormat)||"",value:d,amountValue:h,onChange:S=>{s(S,!0)},selectable:!0,placeholder:"0.0",token:c,onTokenChange:S=>{x(S,!0)}},to:{title:"You Receive",balance:(u==null?void 0:u.balanceFormat)||"",value:m,amountValue:l,onTokenChange:S=>{x(S,!1)},onChange:S=>{s(S,!1)},selectable:!0,placeholder:"0.0",token:p,half:!1,max:!1},iconParams:{xlinkHref:k,svgFill:"text_caption",transform:k==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:k==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>Y(!0),onMouseLeave:()=>Y(!1)}}),e.jsxs(j,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(bs,{marketPrice:g,priceImpactInfoLoading:w,priceImpactInfo:f,priceImpact:R,inputPrice:C,setInputPrice:b,handleMarketPriceClick:r}),e.jsx(fs,{})]}),(f==null?void 0:f.text)&&g&&Number(R)!==0&&C&&e.jsxs(_,{color:f==null?void 0:f.color,lineHeight:"20px",bg:f==null?void 0:f.bg,p:"12px",borderRadius:"8px",children:[f==null?void 0:f.text,"Â ",e.jsx(_,{color:f==null?void 0:f.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>K(`/swap/${c==null?void 0:c.coin_type}/${p==null?void 0:p.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(ie,{disabled:(n==null?void 0:n.disabled)||B,isLoading:B,mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",onClick:(n==null?void 0:n.text)=="Connect Wallet"?()=>z(!0):()=>y(!0),children:n==null?void 0:n.text}),I&&e.jsx(gs,{confirmData:N,isOpen:I,onClose:()=>y(!1),handleSubmitOrder:A,submitOrderLoading:B}),(c||p)&&e.jsx(It,{addToken:!0,tokensInfo:L,waringModalCancel:S=>{S.forEach(ee=>{(ee.coin_type===(c==null?void 0:c.coin_type)||ee.coin_type===(p==null?void 0:p.coin_type))&&x(void 0,ee.coin_type===(c==null?void 0:c.coin_type))})}})]})}function Ss({orderInfo:t}){return e.jsxs(he.Fragment,{children:[e.jsxs(H,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(v,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(v,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(v,{textAlign:"right",children:e.jsx(Pe,{orderInfo:t})})]}),e.jsx(H,{h:"16px"})]},t==null?void 0:t.order_id)}function _s(){const{currentAccount:t,onWalletModal:n}=Q(),{myOrderList:i,orderListLoading:u}=Te(),h=10,[l,d]=o.useState([]),[m,c]=o.useState(0),[p,g]=o.useState(1);return o.useEffect(()=>{if((i==null?void 0:i.length)>0){c(i==null?void 0:i.length);const s=(p-1)*h,r=s+h;d(i.slice(s,r))}},[p,i]),e.jsxs(Ie,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(et,{children:e.jsxs(H,{children:[e.jsx($,{children:"Order Info"}),e.jsx($,{textAlign:"right",children:"Price"}),e.jsx($,{textAlign:"right",children:"Filled Size"}),e.jsx($,{textAlign:"right",children:"Expiry"}),e.jsx($,{textAlign:"right",children:"Action"})]})}),e.jsx(tt,{children:t!=null&&t.address?u?e.jsx(mt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):i.length===0?e.jsx(H,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(he.Fragment,{children:[l.map(s=>e.jsx(Ss,{orderInfo:s},s.order_id)),!u&&(i==null?void 0:i.length)>h&&e.jsx(v,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(me,{w:"100%",children:e.jsx(ge,{total:m,size:h,currentPage:p,onChange:g})})})]}):e.jsx(H,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(v,{colSpan:5,w:"100%",children:e.jsx(G,{type:"nowallet",onboard:()=>{n(!0)},borderRadius:"16px"})})})})]})}function Sr(){const{currentAccount:t}=Q(),{getLimitOrderHistory:n,historyOrderList:i,historyOrderLoading:u}=Kt(),{fetchMyLimitOrder:h}=ut(),{setMyOrderList:l,myOrderList:d,orderListLoading:m}=Te(),{payCoin:c,targetCoin:p}=U(),{fetchAccountBalance:g}=ht();o.useEffect(()=>{t!=null&&t.address&&g()},[]);const{isShowTradeChart:s,isShowTradeOrders:r}=ns(),[x,C]=o.useState([]),[b,R]=o.useState({label:"Open Orders"}),E=o.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",d);const k=[];return k.push({label:"Open Orders",num:b.label==="Open Orders"&&d.length>0&&!m?d.length.toString():void 0}),k.push({label:"Order History",num:b.label==="Order History"&&x.length>0&&!u?x.length.toString():void 0}),k},[b.label,d,x,u,m]);o.useEffect(()=>{A(!0)},[b.label,t,r]),cs({onRpcChange:()=>{A(!0),t!=null&&t.address&&g()}});const A=k=>{r&&(z(0),console.log("ðŸš€  ~ currentAccount:",b.label==="Open Orders",t==null?void 0:t.address),t!=null&&t.address&&(b.label==="Open Orders"?h(t.address,k):(console.log("ðŸš€ ~  ~ currentAccount:",t),n(t.address,k))))};o.useEffect(()=>{t!=null&&t.address&&(i==null?void 0:i.length)>0?C(i):(C([]),l([]))},[i,t==null?void 0:t.address]);const B=k=>{R(k)},{windowWidth:V,isApp:w}=ae(),{refreshCoinMarketPrice:f}=jt(),[N,z]=o.useState(0);return os({interval:1e3,callback:()=>{z(N+1),N>=20&&(z(0),f(),t!=null&&t.address&&g(),A(!1))}}),e.jsxs(M,{mt:V&&V<1024?"28px":"42px",w:"100%",gap:"0px",className:w||s||r?"":"bg_img",children:[e.jsxs(j,{w:"100%",justifyContent:"center",alignItems:"start",gap:"16px",flexDirection:{base:s?"column":"column-reverse",lg:"row"},children:[(r||s)&&e.jsx(j,{gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:s?e.jsx(as,{baseToken:c,quoteToken:p}):e.jsxs(M,{w:"100%",children:[e.jsx(Ze,{tabList:E,currTab:b,myOrderList:d,handleChangeTab:B,handleGetOrderList:A}),b.label==="Open Orders"&&e.jsx(Je,{}),b.label==="Order History"&&e.jsx(Xe,{historyOrderList:x,historyOrderLoading:u})]})}),e.jsx(ws,{})]}),r&&s&&e.jsxs(M,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(Ze,{handleGetOrderList:()=>A(!0),tabList:E,currTab:b,myOrderList:d,handleChangeTab:B}),w&&e.jsx(qe,{h:"16px"}),b.label==="Open Orders"&&(w?e.jsx(Je,{}):e.jsx(_s,{})),b.label==="Order History"&&(w?e.jsx(Xe,{historyOrderList:x,historyOrderLoading:u}):e.jsx(xs,{historyOrderList:x,historyOrderLoading:u}))]})]})}const Ze=({tabList:t,currTab:n,myOrderList:i,handleChangeTab:u,handleGetOrderList:h})=>{const{handleCancelOrder:l,cancelOrderLoading:d}=Qt(),{isApp:m}=ae(),c=n.label==="Open Orders"&&i.length>1;return e.jsxs(j,{w:"100%",justifyContent:"space-between",flexDirection:{base:n.label==="Open Orders"&&i.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(j,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx(Gt,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:t,currentTab:n.label,handleChangeTab:u}),m&&e.jsx(Ue,{handleRefresh:h,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!m||c)&&e.jsxs(j,{gap:"8px",w:{base:"100%",lg:"unset"},children:[c&&e.jsx(ie,{onClick:()=>{l(i)},disabled:d,isLoading:d,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"-8px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!m&&e.jsx(Ue,{handleRefresh:h,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{Sr as default};
//# sourceMappingURL=Limit-a_WIhCRG.js.map

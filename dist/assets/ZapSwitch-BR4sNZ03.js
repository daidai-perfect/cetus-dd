import{a as g,j as o,V as oe,v as Ue,f as ve,H as I,T as H,u as je,S as st,ar as Ge,P as nt,h as ot,m as rt,n as it}from"./vendor-_1sPVx0S.js";import{u as Fe}from"./global-CG4XJcf0.js";import{ak as at,au as Ee,bL as ct,h as Xe,k as Le,e as Ke,m as We,d as E,O as Je,o as Me,am as $e,r as he,X as Te,i as de,a as Qe,bM as Ye,I as ke,f as De,S as lt,K as ut,a2 as ze,aE as Pe,M as dt,R as Ze,c as pt,bN as mt,B as xt}from"./index-DZworFuu.js";import{v as Ne}from"./v4-C6aID195.js";import{D as ft}from"./DepositRatio-LVV2d-h7.js";import{F as gt}from"./FreshProgressV2-B_THDS6m.js";import{u as ht,M as bt}from"./usePriceImpact-tW62EcgX.js";import{d as yt,c as At,f as _t}from"./useGetPoolList-CsB88aY2.js";import{E as Oe}from"./ErrorTips-DTGb4xHZ.js";import{S as wt}from"./Slippage-Bya5o8Ip.js";import{c as qe,u as St}from"./useNotifiSubscription-BHSFkP5y.js";import{a as jt}from"./usePositionList-DCRYUjtM.js";import{u as et}from"./index-cNVIru_O.js";import{u as Rt}from"./useToken-BWHB2fhl.js";import{u as Tt}from"./useTokenBalance-Bm-sJqFs.js";var vt=/\s/;function kt(t){for(var s=t.length;s--&&vt.test(t.charAt(s)););return s}var Zt=/^\s+/;function Bt(t){return t&&t.slice(0,kt(t)+1).replace(Zt,"")}var Ve=NaN,Et=/^[-+]0x[0-9a-f]+$/i,Ft=/^0b[01]+$/i,Lt=/^0o[0-7]+$/i,Wt=parseInt;function Ie(t){if(typeof t=="number")return t;if(at(t))return Ve;if(Ee(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=Ee(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=Bt(t);var e=Ft.test(t);return e||Lt.test(t)?Wt(t.slice(2),e?2:8):Et.test(t)?Ve:+t}var Be=function(){return ct.Date.now()},Ct="Expected a function",Mt=Math.max,$t=Math.min;function Dt(t,s,e){var p,l,x,i,n,A,_=0,C=!1,F=!1,S=!0;if(typeof t!="function")throw new TypeError(Ct);s=Ie(s)||0,Ee(e)&&(C=!!e.leading,F="maxWait"in e,x=F?Mt(Ie(e.maxWait)||0,s):x,S="trailing"in e?!!e.trailing:S);function b(m){var U=p,D=l;return p=l=void 0,_=m,i=t.apply(D,U),i}function c(m){return _=m,n=setTimeout(M,s),C?b(m):i}function f(m){var U=m-A,D=m-_,ee=s-U;return F?$t(ee,x-D):ee}function u(m){var U=m-A,D=m-_;return A===void 0||U>=s||U<0||F&&D>=x}function M(){var m=Be();if(u(m))return q(m);n=setTimeout(M,f(m))}function q(m){return n=void 0,S&&p?b(m):(p=l=void 0,i)}function j(){n!==void 0&&clearTimeout(n),_=0,p=A=l=n=void 0}function $(){return n===void 0?i:q(Be())}function P(){var m=Be(),U=u(m);if(p=arguments,l=this,A=m,U){if(n===void 0)return c(A);if(F)return clearTimeout(n),n=setTimeout(M,s),b(A)}return n===void 0&&(n=setTimeout(M,s)),i}return P.cancel=j,P.flush=$,P}const Nt=(t,s)=>({fromAmount:"",setFromAmount:e=>{t(()=>({fromAmount:e}))},fromAmountValue:"",setFromAmountValue:e=>{t(()=>({fromAmountValue:e}))},toAmount:"",setToAmount:e=>{t(()=>({toAmount:e}))},toAmountValue:"",setToAmountValue:e=>{t(()=>({toAmountValue:e}))},liquidityAmount:"",setLiquidityAmount:e=>{t(()=>({liquidityAmount:e}))},tokenMaxA:"",setTokenMaxA:e=>{t(()=>({tokenMaxA:e}))},tokenMaxB:"",setTokenMaxB:e=>{t(()=>({tokenMaxB:e}))},byAmountIn:!0,setByAmountIn:e=>{t(()=>({byAmountIn:e}))},isTokenA:!0,setIsTokenA:e=>{t(()=>({isTokenA:e}))},percentMap:{percentA:"0",percentB:"0"},setPercentMap:e=>{t(()=>({percentMap:e}))},isFullRange:!1,setIsFullRange:e=>{t(()=>({isFullRange:e}))},fromToken:void 0,setFromToken:e=>{t(()=>({fromToken:e}))},fromTokenLock:!1,setFromTokenLock:e=>{t(()=>({fromTokenLock:e}))},toToken:void 0,setToToken:e=>{t(()=>({toToken:e}))},toTokenLock:!1,setToTokenLock:e=>{t(()=>({toTokenLock:e}))},totalAmount:void 0,setTotalAmount:e=>{t(()=>({totalAmount:e}))},autoStakePosition:!1,setAutoStakePosition:e=>{t(()=>({autoStakePosition:e}))},isFarmRewardsRange:!1,setIsFarmRewardsRange:e=>{t(()=>({isFarmRewardsRange:e}))},useZapIn:!1,setUseZapIn:e=>{t(()=>({useZapIn:e}))},confirmModalOpen:!1,setConfirmModalOpen:e=>{t(()=>({confirmModalOpen:e}))},nftOpen:!1,setNftOpen:e=>{t(()=>({nftOpen:e}))},relatedPosId:"",setRelatedPosId:e=>{t(()=>({relatedPosId:e}))},resetAddLiquidity:()=>{t(()=>({isFarmRewardsRange:!1,autoStakePosition:!1,totalAmount:void 0,fromTokenLock:!1,fromToken:void 0,toTokenLock:!1,toToken:void 0,isFullRange:!1,percentMap:{percentA:"0",percentB:"0"},fromAmount:"",toAmount:"",fromAmountValue:"",toAmountValue:"",liquidityAmount:"",byAmountIn:!0,isTokenA:!0,useZapIn:!1,nftOpen:!1,relatedPosId:""}))}}),tt=Xe(Nt),Ot=(t,s)=>({currentTokens:[],setCurrentTokens:e=>{t(()=>({currentTokens:e}))},zapAmount:"",setZapAmount:e=>{t(()=>({zapAmount:e}))},currentZapToken:void 0,setCurrentZapToken:e=>{t(()=>({currentZapToken:e}))},zapAmountRate:"",setZapAmountRate:e=>{t(()=>({zapAmountRate:e}))},zapTokenBalance:void 0,setZapTokenBalance:e=>{t(()=>({zapTokenBalance:e}))},isPreLoading:!1,setIsPreLoading:e=>{t(()=>({isPreLoading:e}))},preDepositeData:void 0,setPreDepositeData:e=>{t(()=>({preDepositeData:e,isPreLoading:!1}))},zapApiPool:void 0,setZapApiPool:e=>{t(()=>({zapApiPool:e}))},lower:0,setLower:e=>{t(()=>({lower:e}))},upper:0,setUpper:e=>{t(()=>({upper:e}))},liquidity:"",setLiquidity:e=>{t(()=>({liquidity:e}))},zapCurrPriceData:{},setZapCurrPriceData:e=>{t(()=>({zapCurrPriceData:e}))},zapSlideValue:0,setZapSlideValue:e=>{t(()=>({zapSlideValue:Number(e==="--"?0:e)}))},posOriginAmounts:{},setPosOriginAmounts:e=>{t(()=>({posOriginAmounts:e}))},resetZapData:()=>{t(()=>({zapAmount:"",zapAmountRate:"",lower:0,upper:0,preDepositeData:void 0,isPreLoading:!1,liquidity:"",zapSlideValue:0,posOriginAmounts:{}}))}}),Ce=Xe(Ot);function qt(t="Deposit"){var Ae,_e;const{zapAmount:s,currentZapToken:e,zapAmountRate:p,zapTokenBalance:l,isPreLoading:x,preDepositeData:i,zapApiPool:n,setIsPreLoading:A,lower:_,upper:C,liquidity:F,zapCurrPriceData:S,setPreDepositeData:b,zapSlideValue:c}=Ce();console.log("ðŸš€ ~ useZapSubmit ~ zapCurrPriceData:",S);const{currentAccount:f,onWalletModal:u}=Le(),{setConfirmModalOpen:M}=tt(),{zapSdk:q}=Ke(),{zapSlippage:j,slippage:$}=Fe(),[P,m]=g.useState(""),[U,D]=g.useState(!1),{getTokenPrice:ee}=We(),G=ee((Ae=n==null?void 0:n.tokenA)==null?void 0:Ae.coin_type),h=ee((_e=n==null?void 0:n.tokenB)==null?void 0:_e.coin_type),be=g.useMemo(()=>{if(G&&h)return E(G.price).div(h.price).toString()},[G==null?void 0:G.price,h==null?void 0:h.price]),ye=g.useMemo(()=>{const a={text:t==="Withdraw"?"Zap Out":"Zap In",disabled:!1};return f!=null&&f.address?!s||s&&!+s?(a.text="Enter an amount",a.disabled=!0,a):E(s).gt((l==null?void 0:l.balanceFormat)||0)?(a.disabled=!0,a.text=`Insufficient ${Je(l==null?void 0:l.symbol,10)} Balance`,a):((E(p).gt(1e4)||E(p).gt(0)&&E(p).lt(1e-4))&&(a.disabled=!0),a):(a.text="Connect Wallet",a.disabled=!1,a)},[f==null?void 0:f.address,s,e==null?void 0:e.coin_type,x,t,l==null?void 0:l.balanceFormat]),te=Dt(()=>{f?M(!0):u(!0)},300,{leading:!0,trailing:!1}),L=()=>{const a=i==null?void 0:i.amount_a,d=i==null?void 0:i.amount_b,r=n==null?void 0:n.tokenA,y=n==null?void 0:n.tokenB,X=n==null?void 0:n.displayTokenA,V=n==null?void 0:n.displayTokenB,W=de(n!=null&&n.isReverse?d:a,n!=null&&n.isReverse?y==null?void 0:y.decimals:r==null?void 0:r.decimals),N=de(n!=null&&n.isReverse?a:d,n!=null&&n.isReverse?r==null?void 0:r.decimals:y==null?void 0:y.decimals);return{amountA:a,amountB:d,tokenA:r,tokenB:y,displayTokenA:X,displayTokenB:V,dispalyAmountA:W,dispalyAmountB:N}},ae=()=>{const{displayTokenA:a,displayTokenB:d,dispalyAmountA:r,dispalyAmountB:y}=L();return{getShowInfo:(V,W)=>{const N=!r&&!y?`Add ${r} ${a==null?void 0:a.symbol} and ${y} ${d==null?void 0:d.symbol}`:r?y?"Add Liquidity":`Add ${y} ${d==null?void 0:d.symbol}`:`Add ${r} ${a==null?void 0:a.symbol}`,O={modalDescriptionText:N,toastTitleText:N};if(V==="success"){let Q=r,K=y;W&&(Q=Te(W,a)||r,K=Te(W,d)||y);const z=!r&&!y?`Add ${Q} ${a==null?void 0:a.symbol} and ${K} ${d==null?void 0:d.symbol}`:!r&&y?`Add ${Q} ${a==null?void 0:a.symbol}`:!y&&r?`Add ${K} ${d==null?void 0:d.symbol}`:"Add Liquidity";O.toastDescriptionContent=z,O.modalDescriptionText=z,O.toastTitleText="Supplied Successful"}return O}}},k=async(a,d,r,y)=>{console.log("ðŸš€ ~ getZapDepositTx ~ isFarm:",r);const{tokenA:X,tokenB:V}=L(),W={deposit_obj:i,pool_id:n==null?void 0:n.poolAddress,coin_type_a:X==null?void 0:X.coin_type,coin_type_b:V==null?void 0:V.coin_type,tick_lower:a,tick_upper:d,slippage:Number($),swap_slippage:Number(j)};y&&(W.pos_obj=y),r&&(W.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("getZapTx buildDepositPayload params: ",W);const N=await q.Zap.buildDepositPayload(W);return console.log("ðŸš€ ~ getZapTx ~ tx:",N),N},T=(a,d)=>{const{displayTokenA:r,displayTokenB:y,dispalyAmountA:X,dispalyAmountB:V}=L();return{getShowInfo:(N,O)=>{const Q=`Withdraw ${he(s,e==null?void 0:e.decimals)} ${e==null?void 0:e.symbol}`,K={modalDescriptionText:Q,toastTitleText:Q};return N==="success"&&(O&&(Te(O,r),Te(O,y)),K.toastDescriptionContent="",K.modalDescriptionText="",K.toastTitleText="Remove Liquidity Successful"),K}}},pe=async(a,d,r,y,X,V)=>{console.log("ðŸš€ ~ getZapWithdrawTx ~ isFarm:",V),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx preDepositeData:",i);const{tokenA:W,tokenB:N}=L(),O={withdraw_obj:i,pool_id:n==null?void 0:n.poolAddress,pos_id:a,close_pos:(i==null?void 0:i.burn_liquidity)===d,collect_fee:!0,collect_rewarder_types:X,coin_type_a:W==null?void 0:W.coin_type,coin_type_b:N==null?void 0:N.coin_type,tick_lower:r,tick_upper:y,slippage:Number($),swap_slippage:Number(j)};return V&&(O.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx params:",O),await q.Zap.buildWithdrawPayload(O)},Y=g.useRef({}),me=g.useRef(null),J=g.useRef("");g.useEffect(()=>{Y.current={currentZapToken:e,zapApiPool:n,zapAmount:s,currentSqrtPrice:S==null?void 0:S.currentSqrtPrice,lower:_,upper:C,liquidity:F,zapSlippage:j,zapAmountRate:p,marketPrice:be}},[e==null?void 0:e.coin_type,n==null?void 0:n.poolAddress,s,S==null?void 0:S.currentSqrtPrice,_,C,F,j,p,be]);const xe=g.useMemo(()=>!!(e!=null&&e.decimals&&E(s).mul(Math.pow(10,e==null?void 0:e.decimals)).eq(1)),[e==null?void 0:e.decimals,s]),B=async a=>{var w,Z,R,v,ne;console.log("ðŸš€ ~ preZapIn ~ preZapIn:",B);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:V,upper:W,liquidity:N,zapSlippage:O,marketPrice:Q}=Y.current;A(!0);const z=(d==null?void 0:d.coin_type)===((w=r==null?void 0:r.tokenA)==null?void 0:w.coin_type)?"OnlyCoinA":"OnlyCoinB",fe=$e(E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString(),0),ge={pool_id:r==null?void 0:r.poolAddress,tick_lower:V,tick_upper:W,current_sqrt_price:X,slippage:O,swap_slippage:Number($),mark_price:Q};console.log("ðŸš€ ~ preZapIn ~ options123:",ge);const ue={mode:z,coin_amount:fe,coin_type_a:(Z=r==null?void 0:r.tokenA)==null?void 0:Z.coin_type,coin_type_b:(R=r==null?void 0:r.tokenB)==null?void 0:R.coin_type,coin_decimal_a:(v=r==null?void 0:r.tokenA)==null?void 0:v.decimals,coin_decimal_b:(ne=r==null?void 0:r.tokenB)==null?void 0:ne.decimals};console.log("ðŸš€ ~ preZapIn ~ modeOptions:",ue);let se;try{se=await q.Zap.preCalculateDepositAmount(ge,ue),console.log("ðŸš€ ~ preZapIn ~ res:",se)}catch(re){console.log("ðŸš€ ~ preZapIn ~ error:",re),D(!0)}a===J.current&&b(se),A(!1)},ce=async a=>{var ge,ue,se,w,Z;A(!0);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:V,upper:W,liquidity:N,zapSlippage:O}=Y.current,K=(d==null?void 0:d.coin_type)===((ge=r==null?void 0:r.tokenA)==null?void 0:ge.coin_type)?"OnlyCoinA":"OnlyCoinB";E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString();const z={mode:K,pool_id:r==null?void 0:r.poolAddress,tick_lower:V,tick_upper:W,current_sqrt_price:X,coin_type_a:(ue=r==null?void 0:r.tokenA)==null?void 0:ue.coin_type,coin_type_b:(se=r==null?void 0:r.tokenB)==null?void 0:se.coin_type,coin_decimal_a:(w=r==null?void 0:r.tokenA)==null?void 0:w.decimals,coin_decimal_b:(Z=r==null?void 0:r.tokenB)==null?void 0:Z.decimals};E(y).gte(l==null?void 0:l.balanceFormat)?z.burn_liquidity=N:z.burn_liquidity=$e(E(N).mul(E(c).div(100)).toString(),0),console.log("ðŸš€ ~ preZapInRemove ~ options:",z);let fe;try{fe=await q.Zap.preCalculateWithdrawAmount(z),console.log("ðŸš€ ~ preZapInRemove ~ res:",fe)}catch(R){console.log("ðŸš€ ~ preZapOut ~ error:",R),D(!0)}a===J.current&&b(fe),A(!1)},we=Me(B,300),Se=Me(ce,300);g.useEffect(()=>{Re()},[s,e==null?void 0:e.coin_type,S==null?void 0:S.currentSqrtPrice,_,C,c,p]);const le=()=>{var a;(a=me.current)==null||a.reset()},Re=()=>{D(!1);const{zapAmount:a,zapAmountRate:d}=Y.current;if(console.log("ðŸš€ ~ reCalculateZapData ~ zapAmount:",a),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),!Number(a)||E(d).gt(1e4)||E(d).lt(1e-4)||xe){const y=Ne();J.current=y,b(void 0),A(!1);return}A(!0);const r=Ne();J.current=r,t=="Deposit"?we(r):Se(r)};return g.useEffect(()=>{le()},[s,n==null?void 0:n.poolAddress,t]),g.useEffect(()=>()=>{le(),Y.current=null},[]),{btnText:ye.text,btnDisabled:ye.disabled,handleZapIn:te,isPreLoading:x,getZapDepositToastInfo:ae,getZapDepositTx:k,getZapWithdrawToastInfo:T,getZapWithdrawTx:pe,zapProgressRef:me,handleResetZapProgress:le,reCalculateZapData:Re,isMinimumPrecision:xe,zapNotAvailable:U}}function as({action:t,onClick:s,hideAmountInfo:e,otherLoading:p,isReverse:l,inConfirmModal:x,hideDepositRatio:i}){const{currentAccount:n,onWalletModal:A}=Le(),{btnDisabled:_,btnText:C,handleZapIn:F,zapProgressRef:S,reCalculateZapData:b,isMinimumPrecision:c,zapNotAvailable:f}=qt(t),u=()=>{if(!n){A(!0);return}s?s():F()},[M,q]=g.useState(!1),{zapSlippage:j}=Fe(),{getTokenAmountValue:$}=We(),{zapSlideValue:P,preDepositeData:m,currentTokens:U,currentZapToken:D,zapAmount:ee,isPreLoading:G,zapApiPool:h,lower:be,upper:ye,zapCurrPriceData:te,posOriginAmounts:L,zapAmountRate:ae}=Ce(),{fromCoin:k,toCoin:T}=g.useMemo(()=>{var R;const w=D,Z=(R=U==null?void 0:U.filter(v=>(v==null?void 0:v.coin_type)!==(D==null?void 0:D.coin_type)))==null?void 0:R[0];return t==="Withdraw"?{fromCoin:Z,toCoin:w}:{fromCoin:w,toCoin:Z}},[D==null?void 0:D.coin_type,U,t]),{fromAmount:pe,toAmount:Y}=g.useMemo(()=>{var R,v;let w,Z;return m&&(k!=null&&k.coin_type)&&(T!=null&&T.coin_type)&&(w=de((R=m==null?void 0:m.swap_result)==null?void 0:R.swap_in_amount,k==null?void 0:k.decimals),Z=de((v=m==null?void 0:m.swap_result)==null?void 0:v.swap_out_amount,T==null?void 0:T.decimals)),{fromAmount:w,toAmount:Z}},[m,k==null?void 0:k.coin_type,T==null?void 0:T.coin_type]),{sources:me,priceImpactTextInfo:J,showPriceImpactTips:xe}=ht(k,T,pe,Y),[B,ce]=g.useState(!1),we=()=>{ce(!B)},Se=g.useMemo(()=>Y?he(E(Y).sub(E(Y).mul(j)).toString()):"--",[j,Y]),le=g.useMemo(()=>{var w;return(w=m==null?void 0:m.swap_result)==null?void 0:w.swap_price},[m]),Re=()=>{console.log("ZapRoute handleRefresh"),b()},{tokenA:Ae,tokenB:_e,coinAmountA:a,coinAmountB:d,displayCoinAmountA:r,displayCoinAmountB:y,displayTokenA:X,displayTokenB:V,displayAmountARate:W,displayAmountBRate:N,amountARate:O,amountBRate:Q}=g.useMemo(()=>{let w,Z,R,v,ne,re;const ie=h==null?void 0:h.isReverse;return m&&(h!=null&&h.poolAddress)&&(R=h==null?void 0:h.tokenA,v=h==null?void 0:h.tokenB,w=de(m==null?void 0:m.amount_a,R==null?void 0:R.decimals),Z=de(m==null?void 0:m.amount_b,v==null?void 0:v.decimals),ne=$(R==null?void 0:R.coin_type,w),re=$(v==null?void 0:v.coin_type,Z)),{displayCoinAmountA:ie?Z:w,displayCoinAmountB:ie?w:Z,displayTokenA:ie?v:R,displayTokenB:ie?R:v,displayAmountARate:ie?re:ne,displayAmountBRate:ie?ne:re,tokenA:R,tokenB:v,coinAmountA:w,coinAmountB:Z,amountARate:ne,amountBRate:re}},[m,h==null?void 0:h.poolAddress]),{originPosAmountA:K,originPosAmountB:z}=g.useMemo(()=>{let w="",Z="";if(h!=null&&h.poolAddress&&(L!=null&&L.coinAmountA||L!=null&&L.coinAmountB)){const R=h==null?void 0:h.tokenA,v=h==null?void 0:h.tokenB,ne=h==null?void 0:h.isReverse,re=de(L==null?void 0:L.coinAmountA,R==null?void 0:R.decimals),ie=de(L==null?void 0:L.coinAmountB,v==null?void 0:v.decimals);w=ne?ie:re,Z=ne?re:ie}return{originPosAmountA:w,originPosAmountB:Z}},[L,h==null?void 0:h.poolAddress]),[fe,ge]=g.useState({});g.useEffect(()=>{if(a||d){const w=yt(be,ye),Z=At(a||0,d||0,te==null?void 0:te.currentPrice,w);ge(Z)}},[a,d,te==null?void 0:te.currentPrice]);const{isApp:ue}=Qe(),se=g.useMemo(()=>E(ae).gt(1e4)?"In Zap mode, each request should be within $10,000.":E(ae).gt(0)&&(E(ae).lt(1e-4)||c)?"The input is too small. Zap mode is not available.":f?"Zap mode is not available.":"",[ae,t,c,f]);return o.jsx(o.Fragment,{children:o.jsxs(oe,{gap:"0px",w:"100%",borderRadius:"16px",border:"1px solid",borderColor:x?"rgba(0,0,0,0)":"border",bg:x?"none":"bg_six",p:{base:x?"0px":"0px 8px",lg:x?"0px":"0px 16px"},children:[!x&&o.jsx(Ue,{w:{base:"calc(100% + 16px)",lg:"calc(100% + 34px)"},h:"52px",margin:"-1px -1px 0px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:(G||_||p||xe||!!se)&&(n==null?void 0:n.address),isLoading:G||p,onClick:u,children:C}),!!Number(ee)&&o.jsx(oe,{w:"100%",gap:"0px",children:se?o.jsx(ve,{w:"100%",p:"12px 0px",children:o.jsx(Oe,{tips:se})}):o.jsxs(o.Fragment,{children:[xe&&o.jsx(ve,{w:"100%",pt:"12px",children:o.jsx(Oe,{tips:"High price difference. Be cautious before submitting your order."})}),x&&o.jsxs(I,{w:"100%",justify:"space-between",children:[o.jsx(H,{fontSize:"14px",color:"text_paragraph",children:"Zap Amount"}),o.jsx(H,{fontSize:"14px",color:"text_caption",children:Ye(ae,2)})]}),Number(ee)>0&&Number(pe)>0&&o.jsxs(oe,{w:"100%",gap:"12px",pt:"16px",pb:x?"0px":"16px",children:[o.jsx(I,{w:"100%",justify:"space-between",children:o.jsx(H,{fontSize:"14px",color:"text_paragraph",children:"Zap Route"})}),o.jsxs(oe,{w:"100%",bg:x?"bg_secondary":"none",borderRadius:"12px",p:x?"0px 12px":"0px",gap:x?"4px":"12px",border:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",flexDirection:t==="Withdraw"?"column-reverse":"column",children:[o.jsxs(oe,{w:"100%",align:"flex-start",bg:x?"none":"button_outline_hov_bg",p:x?"16px 0px":"16px 12px",borderRadius:x?"0px":"12px",borderBottom:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",children:[o.jsx(I,{w:"100%",align:"center",children:o.jsxs(oe,{w:"100%",align:"flex-start",onClick:()=>{q(!M)},children:[o.jsx(I,{w:"100%",justify:"flex-start",children:G?o.jsx(je,{w:"100%",h:"16px"}):o.jsxs(H,{w:"100%",fontSize:"12px",color:"text_caption",textAlign:"left",children:["Swap ",he(pe)," ",k==null?void 0:k.symbol," for ",Se," ",T==null?void 0:T.symbol]})}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(I,{w:"100%",justify:"space-between",align:{base:"flex-start",lg:"center"},flexDirection:{base:"column",lg:"row"},children:[o.jsxs(I,{gap:"4px",justify:"space-between",w:{base:"100%",lg:"unset"},children:[o.jsxs(I,{gap:"4px",children:[o.jsx(gt,{callbackInterval:20,ref:S,min:0,max:20,size:"14px",noBg:!0,thickness:"16px",onClick:Re}),o.jsxs(I,{flexWrap:"wrap",children:[o.jsx(H,{fontSize:"12px",color:"text_paragraph",children:"Price Difference"}),o.jsx(H,{color:J==null?void 0:J.textColor,fontSize:"12px",children:J==null?void 0:J.priceImpactText}),me==null?void 0:me.map(w=>o.jsx(bt,{market:w},w))]})]}),ue&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:M?"rotate(180deg)":"rotate(0deg)"})]}),o.jsxs(I,{align:"center",gap:"2px",children:[x?o.jsxs(I,{gap:"4px",children:[o.jsx(H,{fontSize:"12px",color:"text_paragraph",children:"Slippage"}),o.jsxs(H,{fontSize:"12px",color:"text_caption",children:[E(j).mul(100).toString(),"%"]})]}):o.jsx(wt,{slippageType:"zap",toolTipText:"Slippage Tolerance"}),!ue&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:M?"rotate(180deg)":"rotate(0deg)"})]})]})]})}),M&&o.jsxs(I,{w:"100%",justify:"space-between",bg:"bg_fifth",h:"52px",borderRadius:"12px",p:"0px 8px",children:[o.jsx(H,{fontSize:"12px",color:"text_paragraph",children:"Swap Rate"}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(I,{children:[B?o.jsxs(H,{fontSize:"12px",color:"text_caption",children:["1 ",T==null?void 0:T.symbol," = ",De(1/le)," ",k==null?void 0:k.symbol]}):o.jsxs(H,{fontSize:"12px",color:"text_caption",children:["1 ",k==null?void 0:k.symbol," = ",De(le)," ",T==null?void 0:T.symbol]}),o.jsx(ke,{xlinkHref:"#icon-icon_swap1",svgW:"16px",svgH:"16px",onClick:we})]})]})]}),o.jsxs(oe,{w:"100%",p:x?"16px 0px":"16px 12px",bg:x?"none":"button_outline_hov_bg",borderRadius:"12px",gap:"12px",children:[i?o.jsx(H,{w:"100%",textAlign:"left",fontSize:"12px",color:"text_caption",children:t==="Withdraw"?"Expected Amounts of Remove":"Expected Amounts to Add"}):o.jsx(ft,{tokenA:Ae,tokenB:_e,percentMap:fe,type:"zap",isLoading:G,isReverse:l,label:"Expected Amounts to Add"}),o.jsxs(I,{bg:"text_highlight_opacity.10",w:"100%",h:"52px",justify:"space-between",align:"center",borderRadius:"12px",children:[o.jsx(He,{token:l?_e:Ae,amount:l?he(P==100?z:d):he(P==100?K:a),rate:l?Q:O,loading:G}),o.jsx(ve,{bg:"bg_fifth",w:"1px",h:"100%"}),o.jsx(He,{token:l?Ae:_e,amount:l?he(P==100?K:a):he(P==100?z:d),loading:G,rate:l?O:Q,align:"right"})]})]})]})]})]})})]})})}function He({token:t,amount:s,rate:e,loading:p,align:l="left"}){return o.jsxs(I,{flex:"1",gap:"8px",p:"12px",justify:"flex-start",flexDirection:l==="left"?"row":"row-reverse",children:[p?o.jsx(st,{size:"20px"}):o.jsx(lt,{imageUrl:t==null?void 0:t.logo_url,w:"20px",h:"20px"}),o.jsxs(oe,{align:`flex-${l==="left"?"start":"end"}`,gap:"4px",children:[p?o.jsx(je,{w:"50px",h:"14px"}):o.jsxs(H,{fontSize:"12px",color:"text_caption",textAlign:`${l==="left"?"left":"right"}`,children:[s," ",Je(t==null?void 0:t.symbol,10)]}),p?o.jsx(je,{w:{base:"70px",lg:"100px"},h:"12px"}):o.jsx(H,{fontSize:"12px",color:"text_paragraph",children:Ye(e,2)})]})]})}const Vt="/assets/bg_alerts@2x-BsIoiXpE.png";function cs({subscriptionSource:t,title:s="Range Alerts",description:e="Receive alerts via Telegram, SMS, or email when this position goes out of range.",wrapStyle:p={}}){const{getPositionNotifiStatus:l}=qe(),{isChecked:x,setIsChecked:i,notifiAuthenticated:n,notifiSourceGroups:A,setIsShowNotifi:_,notifiSubscriptionLoading:C,notifiStatus:F,notifiSources:S}=ut(),{currentAccount:b}=Le(),{notifiUnSubscription:c,notifiSubscription:f}=St(),{currentPosBaseInfo:u}=jt();console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:29 ~ currentPosBaseInfo:",u),g.useEffect(()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: RangeAlerts.tsx:42 ~ notifiSubscriptionLoading:",C),b!=null&&b.address&&t=="PositionDetail"&&u&&F=="authenticated"&&!C){const{isSubscription:j}=l(u.posId,String(u.index));i(j)}},[b,t,u,n,A,C,S]);const{createNotifiSubscriptionVerify:M}=qe(),q=async j=>{if(i(j),console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:46 ~ changeSwitch ~ checked:",j),j){const $=await M();if(console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:49 ~ changeSwitch ~ canSubscription:",$),!$)return i(!1),!1}if(t=="AddLiquidity")i(j);else if(t=="PositionDetail")if(console.log("ðŸš€ðŸš€ðŸš€ ~ changeSwitch ~ checked:",j),j){const $={subscriptionSource:"PositionDetail",position:u==null?void 0:u.posId,pool:u==null?void 0:u.clmmPool,posIndex:String(u==null?void 0:u.index)};f($)}else c(u==null?void 0:u.posId,u==null?void 0:u.clmmPool,u==null?void 0:u.index)};return g.useEffect(()=>()=>{i(!1)},[]),o.jsx(I,{w:"100%",bgImage:Vt,bgSize:"100% 100%",p:"16px",borderRadius:"8px",...p,children:o.jsxs(oe,{w:"100%",gap:"8px",children:[o.jsxs(I,{w:"100%",justify:"space-between",children:[o.jsx(H,{color:"primary",children:s}),F=="authenticated"?o.jsx(Ge,{isChecked:x,disabled:C,onChange:j=>q(j.target.checked)}):o.jsx(Ue,{w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",onClick:()=>_(!0),children:"Set up"})]}),o.jsx(H,{color:"primary_gray",lineHeight:"20px",textAlign:"left",children:e})]})})}function It(){const{setCurrentPriceData:t}=et();return{getCurrentPrice:(e,p)=>{if(p.tokenA&&p.tokenB){const l=p.tokenA.decimals,x=p.tokenB.decimals,i=ze.sqrtPriceX64ToPrice(new Pe(e),l,x).toString(),n=E(1).div(i).toString(),A={currentPrice:i,reverseCurrentPrice:n,currentSqrtPrice:e,pool:p.poolAddress};t(A)}}}}function ls(){const{clmmSdk:t}=dt(),{fetchTokenInfo:s}=Rt(),{contractPoolInfo:e,setContractPoolInfo:p,setContractPoolInfoLoading:l,apiPoolInfo:x,setApiPoolInfo:i,setApiPoolInfoLoading:n}=et(),{setFromToken:A,setToToken:_}=tt(),{getCurrentPrice:C}=It(),F=async b=>{l(!0);let c=null;try{if(c=await t.Pool.getPool(b),console.log("ðŸš€ ~ getContractPoolInfo ~ poolInfo:",{poolInfo:c,apiPoolInfo:x}),(x==null?void 0:x.displayTokenA)===void 0){const f=await S(c);f&&(i(f),n(!1),C(c==null?void 0:c.current_sqrt_price,f),A(f==null?void 0:f.displayTokenA),_(f==null?void 0:f.displayTokenB))}}catch(f){console.log("getContractPoolInfo ~ error:",f)}finally{l(!1)}return e?c?(p(c),c):e:(p(c||null),c)};async function S(b){const c=await s(b.coinTypeA),f=await s(b.coinTypeB);if(c&&f){const u=`${c==null?void 0:c.symbol} - ${f==null?void 0:f.symbol}`,M=Ze(b.fee_rate).div(100).toString(),q=Ze(b.fee_rate).div(1e4).toString(),j=Ze(M).div(100).toString()+"%",$=!_t(b.coinTypeA,b.coinTypeB);return{poolAddress:b.poolAddress,name:u,isReverse:$,tokenA:c,tokenB:f,displayTokenA:$?f:c,displayTokenB:$?c:f,haveMining:!1,miningRewardList:null,miningAprList:null,haveFarming:!1,farmsRewarderList:null,farmsApr:"",farmingAprDisplay:"",feeApr:"",feeAprDisplay:"",miningAprTotal:"",feeAndMiningAprDisplay:"",totalAprDisplay:"",fee:q,feeRate:M,feeDisplay:j,tvlDisplay:"0",volume24Display:"0",fees24Display:"0",isVaults:!1,tickSpacing:b.tickSpacing.toString()}}}return{getContractPoolInfo:F}}function Ht({tokens:t,current:s,onSelect:e}){const p=g.useMemo(()=>t==null?void 0:t.map(i=>({label:i==null?void 0:i.symbol,value:i==null?void 0:i.coin_type})),[t]),l=g.useMemo(()=>{var i;return(i=p==null?void 0:p.filter(n=>(n==null?void 0:n.value)===(s==null?void 0:s.coin_type)))==null?void 0:i[0]},[p,s==null?void 0:s.coin_type]),x=i=>{var A;const n=(A=t==null?void 0:t.filter(_=>(_==null?void 0:_.coin_type)===(i==null?void 0:i.value)))==null?void 0:A[0];e(n)};return o.jsx(ve,{w:"100%",mb:"8px",children:o.jsx(pt,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:l==null?void 0:l.label,tabList:p,handleChangeTab:x})})}function Ut(t,s,e,p,l,x,i,n,A,_){const{currentTokens:C,setCurrentTokens:F,zapAmount:S,setZapAmount:b,currentZapToken:c,setCurrentZapToken:f,zapAmountRate:u,setZapAmountRate:M,setZapTokenBalance:q,zapTokenBalance:j,setPreDepositeData:$,setIsPreLoading:P,setZapApiPool:m,lower:U,upper:D,setLower:ee,setUpper:G,setZapCurrPriceData:h,resetZapData:be,setLiquidity:ye,setZapSlideValue:te,setPosOriginAmounts:L}=Ce(),{zapSdk:ae}=Ke(),{zapSlippage:k}=Fe(),{balanceInfo:T}=Tt(c),{getTokenAmountValue:pe}=We(),[Y,me]=g.useState("");g.useEffect(()=>{ee(p)},[p]),g.useEffect(()=>{G(l)},[l]),g.useEffect(()=>{ye(n||"")},[n]),g.useEffect(()=>{te(A||0)},[A]),g.useEffect(()=>{L({coinAmountA:_==null?void 0:_.coinAmountA,coinAmountB:_==null?void 0:_.coinAmountB})},[_]),g.useEffect(()=>{var B,ce;if(s!=null&&s.poolAddress&&e){const we=(B=s==null?void 0:s.tokenA)==null?void 0:B.decimals,Se=(ce=s==null?void 0:s.tokenB)==null?void 0:ce.decimals,le=ze.sqrtPriceX64ToPrice(new Pe(e),we,Se).toString();h({currentPrice:le,currentSqrtPrice:e})}},[e,s==null?void 0:s.poolAddress]),g.useEffect(()=>{let B=[];s!=null&&s.poolAddress&&(B=[s==null?void 0:s.displayTokenA,s==null?void 0:s.displayTokenB],f(s==null?void 0:s.displayTokenA)),F(B),m(s)},[s==null?void 0:s.poolAddress]);const J=B=>{b(B)},xe=B=>{f(B),b("")};return g.useEffect(()=>{let B;S&&(c!=null&&c.coin_type)&&(B=pe(c==null?void 0:c.coin_type,S)),M(B||"")},[S,c==null?void 0:c.coin_type]),g.useEffect(()=>{var B;if(t==="Deposit")q(T);else{const ce=(c==null?void 0:c.coin_type)===((B=s==null?void 0:s.tokenA)==null?void 0:B.coin_type);q(ce?{balanceFormat:x}:{balanceFormat:i})}},[t,T,x,i,c==null?void 0:c.coin_type,s==null?void 0:s.poolAddress]),g.useEffect(()=>()=>{be()},[]),{currentTokens:C,zapAmount:S,zapAmountRate:u,handleChangeAmount:J,currentZapToken:c,handleChangeZapToken:xe,zapTokenBalance:j,zapSlippage:k}}function us({action:t,apiPoolInfo:s,currentSqrtPrice:e,lowerTick:p,upperTick:l,onlyAmountA:x,onlyAmountB:i,liquidity:n,slideValue:A,currentPosLiquidityData:_}){const{currentTokens:C,currentZapToken:F,handleChangeZapToken:S,zapAmount:b,zapAmountRate:c,handleChangeAmount:f,zapTokenBalance:u}=Ut(t,s,e,p,l,x,i,n,A,_);return g.useEffect(()=>{t==="Withdraw"&&E(b).gt((u==null?void 0:u.balanceFormat)||"0")&&f(u==null?void 0:u.balanceFormat)},[b,t,u==null?void 0:u.balanceFormat]),o.jsxs(oe,{w:"100%",children:[o.jsx(Ht,{tokens:C,current:F,onSelect:S}),o.jsx(mt,{wrapStyle:{h:"108px"},placeholder:"0.0",value:b,onChange:f,balance:(u==null?void 0:u.balanceFormat)||"",amountValue:c,token:F,needRemainBalance:t!=="Withdraw",balanceLabel:t==="Withdraw"?"Available":void 0})]})}function ds(t){const{value:s,action:e,onChange:p}=t,{isApp:l}=Qe();return o.jsx(xt,{padding:"6px 8px",borderRadius:"8px",width:"unset",children:o.jsxs(nt,{isLazy:!0,trigger:l?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[o.jsx(ot,{children:o.jsxs(I,{h:"14px",cursor:"pointer",children:[o.jsxs(H,{whiteSpace:"nowrap",fontSize:"14px",color:s?"primary":"",fontWeight:"500",children:["Zap ",e==="Deposit"?"In":"Out"]}),o.jsx(Ge,{isChecked:s,onChange:()=>{p()}})]})}),o.jsx(rt,{children:o.jsx(it,{p:"12px",lineHeight:"20px",fontSize:"12px",children:e=="Deposit"?"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ":"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."})})]})})}export{cs as R,as as Z,ls as a,qt as b,Ce as c,Dt as d,ds as e,us as f,It as g,tt as u};
//# sourceMappingURL=ZapSwitch-BR4sNZ03.js.map

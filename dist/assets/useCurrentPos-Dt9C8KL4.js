import{c as H,i as I,d as L}from"./usePositionList-EFhDdfru.js";import{U as w,aI as A}from"./index-RYgVkSoi.js";const B=(s,l)=>({isPosHistoryLoading:!0,setIsPosHistoryLoading:o=>{s(()=>({isPosHistoryLoading:o}))},curPosHistoryList:[],setCurPosHistoryList:o=>{s(()=>({curPosHistoryList:o}))},currentPosDetailTab:"increase",setCurrentPosDetailTab:o=>{s(()=>({currentPosDetailTab:o}))},tokenAmountA:"",setTokenAmountA:o=>{s(()=>({tokenAmountA:o}))},tokenAmountB:"",setTokenAmountB:o=>{s(()=>({tokenAmountB:o}))},isFixedDisplayTokenA:!0,setIsFixedDisplayTokenA:o=>{s(()=>({isFixedDisplayTokenA:o}))},slideValue:"--",setSlideValue:o=>{s(()=>({slideValue:o}))},currentPosPoolInfo:null,setCurrentPosPoolInfo:o=>{s(()=>({currentPosPoolInfo:o}))},currentPoolSqrtPrice:"",setCurrentPoolSqrtPrice:o=>{s(()=>({currentPoolSqrtPrice:o}))},curPosContractPoolInfo:null,setCurPosContractPoolInfo:o=>{s(()=>({curPosContractPoolInfo:o}))}}),h=w(B);function S(){const{clmmSdk:s}=A(),{posBaseList:l,setCurrentPosBaseInfo:o,setCurrentPosBaseInfoLoading:m}=H(),{setCurPosHistoryList:d,setIsPosHistoryLoading:P}=h(),{buildPosBaseInfo:g}=I(),{getPosRelatedData:C}=L(),p=async(a,e,r=!1)=>{m(!0);const i=l.find(t=>t.id===e);let n;i&&!r?n=i:n=await f(a,e),console.log("getCurrentPosBaseInfo ~ posInfo:",n),o(n),n&&C([n])},f=async(a,e)=>{const r=await s.fullClient.getOwnedObjectsByPage(a,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{ObjectId:e}});return r&&r.data&&r.data.length>0?g(r.data[0]):null},y=async(a,e)=>{var i;const r=["https://mainnet.suiet.app:443","https://rpc-mainnet.suiscan.xyz:443"];for(const n of r)try{const t=await s.Position.getPositionTransactionList({posId:a,fullRpcUrl:n,originPosId:e,order:"descending"});if(console.log("ðŸš€ ~ getCurrentPosHistory ~ response?.data:",t==null?void 0:t.data,n),((i=t==null?void 0:t.data)==null?void 0:i.length)>0)return t.data}catch(t){console.error(`Error fetching data from ${n}:`,t)}return[]};return{getCurrentPosBaseInfo:p,getCurrentPosHistory:async(a,e)=>{console.log("ðŸš€ ~ getCurrentPosHistory ~ posId:",a,e),P(!0);const r=await y(a,e),i=a.toLowerCase()!==e.toLowerCase()?await y(e,e):[];console.log("ðŸš€ ~ getCurrentPosHistory ~ clmmHistory:",r,i,[...r,...i]);const t=[...r,...i].sort((c,u)=>(u==null?void 0:u.timestampMs)-(c==null?void 0:c.timestampMs));d(t),P(!1),console.log("ðŸš€ ~ getCurrentPosHistory ~ result:",t)},getCurrentPosByPosId:f}}export{S as a,h as u};

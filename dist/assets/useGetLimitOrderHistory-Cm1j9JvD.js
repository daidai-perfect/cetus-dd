import{j as e,H as l,T as c,V as S,aq as we,a as w,X as re,Y as le,Z as ce,$ as oe,a8 as xe,a0 as pe,a1 as de,f as fe,v as E,u as $,C as se}from"./vendor-C6OgHlW5.js";import{Z as Ce,v as L,aV as ue,x as Q,am as ae,e as q,a as I,B,I as v,G as T,q as K,R as Le,j as me,k as ee,aX as G,aP as k,aW as ge,a0 as H,d as U,i as Oe,N as Se,c as ve,F as ie,u as He,b3 as ke}from"./index-BcaB9c-7.js";import{I as ne}from"./IconText-COTm5ial.js";import{u as Y}from"./useTransaction-DmUGgHnq.js";import{u as he}from"./useAccountBalance-C2pgGwpm.js";import{u as _e}from"./useToken-swJ9eiro.js";import{N as Te}from"./NoData-xr_zMTci.js";import{S as Ae}from"./SingleTokenInfo-5fekhlrG.js";import{u as Ee}from"./RangeValue-CLNb11km.js";const Fe=({info:t,imgSize:n="32px",isProfile:s=!1})=>{const{pay_coin:p,target_coin:d,total_pay_amount:u,expect_obtain_amount:o}=t;return e.jsxs(l,{children:[e.jsx(Ce,{w:n,h:n,coinAIconUrl:p.logo_url,coinBIconUrl:d.logo_url}),e.jsxs(l,{flexWrap:"wrap",children:[e.jsxs(l,{children:[!s&&e.jsx(c,{color:"text_caption",children:L(u)}),e.jsxs(c,{color:"text_caption",children:[p.symbol," â†’ "]})]}),e.jsxs(l,{children:[!s&&e.jsx(c,{color:"text_caption",children:L(o)}),e.jsx(c,{color:"text_caption",children:d.symbol})]})]})]})},We=({info:t,isProfile:n=!1})=>e.jsx(l,{justifyContent:"end",gap:"2px",children:n?e.jsx(c,{color:"text_caption",children:ue(t==null?void 0:t.expire_ts)}):e.jsxs(c,{color:"text_caption",children:[Q(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),Be=({info:t,isProfile:n=!1})=>{const{pay_coin:s,total_pay_amount:p,deal_amount:d,deal_rate:u}=t;return e.jsxs(S,{align:"flex-end",gap:n?"4px":"8px",children:[e.jsxs(l,{justifyContent:"end",gap:"2px",children:[e.jsx(c,{color:"text_caption",children:L(d)}),e.jsxs(l,{justifyContent:"end",gap:"2px",children:[e.jsxs(c,{color:"text_caption",children:["/",L(p)," ",s.symbol]}),e.jsxs(c,{color:"primary_gray",children:["(",ae(Number(u)*100),")"]})]})]}),n&&e.jsxs(l,{w:"100%",justify:"flex-end",gap:"2px",children:[e.jsx(c,{color:"primary_gray",fontSize:"12px",children:ae(Number(u)*100)}),e.jsx(we,{h:"4px",w:"40px",value:Number(u)*100,bg:"primary_opacity.10",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})},Qe=({historyInfo:t,type:n,...s})=>{const{getExplorerUrl:p}=q(),d=w.useMemo(()=>(t==null?void 0:t.events)||[],[t]),{isApp:u}=I();return e.jsx(B,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...s,children:e.jsx(S,{align:"flex-start",children:d.map(o=>{const{tokenInfo:g,text:j,icon:b,color:i,num:m}=je(o,t);return e.jsxs(S,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(l,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(l,{gap:n=="card"?"4px":"8px",flexDirection:n=="card"?"column":"row",align:n=="card"?"flex-start":"center",children:[e.jsxs(l,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(v,{svgW:"14px",xlinkHref:b,svgFill:i,svgHover:i}),e.jsx(c,{color:i,children:j})]}),!u&&e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]})]}),e.jsxs(l,{gap:n=="card"?"4px":"20px",flexDirection:n=="card"&&!u?"column":"row",align:n=="card"?"flex-end":"center",children:[e.jsxs(c,{h:"20px",lineHeight:"20px",children:[Q(Number(o.block_time),"")," (UTC)"]}),e.jsxs(l,{gap:"4px",cursor:"pointer",onClick:a=>{T(a),window.open(p(o.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!u&&e.jsx(c,{color:"text_caption",children:"View Transaction"}),e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),u&&e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]})]},o==null?void 0:o.tx)})})})},je=(t,n)=>{const{pay_coin:s,target_coin:p}=n,d=t==null?void 0:t.event_type;return d.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:s,num:`+${L(K(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`}:d.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:p,num:`+${L(K(t==null?void 0:t.amount,p==null?void 0:p.decimals))}`}:d.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${L(K(t==null?void 0:t.amount,s==null?void 0:s.decimals))}`,tokenInfo:s}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},De=({info:t,isProfile:n=!1})=>{const[s,p]=w.useState(!0),{getTokenRank:d}=Ee();w.useEffect(()=>{const i=d(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",i),p(i)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:u,target_coin:o,price:g,reseverPrice:j}=t,b=n?"12px":"14px";return e.jsxs(S,{flexDirection:n?"column":"row",justify:"flex-end",align:n?"flex-end":"center",gap:n?"0px":"8px",children:[n&&(s?e.jsx(c,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(g)}):e.jsx(c,{color:"text_caption",lineHeight:"16px",h:"16px",children:L(j)})),e.jsxs(l,{justifyContent:"end",children:[s?e.jsxs(l,{flexWrap:"wrap",justify:"flex-end",children:[!n&&e.jsx(c,{color:"text_caption",lineHeight:"1",children:L(g)}),e.jsxs(c,{fontSize:b,color:n?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[o.symbol," per ",u.symbol]})]}):e.jsxs(l,{flexWrap:"wrap",justify:"flex-end",children:[!n&&e.jsx(c,{color:"text_caption",children:L(j)}),e.jsxs(c,{fontSize:b,color:n?"text_paragraph":"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[u.symbol," per ",o.symbol]})]}),e.jsx(v,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:i=>{T(i),p(!s)}})]})]})},Ie=({historyInfo:t,openExpendItemObj:n,isProfile:s=!1})=>e.jsxs(l,{justifyContent:"end",gap:"4px",children:[!s&&((t==null?void 0:t.status)=="Cancelled"?e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(v,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"})),e.jsx(c,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),!s&&e.jsx(v,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:n[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),Re=(t,n)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:s=>{t(()=>({orderListLoading:s}))},historyOrderList:[],setHistoryOrderList:s=>{t(()=>({historyOrderList:s}))},setMyOrderList:s=>{t(()=>({myOrderList:s}))}}),Me=Le(Re);function ze({isOpen:t,onClose:n,historyInfo:s}){const{isApp:p}=I(),d=w.useMemo(()=>(s==null?void 0:s.events)||[],[s]),{getExplorerUrl:u}=q();return e.jsxs(re,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(le,{}),e.jsxs(ce,{minWidth:p?"300px":"482px",children:[e.jsx(oe,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",borderBottom:"1px solid",borderColor:"border",pb:"16px",children:"Trade Details"})}),e.jsx(pe,{}),e.jsx(de,{p:"0px 16px ",textAlign:"center",children:e.jsx(l,{h:"100%",gap:"12px",mt:"8px",children:e.jsx(S,{align:"flex-start",w:"100%",gap:"32px",p:"0 0 0px 16px",mb:"16px",borderLeft:"1px solid",borderColor:"border",children:d.map(o=>{const{tokenInfo:g,text:j,icon:b,color:i,num:m}=je(o,s);return e.jsxs(S,{align:"flex-start",w:"100%",mt:"-8px",children:[e.jsxs(l,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(c,{h:"20px",lineHeight:"20px",children:[ue(o.block_time)," (UTC)"]}),e.jsx(c,{color:i,children:j}),e.jsx(l,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-23px",top:"4px",borderRadius:"50%",children:e.jsx(fe,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(B,{p:"16px",borderRadius:"12px",children:e.jsxs(l,{w:"100%",gap:"4px",justify:"space-between",children:[e.jsxs(c,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[m,"Â ",g==null?void 0:g.symbol]}),e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1",onClick:a=>{T(a),window.open(u(o.tx,"tx"))}})]})})]},o==null?void 0:o.tx)})})})})]})]})}function ye(){const{currentAccount:t,addressChangeVersion:n}=me(),{peripherySdk:s}=ee(),{setOrderListLoading:p,setMyOrderList:d,myOrderList:u,orderListLoading:o}=Me(),{getTokenListInfo:g}=_e(),j=async(i=t==null?void 0:t.address,m)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",i);try{if(!i){p(!1),d([]);return}m&&p(!0);const a=await s.LimitOrder.getOwnerLimitOrderList(i,"all"),r=await b(a.data.filter(x=>x.status===G.PartialCompleted||x.status===G.Running));d(r),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",r)}catch(a){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",a)}finally{p(!1)}},b=async i=>{const m=[],a=[];for(const x of i)a.push(x.pay_coin_type),a.push(x.target_coin_type);const r=await g(a);for(const x of i){const[h,f]=[r==null?void 0:r.get(x.pay_coin_type),r==null?void 0:r.get(x.target_coin_type)];if(h&&f){const{total_pay_amount:C,pay_balance:_,rate:O,obtained_amount:y,claimed_amount:D,target_balance:F,created_ts:R,expire_ts:J,status:X,id:M}=x,A=k(C,h.decimals).toString(),W=k(_,h.decimals).toString(),V=k(y,f.decimals).toString(),z=k(D,f.decimals).toString(),P=k(F,f.decimals).toString(),N=ge.rateToPrice(O.toString(),h.decimals,f.decimals),Z=H(1).div(N).toString(),te=k(H(C).sub(_).toFixed(0),h.decimals).toString(),be={order_id:M,pay_coin:h,target_coin:f,price:N,reseverPrice:Z,total_pay_amount:A,expect_obtain_amount:H(A).mul(N).toString(),remaining_amount:W,deal_amount:te,deal_rate:H(te).div(A).toString(),obtained_amount:V,claimed_amount:z,un_claimed_amount:H(P).sub(z).toString(),created_ts:R,expire_ts:J,status:X};m.push(be)}}return m.sort((x,h)=>h.created_ts-x.created_ts)};return{fetchMyLimitOrder:j,formatLimitOrderList:b,orderListLoading:o,myOrderList:u}}function Ne(){const{fetchAccountBalance:t}=he(),{fetchMyLimitOrder:n}=ye(),{signAndExecuteTransaction:s}=Y(),{peripherySdk:p}=ee(),[d,u]=w.useState(!1),{transactionConfirmation:o}=Y();return{handleCancelOrder:async j=>{u(!0);const b={getShowInfo:r=>{const x="Canceling order",h={modalDescriptionText:x,toastTitleText:x};return r==="success"&&(h.toastDescriptionContent="Order cancelled successfully",h.modalDescriptionText="Order cancelled successfully",h.toastTitleText="Order cancelled"),h}};o(b);const i=j.map(r=>({pay_coin_type:r.pay_coin.coin_type,target_coin_type:r.target_coin.coin_type,order_id:r.order_id})),m=await p.LimitOrder.cancelOrdersByOwner(i),a=await s(m,b);u(!1),a&&setTimeout(()=>{t(),n()},2e3)},cancelOrderLoading:d}}function Ue(){const{fetchAccountBalance:t}=he(),{fetchMyLimitOrder:n}=ye(),{signAndExecuteTransaction:s}=Y(),{peripherySdk:p}=ee(),[d,u]=w.useState(!1),[o,g]=w.useState(!1);return{handleClaimOrder:async(i,m)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",i),u(!0);const a={pay_coin_type:i.pay_coin.coin_type,target_coin_type:i.target_coin.coin_type,order_id:i.order_id},r=await p.LimitOrder.claimTargetCoin(a),x=await s(r,{getShowInfo:(h,f)=>{var O;const C=`Claim ${L(m)} ${(O=i==null?void 0:i.target_coin)==null?void 0:O.symbol}`,_={modalDescriptionText:C,toastTitleText:C};return h==="success"&&(_.toastDescriptionContent="",_.modalDescriptionText="",_.toastTitleText="Claim successfully"),_}});u(!1),x&&setTimeout(()=>{t(),n()},2e3)},getLimitOrderClaimHistory:async i=>{g(!0);const m=await p.LimitOrder.getLimitOrderClaimLogs(i.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",i,m),m?(g(!1),m.map(a=>{var x;const r=U(a.parsedJson.claimed_amount).div(Math.pow(10,(x=i.target_coin)==null?void 0:x.decimals));return{...a,...a.parsedJson,claimed_amount:r}})):[]},isClaimHistoryLoading:o,claimLoading:d}}const Ve=({orderInfo:t,isOpen:n,onClose:s,handleClaim:p,claimLoading:d,getLimitOrderClaimHistory:u,isClaimHistoryLoading:o})=>{const{getExplorerUrl:g}=q(),[j,b]=w.useState(""),[i,m]=w.useState([]),[a,r]=w.useState({label:"Claim",value:"claim"}),x=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],h=y=>{r(y),(y==null?void 0:y.value)=="history"&&f()},f=async()=>{const y=await u();y&&m(y)},C=w.useMemo(()=>!j||d?{disabled:!0,text:"Claim"}:U(j).gt(t.un_claimed_amount)||U(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[j,t.un_claimed_amount]),[_,O]=w.useState(!0);return w.useEffect(()=>{_&&(O(!1),b(t.un_claimed_amount))},[_,t.un_claimed_amount]),e.jsxs(re,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:s,isCentered:!0,children:[e.jsx(le,{}),e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsx(xe,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(pe,{}),e.jsx(de,{textAlign:"center",p:"0px",children:e.jsxs(S,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(B,{borderRadius:"8px",p:"8px",children:e.jsx(c,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(Fe,{info:t,imgSize:"28px"}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Price"}),e.jsx(De,{info:t})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Filled Size"}),e.jsx(Be,{info:t})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Expiry"}),e.jsx(We,{info:t})]}),e.jsx(Oe,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:x,currentTab:a.label,handleChangeTab:h}),(a==null?void 0:a.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(S,{gap:"16px",align:"flex-start",children:[e.jsx(c,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(Se,{value:j?L(j).toString():"",onChange:y=>{b(y)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(l,{children:e.jsx(Ae,{portal:!1,token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(E,{onClick:()=>{p(j),s()},disabled:C.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:C.text})]}),(a==null?void 0:a.value)=="history"&&e.jsx(S,{w:"100%",gap:"12px",children:o?e.jsxs(B,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(l,{justify:"space-between",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]}),e.jsxs(l,{justify:"space-between",mt:"16px",children:[e.jsx($,{height:"4",width:"150px"}),e.jsx($,{height:"4",width:"150px"})]})]},history==null?void 0:history.id):(i==null?void 0:i.length)==0?e.jsx(Te,{type:"nodata",text:"No History.",p:"20px"}):i==null?void 0:i.map(y=>{var D,F;return e.jsx(B,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(S,{gap:"16px",align:"flex-start",children:[e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Amount"}),e.jsxs(l,{gap:"4px",children:[e.jsx(ve,{imageUrl:(D=t==null?void 0:t.target_coin)==null?void 0:D.logo_url,w:"20px",h:"20px"}),e.jsxs(c,{color:"text_caption",lineHeight:"18px",children:[L(y==null?void 0:y.claimed_amount)," ",(F=t==null?void 0:t.target_coin)==null?void 0:F.symbol]})]})]}),e.jsxs(l,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Time"}),e.jsxs(l,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:R=>{T(R),window.open(g(y.digest,"tx"))},children:[e.jsxs(c,{color:"text_caption",children:[Q(Number(y==null?void 0:y.timestampMs),"")," (UTC)"]}),e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},y.digest)})})]})})]})]})},et=({orderInfo:t,isProfile:n=!1,isOpenOrder:s=!0})=>{const{handleCancelOrder:p,cancelOrderLoading:d}=Ne(),{handleClaimOrder:u,claimLoading:o,getLimitOrderClaimHistory:g,isClaimHistoryLoading:j}=Ue(),[b,i]=w.useState(),[m,a]=w.useState(!1),[r,x]=w.useState(!1),h=(_,O)=>{i(_),O==="cancel"&&p([_]),O==="claim"&&a(!0)},{isApp:f}=I(),{getExplorerUrl:C}=q();return e.jsxs(l,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:{base:"space-between",lg:"flex-end"},gap:"8px",children:[s&&e.jsxs(l,{justify:"flex-end",children:[U(t==null?void 0:t.obtained_amount).lte(0)&&U(t.un_claimed_amount).lte(0)?e.jsx(ie,{placement:"top",tooltip:e.jsx(c,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."}),children:e.jsx(se,{w:{base:"calc(50vw - 28px)",lg:"unset"},children:e.jsx(E,{disabled:!0,p:"0 8px",h:"28px",borderRadius:"8px",fontSize:"12px",children:"Claim"})})}):e.jsx(E,{isLoading:o,disabled:o,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:_=>{T(_),o||h(t,"claim")},children:"Claim"}),n&&e.jsx(ie,{placement:"bottom-end",tooltip:e.jsxs(S,{align:"flex-start",children:[e.jsx(ne,{text:"View on Explorer",onClick:()=>{window.open(C(t.order_id,"poolAddress"))}}),e.jsx(ne,{text:"Cancel",onClick:()=>{d||h(t,"cancel")}})]}),children:e.jsx(se,{children:e.jsx(E,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(v,{svgFill:f?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!n&&s&&e.jsx(E,{isLoading:d,disabled:d,w:{base:"50%",lg:"unset"},h:"28px",p:"0 8px",variant:"outline",borderRadius:"8px",fontSize:"12px",fontWeight:"500",onClick:_=>{T(_),d||h(t,"cancel")},children:"Cancel"}),n&&!s&&e.jsxs(l,{children:[e.jsx(E,{h:"32px",variant:"outline",fontSize:"12px",p:"0 8px",borderRadius:"8px",fontWeight:"500",onClick:_=>{T(_),x(!0)},children:"Details"}),e.jsx(E,{onClick:_=>{T(_),window.open(C(t.order_id,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(v,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),m&&e.jsx(Ve,{orderInfo:t,claimLoading:o,isOpen:m,onClose:()=>a(!1),handleClaim:_=>u(t,_),getLimitOrderClaimHistory:()=>g(t),isClaimHistoryLoading:j}),r&&e.jsx(ze,{isOpen:r,onClose:()=>x(!1),historyInfo:t})]})};function tt(){const{fetchByApi:t}=He(),{getTokenListInfo:n}=_e(),{currentAccount:s}=me(),[p,d]=w.useState(!0),[u,o]=w.useState([]);w.useEffect(()=>{o([])},[s==null?void 0:s.address]);const g=async(b,i)=>{var m;try{i&&d(!0);const a=await t(ke,"GET",{wallet_address:b});if(console.log(a,"getLimitOrderHistory"),a!=null&&a.list&&((m=a==null?void 0:a.list)==null?void 0:m.length)>0){const r=await j((a==null?void 0:a.list)||[]);return o(r),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",r),r}return[]}catch(a){return console.log("getLimitOrderHistory ~ error:",a),[]}finally{d(!1)}},j=async b=>{const i=[],m=[];for(const r of b)m.push(r.pay_coin),m.push(r.target_coin);const a=await n(m);for(const r of b){const[x,h]=[a==null?void 0:a.get(r.pay_coin),a==null?void 0:a.get(r.target_coin)];if(x&&h){const{total_pay_amount:f,remaining_amount:C,rate:_,obtained_amount:O,claimed_amount:y,target_balance:D,created_ts:F,expire_ts:R,cancel_reason:J,events:X}=r,M=X;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",r,M),M.sort((N,Z)=>Z.block_time-N.block_time);const A=k(f,x.decimals).toString(),W=ge.rateToPrice(_.toString(),x.decimals,h.decimals),V=H(1).div(W).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",W,V);const z=k(H(f).sub(C).toFixed(0),x.decimals).toString(),P={order_id:r.order_id,pay_coin:x,target_coin:h,price:W,reseverPrice:V,total_pay_amount:A,remaining_amount:C,deal_amount:z,deal_rate:H(z).div(A).toString(),expect_obtain_amount:H(A).mul(W).toString(),obtained_amount:O,claimed_amount:y,un_claimed_amount:"0",created_ts:F,expire_ts:R,status:Number(J)===0?G.Completed:G.Cancelled,events:M};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",P),i.push(P)}}return i.sort((r,x)=>x.created_ts=r.created_ts),i};return{getLimitOrderHistory:g,historyOrderLoading:p,historyOrderList:u}}export{Fe as C,We as E,Be as F,Qe as L,et as O,De as P,Ie as S,ye as a,tt as b,Ne as c,Me as u};
//# sourceMappingURL=useGetLimitOrderHistory-Cm1j9JvD.js.map

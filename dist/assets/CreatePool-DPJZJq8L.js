import{a as x,j as e,X as tt,Y as rt,Z as it,$ as ot,a8 as be,a0 as nt,a1 as st,V,H as E,T as _,f as T,v as ee,ag as Ne,I as vt,a7 as Ce,N as Rt,a9 as yt,ab as ct,as as Dt,D as De}from"./vendor-DXHkIl66.js";import{b as It,u as Ft,a as Pt}from"./SelectTokenAndFeeConfirm-QC4LOns-.js";import{D as lt}from"./DepositRatio-Cbbw-23y.js";import{T as at}from"./TotalAmount-CcqMNWAV.js";import{P as Nt}from"./PositionStatus-DsGsaaCE.js";import{c as pt,b as Ie}from"./useGetPoolList-B9bUsMZ5.js";import{n as xt,d as xe,X as z,Z as $e,B as We,ai as Se,v as dt,I as we,j as ut,a0 as H,a as ht,i as Ke,N as Wt,C as pe,aj as Ye,a2 as Y,aa as k,a6 as Fe,y as se,ak as $t,al as Je,w as ce,p as zt,a4 as Be}from"./index-COrObqhs.js";import{T as Ot}from"./TradeConfirmAmountInfo-5Bsx9gWp.js";import{u as Me}from"./useTokenBalance-DKaSilR5.js";import{T as Lt}from"./TradeInputGroup-F01zgmGz.js";import{P as Qe}from"./PriceInput-Cw09n8yj.js";import{u as Et,a as Ht}from"./useCreatePoolHelper-CTYK2lvk.js";import{E as qe}from"./ErrorTips-Cvdl__4Z.js";import{I as Vt}from"./InputBox-Dlz8xsDZ.js";import{u as Ut}from"./useTransaction-19_gbWik.js";import{i as ke}from"./index-BgfP77Mo.js";import{d as Gt}from"./FeeTierSelect-BYHJHdbU.js";import{u as gt}from"./useAccountBalance-JIpp1bm5.js";import{u as Xt}from"./index-CptRizr3.js";import{u as Zt}from"./usePreviousValue-BBpD8e7r.js";import{u as Te}from"./useToken-tdeKOG5n.js";import{R as Kt}from"./RefreshButton-DMtB0j6U.js";import"./index-BMgKM0Tl.js";import"./CheckBox-rv3qIDs9.js";import"./Loading-BH2b7hW0.js";import"./SingleTokenInfo-Cu4rhuHx.js";import"./CopyButton-0PPlBtQz.js";import"./TooltipIcon-QGHwK_uy.js";import"./HTextLabelBox-BHTpNjoy.js";import"./useWrapPoolData-fdYmV8CX.js";import"./_getAllKeysIn-BvQOU9sJ.js";import"./ActionButton-CuCGebIk.js";import"./usePosAdd-BjImhNP3.js";import"./global-DhYiu20h.js";import"./msafe-oYBkW7LJ.js";import"./liquidity-CgFc1bQ3.js";import"./useTrack-pnnm1Ell.js";import"./useSigner-C6u4-fR7.js";import"./useDocumentSize-BOu7tegp.js";import"./debounce-BgSgg6I6.js";import"./index-DKPh1ief.js";function Yt(u){const{isOpen:g,onClose:d,onSubmit:c,data:r}=u,{baseToken:t,quoteToken:i,feeDisplay:a,baseAmount:n,quoteAmount:o,isReverse:S,initPrice:s,minPrice:f,maxPrice:p,isFullRange:R}=r,[A,O]=x.useState(!0);console.log("ðŸš€ ~ file: CreateConfirmModal.tsx:49 ~ CreateConfirmModal ~ data:",r,A);const{getTokenAmountValue:$}=xt(),U=$(t==null?void 0:t.coin_type,n),G=$(i==null?void 0:i.coin_type,o),Z=x.useMemo(()=>xe(U||"0").plus(G||"0").toString(),[U,G]),v=x.useMemo(()=>pt(n,o,s,R),[n,o]),F=x.useMemo(()=>A?`${z(i==null?void 0:i.symbol)} per ${z(t==null?void 0:t.symbol)}`:`${z(t==null?void 0:t.symbol)} per ${z(i==null?void 0:i.symbol)}`,[A,t==null?void 0:t.symbol,i==null?void 0:i.symbol]),N=x.useMemo(()=>R?"0":S?A?f==null?void 0:f.displayReversePrice:p.displayPrice:A?f==null?void 0:f.displayPrice:p.displayReversePrice,[A]),K=x.useMemo(()=>R?"âˆž":S?A?p==null?void 0:p.displayReversePrice:f.displayPrice:A?p==null?void 0:p.displayPrice:f.displayReversePrice,[A]);return e.jsxs(tt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:g,onClose:d,isCentered:!0,children:[e.jsx(rt,{}),e.jsxs(it,{children:[e.jsx(ot,{children:e.jsx(be,{fontWeight:"500",fontSize:"16px",children:"Preview"})}),e.jsx(nt,{}),e.jsx(st,{textAlign:"center",p:"0px",children:e.jsxs(V,{w:"100%",gap:"20px",p:"8px 16px",pb:"0px",children:[e.jsxs(E,{w:"100%",justifyContent:"space-between",h:"40px",children:[e.jsxs(E,{children:[e.jsx($e,{coinACoinType:t==null?void 0:t.coin_type,coinBCoinType:i==null?void 0:i.coin_type,coinAIconUrl:t==null?void 0:t.logo_url,coinBIconUrl:i==null?void 0:i.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),e.jsx(_,{fontSize:"16px",color:"text_caption",children:`${z(t==null?void 0:t.symbol)} - ${z(i==null?void 0:i.symbol)}`})]}),e.jsx(We,{w:"unset",p:"8px 12px",borderRadius:"12px",ml:"4px",children:e.jsxs(E,{gap:"12px",children:[e.jsx(_,{children:"Fee Tier"}),e.jsx(_,{color:"primary",children:a})]})})]}),e.jsx(Ot,{coinA:{amount:n,...t},coinB:{amount:o,...i}}),e.jsxs(T,{w:"100%",children:[e.jsxs(E,{w:"100%",justify:"space-between",h:"32px",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Selected Range"}),e.jsx(Nt,{isActive:!0,isRow:!0,imgStyle:{imgW:"29px",imgH:"16px"},w:"105px",h:"32px"})]}),e.jsxs(E,{justify:"center",bg:"bg_secondary",borderRadius:"8px",h:"48px",w:"100%",gap:"4px",mt:"12px",children:[e.jsx(_,{children:"Current Price"}),e.jsx(_,{as:"span",color:"text_caption",children:Se(A?s:dt(xe(1).div(s).toFixed(18),18,!0).toString(),18)}),e.jsx(_,{children:F}),e.jsx(ee,{variant:"unstyled",onClick:()=>O(!A),children:e.jsx(we,{xlinkHref:"#icon-icon_swap1"})})]}),e.jsxs(E,{w:"100%",h:"100px",bg:"bg_secondary",borderRadius:"12px",mt:"8px",children:[e.jsx(et,{title:"Min Price",price:N,perText:F}),e.jsx(Ne,{orientation:"vertical",h:"40px"}),e.jsx(et,{title:"Max Price",price:K,perText:F})]})]}),e.jsx(lt,{tokenA:t,tokenB:i,percentMap:v,type:"text"}),e.jsx(at,{totalAmount:Z}),e.jsx(ee,{w:"calc(100% + 32px)",bottom:"0px",mt:"4px",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:c,children:"Create and Add Liquidity"})]})})]})]})}const et=({title:u,price:g,perText:d})=>e.jsxs(V,{flex:"1",children:[e.jsx(_,{children:u}),e.jsx(_,{color:"text_caption",children:g}),e.jsx(_,{children:d})]});function Jt(u){const{isOpen:g,onClose:d,data:c}=u,{baseToken:r,quoteToken:t,feeDisplay:i}=c;return e.jsxs(tt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:g,onClose:d,isCentered:!0,children:[e.jsx(rt,{}),e.jsxs(it,{children:[e.jsx(ot,{}),e.jsx(nt,{}),e.jsx(st,{children:e.jsx(V,{gap:"8px",pb:"8px",pt:"28px",w:"100%",children:e.jsxs(V,{gap:"8px",children:[e.jsx(vt,{src:"/images/img_transactionsuccess@2x.png",w:"200px",h:"200px",alt:"icon"}),e.jsxs(V,{mt:"-155px",gap:"10px",children:[e.jsxs(E,{children:[e.jsx($e,{coinACoinType:r==null?void 0:r.coin_type,coinBCoinType:t==null?void 0:t.coin_type,coinAIconUrl:r==null?void 0:r.logo_url,coinBIconUrl:t==null?void 0:t.logo_url,imageStyle:{w:"24px",h:"24px"},imgBoxStyle:{w:"24px",h:"24px"}}),e.jsx(_,{fontSize:"14px",color:"text_caption",children:`${r==null?void 0:r.symbol} - ${t==null?void 0:t.symbol}`})]}),e.jsx(We,{w:"unset",p:"4px 6px",borderRadius:"12px",children:e.jsxs(_,{fontSize:"12px",color:"primary",children:["Fee Tier ",i]})})]}),e.jsx(We,{mt:"80px",borderRadius:"16px",padding:"16px",children:e.jsx(_,{color:"primary_gray",fontSize:"12px",lineHeight:"20px",children:"The pool has been created. It will usually take up to 3 min for a new pool to be presented in front end interface. Thanks for creating this pool"})}),e.jsx(ee,{mt:"16px",fontSize:"14px",w:"100%",onClick:()=>{d()},children:"OK"})]})})})]})]})}function Bt(u,g,d,c,r,t){const{currentAccount:i}=ut(),a=x.useMemo(()=>{const n={text:"Create",disabled:!1};return i!=null&&i.address?!u||!g||u&&!+u||g&&!+g?(n.text="Enter an amount",n.disabled=!0,n):u&&+u&&xe(u).gt((r==null?void 0:r.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${z(d==null?void 0:d.symbol)} Balance`,n):g&&+g&&xe(g).gt((t==null?void 0:t.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${z(c==null?void 0:c.symbol)} Balance`,n):((!u||!g)&&(n.disabled=!0),n):(n.text="Connect Wallet",n.disabled=!1,n)},[i==null?void 0:i.address,u,g,r==null?void 0:r.balanceDisplay,t==null?void 0:t.balanceDisplay,d==null?void 0:d.coin_type,c==null?void 0:c.coin_type]);return{btnText:a.text,btnDisabled:a.disabled}}function Mt({currentStep:u,editStep:g,onCreate:d,baseToken:c,quoteToken:r,baseAmount:t,quoteAmount:i,onBaseAmountChange:a,onQuoteAmountChange:n,isReverse:o,percentMap:S}){const{balanceInfo:s}=Me(c),{balanceInfo:f}=Me(r),{btnText:p,btnDisabled:R}=Bt(t,i,c,r,s,f),{fetchTokenPrices:A,getTokenAmountValue:O}=xt(),$=()=>{const v=[];c!=null&&c.coin_type&&v.push(c==null?void 0:c.coin_type),r!=null&&r.coin_type&&v.push(r==null?void 0:r.coin_type),v.length>0&&A(v)};x.useEffect(()=>{$()},[c==null?void 0:c.coin_type,r==null?void 0:r.coin_type]);const U=O(c==null?void 0:c.coin_type,t),G=O(r==null?void 0:r.coin_type,i),Z=x.useMemo(()=>{if(+U&&+G)return H(U||"0").plus(G||"0").toString()},[U,G]);return e.jsx(e.Fragment,{children:u===3&&g===3?e.jsxs(V,{w:"100%",gap:"12px",bg:"bg_fifth",borderRadius:"12px",p:{base:"16px 8px",lg:"32px"},align:"flex-start",children:[e.jsx(be,{fontSize:"16px",fontWeight:"500",children:"Deposit amounts"}),e.jsx(Lt,{wrapStyle:{mt:"4px"},from:{wrapStyle:{h:"108px"},balance:(s==null?void 0:s.balanceFormat)||"",value:t,amountValue:U,loading:!1,onChange:v=>{a(v)},selectable:!1,placeholder:"0.0",token:c},to:{wrapStyle:{h:"108px"},balance:(f==null?void 0:f.balanceFormat)||"",value:i,amountValue:G,loading:!1,onChange:v=>{n(v)},selectable:!1,placeholder:"0.0",token:r}}),e.jsxs(V,{gap:"16px",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"16px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(at,{totalAmount:Z}),e.jsx(lt,{tokenA:c,tokenB:r,percentMap:S,isReverse:o,type:"image"})]}),e.jsx(ee,{w:"100%",onClick:d,h:"48px",fontSize:"16px",borderRadius:"12px",disabled:R,children:p})]}):null})}function ft({onEdit:u,children:g}){return e.jsxs(E,{w:"100%",p:{base:"16px 8px",lg:"20px 32px"},border:"0px solid",borderColor:"border",borderRadius:"12px",bg:"bg_fifth",justify:"space-between",children:[g,e.jsxs(ee,{onClick:u,variant:"unstyled",border:"1px solid",borderColor:"border",cursor:"pointer",borderRadius:"8px",p:"5px 8px",display:"flex",h:"32px",alignItems:"center",gap:"8px",minW:"auto",_hover:{p:{color:"#fff"},svg:{fill:"#fff"}},children:[e.jsx(we,{xlinkHref:"#icon-icon_edit"}),e.jsx(_,{fontSize:"12px",fontWeight:"500",children:"Edit"})]})]})}function Qt({onEdit:u,editStep:g,currentStep:d,onContinue:c,baseToken:r,quoteToken:t,onBaseTokenChange:i,onQuoteTokenChange:a,feeTier:n,feeTierList:o,onFeeTierChange:S,quoteWhiteTokenList:s}){return e.jsx(e.Fragment,{children:g===1||d===1?e.jsx(It,{title:"Select pair",description:"Select the token you want to create a liquidity pool for.",onContinue:c,baseToken:r,onBaseTokenChange:i,quoteToken:t,onQuoteTokenChange:a,quoteWhiteTokenList:s,feeTier:n,feeTierList:o,onFeeTierChange:S,wrapStyle:{p:{base:"16px 8px",lg:"32px"}},fromSource:"createPool"}):e.jsx(ft,{onEdit:u,children:e.jsxs(E,{gap:"12px",children:[e.jsx($e,{coinAIconUrl:r==null?void 0:r.logo_url,coinBIconUrl:t==null?void 0:t.logo_url,coinACoinType:r==null?void 0:r.coin_type,coinBCoinType:t==null?void 0:t.coin_type,w:"36px",h:"36px"}),e.jsxs(E,{children:[e.jsx(_,{color:"text_caption",fontWeight:"500",children:`${z(r==null?void 0:r.symbol)}-${z(t==null?void 0:t.symbol)}`}),e.jsx(T,{h:"16px",p:"1px 8px",borderRadius:"16px",border:"1px solid",borderColor:"border",bg:"bg_secondary",children:e.jsx(_,{fontSize:"12px",fontWeight:"500",color:"text_highlight",children:typeof n=="string"?`${xe(n).div(100).toString()}%`:n==null?void 0:n.feeDisplay})})]})]})})})}const qt=[{label:"Full Range"},{label:"Custom Range"}];function kt({editStep:u,currTick:g,currentStep:d,onEdit:c,onContinue:r,displayBaseToken:t,displayQuoteToken:i,initPrice:a,onInitPriceChange:n,displayMinPrice:o,onMinPriceChange:S,displayMaxPrice:s,onMaxPriceChange:f,isFullRange:p,isReverse:R,handleRangeModeChange:A,handleSwitchDirectionChange:O,handlePriceAction:$}){const[U,G]=x.useState("Full Range"),{isApp:Z}=ht(),v=x.useMemo(()=>o?[o.tokenA,o.tokenB].filter(Boolean).map(h=>({label:h==null?void 0:h.symbol,isToken:!0,imgInfo:{src:h==null?void 0:h.logo_url,w:"16px",h:"16px",borderRadius:"50%",fallbackSrc:"/images/placeholder-token@2x.png"}})):[],[o==null?void 0:o.tokenA,o==null?void 0:o.tokenB]),F=x.useMemo(()=>`${z(i==null?void 0:i.symbol)} per ${z(t==null?void 0:t.symbol)}`,[t==null?void 0:t.symbol,i==null?void 0:i.symbol]),N=x.useMemo(()=>{var h;return p?!0:((h=o==null?void 0:o.tokenA)==null?void 0:h.coin_type)===(t==null?void 0:t.coin_type)},[p,o==null?void 0:o.tokenA,o==null?void 0:o.tokenB,t==null?void 0:t.coin_type]),{showInputPriceWarn:K,showPriceRangeWarn:M}=Et(p,g,R?s.tick:o.tick,R?o.tick:s.tick),te=x.useMemo(()=>(o==null?void 0:o.price)==="0"&&(s==null?void 0:s.price)==="âˆž",[o==null?void 0:o.price,s==null?void 0:s.price]),C=x.useMemo(()=>!+a&&!p,[a,p]);return e.jsx(e.Fragment,{children:d>=2?u===2||d===2?e.jsxs(V,{w:"100%",gap:"32px",bg:"bg_fifth",borderRadius:"12px",p:{base:"16px 8px",lg:"32px"},children:[e.jsxs(V,{gap:"8px",w:"100%",align:"flex-start",children:[e.jsx(be,{fontSize:"16px",fontWeight:"500",children:"Set initial Price"}),e.jsxs(Ce,{flexDir:{base:"column",lg:"row"},w:"100%",justify:"space-between",mt:"-2px",alignItems:"center",children:[e.jsx(_,{fontSize:"12px",children:"Please set an initial price for this new pool to start."}),e.jsx(Ke,{type:"outlineTab",tabList:v,currentTab:t==null?void 0:t.symbol,handleChangeTab:h=>{h.label!==(t==null?void 0:t.symbol)&&O()},wrapStyle:{w:{base:"100%",lg:"auto"},h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px"},itemStyle:{flex:1,h:"24px",p:"4px 12px",borderRadius:"4px",gap:"4px"}})]}),e.jsx(Vt,{mt:"4px",h:"48px",borderRadius:"12px",p:"16px",children:e.jsxs(Rt,{fontFamily:"Inter",justifyContent:"space-between",gap:"12px",children:[e.jsx(Wt,{value:a?Se(a,18):"",onChange:h=>{n==null||n(h)},placeholder:"0.0",inputAllowed:!0,decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"16px",fontWeight:"500",height:"14px",lineHeight:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(yt,{children:e.jsx(_,{children:F})})]})}),a&&e.jsxs(E,{h:"20px",w:"100%",children:[e.jsxs(_,{color:"text_caption",fontSize:"12px",children:["Current Price: 1 ",z(t==null?void 0:t.symbol)," = ",pe(Se(a,18))," ",z(i==null?void 0:i.symbol)]}),e.jsx(we,{w:"16px",h:"16px",svgW:"16px",svgH:"16px",xlinkHref:"#icon-icon_swap1",fontSize:"12px",onClick:O})]})]}),e.jsxs(V,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(be,{fontSize:"16px",fontWeight:"500",children:"Set Price Range"}),e.jsx(_,{fontSize:"12px",children:"Please specify a price range that you want to provide your liquidity within."}),e.jsx(Ke,{type:"outlineTab",tabList:qt,currentTab:p?"Full Range":"Custom Range",handleChangeTab:h=>{G(h==null?void 0:h.label),A((h==null?void 0:h.label)==="Full Range")},wrapStyle:{w:"100%",h:"40px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"12px",gap:"4px"},itemStyle:{flex:"1",h:"32px",p:"8px",borderRadius:"8px",fontSize:"14px"}}),e.jsxs(Ce,{mt:"4px",position:"relative",flexDir:{base:"column",lg:"row"},w:"100%",gap:{base:"8px",lg:"16px"},children:[e.jsx(T,{opacity:C?0:1,w:{base:"100%",lg:"50%"},children:e.jsx(Qe,{title:"Min Price",perText:F,data:o,direct:N,loading:!1,handleAddPrice:h=>$("Add",h),handleSubPrice:h=>$("Sub",h),setTickDataBasedOnPrice:S,isFullRange:te})}),e.jsx(T,{opacity:C?0:1,w:{base:"100%",lg:"50%"},children:e.jsx(Qe,{title:"Max Price",perText:F,data:s,direct:N,loading:!1,handleAddPrice:h=>$("Add",h),handleSubPrice:h=>$("Sub",h),setTickDataBasedOnPrice:f,isFullRange:te})}),!+a&&!p&&e.jsx(Ye,{position:"absolute",top:"0px",left:"0",w:"100%",h:"80px",borderRadius:"12px",text:""}),Z&&!+a&&!p&&e.jsx(Ye,{position:"absolute",top:"88px",left:"0",w:"100%",h:"80px",borderRadius:"12px",text:""})]}),!p&&K&&!M&&e.jsx(qe,{p:"8px 16px",w:"100%",isShowIcon:!1,type:"warning",borderRadius:"8px",tipsFontSize:"12px",tipsLineHeight:"16px",tips:"To create a new pool, the initial price you set must be within your price range."}),!p&&M&&e.jsx(qe,{isShowIcon:!1,tipsFontSize:"12px",justifyContent:"center",tips:"The max price should be higher than min price.",p:"0 16px",h:"28px",borderRadius:"8px"}),e.jsx(ee,{mt:"4px",w:"100%",onClick:r,disabled:!a||!+a||!o.price||!s.price||K||M,h:"48px",fontSize:"16px",borderRadius:"12px",children:!a||!+a?"Enter initial price":"Continue"})]})]}):e.jsx(ft,{onEdit:c,children:e.jsxs(V,{gap:"12px",align:"flex-start",children:[e.jsxs(E,{children:[e.jsx(_,{whiteSpace:"nowrap",children:"Initial Price"}),e.jsx(_,{color:"text_caption",fontWeight:"500",children:`${Se(a,18)} ${F}`})]}),e.jsxs(E,{children:[e.jsx(_,{whiteSpace:"nowrap",children:"Price Range"}),e.jsxs(_,{color:"text_caption",fontWeight:"500",children:[p?"0 - âˆž":`${R?o.displayReversePrice:o==null?void 0:o.displayPrice} - ${R?s==null?void 0:s.displayReversePrice:s==null?void 0:s.displayPrice} `," ",`${F}`," "]})]})]})}):null})}function Tt({currentStep:u,handleStepClick:g}){const{isApp:d}=ht();return e.jsxs(Ce,{flexDir:{base:"row",lg:"column"},gap:"12px",flex:{base:"1",lg:"0 0 258px"},w:{base:"100%",lg:"258px"},p:{base:"12px",lg:"32px"},justify:"center",align:{base:"center",lg:"flex-start"},bg:"bg_fifth",borderRadius:"12px",children:[e.jsx(Pe,{step:1,title:"Select token & fee tier",isActive:u>=1,handleStepClick:g}),e.jsx(T,{w:"32px",h:{base:"1px",lg:"32px"},children:e.jsx(Ne,{orientation:d?"horizontal":"vertical",ml:{base:"0",lg:"16px"}})}),e.jsx(Pe,{step:2,title:"Set initial price & range",isActive:u>=2,handleStepClick:g}),e.jsx(T,{w:"32px",h:{base:"1px",lg:"32px"},children:e.jsx(Ne,{orientation:d?"horizontal":"vertical",ml:{base:"0",lg:"16px"}})}),e.jsx(Pe,{step:3,title:"Enter deposit amounts",isActive:u>=3})]})}function Pe({step:u,title:g,isActive:d,handleStepClick:c}){return e.jsxs(E,{w:{base:"32px",lg:"100%"},cursor:c&&d?"pointer":"unset",onClick:()=>{c&&d&&c(u)},children:[e.jsx(T,{as:"div",flex:"0 0 32px",h:"32px",lineHeight:"32px",textAlign:"center",border:"1px solid",fontSize:"12px",fontWeight:"500",color:d?"text_highlight":"text_paragraph",borderColor:"border",borderRadius:"8px",bg:d?"primary_disabled":"transparent",children:u}),e.jsxs(V,{align:"flex-start",display:{base:"none",lg:"flex"},children:[e.jsxs(_,{fontSize:"14px",color:d?"text_caption":"text_paragraph",fontWeight:"500",children:["Step Â ",u]}),e.jsx(_,{fontSize:"12px",color:d?"primary":"text_paragraph",fontWeight:"500",children:g})]})]})}function er(){const u=(r,t,i,a,n)=>{const o=i.decimals,S=a.decimals;let s;Math.abs(r)==Math.abs(Y.getMinIndex(n))?s=t==="lower"?"0":"âˆž":s=k.tickIndexToPrice(r,o,S).toString();const f=s==="âˆž"?"âˆž":se(s,6).toString(),p=Ie(s),R=p==="âˆž"?"âˆž":se(p,6).toString();return{id:t,tokenA:i,tokenB:a,tick:r,price:s,displayPrice:f,reversePrice:p,displayReversePrice:R,tickSpacing:n.toString(),pool:"1"}},g=(r,t)=>{const i=r.tokenA,a=r.tokenB;if(!i||!a||t.length===0)return;let n,o="";if(t==="âˆž")n=Y.getMaxIndex(Number(r.tickSpacing)),o="âˆž";else if(H(t).equals(0))n=Y.getMinIndex(Number(r.tickSpacing)),o="0";else if(H(t).gt(0)){const p=k.priceToTickIndex(H(t),i.decimals,a.decimals);n=Fe(Number(p),Number(r.tickSpacing)),o=k.tickIndexToPrice(Number(n),i.decimals,a.decimals).toString()}const S=o==="âˆž"?"âˆž":se(o,6),s=Ie(o),f=s==="âˆž"?"âˆž":se(s,6);if(n!==void 0)return{...r,tick:n,price:o,displayPrice:S.toString(),reversePrice:s,displayReversePrice:f.toString()}},d=(r,t="Add")=>{const{tokenA:i,tokenB:a,tick:n,tickSpacing:o}=r;if(i&&a&&o){const S=t==="Add"?H(n).add(o).toNumber():H(n).sub(o).toNumber();if(H(S).gt(Y.getMaxIndex(Number(r.tickSpacing)))||H(S).lt(Y.getMinIndex(Number(r.tickSpacing))))return;const s=k.tickIndexToPrice(S,i.decimals,a.decimals).toString(),f=s==="âˆž"?"âˆž":se(s,6);if(f===r.displayPrice){const p=Number(r.tickSpacing)<20?40:1;return d({...r,tick:t==="Add"?H(n).add(Number(o)*p).toNumber():H(n).sub(Number(o)*p).toNumber()},t)}else{const p=Ie(s),R=p==="âˆž"?"âˆž":se(p,6);return{id:r.id,tick:S,price:s.toString(),displayPrice:f.toString(),reversePrice:p.toString(),displayReversePrice:R.toString(),tokenA:i,tokenB:a,tickSpacing:o,pool:"1"}}}};return{calcInitPriceRange:(r,t,i,a,n,o,S)=>{console.log("ðŸš€ ~ file: useCreatePriceRange.ts:84 ~ useCreatePriceRange ~ calcInitPriceRange:",{tickSpacing:i,baseToken:a,quoteToken:n});try{if(i&&a&&n){const s=Y.getMaxIndex(i),f=Y.getMinIndex(i);if(r){const p={id:"lower",tokenA:a,tokenB:n,tick:f,price:"0",displayPrice:"0",reversePrice:"âˆž",displayReversePrice:"âˆž",tickSpacing:i.toString(),pool:new Date().getTime().toString()},R={id:"upper",tokenA:a,tokenB:n,tick:s,price:"âˆž",displayPrice:"âˆž",reversePrice:"0",displayReversePrice:"0",tickSpacing:i.toString(),pool:new Date().getTime().toString()};if(t&&+t){const A=k.priceToTickIndex(H(t),a.decimals,n.decimals);return{minData:p,maxData:R,currTick:A}}return{minData:p,maxData:R,currTick:void 0}}else if(t&&+t){const p=k.priceToTickIndex(H(t),a.decimals,n.decimals),R=o||Fe(Number(p-i*5),Number(i));R<f&&(o=f);const A=S||Fe(Number(p+i*5),Number(i));A>s&&(S=s);const O=u(R,"lower",a,n,i),$=u(A,"upper",a,n,i);return{minData:O,maxData:$,currTick:p}}}}catch(s){console.log("ðŸš€ ~ file: useCreatePriceRange.ts:228 ~ useCreatePriceRange ~ error:",s)}},handleActionPrice:d,updateTickDataBasedOnPrice:g}}function tr(){ct();const{base:u,quote:g,fee:d}=Dt(),{tokenInfo:c}=Te(u),{tokenInfo:r}=Te(g),[t,i]=x.useState(void 0),[a,n]=x.useState([]),[o,S]=x.useState(1),[s,f]=x.useState(0),{signAndExecuteTransaction:p,transactionConfirmation:R,transactionRejected:A}=Ut(),{fetchAccountBalance:O}=gt(),{preAddPool:$,fetchFeeTierList:U,getCreatePoolTxPayload:G}=Ht(),{quoteWhiteTokenList:Z}=Ft(),[v,F]=x.useState(),[N,K]=x.useState(),[M,te]=x.useState(!0);x.useEffect(()=>{O()},[]);const[C,h]=x.useState(),[w,J]=x.useState(),[W,re]=x.useState(""),[L,de]=x.useState(!0),[y,ie]=x.useState({}),[P,oe]=x.useState({}),[ue,he]=x.useState(),[_e,ge]=x.useState(void 0),D=x.useMemo(()=>C&&w?$t(Je(C.coin_type),Je(w.coin_type)):!1,[C,w]),[Ae,fe]=x.useState(void 0),{calcInitPriceRange:ve,handleActionPrice:Re,updateTickDataBasedOnPrice:I}=er(),[B,me]=x.useState(""),[le,je]=x.useState("");x.useEffect(()=>{r&&!ke(r,Z)?ke(c,Z)?(F(r),h(r),J(c||ce.sui_coin),K(c||ce.sui_coin)):(F(void 0),h(void 0),J(ce.sui_coin),K(ce.sui_coin)):(F(c),h(c),J(r||ce.sui_coin),K(r||ce.sui_coin))},[c==null?void 0:c.coin_type,r==null?void 0:r.coin_type,Z]),x.useEffect(()=>{ze()},[v==null?void 0:v.coin_type,N==null?void 0:N.coin_type]);const ze=()=>{var l;v&&N?U(v.coin_type,N.coin_type).then(j=>{n(j);const m=j.filter(X=>X.poolAddress===void 0),b=m.find(X=>X.feeRate===d)||m.find(X=>X.feeRate==="25")||(m.length>0?m[0]:void 0)||(j.length>0?j[0]:void 0);b&&Oe(b)}):(n((l=Gt)==null?void 0:l.map(j=>({...j,title:""}))),i(void 0))},mt=(l,j=!0)=>{ye(1),j?(F(l),h(l),J(N),(l==null?void 0:l.coin_type)===(N==null?void 0:N.coin_type)&&(K(void 0),J(void 0))):(K(l),J(l),h(v),(l==null?void 0:l.coin_type)===(v==null?void 0:v.coin_type)&&(F(void 0),h(void 0)))},Oe=l=>{i(l),S(1),At(),Q(!0)},jt=()=>{const l=C;if(h(w),J(l),+W){const m=dt(H(1).div(W).toFixed(18),18,!0).toString();re(m)}};x.useEffect(()=>{Le(L)},[W,t==null?void 0:t.tickSpacing]);const Le=(l,j,m)=>{ne();const b=ve(l,W&&+W?D?(1/Number(W)).toString():W:"",Number((t==null?void 0:t.tickSpacing)||0),D?w:C,D?C:w,j,m);console.log("ðŸš€ ~ handleInitPriceRange ~ data:",b),b?(oe(b.maxData),ie(b.minData),he(b.currTick)):he(void 0)};x.useMemo(()=>{if(t&&C&&w)return k.tickIndexToPrice(Y.getMaxIndex(20),6,6).toFixed(9,zt.ROUND_DOWN)},[t==null?void 0:t.tickSpacing,C==null?void 0:C.decimals,w==null?void 0:w.decimals]);const St=l=>{re(l)},Q=(l,j,m)=>{de(l),ne(),Le(l,j,m)},Ee=x.useMemo(()=>L?y:D?P:y,[L,y,P,D]),He=x.useMemo(()=>L?P:D?y:P,[L,y,P,D]),bt=(l,j)=>{ne();const m=Re(j,l);m&&((m==null?void 0:m.id)===(y==null?void 0:y.id)?ie(m):oe(m))},Ct=Zt(L),wt=(l,j,m)=>{const b=I(l,j);if(b){b.pool=new Date().getTime().toString();let X=y==null?void 0:y.tick,q=P==null?void 0:P.tick;b.id==="lower"?(ie({...b}),X=b.tick):(oe({...b}),q=b.tick),X!==void 0&&q!==void 0&&t?Ct&&(Y.getMaxIndex(Number(t.tickSpacing))!==q||Y.getMinIndex(Number(t.tickSpacing))!==X?Q(!1):Q(!0)):Q(!1,X,q)}else Q(!1)},_t=(l,j)=>{te(j),j?me(l):je(l);const m=Ve(l,j);m?(fe(m),j?je(D?m.coinAmountA:m.coinAmountB):me(D?m.coinAmountB:m.coinAmountA)):(j?je(""):me(""),fe(void 0))},ye=l=>{console.log("ðŸš€ ~ file: useCreatePool.ts:288 ~ handleStepClick ~ step:",l,o,s),l===1?(S(1),f(1),re(""),Q(!0),ne()):l===2?(S(2),f(2),ne()):(S(3),f(3))},Ve=(l,j,m)=>{if(w&&C&&W&&t&&l&&+l&&(y!=null&&y.price)&&(P!=null&&P.price))try{const b=$({realTokenA:D?w:C,realTokenB:D?C:w,needReverse:y.tokenA.coin_type!==C.coin_type,tickSpacing:Number(t.tickSpacing),amount:l,amountCoinType:j?C.coin_type:w.coin_type,maxPrice:L?P.price:D?y.reversePrice:P.price,minPrice:L?y.price:D?P.reversePrice:y.price,price:D?H(1).div(W).toString():W});return console.log("ðŸš€ ~ file: useCreatePool.ts:212 ~ handleAmountChange ~ res:",b),b}catch(b){console.log("ðŸš€ ~ file: useCreatePool.ts:240 ~ preCalcAddPool ~ error:",b)}};Xt(()=>{const l=Ve("1",!0);if(l){const j=pt(l==null?void 0:l.coinAmountA,l==null?void 0:l.coinAmountB,D?(1/Number(W)).toString():W,L);console.log("ðŸš€ ~ file: useCreatePool.ts:273 ~ useCreatePool ~ perMap:",j),ge(j)}else ge(void 0)},[W,y.tick,P.tick,L,D,t==null?void 0:t.tickSpacing],{wait:500});const At=()=>{re(""),ne(),de(!0)},ne=()=>{me(""),je("")};return{baseToken:v,quoteToken:N,handleSelectTokenChange:mt,displayQuoteWhiteTokenList:Z,feeTier:t,setFeeTier:i,feeTierList:a,currentStep:o,editStep:s,setCurrentStep:S,setEditStep:f,displayBaseToken:C,displayQuoteToken:w,handleSwitchDirectionChange:jt,initPrice:W,handleInitPriceChange:St,isFullRange:L,handleRangeModeChange:Q,minTickData:y,maxTickData:P,isReverse:D,handleFeeTierChange:Oe,handlePriceAction:bt,baseAmount:B,quoteAmount:le,handleAmountChange:_t,getConfirmData:()=>({isReverse:D,baseToken:C,quoteToken:w,baseAmount:B,quoteAmount:le,minPrice:Ee,maxPrice:He,initPrice:W,feeDisplay:t.feeDisplay,isFullRange:L}),handleCreateAction:async()=>{const l=y.tokenA;y.tokenB,l.coin_type,M?C.coin_type:w.coin_type;const j={getShowInfo:(m,b)=>{const X=z(C==null?void 0:C.symbol),q=z(w==null?void 0:w.symbol),Ue=`Add ${pe(B)} ${X} and ${pe(le)} ${q}`,ae={modalDescriptionText:Ue,toastTitleText:Ue};if(m==="success"){let Ge=B,Xe=le;b&&(Ge=Be(b,C)||B,Xe=Be(b,w)||le);const Ze=`Add ${pe(Ge)} ${X} and ${pe(Xe)} ${q}`;ae.toastDescriptionContent=Ze,ae.modalDescriptionText=Ze,ae.toastTitleText="Create Success"}return m==="rejected"&&(ae.toastTitleText="Create pool"),ae}};R(j);try{const m=await G(Ae),b=await p(m,j,{showSuccessModal:!1,useDevInspect:!0});if(console.log("ðŸš€ ~ handleCreateAction ~ res:",b),b)return O(),ze(),ye(1),t.feeDisplay}catch(m){console.log("ðŸš€ ~ file: useCreatePool.ts:341 ~ handleCreateAction ~ error:",m),A(j)}},percentMap:_e,currTick:ue,displayMinPrice:Ee,displayMaxPrice:He,handleTickPriceChange:wt,handleStepClick:ye,fetchFeeTierList:U}}function Kr(){const u=ct(),{baseToken:g,quoteToken:d,feeTier:c,currentStep:r,editStep:t,feeTierList:i,handleSelectTokenChange:a,displayQuoteWhiteTokenList:n,displayBaseToken:o,displayQuoteToken:S,handleSwitchDirectionChange:s,initPrice:f,handleInitPriceChange:p,isFullRange:R,handleRangeModeChange:A,handleTickPriceChange:O,isReverse:$,handleFeeTierChange:U,handlePriceAction:G,baseAmount:Z,quoteAmount:v,handleAmountChange:F,getConfirmData:N,handleCreateAction:K,percentMap:M,currTick:te,displayMinPrice:C,displayMaxPrice:h,handleStepClick:w,fetchFeeTierList:J}=tr(),{currentAccount:W,onWalletModal:re}=ut(),{isOpen:L,onOpen:de,onClose:y}=De(),{isOpen:ie,onOpen:P,onClose:oe}=De(),{isOpen:ue,onOpen:he,onClose:_e}=De(),{fetchAccountBalance:ge}=gt(),[D,Ae]=x.useState(),fe=()=>{g&&d&&c&&u(`/liquidity?tab=deposit&poolAddress=${c==null?void 0:c.poolAddress}`,{replace:!0})},ve=()=>({baseToken:o,quoteToken:S,feeDisplay:D}),Re=()=>{g&&d&&J(g.coin_type,d.coin_type),ge()};return e.jsxs(V,{w:"814px",align:"flex-start",gap:"20px",mt:"20px",children:[e.jsxs(E,{w:"100%",justifyContent:"space-between",children:[e.jsxs(ee,{variant:"outline",h:"32px",onClick:()=>u("/pools"),p:"0 12px",borderRadius:"8px",bg:"background",children:[e.jsx(we,{xlinkHref:"#icon-icon_descending_nor",transform:"rotate(90deg)"}),e.jsx(_,{fontSize:"12px",children:"Back"})]}),e.jsx(Kt,{handleRefresh:Re,w:"32px",h:"32px",borderRadius:"8px",bg:"background",innerStyle:{bg:"background"}})]}),e.jsxs(Ce,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",align:"flex-start",children:[e.jsx(Tt,{currentStep:r,handleStepClick:w}),e.jsxs(V,{w:"100%",gap:"16px",children:[e.jsx(Qt,{editStep:t,currentStep:r,onEdit:()=>{w(1)},onContinue:()=>{c&&(c.poolAddress?de():w(2))},baseToken:g,onBaseTokenChange:I=>a(I,!0),quoteToken:d,onQuoteTokenChange:I=>a(I,!1),feeTier:c,feeTierList:i,quoteWhiteTokenList:n,onFeeTierChange:I=>U(I),fromSource:"createPool"}),e.jsx(kt,{editStep:t,currentStep:r,onEdit:()=>w(2),onContinue:()=>{w(3)},displayBaseToken:o,displayQuoteToken:S,initPrice:f,currTick:te,isReverse:$,onInitPriceChange:I=>p(I),handlePriceAction:G,displayMinPrice:C,onMinPriceChange:(I,B)=>{O(I,B,!0)},displayMaxPrice:h,onMaxPriceChange:(I,B)=>{O(I,B,!1)},handleSwitchDirectionChange:s,isFullRange:R,handleRangeModeChange:A}),e.jsx(Mt,{currentStep:r,editStep:t,onCreate:()=>{W?P():re(!0)},percentMap:M,baseToken:o,quoteToken:S,baseAmount:Z,quoteAmount:v,onBaseAmountChange:I=>F(I,!0),onQuoteAmountChange:I=>F(I,!1),isReverse:$})]})]}),L&&e.jsx(Pt,{title:"This Pool already exists",subTitle:"Do you want to provide liquidity?",btnText:"Add liquidity",isOpen:L,onClose:y,onConfirm:fe}),ie&&e.jsx(Yt,{isOpen:ie,onClose:oe,onSubmit:async()=>{oe();const I=await K();I&&(Ae(I),he())},data:N()}),ue&&D&&e.jsx(Jt,{isOpen:ue,onClose:_e,data:ve()})]})}export{Kr as default};
//# sourceMappingURL=CreatePool-DPJZJq8L.js.map

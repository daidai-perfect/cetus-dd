import{A as k}from"./aggregator-oFKtN55h.js";import{u as bs}from"./useTransaction-B2ZSWOCT.js";import{u as De}from"./global-C6vh2RR7.js";import{u as ys}from"./swapConfig-DNLKvr7m.js";import{u as js}from"./useAccountBalance-CvxAcInh.js";import{u as ws,r as ms,ay as _s,y as Fe,bC as Ee,x as Ss,G as M,E as vs,bD as fe,aK as Rs,F as U,a3 as Le,bE as As,n as zs,$ as Ge,X as be,J as Ts,I as se,d as Is,a as ye,e as F,h as Hs,C as Ne,bF as Ve,Z as Ps,K as $s,f as Ws,w as Fs}from"./index-C10POeB7.js";import{a,ay as Es,ak as Ls,j as e,H as h,T as f,C as ee,p as A,V as z,f as T,P as Ke,h as ke,k as qe,m as Ye,n as Je,ae as Bs,S as P,W as Ms,X as Us,Y as Cs,Z as Os,$ as Ds,a0 as Gs,q as ce}from"./vendor-BowHGuwE.js";import{u as je}from"./useToken-CQONILEW.js";import{u as Be}from"./useTokenBalance-BHB-OVys.js";import{u as Ns}from"./useFindBestRouting-DyZEpIII.js";import{b as Xe,A as ge,c as Vs}from"./useSwapHelper-B0yOkkbM.js";import{v as Me,M as Ks,c as ks,u as Ze}from"./usePriceImpact-B0KEz-Yr.js";import{C as we}from"./CurrentPrice-CqynVSTc.js";import{H as qs}from"./HighlightText-DJrmlQd_.js";import{g as pe}from"./index-DTP1Jlsp.js";import{A as Ue}from"./SingleTokenInfo-DwdF0PGY.js";import{H as Ce}from"./HTextLabelBox-seuGwifr.js";import{T as Ys}from"./TradeConfirmAmountInfo-DOA2FYNk.js";import{b as Js}from"./TradeInputGroup-B2IjGkE1.js";var Xs=1,Zs=4;function Qs(t){return Js(t,Xs|Zs)}function Oe(t){const[p,s]=a.useState(),{fetchByApi:r}=ws(),x=async i=>{var u;if(i.is_verified===void 0?i.is_trusted:i.is_verified)return!1;try{let n=!1;const{coins:l}=await r(`/router_v2/honey_pot_check?coins=${i==null?void 0:i.coin_type}`,"GET");return console.log("ðŸš€ðŸš€ðŸš€ ~ useCheckTokenScamsAlert.ts:23 ~ checkIsScamsCoin ~ coins:",l),l&&l.length>0&&(n=(u=l[0])==null?void 0:u.is_honey_pot_scam),n}catch(n){console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:19 ~ checkTokenScams ~ error:",n)}return!1};return a.useEffect(()=>{s(void 0),t&&x(t).then(i=>{s(i)})},[t==null?void 0:t.coin_type]),{isScamsCoin:p}}const er="0xeb863165a109f7791a3182be08aff1438ab2a429314fc135ae19d953afe1edd6";function zr(t,p){const{fromCoin:s,toCoin:r,setFromCoin:x,setToCoin:i,setToAmount:o,fromAmount:u,toAmount:n,setFromAmount:l,routerData:b,setFindRouterLoading:y,setRouterData:d,setByAmountIn:j,byAmountIn:w}=t,{from:_,to:g}=Es(),{findBestRouters:S,checkProvidersKeys:v}=Ns(),{fetchTokenPrices:I,getTokenAmountValue:H}=ms(),{slippage:$,mevProtect:C,maxCapForGas:le,transactionMode:D,customGasPrice:re}=De(),{aggregatorSDK:xe}=_s(),R=Ls(),{fetchTokenInfo:W}=je(),[ae,te]=a.useState(!1),{signAndExecuteTransaction:ue,transactionConfirmation:rs}=bs(),{providersSwitchStates:me,supportOrderSplit:or}=ys(),{fetchAccountBalance:ts}=js(),{balanceInfo:is}=Be(s),{balanceInfo:os}=Be(r),ns=H(s==null?void 0:s.coin_type,u),cs=H(r==null?void 0:r.coin_type,n),[_e,Se]=a.useState(""),ve=a.useRef(""),ie=a.useRef(!0),q=a.useRef(""),Y=a.useRef(""),J=a.useRef(),X=a.useRef(),Re=a.useRef([]);a.useEffect(()=>{J.current=s},[s]),a.useEffect(()=>{X.current=r},[r]),a.useEffect(()=>{ve.current=_e},[_e]),a.useEffect(()=>{ie.current=w},[w]),a.useEffect(()=>{q.current=u},[u]),a.useEffect(()=>{Y.current=n},[n]);const ps=a.useMemo(()=>String(g)+String(_),[_,g]);a.useEffect(()=>{p||ls()},[ps]);const ls=a.useCallback(()=>{!_&&!g?(x(Fe.clmm_swap.from_coin),i(Fe.clmm_swap.to_coin),R("/swap")):(_&&Ee(_)?W(_).then(c=>{c?(c==null?void 0:c.coin_type)!==(s==null?void 0:s.coin_type)&&x(c):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):x(void 0),g&&Ee(g)?W(g).then(c=>{c?(c==null?void 0:c.coin_type)!==(r==null?void 0:r.coin_type)&&i(c):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):i(void 0))},[_,g]),Ae=Ss(async(c,m,E)=>{if(J.current&&X.current&&+c){const O=p?Object.entries(k).map(([B,V])=>B):Object.entries(me).filter(([B,V])=>V===!0).map(([B,V])=>B);(+q.current||+Y.current)&&y(!0);const N=await v(O),Te=vs(c,m?J.current.decimals:X.current.decimals),L=await S({fromToken:J.current,toToken:X.current,amount:Te.toString(),providersKeys:N,by_amount_in:m,uuid:E});y(!1),ve.current===E&&(Re.current=N,m?+q.current?(o(L.toAmountUi||""),d(L)):o(""):+Y.current?(l(L.fromAmountUi||"ÃŸ"),d(L)):l(""))}else Z(!m)},500),xs=(c,m,E=!1)=>{if(j(m),m?(l(c),E&&o("")):(o(c),E&&l("")),+c){const O=Me();Se(O),Ae(c,m,O)}else y(!1),d(void 0),c!=="0"?Z():m?o(""):l("")},G=()=>{const c=ie.current?q.current:Y.current;if(console.log("ðŸš€ ~ file: useSwap.ts:273 ~ reCalculateRouteData ~ amount:",c,ie.current,q.current,Y.current),+c){const m=Me();Se(m),Ae(c,ie.current,m)}};a.useEffect(()=>{G()},[JSON.stringify(me)]);const as=a.useCallback((c,m=!0)=>{Z(),p?m?(c&&M((c==null?void 0:c.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")&&i(s),x(c)):(c&&M((c==null?void 0:c.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")&&x(r),i(c)):m?c&&M((c==null?void 0:c.coin_type)||"")===M((r==null?void 0:r.coin_type)||"")?R(`/swap/${c==null?void 0:c.coin_type}/${s==null?void 0:s.coin_type}`):R(`/swap/${c==null?void 0:c.coin_type}/${r==null?void 0:r.coin_type}`):c&&M((c==null?void 0:c.coin_type)||"")===M((s==null?void 0:s.coin_type)||"")?R(`/swap/${r==null?void 0:r.coin_type}/${c==null?void 0:c.coin_type}`):R(`/swap/${s==null?void 0:s.coin_type}/${c==null?void 0:c.coin_type}`)},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),{amountLimit:us}=Xe($,b),Z=c=>{c===void 0?(l(""),o("")):c?l(""):o(""),y(!1),d(void 0)};a.useEffect(()=>{ze()},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const ze=()=>{const c=[];s&&c.push(s.coin_type),r&&c.push(r.coin_type),c.length>0&&I(c)},ds=()=>({...b}),hs=async c=>{var E,O;let m;try{const{routerData:N,byAmountIn:Te,fromAmountUi:L,toAmountUi:B}=c,V=new Rs,K={routers:N,partner:er,txb:V,slippage:Number($),refreshAllCoins:!0};te(!1),console.log("ðŸš€ ~ file: useSwap.ts:261 ~ doSwapAction ~ params:",K),m={isSwapWidget:p,actionType:"swap",getShowInfo:(He,de)=>{const he=`Swapping ${U(L)} ${s==null?void 0:s.symbol} for ${U(B)} ${r==null?void 0:r.symbol}`,Q={modalDescriptionText:he,toastTitleText:he};if(He==="success"){let Pe=L,$e=B;de&&(Pe=Le(de,s)||L,$e=Le(de,r)||B);const We=`Swapped ${U(Pe)} ${s==null?void 0:s.symbol} for ${U($e)} ${r==null?void 0:r.symbol}`;Q.toastDescriptionContent=We,Q.modalDescriptionText=We,Q.toastTitleText="Swap Successful"}return He==="rejected"&&(Q.toastTitleText=he.replace("Swapping","Swap")),Q}},p||rs(m);const Ie=await ue(async()=>(await xe.fastRouterSwap(K),V),m,{useMev:C,useFastMode:D==="Fast Mode",maxCapForGas:le,customGasPrice:re,msafeParams:{action:"AggregatorSwap",txbParams:{...K,routers:As(K==null?void 0:K.routers)}},otherParams:{routerData:t.routerData,providerKey:Re.current,from:(E=J.current)==null?void 0:E.coin_type,to:(O=X.current)==null?void 0:O.coin_type}});return console.log("ðŸš€ ~ file: useSwap.ts:272 ~ doSwapAction ~ res:",Ie),Ie?(Z(),ts(),!0):(G(),!1)}catch(N){console.log("ðŸš€ ~ doSwapAction ~ error text:",N)}},{isScamsCoin:oe}=Oe(s),{isScamsCoin:ne}=Oe(r),fs=a.useMemo(()=>{if(!(!oe&&!ne)){if(oe&&ne&&(s!=null&&s.symbol)&&(r!=null&&r.symbol))return`${s==null?void 0:s.symbol} and ${r==null?void 0:r.symbol} are`;if(oe&&(s!=null&&s.symbol))return`${s==null?void 0:s.symbol} token is `;if(ne&&(r!=null&&r.symbol))return`${r==null?void 0:r.symbol} token is `}},[oe,ne,s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),gs=async c=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useSwap.ts:491 ~ onReverseClick ~ isOpenAggregatorMode:",c),c?(p?(x(r),i(s)):(x(r),i(s),R(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`)),l(n),o(""),j(!0),await fe(200),G()):w?(p?(x(r),i(s)):R(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`),l(""),o(u),j(!1),await fe(200),G()):(p?(x(r),i(s)):R(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`),l(n),o(""),j(!0),await fe(200),G())};return a.useEffect(()=>()=>{p||(x(void 0),i(void 0)),l(""),o("")},[]),{handleSelectToken:as,handleAmountChange:xs,fromAmount:u,toAmount:n,fromAmountValue:ns,toAmountValue:cs,amountLimit:us,getSwapSecondaryData:ds,reCalculateRouteData:G,fromBalanceInfo:is,toBalanceInfo:os,doSwapAction:hs,scamsText:fs,refreshMarketPrice:ze,isOpenConfirmModel:ae,setIsOpenConfirmModel:te,resetInputAmount:Z,onReverseClick:gs}}function Tr(t,p,s,r,x,i){const{currentAccount:o}=zs(),u=a.useMemo(()=>{const n={text:"Swap",disabled:!1};if(!(o!=null&&o.address))return n.text="Connect Wallet",n.disabled=!1,n;if(!r||!x)return n.text="Select a token",n.disabled=!0,n;if(!+t&&!+p)return n.text="Enter an amount",n.disabled=!0,n;if(i&&i.errorCode){if(i.errorCode===ge.InsufficientLiquidity)return n.text="Insufficient liquidity for this trade",n.disabled=!0,n;if(i.errorCode===ge.NoRouter||i.errorCode===ge.HoneyPot)return n.text="No Available Route",n.disabled=!0,n}return+t&&Ge(t).gt(s||0)?(n.disabled=!0,n.text=`Insufficient ${be(r==null?void 0:r.symbol,10)} Balance`,n):((!+t||!+p)&&(n.disabled=!0),n)},[o==null?void 0:o.address,t,p,s,i==null?void 0:i.errorCode,r,x]);return{btnText:u.text,btnDisabled:u.disabled}}function Qe(t){const{showIncalculable:p,fromToken:s,toToken:r,marketPrice:x,priceImpact:i,sources:o=[],isWidget:u=!1,isLoading:n}=t;return e.jsxs(h,{justify:"space-between",w:"100%",gap:"4px",flexWrap:"wrap",children:[e.jsxs(h,{w:"132px",alignItems:"end",gap:"4px",children:[e.jsx(f,{whiteSpace:"nowrap",fontSize:u?"12px":"14px",h:"20px",lineHeight:"20px",fontWeight:"500",children:"Price Difference"}),e.jsx(Ts,{tooltip:e.jsx(sr,{marketPrice:x,sources:o,fromToken:s,toToken:r,showIncalculable:p}),children:e.jsx(ee,{children:e.jsx(se,{xlinkHref:"#icon-icon_tips",svgW:"20px",svgH:"20px"})})})]}),e.jsx(A,{isLoaded:!n,h:"20px",children:e.jsxs(h,{justify:"flex-end",h:"20px",children:[e.jsx(f,{maxW:u?`calc(90vw - 56px - ${24*((o==null?void 0:o.length)||0)}px)`:"unset",flex:"1",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:i==null?void 0:i.textColor,fontWeight:"500",fontSize:u?"12px":"14px",children:i!=null&&i.priceImpactText&&!p?i==null?void 0:i.priceImpactText:"Incalculable"}),!p&&(o==null?void 0:o.map(l=>e.jsx(Ks,{market:l},l)))]})})]})}function sr(t){const{marketPrice:p,sources:s,fromToken:r,toToken:x,showIncalculable:i}=t;return e.jsxs(z,{className:"no-close-widget-flag",w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(f,{color:"content_text",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The difference between the market price and estimated price due to trade size."}),!i&&e.jsxs(z,{w:"100%",align:"flex-start",children:[e.jsx(f,{fontSize:"12px",color:"text_caption",children:"Market price sources:"}),p?e.jsx(we,{fontSize:"12px",fromToken:r,toToken:x,fromValue:"1",toValue:p,color:"text_caption"}):e.jsx(f,{color:"primary_yellow",fontSize:"12px",children:"Price is unknown"})]}),p&&!i&&e.jsxs(h,{w:"100%",children:[e.jsx(f,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:"Market price sources:"}),e.jsx(f,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:s.map(o=>ks[o]+"  ")})]})]})}function Ir(t){const{fromCoin:p,toCoin:s,findRouterLoading:r,isWidget:x=!1,routerData:i,bg:o="primary_opacity.10"}=t,{marketPrice:u,priceImpact:n,sources:l,priceImpactTextInfo:b,showIncalculable:y}=Ze(p,s,i==null?void 0:i.fromAmountUi,i==null?void 0:i.toAmountUi);return e.jsxs(z,{w:"100%",p:"8px",gap:"8px",bg:o,borderRadius:"12px",align:"flex-start",children:[e.jsx(we,{fromToken:p,toToken:s,fromValue:i==null?void 0:i.fromAmountUi,toValue:i==null?void 0:i.toAmountUi,isLoading:r,color:"text_caption",fontSize:x?"12px":"14px"}),!y&&Is(n).lte(-30)&&e.jsxs(h,{w:"100%",justify:"flex-start",children:[e.jsx(se,{xlinkHref:"#icon-warning",svgFill:"primary_red",svgHover:"primary_red",fontSize:"16px"}),e.jsx(f,{color:"primary_red",fontSize:"12px",lineHeight:"20px",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})]}),e.jsx(Qe,{fromToken:p,isWidget:x,toToken:s,marketPrice:u,priceImpact:b,isLoading:r,sources:l,showIncalculable:y})]})}function Hr({scamsText:t}){return e.jsxs(z,{borderRadius:"8px",border:"1px solid",borderColor:"border",pt:"12px",maxW:"480px",children:[e.jsxs(h,{children:[e.jsx(se,{xlinkHref:"#icon-icon_priceupdated",svgFill:"primary_yellow",svgHover:"primary_yellow",svgW:"20px",svgH:"20px"}),e.jsx(f,{color:"primary_yellow",children:"Alert"})]}),e.jsx(T,{bg:"card_bg",borderRadius:"8px",p:"11px",children:e.jsx(qs,{text:`${t}  detected to have Deny List feature. It's an optional feature on Sui designed for regulated coins (learn more). However, it could be misused by HoneyPot scams, which may restrict users from selling the tokens after buying. Please be cautious.`,keywords:["learn more"],onKeywordClick:()=>{window.open("https://docs.sui.io/guides/developer/coin/regulated","_blank")}})})]})}const es=({data:t,children:p,loading:s,isSwapWidget:r})=>{var l,b,y;const{getTokenListInfo:x}=je(),{isApp:i}=ye(),[o,u]=a.useState(new Map),n=async()=>{var d,j,w;if(t&&(t!=null&&t.routers)&&((d=t==null?void 0:t.routers)==null?void 0:d.length)>0){const _=[];(w=(j=t==null?void 0:t.routers[0])==null?void 0:j.paths)==null||w.forEach(S=>{_.push(S==null?void 0:S.from_type),_.push(S==null?void 0:S.to_type)});const g=await x(_);g&&u(g)}};return a.useEffect(()=>{n()},[t==null?void 0:t.routers]),(t==null?void 0:t.providers)&&e.jsx(A,{isLoaded:!s,minW:"128px",minH:"20px",lineHeight:"20px",children:e.jsxs(h,{w:"100%",gap:"4px",align:"center",justify:"flex-end",wrap:"wrap",children:[(t==null?void 0:t.router_summery)!=="1 Streams"?e.jsx(f,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",overflowWrap:"break-word",children:t==null?void 0:t.router_summery}):e.jsx(e.Fragment,{children:e.jsx(f,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",textAlign:"right",overflowWrap:"break-word",children:(b=(l=t==null?void 0:t.routers[0])==null?void 0:l.paths)==null?void 0:b.map((d,j)=>{var w,_,g;return j===0?`${(w=o==null?void 0:o.get(d==null?void 0:d.from_type))==null?void 0:w.symbol} > ${(_=o==null?void 0:o.get(d==null?void 0:d.to_type))==null?void 0:_.symbol}`:(g=o==null?void 0:o.get(d==null?void 0:d.to_type))==null?void 0:g.symbol}).join(" > ")})}),(y=t==null?void 0:t.providers)==null?void 0:y.map(d=>i&&p?e.jsx(F,{w:"16px",h:"16px",imageUrl:k[d].logo}):e.jsxs(Ke,{isLazy:!0,trigger:i?"click":"hover",children:[e.jsx(ke,{children:e.jsx(T,{children:e.jsx(F,{w:"16px",h:"16px",imageUrl:k[d].logo})})}),e.jsx(qe,{children:e.jsx(Ye,{w:"unset",children:e.jsx(Je,{fontSize:"12px",children:k[d].name})})})]},d)),p]})})};function ss({children:t,fromToken:p,toToken:s,poolAddress:r}){const{isApp:x}=ye(),{getExplorerUrl:i}=Hs();return e.jsxs(Ke,{isLazy:!0,trigger:x?"click":"hover",children:[e.jsx(ke,{children:t}),e.jsx(qe,{children:e.jsx(Ye,{w:"unset",minW:"unset",children:e.jsx(Je,{p:"12px",children:e.jsxs(z,{w:"100%",gap:"12px",className:"no-close-widget-flag",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{w:"100%",justify:"space-between",h:"20px",p:"0",children:[e.jsx(h,{children:e.jsx(f,{fontSize:"12px",color:"text_caption",children:"Pool"})}),e.jsx(Ue,{address:r,color:"text_caption",showLink:!!x,onClickLink:()=>{window.open(i(r,"poolAddress"),"_blank")}})]}),e.jsx(Bs,{orientation:"horizontal",borderColor:"border"})]}),[p,s].map(o=>e.jsxs(h,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsxs(h,{children:[e.jsx(F,{imageUrl:o==null?void 0:o.logo_url,w:"24px",h:"24px",coinType:o?o==null?void 0:o.coin_type:"",showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(z,{align:"flex-start",gap:"0px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",fontWeight:"500",children:be((o==null?void 0:o.symbol)||"",10)})})]}),e.jsx(Ue,{color:"primary_gray",showLink:!!x,address:o==null?void 0:o.coin_type,onClickLink:()=>window.open(i(o==null?void 0:o.coin_type,"coin"))})]},o==null?void 0:o.coin_type))]})})})})]})}const rr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:x,loading:i})=>e.jsxs(z,{w:"100%",align:"center",p:"20px 0 8px",children:[e.jsx(h,{children:i?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(s||"0")}),e.jsx(f,{children:t==null?void 0:t.symbol})]})}),e.jsx(T,{w:"100%",bg:"bg_secondary",p:"20px 8px",borderRadius:"8px",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"},_after:{content:'""',position:"absolute",bottom:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"}},children:e.jsx(z,{gap:i?"56px":"16px",border:"1px dashed",borderColor:"border",borderRadius:"8px",p:i?"36px 0":"16px 0",children:x==null?void 0:x.map((o,u)=>e.jsxs(h,{w:"100%",gap:"0",justify:"space-between",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}},children:[!i&&e.jsx(ee,{borderRadius:"12px",h:"24px",bg:"h5_router_percentage_bg",p:"6px 12px",ml:"20px",zIndex:2,children:e.jsx(f,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(o.percentage)})}),e.jsx(z,{w:"100%",align:"center",sx:o.paths.length>1&&!i?{position:"relative",_before:{content:'""',backgroundColor:"bg_secondary",position:"absolute",top:"20px",right:"16px",width:"calc(100% - 32px)",height:"calc(100% - 40px)",border:"1px dashed",borderColor:"border",borderRadius:"8px",zIndex:2}}:{},children:i?e.jsx(e.Fragment,{children:e.jsxs(h,{gap:"8px",position:"absolute",h:"40px",top:"-20px",borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:2,children:[e.jsxs(h,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):o.paths.map(n=>{var l,b,y,d,j;return e.jsx(ss,{fromToken:n==null?void 0:n.fromToken,toToken:n==null?void 0:n.toToken,poolAddress:n==null?void 0:n.pool_address,children:e.jsxs(h,{borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:3,children:[e.jsx(Ne,{coinAIconUrl:(l=n.fromToken)==null?void 0:l.logo_url,coinBIconUrl:(b=n.toToken)==null?void 0:b.logo_url,w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(y=n.fromToken)==null?void 0:y.coin_type,coinBCoinType:(d=n.toToken)==null?void 0:d.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(j=k[n.provider])==null?void 0:j.name}),!!+n.fee_rate&&e.jsx(ee,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(Ve(n.fee_rate))})})]},n.to_type)},n.to_type)})})]},u))})}),e.jsx(h,{children:i?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(r||"0")}),e.jsx(f,{children:p==null?void 0:p.symbol})]})})]}),tr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:x,loading:i})=>{var o;return e.jsxs(z,{w:"100%",gap:"12px",children:[e.jsxs(h,{w:"100%",justify:"space-between",children:[e.jsx(h,{borderRadius:"14px",h:"28px",p:"0 12px 0 0 ",children:i?e.jsxs(e.Fragment,{children:[e.jsx(P,{w:"28px",h:"28px"}),e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(f,{color:"text_caption",children:U(s||"0")}),e.jsx(f,{children:t==null?void 0:t.symbol})]})}),e.jsx(h,{borderRadius:"14px",h:"28px",p:"0 0 0 12px",children:i?e.jsxs(e.Fragment,{children:[e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]}),e.jsx(P,{w:"28px",h:"28px"})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{color:"text_caption",children:U(r||"0")}),e.jsx(f,{children:p==null?void 0:p.symbol}),e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"})]})})]}),e.jsxs(T,{w:"100%",bg:"bg_secondary",p:"32px 24px",borderRadius:"12px",position:"relative",children:[e.jsx(T,{position:"absolute",left:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"0px 100px 100px 0px",zIndex:2,children:i?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(F,{imageUrl:t==null?void 0:t.logo_url,w:"24px",h:"24px",coinType:t==null?void 0:t.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(T,{position:"absolute",right:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"100px 0px 0px 100px",zIndex:2,children:i?e.jsx(P,{w:"24px",h:"24px"}):e.jsx(F,{imageUrl:p==null?void 0:p.logo_url,w:"24px",h:"24px",coinType:p==null?void 0:p.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(z,{gap:"32px",border:"1px dashed",borderBottom:((o=x||[])==null?void 0:o.length)>1?"1px dashed":"none",borderColor:"border",borderRadius:"8px",children:x==null?void 0:x.map((u,n)=>e.jsxs(h,{mt:n===0?"-20px":0,mb:n===x.length-1?"-20px":0,w:"100%",justify:"space-between",gap:"0",sx:n>0&&n<x.length-1?{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}}:{position:"relative"},children:[!i&&e.jsx(ee,{borderRadius:"12px",h:"24px",bg:"card_bg",p:"8px 12px",ml:"24px",zIndex:2,position:"absolute",children:e.jsx(f,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(u.percentage)})}),e.jsx(h,{h:"40px",w:"100%",justify:"center",zIndex:2,children:i?e.jsx(e.Fragment,{children:e.jsxs(h,{gap:"8px",position:"absolute",h:"40px",borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsxs(h,{gap:"0",children:[e.jsx(P,{w:"24px",h:"24px"}),e.jsx(P,{w:"24px",h:"24px"})]}),e.jsxs(T,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):u.paths.map(l=>{var b,y,d,j,w;return e.jsx(ss,{fromToken:l==null?void 0:l.fromToken,toToken:l==null?void 0:l.toToken,poolAddress:l==null?void 0:l.pool_address,children:e.jsxs(h,{borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsx(Ne,{coinAIconUrl:(b=l.fromToken)==null?void 0:b.logo_url,coinBIconUrl:(y=l.toToken)==null?void 0:y.logo_url,variant:"",p:"0px",w:"24px",h:"24px",imageStyle:{decoding:"async"},coinACoinType:(d=l.fromToken)==null?void 0:d.coin_type,coinBCoinType:(j=l.toToken)==null?void 0:j.coin_type,showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(w=k[l.provider])==null?void 0:w.name}),!!+l.fee_rate&&e.jsx(ee,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(f,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(Ve(l.fee_rate))})})]})},l.to_type)})})]},n))})]})]})},ir=({isOpen:t,onClose:p,data:s,fromCoin:r,toCoin:x,fromAmount:i,toAmount:o})=>{const{isApp:u}=ye(),{getTokenListInfo:n}=je(),[l,b]=a.useState(new Map),y=async S=>{const v=await n(S);v&&(v==null?void 0:v.size)>0&&b(v)};Ps(()=>{var S,v;if(s!=null&&s.routers&&((S=s==null?void 0:s.routers)==null?void 0:S.length)>0){const I=[];(v=s==null?void 0:s.routers)==null||v.forEach(H=>{H.paths.forEach($=>{I.includes($.from_type)||I.push($.from_type),I.includes($.to_type)||I.push($.to_type)})}),y(I)}},[s==null?void 0:s.routers]);const d=a.useMemo(()=>{var S,v;return!(s!=null&&s.routers)||((S=s==null?void 0:s.routers)==null?void 0:S.length)===0||(l==null?void 0:l.size)===0?[]:(v=s==null?void 0:s.routers)==null?void 0:v.map(I=>({...I,paths:I.paths.map(H=>({...H,fromToken:l==null?void 0:l.get(H.from_type),toToken:l==null?void 0:l.get(H.to_type)}))}))},[s==null?void 0:s.routers,l]),j={fromToken:r,toToken:x,fromAmount:i,toAmount:o,routes:d},[w,_]=a.useState(!0),g=a.useRef(null);return a.useEffect(()=>(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{_(!1)},200),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),e.jsxs(Ms,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:p,isCentered:!0,children:[e.jsx(Us,{}),e.jsxs(Cs,{maxW:"1200px",w:u?"calc(100vw - 32px)":"880px",children:[e.jsx(Os,{mr:"-10px",children:e.jsxs(h,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(f,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Route"}),e.jsxs(h,{gap:"0",align:"center",children:[e.jsx(es,{data:s}),e.jsx(Ds,{mt:"0",position:"static"})]})]})}),e.jsx(Gs,{p:{base:"8px 16px",lg:"16px"},children:u?e.jsx(rr,{...j,loading:w}):e.jsx(tr,{...j,loading:w})})]})]})};function Pr(t){const{formatSwapRouter:p,findRouterLoading:s,fromAmount:r,toAmount:x,fromCoin:i,toCoin:o,isSwapWidget:u=!1,handleSwapWidgetRouterClick:n}=t,[l,b]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(h,{w:"100%",justify:"space-between",p:"0 8px",children:[e.jsx(f,{fontSize:u?"12px":"14px",fontWeight:"500",whiteSpace:"nowrap",children:"Auto Router"}),e.jsx(T,{onClick:y=>{$s(y),u?n&&n():b(!l)},cursor:"pointer",children:e.jsx(es,{data:p,loading:s,isSwapWidget:u,children:e.jsx(se,{xlinkHref:"#icon-icon_spread",fontSize:"16px"})})})]}),l&&!u&&e.jsx(ir,{isOpen:l,onClose:()=>b(!1),fromCoin:i,toCoin:o,data:p,fromAmount:r,toAmount:x})]})}function $r(t){const{lastRouterData:p,fromCoin:s,toCoin:r,onClose:x,data:i,onSubmitClick:o,isWidget:u}=t,{slippage:n}=De(),l=a.useRef(!1),[b,y]=a.useState(i),{fromAmountUi:d,toAmountUi:j,byAmountIn:w}=b,{amountLimit:_}=Xe(n,b),[g,S]=a.useState(!1),{priceImpactTextInfo:v,marketPrice:I,sources:H,showPriceImpactTips:$,showPriceImpactWarn:C,showIncalculable:le}=Ze(s,r,d,j),{priceAcceptRouterData:D}=Vs(b,p),[re,xe]=a.useState(!1),R=a.useMemo(()=>D!==void 0,[D]),W=a.useMemo(()=>w?r:s,[w]),ae=()=>{if(D){if(l.current)return;l.current=!0;const ue=Qs(D);y(ue),setTimeout(()=>{l.current=!1},300)}},te=a.useMemo(()=>g?!1:!!C,[g,C]);return e.jsxs(z,{textAlign:"center",p:"0px",w:"100%",children:[e.jsxs(z,{w:"100%",gap:"16px",pl:"16px",pr:"16px",pb:"16px",children:[e.jsx(Ys,{bg:u?"swap_bg_primary":"bg_primary",coinA:{amount:d||"0",...s},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:j||"0",...r}}),e.jsx(h,{w:"100%",minH:"48px",bg:u?"swap_bg_primary":"bg_primary",borderRadius:"8px",border:"1px solid",borderColor:"border",justifyContent:"center",zIndex:"100",children:e.jsx(we,{fromToken:s,toToken:r,fromValue:d,toValue:j,color:"text_caption"})}),$&&e.jsx(h,{zIndex:"99",w:"100%",mt:"-26px",bg:C?"primary_red_opacity.10":"primary_yellow_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"center",p:"18px 16px 10px",children:e.jsx(f,{color:C?"primary_red":"primary_yellow",fontSize:"12px",lineHeight:"20px",textAlign:"start",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})}),e.jsx(Ce,{wrapStyle:{h:"20px",lineHeight:"20px"},label:"Slippage Tolerance",labelStyle:{fontSize:"14px"},value:`${Ge(n).mul(100)}%`,valueStyle:{fontSize:"14px"}}),e.jsx(Ce,{wrapStyle:{h:"20px",lineHeight:"20px"},label:w?"Minimum Received":"Maximum Input",labelStyle:{fontSize:"14px"},value:`${Ws(_||0,W==null?void 0:W.decimals,!1,Fs.ROUND_DOWN).toString()} ${be(W==null?void 0:W.symbol)}`,valueStyle:{fontSize:"14px"}}),e.jsx(Qe,{fromToken:s,toToken:r,sources:H,marketPrice:I,priceImpact:v,showIncalculable:le}),C&&e.jsxs(z,{w:"100%",gap:"8px",children:[e.jsx(h,{w:"100%",bg:"primary_red_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"start",p:"10px 16px",children:e.jsx(f,{color:"primary_red",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?"})}),e.jsxs(h,{w:"100%",justifyContent:"space-between",gap:"16px",children:[e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:g?"text_highlight":"button_outline_border",onClick:()=>{S(!0)},children:"Yes, please continue."}),e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:"button_outline_border",onClick:x,children:"No,cancel it."})]})]}),R&&e.jsxs(h,{w:"100%",justifyContent:"space-between",children:[e.jsxs(h,{children:[e.jsx(se,{xlinkHref:"#icon-icon_priceupdated1",svgW:"20px",svgH:"20px"}),e.jsx(f,{color:"text_caption",fontWeight:"500",fontSize:"14px",children:"Price updated"})]}),e.jsx(ce,{onClick:ae,h:"40px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",p:"0 42px",children:"Accept"})]})]}),!R&&e.jsx(ce,{disabled:te,isLoading:re,mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{re||(xe(!0),o(b))},children:"Confirm Swap"})]})}export{rr as H,es as O,Ir as P,Hr as S,Tr as a,Pr as b,$r as c,zr as u};
//# sourceMappingURL=SwapConfirmBlock-Bk0QDyse.js.map

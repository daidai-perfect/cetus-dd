import{A as G}from"./aggregator-BE05R8Nv.js";import{u as fs}from"./useTransaction-_40Gj-Xj.js";import{u as Be}from"./global-XGPon1rE.js";import{i as gs,u as bs}from"./index-p86JPiOx.js";import{u as js}from"./useAccountBalance-BlkjpDIb.js";import{r as ms,Y as ys,z as $e,bE as Te,x as ws,y as _s,bF as de,a_ as Ss,F as M,a6 as We,bG as vs,n as Rs,a2 as Oe,$ as Ce,H as As,I as k,d as zs,a as fe,c as W,e as Is,C as De,a1 as Hs,J as Ps,m as $s,w as Ts}from"./index-ptnn7YYs.js";import{a,az as Ws,ab as Fs,j as e,H as u,T as d,C as Q,u as A,V as z,f as I,P as Ne,h as Ve,k as Ge,m as Ke,n as Ye,ag as Ls,S as $,X as Es,Y as Ms,Z as Us,$ as Bs,a0 as Os,a1 as Cs,v as ce}from"./vendor-DsVemle5.js";import{u as ge}from"./useToken-D0Y8EMfE.js";import{u as Fe}from"./useTokenBalance-BmzoUDH9.js";import{u as Ds}from"./useFindBestRouting-DsIA0n5P.js";import{b as qe,A as he,c as Ns}from"./useSwapHelper-CkdGRiyG.js";import{v as Le}from"./v4-C6aID195.js";import{M as Vs,a as Gs,u as Je}from"./usePriceImpact-DsXChPO7.js";import{C as be}from"./CurrentPrice-BdO6dfIz.js";import{H as Ks}from"./HighlightText-D28Vg5Uh.js";import{g as pe}from"./index-Cr9gqCFC.js";import{A as Ee}from"./SingleTokenInfo-BK4bHte8.js";import{H as Me}from"./HTextLabelBox-BSdt2JjM.js";import{T as Ys}from"./TradeConfirmAmountInfo-DPXgMlK5.js";import{b as qs}from"./TradeInputGroup-cjeY54io.js";var Js=1,Xs=4;function Zs(t){return qs(t,Js|Xs)}function Ue(t){const[p,s]=a.useState(),r=async l=>{if(l.is_verified===void 0?l.is_trusted:l.is_verified)return!1;try{const i=await gs(l.coin_type);return console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:24 ~ checkIsScamsCoin ~ isScamsCoin:",i),i}catch(i){console.log("ðŸš€ ~ file: useCheckTokenScamsAlert.ts:19 ~ checkTokenScams ~ error:",i)}return!1};return a.useEffect(()=>{s(void 0),t&&r(t).then(l=>{s(l)})},[t==null?void 0:t.coin_type]),{isScamsCoin:p}}const Qs="0xeb863165a109f7791a3182be08aff1438ab2a429314fc135ae19d953afe1edd6";function Ar(t,p){const{fromCoin:s,toCoin:r,setFromCoin:l,setToCoin:o,setToAmount:i,fromAmount:f,toAmount:c,setFromAmount:x,routerData:b,setFindRouterLoading:j,setRouterData:h,setByAmountIn:S,byAmountIn:v}=t,{from:w,to:g}=Ws(),{findBestRouters:_,checkProvidersKeys:R}=Ds(),{fetchTokenPrices:H,getTokenAmountValue:P}=ms(),{slippage:T,mevProtect:U,maxCapForGas:O,transactionMode:ee,customGasPrice:le}=Be(),{aggregatorSDK:se}=ys(),m=Fs(),{fetchTokenInfo:re}=ge(),[xe,te]=a.useState(!1),{signAndExecuteTransaction:ke,transactionConfirmation:es}=fs(),{providersSwitchStates:je,supportOrderSplit:tr}=bs(),{fetchAccountBalance:ss}=js(),{balanceInfo:rs}=Fe(s),{balanceInfo:ts}=Fe(r),is=P(s==null?void 0:s.coin_type,f),os=P(r==null?void 0:r.coin_type,c),[me,ye]=a.useState(""),we=a.useRef(""),ie=a.useRef(!0),K=a.useRef(""),Y=a.useRef(""),q=a.useRef(),J=a.useRef(),_e=a.useRef([]);a.useEffect(()=>{q.current=s},[s]),a.useEffect(()=>{J.current=r},[r]),a.useEffect(()=>{we.current=me},[me]),a.useEffect(()=>{ie.current=v},[v]),a.useEffect(()=>{K.current=f},[f]),a.useEffect(()=>{Y.current=c},[c]);const ns=a.useMemo(()=>String(g)+String(w),[w,g]);a.useEffect(()=>{p||cs()},[ns]);const cs=a.useCallback(()=>{!w&&!g?(l($e.clmm_swap.from_coin),o($e.clmm_swap.to_coin),m("/swap")):(w&&Te(w)?re(w).then(n=>{n?(n==null?void 0:n.coin_type)!==(s==null?void 0:s.coin_type)&&l(n):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):l(void 0),g&&Te(g)?re(g).then(n=>{n?(n==null?void 0:n.coin_type)!==(r==null?void 0:r.coin_type)&&o(n):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`)}):o(void 0))},[w,g]),Se=ws(async(n,y,F)=>{if(q.current&&J.current&&+n){const B=p?Object.entries(G).map(([E,N])=>E):Object.entries(je).filter(([E,N])=>N===!0).map(([E,N])=>E);(+K.current||+Y.current)&&j(!0);const D=await R(B),Re=_s(n,y?q.current.decimals:J.current.decimals),L=await _({fromToken:q.current,toToken:J.current,amount:Re.toString(),providersKeys:D,by_amount_in:y,uuid:F});j(!1),we.current===F&&(_e.current=D,y?+K.current?(i(L.toAmountUi||""),h(L)):i(""):+Y.current?(x(L.fromAmountUi||"ÃŸ"),h(L)):x(""))}else X(!y)},500),ps=(n,y,F=!1)=>{if(S(y),y?(x(n),F&&i("")):(i(n),F&&x("")),+n){const B=Le();ye(B),Se(n,y,B)}else j(!1),h(void 0),n!=="0"?X():y?i(""):x("")},C=()=>{const n=ie.current?K.current:Y.current;if(console.log("ðŸš€ ~ file: useSwap.ts:273 ~ reCalculateRouteData ~ amount:",n,ie.current,K.current,Y.current),+n){const y=Le();ye(y),Se(n,ie.current,y)}};a.useEffect(()=>{C()},[JSON.stringify(je)]);const ls=a.useCallback((n,y=!0)=>{X(),p?y?(n&&(n==null?void 0:n.coin_type)===(r==null?void 0:r.coin_type)&&o(s),l(n)):(n&&(n==null?void 0:n.coin_type)===(s==null?void 0:s.coin_type)&&l(r),o(n)):y?n&&(n==null?void 0:n.coin_type)===(r==null?void 0:r.coin_type)?m(`/swap/${n==null?void 0:n.coin_type}/${s==null?void 0:s.coin_type}`):m(`/swap/${n==null?void 0:n.coin_type}/${r==null?void 0:r.coin_type}`):n&&(n==null?void 0:n.coin_type)===(s==null?void 0:s.coin_type)?m(`/swap/${r==null?void 0:r.coin_type}/${n==null?void 0:n.coin_type}`):m(`/swap/${s==null?void 0:s.coin_type}/${n==null?void 0:n.coin_type}`)},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),{amountLimit:xs}=qe(T,b),X=n=>{n===void 0?(x(""),i("")):n?x(""):i(""),j(!1),h(void 0)};a.useEffect(()=>{ve()},[s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]);const ve=()=>{const n=[];s&&n.push(s.coin_type),r&&n.push(r.coin_type),n.length>0&&H(n)},as=()=>({...b}),us=async n=>{var F,B;let y;try{const{routerData:D,byAmountIn:Re,fromAmountUi:L,toAmountUi:E}=n,N=new Ss,V={routers:D,partner:Qs,txb:N,slippage:Number(T),refreshAllCoins:!0};te(!1),console.log("ðŸš€ ~ file: useSwap.ts:261 ~ doSwapAction ~ params:",V),y={isSwapWidget:p,actionType:"swap",getShowInfo:(ze,ae)=>{const ue=`Swapping ${M(L)} ${s==null?void 0:s.symbol} for ${M(E)} ${r==null?void 0:r.symbol}`,Z={modalDescriptionText:ue,toastTitleText:ue};if(ze==="success"){let Ie=L,He=E;ae&&(Ie=We(ae,s)||L,He=We(ae,r)||E);const Pe=`Swapped ${M(Ie)} ${s==null?void 0:s.symbol} for ${M(He)} ${r==null?void 0:r.symbol}`;Z.toastDescriptionContent=Pe,Z.modalDescriptionText=Pe,Z.toastTitleText="Swap Successful"}return ze==="rejected"&&(Z.toastTitleText=ue.replace("Swapping","Swap")),Z}},p||es(y);const Ae=await ke(async()=>(await se.fastRouterSwap(V),N),y,{useMev:U,useFastMode:ee==="Fast Mode",maxCapForGas:O,customGasPrice:le,msafeParams:{action:"AggregatorSwap",txbParams:{...V,routers:vs(V==null?void 0:V.routers)}},otherParams:{routerData:t.routerData,providerKey:_e.current,from:(F=q.current)==null?void 0:F.coin_type,to:(B=J.current)==null?void 0:B.coin_type}});return console.log("ðŸš€ ~ file: useSwap.ts:272 ~ doSwapAction ~ res:",Ae),Ae?(X(),ss(),!0):(C(),!1)}catch(D){console.log("ðŸš€ ~ doSwapAction ~ error text:",D)}},{isScamsCoin:oe}=Ue(s),{isScamsCoin:ne}=Ue(r),ds=a.useMemo(()=>{if(!(!oe&&!ne)){if(oe&&ne&&(s!=null&&s.symbol)&&(r!=null&&r.symbol))return`${s==null?void 0:s.symbol} and ${r==null?void 0:r.symbol} are`;if(oe&&(s!=null&&s.symbol))return`${s==null?void 0:s.symbol} token is `;if(ne&&(r!=null&&r.symbol))return`${r==null?void 0:r.symbol} token is `}},[oe,ne,s==null?void 0:s.coin_type,r==null?void 0:r.coin_type]),hs=async n=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useSwap.ts:491 ~ onReverseClick ~ isOpenAggregatorMode:",n),n?(p?(l(r),o(s)):(l(r),o(s),m(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`)),x(c),i(""),S(!0),await de(200),C()):v?(p?(l(r),o(s)):m(`/swap/${r==null?void 0:r.coin_type}/${s==null?void 0:s.coin_type}`),x(""),i(f),S(!1),await de(200),C()):(p?(l(r),o(s)):m(`/swap/${s==null?void 0:s.coin_type}/${r==null?void 0:r.coin_type}`),x(c),i(""),S(!0),await de(200),C())};return a.useEffect(()=>()=>{p||(l(void 0),o(void 0)),x(""),i("")},[]),{handleSelectToken:ls,handleAmountChange:ps,fromAmount:f,toAmount:c,fromAmountValue:is,toAmountValue:os,amountLimit:xs,getSwapSecondaryData:as,reCalculateRouteData:C,fromBalanceInfo:rs,toBalanceInfo:ts,doSwapAction:us,scamsText:ds,refreshMarketPrice:ve,isOpenConfirmModel:xe,setIsOpenConfirmModel:te,resetInputAmount:X,onReverseClick:hs}}function zr(t,p,s,r,l,o){const{currentAccount:i}=Rs(),f=a.useMemo(()=>{const c={text:"Swap",disabled:!1};if(!(i!=null&&i.address))return c.text="Connect Wallet",c.disabled=!1,c;if(!r||!l)return c.text="Select a token",c.disabled=!0,c;if(!+t&&!+p)return c.text="Enter an amount",c.disabled=!0,c;if(o&&o.errorCode){if(o.errorCode===he.InsufficientLiquidity)return c.text="Insufficient liquidity for this trade",c.disabled=!0,c;if(o.errorCode===he.NoRouter||o.errorCode===he.HoneyPot)return c.text="No Available Route",c.disabled=!0,c}return+t&&Oe(t).gt(s||0)?(c.disabled=!0,c.text=`Insufficient ${Ce(r==null?void 0:r.symbol,10)} Balance`,c):((!+t||!+p)&&(c.disabled=!0),c)},[i==null?void 0:i.address,t,p,s,o==null?void 0:o.errorCode,r,l]);return{btnText:f.text,btnDisabled:f.disabled}}function Xe(t){const{fromToken:p,toToken:s,marketPrice:r,priceImpact:l,sources:o=[],isWidget:i=!1,isLoading:f}=t;return e.jsxs(u,{justify:"space-between",w:"100%",gap:"4px",flexWrap:"wrap",children:[e.jsxs(u,{w:"132px",alignItems:"end",gap:"4px",children:[e.jsx(d,{whiteSpace:"nowrap",fontSize:i?"12px":"14px",h:"20px",lineHeight:"20px",fontWeight:"500",children:"Price Difference"}),e.jsx(As,{tooltip:e.jsx(ks,{marketPrice:r,sources:o,fromToken:p,toToken:s}),children:e.jsx(Q,{children:e.jsx(k,{xlinkHref:"#icon-icon_tips",svgW:"20px",svgH:"20px"})})})]}),e.jsx(A,{isLoaded:!f,h:"20px",children:e.jsxs(u,{justify:"flex-end",children:[e.jsx(d,{maxW:i?`calc(90vw - 56px - ${24*((o==null?void 0:o.length)||0)}px)`:"unset",flex:"1",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:l==null?void 0:l.textColor,fontWeight:"500",fontSize:i?"12px":"14px",children:l!=null&&l.priceImpactText?l==null?void 0:l.priceImpactText:"Incalculable"}),o==null?void 0:o.map(c=>e.jsx(Vs,{market:c},c))]})})]})}function ks(t){const{marketPrice:p,sources:s,fromToken:r,toToken:l}=t;return e.jsxs(z,{className:"no-close-widget-flag",w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(d,{color:"content_text",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The difference between the market price and estimated price due to trade size."}),e.jsxs(z,{w:"100%",align:"flex-start",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:"Market price sources:"}),p?e.jsx(be,{fontSize:"12px",fromToken:r,toToken:l,fromValue:"1",toValue:p,color:"text_caption"}):e.jsx(d,{color:"primary_yellow",fontSize:"12px",children:"Price is unknown"})]}),p&&e.jsxs(u,{w:"100%",children:[e.jsx(d,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:"Market price sources:"}),e.jsx(d,{color:"content_text",fontSize:"12px",mt:"5px",whiteSpace:"pre",children:s.map(o=>Gs[o]+"  ")})]})]})}function Ir(t){const{fromCoin:p,toCoin:s,findRouterLoading:r,isWidget:l=!1,routerData:o,bg:i="primary_opacity.10"}=t,{marketPrice:f,priceImpact:c,sources:x,priceImpactTextInfo:b,hideShowPriceImpact:j}=Je(p,s,o==null?void 0:o.fromAmountUi,o==null?void 0:o.toAmountUi);return e.jsxs(z,{w:"100%",p:"8px",gap:"8px",bg:i,borderRadius:"12px",align:"flex-start",children:[e.jsx(be,{fromToken:p,toToken:s,fromValue:o==null?void 0:o.fromAmountUi,toValue:o==null?void 0:o.toAmountUi,isLoading:r,color:"text_caption",fontSize:l?"12px":"14px"}),!j&&zs(c).lte(-30)&&e.jsxs(u,{w:"100%",justify:"flex-start",children:[e.jsx(k,{xlinkHref:"#icon-warning",svgFill:"primary_red",svgHover:"primary_red",fontSize:"16px"}),e.jsx(d,{color:"primary_red",fontSize:"12px",lineHeight:"20px",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})]}),!j&&e.jsx(Xe,{fromToken:p,isWidget:l,toToken:s,marketPrice:f,priceImpact:b,isLoading:r,sources:x})]})}function Hr({scamsText:t}){return e.jsxs(z,{borderRadius:"8px",border:"1px solid",borderColor:"border",pt:"12px",maxW:"480px",children:[e.jsxs(u,{children:[e.jsx(k,{xlinkHref:"#icon-icon_priceupdated",svgFill:"primary_yellow",svgHover:"primary_yellow",svgW:"20px",svgH:"20px"}),e.jsx(d,{color:"primary_yellow",children:"Alert"})]}),e.jsx(I,{bg:"card_bg",borderRadius:"8px",p:"11px",children:e.jsx(Ks,{text:`${t}  detected to have Deny List feature. It's an optional feature on Sui designed for regulated coins (learn more). However, it could be misused by HoneyPot scams, which may restrict users from selling the tokens after buying. Please be cautious.`,keywords:["learn more"],onKeywordClick:()=>{window.open("https://docs.sui.io/guides/developer/coin/regulated","_blank")}})})]})}const Ze=({data:t,children:p,loading:s,isSwapWidget:r})=>{var x,b,j;const{getTokenListInfo:l}=ge(),{isApp:o}=fe(),[i,f]=a.useState(new Map),c=async()=>{var h,S,v;if(t&&(t!=null&&t.routers)&&((h=t==null?void 0:t.routers)==null?void 0:h.length)>0){const w=[];(v=(S=t==null?void 0:t.routers[0])==null?void 0:S.paths)==null||v.forEach(_=>{w.push(_==null?void 0:_.from_type),w.push(_==null?void 0:_.to_type)});const g=await l(w);g&&f(g)}};return a.useEffect(()=>{c()},[t==null?void 0:t.routers]),(t==null?void 0:t.providers)&&e.jsx(A,{isLoaded:!s,minW:"128px",minH:"20px",lineHeight:"20px",children:e.jsxs(u,{w:"100%",gap:"4px",align:"center",justify:"flex-end",wrap:"wrap",children:[(t==null?void 0:t.router_summery)!=="1 Streams"?e.jsx(d,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",overflowWrap:"break-word",children:t==null?void 0:t.router_summery}):e.jsx(e.Fragment,{children:e.jsx(d,{color:"text_caption",fontSize:r?"12px":"14px",fontWeight:"500",textAlign:"right",overflowWrap:"break-word",children:(b=(x=t==null?void 0:t.routers[0])==null?void 0:x.paths)==null?void 0:b.map((h,S)=>{var v,w,g;return S===0?`${(v=i==null?void 0:i.get(h==null?void 0:h.from_type))==null?void 0:v.symbol} > ${(w=i==null?void 0:i.get(h==null?void 0:h.to_type))==null?void 0:w.symbol}`:(g=i==null?void 0:i.get(h==null?void 0:h.to_type))==null?void 0:g.symbol}).join(" > ")})}),(j=t==null?void 0:t.providers)==null?void 0:j.map(h=>o&&p?e.jsx(W,{w:"16px",h:"16px",imageUrl:G[h].logo}):e.jsxs(Ne,{isLazy:!0,trigger:o?"click":"hover",children:[e.jsx(Ve,{children:e.jsx(I,{children:e.jsx(W,{w:"16px",h:"16px",imageUrl:G[h].logo})})}),e.jsx(Ge,{children:e.jsx(Ke,{w:"unset",children:e.jsx(Ye,{fontSize:"12px",children:G[h].name})})})]},h)),p]})})};function Qe({children:t,fromToken:p,toToken:s,poolAddress:r}){const{isApp:l}=fe(),{getExplorerUrl:o}=Is();return e.jsxs(Ne,{isLazy:!0,trigger:l?"click":"hover",children:[e.jsx(Ve,{children:t}),e.jsx(Ge,{children:e.jsx(Ke,{w:"unset",minW:"unset",children:e.jsx(Ye,{p:"12px",children:e.jsxs(z,{w:"100%",gap:"12px",className:"no-close-widget-flag",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{w:"100%",justify:"space-between",h:"20px",p:"0",children:[e.jsx(u,{children:e.jsx(d,{fontSize:"12px",color:"text_caption",children:"Pool"})}),e.jsx(Ee,{address:r,color:"text_caption",showLink:!!l,onClickLink:()=>{window.open(o(r,"poolAddress"),"_blank")}})]}),e.jsx(Ls,{orientation:"horizontal",borderColor:"border"})]}),[p,s].map(i=>e.jsxs(u,{w:"100%",justify:"space-between",gap:"12px",children:[e.jsxs(u,{children:[e.jsx(W,{imageUrl:i==null?void 0:i.logo_url,w:"24px",h:"24px",coinType:i?i==null?void 0:i.coin_type:"",showTagWidth:"10px",showTagHeight:"10px"}),e.jsx(z,{align:"flex-start",gap:"0px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",fontWeight:"500",children:Ce((i==null?void 0:i.symbol)||"",10)})})]}),e.jsx(Ee,{color:"primary_gray",showLink:!!l,address:i==null?void 0:i.coin_type,onClickLink:()=>window.open(o(i==null?void 0:i.coin_type,"coin"))})]},i==null?void 0:i.coin_type))]})})})})]})}const er=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>e.jsxs(z,{w:"100%",align:"center",p:"20px 0 8px",children:[e.jsx(u,{children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:M(s||"0")}),e.jsx(d,{children:t==null?void 0:t.symbol})]})}),e.jsx(I,{w:"100%",bg:"bg_secondary",p:"20px 8px",borderRadius:"8px",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"},_after:{content:'""',position:"absolute",bottom:"0",left:"50%",width:"0",height:"20px",borderLeft:"1px dashed",borderColor:"border"}},children:e.jsx(z,{gap:o?"56px":"16px",border:"1px dashed",borderColor:"border",borderRadius:"8px",p:o?"36px 0":"16px 0",children:l==null?void 0:l.map((i,f)=>e.jsxs(u,{w:"100%",gap:"0",justify:"space-between",sx:{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}},children:[!o&&e.jsx(Q,{borderRadius:"12px",h:"24px",bg:"h5_router_percentage_bg",p:"6px 12px",ml:"20px",zIndex:2,children:e.jsx(d,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(i.percentage)})}),e.jsx(z,{w:"100%",align:"center",sx:i.paths.length>1&&!o?{position:"relative",_before:{content:'""',backgroundColor:"bg_secondary",position:"absolute",top:"20px",right:"16px",width:"calc(100% - 32px)",height:"calc(100% - 40px)",border:"1px dashed",borderColor:"border",borderRadius:"8px",zIndex:2}}:{},children:o?e.jsx(e.Fragment,{children:e.jsxs(u,{gap:"8px",position:"absolute",h:"40px",top:"-20px",borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:2,children:[e.jsxs(u,{gap:"0",children:[e.jsx($,{w:"24px",h:"24px"}),e.jsx($,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):i.paths.map(c=>{var x,b,j;return e.jsx(Qe,{fromToken:c==null?void 0:c.fromToken,toToken:c==null?void 0:c.toToken,poolAddress:c==null?void 0:c.pool_address,children:e.jsxs(u,{borderRadius:"20px",p:"8px",bg:"card_bg",zIndex:3,children:[e.jsx(De,{coinAIconUrl:(x=c.fromToken)==null?void 0:x.logo_url,coinBIconUrl:(b=c.toToken)==null?void 0:b.logo_url,w:"24px",h:"24px",imageStyle:{decoding:"async"}}),e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(j=G[c.provider])==null?void 0:j.name}),!!+c.fee_rate&&e.jsx(Q,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(c.fee_rate)})})]},c.to_type)},c.to_type)})})]},f))})}),e.jsx(u,{children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:M(r||"0")}),e.jsx(d,{children:p==null?void 0:p.symbol})]})})]}),sr=({fromToken:t,toToken:p,fromAmount:s,toAmount:r,routes:l,loading:o})=>{var i;return e.jsxs(z,{w:"100%",gap:"12px",children:[e.jsxs(u,{w:"100%",justify:"space-between",children:[e.jsx(u,{borderRadius:"14px",h:"28px",p:"0 12px 0 0 ",children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{w:"28px",h:"28px"}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"28px",h:"28px",coinType:t==null?void 0:t.coin_type,showTagWidth:"12px",showTagHeight:"12px"}),e.jsx(d,{color:"text_caption",children:M(s||"0")}),e.jsx(d,{children:t==null?void 0:t.symbol})]})}),e.jsx(u,{borderRadius:"14px",h:"28px",p:"0 0 0 12px",children:o?e.jsxs(e.Fragment,{children:[e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]}),e.jsx($,{w:"28px",h:"28px"})]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{color:"text_caption",children:M(r||"0")}),e.jsx(d,{children:p==null?void 0:p.symbol}),e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:p==null?void 0:p.coin_type,showTagWidth:"12px",showTagHeight:"12px"})]})})]}),e.jsxs(I,{w:"100%",bg:"bg_secondary",p:"32px 24px",borderRadius:"12px",position:"relative",children:[e.jsx(I,{position:"absolute",left:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"0px 100px 100px 0px",zIndex:2,children:o?e.jsx($,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:t==null?void 0:t.logo_url,w:"24px",h:"24px",coinType:t==null?void 0:t.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(I,{position:"absolute",right:"0",p:"8px",top:"calc(50% - 20px)",bg:"background",borderRadius:"100px 0px 0px 100px",zIndex:2,children:o?e.jsx($,{w:"24px",h:"24px"}):e.jsx(W,{imageUrl:p==null?void 0:p.logo_url,w:"24px",h:"24px",coinType:p==null?void 0:p.coin_type,showTagWidth:"10px",showTagHeight:"10px"})}),e.jsx(z,{gap:"32px",border:"1px dashed",borderBottom:((i=l||[])==null?void 0:i.length)>1?"1px dashed":"none",borderColor:"border",borderRadius:"8px",children:l==null?void 0:l.map((f,c)=>e.jsxs(u,{mt:c===0?"-20px":0,mb:c===l.length-1?"-20px":0,w:"100%",justify:"space-between",gap:"0",sx:c>0&&c<l.length-1?{position:"relative",_before:{content:'""',position:"absolute",top:"50%",left:"0",width:"100%",height:"1px",borderTop:"1px dashed",borderColor:"border",zIndex:1}}:{position:"relative"},children:[!o&&e.jsx(Q,{borderRadius:"12px",h:"24px",bg:"card_bg",p:"8px 12px",ml:"40px",zIndex:2,position:"absolute",children:e.jsx(d,{color:"primary",fontSize:"12px",lineHeight:"12px",fontWeight:"500",children:pe(f.percentage)})}),e.jsx(u,{h:"40px",w:"100%",justify:"center",zIndex:2,children:o?e.jsx(e.Fragment,{children:e.jsxs(u,{gap:"8px",position:"absolute",h:"40px",borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsxs(u,{gap:"0",children:[e.jsx($,{w:"24px",h:"24px"}),e.jsx($,{w:"24px",h:"24px"})]}),e.jsxs(I,{pos:"relative",w:"100px",h:"14px",children:[e.jsx(A,{pos:"absolute",left:"0",w:"50%",borderRadius:"4px",h:"14px",endColor:"skeleton_light"}),e.jsx(A,{pos:"absolute",right:"0",w:"100%",h:"14px"})]})]})}):f.paths.map(x=>{var b,j,h;return e.jsx(Qe,{fromToken:x==null?void 0:x.fromToken,toToken:x==null?void 0:x.toToken,poolAddress:x==null?void 0:x.pool_address,children:e.jsxs(u,{borderRadius:"20px",p:"8px",bg:"card_bg",children:[e.jsx(De,{coinAIconUrl:(b=x.fromToken)==null?void 0:b.logo_url,coinBIconUrl:(j=x.toToken)==null?void 0:j.logo_url,variant:"",p:"0px",w:"24px",h:"24px",imageStyle:{decoding:"async"}}),e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:(h=G[x.provider])==null?void 0:h.name}),!!+x.fee_rate&&e.jsx(Q,{p:"6px 8px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:e.jsx(d,{fontSize:"12px",color:"text_caption",lineHeight:"12px",fontWeight:"500",children:pe(x.fee_rate)})})]})},x.to_type)})})]},c))})]})]})},rr=({isOpen:t,onClose:p,data:s,fromCoin:r,toCoin:l,fromAmount:o,toAmount:i})=>{const{isApp:f}=fe(),{getTokenListInfo:c}=ge(),[x,b]=a.useState(new Map),j=async _=>{const R=await c(_);R&&(R==null?void 0:R.size)>0&&b(R)};Hs(()=>{var _,R;if(s!=null&&s.routers&&((_=s==null?void 0:s.routers)==null?void 0:_.length)>0){const H=[];(R=s==null?void 0:s.routers)==null||R.forEach(P=>{P.paths.forEach(T=>{H.includes(T.from_type)||H.push(T.from_type),H.includes(T.to_type)||H.push(T.to_type)})}),j(H)}},[s==null?void 0:s.routers]);const h=a.useMemo(()=>{var _,R;return!(s!=null&&s.routers)||((_=s==null?void 0:s.routers)==null?void 0:_.length)===0||(x==null?void 0:x.size)===0?[]:(R=s==null?void 0:s.routers)==null?void 0:R.map(H=>({...H,paths:H.paths.map(P=>({...P,fromToken:x==null?void 0:x.get(P.from_type),toToken:x==null?void 0:x.get(P.to_type)}))}))},[s==null?void 0:s.routers,x]),S={fromToken:r,toToken:l,fromAmount:o,toAmount:i,routes:h},[v,w]=a.useState(!0),g=a.useRef(null);return a.useEffect(()=>(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{w(!1)},200),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),e.jsxs(Es,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:p,isCentered:!0,children:[e.jsx(Ms,{}),e.jsxs(Us,{maxW:"1200px",w:f?"calc(100vw - 32px)":"880px",children:[e.jsx(Bs,{mr:"-10px",children:e.jsxs(u,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(d,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Route"}),e.jsxs(u,{gap:"0",align:"center",children:[e.jsx(Ze,{data:s}),e.jsx(Os,{mt:"0",position:"static"})]})]})}),e.jsx(Cs,{p:{base:"8px 16px",lg:"16px"},children:f?e.jsx(er,{...S,loading:v}):e.jsx(sr,{...S,loading:v})})]})]})};function Pr(t){const{formatSwapRouter:p,findRouterLoading:s,fromAmount:r,toAmount:l,fromCoin:o,toCoin:i,isSwapWidget:f=!1,handleSwapWidgetRouterClick:c}=t,[x,b]=a.useState(!1);return console.log(p,"formatSwapRouter"),e.jsxs(e.Fragment,{children:[e.jsxs(u,{w:"100%",justify:"space-between",p:"0 8px",children:[e.jsx(d,{fontSize:f?"12px":"14px",fontWeight:"500",whiteSpace:"nowrap",children:"Auto Router"}),e.jsx(I,{onClick:j=>{Ps(j),f?c&&c():b(!x)},cursor:"pointer",children:e.jsx(Ze,{data:p,loading:s,isSwapWidget:f,children:e.jsx(k,{xlinkHref:"#icon-icon_spread",fontSize:"16px"})})})]}),x&&!f&&e.jsx(rr,{isOpen:x,onClose:()=>b(!1),fromCoin:o,toCoin:i,data:p,fromAmount:r,toAmount:l})]})}function $r(t){const{lastRouterData:p,fromCoin:s,toCoin:r,onClose:l,data:o,onSubmitClick:i,isWidget:f}=t,{slippage:c}=Be(),x=a.useRef(!1),[b,j]=a.useState(o),{fromAmountUi:h,toAmountUi:S,byAmountIn:v}=b,{amountLimit:w}=qe(c,b),[g,_]=a.useState(!1),{priceImpactTextInfo:R,marketPrice:H,sources:P,showPriceImpactTips:T,showPriceImpactWarn:U}=Je(s,r,h,S),{priceAcceptRouterData:O}=Ns(b,p),[ee,le]=a.useState(!1),se=a.useMemo(()=>O!==void 0,[O]),m=a.useMemo(()=>v?r:s,[v]),re=()=>{if(O){if(x.current)return;x.current=!0;const te=Zs(O);j(te),setTimeout(()=>{x.current=!1},300)}},xe=a.useMemo(()=>g?!1:!!U,[g,U]);return e.jsxs(z,{textAlign:"center",p:"0px",w:"100%",children:[e.jsxs(z,{w:"100%",gap:"16px",pl:"16px",pr:"16px",pb:"16px",children:[e.jsx(Ys,{bg:f?"swap_bg_primary":"bg_primary",coinA:{amount:h||"0",...s},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:S||"0",...r}}),e.jsx(u,{w:"100%",minH:"48px",bg:f?"swap_bg_primary":"bg_primary",borderRadius:"8px",border:"1px solid",borderColor:"border",justifyContent:"center",zIndex:"100",children:e.jsx(be,{fromToken:s,toToken:r,fromValue:h,toValue:S,color:"text_caption"})}),T&&e.jsx(u,{zIndex:"99",w:"100%",mt:"-26px",bg:U?"primary_red_opacity.10":"primary_yellow_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"center",p:"18px 16px 10px",children:e.jsx(d,{color:U?"primary_red":"primary_yellow",fontSize:"12px",lineHeight:"20px",textAlign:"start",fontWeight:"500",children:"High price difference. Be cautious before submitting your order."})}),e.jsx(Me,{wrapStyle:{h:"20px",lineHeight:"20px"},label:"Slippage Tolerance",labelStyle:{fontSize:"14px"},value:`${Oe(c).mul(100)}%`,valueStyle:{fontSize:"14px"}}),e.jsx(Me,{wrapStyle:{h:"20px",lineHeight:"20px"},label:v?"Minimum Received":"Maximum Input",labelStyle:{fontSize:"14px"},value:`${$s(w||0,m==null?void 0:m.decimals,!1,Ts.ROUND_DOWN).toString()} ${m==null?void 0:m.symbol}`,valueStyle:{fontSize:"14px"}}),e.jsx(Xe,{fromToken:s,toToken:r,sources:P,marketPrice:H,priceImpact:R}),U&&e.jsxs(z,{w:"100%",gap:"8px",children:[e.jsx(u,{w:"100%",bg:"primary_red_opacity.10",borderRadius:"12px",border:"1px solid",borderColor:"border",justifyContent:"start",p:"10px 16px",children:e.jsx(d,{color:"primary_red",fontSize:"12px",lineHeight:"20px",textAlign:"start",children:"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?"})}),e.jsxs(u,{w:"100%",justifyContent:"space-between",gap:"16px",children:[e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:g?"text_highlight":"button_outline_border",onClick:()=>{_(!0)},children:"Yes, please continue."}),e.jsx(ce,{variant:"outline",w:"100%",color:"text_highlight",fontSize:"14px",borderColor:"button_outline_border",onClick:l,children:"No,cancel it."})]})]}),se&&e.jsxs(u,{w:"100%",justifyContent:"space-between",children:[e.jsxs(u,{children:[e.jsx(k,{xlinkHref:"#icon-icon_priceupdated1",svgW:"20px",svgH:"20px"}),e.jsx(d,{color:"text_caption",fontWeight:"500",fontSize:"14px",children:"Price updated"})]}),e.jsx(ce,{onClick:re,h:"40px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",p:"0 42px",children:"Accept"})]})]}),!se&&e.jsx(ce,{disabled:xe,isLoading:ee,mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{ee||(le(!0),i(b))},children:"Confirm Swap"})]})}export{er as H,Ze as O,Ir as P,Hr as S,zr as a,Pr as b,$r as c,Ar as u};
//# sourceMappingURL=SwapConfirmBlock-DvaxtX_K.js.map

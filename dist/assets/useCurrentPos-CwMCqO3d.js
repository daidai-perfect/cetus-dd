import{c as H,i as I,d as L}from"./usePositionList-CyCzZNts.js";import{U as h,aH as w}from"./index-D49RffYW.js";const A=(o,l)=>({isPosDetailRefresh:!1,setIsPosDetailRefresh:t=>{o(()=>({isPosDetailRefresh:t}))},isPosHistoryLoading:!0,setIsPosHistoryLoading:t=>{o(()=>({isPosHistoryLoading:t}))},curPosHistoryList:[],setCurPosHistoryList:t=>{o(()=>({curPosHistoryList:t}))},currentPosDetailTab:"increase",setCurrentPosDetailTab:t=>{o(()=>({currentPosDetailTab:t}))},tokenAmountA:"",setTokenAmountA:t=>{o(()=>({tokenAmountA:t}))},tokenAmountB:"",setTokenAmountB:t=>{o(()=>({tokenAmountB:t}))},isFixedDisplayTokenA:!0,setIsFixedDisplayTokenA:t=>{o(()=>({isFixedDisplayTokenA:t}))},slideValue:"--",setSlideValue:t=>{o(()=>({slideValue:t}))},currentPosPoolInfo:null,setCurrentPosPoolInfo:t=>{o(()=>({currentPosPoolInfo:t}))},currentPoolSqrtPrice:"",setCurrentPoolSqrtPrice:t=>{o(()=>({currentPoolSqrtPrice:t}))},curPosContractPoolInfo:null,setCurPosContractPoolInfo:t=>{o(()=>({curPosContractPoolInfo:t}))}}),D=h(A);function S(){const{clmmSdk:o}=w(),{posBaseList:l,setCurrentPosBaseInfo:t,setCurrentPosBaseInfoLoading:d}=H(),{setCurPosHistoryList:m,setIsPosHistoryLoading:P}=D(),{buildPosBaseInfo:C}=I(),{getPosRelatedData:p}=L(),g=async(i,s,e=!1)=>{d(!0);const a=l.find(r=>r.id===s);let n;a&&!e?n=a:n=await f(i,s),t(n),n&&p([n])},f=async(i,s)=>{const e=await o.fullClient.getOwnedObjectsByPage(i,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{ObjectId:s}});return e&&e.data&&e.data.length>0?C(e.data[0]):null},y=async(i,s)=>{var a;const e=["https://mainnet.suiet.app:443","https://rpc-mainnet.suiscan.xyz:443"];for(const n of e)try{const r=await o.Position.getPositionTransactionList({posId:i,fullRpcUrl:n,originPosId:s,order:"descending"});if(((a=r==null?void 0:r.data)==null?void 0:a.length)>0)return r.data}catch(r){console.error(`Error fetching data from ${n}:`,r)}return[]};return{getCurrentPosBaseInfo:g,getCurrentPosHistory:async(i,s)=>{P(!0);const e=await y(i,s),a=i.toLowerCase()!==s.toLowerCase()?await y(s,s):[],r=[...e,...a].sort((c,u)=>(u==null?void 0:u.timestampMs)-(c==null?void 0:c.timestampMs));m(r),P(!1)},getCurrentPosByPosId:f}}export{S as a,D as u};

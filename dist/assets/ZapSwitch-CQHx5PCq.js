import{a as g,j as o,V as oe,v as Ue,f as ve,H,T as U,u as je,S as st,ar as Ge,P as nt,h as ot,m as rt,n as it}from"./vendor-DsVemle5.js";import{u as Ee}from"./global-CXwwb5OW.js";import{ax as at,aJ as Le,aQ as ct,k as Xe,n as Fe,j as Ke,r as We,d as E,$ as Je,x as $e,az as De,A as he,a6 as Te,l as de,a as Qe,aR as Ye,I as ke,f as Me,c as lt,V as ut,ac as ze,aS as Pe,Y as dt,a2 as Ze,i as pt,aT as mt,B as xt}from"./index-DIvDX_Yh.js";import{v as Ne}from"./v4-C6aID195.js";import{D as ft}from"./DepositRatio-CYJIi_w0.js";import{F as gt}from"./FreshProgressV2-ZPylifaE.js";import{u as ht,M as bt}from"./usePriceImpact-DY73T9z-.js";import{d as yt,c as At,e as _t}from"./useGetPoolList-CqBccx4u.js";import{E as qe}from"./ErrorTips-BZCXKHj3.js";import{S as wt}from"./Slippage-DGLr6udB.js";import{c as Oe,u as St}from"./useNotifiSubscription-rM7Fm_-w.js";import{u as jt}from"./usePositionList-DMAeOMoO.js";import{u as et}from"./index-DnKQwi__.js";import{u as Rt}from"./useToken-YYj-bY2H.js";import{u as Tt}from"./useTokenBalance-Dt87YmUP.js";var vt=/\s/;function kt(t){for(var s=t.length;s--&&vt.test(t.charAt(s)););return s}var Zt=/^\s+/;function Bt(t){return t&&t.slice(0,kt(t)+1).replace(Zt,"")}var Ve=NaN,Lt=/^[-+]0x[0-9a-f]+$/i,Et=/^0b[01]+$/i,Ft=/^0o[0-7]+$/i,Wt=parseInt;function Ie(t){if(typeof t=="number")return t;if(at(t))return Ve;if(Le(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=Le(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=Bt(t);var e=Et.test(t);return e||Ft.test(t)?Wt(t.slice(2),e?2:8):Lt.test(t)?Ve:+t}var Be=function(){return ct.Date.now()},Ct="Expected a function",$t=Math.max,Dt=Math.min;function Mt(t,s,e){var p,l,x,a,n,A,_=0,$=!1,F=!1,S=!0;if(typeof t!="function")throw new TypeError(Ct);s=Ie(s)||0,Le(e)&&($=!!e.leading,F="maxWait"in e,x=F?$t(Ie(e.maxWait)||0,s):x,S="trailing"in e?!!e.trailing:S);function b(u){var V=p,M=l;return p=l=void 0,_=u,a=t.apply(M,V),a}function m(u){return _=u,n=setTimeout(k,s),$?b(u):a}function f(u){var V=u-A,M=u-_,ee=s-V;return F?Dt(ee,x-M):ee}function i(u){var V=u-A,M=u-_;return A===void 0||V>=s||V<0||F&&M>=x}function k(){var u=Be();if(i(u))return q(u);n=setTimeout(k,f(u))}function q(u){return n=void 0,S&&p?b(u):(p=l=void 0,a)}function j(){n!==void 0&&clearTimeout(n),_=0,p=A=l=n=void 0}function O(){return n===void 0?a:q(Be())}function Y(){var u=Be(),V=i(u);if(p=arguments,l=this,A=u,V){if(n===void 0)return m(A);if(F)return clearTimeout(n),n=setTimeout(k,s),b(A)}return n===void 0&&(n=setTimeout(k,s)),a}return Y.cancel=j,Y.flush=O,Y}const Nt=(t,s)=>({fromAmount:"",setFromAmount:e=>{t(()=>({fromAmount:e}))},fromAmountValue:"",setFromAmountValue:e=>{t(()=>({fromAmountValue:e}))},toAmount:"",setToAmount:e=>{t(()=>({toAmount:e}))},toAmountValue:"",setToAmountValue:e=>{t(()=>({toAmountValue:e}))},liquidityAmount:"",setLiquidityAmount:e=>{t(()=>({liquidityAmount:e}))},tokenMaxA:"",setTokenMaxA:e=>{t(()=>({tokenMaxA:e}))},tokenMaxB:"",setTokenMaxB:e=>{t(()=>({tokenMaxB:e}))},byAmountIn:!0,setByAmountIn:e=>{t(()=>({byAmountIn:e}))},isTokenA:!0,setIsTokenA:e=>{t(()=>({isTokenA:e}))},percentMap:{percentA:"0",percentB:"0"},setPercentMap:e=>{t(()=>({percentMap:e}))},isFullRange:!1,setIsFullRange:e=>{t(()=>({isFullRange:e}))},fromToken:void 0,setFromToken:e=>{t(()=>({fromToken:e}))},fromTokenLock:!1,setFromTokenLock:e=>{t(()=>({fromTokenLock:e}))},toToken:void 0,setToToken:e=>{t(()=>({toToken:e}))},toTokenLock:!1,setToTokenLock:e=>{t(()=>({toTokenLock:e}))},totalAmount:void 0,setTotalAmount:e=>{t(()=>({totalAmount:e}))},autoStakePosition:!1,setAutoStakePosition:e=>{t(()=>({autoStakePosition:e}))},isFarmRewardsRange:!1,setIsFarmRewardsRange:e=>{t(()=>({isFarmRewardsRange:e}))},useZapIn:!1,setUseZapIn:e=>{t(()=>({useZapIn:e}))},confirmModalOpen:!1,setConfirmModalOpen:e=>{t(()=>({confirmModalOpen:e}))},nftOpen:!1,setNftOpen:e=>{t(()=>({nftOpen:e}))},relatedPosId:"",setRelatedPosId:e=>{t(()=>({relatedPosId:e}))},resetAddLiquidity:()=>{t(()=>({isFarmRewardsRange:!1,autoStakePosition:!1,totalAmount:void 0,fromTokenLock:!1,fromToken:void 0,toTokenLock:!1,toToken:void 0,isFullRange:!1,percentMap:{percentA:"0",percentB:"0"},fromAmount:"",toAmount:"",fromAmountValue:"",toAmountValue:"",liquidityAmount:"",byAmountIn:!0,isTokenA:!0,useZapIn:!1,nftOpen:!1,relatedPosId:""}))}}),tt=Xe(Nt),qt=(t,s)=>({currentTokens:[],setCurrentTokens:e=>{t(()=>({currentTokens:e}))},zapAmount:"",setZapAmount:e=>{t(()=>({zapAmount:e}))},currentZapToken:void 0,setCurrentZapToken:e=>{t(()=>({currentZapToken:e}))},zapAmountRate:"",setZapAmountRate:e=>{t(()=>({zapAmountRate:e}))},zapTokenBalance:void 0,setZapTokenBalance:e=>{t(()=>({zapTokenBalance:e}))},isPreLoading:!1,setIsPreLoading:e=>{t(()=>({isPreLoading:e}))},preDepositeData:void 0,setPreDepositeData:e=>{t(()=>({preDepositeData:e,isPreLoading:!1}))},zapApiPool:void 0,setZapApiPool:e=>{t(()=>({zapApiPool:e}))},lower:0,setLower:e=>{t(()=>({lower:e}))},upper:0,setUpper:e=>{t(()=>({upper:e}))},liquidity:"",setLiquidity:e=>{t(()=>({liquidity:e}))},zapCurrPriceData:{},setZapCurrPriceData:e=>{t(()=>({zapCurrPriceData:e}))},zapSlideValue:0,setZapSlideValue:e=>{t(()=>({zapSlideValue:Number(e==="--"?0:e)}))},posOriginAmounts:{},setPosOriginAmounts:e=>{t(()=>({posOriginAmounts:e}))},resetZapData:()=>{t(()=>({zapAmount:"",zapAmountRate:"",lower:0,upper:0,preDepositeData:void 0,isPreLoading:!1,liquidity:"",zapSlideValue:0,posOriginAmounts:{}}))}}),Ce=Xe(qt);function Ot(t="Deposit"){var Ae,_e;const{zapAmount:s,currentZapToken:e,zapAmountRate:p,zapTokenBalance:l,isPreLoading:x,preDepositeData:a,zapApiPool:n,setIsPreLoading:A,lower:_,upper:$,liquidity:F,zapCurrPriceData:S,setPreDepositeData:b,zapSlideValue:m}=Ce();console.log("ðŸš€ ~ useZapSubmit ~ zapCurrPriceData:",S);const{currentAccount:f,onWalletModal:i}=Fe(),{setConfirmModalOpen:k}=tt(),{zapSdk:q}=Ke(),{zapSlippage:j,slippage:O}=Ee(),[Y,u]=g.useState(""),[V,M]=g.useState(!1),{getTokenPrice:ee}=We(),G=ee((Ae=n==null?void 0:n.tokenA)==null?void 0:Ae.coin_type),h=ee((_e=n==null?void 0:n.tokenB)==null?void 0:_e.coin_type),be=g.useMemo(()=>{if(G&&h)return E(G.price).div(h.price).toString()},[G==null?void 0:G.price,h==null?void 0:h.price]),ye=g.useMemo(()=>{const c={text:t==="Withdraw"?"Zap Out":"Zap In",disabled:!1};return f!=null&&f.address?!s||s&&!+s?(c.text="Enter an amount",c.disabled=!0,c):E(s).gt((l==null?void 0:l.balanceFormat)||0)?(c.disabled=!0,c.text=`Insufficient ${Je(l==null?void 0:l.symbol,10)} Balance`,c):((E(p).gt(1e4)||E(p).gt(0)&&E(p).lt(1e-4))&&(c.disabled=!0),c):(c.text="Connect Wallet",c.disabled=!1,c)},[f==null?void 0:f.address,s,e==null?void 0:e.coin_type,x,t,l==null?void 0:l.balanceFormat]),te=Mt(()=>{f?k(!0):i(!0)},300,{leading:!0,trailing:!1}),W=()=>{const c=a==null?void 0:a.amount_a,d=a==null?void 0:a.amount_b,r=n==null?void 0:n.tokenA,y=n==null?void 0:n.tokenB,X=n==null?void 0:n.displayTokenA,I=n==null?void 0:n.displayTokenB,C=de(n!=null&&n.isReverse?d:c,n!=null&&n.isReverse?y==null?void 0:y.decimals:r==null?void 0:r.decimals),N=de(n!=null&&n.isReverse?c:d,n!=null&&n.isReverse?r==null?void 0:r.decimals:y==null?void 0:y.decimals);return{amountA:c,amountB:d,tokenA:r,tokenB:y,displayTokenA:X,displayTokenB:I,dispalyAmountA:C,dispalyAmountB:N}},ae=()=>{const{displayTokenA:c,displayTokenB:d,dispalyAmountA:r,dispalyAmountB:y}=W();return{getShowInfo:(I,C)=>{const N=!r&&!y?`Add ${r} ${c==null?void 0:c.symbol} and ${y} ${d==null?void 0:d.symbol}`:r?y?"Add Liquidity":`Add ${y} ${d==null?void 0:d.symbol}`:`Add ${r} ${c==null?void 0:c.symbol}`,D={modalDescriptionText:N,toastTitleText:N};if(I==="success"){let Q=r,K=y;C&&(Q=Te(C,c)||r,K=Te(C,d)||y);const P=!r&&!y?`Add ${Q} ${c==null?void 0:c.symbol} and ${K} ${d==null?void 0:d.symbol}`:!r&&y?`Add ${Q} ${c==null?void 0:c.symbol}`:!y&&r?`Add ${K} ${d==null?void 0:d.symbol}`:"Add Liquidity";D.toastDescriptionContent=P,D.modalDescriptionText=P,D.toastTitleText="Supplied Successful"}return D}}},Z=async(c,d,r,y)=>{console.log("ðŸš€ ~ getZapDepositTx ~ isFarm:",r);const{tokenA:X,tokenB:I}=W(),C={deposit_obj:a,pool_id:n==null?void 0:n.poolAddress,coin_type_a:X==null?void 0:X.coin_type,coin_type_b:I==null?void 0:I.coin_type,tick_lower:c,tick_upper:d,slippage:Number(O),swap_slippage:Number(j)};y&&(C.pos_obj=y),r&&(C.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("getZapTx buildDepositPayload params: ",C);const N=await q.Zap.buildDepositPayload(C);return console.log("ðŸš€ ~ getZapTx ~ tx:",N),N},T=(c,d)=>{const{displayTokenA:r,displayTokenB:y,dispalyAmountA:X,dispalyAmountB:I}=W();return{getShowInfo:(N,D)=>{const Q=`Withdraw ${he(s,e==null?void 0:e.decimals)} ${e==null?void 0:e.symbol}`,K={modalDescriptionText:Q,toastTitleText:Q};return N==="success"&&(D&&(Te(D,r),Te(D,y)),K.toastDescriptionContent="",K.modalDescriptionText="",K.toastTitleText="Remove Liquidity Successful"),K}}},pe=async(c,d,r,y,X,I)=>{console.log("ðŸš€ ~ getZapWithdrawTx ~ isFarm:",I),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx preDepositeData:",a);const{tokenA:C,tokenB:N}=W(),D={withdraw_obj:a,pool_id:n==null?void 0:n.poolAddress,pos_id:c,close_pos:(a==null?void 0:a.burn_liquidity)===d,collect_fee:!0,collect_rewarder_types:X,coin_type_a:C==null?void 0:C.coin_type,coin_type_b:N==null?void 0:N.coin_type,tick_lower:r,tick_upper:y,slippage:Number(O),swap_slippage:Number(j)};return I&&(D.farms_pool_id=n==null?void 0:n.farmsPoolAddress),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx params:",D),await q.Zap.buildWithdrawPayload(D)},z=g.useRef({}),me=g.useRef(null),J=g.useRef("");g.useEffect(()=>{z.current={currentZapToken:e,zapApiPool:n,zapAmount:s,currentSqrtPrice:S==null?void 0:S.currentSqrtPrice,lower:_,upper:$,liquidity:F,zapSlippage:j,zapAmountRate:p,marketPrice:be}},[e==null?void 0:e.coin_type,n==null?void 0:n.poolAddress,s,S==null?void 0:S.currentSqrtPrice,_,$,F,j,p,be]);const xe=g.useMemo(()=>!!(e!=null&&e.decimals&&E(s).mul(Math.pow(10,e==null?void 0:e.decimals)).eq(1)),[e==null?void 0:e.decimals,s]),L=async c=>{var w,B,R,v,ne;console.log("ðŸš€ ~ preZapIn ~ preZapIn:",L);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:I,upper:C,liquidity:N,zapSlippage:D,marketPrice:Q}=z.current;A(!0);const P=(d==null?void 0:d.coin_type)===((w=r==null?void 0:r.tokenA)==null?void 0:w.coin_type)?"OnlyCoinA":"OnlyCoinB",fe=De(E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString(),0);console.log("ðŸš€ ~ preZapIn ~ options.zapSlippage:",O,D);const ge={pool_id:r==null?void 0:r.poolAddress,tick_lower:I,tick_upper:C,current_sqrt_price:X,slippage:Number(O),swap_slippage:Number(D),mark_price:Q};console.log("ðŸš€ ~ preZapIn ~ options123:",ge);const ue={mode:P,coin_amount:fe,coin_type_a:(B=r==null?void 0:r.tokenA)==null?void 0:B.coin_type,coin_type_b:(R=r==null?void 0:r.tokenB)==null?void 0:R.coin_type,coin_decimal_a:(v=r==null?void 0:r.tokenA)==null?void 0:v.decimals,coin_decimal_b:(ne=r==null?void 0:r.tokenB)==null?void 0:ne.decimals,max_remain_rate:.01};console.log("ðŸš€ ~ preZapIn ~ modeOptions:",ue);let se;try{se=await q.Zap.preCalculateDepositAmount(ge,ue),console.log("ðŸš€ ~ preZapIn ~ res:",se)}catch(re){console.log("ðŸš€ ~ preZapIn ~ error:",re),M(!0)}c===J.current&&b(se),A(!1)},ce=async c=>{var ge,ue,se,w,B;A(!0);const{currentZapToken:d,zapApiPool:r,zapAmount:y,currentSqrtPrice:X,lower:I,upper:C,liquidity:N,zapSlippage:D}=z.current,K=(d==null?void 0:d.coin_type)===((ge=r==null?void 0:r.tokenA)==null?void 0:ge.coin_type)?"OnlyCoinA":"OnlyCoinB";E(y).mul(Math.pow(10,d==null?void 0:d.decimals)).toString();const P={mode:K,pool_id:r==null?void 0:r.poolAddress,tick_lower:I,tick_upper:C,current_sqrt_price:X,coin_type_a:(ue=r==null?void 0:r.tokenA)==null?void 0:ue.coin_type,coin_type_b:(se=r==null?void 0:r.tokenB)==null?void 0:se.coin_type,coin_decimal_a:(w=r==null?void 0:r.tokenA)==null?void 0:w.decimals,coin_decimal_b:(B=r==null?void 0:r.tokenB)==null?void 0:B.decimals};E(y).gte(l==null?void 0:l.balanceFormat)?P.burn_liquidity=N:P.burn_liquidity=De(E(N).mul(E(m).div(100)).toString(),0),console.log("ðŸš€ ~ preZapInRemove ~ options:",P);let fe;try{fe=await q.Zap.preCalculateWithdrawAmount(P),console.log("ðŸš€ ~ preZapInRemove ~ res:",fe)}catch(R){console.log("ðŸš€ ~ preZapOut ~ error:",R),M(!0)}c===J.current&&b(fe),A(!1)},we=$e(L,300),Se=$e(ce,300);g.useEffect(()=>{Re()},[s,e==null?void 0:e.coin_type,S==null?void 0:S.currentSqrtPrice,_,$,m,p]);const le=()=>{var c;(c=me.current)==null||c.reset()},Re=()=>{M(!1);const{zapAmount:c,zapAmountRate:d}=z.current;if(console.log("ðŸš€ ~ reCalculateZapData ~ zapAmount:",c),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",d),!Number(c)||E(d).gt(1e4)||E(d).lt(1e-4)||xe){const y=Ne();J.current=y,b(void 0),A(!1);return}A(!0);const r=Ne();J.current=r,t=="Deposit"?we(r):Se(r)};return g.useEffect(()=>{le()},[s,n==null?void 0:n.poolAddress,t]),g.useEffect(()=>()=>{le(),z.current=null},[]),{btnText:ye.text,btnDisabled:ye.disabled,handleZapIn:te,isPreLoading:x,getZapDepositToastInfo:ae,getZapDepositTx:Z,getZapWithdrawToastInfo:T,getZapWithdrawTx:pe,zapProgressRef:me,handleResetZapProgress:le,reCalculateZapData:Re,isMinimumPrecision:xe,zapNotAvailable:V}}function as({action:t,onClick:s,hideAmountInfo:e,otherLoading:p,isReverse:l,inConfirmModal:x,hideDepositRatio:a}){const{currentAccount:n,onWalletModal:A}=Fe(),{btnDisabled:_,btnText:$,handleZapIn:F,zapProgressRef:S,reCalculateZapData:b,isMinimumPrecision:m,zapNotAvailable:f}=Ot(t),i=()=>{if(!n){A(!0);return}s?s():F()},[k,q]=g.useState(!1),{zapSlippage:j}=Ee(),{getTokenAmountValue:O}=We(),{zapSlideValue:Y,preDepositeData:u,currentTokens:V,currentZapToken:M,zapAmount:ee,isPreLoading:G,zapApiPool:h,lower:be,upper:ye,zapCurrPriceData:te,posOriginAmounts:W,zapAmountRate:ae}=Ce(),{fromCoin:Z,toCoin:T}=g.useMemo(()=>{var R;const w=M,B=(R=V==null?void 0:V.filter(v=>(v==null?void 0:v.coin_type)!==(M==null?void 0:M.coin_type)))==null?void 0:R[0];return t==="Withdraw"?{fromCoin:B,toCoin:w}:{fromCoin:w,toCoin:B}},[M==null?void 0:M.coin_type,V,t]),{fromAmount:pe,toAmount:z}=g.useMemo(()=>{var R,v;let w,B;return u&&(Z!=null&&Z.coin_type)&&(T!=null&&T.coin_type)&&(w=de((R=u==null?void 0:u.swap_result)==null?void 0:R.swap_in_amount,Z==null?void 0:Z.decimals),B=de((v=u==null?void 0:u.swap_result)==null?void 0:v.swap_out_amount,T==null?void 0:T.decimals)),{fromAmount:w,toAmount:B}},[u,Z==null?void 0:Z.coin_type,T==null?void 0:T.coin_type]),{sources:me,priceImpactTextInfo:J,showPriceImpactTips:xe}=ht(Z,T,pe,z),[L,ce]=g.useState(!1),we=()=>{ce(!L)},Se=g.useMemo(()=>z?he(E(z).sub(E(z).mul(j)).toString()):"--",[j,z]),le=g.useMemo(()=>{var w;return(w=u==null?void 0:u.swap_result)==null?void 0:w.swap_price},[u]),Re=()=>{console.log("ZapRoute handleRefresh"),b()},{tokenA:Ae,tokenB:_e,coinAmountA:c,coinAmountB:d,displayCoinAmountA:r,displayCoinAmountB:y,displayTokenA:X,displayTokenB:I,displayAmountARate:C,displayAmountBRate:N,amountARate:D,amountBRate:Q}=g.useMemo(()=>{let w,B,R,v,ne,re;const ie=h==null?void 0:h.isReverse;return u&&(h!=null&&h.poolAddress)&&(R=h==null?void 0:h.tokenA,v=h==null?void 0:h.tokenB,w=de(u==null?void 0:u.amount_a,R==null?void 0:R.decimals),B=de(u==null?void 0:u.amount_b,v==null?void 0:v.decimals),ne=O(R==null?void 0:R.coin_type,w),re=O(v==null?void 0:v.coin_type,B)),{displayCoinAmountA:ie?B:w,displayCoinAmountB:ie?w:B,displayTokenA:ie?v:R,displayTokenB:ie?R:v,displayAmountARate:ie?re:ne,displayAmountBRate:ie?ne:re,tokenA:R,tokenB:v,coinAmountA:w,coinAmountB:B,amountARate:ne,amountBRate:re}},[u,h==null?void 0:h.poolAddress]),{originPosAmountA:K,originPosAmountB:P}=g.useMemo(()=>{let w="",B="";if(h!=null&&h.poolAddress&&(W!=null&&W.coinAmountA||W!=null&&W.coinAmountB)){const R=h==null?void 0:h.tokenA,v=h==null?void 0:h.tokenB,ne=h==null?void 0:h.isReverse,re=de(W==null?void 0:W.coinAmountA,R==null?void 0:R.decimals),ie=de(W==null?void 0:W.coinAmountB,v==null?void 0:v.decimals);w=ne?ie:re,B=ne?re:ie}return{originPosAmountA:w,originPosAmountB:B}},[W,h==null?void 0:h.poolAddress]),[fe,ge]=g.useState({});g.useEffect(()=>{if(c||d){const w=yt(be,ye),B=At(c||0,d||0,te==null?void 0:te.currentPrice,w);ge(B)}},[c,d,te==null?void 0:te.currentPrice]);const{isApp:ue}=Qe(),se=g.useMemo(()=>E(ae).gt(1e4)?"In Zap mode, each request should be within $10,000.":E(ae).gt(0)&&(E(ae).lt(1e-4)||m)?"The input is too small. Zap mode is not available.":f?"Zap mode is not available.":"",[ae,t,m,f]);return o.jsx(o.Fragment,{children:o.jsxs(oe,{gap:"0px",w:"100%",borderRadius:"16px",border:"1px solid",borderColor:x?"rgba(0,0,0,0)":"border",bg:x?"none":"bg_six",p:{base:x?"0px":"0px 8px",lg:x?"0px":"0px 16px"},children:[!x&&o.jsx(Ue,{w:{base:"calc(100% + 16px)",lg:"calc(100% + 34px)"},h:"52px",margin:"-1px -1px 0px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:(G||_||p||xe||!!se)&&(n==null?void 0:n.address),isLoading:G||p,onClick:i,children:$}),!!Number(ee)&&o.jsx(oe,{w:"100%",gap:"0px",children:se?o.jsx(ve,{w:"100%",p:"12px 0px",children:o.jsx(qe,{tips:se})}):o.jsxs(o.Fragment,{children:[xe&&o.jsx(ve,{w:"100%",pt:"12px",children:o.jsx(qe,{tips:"High price difference. Be cautious before submitting your order."})}),x&&o.jsxs(H,{w:"100%",justify:"space-between",children:[o.jsx(U,{fontSize:"14px",color:"text_paragraph",children:"Zap Amount"}),o.jsx(U,{fontSize:"14px",color:"text_caption",children:Ye(ae,2)})]}),Number(ee)>0&&Number(pe)>0&&o.jsxs(oe,{w:"100%",gap:"12px",pt:"16px",pb:x?"0px":"16px",children:[o.jsx(H,{w:"100%",justify:"space-between",children:o.jsx(U,{fontSize:"14px",color:"text_paragraph",children:"Zap Route"})}),o.jsxs(oe,{w:"100%",bg:x?"bg_secondary":"none",borderRadius:"12px",p:x?"0px 12px":"0px",gap:x?"4px":"12px",border:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",flexDirection:t==="Withdraw"?"column-reverse":"column",children:[o.jsxs(oe,{w:"100%",align:"flex-start",bg:x?"none":"button_outline_hov_bg",p:x?"16px 0px":"16px 12px",borderRadius:x?"0px":"12px",borderBottom:"1px solid",borderColor:x?"border":"rgba(0,0,0,0)",children:[o.jsx(H,{w:"100%",align:"center",children:o.jsxs(oe,{w:"100%",align:"flex-start",onClick:()=>{q(!k)},children:[o.jsx(H,{w:"100%",justify:"flex-start",children:G?o.jsx(je,{w:"100%",h:"16px"}):o.jsxs(U,{w:"100%",fontSize:"12px",color:"text_caption",textAlign:"left",children:["Swap ",he(pe)," ",Z==null?void 0:Z.symbol," for ",Se," ",T==null?void 0:T.symbol]})}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(H,{w:"100%",justify:"space-between",align:{base:"flex-start",lg:"center"},flexDirection:{base:"column",lg:"row"},children:[o.jsxs(H,{gap:"4px",justify:"space-between",w:{base:"100%",lg:"unset"},children:[o.jsxs(H,{gap:"4px",children:[o.jsx(gt,{callbackInterval:20,ref:S,min:0,max:20,size:"14px",noBg:!0,thickness:"16px",onClick:Re}),o.jsxs(H,{flexWrap:"wrap",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Price Difference"}),o.jsx(U,{color:J==null?void 0:J.textColor,fontSize:"12px",children:J==null?void 0:J.priceImpactText}),me==null?void 0:me.map(w=>o.jsx(bt,{market:w},w))]})]}),ue&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:k?"rotate(180deg)":"rotate(0deg)"})]}),o.jsxs(H,{align:"center",gap:"2px",children:[x?o.jsxs(H,{gap:"4px",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Slippage"}),o.jsxs(U,{fontSize:"12px",color:"text_caption",children:[E(j).mul(100).toString(),"%"]})]}):o.jsx(wt,{slippageType:"zap",toolTipText:"Slippage Tolerance"}),!ue&&o.jsx(ke,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:k?"rotate(180deg)":"rotate(0deg)"})]})]})]})}),k&&o.jsxs(H,{w:"100%",justify:"space-between",bg:"bg_fifth",h:"52px",borderRadius:"12px",p:"0px 8px",children:[o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:"Swap Rate"}),G?o.jsx(je,{w:"150px",h:"16px"}):o.jsxs(H,{children:[L?o.jsxs(U,{fontSize:"12px",color:"text_caption",children:["1 ",T==null?void 0:T.symbol," = ",Me(1/le)," ",Z==null?void 0:Z.symbol]}):o.jsxs(U,{fontSize:"12px",color:"text_caption",children:["1 ",Z==null?void 0:Z.symbol," = ",Me(le)," ",T==null?void 0:T.symbol]}),o.jsx(ke,{xlinkHref:"#icon-icon_swap1",svgW:"16px",svgH:"16px",onClick:we})]})]})]}),o.jsxs(oe,{w:"100%",p:x?"16px 0px":"16px 12px",bg:x?"none":"button_outline_hov_bg",borderRadius:"12px",gap:"12px",children:[a?o.jsx(U,{w:"100%",textAlign:"left",fontSize:"12px",color:"text_caption",children:t==="Withdraw"?"Expected Amounts of Remove":"Expected Amounts to Add"}):o.jsx(ft,{tokenA:Ae,tokenB:_e,percentMap:fe,type:"zap",isLoading:G,isReverse:l,label:"Expected Amounts to Add"}),o.jsxs(H,{bg:"text_highlight_opacity.10",w:"100%",h:"52px",justify:"space-between",align:"center",borderRadius:"12px",children:[o.jsx(He,{token:l?_e:Ae,amount:l?he(Y==100?P:d):he(Y==100?K:c),rate:l?Q:D,loading:G}),o.jsx(ve,{bg:"bg_fifth",w:"1px",h:"100%"}),o.jsx(He,{token:l?Ae:_e,amount:l?he(Y==100?K:c):he(Y==100?P:d),loading:G,rate:l?D:Q,align:"right"})]})]})]})]})]})})]})})}function He({token:t,amount:s,rate:e,loading:p,align:l="left"}){return o.jsxs(H,{flex:"1",gap:"8px",p:"12px",justify:"flex-start",flexDirection:l==="left"?"row":"row-reverse",children:[p?o.jsx(st,{size:"20px"}):o.jsx(lt,{imageUrl:t==null?void 0:t.logo_url,w:"20px",h:"20px"}),o.jsxs(oe,{align:`flex-${l==="left"?"start":"end"}`,gap:"4px",children:[p?o.jsx(je,{w:"50px",h:"14px"}):o.jsxs(U,{fontSize:"12px",color:"text_caption",textAlign:`${l==="left"?"left":"right"}`,children:[s," ",Je(t==null?void 0:t.symbol,10)]}),p?o.jsx(je,{w:{base:"70px",lg:"100px"},h:"12px"}):o.jsx(U,{fontSize:"12px",color:"text_paragraph",children:Ye(e,2)})]})]})}const Vt="/assets/bg_alerts@2x-BsIoiXpE.png";function cs({subscriptionSource:t,title:s="Range Alerts",description:e="Receive alerts via Telegram, SMS, or email when this position goes out of range.",wrapStyle:p={}}){const{getPositionNotifiStatus:l}=Oe(),{isChecked:x,setIsChecked:a,notifiAuthenticated:n,notifiSourceGroups:A,setIsShowNotifi:_,notifiSubscriptionLoading:$,notifiStatus:F,notifiSources:S}=ut(),{currentAccount:b}=Fe(),{notifiUnSubscription:m,notifiSubscription:f}=St(),{currentPosBaseInfo:i}=jt();console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:29 ~ currentPosBaseInfo:",i),g.useEffect(()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: RangeAlerts.tsx:42 ~ notifiSubscriptionLoading:",$),b!=null&&b.address&&t=="PositionDetail"&&i&&F=="authenticated"&&!$){const{isSubscription:j}=l(i.posId,String(i.index));a(j)}},[b,t,i,n,A,$,S]);const{createNotifiSubscriptionVerify:k}=Oe(),q=async j=>{if(a(j),console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:46 ~ changeSwitch ~ checked:",j),j){const O=await k();if(console.log("ðŸš€ðŸš€ðŸš€ ~ RangeAlerts.tsx:49 ~ changeSwitch ~ canSubscription:",O),!O)return a(!1),!1}if(t=="AddLiquidity")a(j);else if(t=="PositionDetail")if(console.log("ðŸš€ðŸš€ðŸš€ ~ changeSwitch ~ checked:",j),j){const O={subscriptionSource:"PositionDetail",position:i==null?void 0:i.posId,pool:i==null?void 0:i.clmmPool,posIndex:String(i==null?void 0:i.index)};f(O)}else m(i==null?void 0:i.posId,i==null?void 0:i.clmmPool,i==null?void 0:i.index)};return g.useEffect(()=>()=>{a(!1)},[]),o.jsx(H,{w:"100%",bgImage:Vt,bgSize:"100% 100%",p:"16px",borderRadius:"8px",...p,children:o.jsxs(oe,{w:"100%",gap:"8px",children:[o.jsxs(H,{w:"100%",justify:"space-between",children:[o.jsx(U,{color:"primary",children:s}),F=="authenticated"?o.jsx(Ge,{isChecked:x,disabled:$,onChange:j=>q(j.target.checked)}):o.jsx(Ue,{w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",onClick:()=>_(!0),children:"Set up"})]}),o.jsx(U,{color:"primary_gray",lineHeight:"20px",textAlign:"left",children:e})]})})}function It(){const{setCurrentPriceData:t}=et();return{getCurrentPrice:(e,p)=>{if(p.tokenA&&p.tokenB){const l=p.tokenA.decimals,x=p.tokenB.decimals,a=ze.sqrtPriceX64ToPrice(new Pe(e),l,x).toString(),n=E(1).div(a).toString(),A={currentPrice:a,reverseCurrentPrice:n,currentSqrtPrice:e,pool:p.poolAddress};t(A)}}}}function ls(){const{clmmSdk:t}=dt(),{getTokenListInfo:s}=Rt(),{contractPoolInfo:e,setContractPoolInfo:p,setContractPoolInfoLoading:l,apiPoolInfo:x,setApiPoolInfo:a,setApiPoolInfoLoading:n}=et(),{setFromToken:A,setToToken:_}=tt(),{getCurrentPrice:$}=It(),F=async b=>{l(!0);let m=null;try{if(m=await t.Pool.getPool(b),console.log(b,m,"poolAddress"),console.log("ðŸš€ ~ getContractPoolInfo ~ poolInfo:",{poolInfo:m,apiPoolInfo:x}),(x==null?void 0:x.displayTokenA)===void 0){const f=await S(m);f&&(a(f),n(!1),$(m==null?void 0:m.current_sqrt_price,f),A(f==null?void 0:f.displayTokenA),_(f==null?void 0:f.displayTokenB))}}catch(f){console.log("getContractPoolInfo ~ error:",f)}finally{l(!1)}return e?m?(p(m),m):e:(p(m||null),m)};async function S(b){const m=[b.coinTypeA,b.coinTypeB].filter(Boolean),f=await s(m),i=f==null?void 0:f.get(b.coinTypeA),k=f==null?void 0:f.get(b.coinType);if(i&&k){const q=`${i==null?void 0:i.symbol} - ${k==null?void 0:k.symbol}`,j=Ze(b.fee_rate).div(100).toString(),O=Ze(b.fee_rate).div(1e4).toString(),Y=Ze(j).div(100).toString()+"%",u=!_t(b.coinTypeA,b.coinTypeB);return{poolAddress:b.poolAddress,name:q,isReverse:u,tokenA:i,tokenB:k,displayTokenA:u?k:i,displayTokenB:u?i:k,haveMining:!1,miningRewardList:null,miningAprList:null,haveFarming:!1,farmsRewarderList:null,farmsApr:"",farmingAprDisplay:"",feeApr:"",feeAprDisplay:"",miningAprTotal:"",feeAndMiningAprDisplay:"",totalAprDisplay:"",fee:O,feeRate:j,feeDisplay:Y,tvlDisplay:"0",volume24Display:"0",fees24Display:"0",isVaults:!1,tickSpacing:b.tickSpacing.toString()}}}return{getContractPoolInfo:F}}function Ht({tokens:t,current:s,onSelect:e}){const p=g.useMemo(()=>t==null?void 0:t.map(a=>({label:a==null?void 0:a.symbol,value:a==null?void 0:a.coin_type})),[t]),l=g.useMemo(()=>{var a;return(a=p==null?void 0:p.filter(n=>(n==null?void 0:n.value)===(s==null?void 0:s.coin_type)))==null?void 0:a[0]},[p,s==null?void 0:s.coin_type]),x=a=>{var A;const n=(A=t==null?void 0:t.filter(_=>(_==null?void 0:_.coin_type)===(a==null?void 0:a.value)))==null?void 0:A[0];e(n)};return o.jsx(ve,{w:"100%",mb:"8px",children:o.jsx(pt,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:l==null?void 0:l.label,tabList:p,handleChangeTab:x})})}function Ut(t,s,e,p,l,x,a,n,A,_){const{currentTokens:$,setCurrentTokens:F,zapAmount:S,setZapAmount:b,currentZapToken:m,setCurrentZapToken:f,zapAmountRate:i,setZapAmountRate:k,setZapTokenBalance:q,zapTokenBalance:j,setPreDepositeData:O,setIsPreLoading:Y,setZapApiPool:u,lower:V,upper:M,setLower:ee,setUpper:G,setZapCurrPriceData:h,resetZapData:be,setLiquidity:ye,setZapSlideValue:te,setPosOriginAmounts:W}=Ce(),{zapSdk:ae}=Ke(),{zapSlippage:Z}=Ee(),{balanceInfo:T}=Tt(m),{getTokenAmountValue:pe}=We(),[z,me]=g.useState("");g.useEffect(()=>{ee(p)},[p]),g.useEffect(()=>{G(l)},[l]),g.useEffect(()=>{ye(n||"")},[n]),g.useEffect(()=>{te(A||0)},[A]),g.useEffect(()=>{W({coinAmountA:_==null?void 0:_.coinAmountA,coinAmountB:_==null?void 0:_.coinAmountB})},[_]),g.useEffect(()=>{var L,ce;if(s!=null&&s.poolAddress&&e){const we=(L=s==null?void 0:s.tokenA)==null?void 0:L.decimals,Se=(ce=s==null?void 0:s.tokenB)==null?void 0:ce.decimals,le=ze.sqrtPriceX64ToPrice(new Pe(e),we,Se).toString();h({currentPrice:le,currentSqrtPrice:e})}},[e,s==null?void 0:s.poolAddress]),g.useEffect(()=>{let L=[];s!=null&&s.poolAddress&&(L=[s==null?void 0:s.displayTokenA,s==null?void 0:s.displayTokenB],f(s==null?void 0:s.displayTokenA)),F(L),u(s)},[s==null?void 0:s.poolAddress]);const J=L=>{b(L)},xe=L=>{f(L),b("")};return g.useEffect(()=>{let L;S&&(m!=null&&m.coin_type)&&(L=pe(m==null?void 0:m.coin_type,S)),k(L||"")},[S,m==null?void 0:m.coin_type]),g.useEffect(()=>{var L;if(t==="Deposit")q(T);else{const ce=(m==null?void 0:m.coin_type)===((L=s==null?void 0:s.tokenA)==null?void 0:L.coin_type);q(ce?{balanceFormat:x}:{balanceFormat:a})}},[t,T,x,a,m==null?void 0:m.coin_type,s==null?void 0:s.poolAddress]),g.useEffect(()=>()=>{be()},[]),{currentTokens:$,zapAmount:S,zapAmountRate:i,handleChangeAmount:J,currentZapToken:m,handleChangeZapToken:xe,zapTokenBalance:j,zapSlippage:Z}}function us({action:t,apiPoolInfo:s,currentSqrtPrice:e,lowerTick:p,upperTick:l,onlyAmountA:x,onlyAmountB:a,liquidity:n,slideValue:A,currentPosLiquidityData:_}){const{currentTokens:$,currentZapToken:F,handleChangeZapToken:S,zapAmount:b,zapAmountRate:m,handleChangeAmount:f,zapTokenBalance:i}=Ut(t,s,e,p,l,x,a,n,A,_);return g.useEffect(()=>{t==="Withdraw"&&E(b).gt((i==null?void 0:i.balanceFormat)||"0")&&f(i==null?void 0:i.balanceFormat)},[b,t,i==null?void 0:i.balanceFormat]),o.jsxs(oe,{w:"100%",children:[o.jsx(Ht,{tokens:$,current:F,onSelect:S}),o.jsx(mt,{wrapStyle:{h:"108px"},placeholder:"0.0",value:b,onChange:f,balance:(i==null?void 0:i.balanceFormat)||"",amountValue:m,token:F,needRemainBalance:t!=="Withdraw",balanceLabel:t==="Withdraw"?"Available":void 0})]})}function ds(t){const{value:s,action:e,onChange:p}=t,{isApp:l}=Qe();return o.jsx(xt,{padding:"6px 8px",borderRadius:"8px",width:"unset",children:o.jsxs(nt,{isLazy:!0,trigger:l?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[o.jsx(ot,{children:o.jsxs(H,{h:"14px",cursor:"pointer",children:[o.jsxs(U,{whiteSpace:"nowrap",fontSize:"14px",color:s?"primary":"",fontWeight:"500",children:["Zap ",e==="Deposit"?"In":"Out"]}),o.jsx(Ge,{isChecked:s,onChange:()=>{p()}})]})}),o.jsx(rt,{children:o.jsx(it,{p:"12px",lineHeight:"20px",fontSize:"12px",children:e=="Deposit"?"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ":"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."})})]})})}export{cs as R,as as Z,ls as a,It as b,Ot as c,Mt as d,Ce as e,ds as f,us as g,tt as u};
//# sourceMappingURL=ZapSwitch-CQHx5PCq.js.map

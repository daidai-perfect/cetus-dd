import{a as p,x as Ye,j as e,V as R,F as Je,a9 as ze,H as T,T as h,C as I,p as ae,q,f as K,W as Ze,X as et,Y as tt,Z as st,$ as nt,a0 as ot,aa as Be,I as it,N as jt,az as mt,O as bt,Q as yt,aq as Ne,af as wt}from"./vendor-BFGDaAdA.js";import{u as at}from"./global-jK9B4_lU.js";import{k as X,C as ce,I as N,O as Z,aD as Ct,j as me,a as Q,n as ke,o as ue,a1 as _t,d as F,s as St,e as fe,f as J,G as oe,B as te,h as lt,r as Xe,aE as Te,F as vt,Q as rt,M as pe,q as Tt,V as kt,c as ct,aj as Pt,v as ee,ao as ne,an as je,l as re,aF as Lt,aG as $e,p as ve,aH as At,aI as Ot,ai as Rt,aJ as Dt,Z as Ht,aK as Ft,aL as Ge,aM as qe}from"./index-ChSVVHaJ.js";import{N as se}from"./NoData-DtiZhmrM.js";import{u as zt,A as Bt,R as Et}from"./RecentTransactions-B9-HhCtc.js";import{A as Vt}from"./AccountSwitchDrawer-Duc_CeBW.js";import{a as be,u as Ee,e as Ve,i as Ut,j as Mt,f as Wt,c as Nt,k as Xt}from"./VaultsAprBlock-9w_uOtsw.js";import{a as xe,d as $t,u as Gt,e as qt,f as Kt,g as Qt,c as It,b as Yt}from"./usePositionList-CQEFjGgG.js";import{a as Jt,b as Zt,P as es,u as ts}from"./PoolItem-DbUdb7ea.js";import{u as Y}from"./activeOrders-GpBDUoq6.js";import{P as ss,V as ns,H as ie,u as os}from"./PositionListLoading-ChLCJUHi.js";import{C as is}from"./CoinPairInfo-BHGuUvYD.js";import{u as dt}from"./VaultsAction-BXCfoTXt.js";import{V as as}from"./VaultsHoldings-DPgi5WDV.js";import{H as Pe,T as Le}from"./Table-DNN8epBr.js";import{T as he}from"./TableSortTh-BmYtkl_-.js";import{u as pt,D as ut,g as ls,e as rs,f as cs,W as ds,b as ps,R as us,a as xs,d as gs}from"./OverviewOrders-C67Tr9qZ.js";import{I as De}from"./IconText-CiZEVha6.js";import{u as hs}from"./RangeValue-DZA5kZG2.js";import{H as le}from"./HTextLabelBox-B-nKLdqZ.js";import{P as Ae}from"./Pagination-ijyf4HFr.js";import{b as fs,u as ye,c as js,C as ms,P as bs,F as ys,E as ws,S as Cs,O as _s,a as Ss}from"./useGetLimitOrderHistory-CGLcIXBz.js";import{u as vs}from"./useRpcListener-BM79iHQK.js";import{R as Ts}from"./RefreshButton-pkVEdLvT.js";import{u as ks}from"./useAccountBalance-xCFNREy3.js";import{u as xt}from"./useToken-DnukIxF2.js";import{f as Ue,a as Ps,b as Ls,u as As,X as Os,c as Rs,C as Ds,e as Hs,d as Fs,g as zs}from"./useXCetus-cZpAd0Cz.js";import{S as gt}from"./SingleTokenInfo-DXxahmBV.js";import{S as Bs}from"./SortDropBlock-DvTpeCo_.js";import{u as Es}from"./useTokenBalance-D943AjPe.js";import{X as Vs,a as Us,b as Ms,c as Ws}from"./useXCetusHelper-Cw9nSxyb.js";import"./CopyButton-CWWUWQJF.js";import"./Drawer-Dz9Aj4rR.js";import"./useGetPoolList-Cf87pFZm.js";import"./useWrapPoolData-D5ncdzDG.js";import"./useFavoritePool-BdgqzfrU.js";import"./CheckBox-CqHgO4KS.js";import"./SearchInputBlock-S0JoFFZh.js";import"./index-BZ8UGfWy.js";import"./Loading-yKVeoG31.js";import"./TooltipIcon-CGRTSCZG.js";import"./PositionCurrentPrice-BGJCvFu3.js";import"./contract-helper-CZVMEumF.js";import"./msafe-oYBkW7LJ.js";import"./useTransaction-BbmVBjAH.js";import"./useTrack-C19Aw2tz.js";import"./useSigner-DouEVNRN.js";import"./ExpendItem-DEfRHsFF.js";import"./PositionStatus-BgvDt4hv.js";import"./useInterval-BQqGpXj5.js";import"./PoweredByHaedal-Bke0Bj0w.js";import"./VTextLabelBox-CUFnEEKg.js";import"./useNotifiSubscription-BB1HBC_N.js";import"./useNotifiAlerts-D4u5IY5V.js";import"./usePriceImpact-BcGZX8m-.js";import"./index-BmEYB-eP.js";import"./useSwapHelper-BR8zHa8J.js";import"./TradeConfirmAmountInfo-BVDhHIq2.js";import"./TotalAmount-CKMFGbb5.js";import"./TradeInputGroup-DXz0vdlf.js";import"./_getAllKeysIn-CcH-WynY.js";import"./RemoveBlock-c7Lp9HFN.js";import"./DepositRatio-C6F0gF13.js";import"./FreshProgressV2-DeDOre2e.js";import"./ErrorTips-3iAafdyK.js";import"./index-zvNes5JD.js";import"./usePosAdd-Dm3omEQQ.js";import"./index-C4qWJUp8.js";import"./useFindBestRouting-BOYs32yR.js";import"./useVaultsHoldings-BZ5ZJSs5.js";import"./usePreviousValue-DoVr3Y3V.js";import"./HighlightText-fkyigc44.js";import"./index-D1m9ooSc.js";import"./debounce-B8kzHASh.js";import"./index-BLCSsYSf.js";function Ns(t=100){const i=p.useRef([]),o=p.useRef(!1),l=p.useRef(void 0),r=p.useCallback(async()=>{if(!o.current){for(o.current=!0;i.current.length>0;){const n=i.current.shift();if(!n)continue;const{id:c,run:u,onStart:x,onSuccess:d,onError:y}=n;if(n._cancelled){console.log(`[task:${n.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),x==null||x(c);const w=await u(l.current,c);l.current=w,console.log(`[task:${c}] success`,w),d==null||d(w,c)}catch(w){console.error(`[task:${c}] failed`,w),y==null||y(w,c)}await new Promise(w=>setTimeout(w,t))}o.current=!1}},[t]),a=n=>{i.current.push(n),r()},s=n=>{const c=i.current.find(u=>u.id===n);c&&(c._cancelled=!0),i.current=i.current.filter(u=>u.id!==n)};return p.useEffect(()=>()=>{i.current=[],o.current=!1,l.current=void 0},[]),{addTask:a,removeTask:s}}const ht=(t,i)=>i?t:"********";function Xs({totalValue:t,onRefreshTask:i,isLoading:o,children:l}){const[r,a]=p.useState(!1),{currentAccount:s,onWalletModal:n,accounts:c,accountServiceNameObj:u}=X(),{isShowProfileAssets:x,setIsShowProfileAssets:d}=at();p.useEffect(()=>{a(!0)},[]);const{isOpen:y,onClose:w,onToggle:C}=Ye(),{getServiceNames:L}=zt(),A=p.useCallback(()=>{y||L(c),C(),console.log("AccountSwitch###handleClick###isOpen: ",y)},[y,c]);return console.log(s,u,c,"currentAccount-H5Main"),e.jsxs(R,{w:"100%",mt:"28px",children:[r?s!=null&&s.address?e.jsxs(R,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(T,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(T,{h:"18px",children:[e.jsx(h,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ce,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(h,{fontSize:"12px",children:x?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(N,{xlinkHref:x?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>d(!x)})})})]}),e.jsxs(T,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(h,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(N,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(ae,{isLoaded:!o,h:"32px",children:e.jsx(h,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Z(t,2),x)})}),c.length>1&&e.jsxs(T,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:A,cursor:"pointer",children:[e.jsxs(T,{children:[e.jsx(N,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(h,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[s!=null&&s.label?`${s==null?void 0:s.label} : `:"",(u==null?void 0:u[s==null?void 0:s.address])||Ct(s==null?void 0:s.address)]})]}),e.jsx(N,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),l]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>n(!0)}):e.jsx(Je,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})}),e.jsx(Vt,{isOpen:y,onClose:w})]})}function Me(t){const{type:i,children:o,wrapStyle:l={h:"60px"},textStyle:r={fontSize:"16px"}}=t,a=(s,n)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(s,n):s===n.value;return e.jsxs(T,{justify:"space-between",w:"100%",h:"60px",...l,children:["title"in t?e.jsx(h,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(me,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(s,n)=>a(s,n),wrapStyle:{h:"60px",border:"none",gap:"38px",...l},itemStyle:r}),o]})}function $s({showPosListGroupByPool:t=[]}){var a;const{currentAccount:i,onWalletModal:o}=X(),{posBaseListLoading:l}=xe(),{isAutoRefresh:r}=Y();return e.jsxs(R,{w:"100%",children:[e.jsx(Jt,{isProfile:!0}),i!=null&&i.address?!r&&l?[{},{},{},{}].map((s,n)=>e.jsx(ss,{},n)):((a=Object.values(t))==null?void 0:a.length)>0?Object.values(t).map((s,n)=>e.jsx(Zt,{poolInfo:s,isProfile:!0},n)):e.jsx(se,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(se,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})}function Gs({poolInfo:t}){const{setProfileActionTab:i,isProfileOpenVaultModal:o,setIsProfileOpenVaultModal:l,clearVaultsActionData:r,setProfilePoolInfo:a}=dt();return p.useEffect(()=>{r()},[o]),e.jsx(e.Fragment,{children:e.jsxs(T,{justify:"flex-end",children:[e.jsx(q,{onClick:()=>{i("Deposit"),l(!0),a(t)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Deposit"}),e.jsx(q,{onClick:()=>{i("Withdraw"),l(!0),a(t)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Withdraw"})]})})}function qs({selectCoinList:t=[]}){const{vaultsPositionObj:i}=be(),{vaultPageList:o,vaultListLoading:l,setVaultListLoading:r}=Ee(),{filterVaultList:a,getCurrentTabNum:s}=Ve(),[n,c]=p.useState([]),[u,x]=p.useState("desc"),[d,y]=p.useState({label:"",value:""}),{profileActionTab:w,isProfileOpenVaultModal:C,setIsProfileOpenVaultModal:L,profilePoolInfo:A}=dt();p.useEffect(()=>{d.value==""&&c(o)},[o]),console.log("ðŸš€ ~ ProfileVaults ~ pageList:",l,(n==null?void 0:n.length)===0,n);const{isAutoRefresh:B,autoRefreshCount:m}=Y(),{isApp:g}=Q(),b=!0,S={sortRule:"desc",sortType:"tvl"},_=p.useMemo(()=>[{label:"All Vault",value:"all",num:s({sortOptions:S,currentTab:"all",isYourHoldings:b,selectCoinList:t})||""},{label:"Cetus",value:"cetus",num:s({sortOptions:S,currentTab:"cetus",isYourHoldings:b,selectCoinList:t})||""},{label:"Haedal",value:"haedal",num:s({sortOptions:S,currentTab:"haedal",isYourHoldings:b,selectCoinList:t})||""}],[JSON.stringify(n),b,JSON.stringify(t)]),[P,f]=p.useState("all"),{coinPriceObj:v}=ke(),{getTokenAmountValue:O}=ue(),{getTokenAmountValueByPyth:k}=Ut(),{pythPriceMap:z}=Mt(),E=H=>{P===H||l||(f(H),a({sortOptions:S,currentTab:H,isYourHoldings:b,selectCoinList:t}),r(!0),setTimeout(()=>{r(!1)},200))};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ vaultsPositionObj:",i),_t(i)&&a({sortOptions:S,currentTab:P,isYourHoldings:b,selectCoinList:t})},[i,t]);const M=(H,$,W)=>H.category=="haedal"?k($,W):O($,W,"--");p.useEffect(()=>{if((o==null?void 0:o.length)>0&&d.value!==""){const $=o.map(W=>{const G=i[W==null?void 0:W.vaultId]||{},de=M(W,G.displayCoinTypeA,G.displayAmountA),we=M(W,G.displayCoinTypeB,G.displayAmountB),ge=de=="--"||de=="--"?"0":F(de).plus(we||0).toString(),Ce=St(ge,"$");return{...W,sharePoolRate:G==null?void 0:G.sharePoolRate,holdingAmount:parseFloat(ge||"0"),holdingAmountDisplay:Ce}}).sort((W,G)=>u==="asc"?d.value=="holdings"?W.holdingAmount-G.holdingAmount:W.sharePoolRate-G.sharePoolRate:d.value=="holdings"?G.holdingAmount-W.holdingAmount:G.sharePoolRate-W.sharePoolRate);console.log("ðŸš€ ~ useEffect ~ sorted:",i,$),c($)}},[o.length,d.value,u,v,z]);const D=H=>{if(g)(H==null?void 0:H.value)!==(d==null?void 0:d.value)&&(x("desc"),y(H));else if((H==null?void 0:H.value)==(d==null?void 0:d.value)){const $=u=="desc"?"asc":"desc";x($)}else x("desc"),y(H)},j=[{label:"Your Holdings",value:"holdings"},{label:"Share of Pool",value:"shareOfPool"}].reduce((H,$)=>(H[$.value]=$,H),{}),V=Ks({isShowPowered:P!=="Haedal",vaultsPositionObj:i,getAmountValue:M,sortRule:u,sortBy:d,sortByObject:j,clickSort:D});return e.jsxs(R,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",children:[e.jsx(me,{type:"outlineTab",tabList:_,currentTab:P,handleChangeTab:H=>E(H==null?void 0:H.value),isActive:(H,$)=>H===$.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),e.jsx(R,{w:"100%",position:"relative",gap:"20px",children:(B||!l)&&(n==null?void 0:n.length)===0?e.jsx(se,{type:"nodata",text:"No vaults found",noBorder:!0}):g?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"clmmPoolAddress",columns:V,dataSource:n,loading:!B&&l,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"clmmPoolAddress",columns:V,dataSource:n,loading:!B&&l,rowStyle:{h:"80px",cursor:"pointer"}})}),C&&e.jsx(ns,{isOpen:C,setIsOpen:L,displayTokenA:A.displayTokenA,displayTokenB:A.displayTokenB,feeDisplay:A.feeDisplay,clmmPool:A.clmmPoolAddress,category:A.category,vaultId:A.vaultId,isReverse:A.isReverse,currentTab:w},A.vaultId)]})}const Ks=({isShowPowered:t,vaultsPositionObj:i,getAmountValue:o,sortRule:l,sortBy:r,sortByObject:a,clickSort:s})=>[{title:e.jsx(h,{children:"Pools"}),key:"pools",thConfig:{pl:"0px !important"},render:n=>e.jsx(is,{poolInfo:{...n,poolAddress:n==null?void 0:n.vaultId},isShowPowered:t,symbolFontSize:"15px"})},{title:e.jsx(he,{labelInfo:a.holdings,sortBy:r,sortRule:l,clickSort:n=>s(n)}),key:"holdings",render:n=>{var d,y,w,C;const c=i[n==null?void 0:n.vaultId]||{},u=o(n,(d=n==null?void 0:n.displayTokenA)==null?void 0:d.coin_type,c==null?void 0:c.displayAmountA),x=o(n,(y=n==null?void 0:n.displayTokenB)==null?void 0:y.coin_type,c==null?void 0:c.displayAmountB);return e.jsx(ce,{placement:"top",tooltip:e.jsxs(R,{gap:"8px",align:"flex-start",minW:"200px",children:[e.jsxs(T,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(T,{children:[e.jsx(fe,{imageUrl:n.displayTokenA.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(h,{color:"text_caption",fontSize:"12px",children:(w=n==null?void 0:n.displayTokenA)==null?void 0:w.symbol})]}),e.jsx(ie,{children:e.jsxs(R,{align:"flex-end",children:[e.jsx(h,{color:"text_caption",fontSize:"12px",children:J(c==null?void 0:c.displayAmountA)}),e.jsx(h,{fontSize:"12px",children:u=="--"?"$--":Z(u,2)})]})})]}),e.jsx(K,{w:"100%",height:"1px",bg:"border"}),e.jsxs(T,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(T,{children:[e.jsx(fe,{imageUrl:n.displayTokenB.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(h,{color:"text_caption",fontSize:"12px",children:(C=n==null?void 0:n.displayTokenB)==null?void 0:C.symbol})]}),e.jsx(ie,{children:e.jsxs(R,{align:"flex-end",children:[e.jsx(h,{color:"text_caption",fontSize:"12px",children:J(c==null?void 0:c.displayAmountB)}),e.jsx(h,{fontSize:"12px",children:x=="--"?"$--":Z(x,2)})]})})]})]}),children:e.jsx(I,{as:"button",ml:"4px",children:e.jsx(ie,{children:e.jsxs(T,{justifyContent:"flex-end",gap:"0",children:[e.jsx(h,{color:"text_caption",mr:"2px",textDecoration:"underline dotted",textUnderlineOffset:"3px",children:`${(c==null?void 0:c.balanceDisplay)||"0"} LP`}),e.jsx(h,{children:"("}),e.jsx(as,{color:"text_paragraph",vaultId:n.vaultId,category:n.category}),e.jsx(h,{children:")"})]})})})})}},{title:e.jsx(he,{labelInfo:a.shareOfPool,sortBy:r,sortRule:l,clickSort:n=>s(n)}),key:"shareOfPool",render:n=>{const c=i[n==null?void 0:n.vaultId]||{};return console.log("ðŸš€ ~ vaultsPositionObj:",i,c),e.jsx(T,{justify:"flex-end",children:e.jsx(ie,{children:e.jsxs(h,{color:"text_caption",children:[" ",c==null?void 0:c.shartOfPoolDisplay]})})})}},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),key:"actions",render:n=>e.jsx(Gs,{poolInfo:n})}];function Qs(){const{currentAccount:t}=X(),{vaultsPositionObj:i}=be(),{showPosListLength:o,posBaseListLoading:l,setShowPosListLength:r,posBaseListGroupByPool:a}=xe(),{getCurrentTabNum:s}=Ve(),[n,c]=p.useState([]),u=m=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",m),c(g=>[...g,m])},x=m=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",m),c(g=>g.filter(b=>(b==null?void 0:b.coin_type)!==(m==null?void 0:m.coin_type)))};p.useEffect(()=>{t!=null&&t.address||r("")},[t==null?void 0:t.address]),p.useEffect(()=>()=>{r("")},[]);const[d,y]=p.useState("positions"),w={sortRule:"desc",sortType:"tvl"},C=!0,L=p.useMemo(()=>{const m=d=="positions"?[]:n;return[{label:"Positions",value:"positions",num:l?"":Number(o)},{label:"Vaults",value:"vaults",num:s({sortOptions:w,currentTab:"all",isYourHoldings:C,selectCoinList:m})||""}]},[l,o,n,i]),[A,B]=p.useState([]);return p.useEffect(()=>{var P,f,v,O;const m=d=="vaults"?[]:n,g=(P=m[0])!=null&&P.coin_type?oe((f=m[0])==null?void 0:f.coin_type):void 0,b=(v=m[1])!=null&&v.coin_type?oe((O=m[1])==null?void 0:O.coin_type):void 0,S=Object.values(a).filter(k=>g&&b?oe(k.tokenA.coin_type)==g&&oe(k.tokenB.coin_type)==b||oe(k.tokenA.coin_type)==b&&oe(k.tokenB.coin_type)==g:g?oe(k.tokenA.coin_type)==g||oe(k.tokenB.coin_type)==g:k);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(a),S),B(S);const _=S.reduce((k,z)=>k+(z.list?z.list.length:0),0);t!=null&&t.address&&r(_.toString())},[n,a]),e.jsx(te,{p:"0 16px 16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{gap:"16px",w:"100%",children:[e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(Me,{type:"tab",currentTab:d,tabs:L,onTabChange:m=>{c([]),y(m.value)},textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(es,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:n,onClickSelectCoinList:u,onDeleteSelectCoinList:x})]}),e.jsx(K,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),d==="positions"&&e.jsx($s,{showPosListGroupByPool:A}),d==="vaults"&&e.jsx(qs,{selectCoinList:n})]})})}function Is({orderInfo:t,isActiveOrder:i,pageDirect:o}){const{inCoin:l,outCoin:r}=t,{orderHistoryList:a,handleGetDcaOrderHistory:s,orderHistoryListLoading:n}=pt();p.useEffect(()=>{t!=null&&t.orderID&&s(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=lt(),[u,x]=p.useState(o),d=142,y=(a==null?void 0:a.length)||0,w=(a==null?void 0:a.length)==0?"0px":(a==null?void 0:a.length)<=1?`${d*y+8}px`:`${d*y+(y-1)*32+8}px`;return e.jsxs(R,{pb:"16px",align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(a==null?void 0:a.length)>=3?"460px":"unset",overflowY:"auto",children:[!n&&e.jsx(K,{w:"0px",h:w,borderRight:"1px dashed",borderColor:"border",position:"absolute",left:"6px",top:"8px"}),n?e.jsx(T,{h:"100px",w:"100%",justify:"center",children:e.jsx(ze,{})}):(a==null?void 0:a.length)===0?e.jsx(se,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):a.map(C=>{const L=Xe(C.inAmount,l==null?void 0:l.decimals),A=Xe(C.outAmount,r==null?void 0:r.decimals),B=F(L).div(A).toString(),m=F(1).div(B).toString();return e.jsxs(R,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(T,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(h,{h:"20px",lineHeight:"20px",children:[Te((C==null?void 0:C.time)*1e3)," (UTC)"]}),e.jsx(N,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(C==null?void 0:C.tx,"tx"))}}),e.jsx(T,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(K,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(te,{p:"16px",borderRadius:"12px",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsxs(R,{gap:"0px",align:"flex-start",children:[e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:u?`${J(B)} `:`${J(m)} `}),e.jsxs(T,{children:[e.jsxs(h,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",u?` ${l.symbol} per ${r.symbol}`:` ${r.symbol} per ${l.symbol}`,")"]}),e.jsx(N,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>x(!u)})]})]}),e.jsxs(T,{w:"100%",gap:"4px",children:[e.jsx(fe,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${J(L)}`}),e.jsx(h,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${l.symbol}`}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(fe,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(h,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${J(A)}`}),e.jsx(h,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},C==null?void 0:C.tx)})]})}function Ys({orderInfo:t,isActiveOrder:i,pageDirect:o,isClaimLoading:l=!1,toClaim:r}){const{inCoin:a,outCoin:s}=t;return e.jsxs(R,{pb:"24px",children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&i&&e.jsx(Js,{}),e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(ut,{orderInfo:t}),i&&r&&e.jsx(q,{isLoading:l,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||l,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(h,{fontSize:"16px",color:"text_caption",children:ls(t,i,!0)}),e.jsx(h,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(T,{w:"100%",justify:"space-around",children:[e.jsxs(R,{children:[e.jsx(h,{fontSize:"16px",color:"text_caption",children:rs(t)}),e.jsxs(h,{fontSize:"12px",children:["DCA ",a==null?void 0:a.symbol," Balance"]})]}),e.jsx(K,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(R,{children:[e.jsx(h,{color:"text_caption",fontSize:"16px",children:cs(t)}),e.jsxs(h,{fontSize:"12px",children:["DCA ",s==null?void 0:s.symbol," Balance "]})]})]}),e.jsxs(R,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(le,{label:"Invest Every",value:t==null?void 0:t.investEvery}),F(t==null?void 0:t.ofOrderLeft).gt("0")&&e.jsx(le,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(le,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${a==null?void 0:a.symbol}`}),i&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(le,{label:"Current Avg. Price",value:o?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${a==null?void 0:a.symbol}`}),!i&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(le,{label:"Avg. Price",value:o?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${a==null?void 0:a.symbol}`}),i&&e.jsx(le,{label:"Next Order (UTC)",value:Te(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(le,{label:"Created (UTC)",value:Te(t==null?void 0:t.createAt)||""})]})]})}const Js=()=>{const[t,i]=p.useState(!1);return e.jsxs(R,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(T,{align:"center",w:"100%",cursor:"pointer",onClick:()=>i(!t),children:[e.jsx(h,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(N,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(R,{align:"flex-start",w:"100%",children:[e.jsx(K,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(ds,{})]})]})};function Zs({isOpen:t,onClose:i,orderInfo:o,isActiveOrder:l,isClaimLoading:r=!1,toClaim:a}){const{isApp:s}=Q(),n=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,u]=p.useState("overview"),{inCoin:x,outCoin:d}=o,[y,w]=p.useState(!1),{getTokenRank:C}=hs();return p.useEffect(()=>{const L=C(x,d);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",d,x,L),w(!L)},[x==null?void 0:x.coin_type,d==null?void 0:d.coin_type]),e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{minWidth:s?"300px":"482px",children:[e.jsx(st,{children:e.jsx(K,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Me,{type:"tab",currentTab:c,tabs:n,onTabChange:L=>u(L.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"0 16px 0px",textAlign:"center",children:[c=="overview"&&e.jsx(Ys,{orderInfo:o,isActiveOrder:l,pageDirect:y,isClaimLoading:r,toClaim:a}),c=="orders"&&e.jsx(Is,{orderInfo:o,isActiveOrder:l,pageDirect:y})]})]})]})}function en({orderInfo:t,isActiveOrder:i=!0}){const{isApp:o}=Q(),[l,r]=p.useState(!1),{getExplorerUrl:a}=lt(),{isClaimLoading:s,toClaim:n,closeOrderAction:c,isCloseLoading:u}=pt();return e.jsxs(e.Fragment,{children:[i&&e.jsxs(T,{justify:"flex-end",children:[e.jsx(q,{isLoading:s,onClick:()=>n(t),disabled:(t==null?void 0:t.outBalance)<=0||s,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(ce,{placement:"bottom-end",tooltip:e.jsxs(R,{align:"flex-start",children:[e.jsx(De,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(De,{text:"View on Explorer",onClick:()=>{window.open(a(t.orderID,"poolAddress"))}}),e.jsx(De,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:u?()=>{}:()=>{c(t)}})]}),children:e.jsx(I,{children:e.jsx(q,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:o?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!i&&e.jsxs(T,{justify:"flex-end",children:[e.jsx(q,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(q,{onClick:x=>{vt(x),window.open(a(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(N,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),l&&e.jsx(Zs,{isOpen:l,onClose:()=>r(!1),orderInfo:t,isActiveOrder:i,isClaimLoading:s,toClaim:n})]})}function tn(){const{isAutoRefresh:t,dcaOrderListLoading:i,dcaActiveOrderList:o,dcaPastOrderList:l}=Y(),[r,a]=p.useState("activeDCAs"),s=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&i?"":o==null?void 0:o.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&i?"":l==null?void 0:l.length}],[i,l,o]),n=p.useMemo(()=>r=="activeDCAs"?o:l,[r,o,l]),{isApp:c}=Q(),{closeAll:u,claimAll:x,isClaimAllLoading:d,isCloseAllLoading:y}=ps(),w=p.useMemo(()=>r==="pastDCAs"||(n==null?void 0:n.length)===0?0:n==null?void 0:n.reduce((_,P)=>F(_).plus(P==null?void 0:P.outBalance),F(0)).toString(),[r,n]),[C,L]=p.useState([]),[A,B]=p.useState(0),[m,g]=p.useState(1),b=10,S=Ke(r=="activeDCAs");return p.useEffect(()=>{if((n==null?void 0:n.length)>0){const _=(m-1)*b;(n==null?void 0:n.length)<=_&&g(1)}},[n]),p.useEffect(()=>{if((n==null?void 0:n.length)>0){B(n==null?void 0:n.length);const _=(m-1)*b,P=_+b;console.log("ðŸš€ ~ useEffect ~ start:",m,n.slice(0,P),_,P),(n==null?void 0:n.length)>_&&L(n.slice(_,P))}},[m,n]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:s,currentTab:r,handleChangeTab:_=>a(_==null?void 0:_.value),isActive:(_,P)=>_===P.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(n==null?void 0:n.length)>1&&r=="activeDCAs"&&e.jsxs(T,{children:[e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:d,disabled:Number(w)===0||d,onClick:()=>{x(n)},children:"Claim All"}),e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:y,disabled:(n==null?void 0:n.length)==0||y,onClick:()=>{u(n)},children:"Close All"})]})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(t||!i)&&(n==null?void 0:n.length)===0?e.jsx(se,{type:"nodata",text:r==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"orderID",columns:S,dataSource:C,loading:!t&&i,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"orderID",columns:Ke(r=="activeDCAs"),dataSource:C,loading:!t&&i,rowStyle:{h:"80px",cursor:"pointer"}}),(n==null?void 0:n.length)>b&&e.jsx(I,{children:e.jsx(Ae,{total:A,size:b,currentPage:m,onChange:_=>{g(_)}})})]})]})}const Ke=t=>[{title:e.jsx(h,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:o=>e.jsx(ut,{orderInfo:o})},{title:e.jsx(h,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:o=>e.jsx(us,{orderInfo:o,isProfile:!0,isRank:!0})},{title:e.jsx(h,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:o=>e.jsx(xs,{orderInfo:o,isProfile:!0})},t&&{title:e.jsx(h,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:o})=>e.jsx(h,{color:"text_caption",children:Te(o)})},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:o=>e.jsx(en,{orderInfo:o,isActiveOrder:t})}].filter(Boolean);function sn(){const{currentAccount:t}=X(),{getLimitOrderHistory:i,historyOrderList:o,historyOrderLoading:l}=fs(),{myOrderList:r,orderListLoading:a}=ye(),{isAutoRefresh:s,autoRefreshCount:n}=Y(),[c,u]=p.useState("openOrders"),x=p.useMemo(()=>c=="openOrders"?a:l,[c,a,l]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,o),c=="openOrders"?r:o),[c,r,o]),y=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:(s||!x)&&(r==null?void 0:r.length)===0?0:!s&&a?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:(s||!x)&&(o==null?void 0:o.length)===0?0:!s&&l?"":o==null?void 0:o.length}],[a,l,r,o]),w=v=>{t!=null&&t.address&&i(t.address,v)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",n),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),n>0&&w(!0)},[n]),p.useEffect(()=>{w(!1)},[c,t]),vs({onRpcChange:()=>{w(!0)}});const{isApp:C}=Q(),{handleCancelOrder:L,cancelOrderLoading:A}=js(),[B,m]=p.useState([]),[g,b]=p.useState(0),[S,_]=p.useState(1),P=10,f=nn(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const v=(S-1)*P;(d==null?void 0:d.length)<=v&&_(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){b(d==null?void 0:d.length);const v=(S-1)*P,O=v+P;console.log("ðŸš€ ~ useEffect ~ start:",S,d.slice(0,O),v,O),(d==null?void 0:d.length)>v&&m(d.slice(v,O))}},[S,d]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:y,currentTab:c,handleChangeTab:v=>u(v==null?void 0:v.value),isActive:(v,O)=>v===O.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(T,{children:e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:A,onClick:()=>{L(r)},children:"Cancel All"})})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(s||!x)&&(d==null?void 0:d.length)===0?e.jsx(se,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):C?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"order_id",columns:f,dataSource:B,loading:!s&&x,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"order_id",columns:f,dataSource:B,loading:!s&&x,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>P&&e.jsx(I,{children:e.jsx(Ae,{total:g,size:P,currentPage:S,onChange:v=>{_(v)}})})]})]})}const nn=t=>[{title:e.jsx(h,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:o=>e.jsx(ms,{imgSize:"28px",info:o,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:o=>e.jsx(bs,{info:o,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:o=>e.jsx(ys,{info:o,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:o=>e.jsx(ws,{info:o,isProfile:!0})},!t&&{title:e.jsx(h,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:o=>e.jsx(Cs,{historyInfo:o,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(h,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:o=>e.jsx(_s,{orderInfo:o,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function on(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[i,o]=p.useState("limitOrders");return e.jsx(te,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsx(K,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Me,{type:"tab",currentTab:i,tabs:t,onTabChange:l=>o(l.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),i==="limitOrders"&&e.jsx(sn,{}),i==="dca"&&e.jsx(tn,{})]})})}function an({handleRefresh:t,totalValue:i,isLoading:o}){const{isApp:l}=Q(),{currentAccount:r,accounts:a}=X(),{isShowProfileAssets:s,setIsShowProfileAssets:n}=at(),[c,u]=p.useState(!1),{onClose:x}=Ye();return e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsxs(T,{gap:"4px",children:[e.jsx(h,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ce,{showTooltip:!l,placement:"bottom-end",tooltip:e.jsx(h,{fontSize:"12px",children:s?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(N,{xlinkHref:s?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>n(!s)})})})]}),e.jsxs(T,{children:[e.jsxs(T,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{u(!0)},children:[e.jsx(N,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(h,{children:"Transactions"})]}),e.jsx(Ts,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),e.jsx(T,{w:"100%",justify:"space-between",mt:"2px",children:e.jsx(ae,{isLoaded:!o,h:"22px",children:e.jsx(h,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Z(i,2),s)})})}),a.length>1&&e.jsx(Bt,{currentAccount:r,accounts:a,onClose:x,isProfile:!0}),c&&e.jsx(Et,{isOpen:c,onClose:()=>u(!1)})]})}function ln({tabList:t,tabData:i,onClickTab:o}){return e.jsx(R,{w:"100%",children:t==null?void 0:t.map(l=>e.jsx(rn,{imgUrl:l.activeImgUrl,value:i[l.value].totalValue,title:l.title,url:l.route,tooltip:l==null?void 0:l.tooltip,onClick:()=>o(l.value),isLoading:i[l.value].isLoading},l.title))})}const rn=({imgUrl:t,value:i,title:o,url:l,tooltip:r,isLoading:a,onClick:s})=>(Be(),e.jsxs(T,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:s,children:[e.jsxs(T,{gap:"12px",children:[e.jsx(it,{w:"36px",h:"36px",src:t}),e.jsxs(R,{gap:"2px",align:"flex-start",children:[e.jsx(ae,{h:"24px",isLoaded:!a,children:e.jsx(h,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:i})}),e.jsxs(T,{gap:"4px",children:[e.jsx(h,{fontSize:"12px",h:"15px",lineHeight:"15px",children:o}),r&&e.jsx(ce,{tooltip:r,children:e.jsx(K,{children:e.jsx(N,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(I,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(N,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function cn({tabList:t,activeTab:i,tabData:o,onClickTab:l}){return e.jsx(T,{w:"100%",mt:"12px",gap:"12px",children:t.map(r=>{var a,s;return e.jsxs(te,{w:"25%",p:"28px 16px",bgImage:i===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:i===r.value?"primary":"border",onClick:()=>l(r.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(R,{align:"flex-start",gap:"10px",children:[e.jsx(h,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(T,{h:"22px",children:e.jsx(ie,{size:"l",children:e.jsx(ce,{placement:"top",tooltip:e.jsx(h,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:r.tooltip}),showTooltip:r.showTooltip,children:e.jsx(I,{as:"button",children:e.jsx(ae,{isLoaded:!((a=o[r.value])!=null&&a.isLoading),children:e.jsx(h,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(s=o[r.value])==null?void 0:s.totalValue})})})})})})]}),e.jsx(it,{w:"38px",h:"38px",src:r.activeImgUrl,opacity:i===r.value?"0.8":"0.4"})]},r.value)})})}function Qe(t){const{isApp:i}=Q();return i?e.jsx(ln,{...t}):e.jsx(cn,{...t})}const dn=(t,i)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:o=>t({isCoinHoldingLoading:o}),setCoinHoldingList:o=>t({coinHoldingList:o}),isCoinPriceLoading:!0,setIsCoinPriceLoading:o=>t({isCoinPriceLoading:o}),holdingsTotalUsd:"0",setHoldingsTotalUsd:o=>t({holdingsTotalUsd:o}),unknownCoinCount:0,setUnknownCoinCount:o=>t({unknownCoinCount:o})}),Oe=rt(dn);function ft(){const{currentAccount:t}=X(),{fetchAccountBalance:i}=ks(),{coinHoldingList:o,setCoinHoldingList:l,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:a,setHoldingsTotalUsd:s,isCoinPriceLoading:n,setUnknownCoinCount:c}=Oe(),{getTokenListInfo:u}=xt(),{getTokenPrice:x}=ue(),{refreshCoinPriceInfo:d}=Ue(),y=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{y.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const w=async()=>{const m=y.current;if(m){r(!0);const g=await i(m,!0);if(g){const b=await u(g.filter(P=>F(P.totalBalance).gt(0)).map(P=>P.coinType));if(!b)throw r(!1),l([]),new Error("get token list info error");const S=[];let _=0;return g.forEach(P=>{const f=b.get(P.coinType);if(f){const v=P.totalBalance,O=pe(v,f.decimals).toString(),k=J(O,void 0,void 0,Tt.ROUND_DOWN).toString(),z={balance:v,balance_format:O,balance_display:k,balance_usd:void 0,coin:f,coin_type:f==null?void 0:f.coin_type,price:"",price_diff_24:""};S.push(z),f.is_verified||_++}}),L(S),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",m),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",y.current),m===y.current&&(l(S),c(_),C([...S])),r(!1),S}}else r(!1),l([]);return[]},C=async m=>{a(!0);try{await d(m.filter(g=>g.coin.is_verified).map(g=>g.coin.coin_type),!0)}catch(g){console.error("fetch coin price info error",g)}finally{a(!1)}},L=m=>{m.map(g=>{const{coin:b}=g;if(b.is_verified){const S=x(b.coin_type);S&&(g.price=S.price,g.price_diff_24=S.price_change||"",g.balance_usd=F(g.balance_format).mul(S.price).toString())}})},A=async m=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:m,coinHoldingList:o,currentAccount:t}),t){const{search:g,current_sort:b,current_sort_order:S,is_show_unknown:_=!1,is_hide_small_balance:P=!0}=m;let f=[];if(_?f.push(...o):f=o.filter(v=>v.coin.is_verified),g){const v=g.toLowerCase();f=f.filter(O=>O.coin.coin_type.toLowerCase().includes(v)||O.coin.symbol.toLowerCase().includes(v)||O.coin.name.toLowerCase().includes(v))}return L(f),P&&!n&&(f=f.filter(v=>v.balance_usd===void 0||F(v.balance_usd).gt(.01))),f.sort((v,O)=>{if(b==="balance"){const k=F(v.balance_format).cmp(F(O.balance_format));if(k!==0)return S==="desc"?-k:k}if(b==="value"){const k=F(v.balance_usd).cmp(F(O.balance_usd));return k!==0?S==="desc"?-k:k:F(O.balance_format).cmp(F(v.balance_format))}if(b==="price"){const k=F(v.price||"0").cmp(F(O.price||"0"));return k!==0?S==="desc"?-k:k:F(O.balance_format).cmp(F(v.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",f),f}return[]};return p.useEffect(()=>{L(o);const m=o.reduce((g,b)=>g+Number(b.balance_usd||0),0);s(m.toString())},[o,n]),{getFilterCoinHoldingList:A,fetchCoinHoldingList:w,resetUserData:()=>{l([]),s("0"),c(0)}}}function pn({inputValue:t,changeInputValue:i}){const o=p.useRef(null),[l,r]=p.useState(!1);return Q(),e.jsxs(jt,{w:l?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(mt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:a=>{var s;(s=o.current)==null||s.focus(),r(!0)}})}),e.jsx(bt,{bg:"background",ref:o,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:a=>{i(a.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{i(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:l?"28px":"8px",pl:l?"28px":"8px"}),t?e.jsx(yt,{right:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_close",onMouseDown:a=>a.preventDefault(),onClick:a=>{i(""),setTimeout(()=>{var s;(s=o.current)==null||s.focus()},0)}})}):null]})}function un({inputValue:t,changeInputValue:i,isShowUnknownCoin:o,handleIsShowUnknownCoin:l,isHideLowAsset:r,handleIsHideLowAsset:a,unknownCoinCount:s}){return Q(),e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(h,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(T,{children:[e.jsx(pn,{inputValue:t,changeInputValue:i}),e.jsx(te,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(T,{h:"100%",justify:"space-between",children:[e.jsxs(h,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",s,")"]}),e.jsx(Ne,{isChecked:o,onChange:l})]})}),e.jsx(te,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(T,{h:"100%",justify:"space-between",children:[e.jsx(h,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Ne,{isChecked:r,onChange:a})]})})]})]})}function xn(){const{isApp:t}=Q(),{getFilterCoinHoldingList:i}=ft(),{isCoinHoldingLoading:o,isCoinPriceLoading:l,unknownCoinCount:r}=Oe(),{isAutoRefresh:a}=Y(),[s,n]=p.useState([]),[c,u]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[x,d]=p.useState(!1),[y,w]=p.useState(!0),[C,L]=p.useState("desc"),[A,B]=p.useState(Fe[2]),m=j=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",j),a||z(1),u(j),i(j).then(n)},g=j=>{m({...c,search:j})},b=j=>{const V=(j==null?void 0:j.value)===(A==null?void 0:A.value),H=t||!V?"desc":C==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",H,j),B(j),L(H),m({...c,current_sort:j.value,current_sort_order:H})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",o,l,s),!o&&!l&&m(c)},[o,l]);const S=Be(),_=j=>{S(`/swap/${j}/''`)},[P,f]=p.useState([]),[v,O]=p.useState(0),[k,z]=p.useState(1),E=10;p.useEffect(()=>{if((s==null?void 0:s.length)>0){const j=(k-1)*E;(s==null?void 0:s.length)<=j&&z(1)}},[s]),p.useEffect(()=>{if((s==null?void 0:s.length)>0){O(s==null?void 0:s.length);const j=(k-1)*E,V=j+E;console.log("ðŸš€ ~ useEffect ~ start:",k,s.slice(0,V),j,V),(s==null?void 0:s.length)>j&&f(s.slice(j,V))}else f([])},[k,s]);const M=(j,V)=>{j==="is_show_unknown"&&d(V),j==="is_hide_small_balance"&&w(V)},D=j=>{M("is_show_unknown",j.target.checked),j.target.checked||m({...c,is_show_unknown:!1}),j.target.checked&&!x&&(M("is_hide_small_balance",!1),m({...c,is_show_unknown:!0,is_hide_small_balance:!1}))},U=j=>{M("is_hide_small_balance",j.target.checked),m({...c,is_hide_small_balance:j.target.checked})};return e.jsx(te,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(un,{unknownCoinCount:r,inputValue:c.search||"",changeInputValue:g,isShowUnknownCoin:x,handleIsShowUnknownCoin:D,isHideLowAsset:y,handleIsHideLowAsset:U}),e.jsx(K,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(!o&&!l||a)&&(s==null?void 0:s.length)===0?e.jsx(se,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(R,{w:"100%",gap:"4px",children:[e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(h,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Bs,{sortText:"Sort by",minW:"180px",currentSort:A,sortByList:Fe,onSortByChange:b,xlinkHref:C==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>L(j=>j==="desc"?"asc":"desc")})]}),e.jsx(Pe,{rowKey:"coin_type",columns:Ie(C,A,b,_,!a&&l,s==null?void 0:s.length),dataSource:P,loading:!a&&(o||l),itemSkeletonLength:5,itemHeight:"30px",onRowClick:j=>{_(j==null?void 0:j.coin_type)}})]}):e.jsx(Le,{rowKey:"coin_type",columns:Ie(C,A,b,_,!a&&l,s==null?void 0:s.length),dataSource:P,skeletonLength:5,loading:!a&&(o||l),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:j=>{_(j==null?void 0:j.coin_type)}}),(s==null?void 0:s.length)>E&&e.jsx(I,{children:e.jsx(Ae,{total:v,size:E,currentPage:k,onChange:j=>{z(j)}})})]})]})})}const Fe=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],He=Object.fromEntries(Fe.map(t=>[t.value,t])),Ie=(t,i,o,l,r,a)=>[{title:e.jsxs(h,{children:["Token(",a,")"]}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:s})=>e.jsx(gt,{haveTooltip:!0,token:s,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(he,{labelInfo:He.balance,sortRule:t,sortBy:i,clickSort:o}),key:"balance",thConfig:{w:"25%"},render:({coin:s,balance_display:n})=>e.jsx(T,{justify:"flex-end",children:e.jsx(ie,{children:e.jsxs(h,{color:"text_caption",children:[n," ",kt(s==null?void 0:s.symbol,10)]})})})},{title:e.jsx(he,{labelInfo:He.price,sortRule:t,sortBy:i,clickSort:o}),key:"price",thConfig:{w:"25%"},render:({price:s,price_diff_24:n})=>{const c=F(n).gt(0);return e.jsx(T,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!r,children:e.jsx(T,{gap:"2px",children:s===void 0||s===""?e.jsx(h,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{color:"text_caption",children:["$",ct(s)]}),e.jsxs(h,{color:Number(n)===0?"text_caption":c?"primary_green":"primary_red",children:["(",c?"+":F(n).gt(-1e-4)&&F(n).lt(0)?"-":"",F(n).gt(-1e-4)&&F(n).lt(1e-4)?"0%":Pt(F(n).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(he,{labelInfo:He.value,sortRule:t,sortBy:i,clickSort:o}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:s})=>(console.log(s,"balance_usd"),e.jsx(T,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!r,children:e.jsx(ie,{children:e.jsx(h,{color:"text_caption",children:s===void 0?"--":Z(s,2)})})})}))},{title:e.jsx(h,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:s=>e.jsx(q,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{l(s==null?void 0:s.coin_type)},children:"Swap"})}],gn=(t,i)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:o=>t({isXCetusModalOpen:o}),isXCetusLoading:!1,setIsXCetusLoading:o=>t({isXCetusLoading:o}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:o=>t({currentXCetusTab:o})}),Re=rt(gn),hn={cetus:{title:"CETUS Holdings",imgUrl:ee.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:ee.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function We({type:t,amount:i,amountUSD:o,isLoading:l,children:r}){const{title:a,imgUrl:s,bgUrl:n}=hn[t];return e.jsx(te,{flex:"1",bg:`center / cover no-repeat url(${n})`,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(R,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(T,{children:[e.jsx(fe,{imageUrl:s,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(h,{children:a})]}),e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(ie,{children:e.jsxs(R,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(ae,{isLoaded:!l,h:"24px",children:e.jsx(h,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:i})}),o!==void 0&&e.jsx(ae,{isLoaded:!l,h:"17px",children:e.jsxs(h,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ct(o,2)]})})]})}),r]})]})})}function fn(){const{currentAccount:t}=X(),{balanceInfo:i}=Es(ee.cetus_coin),{getTokenAmountValue:o}=ue(),{coinPriceObj:l}=ke(),r=p.useMemo(()=>o(ee.cetus_coin.coin_type,pe((i==null?void 0:i.balance)||"0",ee.cetus_coin.decimals)).toString(),[i==null?void 0:i.balance,t==null?void 0:t.address,l]),{setCurrentXCetusTab:a,setIsXCetusModalOpen:s}=Re(),n=()=>{s(!0),a("Get xCETUS")},{veNFT:c,veNFTLoading:u,lockCetusListLoading:x}=ne();return e.jsx(We,{type:"cetus",amount:t?(i==null?void 0:i.balanceFormat)||"0":"--",amountUSD:r,isLoading:(x||u)&&c!==void 0,children:e.jsx(q,{onClick:n,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Convert to xCETUS"})})}function jn(){const{lockCetusList:t,lockCetusListLoading:i}=ne(),[o,l]=p.useState([]),[r,a]=p.useState(0),[s,n]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const u=(s-1)*c;(t==null?void 0:t.length)<=u&&n(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){a(t==null?void 0:t.length);const u=(s-1)*c,x=u+c;console.log("ðŸš€ ~ useEffect ~ start:",s,t.slice(0,x),u,x),(t==null?void 0:t.length)>u&&l(t.slice(u,x))}},[s,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(wt,{orientation:"horizontal"}),e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(h,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(R,{w:"100%",gap:"12px",children:o==null?void 0:o.map(u=>e.jsx(mn,{order:u},u==null?void 0:u.id))}),(t==null?void 0:t.length)>c&&e.jsx(I,{w:"100%",children:e.jsx(Ae,{total:r,size:c,currentPage:s,onChange:u=>{n(u)}})})]})]})}const mn=({order:t})=>{const[i,o]=p.useState(!je.isLocked(t));p.useEffect(()=>{o(!je.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:l,handleCancelOrder:r}=Ps(),{claimOrderLoading:a,handleClaimOrder:s}=Ls(),{days:n,hours:c,minutes:u,seconds:x}=As(t.locked_until_time*1e3,()=>{o(!0)},"days"),d=y=>{y?s(t.id):r(t)};return e.jsxs(T,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",bg:"bg_nine",borderRadius:"12px",children:[i?e.jsxs(T,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(h,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(T,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(K,{as:"div",children:[e.jsxs(h,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(h,{as:"span",color:"text_caption",fontSize:"13px",children:[n,"d : ",c,"h : ",u,"m : ",x,"s"]})]})]}),e.jsxs(T,{gap:"12px",children:[e.jsx(Os,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(q,{onClick:()=>{l||a||d(i)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:l||a,color:i?"background":"primary_gray",bg:i?"primary":"card_bg",_hover:{bg:i?"primary_hover":"button_ghost_hov_bg",color:i?"background":"text_caption"},children:i?"Claim":"Cancel"})]})]})};function bn({totalRewardValue:t,rewardList:i,summaryRewardList:o}){const{currentAccount:l}=X(),{veNFTLoading:r}=ne(),{claimRewardLoading:a,handleClaimReward:s}=Rs(),n=()=>{a||s(i)};return Q(),e.jsx(We,{type:"rewards",amount:l?F(t).gt("0")?e.jsx(ce,{tooltip:e.jsx(R,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:o==null?void 0:o.map(c=>e.jsxs(T,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(gt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(T,{gap:"4px",children:[e.jsx(h,{fontSize:"12px",color:"text_caption",children:J(c==null?void 0:c.amount,6)}),e.jsxs(h,{fontSize:"12px",children:["(",Z(c==null?void 0:c.value,2),")"]})]})]},c.coin_type))}),children:e.jsx(h,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Z(t,2)})}):e.jsx(h,{textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Z(t,2)}):"--",isLoading:r,children:o.length>0&&e.jsx(q,{onClick:n,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Claim"})})}function yn({availableXCetusAmount:t}){const{currentAccount:i}=X(),{veNFT:o,veNFTLoading:l,lockCetusListLoading:r}=ne(),{getTokenAmountValue:a}=ue(),{coinPriceObj:s}=ke(),n=p.useMemo(()=>a(ee.cetus_coin.coin_type,pe(t||"0",ee.x_cetus_coin.decimals)).toString(),[t,i==null?void 0:i.address,s]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:u}=Re(),x=()=>{u(!0),c("Redeem CETUS")},d=(r||l)&&o!==void 0;return e.jsx(We,{type:"xcetus",amount:i?J(pe(t||"0",9),9).toString():"--",amountUSD:n,isLoading:d,children:e.jsx(q,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Redeem"})})}const _e=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function wn({isOpen:t,onClose:i,availableXCetusAmount:o}){const{currentXCetusTab:l,setCurrentXCetusTab:r}=Re(),[a,s]=p.useState("#icon-a-icon_trade"),n=()=>{s("#icon-icon_swap1")},c=()=>{s("#icon-a-icon_trade")},u=()=>{var d;const x=(d=_e==null?void 0:_e.find(y=>(y==null?void 0:y.value)!==l))==null?void 0:d.value;x&&r(x)};return e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{children:[e.jsx(st,{p:"0 16px",children:e.jsx(K,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(me,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:_e,currentTab:l,handleChangeTab:x=>{r(x==null?void 0:x.value)}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"20px 16px 16px",children:[l==="Get xCETUS"&&e.jsx(Ds,{onClose:i,availableXCetusAmount:o,onIconClick:u,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:n,onMouseLeave:c}}),l==="Redeem CETUS"&&e.jsx(Hs,{onClose:i,availableXCetusAmount:pe(o,9),onIconClick:u,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:n,onMouseLeave:c}})]})]})]})}function Cn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:i}=Re(),{availableXCetusAmount:o,totalRewardValue:l,rewardList:r,summaryRewardList:a}=Fs();return e.jsx(te,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",gap:"16px",children:[e.jsxs(T,{w:"100%",gap:"10px",children:[e.jsx(yn,{availableXCetusAmount:o}),e.jsx(fn,{}),e.jsx(bn,{totalRewardValue:l,rewardList:r,summaryRewardList:a})]}),e.jsx(jn,{}),t&&e.jsx(wn,{isOpen:t,onClose:()=>i(!1),availableXCetusAmount:o})]})})}function _n(){const{currentAccount:t}=X(),{orderListLoading:i,myOrderList:o}=ye(),{isAutoRefresh:l,dcaOrderListLoading:r,dcaActiveOrderList:a}=Y(),{getTokenAmountValue:s,coinPriceObj:n}=ue(),c=p.useMemo(()=>{let d=F(0);if(l||!i)return(o==null?void 0:o.length)>0&&(t!=null&&t.address)?(o.forEach(y=>{const{pay_coin:w,target_coin:C,un_claimed_amount:L,remaining_amount:A}=y,B=s(w.coin_type,A),m=s(C.coin_type,L);d=F(d).plus(B).plus(m),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",d.toString())}),d.toString()):"0"},[l,o,t==null?void 0:t.address,i,n]),u=p.useMemo(()=>{let d=F(0);if(l||!r)return(a==null?void 0:a.length)>0&&(t!=null&&t.address)?(a.forEach(y=>{const{inBalance:w,inCoin:C,outBalance:L,outCoin:A}=y,B=s(C.coin_type,w),m=s(A.coin_type,L);d=F(d).plus(B).plus(m),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",d.toString())}),d):"0"},[l,a,t==null?void 0:t.address,r,n]),x=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",u,c),u&&c){let d=F(0);return d=F(d).plus(u).plus(c),d.toString()}return"--"},[u,c]);return{limitTotalTvl:c,dcaTotalTvl:u,orderTotalTvl:x}}function Sn(){const{currentAccount:t}=X(),{isAutoRefresh:i}=Y(),{veNFT:o,veNFTLoading:l,lockCetusListLoading:r}=ne(),{getTokenAmountValue:a}=ue(),{coinPriceObj:s}=ke();return{xCetusTotalTvl:p.useMemo(()=>{if(i||!l&&!r)return t!=null&&t.address&&o?a(ee.cetus_coin.coin_type,pe(o==null?void 0:o.xcetus_balance,ee.cetus_coin.decimals)).toString():"0"},[i,o==null?void 0:o.xcetus_balance,r,l,t==null?void 0:t.address,s])}}const vn="fetch-coin-holding-list",Tn="fetch-owner-nft",kn="fetch-active-order-list",Pn="fetch-xcetus-base-info",Ln="fetch-vaults-position-list";function An(){const{currentAccount:t}=X(),{getTokenListInfo:i}=xt(),{getLimitUserIndexer:o,getDcaUserIndexer:l}=zs(),{setOrderListLoading:r,setMyOrderList:a}=ye(),{setDcaOrderListLoading:s,setDcaActiveOrderList:n,setDcaPastOrderList:c}=Y(),{refreshCoinPriceInfo:u}=Ue(),{buildDcaOrderList:x}=gs(),d=re("limit"),y=re("dca"),{formatLimitOrderList:w}=Ss(),C=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{C.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const L=async()=>{if(t){r(!0);const g=await o(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",g),g)try{return(await d.FullClient.getDynamicFieldsByPage(g)).data.map(_=>_.name.value)}catch(b){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",b)}}return[]},A=async()=>{if(t){s(!0);const g=await l(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",g),g)try{return(await y.FullClient.getDynamicFieldsByPage(g)).data.map(_=>_.name.value)}catch(b){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",b)}}return[]};return{fetchActiveOrderList:async()=>{try{const g=await L(),b=await A(),S=await d.FullClient.batchGetObjects([...g,...b],{showType:!0,showContent:!0}),_=S.filter(D=>{var U,j;return(j=(U=D.data)==null?void 0:U.type)==null?void 0:j.includes("limit_order::LimitOrder")}),P=S.filter(D=>{var U,j;return(j=(U=D.data)==null?void 0:U.type)==null?void 0:j.includes("order::Order")}),v=_.map(D=>Lt.buildLimitOrderInfo(D)).filter(D=>D!==void 0).filter(D=>D.status===$e.PartialCompleted||D.status===$e.Running),O=P.map(D=>{var H,$,W,G,de,we,ge,Ce;const U=ve(((H=D.data)==null?void 0:H.type)||""),j=U.type_arguments[0],V=U.type_arguments[1];return{in_coin_type:j,out_coin_type:V,...(W=($=D.data)==null?void 0:$.content)==null?void 0:W.fields,id:(ge=(we=(de=(G=D.data)==null?void 0:G.content)==null?void 0:de.fields)==null?void 0:we.id)==null?void 0:ge.id,version:(Ce=D.data)==null?void 0:Ce.version}}),k=new Set;for(const D of v)k.add(D.pay_coin_type),k.add(D.target_coin_type);for(const D of O)k.add(D.in_coin_type),k.add(D.out_coin_type);await i(Array.from(k));const z=await w(v);a(z);const{activeResult:E,pastResult:M}=await x(O);C.current===(t==null?void 0:t.address)&&(n(E),c(M),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",z),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",O)),u(Array.from(k))}catch(g){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",g)}finally{r(!1),s(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),a([]),n([]),c([])}}}function On(){const{currentAccount:t}=X(),i=re("clmm"),o=re("xcetus"),{buildFarmsPositionType:l,buildBurnPositionType:r}=$t(),{setPosBaseList:a,setFullRangePosBaseList:s,setPosBaseListLoading:n}=xe(),{setVeNFT:c,setVeNFTLoading:u,setLockCetusList:x,clearData:d,setLockCetusListLoading:y,setAvailableXCetusAmount:w}=ne(),{formatPosBaseList:C}=Gt(),L=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{L.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const m=L.current;if(m){n(!0),u(!0);const g=await i.FullClient.getOwnedObjectsByPage(m,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:At.clmm_pool.package_id},{StructType:l},{StructType:r},{StructType:Vs},{StructType:Us}]}});let b=await C(g);a(b),n(!1),(b==null?void 0:b.length)==0&&s([]);const S=Ms(g.data);if(S&&m===L.current){c(S,m);const _=await Ws(g.data,o);_.sort((P,f)=>P.locked_until_time-f.locked_until_time),console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:_,veNFT:S,availableXCetusAmount:je.getAvailableXCetus(S,_)}),x(_),w(je.getAvailableXCetus(S,_))}else y(!1);return{veNFT:S,posBaseList:b}}}catch(m){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",m),m instanceof TypeError&&(n(!1),a([]))}finally{n(!1),y(!1),u(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{a([]),d()}}}function Rn(){const t=re("farms"),i=re("clmm"),{getPosPoolsOriginalObj:o,getPosPoolsRelatedData:l}=qt(),{getPosLiquidityData:r}=Kt(),{setPosLiquidityData:a,setFarmsPosRewardsData:s,setFarmsPosRewardsDataLoading:n,setPosRewardsData:c,setPosRewardsDataLoading:u,setPosFeeData:x,setPosFeeDataLoading:d}=xe(),{formatFarmsRewardsData:y}=Qt(),{formatPosRewardsData:w}=It(),{formatPosFeeData:C}=Yt(),{refreshCoinPriceInfo:L}=Ue(),A=async g=>{var P;const b=g.filter(f=>f.posType==="farms"&&f.farmsPool),S=await o(g);if(l(g,S),((P=Object.keys(S))==null?void 0:P.length)===0)throw a({}),new Error("No pool data found");r(g,S);const _=new Ot;b.length>0&&b.forEach(f=>{t.Farms.buildCalculateFarmingReward({pool_id:f.farmsPool,position_nft_id:f.id},_)}),g.forEach(f=>{i.Position.buildFetchPosFee({pool_id:f.clmmPool,position_id:f.posId,coin_type_a:f.coinTypeA,coin_type_b:f.coinTypeB},_)}),g.filter(f=>f.posType!=="farms").forEach(f=>{var O;const v=S[f.clmmPool];i.Rewarder.buildFetchPosReward({pool_id:f.clmmPool,position_id:f.posId,coin_type_a:f.coinTypeA,coin_type_b:f.coinTypeB,rewarder_types:(O=v.rewarder_infos)==null?void 0:O.map(k=>k.coinAddress)},_)});try{n(!0),u(!0),d(!0);const f=await i.FullClient.devInspectTransactionBlock({transactionBlock:_,sender:Rt("0x0")}),v=t.Farms.parsedPosRewardData(f),O=i.Rewarder.parsedPosRewardData(f),k=i.Position.parsedPosFeeData(f);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:v,clmmRewardData:O,clmmFeeData:k});const z=await y(v);s(z);const E=await w(Object.values(O).map(D=>{const U=S[g.find(j=>j.posId===D.position_id).clmmPool];return{poolAddress:U.pool_address,positionId:D.position_id,rewarderAmountOwed:D.rewarder_amount.map((j,V)=>({coin_address:U.rewarder_infos[V].coinAddress,amount_owed:new Dt(j)}))}}));c(E);const M=await C(Object.values(k).map(D=>({position_id:D.position_id,fee_owned_a:D.fee_owned_a,fee_owned_b:D.fee_owned_b})),g);x(M),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:M,posRewardsData:E,posFarmsRewardsObj:z}),B(g,E,z)}catch(f){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",f)}finally{n(!1),u(!1),d(!1)}},B=async(g,b,S)=>{console.log("ðŸš€ ~ fetchTokenPrice ~ posRewardsData:",g,b);const _=[];if(g.length>0){g.map(f=>{_.push(ve(f==null?void 0:f.coinTypeA).full_address),_.push(ve(f==null?void 0:f.coinTypeB).full_address);const v=b[f==null?void 0:f.posId]||[],O=S[f==null?void 0:f.id]||[],k=v.concat(O);k==null||k.map(z=>{var E;Ht(z==null?void 0:z.display_amount_owed).gt(0)&&_.push(ve((E=z==null?void 0:z.token)==null?void 0:E.coin_type).full_address)})}),console.log("ðŸš€ ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(_)));const P=Array.from(new Set(_));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",P),L(P)}};return{fetchPosRelatedData:A,resetUserData:()=>{a({}),s({}),c({}),x({})}}}function Dn(){const{getVaultsTokenList:t,getVaultsLpTokenList:i}=Ve(),{getVaultsContractInfo:o}=Wt(),{getVaultsPosition:l}=Nt(),{setVaultsPositionLoading:r,clearVaultsPositionObj:a}=be(),{setVaultListLoading:s}=Ee(),{getVaultPoolList:n}=Xt();return{fetchVaultsPositionList:async()=>{r(!0),s(!0);const x=await n();console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:",x),t(x),i(x);const{lstVaultContractInfoObj:d,haedalVaultContractInfoObj:y,allClmmPoolContractInfoObj:w}=await o(x);l(x,d,y,w,!0)},resetUserData:()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileVaults.ts:39 ~ resetUserData ~ clearVaultsPositionObj:",a),a()}}}function Hn(){const{currentAccount:t}=X(),{setXCetusManager:i,setDividendManager:o}=ne(),l=re("xcetus");return{fetchXCetusBaseInfo:async a=>{try{const{xcetus:s,xcetus_dividends:n}=Ft,{dividend_manager_id:c}=Ge(n),{xcetus_manager_id:u}=Ge(s),x=await l.FullClient.batchGetObjects([u,c],{showType:!0,showContent:!0}),d=x.find(w=>{var C,L;return(L=(C=w.data)==null?void 0:C.type)==null?void 0:L.includes("xcetus::XcetusManager")});if(d){const w=qe(d),C={id:w.id.id,index:Number(w.index),has_venft:{handle:w.has_venft.fields.id.id,size:w.has_venft.fields.size},nfts:{handle:w.nfts.fields.id.id,size:w.nfts.fields.size},total_locked:w.total_locked,treasury:w.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",C),i(C)}const y=x.find(w=>{var C,L;return(L=(C=w.data)==null?void 0:C.type)==null?void 0:L.includes("dividend::DividendManager")});if(y){const w=qe(y),C=je.buildDividendManager(w);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",C),l.updateCache(`${c}_getDividendManager`,C),o(C)}}catch(s){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",s)}}}}function Fn(t){const{currentAccount:i}=X(),{fetchCoinHoldingList:o,resetUserData:l}=ft(),{fetchPosRelatedData:r,resetUserData:a}=Rn(),{fetchActiveOrderList:s,resetUserData:n}=An(),{fetchVaultsPositionList:c,resetUserData:u}=Dn(),{setAutoRefreshCount:x}=Y(),{fetchOwnerNFT:d,resetUserData:y}=On(),{fetchXCetusBaseInfo:w}=Hn(),{addTask:C,removeTask:L}=Ns(),[A,B]=p.useState([]),m=p.useRef(i),{setOrderListLoading:g}=ye(),{setLockCetusListLoading:b}=ne(),{setPosBaseListLoading:S}=xe(),{setIsCoinHoldingLoading:_}=Oe(),{setVaultListLoading:P}=Ee(),{setVaultsPositionLoading:f}=be(),v=()=>{l(),a(),n(),y(),u()};p.useEffect(()=>{var j,V;i?((j=m.current)!=null&&j.address&&((V=m.current)==null?void 0:V.address)!==(i==null?void 0:i.address)&&(x(!1),v(),A.forEach(H=>{L(H.id)})),D()):(v(),A.forEach(H=>{L(H.id)})),m.current=i},[i==null?void 0:i.address]);const O={id:vn,run:o},k={id:Tn,run:d,onSuccess:j=>{const{posBaseList:V}=j;r(V)}},z={id:Pn,run:w},E={id:kn,run:s},M={id:Ln,run:c},D=()=>{const j=[];g(!0),b(!0),S(!0),_(!0),f(!0),P(!0),t==="wallet"?j.push(O,k,M,E,z):t==="liquidity"?j.push(k,M,O,E,z):t==="orders"?j.push(E,O,k,M,z):j.push(k,M,z,O,E),B(j),j.forEach(V=>{C(V)})};return{refreshTask:()=>{i&&(A.forEach(j=>{L(j.id)}),D())}}}const Se=t=>t?Z(t,2):"$--",zn=(...t)=>t.reduce((i,o)=>i.plus(o&&+o?o:0),F(0)).toString();function ii(){const{tab:t}=os(),{currentAccount:i,onWalletModal:o}=X(),l=Be(),{posBaseListLoading:r,posLiquidityDataLoading:a}=xe(),{holdingsTotalUsd:s,isCoinPriceLoading:n,isCoinHoldingLoading:c}=Oe(),{liquidityTotalTvl:u}=ts(),{orderTotalTvl:x}=_n(),{orderListLoading:d}=ye(),{isAutoRefresh:y,dcaOrderListLoading:w,setAutoRefreshCount:C,resetAutoRefreshCount:L}=Y(),{xCetusTotalTvl:A}=Sn(),{vaultsPositionLoading:B}=be(),{lockCetusListLoading:m,veNFTLoading:g}=ne(),b=p.useMemo(()=>t,[t]),{refreshTask:S}=Fn(b),_=!y&&(c||n),P=!y&&(r||a||n||B),f=!y&&(d||w||n),v=!y&&(m||g||n),O=p.useMemo(()=>({wallet:{totalValue:Se(s),isLoading:_},liquidity:{totalValue:Se(u),isLoading:P},orders:{totalValue:Se(x),isLoading:f},xCetus:{totalValue:Se(A),isLoading:v}}),[s,u,x,A,_,P,f,v]),k=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],z=p.useMemo(()=>zn(A,u,x,s),[A,u,x,s]);p.useEffect(()=>L(!1),[]);const[E,M]=p.useState(!1);p.useEffect(()=>{M(!0)},[]);const{isApp:D}=Q();return D?e.jsx(Xs,{totalValue:z,onRefreshTask:S,isLoading:!y&&(g||r||d||w),children:e.jsx(Qe,{tabList:k,activeTab:b,tabData:O,onClickTab:U=>l(`/profile?tab=${U}`)})}):e.jsx(R,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:E?i!=null&&i.address?e.jsxs(R,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(an,{handleRefresh:U=>{C(!U),S()},totalValue:z,isLoading:!y&&(g||r||d||w)}),e.jsx(Qe,{tabList:k,activeTab:b,tabData:O,onClickTab:U=>l(`/profile?tab=${U}`)}),b==="wallet"&&e.jsx(xn,{}),b==="liquidity"&&e.jsx(Qs,{}),b==="orders"&&e.jsx(on,{}),b==="xCetus"&&e.jsx(Cn,{})]}):e.jsx(se,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>o(!0)}):e.jsx(Je,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})})})}export{ii as default};
//# sourceMappingURL=Profile-DE65bf8-.js.map

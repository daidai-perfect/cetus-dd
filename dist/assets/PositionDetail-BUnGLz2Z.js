import{a1 as te,r as o,aa as Y,d as z,b as xe,j as e,W as G,m as le,T as n,V as L,H as x,g as P,S as M,as as ae,aA as ce,$ as de,a$ as ue,e as ge,a4 as oe,aO as _e,B as he,az as Se,aQ as Ce,bc as Ae,Y as ve,a as ke,bd as Re,a_ as Le,k as We}from"./index-D49RffYW.js";import{A as Ee}from"./index-BVFwDyvF.js";import{C as Fe}from"./CoinPairInfo-DmtDGhhi.js";import{S as Ve}from"./Slippage-C-5lq2_6.js";import{u as ze,c as He,L as Me,b as Ne,S as I}from"./useGetContractPoolInfo-a8mJ-Bmn.js";import{u as fe,a as Ue,P as Ge}from"./PositionCurrentPrice-BTKiEyAc.js";import{u as ee,a as be}from"./useCurrentPos-CwMCqO3d.js";import{e as Ye,f as Oe,c as J,b as qe}from"./usePositionList-CyCzZNts.js";import{A as je}from"./AddressCopyLink-BnCAac35.js";import{C as $e}from"./CetusTooltip-7TnGbJNH.js";import{u as ye}from"./useAccountBalance-D-weOZgA.js";import{u as De}from"./useTransaction-i5gFyneH.js";import{L as Qe}from"./PriceRange-BFhvNGCl.js";import{P as Je}from"./progress-C8tpxWAq.js";import{L as pe}from"./LockInput-D8hYvbJh.js";import{u as Ke}from"./usePosAdd-vnaoQeks.js";import{T as Xe}from"./TradeInputGroup-C7m7R_Tz.js";import{F as Ze,R as Be}from"./RemoveBlock-Brnm7DVB.js";import{R as Ie}from"./RangeAlerts-CxanDQq5.js";import{T as Pe}from"./TooltipIcon-BGEWyiwk.js";import{P as ei}from"./PositionStatus-Cy2qCSNc.js";import{R as ii}from"./RangeValue-B6IVaqEN.js";import{u as si}from"./index-DDipQFQp.js";import{b as li,u as pi}from"./useGetPoolList-DBJielhS.js";import{R as re}from"./RefreshButton-C1kwCG7k.js";import{u as ai}from"./useRpcListener-D8tK2rVa.js";import"./global-iZ7St_zm.js";import"./index-BzKWeyUu.js";import"./useTokenBalance-Cc02jFZo.js";import"./switch-Dw_sCPfe.js";import"./linear-Cl5vGKe1.js";import"./liquidity-C80wvFzz.js";import"./usePreviousValue-D4m5LJZe.js";import"./ActionButton-CAHJhAqM.js";import"./HTextLabelBox-DVxTk_Ir.js";import"./VTextLabelBox-hTKeBwlM.js";import"./useToken-BlS8b5ft.js";import"./useBurn-BlABJCgq.js";import"./msafe-oYBkW7LJ.js";import"./api-data-utils-D656F-wl.js";import"./AddressUnderline-CPGiMg8E.js";import"./SingleTokenInfo-Cvcahm1q.js";import"./progress.utils-4THQPte7.js";import"./icon_lock@2x-OdzkPjmc.js";import"./useInsufficientBalanceToast-oZJ3kO4O.js";import"./_getAllKeysIn-Caqnu8Ck.js";import"./ExpendItem-Dexzs6Wu.js";import"./useNotifiSubscription-CuqMrTBs.js";import"./useXCetusHelper-wuRv4yeo.js";function ti(){var X,Z,B,$,D,F;const{tokenAmountA:l,tokenAmountB:p,currentPosDetailTab:t,curPosContractPoolInfo:a}=ee(),{getPosFeeData:_}=Ye(),{getPosRewardsData:m}=Oe(),{currentAccount:d}=te(),{currentPosBaseInfo:i,posFeeData:g,posRewardsData:c,posLiquidityData:h,currentPosBaseInfoLoading:v,posFeeDataLoading:w,posRewardsDataLoading:S}=J();be();const s=o.useMemo(()=>h[i==null?void 0:i.posId],[h,i==null?void 0:i.posId]),j=o.useMemo(()=>g[i==null?void 0:i.posId],[g,i==null?void 0:i.posId]),T=o.useMemo(()=>c[i==null?void 0:i.posId],[c,i==null?void 0:i.posId]),y=Y(s==null?void 0:s.displayCoinAmountA,void 0,!0),W=Y(s==null?void 0:s.displayCoinAmountB,void 0,!0),[C,k]=o.useState(!1),[A,V]=o.useState("--"),{signAndExecuteTransaction:u}=De(),{getPosClaimFeeAndRewardTxPayload:E}=fe(),{calculatePendingYield:N}=Ue();o.useEffect(()=>{if(!v&&!w&&!S){const{total:b}=N([i],g,c);V(b)}},[v,w,S]);const{fetchAccountBalance:R}=ye(),H=async()=>{k(!0);try{const b=(T==null?void 0:T.map(se=>se.coin_address))||[],ie={posType:i==null?void 0:i.posType,id:i==null?void 0:i.id,clmmPool:i==null?void 0:i.clmmPool,coinTypeA:i==null?void 0:i.coinTypeA,coinTypeB:i==null?void 0:i.coinTypeB,rewarderCoinTypes:b,account:d==null?void 0:d.address},{tx:we,msafeParams:Te}=await E(ie);await u(we,{getShowInfo:se=>{const ne={modalDescriptionText:"",toastTitleText:""};return se==="success"&&(ne.toastTitleText="Claim Successful"),ne}},{msafeParams:Te})&&setTimeout(()=>{R(),_([i]),m([i],{[a.poolAddress]:a})},2e3),k(!1)}catch{k(!1)}},f=l!==""||p!=="",U=z(+y).sub(+l).toString(),O=f?z(y).eq(0)?"0":t=="increase"?z(l).plus(y).toString():z(U).gt(0)?U:"0":"",q=z(+W).sub(+p).toString(),K=f?z(W).eq(0)?"0":t=="increase"?z(p).plus(W).toString():z(q).gt(0)?q:"0":"",{isApp:r}=xe();return e.jsxs(G,{w:"100%",borderRadius:"16px",p:"0",children:[e.jsx(G,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"auto",lg:"80px"},p:{base:"20px 8px",lg:"20px 20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(le,{flexDir:{base:"column",lg:"row"},w:"100%",justify:{base:"center",lg:"space-between"},gap:{base:"16px",lg:"0"},children:[e.jsxs(le,{flexDir:{base:"row",lg:"column"},align:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},mt:{base:"-12px",lg:"0"},children:[e.jsx(n,{color:"primary_gray",mb:{base:"0",lg:"-12px"},children:"Liquidity"}),e.jsx(Qe,{positionInfo:i,haveTooltip:!1})]}),e.jsxs(L,{minW:"200px",align:{base:"center",lg:"flex-end"},pb:{base:"0",lg:"12px"},gap:"12px",children:[e.jsxs(x,{w:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(x,{gap:"4px",children:[e.jsx(P,{imageUrl:(X=i==null?void 0:i.displayTokenA)==null?void 0:X.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?(Z=i==null?void 0:i.displayTokenA)==null?void 0:Z.coin_type:""}),e.jsx(M,{isLoaded:!!i&&!!s,children:e.jsxs(x,{gap:"4px",children:[e.jsx(n,{color:"primary",children:ae((B=i==null?void 0:i.displayTokenA)==null?void 0:B.symbol)}),e.jsxs(n,{color:"primary",children:[s==null?void 0:s.displayPercentA,"%"]})]})})]}),e.jsxs(x,{gap:"4px",children:[e.jsx(P,{imageUrl:($=i==null?void 0:i.displayTokenB)==null?void 0:$.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?(D=i==null?void 0:i.displayTokenB)==null?void 0:D.coin_type:""}),e.jsx(M,{isLoaded:!!i&&!!s,children:e.jsxs(x,{gap:"4px",children:[e.jsx(n,{color:"primary_green",children:ae((F=i==null?void 0:i.displayTokenB)==null?void 0:F.symbol)}),e.jsxs(n,{color:"primary_green",children:[s==null?void 0:s.displayPercentB,"%"]})]})})]})]}),e.jsx(Je,{w:"200px",h:"4px",value:s==null?void 0:s.displayPercentA,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})}),e.jsxs(x,{gap:{base:"20px",lg:"8px"},p:{base:"20px 8px",lg:"40px 8px"},w:"100%",justify:"space-around",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Base",token:i==null?void 0:i.displayTokenA,amount:s==null?void 0:s.displayCoinAmountA,afterAmount:O}),e.jsx(Q,{label:"Quote",token:i==null?void 0:i.displayTokenB,amount:s==null?void 0:s.displayCoinAmountB,afterAmount:K})]}),e.jsx(G,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"70px",lg:"80px"},p:{base:"20px 8px",lg:"20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(x,{w:"100%",justify:"space-between",children:[e.jsxs(le,{flexDir:{base:"row",lg:"column"},alignItems:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},w:{base:"100%",lg:"auto"},children:[e.jsx(n,{color:"primary_gray",children:"Pending Yield"}),e.jsx(M,{isLoaded:!!A&&!!i&&!!g&&!!c,children:e.jsx(n,{color:"text_caption",fontSize:"16px",children:ce(A,2)})})]}),e.jsx(de,{isLoading:C,disabled:Number(A)==0||w||S||C||!j,onClick:H,w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",children:"Claim"})]})}),e.jsxs(x,{p:{base:"20px 8px 0",lg:"40px 8px 20px"},w:"100%",justify:"space-between",flexWrap:"wrap",sx:{">div":{mb:{base:"12px",lg:"20px"}}},flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Fees",token:i==null?void 0:i.displayTokenA,amount:j==null?void 0:j.displayFeeOwedA,afterAmount:f?"0":""}),e.jsx(Q,{label:r?"":"Fees",token:i==null?void 0:i.displayTokenB,amount:j==null?void 0:j.displayFeeOwedB,afterAmount:f?"0":""}),T==null?void 0:T.map((b,ie)=>e.jsx(ue.Fragment,{children:z(b.amount_owed).gt(0)&&e.jsx(Q,{label:r?ie==0?"Mining Rewards":"":"Mining Rewards",token:b==null?void 0:b.token,amount:b==null?void 0:b.display_amount_owed,afterAmount:f?"0":""})},b==null?void 0:b.coin_address))]})]})}const Q=({label:l,token:p,amount:t,afterAmount:a,isLoading:_})=>{const{isApp:m}=xe(),{getExplorerUrl:d}=ge();return e.jsxs(L,{align:{base:"flex-end",lg:"center"},gap:{base:"4px",lg:"8px"},w:{base:"100%",lg:"calc(50% - 4px)"},children:[e.jsxs(x,{w:"100%",justify:{base:"space-between"},flexDirection:{base:"row",lg:"column"},children:[e.jsx(n,{color:"primary_gray",children:l}),e.jsxs(x,{children:[e.jsx($e,{showTooltip:!m,placement:"top",tooltip:e.jsxs(x,{children:[e.jsx(P,{imageUrl:p==null?void 0:p.logo_url,w:"20px",h:"20px",minH:"20px",minW:"20px",showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:""}),e.jsx(n,{color:"text_caption",children:p==null?void 0:p.symbol}),e.jsx(je,{address:p==null?void 0:p.coin_type,onClickLink:()=>window.open(d(p==null?void 0:p.coin_type,"coin"))})]}),children:e.jsx(P,{imageUrl:p==null?void 0:p.logo_url,w:{base:"20px",lg:"28px"},h:{base:"20px",lg:"28px"},minH:{base:"20px",lg:"28px"},minW:{base:"20px",lg:"28px"},showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:"",onClick:m?()=>window.open(d(p==null?void 0:p.coin_type,"coin")):()=>{}})}),e.jsx(M,{isLoaded:!_&&!!t,children:e.jsx(n,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:Y(t)})}),e.jsx(n,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:ae(p==null?void 0:p.symbol)})]})]}),a!==""&&a&&e.jsxs(x,{bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(n,{color:"primary",children:Y(a)}),e.jsx(n,{color:"primary",children:"after"})]})]})};function xi(){const{currentPosBaseInfo:l,posPoolsRelatedData:p}=J(),{currentAccount:t,onWalletModal:a}=te(),{tokenAmountA:_,tokenAmountB:m,isFixedDisplayTokenA:d,curPosContractPoolInfo:i}=ee(),{displayTokenA:g,displayTokenB:c,tokenABalanceInfo:h,tokenBBalanceInfo:v,tokenAmountValueA:w,tokenAmountValueB:S,handleAmountChange:s,preAddLoading:j,btnStatusText:T,toAdd:y,isAddLoading:W,showDisplayTokenALock:C,showDisplayTokenBLock:k,resetInputAmount:A}=Ke();o.useEffect(()=>()=>{A()},[]);const{getTokenAmountValue:V}=oe(),u=V(g==null?void 0:g.coin_type,_,"--"),E=V(c==null?void 0:c.coin_type,m,"--"),N=u=="--"||E=="--"?"--":_e(w).plus(S).toString(),R=p[l==null?void 0:l.posId];return e.jsxs(L,{w:"100%",gap:"8px",children:[e.jsxs(he,{w:"100%",position:"relative",children:[e.jsx(Xe,{from:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(h==null?void 0:h.balanceFormat)||"",value:_,amountValue:w,loading:!d&&j,onChange:H=>{s(H,!0)},placeholder:"0.0",token:g},to:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(v==null?void 0:v.balanceFormat)||"",value:m,amountValue:S,loading:d&&j,onChange:H=>{s(H,!1)},placeholder:"0.0",token:c},iconParams:C||k?void 0:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),(!l||!i)&&e.jsx(pe,{position:"absolute",top:"0px",left:"0",borderRadius:"12px",h:"224px",zIndex:9999}),l&&(l==null?void 0:l.posType)=="burn"&&e.jsx(pe,{position:"absolute",top:"0px",left:"0",h:"224px",borderRadius:"12px",text:"Your liquidity has been permanently locked",zIndex:9999}),l&&i&&(C||k)&&e.jsx(pe,{position:"absolute",top:C?"0px":"116px",borderRadius:"12px",h:"108px",left:"0"})]}),e.jsx(de,{onClick:()=>{t?y():a(!0)},isLoading:W,disabled:T.disabled||W,w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:T.text}),+N&&e.jsx(G,{borderRadius:"0 0 12px 12px",pt:"36px",mt:"-28px",children:e.jsxs(x,{w:"100%",justify:"space-between",children:[e.jsx(n,{children:"Total Amount"}),e.jsx(n,{color:"text_caption",children:ce(N,2)})]})}),(l==null?void 0:l.posType)!=="burn"&&e.jsx(Ze,{}),R&&(R==null?void 0:R.minPrice)!=="0"&&(R==null?void 0:R.maxPrice)!=="∞"&&e.jsx(Ie,{subscriptionSource:"PositionDetail"})]})}function di(){const{currentPosBaseInfo:l}=J(),{currentPosPoolInfo:p,curPosContractPoolInfo:t}=ee(),{setContractPoolInfo:a,setApiPoolInfo:_}=si(),{lowerTickData:m,upperTickData:d,setLowerTickData:i,setUpperTickData:g}=ze();Se(()=>{_(p)},[p]);const c=(w,S,s)=>{var V,u;const j=(V=s==null?void 0:s.tokenA)==null?void 0:V.decimals,T=(u=s==null?void 0:s.tokenB)==null?void 0:u.decimals;let y;Math.abs(w)==Math.abs(Ce.getMinIndex(Number(s.tickSpacing)))?y=S==="lower"?"0":"∞":y=Ae.tickIndexToPrice(w,j,T).toString();const W=y==="∞"?"∞":Y(y,6),C=li(y),k=C==="∞"?"∞":Y(C,6),A={id:S,tokenA:s==null?void 0:s.tokenA,tokenB:s==null?void 0:s.tokenB,tick:w,price:y,displayPrice:W,reversePrice:C,displayReversePrice:k,tickSpacing:s==null?void 0:s.tickSpacing,pool:s==null?void 0:s.poolAddress};S==="lower"?i({...A}):g({...A})},{getCurrentPrice:h}=He();o.useEffect(()=>{l!=null&&l.lowerTick&&(t!=null&&t.current_sqrt_price)&&(p!=null&&p.poolAddress)&&(c(l==null?void 0:l.lowerTick,"lower",p),c(l==null?void 0:l.upperTick,"upper",p),h(t==null?void 0:t.current_sqrt_price,p),a(t))},[l==null?void 0:l.lowerTick,t==null?void 0:t.current_sqrt_price,p==null?void 0:p.poolAddress]);const v=o.useMemo(()=>(l==null?void 0:l.posId)&&(m==null?void 0:m.pool)&&(d==null?void 0:d.pool),[m==null?void 0:m.pool,d==null?void 0:d.pool,l==null?void 0:l.posId]);return e.jsx(he,{className:"chart-block",w:{base:"100%",lg:"200px"},h:"85px",mb:"8px",overflow:"hidden",children:v&&e.jsx(Me,{isFrom:"position",handleClickRefresh:()=>{},direct:!(l!=null&&l.isReverse),minPriceData:l!=null&&l.isReverse?d:m,maxPriceData:l!=null&&l.isReverse?m:d,readonly:!0})})}function ni(){const{currentPosBaseInfo:l,posPoolsRelatedData:p,posPoolsOriginalData:t}=J(),a=p[l==null?void 0:l.posId],{getClmmPosName:_}=qe(),m=o.useMemo(()=>{var c;if(l!=null&&l.tokenName)return l==null?void 0:l.tokenName;{const h=(c=t==null?void 0:t[l==null?void 0:l.clmmPool])==null?void 0:c.index;return _(l==null?void 0:l.index,h)}},[l==null?void 0:l.tokenName,l==null?void 0:l.index,l==null?void 0:l.clmmPool,t]);(a==null?void 0:a.displayFee)+"";const d=(a==null?void 0:a.currentStatus)=="Active",i=o.useMemo(()=>{const c=a==null?void 0:a.minPriceOrigin,h=a==null?void 0:a.maxPriceOrigin;return c!=="0"&&h!=="∞"?ve(1/(1-Number((c/h)**.25)),2)+"x":"1x"},[a==null?void 0:a.minPriceOrigin,a==null?void 0:a.maxPriceOrigin]),{getExplorerUrl:g}=ge();return e.jsxs(G,{w:"100%",borderRadius:"20px 20px 16px 16px",children:[e.jsx(G,{p:{base:"16px 8px",lg:"16px"},w:"calc(100% + 34px)",ml:"-17px",mt:"-21px",bg:"bg_primary",children:e.jsxs(x,{justify:"space-between",children:[e.jsxs(x,{h:{base:"40px",lg:"32px"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(n,{children:"Position ID"}),e.jsx(M,{isLoaded:!!m,children:e.jsx(n,{color:"text_caption",children:m==null?void 0:m.split("|")[1]})})]}),e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(n,{children:"Position NFT"}),e.jsx(M,{isLoaded:!!(l!=null&&l.id),children:e.jsx(je,{fontWeight:"500",color:"text_caption",fontSize:"14px",address:l==null?void 0:l.id,showLink:!1,onClickLink:()=>{window.open(g(l==null?void 0:l.id,"nftAddress"),"_blank")}})})]})]}),a&&e.jsx(ei,{isActive:d,isLoading:(a==null?void 0:a.currentStatus)=="",h:"32px",p:"0 12px",w:"unset",isRow:!0,imgStyle:{imgW:"30px",imgH:"16px"}})]})}),e.jsxs(x,{gap:{base:"20px",lg:"8px"},w:"100%",justify:"space-between",p:"28px 0 20px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(L,{gap:{base:"16px",lg:"32px"},children:[e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(n,{color:"primary_gray",children:"Current Price"}),e.jsx(Ge,{posId:(l==null?void 0:l.posId)||"",displayTokenA:l==null?void 0:l.displayTokenA,displayTokenB:l==null?void 0:l.displayTokenB})]}),e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(n,{color:"primary_gray",children:"Position Range"}),e.jsx(ii,{displayTokenA:l==null?void 0:l.displayTokenA,displayTokenB:l==null?void 0:l.displayTokenB,justify:"center",priceInfo:{minPrice:a==null?void 0:a.minPrice,maxPrice:a==null?void 0:a.maxPrice,minPriceResever:a==null?void 0:a.minPriceResever,maxPriceResever:a==null?void 0:a.maxPriceResever},fontSize:"14px"})]})]}),e.jsxs(L,{gap:"0",children:[e.jsx(di,{}),e.jsx(L,{zIndex:"9",children:e.jsxs(x,{gap:"2px",bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(n,{color:"primary",fontSize:"12px",children:"Leverage"}),e.jsx(Pe,{type:"leverage"}),e.jsx(M,{ml:"4px",isLoaded:!!i&&!!a,children:e.jsx(n,{color:"primary",children:i})})]})})]})]})]})}function ts(){var q,K;const l=ke(),{fetchAccountBalance:p}=ye(),{currentAccount:t}=te(),{position_nft_id:a}=Re(),{getCurrentPosBaseInfo:_,getCurrentPosHistory:m}=be(),{currentPosDetailTab:d,currentPosPoolInfo:i,setCurrentPosDetailTab:g,setCurrentPosPoolInfo:c,setCurrentPoolSqrtPrice:h,setCurPosContractPoolInfo:v,setIsPosDetailRefresh:w}=ee(),{posPoolsRelatedData:S,currentPosBaseInfo:s,setCurrentPosBaseInfo:j,farmsPosRewardsData:T,posRewardsData:y}=J(),W=(((q=S[s==null?void 0:s.posId])==null?void 0:q.displayFee)||"--")+"%",C=[{label:"Increase",value:"increase"},{label:"Remove",value:"remove"}],k=()=>{w(!0),A(!0),H(),N(),p(),U(),setTimeout(()=>{w(!1)},1e3)},A=(r=!1)=>{t!=null&&t.address&&a&&_(t==null?void 0:t.address,a,r)};o.useEffect(()=>{A()},[t==null?void 0:t.address,a]),o.useEffect(()=>{},[s==null?void 0:s.id]);const{fetchTokenPrices:V}=oe(),u=T[s==null?void 0:s.id],E=y[s==null?void 0:s.posId],N=()=>{var $,D;const r=(E==null?void 0:E.map(F=>F==null?void 0:F.coin_address))||[],X=(u==null?void 0:u.map(F=>F==null?void 0:F.rewarder_type))||[],Z=[($=s==null?void 0:s.tokenA)==null?void 0:$.coin_type,(D=s==null?void 0:s.tokenB)==null?void 0:D.coin_type].filter(Boolean),B=Array.from(new Set([...r,...Z,...X]));V(B)};o.useEffect(()=>{N()},[s==null?void 0:s.posId,E==null?void 0:E.length,u==null?void 0:u.length]);const{getPoolList:R}=pi(),H=async()=>{if(!(s!=null&&s.clmmPool))return;const r=await R({pool:s==null?void 0:s.clmmPool});if(r)return c(r==null?void 0:r.list[0])},{getContractPoolInfo:f}=Ne(),U=async()=>{if(s!=null&&s.clmmPool){const r=await f(s==null?void 0:s.clmmPool);r&&(h(r.current_sqrt_price),v(r))}};o.useEffect(()=>{H(),U();let r;return s!=null&&s.clmmPool&&(r=setInterval(()=>{U()},2e4)),()=>{clearInterval(r)}},[s==null?void 0:s.clmmPool]),o.useEffect(()=>(g("increase"),t!=null&&t.address&&p(),()=>{v(null),j(null),c(null)}),[]),ai({onRpcChange:()=>{A(!0),U(),t!=null&&t.address&&p()}});const{isApp:O}=xe();return e.jsxs(L,{gap:"12px",w:"100%",pt:"20px",align:"flex-start",children:[e.jsxs(x,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(x,{w:{base:"100%",lg:"unset"},justifyContent:"space-between",children:[e.jsx(Le,{}),O&&e.jsxs(x,{children:[e.jsx(me,{}),e.jsx(re,{handleRefresh:k,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(x,{w:{base:"100%",lg:"unset"},children:[e.jsx(de,{w:{base:"100%",lg:"unset"},bg:"bg_secondary",fontSize:"14px",p:"0 16px",h:"32px",borderRadius:"8px",fontWeight:"500",variant:"outline",onClick:r=>{l(`/liquidity?poolAddress=${s==null?void 0:s.clmmPool}`)},children:"Create a new position"}),!O&&e.jsx(re,{handleRefresh:k,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(x,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(M,{w:{base:"100%",lg:"unset"},isLoaded:!!(s!=null&&s.clmmPool),children:e.jsx(Fe,{symbolFontWeight:"600",haveName:!0,poolInfo:{feeDisplay:W,poolAddress:s==null?void 0:s.clmmPool,...s},symbolEllipsesDecimals:10,nameEllipsesDecimals:20,placement:"bottom-start"})}),e.jsxs(x,{w:{base:"100%",lg:"unset"},gap:{base:"12px",lg:"28px"},flexDirection:{base:"column",lg:"row"},children:[e.jsx(I,{label:"Pool APR",value:e.jsx(Ee,{poolInfo:i,children:e.jsxs(x,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsx(n,{as:"span",fontSize:"14px",color:"text_caption",fontWeight:"500",cursor:i!=null&&i.farmingAprDisplay||((K=i==null?void 0:i.miningAprList)==null?void 0:K.length)>0?"help":"text",children:i==null?void 0:i.feeAndMiningAprDisplay}),(i==null?void 0:i.haveFarming)&&e.jsxs(n,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",i==null?void 0:i.farmingAprDisplay]})]})}),loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"TVL",value:(i==null?void 0:i.tvlDisplay)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"Volume (24H)",value:(i==null?void 0:i.volume24Display)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"Fees (24H)",value:(i==null?void 0:i.fees24Display)||"",loading:!(i!=null&&i.poolAddress)})]})]}),e.jsxs(x,{w:"100%",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(L,{w:{base:"100%",lg:"60%"},gap:"8px",children:[e.jsx(ni,{}),e.jsx(ti,{})]},`${s==null?void 0:s.posId}-posInfo`),e.jsxs(L,{w:{base:"100%",lg:"40%"},children:[e.jsx(G,{p:"0",borderRadius:"12px",children:e.jsxs(x,{w:"100%",p:"0 16px",children:[e.jsx(We,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{w:{base:"50%",lg:"unset"},fontSize:"16px",mr:"28px"},tabList:C,currentTab:d=="increase"?"Increase":"Remove",handleChangeTab:r=>{g(r==null?void 0:r.value)}}),!O&&e.jsx(me,{})]})}),d=="increase"&&e.jsx(xi,{}),d=="remove"&&e.jsx(Be,{})]})]})]})}const me=()=>e.jsx(x,{children:e.jsx(Ve,{})});export{ts as default};

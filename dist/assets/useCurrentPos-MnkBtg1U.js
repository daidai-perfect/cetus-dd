import{a as H,g as I,b as L}from"./usePositionList-CIC4JxMO.js";import{R as h,aK as w}from"./index-BcaxaUt8.js";const A=(t,l)=>({isPosDetailRefresh:!1,setIsPosDetailRefresh:o=>{t(()=>({isPosDetailRefresh:o}))},isPosHistoryLoading:!0,setIsPosHistoryLoading:o=>{t(()=>({isPosHistoryLoading:o}))},curPosHistoryList:[],setCurPosHistoryList:o=>{t(()=>({curPosHistoryList:o}))},currentPosDetailTab:"increase",setCurrentPosDetailTab:o=>{t(()=>({currentPosDetailTab:o}))},tokenAmountA:"",setTokenAmountA:o=>{t(()=>({tokenAmountA:o}))},tokenAmountB:"",setTokenAmountB:o=>{t(()=>({tokenAmountB:o}))},isFixedDisplayTokenA:!0,setIsFixedDisplayTokenA:o=>{t(()=>({isFixedDisplayTokenA:o}))},slideValue:"--",setSlideValue:o=>{t(()=>({slideValue:o}))},currentPosPoolInfo:null,setCurrentPosPoolInfo:o=>{t(()=>({currentPosPoolInfo:o}))},currentPoolSqrtPrice:"",setCurrentPoolSqrtPrice:o=>{t(()=>({currentPoolSqrtPrice:o}))},curPosContractPoolInfo:null,setCurPosContractPoolInfo:o=>{t(()=>({curPosContractPoolInfo:o}))}}),B=h(A);function S(){const{clmmSdk:t}=w(),{posBaseList:l,setCurrentPosBaseInfo:o,setCurrentPosBaseInfoLoading:g}=H(),{setCurPosHistoryList:m,setIsPosHistoryLoading:P}=B(),{buildPosBaseInfo:d}=I(),{getPosRelatedData:C}=L(),p=async(a,e,r=!1)=>{g(!0);const i=l.find(s=>s.id===e);let n;i&&!r?n=i:n=await f(a,e),console.log("getCurrentPosBaseInfo ~ posInfo:",n),o(n),n&&C([n])},f=async(a,e)=>{const r=await t.fullClient.getOwnedObjectsByPage(a,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{ObjectId:e}});return r&&r.data&&r.data.length>0?d(r.data[0]):null},y=async(a,e)=>{var i;const r=["https://mainnet.suiet.app:443","https://rpc-mainnet.suiscan.xyz:443"];for(const n of r)try{const s=await t.Position.getPositionTransactionList({posId:a,fullRpcUrl:n,originPosId:e,order:"descending"});if(console.log("ðŸš€ ~ getCurrentPosHistory ~ response?.data:",s==null?void 0:s.data,n),((i=s==null?void 0:s.data)==null?void 0:i.length)>0)return s.data}catch(s){console.error(`Error fetching data from ${n}:`,s)}return[]};return{getCurrentPosBaseInfo:p,getCurrentPosHistory:async(a,e)=>{console.log("ðŸš€ ~ getCurrentPosHistory ~ posId:",a,e),P(!0);const r=await y(a,e),i=a.toLowerCase()!==e.toLowerCase()?await y(e,e):[];console.log("ðŸš€ ~ getCurrentPosHistory ~ clmmHistory:",r,i,[...r,...i]);const s=[...r,...i].sort((c,u)=>(u==null?void 0:u.timestampMs)-(c==null?void 0:c.timestampMs));m(s),P(!1),console.log("ðŸš€ ~ getCurrentPosHistory ~ result:",s)},getCurrentPosByPosId:f}}export{S as a,B as u};

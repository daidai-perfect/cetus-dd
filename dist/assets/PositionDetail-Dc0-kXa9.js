import{a0 as pe,r as j,a9 as Y,d as z,b as te,j as e,U as D,l as se,T as c,V as L,H as n,c as ce,S as M,aL as ae,aC as be,Z as xe,b8 as Se,e as je,B as de,a3 as ye,aR as Ce,aQ as _e,aT as ve,b9 as Ae,X as ue,a as Re,ba as Le,a8 as re,b2 as Fe,i as Ee}from"./index-BMYxc9Od.js";import{A as We}from"./index-Dbc2tu1I.js";import{C as Ve}from"./CoinPairInfo-B6xbyLw9.js";import{S as ze}from"./Slippage-BHfkGKpx.js";import{a as Me,d as He,L as Ne,c as De,S as I}from"./useGetContractPoolInfo-BCjo8ULW.js";import{u as fe,a as Ge,P as Ue}from"./PositionCurrentPrice-Dfxi9Q7k.js";import{u as P,a as we}from"./useCurrentPos-BnGJCwf6.js";import{c as Ye,d as qe,a as X,u as Oe}from"./usePositionList-CqhidtZG.js";import{u as Te}from"./useAccountBalance-7Ju_sYta.js";import{u as $e}from"./useTransaction-CfK3pLEn.js";import{S as Qe,A as Xe}from"./SingleTokenInfo-YXdPNl3G.js";import{L as Ze}from"./PriceRange-BiZddocv.js";import{P as Je}from"./progress-qOaxYcSf.js";import{L as le}from"./LockInput-DRQ1QGli.js";import{u as Ke}from"./usePosAdd-BVUrQu-D.js";import{T as Be}from"./TradeInputGroup-DZEf1SXK.js";import{F as Ie,R as Pe}from"./RemoveBlock-CzkZMNE2.js";import{R as ei}from"./RangeAlerts-0o1wc_Y3.js";import{T as ii}from"./TooltipIcon-ByUA4JrQ.js";import{P as si}from"./PositionStatus-BWThaEyG.js";import{R as li}from"./RangeValue-Cv8ui1Wd.js";import{u as ai}from"./index-CbiH6bwv.js";import{b as pi,u as ti}from"./useGetPoolList-DKPSLTZh.js";import{u as xi}from"./swapWidget-CEDEOiPt.js";import{R as ge}from"./RefreshButton-BJxOoBp4.js";import{u as di}from"./useRpcListener-BR_hP-SR.js";import"./PoweredByHaedal-B3ifw1QO.js";import"./global-VD-aBjBV.js";import"./index-CJXWYa_3.js";import"./useTokenBalance-Cj_lT5nh.js";import"./linear-DYpwdEgO.js";import"./liquidity-DrWzbeFU.js";import"./usePreviousValue-B64GMDoH.js";import"./ActionButton-Dr1zwxoh.js";import"./HTextLabelBox-DAS3uNTR.js";import"./VTextLabelBox-C4n_Ly5H.js";import"./useToken-Bvs0Ung1.js";import"./useBurn-BFQu7S5q.js";import"./msafe-oYBkW7LJ.js";import"./useFavoritePool-CFeoAJA1.js";import"./api-data-utils-Ddy-a3WS.js";import"./AddressUnderline-Bhd4IXQA.js";import"./progress.utils-CSV6fYbb.js";import"./useInsufficientBalanceToast-CfqXK2Kq.js";import"./_getAllKeysIn-DYEwfs_x.js";import"./ExpendItem-BTLpZv6m.js";import"./useNotifiSubscription-D71-OFDa.js";import"./useXCetusHelper-D802DwcO.js";function ni(){var O,$,m,J,K,B;const{tokenAmountA:i,tokenAmountB:d,currentPosDetailTab:x,curPosContractPoolInfo:p}=P(),{getPosFeeData:_}=Ye(),{getPosRewardsData:o}=qe(),{currentAccount:a}=pe(),{currentPosBaseInfo:s,posFeeData:h,posRewardsData:r,posLiquidityData:b,currentPosBaseInfoLoading:R,posFeeDataLoading:v,posRewardsDataLoading:l}=X();we();const t=j.useMemo(()=>b[s==null?void 0:s.posId],[b,s==null?void 0:s.posId]),y=j.useMemo(()=>(console.log("ðŸš€ ~ currentPosFeeData ~ posFeeData[currentPosBaseInfo?.posId as string]:",h[s==null?void 0:s.posId]),h[s==null?void 0:s.posId]),[h,s==null?void 0:s.posId]),k=j.useMemo(()=>(console.log("ðŸš€ ~ currentPosRewardsData ~ posRewardsData[currentPosBaseInfo?.posId as string]:",r[s==null?void 0:s.posId]),r[s==null?void 0:s.posId]),[r,s==null?void 0:s.posId]),w=Y(t==null?void 0:t.displayCoinAmountA,void 0,!0),F=Y(t==null?void 0:t.displayCoinAmountB,void 0,!0),[S,A]=j.useState(!1),[E,T]=j.useState("--"),{signAndExecuteTransaction:C}=$e(),{getPosClaimFeeAndRewardTxPayload:f}=fe(),{calculatePendingYield:G}=Ge();j.useEffect(()=>{if(!R&&!v&&!l){const{total:g}=G([s],h,r);T(g)}},[R,v,l]);const{fetchAccountBalance:u}=Te(),H=async()=>{A(!0);try{const g=(k==null?void 0:k.map(ie=>ie.coin_address))||[],N={posType:s==null?void 0:s.posType,id:s==null?void 0:s.id,clmmPool:s==null?void 0:s.clmmPool,coinTypeA:s==null?void 0:s.coinTypeA,coinTypeB:s==null?void 0:s.coinTypeB,rewarderCoinTypes:g,account:a==null?void 0:a.address};console.log("ðŸš€ ~ toClaim ~ params.currentPosBaseInfo:",N,s);const{tx:V,msafeParams:ke}=await f(N);console.log("ðŸš€ ~ toClaim ~ tx:",V);const oe=await C(V,{getShowInfo:ie=>{const me={modalDescriptionText:"",toastTitleText:""};return ie==="success"&&(me.toastTitleText="Claim Successful"),me}},{msafeParams:ke});console.log("ðŸš€ ~ toClaim ~ res:",oe),oe&&setTimeout(()=>{u(),_([s]),o([s],{[p.poolAddress]:p})},2e3),A(!1)}catch(g){A(!1),console.log("ðŸš€ ~ toClaim ~ error:",g)}},W=i!==""||d!=="",q=z(+w).sub(+i).toString(),Z=W?z(w).eq(0)?"0":x=="increase"?z(i).plus(w).toString():z(q).gt(0)?q:"0":"",ee=z(+F).sub(+d).toString(),ne=W?z(F).eq(0)?"0":x=="increase"?z(d).plus(F).toString():z(ee).gt(0)?ee:"0":"",{isApp:U}=te();return e.jsxs(D,{w:"100%",borderRadius:"16px",p:"0",children:[e.jsx(D,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"auto",lg:"80px"},p:{base:"20px 8px",lg:"20px 20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(se,{flexDir:{base:"column",lg:"row"},w:"100%",justify:{base:"center",lg:"space-between"},gap:{base:"16px",lg:"0"},children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},align:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},mt:{base:"-12px",lg:"0"},children:[e.jsx(c,{color:"primary_gray",mb:{base:"0",lg:"-12px"},children:"Liquidity"}),e.jsx(Ze,{positionInfo:s,haveTooltip:!1})]}),e.jsxs(L,{minW:"200px",align:{base:"center",lg:"flex-end"},pb:{base:"0",lg:"12px"},gap:"12px",children:[e.jsxs(n,{w:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(n,{gap:"4px",children:[e.jsx(ce,{imageUrl:(O=s==null?void 0:s.displayTokenA)==null?void 0:O.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:s?($=s==null?void 0:s.displayTokenA)==null?void 0:$.coin_type:""}),e.jsx(M,{isLoaded:!!s&&!!t,children:e.jsxs(n,{gap:"4px",children:[e.jsx(c,{color:"primary",children:ae((m=s==null?void 0:s.displayTokenA)==null?void 0:m.symbol)}),e.jsxs(c,{color:"primary",children:[t==null?void 0:t.displayPercentA,"%"]})]})})]}),e.jsxs(n,{gap:"4px",children:[e.jsx(ce,{imageUrl:(J=s==null?void 0:s.displayTokenB)==null?void 0:J.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:s?(K=s==null?void 0:s.displayTokenB)==null?void 0:K.coin_type:""}),e.jsx(M,{isLoaded:!!s&&!!t,children:e.jsxs(n,{gap:"4px",children:[e.jsx(c,{color:"primary_green",children:ae((B=s==null?void 0:s.displayTokenB)==null?void 0:B.symbol)}),e.jsxs(c,{color:"primary_green",children:[t==null?void 0:t.displayPercentB,"%"]})]})})]})]}),e.jsx(Je,{w:"200px",h:"4px",value:t==null?void 0:t.displayPercentA,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})}),e.jsxs(n,{gap:{base:"20px",lg:"8px"},p:{base:"20px 8px",lg:"40px 8px"},w:"100%",justify:"space-around",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Base",token:s==null?void 0:s.displayTokenA,amount:t==null?void 0:t.displayCoinAmountA,afterAmount:Z}),e.jsx(Q,{label:"Quote",token:s==null?void 0:s.displayTokenB,amount:t==null?void 0:t.displayCoinAmountB,afterAmount:ne})]}),e.jsx(D,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"70px",lg:"80px"},p:{base:"20px 8px",lg:"20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},alignItems:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},w:{base:"100%",lg:"auto"},children:[e.jsx(c,{color:"primary_gray",children:"Pending Yield"}),e.jsx(M,{isLoaded:!!E&&!!s&&!!h&&!!r,children:e.jsx(c,{color:"text_caption",fontSize:"16px",children:be(E,2)})})]}),e.jsx(xe,{isLoading:S,disabled:Number(E)==0||v||l||S||!y,onClick:H,w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",children:"Claim"})]})}),e.jsxs(n,{p:{base:"20px 8px 0",lg:"40px 8px 20px"},w:"100%",justify:"space-between",flexWrap:"wrap",sx:{">div":{mb:{base:"12px",lg:"20px"}}},flexDirection:{base:"column",lg:"row"},children:[e.jsx(Q,{label:"Fees",token:s==null?void 0:s.displayTokenA,amount:y==null?void 0:y.displayFeeOwedA,afterAmount:W?"0":""}),e.jsx(Q,{label:U?"":"Fees",token:s==null?void 0:s.displayTokenB,amount:y==null?void 0:y.displayFeeOwedB,afterAmount:W?"0":""}),k==null?void 0:k.map((g,N)=>e.jsx(Se.Fragment,{children:z(g.amount_owed).gt(0)&&e.jsx(Q,{label:U?N==0?"Mining Rewards":"":"Mining Rewards",token:g==null?void 0:g.token,amount:g==null?void 0:g.display_amount_owed,afterAmount:W?"0":""})},g==null?void 0:g.coin_address))]})]})}const Q=({label:i,token:d,amount:x,afterAmount:p,isLoading:_})=>{const{isApp:o}=te(),{getExplorerUrl:a}=je();return e.jsxs(L,{align:{base:"flex-end",lg:"center"},gap:{base:"4px",lg:"8px"},w:{base:"100%",lg:"calc(50% - 4px)"},children:[e.jsxs(n,{w:"100%",justify:{base:"space-between"},flexDirection:{base:"row",lg:"column"},children:[e.jsx(c,{color:"primary_gray",children:i}),e.jsxs(n,{children:[e.jsx(de,{onClick:o?()=>window.open(a(d==null?void 0:d.coin_type,"coin")):()=>{},children:e.jsx(Qe,{haveTooltip:!o,coinType:d?d==null?void 0:d.coin_type:"",haveName:!1,haveSymbol:!1,warningIcon:{iconW:"14px",iconH:"14px"},imgBoxStyle:{w:"28px",h:"28px"}})}),e.jsx(M,{isLoaded:!_&&!!x,children:e.jsx(c,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:Y(x)})}),e.jsx(c,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:ae(d==null?void 0:d.symbol)})]})]}),p!==""&&p&&e.jsxs(n,{bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(c,{color:"primary",children:Y(p)}),e.jsx(c,{color:"primary",children:"after"})]})]})};function oi(){const{currentPosBaseInfo:i,posPoolsRelatedData:d}=X(),{currentAccount:x,onWalletModal:p}=pe(),{tokenAmountA:_,tokenAmountB:o,isFixedDisplayTokenA:a,curPosContractPoolInfo:s}=P(),{displayTokenA:h,displayTokenB:r,tokenABalanceInfo:b,tokenBBalanceInfo:R,tokenAmountValueA:v,tokenAmountValueB:l,handleAmountChange:t,preAddLoading:y,btnStatusText:k,toAdd:w,isAddLoading:F,showDisplayTokenALock:S,showDisplayTokenBLock:A,resetInputAmount:E}=Ke();j.useEffect(()=>()=>{E()},[]);const{getTokenAmountValue:T}=ye(),C=T(h==null?void 0:h.coin_type,_,"--"),f=T(r==null?void 0:r.coin_type,o,"--"),G=C=="--"||f=="--"?"--":Ce(v).plus(l).toString(),u=d[i==null?void 0:i.posId];return e.jsxs(L,{w:"100%",gap:"8px",children:[e.jsxs(de,{w:"100%",position:"relative",children:[e.jsx(Be,{from:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(b==null?void 0:b.balanceFormat)||"",value:_,amountValue:v,loading:!a&&y,onChange:H=>{t(H,!0)},placeholder:"0.0",token:h},to:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(R==null?void 0:R.balanceFormat)||"",value:o,amountValue:l,loading:a&&y,onChange:H=>{t(H,!1)},placeholder:"0.0",token:r},iconParams:S||A?void 0:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),(!i||!s)&&e.jsx(le,{position:"absolute",top:"0px",left:"0",borderRadius:"12px",h:"224px",zIndex:9999}),i&&(i==null?void 0:i.posType)=="burn"&&e.jsx(le,{position:"absolute",top:"0px",left:"0",h:"224px",borderRadius:"12px",text:"Your liquidity has been permanently locked",zIndex:9999}),i&&s&&(S||A)&&e.jsx(le,{position:"absolute",top:S?"0px":"116px",borderRadius:"12px",h:"108px",left:"0"})]}),e.jsx(xe,{onClick:()=>{x?w():p(!0)},isLoading:F,disabled:k.disabled||F,w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:k.text}),+G&&e.jsx(D,{borderRadius:"0 0 12px 12px",pt:"36px",mt:"-28px",children:e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Total Amount"}),e.jsx(c,{color:"text_caption",children:be(G,2)})]})}),(i==null?void 0:i.posType)!=="burn"&&e.jsx(Ie,{}),u&&(u==null?void 0:u.minPrice)!=="0"&&(u==null?void 0:u.maxPrice)!=="âˆž"&&e.jsx(ei,{subscriptionSource:"PositionDetail"})]})}function mi(){const{currentPosBaseInfo:i}=X(),{currentPosPoolInfo:d,curPosContractPoolInfo:x}=P(),{setContractPoolInfo:p,setApiPoolInfo:_}=ai(),{lowerTickData:o,upperTickData:a,setLowerTickData:s,setUpperTickData:h}=Me();_e(()=>{_(d)},[d]);const r=(v,l,t)=>{var T,C;const y=(T=t==null?void 0:t.tokenA)==null?void 0:T.decimals,k=(C=t==null?void 0:t.tokenB)==null?void 0:C.decimals;let w;Math.abs(v)==Math.abs(ve.getMinIndex(Number(t.tickSpacing)))?w=l==="lower"?"0":"âˆž":w=Ae.tickIndexToPrice(v,y,k).toString();const F=w==="âˆž"?"âˆž":Y(w,6),S=pi(w),A=S==="âˆž"?"âˆž":Y(S,6),E={id:l,tokenA:t==null?void 0:t.tokenA,tokenB:t==null?void 0:t.tokenB,tick:v,price:w,displayPrice:F,reversePrice:S,displayReversePrice:A,tickSpacing:t==null?void 0:t.tickSpacing,pool:t==null?void 0:t.poolAddress};l==="lower"?s({...E}):h({...E})},{getCurrentPrice:b}=He();j.useEffect(()=>{i!=null&&i.lowerTick&&(x!=null&&x.current_sqrt_price)&&(d!=null&&d.poolAddress)&&(r(i==null?void 0:i.lowerTick,"lower",d),r(i==null?void 0:i.upperTick,"upper",d),b(x==null?void 0:x.current_sqrt_price,d),p(x))},[i==null?void 0:i.lowerTick,x==null?void 0:x.current_sqrt_price,d==null?void 0:d.poolAddress]);const R=j.useMemo(()=>(i==null?void 0:i.posId)&&(o==null?void 0:o.pool)&&(a==null?void 0:a.pool),[o==null?void 0:o.pool,a==null?void 0:a.pool,i==null?void 0:i.posId]);return e.jsx(de,{className:"chart-block",w:{base:"100%",lg:"200px"},h:"85px",mb:"8px",overflow:"hidden",children:R&&e.jsx(Ne,{isFrom:"position",handleClickRefresh:()=>{},direct:!(i!=null&&i.isReverse),minPriceData:i!=null&&i.isReverse?a:o,maxPriceData:i!=null&&i.isReverse?o:a,readonly:!0})})}function ci(){const{currentPosBaseInfo:i,posPoolsRelatedData:d,posPoolsOriginalData:x}=X(),p=d[i==null?void 0:i.posId],{getClmmPosName:_}=Oe(),o=j.useMemo(()=>{var r;if(i!=null&&i.tokenName)return i==null?void 0:i.tokenName;{const b=(r=x==null?void 0:x[i==null?void 0:i.clmmPool])==null?void 0:r.index;return _(i==null?void 0:i.index,b)}},[i==null?void 0:i.tokenName,i==null?void 0:i.index,i==null?void 0:i.clmmPool,x]);(p==null?void 0:p.displayFee)+"";const a=(p==null?void 0:p.currentStatus)=="Active",s=j.useMemo(()=>{console.log("ðŸš€ ~ leverage ~ currentPosPoolsRelatedData:",p);const r=p==null?void 0:p.minPriceOrigin,b=p==null?void 0:p.maxPriceOrigin;return r!=="0"&&b!=="âˆž"?ue(1/(1-Number((r/b)**.25)),2)+"x":"1x"},[p==null?void 0:p.minPriceOrigin,p==null?void 0:p.maxPriceOrigin]),{getExplorerUrl:h}=je();return e.jsxs(D,{w:"100%",borderRadius:"20px 20px 16px 16px",children:[e.jsx(D,{p:{base:"16px 8px",lg:"16px"},w:"calc(100% + 34px)",ml:"-17px",mt:"-21px",bg:"bg_primary",children:e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{h:{base:"40px",lg:"32px"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(c,{children:"Position ID"}),e.jsx(M,{isLoaded:!!o,children:e.jsx(c,{color:"text_caption",children:o==null?void 0:o.split("|")[1]})})]}),e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(c,{children:"Position NFT"}),e.jsx(M,{isLoaded:!!(i!=null&&i.id),children:e.jsx(Xe,{fontWeight:"500",color:"text_caption",fontSize:"14px",address:i==null?void 0:i.id,showLink:!1,onClickLink:()=>{window.open(h(i==null?void 0:i.id,"nftAddress"),"_blank")}})})]})]}),p&&e.jsx(si,{isActive:a,isLoading:(p==null?void 0:p.currentStatus)=="",h:"32px",p:"0 12px",w:"unset",isRow:!0,imgStyle:{imgW:"30px",imgH:"16px"}})]})}),e.jsxs(n,{gap:{base:"20px",lg:"8px"},w:"100%",justify:"space-between",p:"28px 0 20px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(L,{gap:{base:"16px",lg:"32px"},children:[e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(c,{color:"primary_gray",children:"Current Price"}),e.jsx(Ue,{posId:(i==null?void 0:i.posId)||"",displayTokenA:i==null?void 0:i.displayTokenA,displayTokenB:i==null?void 0:i.displayTokenB})]}),e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(c,{color:"primary_gray",children:"Position Range"}),e.jsx(li,{displayTokenA:i==null?void 0:i.displayTokenA,displayTokenB:i==null?void 0:i.displayTokenB,justify:"center",priceInfo:{minPrice:p==null?void 0:p.minPrice,maxPrice:p==null?void 0:p.maxPrice,minPriceResever:p==null?void 0:p.minPriceResever,maxPriceResever:p==null?void 0:p.maxPriceResever},fontSize:"14px"})]})]}),e.jsxs(L,{gap:"0",children:[e.jsx(mi,{}),e.jsx(L,{zIndex:"9",children:e.jsxs(n,{gap:"2px",bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(c,{color:"primary",fontSize:"12px",children:"Leverage"}),e.jsx(ii,{type:"leverage"}),e.jsx(M,{ml:"4px",isLoaded:!!s&&!!p,children:e.jsx(c,{color:"primary",children:s})})]})})]})]})]})}function xs(){var O,$;const i=Re(),{fetchAccountBalance:d}=Te(),{currentAccount:x}=pe(),{position_nft_id:p}=Le(),{getCurrentPosBaseInfo:_}=we(),{currentPosDetailTab:o,currentPosPoolInfo:a,setCurrentPosDetailTab:s,setCurrentPosPoolInfo:h,setCurrentPoolSqrtPrice:r,setCurPosContractPoolInfo:b,setIsPosDetailRefresh:R}=P(),{posPoolsRelatedData:v,currentPosBaseInfo:l,setCurrentPosBaseInfo:t,farmsPosRewardsData:y,posRewardsData:k}=X(),w=(((O=v[l==null?void 0:l.posId])==null?void 0:O.displayFee)||"--")+"%",F=[{label:"Increase",value:"increase"},{label:"Remove",value:"remove"}],S=()=>{console.log("ðŸš€ ~ handleRefresh ~ handleRefresh:"),R(!0),A(!0),u(),f(),d(),W(),setTimeout(()=>{R(!1)},1e3)},A=(m=!1)=>{x!=null&&x.address&&p&&_(x==null?void 0:x.address,p,m)};j.useEffect(()=>{console.log("ðŸš€ ~ PositionDetail ~ position_nft_id:",p),A()},[x==null?void 0:x.address,p]),j.useEffect(()=>{console.log("ðŸš€ ~ PositionHistory ~ currentPosBaseInfo?.id:",l==null?void 0:l.id)},[l==null?void 0:l.id]);const{fetchTokenPrices:E}=ye(),T=y[l==null?void 0:l.id],C=k[l==null?void 0:l.posId],f=()=>{var g,N;const m=(C==null?void 0:C.map(V=>V==null?void 0:V.coin_address))||[],J=(T==null?void 0:T.map(V=>V==null?void 0:V.rewarder_type))||[],K=[(g=l==null?void 0:l.tokenA)==null?void 0:g.coin_type,(N=l==null?void 0:l.tokenB)==null?void 0:N.coin_type].filter(Boolean),B=Array.from(new Set([...m,...K,...J]));E(B)};j.useEffect(()=>{f()},[l==null?void 0:l.posId,C==null?void 0:C.length,T==null?void 0:T.length]);const{getPoolList:G}=ti(),u=async()=>{if(!(l!=null&&l.clmmPool))return;const m=await G({pool:l==null?void 0:l.clmmPool});if(console.log("ðŸš€ ~ getPoolData ~ poolInfo:",l,m),m)return h(m==null?void 0:m.list[0])},{getContractPoolInfo:H}=De(),W=async()=>{if(console.log("ðŸš€ ~ handleGetPrice ~ currentPosBaseInfo?.clmmPool:",l==null?void 0:l.clmmPool),l!=null&&l.clmmPool){const m=await H(l==null?void 0:l.clmmPool);console.log("ðŸš€ ~ handleGetPrice ~ contractPoolInfo:",m),m&&(r(m.current_sqrt_price),b(m))}},{setFromCoin:q,setToCoin:Z,fromCoin:ee,toCoin:ne}=xi();j.useEffect(()=>{u(),W();let m;return l!=null&&l.clmmPool&&(m=setInterval(()=>{W()},2e4)),l!=null&&l.displayTokenA&&(l!=null&&l.displayTokenB)&&(q(l==null?void 0:l.displayTokenA),Z(l==null?void 0:l.displayTokenB)),()=>{clearInterval(m),q(re.clmm_swap.from_coin),Z(re.clmm_swap.to_coin)}},[l==null?void 0:l.clmmPool]),j.useEffect(()=>(s("increase"),x!=null&&x.address&&d(),()=>{b(null),t(null),h(null)}),[]),di({onRpcChange:()=>{A(!0),W(),x!=null&&x.address&&d()}});const{isApp:U}=te();return e.jsxs(L,{gap:"12px",w:"100%",pt:"20px",align:"flex-start",children:[e.jsxs(n,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(n,{w:{base:"100%",lg:"unset"},justifyContent:"space-between",children:[e.jsx(Fe,{}),U&&e.jsxs(n,{children:[e.jsx(he,{}),e.jsx(ge,{handleRefresh:S,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(xe,{w:{base:"100%",lg:"unset"},bg:"bg_secondary",fontSize:"14px",p:"0 16px",h:"32px",borderRadius:"8px",fontWeight:"500",variant:"outline",onClick:m=>{i(`/liquidity?poolAddress=${l==null?void 0:l.clmmPool}`)},children:"Create a new position"}),!U&&e.jsx(ge,{handleRefresh:S,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(n,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(M,{w:{base:"100%",lg:"unset"},isLoaded:!!(l!=null&&l.clmmPool),children:e.jsx(Ve,{symbolFontWeight:"600",haveName:!0,poolInfo:{feeDisplay:w,poolAddress:l==null?void 0:l.clmmPool,...l},symbolEllipsesDecimals:10,nameEllipsesDecimals:20,placement:"bottom-start"})}),e.jsxs(n,{w:{base:"100%",lg:"unset"},gap:{base:"12px",lg:"28px"},flexDirection:{base:"column",lg:"row"},children:[e.jsx(I,{label:"Pool APR",value:e.jsx(We,{poolInfo:a,children:e.jsxs(n,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsx(c,{as:"span",fontSize:"14px",color:"text_caption",fontWeight:"500",cursor:a!=null&&a.farmingAprDisplay||(($=a==null?void 0:a.miningAprList)==null?void 0:$.length)>0?"help":"text",children:a==null?void 0:a.feeAndMiningAprDisplay}),(a==null?void 0:a.haveFarming)&&e.jsxs(c,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",a==null?void 0:a.farmingAprDisplay]})]})}),loading:!(a!=null&&a.poolAddress)}),e.jsx(I,{label:"TVL",value:(a==null?void 0:a.tvlDisplay)||"",loading:!(a!=null&&a.poolAddress)}),e.jsx(I,{label:"Volume (24H)",value:(a==null?void 0:a.volume24Display)||"",loading:!(a!=null&&a.poolAddress)}),e.jsx(I,{label:"Fees (24H)",value:(a==null?void 0:a.fees24Display)||"",loading:!(a!=null&&a.poolAddress)})]})]}),e.jsxs(n,{w:"100%",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(L,{w:{base:"100%",lg:"60%"},gap:"8px",children:[e.jsx(ci,{}),e.jsx(ni,{})]},`${l==null?void 0:l.posId}-posInfo`),e.jsxs(L,{w:{base:"100%",lg:"40%"},children:[e.jsx(D,{p:"0",borderRadius:"12px",children:e.jsxs(n,{w:"100%",p:"0 16px",children:[e.jsx(Ee,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{w:{base:"50%",lg:"unset"},fontSize:"16px",mr:"28px"},tabList:F,currentTab:o=="increase"?"Increase":"Remove",handleChangeTab:m=>{s(m==null?void 0:m.value)}}),!U&&e.jsx(he,{})]})}),o=="increase"&&e.jsx(oi,{}),o=="remove"&&e.jsx(Pe,{})]})]})]})}const he=()=>e.jsx(n,{children:e.jsx(ze,{})});export{xs as default};

import{j as e,H as j,T as _,a as d,V as P,X as Fe,Y as Ne,Z as De,$ as Be,a8 as jt,a0 as We,a1 as $e,v as I,u as Q,C as he,S as ot,f as bt,R as Le,at as U,au as F,aw as ft,ax as _t,ay as Z,as as wt,ab as yt,az as Zt,O as ct,aa as Xt}from"./vendor-DsVemle5.js";import{C as qt,m as W,t as Ve,as as St,e as Ct,a as re,B as G,I as ee,K as Ye,l as Re,k as Lt,n as se,j as Oe,at as ye,au as ie,av as Ot,a2 as X,d as z,i as vt,N as Tt,c as It,J as Ge,z as Se,r as Ue,y as lt,Y as es,M as ts,E as ne,$ as dt,A as ss,u as is,aw as ns}from"./index-DIvDX_Yh.js";import{P as ve}from"./Pagination-CG5bXf-5.js";import{N as te}from"./NoData-HfG491EP.js";import{u as rs}from"./RangeValue-BR10AKaI.js";import{u as ge}from"./useTransaction-CjlygSkT.js";import{u as Te}from"./useAccountBalance-CBRzIpkZ.js";import{u as Je}from"./useToken-YYj-bY2H.js";import{S as as}from"./SingleTokenInfo-CBKDT-57.js";import{b as Pt}from"./FarmsTable-DHuRESjo.js";import{A as os}from"./aggregator-Boz3QPO-.js";import{A as pt}from"./useSwapHelper-BOLbfc9y.js";import{u as xt}from"./useTokenBalance-Dt87YmUP.js";import{u as cs}from"./useInsufficientBalanceToast-QGj3IVLD.js";import{u as ls}from"./useFindBestRouting-H-sky85D.js";import{T as ds}from"./TradeInputGroup-CW7tw1iX.js";import{W as ps}from"./WarningTokenTipModal-Bwp0YzSD.js";import{M as xs,C as us}from"./MenuDropBlock-CVfW8l4z.js";import{T as ms,a as gs}from"./TradeTab-DOM9cS6C.js";import"./index-Bbyfw4ff.js";import{u as hs}from"./global-CXwwb5OW.js";import"./swap-DfglqfWy.js";import"./AggregatorModal-DvqOUCop.js";import"./FreshProgressV2-ZPylifaE.js";import{T as js}from"./TradeConfirmAmountInfo-K6F_j3dB.js";import{I as Ce}from"./InputBox-B9mQGWx1.js";import{LimitPriceChart as bs}from"./LimitPriceChart-7i7t9K_a.js";import{u as fs}from"./useInterval-DHQ0XTt3.js";import{u as _s}from"./useRpcListener-BP45ghaH.js";import{R as ut}from"./RefreshButton-DvOwcCPC.js";import"./useTrack-DRz2Qk0R.js";import"./useSigner-Brm2Toqu.js";import"./CopyButton-D-DvrQ9Z.js";import"./usePositionList-DMAeOMoO.js";import"./useFavoritePool-BJLivj5m.js";import"./useGetPoolList-CqBccx4u.js";import"./useWrapPoolData-D5Mp0awk.js";import"./index-Cy9bHcqq.js";import"./ExpendItem-n-_qpxU7.js";import"./msafe-oYBkW7LJ.js";import"./PriceRange-Cn5wVyeV.js";import"./PositionStatus-Z20d5_GT.js";import"./CoinPairInfo-CkfLTRmv.js";import"./PoweredByHaedal-CSYJZkP0.js";import"./_getAllKeysIn-BgIYPgua.js";import"./CheckBox-D8E1JnSg.js";import"./IconBg-trGOVJ4E.js";import"./TooltipIcon-DEf7niQQ.js";import"./usePreviousValue-CMQTRdbk.js";const je=({info:t,imgSize:n="32px"})=>{const{pay_coin:r,target_coin:m,total_pay_amount:x,expect_obtain_amount:p}=t;return e.jsxs(j,{children:[e.jsx(qt,{w:n,h:n,coinAIconUrl:r.logo_url,coinBIconUrl:m.logo_url}),e.jsxs(_,{color:"text_caption",children:[W(x)," ",r.symbol," â†’ ",W(p)," ",m.symbol]})]})},be=({info:t})=>e.jsx(j,{justifyContent:"end",gap:"2px",children:e.jsxs(_,{color:"text_caption",children:[Ve(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),fe=({info:t})=>{const{pay_coin:n,total_pay_amount:r,deal_amount:m,deal_rate:x}=t;return e.jsxs(j,{justifyContent:"end",gap:"2px",children:[e.jsxs(_,{color:"text_caption",children:[W(m),"/",W(r)," ",n.symbol]}),e.jsxs(_,{color:"primary_gray",children:["(",St(Number(x)*100),")"]})]})},kt=({historyInfo:t,type:n,...r})=>{const{getExplorerUrl:m}=Ct(),{pay_coin:x,target_coin:p}=t,g=d.useMemo(()=>(t==null?void 0:t.events)||[],[t]),h=o=>{const l=o==null?void 0:o.event_type;return l.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:x,num:`+${W(Re(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`}:l.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:p,num:`+${W(Re(o==null?void 0:o.amount,p==null?void 0:p.decimals))}`}:l.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${W(Re(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`,tokenInfo:x}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},{isApp:a}=re();return e.jsx(G,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...r,children:e.jsx(P,{align:"flex-start",children:g.map(o=>{const{tokenInfo:l,text:i,icon:s,color:c,num:b}=h(o);return e.jsxs(P,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(j,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(j,{gap:n=="card"?"4px":"8px",flexDirection:n=="card"?"column":"row",align:n=="card"?"flex-start":"center",children:[e.jsxs(j,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(ee,{svgW:"14px",xlinkHref:s,svgFill:c,svgHover:c}),e.jsx(_,{color:c,children:i})]}),!a&&e.jsxs(_,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[b,"Â ",l==null?void 0:l.symbol]})]}),e.jsxs(j,{gap:n=="card"?"4px":"20px",flexDirection:n=="card"&&!a?"column":"row",align:n=="card"?"flex-end":"center",children:[e.jsxs(_,{h:"20px",lineHeight:"20px",children:[Ve(Number(o.block_time),"")," (UTC)"]}),e.jsxs(j,{gap:"4px",cursor:"pointer",onClick:f=>{Ye(f),window.open(m(o.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!a&&e.jsx(_,{color:"text_caption",children:"View Transaction"}),e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),a&&e.jsxs(_,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[b,"Â ",l==null?void 0:l.symbol]})]},o==null?void 0:o.tx)})})})},le=({info:t})=>{const[n,r]=d.useState(!0),{getTokenRank:m}=rs();d.useEffect(()=>{const a=m(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",a),r(a)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:x,target_coin:p,price:g,reseverPrice:h}=t;return e.jsxs(j,{justifyContent:"end",children:[n?e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(_,{color:"text_caption",lineHeight:"1",children:W(g)}),e.jsxs(_,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[p.symbol," per ",x.symbol]})]}):e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(_,{color:"text_caption",children:W(h)}),e.jsxs(_,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[x.symbol," per ",p.symbol]})]}),e.jsx(ee,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:a=>{Ye(a),r(!n)}})]})},Mt=({historyInfo:t,openExpendItemObj:n})=>e.jsxs(j,{justifyContent:"end",gap:"4px",children:[(t==null?void 0:t.status)=="Cancelled"?e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(ee,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"}),e.jsx(_,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),e.jsx(ee,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:n[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),ws=(t,n)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:r=>{t(()=>({orderListLoading:r}))},setMyOrderList:r=>{t(()=>({myOrderList:r}))}}),Pe=Lt(ws);function ke(){const{currentAccount:t,addressChangeVersion:n}=se(),{peripherySdk:r}=Oe(),{setOrderListLoading:m,setMyOrderList:x,myOrderList:p,orderListLoading:g}=Pe(),{getTokenListInfo:h}=Je(),a=async(l=t==null?void 0:t.address,i)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",l);try{if(!l){m(!1),x([]);return}i&&m(!0);const s=await r.LimitOrder.getOwnerLimitOrderList(l,"all"),c=await o(s.data.filter(b=>b.status===ye.PartialCompleted||b.status===ye.Running));x(c),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",c)}catch(s){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",s)}finally{m(!1)}},o=async l=>{const i=[],s=[];for(const b of l)s.push(b.pay_coin_type),s.push(b.target_coin_type);const c=await h(s);for(const b of l){const[f,L]=[c==null?void 0:c.get(b.pay_coin_type),c==null?void 0:c.get(b.target_coin_type)];if(f&&L){const{total_pay_amount:O,pay_balance:v,rate:M,obtained_amount:y,claimed_amount:S,target_balance:w,created_ts:E,expire_ts:N,status:H,id:J}=b,D=ie(O,f.decimals).toString(),V=ie(v,f.decimals).toString(),T=ie(y,L.decimals).toString(),$=ie(S,L.decimals).toString(),k=ie(w,L.decimals).toString(),C=Ot.rateToPrice(M.toString(),f.decimals,L.decimals),q=X(1).div(C).toString(),de=ie(X(O).sub(v).toFixed(0),f.decimals).toString(),Me={order_id:J,pay_coin:f,target_coin:L,price:C,reseverPrice:q,total_pay_amount:D,expect_obtain_amount:X(D).mul(C).toString(),remaining_amount:V,deal_amount:de,deal_rate:X(de).div(D).toString(),obtained_amount:T,claimed_amount:$,un_claimed_amount:X(k).sub($).toString(),created_ts:E,expire_ts:N,status:H};i.push(Me)}}return i.sort((b,f)=>f.created_ts-b.created_ts)};return{fetchMyLimitOrder:a,orderListLoading:g,myOrderList:p}}function Et(){const{fetchAccountBalance:t}=Te(),{fetchMyLimitOrder:n}=ke(),{signAndExecuteTransaction:r}=ge(),{peripherySdk:m}=Oe(),[x,p]=d.useState(!1),{transactionConfirmation:g}=ge();return{handleCancelOrder:async a=>{p(!0);const o={getShowInfo:c=>{const b="Canceling order",f={modalDescriptionText:b,toastTitleText:b};return c==="success"&&(f.toastDescriptionContent="Order cancelled successfully",f.modalDescriptionText="Order cancelled successfully",f.toastTitleText="Order cancelled"),f}};g(o);const l=a.map(c=>({pay_coin_type:c.pay_coin.coin_type,target_coin_type:c.target_coin.coin_type,order_id:c.order_id})),i=await m.LimitOrder.cancelOrdersByOwner(l),s=await r(i,o);p(!1),s&&setTimeout(()=>{t(),n()},2e3)},cancelOrderLoading:x}}function ys(){const{fetchAccountBalance:t}=Te(),{fetchMyLimitOrder:n}=ke(),{signAndExecuteTransaction:r}=ge(),{peripherySdk:m}=Oe(),[x,p]=d.useState(!1),[g,h]=d.useState(!1);return{handleClaimOrder:async(l,i)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",l),p(!0);const s={pay_coin_type:l.pay_coin.coin_type,target_coin_type:l.target_coin.coin_type,order_id:l.order_id},c=await m.LimitOrder.claimTargetCoin(s),b=await r(c,{getShowInfo:(f,L)=>{var M;const O=`Claim ${W(i)} ${(M=l==null?void 0:l.target_coin)==null?void 0:M.symbol}`,v={modalDescriptionText:O,toastTitleText:O};return f==="success"&&(v.toastDescriptionContent="",v.modalDescriptionText="",v.toastTitleText="Claim successfully"),v}});p(!1),b&&setTimeout(()=>{t(),n()},2e3)},getLimitOrderClaimHistory:async l=>{h(!0);const i=await m.LimitOrder.getLimitOrderClaimLogs(l.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",l,i),i?(h(!1),i.map(s=>{var b;const c=z(s.parsedJson.claimed_amount).div(Math.pow(10,(b=l.target_coin)==null?void 0:b.decimals));return{...s,...s.parsedJson,claimed_amount:c}})):[]},isClaimHistoryLoading:g,claimLoading:x}}const Ss=({orderInfo:t,isOpen:n,onClose:r,handleClaim:m,claimLoading:x,getLimitOrderClaimHistory:p,isClaimHistoryLoading:g})=>{const{getExplorerUrl:h}=Ct(),[a,o]=d.useState(""),[l,i]=d.useState([]),[s,c]=d.useState({label:"Claim",value:"claim"}),b=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],f=y=>{c(y),(y==null?void 0:y.value)=="history"&&L()},L=async()=>{const y=await p();y&&i(y)},O=d.useMemo(()=>!a||x?{disabled:!0,text:"Claim"}:z(a).gt(t.un_claimed_amount)||z(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[a,t.un_claimed_amount]),[v,M]=d.useState(!0);return d.useEffect(()=>{v&&(M(!1),o(t.un_claimed_amount))},[v,t.un_claimed_amount]),e.jsxs(Fe,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Ne,{}),e.jsxs(De,{children:[e.jsx(Be,{children:e.jsx(jt,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(We,{}),e.jsx($e,{textAlign:"center",p:"0px",children:e.jsxs(P,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(G,{borderRadius:"8px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(je,{info:t,imgSize:"28px"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(le,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),e.jsx(vt,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:b,currentTab:s.label,handleChangeTab:f}),(s==null?void 0:s.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(G,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(P,{gap:"16px",align:"flex-start",children:[e.jsx(_,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(Tt,{value:a?W(a).toString():"",onChange:y=>{o(y)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(j,{children:e.jsx(as,{portal:!1,token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(I,{onClick:()=>{m(a),r()},disabled:O.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:O.text})]}),(s==null?void 0:s.value)=="history"&&e.jsx(P,{w:"100%",gap:"12px",children:g?e.jsxs(G,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(j,{justify:"space-between",children:[e.jsx(Q,{height:"4",width:"150px"}),e.jsx(Q,{height:"4",width:"150px"})]}),e.jsxs(j,{justify:"space-between",mt:"16px",children:[e.jsx(Q,{height:"4",width:"150px"}),e.jsx(Q,{height:"4",width:"150px"})]})]},history==null?void 0:history.id):(l==null?void 0:l.length)==0?e.jsx(te,{type:"nodata",text:"No History.",p:"20px"}):l==null?void 0:l.map(y=>{var S,w;return e.jsx(G,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(P,{gap:"16px",align:"flex-start",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Amount"}),e.jsxs(j,{gap:"4px",children:[e.jsx(It,{imageUrl:(S=t==null?void 0:t.target_coin)==null?void 0:S.logo_url,w:"20px",h:"20px"}),e.jsxs(_,{color:"text_caption",lineHeight:"18px",children:[W(y==null?void 0:y.claimed_amount)," ",(w=t==null?void 0:t.target_coin)==null?void 0:w.symbol]})]})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Time"}),e.jsxs(j,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:E=>{Ye(E),window.open(h(y.digest,"tx"))},children:[e.jsxs(_,{color:"text_caption",children:[Ve(Number(y==null?void 0:y.timestampMs),"")," (UTC)"]}),e.jsx(ee,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},y.digest)})})]})})]})]})},ze=({orderInfo:t})=>{const{handleCancelOrder:n,cancelOrderLoading:r}=Et(),{handleClaimOrder:m,claimLoading:x,getLimitOrderClaimHistory:p,isClaimHistoryLoading:g}=ys(),[h,a]=d.useState(),[o,l]=d.useState(!1),i=(s,c)=>{a(s),c==="cancel"&&n([s]),c==="claim"&&l(!0)};return re(),e.jsxs(j,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:"space-between",gap:"8px",children:[z(t==null?void 0:t.obtained_amount).lte(0)&&z(t.un_claimed_amount).lte(0)?e.jsx(Ge,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."}),children:e.jsx(he,{w:{base:"calc(50vw - 28px)",lg:"80px"},children:e.jsx(I,{disabled:!0,w:"100%",h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",children:"Claim"})})}):e.jsx(I,{isLoading:x,disabled:x,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",onClick:()=>{x||i(t,"claim")},children:"Claim"}),e.jsx(I,{isLoading:r,disabled:r,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",color:"primary_gray",bg:"button_ghost_bg",onClick:()=>{r||i(t,"cancel")},children:"Cancel"}),o&&e.jsx(Ss,{orderInfo:t,claimLoading:x,isOpen:o,onClose:()=>l(!1),handleClaim:s=>m(t,s),getLimitOrderClaimHistory:()=>p(t),isClaimHistoryLoading:g})]})};function mt(){const{currentAccount:t,onWalletModal:n}=se(),{myOrderList:r,orderListLoading:m}=Pe();console.log("ðŸš€ ~ OrderTableList ~ myOrderList:",r);const x=10,[p,g]=d.useState([]),[h,a]=d.useState(0),[o,l]=d.useState(1);return d.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const i=(o-1)*x,s=i+x;g(r.slice(i,s))}},[o,r]),e.jsx(P,{w:"100%",children:t!=null&&t.address?m?e.jsx(G,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((i,s)=>e.jsx(Ht,{},s))})}):r.length===0?e.jsx(te,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"}):e.jsxs(G,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(p==null?void 0:p.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:p==null?void 0:p.map(i=>e.jsx(Cs,{orderInfo:i},i==null?void 0:i.order_id))}),!m&&(r==null?void 0:r.length)>x&&e.jsx(he,{mt:"12px",children:e.jsx(ve,{total:h,size:x,currentPage:o,onChange:l})})]}):e.jsx(te,{type:"nowallet",onboard:()=>n(!0),borderRadius:"16px"})})}const Cs=({orderInfo:t})=>{const{isApp:n}=re();return e.jsxs(P,{w:"100%",gap:"16px",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(je,{info:t,imgSize:"28px"}),!n&&e.jsx(ze,{orderInfo:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(le,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),n&&e.jsx(ze,{orderInfo:t})]})},Ht=()=>e.jsxs(P,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsx(j,{w:"100%",gap:"0",justify:"space-between",children:e.jsxs(j,{gap:"0",children:[e.jsxs(j,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(ot,{size:"8"}),e.jsx(ot,{size:"8"})]}),e.jsx(Q,{height:"4",width:"100px"})]})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(Q,{height:"4",width:"180px"}),e.jsx(Q,{height:"4",width:"150px"})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(Q,{height:"4",width:"180px"}),e.jsx(Q,{height:"4",width:"150px"})]})]});function gt(t){const{historyOrderList:n,historyOrderLoading:r}=t,{currentAccount:m,onWalletModal:x}=se();console.log("ðŸš€ ~ OrderTableList ~ historyOrderList:",n);const p=10,[g,h]=d.useState([]),[a,o]=d.useState(0),[l,i]=d.useState(1);return d.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const s=(l-1)*p,c=s+p;h(n.slice(s,c))}},[l,n]),e.jsx(P,{w:"100%",children:m!=null&&m.address?r?e.jsx(G,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((s,c)=>e.jsx(Ht,{},c))})}):n.length===0?e.jsx(te,{type:"nodata",text:"You don't have any order history.",borderRadius:"16px"}):e.jsxs(G,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(g==null?void 0:g.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(P,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:g==null?void 0:g.map(s=>e.jsx(Ls,{historyInfo:s},s==null?void 0:s.order_id))}),!r&&(n==null?void 0:n.length)>p&&e.jsx(he,{mt:"12px",children:e.jsx(ve,{total:a,size:p,currentPage:l,onChange:i})})]}):e.jsx(te,{type:"nowallet",onboard:()=>x(!0),borderRadius:"16px"})})}const Ls=({historyInfo:t})=>{const[n,r]=d.useState({});return e.jsxs(P,{w:"100%",gap:"16px",children:[e.jsx(j,{w:"100%",justify:"space-between",children:e.jsx(je,{info:t,imgSize:"28px"})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Limit Price"}),e.jsx(le,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expiry"}),e.jsx(be,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Filled Size"}),e.jsx(fe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Status"}),e.jsx(bt,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},children:e.jsx(Mt,{historyInfo:t,openExpendItemObj:n})})]}),n[t==null?void 0:t.order_id]&&e.jsx(kt,{historyInfo:t,p:"0",border:"none",type:"card"})]})};function Os({historyInfo:t}){const[n,r]=d.useState({});return e.jsxs(Le.Fragment,{children:[e.jsxs(U,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},sx:{td:{pb:n[t==null?void 0:t.order_id]?"20px !important":"16px !important"}},children:[e.jsx(F,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(F,{w:"20%",textAlign:"right",children:e.jsx(le,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(Mt,{historyInfo:t,openExpendItemObj:n})})]}),!n[t==null?void 0:t.order_id]&&e.jsx(U,{h:"16px"}),e.jsx(U,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:n[t==null?void 0:t.order_id]&&e.jsx(F,{colSpan:5,children:e.jsx(kt,{historyInfo:t})})})]},t==null?void 0:t.order_id)}function vs(t){const{historyOrderList:n,historyOrderLoading:r}=t;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",n);const{currentAccount:m,onWalletModal:x}=se(),p=10,[g,h]=d.useState([]),[a,o]=d.useState(0),[l,i]=d.useState(1);return d.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const s=(l-1)*p,c=s+p;h(n.slice(s,c))}},[l,n]),e.jsxs(ft,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(_t,{children:e.jsxs(U,{children:[e.jsx(Z,{children:"Order Info"}),e.jsx(Z,{textAlign:"right",children:"Limit Price"}),e.jsx(Z,{textAlign:"right",children:"Expiry"}),e.jsx(Z,{textAlign:"right",children:"Filled Size"}),e.jsx(Z,{textAlign:"right",children:"Status"})]})}),e.jsx(wt,{children:m!=null&&m.address?r?e.jsx(Pt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):n.length===0?e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(F,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(Le.Fragment,{children:[g.map(s=>e.jsx(Os,{historyInfo:s},s.order_id)),!r&&(n==null?void 0:n.length)>p&&e.jsx(F,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(he,{w:"100%",children:e.jsx(ve,{total:a,size:p,currentPage:l,onChange:i})})})]}):e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(F,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nowallet",onboard:()=>{x(!0)}})})})})]})}const Ts=(t,n)=>({quoteToken:void 0,payCoin:Se.clmm_swap.from_coin,targetCoin:Se.clmm_swap.to_coin,setPayCoin:r=>{t(()=>({payCoin:r}))},setTargetCoin:r=>{t(()=>({targetCoin:r}))},setQuoteToken:r=>{t(()=>({quoteToken:r}))},expiresIn:"7 Days",setExpiresIn:r=>{t(()=>({expiresIn:r}))},customExpiresVal:null,setCustomExpiresVal:r=>{t(()=>({customExpiresVal:r}))},refreshPriceLoading:!1,setRefreshPriceLoading:r=>{t(()=>({refreshPriceLoading:r}))}}),ae=Lt(Ts);function Ps(t,n){const{getTokenPrice:r}=Ue(),m=r(t),x=r(n),p=d.useMemo(()=>{if(m&&x){const g=X(m.price).div(x.price).toString(),h=g.toString();return{price:g,displayPrice:h}}},[m,x]);return{price:p==null?void 0:p.price,displayPrice:p==null?void 0:p.displayPrice}}function At(){const{payCoin:t,targetCoin:n,setRefreshPriceLoading:r}=ae(),{fetchTokenPrices:m}=Ue();return{refreshCoinMarketPrice:()=>{const p=[];t&&p.push(t.coin_type),n&&p.push(n.coin_type),p.length>0&&(r(!0),m(p).finally(()=>{r(!1)}))}}}function ks(){const{refreshCoinMarketPrice:t}=At(),{fetchAccountBalance:n}=Te(),{fetchMyLimitOrder:r}=ke(),{signAndExecuteTransaction:m}=ge(),{peripherySdk:x}=Oe(),{findBestRouters:p}=ls(),{getTokenAmountValue:g}=Ue(),h=yt(),{pay:a,target:o}=Zt(),{getTokenListInfo:l}=Je(),{payCoin:i,targetCoin:s,quoteToken:c,expiresIn:b,setPayCoin:f,setTargetCoin:L,setQuoteToken:O,customExpiresVal:v,setExpiresIn:M,setRefreshPriceLoading:y}=ae(),[S,w]=d.useState(""),[E,N]=d.useState(""),[H,J]=d.useState(!0),[D,V]=d.useState(!0),[T,$]=d.useState(""),{displayPrice:k}=Ps((c==null?void 0:c.coin_type)===(i==null?void 0:i.coin_type)?s==null?void 0:s.coin_type:i==null?void 0:i.coin_type,c==null?void 0:c.coin_type),{balanceInfo:C}=xt(i),{balanceInfo:q}=xt(s),de=g(i==null?void 0:i.coin_type,S),Me=g(s==null?void 0:s.coin_type,E),[Ee,Rt]=d.useState(""),Ke=d.useRef(Ee);d.useEffect(()=>{Ke.current=Ee},[Ee]);const[pe,Qe]=d.useState(void 0),[xe,Ze]=d.useState(""),zt=d.useRef(S),Ft=d.useRef(E);d.useEffect(()=>{zt.current=S},[S]),d.useEffect(()=>{Ft.current=E},[E]),d.useEffect(()=>{(async()=>{const A=[a,o].filter(Boolean),B=await l(A),Y=B==null?void 0:B.get(a||"");f(Y||Se.clmm_swap.from_coin);const K=B==null?void 0:B.get(o||"");L(K||Se.clmm_swap.to_coin)})()},[a,o]),d.useEffect(()=>{if(Qe(void 0),t(),Nt(),i&&s){const u=i.extensions&&i.extensions.rank||"0",A=s.extensions&&s.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",i,s),z(u).gte(A)?O({...i}):O({...s})}},[i==null?void 0:i.coin_type,s==null?void 0:s.coin_type]);const Nt=async()=>{if(i&&s){const u=`${i.coin_type}_${s.coin_type}`;Rt(u);const A=Object.entries(os).map(([Y,K])=>K.id),B=await p({fromToken:i,toToken:s,amount:lt(1,i.decimals).toFixed(0),providersKeys:A,by_amount_in:!0,uuid:u});u===Ke.current&&Qe(B)}};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",D,k),D?$(k||""):qe()},[k]),d.useEffect(()=>{c&&!D&&+T&&$(W(z(1).div(T).toFixed(c.decimals)).toString())},[c]),d.useEffect(()=>{Ie(H?S:E,H),qe()},[T]);const[ue,Dt]=d.useState({tooltip:"",color:"",text:"",bg:""}),[Bt,Xe]=d.useState(!1),qe=()=>{var u,A;if(!D&&k&&T){Xe(!0);const B=z(T).sub(k).div(k).mul(100).toFixed(2);Ze(B);const Y=z(B).gt(0),K=Y?B:B.split("-")[1],R={tooltip:"",color:"",text:"",bg:""};R.tooltip=`Limit order price is ${K}% ${Y?"higher":"lower"} than the market.`,((u=c==null?void 0:c.coin_type)==null?void 0:u.toLowerCase())==((A=s==null?void 0:s.coin_type)==null?void 0:A.toLowerCase())?Number(T)>Number(k)?(R.text="",R.color="#68FFD8"):Number(k)>Number(T)&&(R.text=`Your limit order price is ${K}% ${Y?"higher":"lower"} than market. You are selling at a much ${Y?"higher":"lower"} rate. We recommend you to use`,R.color="#ffb62d",R.bg="rgba(255,202,104,0.1)"):Number(T)>Number(k)?(R.text=`Your limit order price is ${K}% ${Y?"higher":"lower"} than market. You are buying at a much ${Y?"higher":"lower"} rate. We recommend you to use`,R.color="#ffb62d",R.bg="rgba(255,202,104,0.1)"):Number(k)>Number(T)&&(R.text="",R.color="#68FFD8"),Dt(R),Xe(!1);return}Ze("")},Wt=(u=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",k),V(u),u&&($(k||""),t())},Ie=(u,A)=>{if(J(A),A?w(u):N(u),c&&i&&s&&+T&&+u)if(A){c.coin_type===i.coin_type?N(z(u).div(T).toString().toString()):N(z(u).mul(T).toString().toString());return}else{c.coin_type===s.coin_type?w(z(u).div(T).toString().toString()):w(z(u).mul(T).toString().toString());return}A?N(""):w("")},et=(u,A)=>{tt(),J(A),V(!0),A?ne(u==null?void 0:u.coin_type)===ne(s==null?void 0:s.coin_type)?h(`/limit/${u==null?void 0:u.coin_type}/${i==null?void 0:i.coin_type}`):h(`/limit/${u==null?void 0:u.coin_type}/${s==null?void 0:s.coin_type}`):ne(u==null?void 0:u.coin_type)===ne(i==null?void 0:i.coin_type)?h(`/limit/${s==null?void 0:s.coin_type}/${u==null?void 0:u.coin_type}`):h(`/limit/${i==null?void 0:i.coin_type}/${u==null?void 0:u.coin_type}`)},$t=async()=>{$(k||""),s&&(et(s,!0),w(E),N(S))},tt=()=>{w(""),N("")};d.useEffect(()=>()=>{M("7 Days")},[]);const[Vt,He]=d.useState(!1),Yt=u=>{switch(u){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:Gt}=cs(),{transactionConfirmation:Ut}=ge(),{clmmSdk:Jt}=es(),{addToken:st}=ts(),Kt=async()=>{var nt,rt;const u={getShowInfo:(ce,at)=>{const we="Creating order",me={modalDescriptionText:we,toastTitleText:we};return ce==="success"&&(me.toastDescriptionContent="",me.modalDescriptionText="Created order successfully",me.toastTitleText="Created order successfully"),ce==="rejected"&&(me.toastTitleText="Create order"),me}};Ut(u);const A=Date.parse(new Date().toString())+(Yt(b)||v);console.log(" ~ handleSubmitOrder ~ expired_ts:",A),He(!0);const B=await Jt.CetusConfig.getTokenListByCoinTypes([i==null?void 0:i.coin_type,s==null?void 0:s.coin_type]),Y=i==null?void 0:i.decimals,K=s==null?void 0:s.decimals,R=(nt=B[i==null?void 0:i.coin_type])==null?void 0:nt.decimals,_e=(rt=B[s==null?void 0:s.coin_type])==null?void 0:rt.decimals;Y!==R&&st({...i,decimals:R}),K!==_e&&st({...s,decimals:_e});let Ae;(c==null?void 0:c.coin_type)===(s==null?void 0:s.coin_type)?Ae=T:Ae=z(1).div(T).toFixed(_e);try{const ce={pay_coin_type:i.coin_type,target_coin_type:s.coin_type,expired_ts:A,target_decimal:_e,pay_decimal:R,price:Number(Ae),pay_coin_amount:Number(lt(S,R).toFixed(0))},at=await x.LimitOrder.placeLimitOrder(ce),we=await m(at,u);He(!1),we&&(n(),r(),tt())}catch(ce){Gt(String(ce)),He(!1)}},{currentAccount:oe}=se(),it=d.useMemo(()=>{const u=g(i==null?void 0:i.coin_type,S);return Number(u)==0&&Number(S)>0?!1:Number(u)<5},[i,S]),Qt=d.useMemo(()=>{const u={text:"Place Limit Order",disabled:!1};return oe!=null&&oe.address?!i||!s?(u.disabled=!0,u.text=" Select a token",u):!Number(S)||!Number(E)?(u.disabled=!0,u.text="Enter an amount",u):it?(u.disabled=!0,u.text="Order size should be higher than $5",u):Number(S)>Number(C==null?void 0:C.balanceFormat)||!(C!=null&&C.balanceFormat)?(u.disabled=!0,u.text=`Insufficient ${i==null?void 0:i.symbol} balance`,u):pe&&pe.errorCode&&(pe.errorCode===pt.NoRouter||pe.errorCode===pt.HoneyPot)?(u.text="No Available Route",u.disabled=!0,u):(console.log("ðŸš€ ~ buttonTextStatus ~ priceImpact:",12,ue.color,ue,xe),ue.color.toLowerCase()=="#ffb62d"&&(Number(xe)<-10||Number(xe)>10)&&(u.disabled=!0),u):(u.disabled=!1,u.text="Connect Wallet",u)},[oe==null?void 0:oe.address,i,s,pe,S,E,it,C,JSON.stringify(ue),xe]);return{priceImpactInfoLoading:Bt,priceImpactInfo:ue,fixPayCoin:H,onReverseClick:$t,handleSelectToken:et,marketPrice:k,payCoin:i,targetCoin:s,handleAmountChange:Ie,payAmount:S,targetAmount:E,payBalanceInfo:C,targetBalanceInfo:q,payAmountValue:de,targetAmountValue:Me,useMarketPrice:D,handleMarketPriceClick:Wt,inputPrice:T,setInputPrice:$,priceImpact:xe,quoteToken:c,setQuoteToken:O,handleSubmitOrder:Kt,submitOrderLoading:Vt,buttonTextStatus:Qt}}const Ms=({confirmData:t,isOpen:n,onClose:r,handleSubmitOrder:m,submitOrderLoading:x})=>{const{payAmount:p,targetAmount:g,payCoin:h,targetCoin:a,inputPrice:o,expiresIn:l,quoteToken:i}=t,s=d.useMemo(()=>{var b,f;return console.log("ðŸš€ ~ price ~ inputPrice:",o),o?((b=i==null?void 0:i.coin_type)==null?void 0:b.toLowerCase())==((f=a==null?void 0:a.coin_type)==null?void 0:f.toLowerCase())?o:z(1).div(o).toString():""},[i,a,o]),c=d.useMemo(()=>{var b,f;return o?((b=i==null?void 0:i.coin_type)==null?void 0:b.toLowerCase())==((f=a==null?void 0:a.coin_type)==null?void 0:f.toLowerCase())?z(1).div(o).toString():o:""},[i,a,o]);return e.jsxs(Fe,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Ne,{}),e.jsxs(De,{children:[e.jsx(Be,{children:e.jsx(jt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(We,{}),e.jsx($e,{textAlign:"center",p:"0px",children:e.jsxs(P,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(js,{coinA:{amount:W(p,h==null?void 0:h.decimals).toString()||"0",...h},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:W(g,a==null?void 0:a.decimals).toString()||"0",...a}}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Price"}),e.jsx(Q,{isLoaded:!!o,children:e.jsx(le,{info:{pay_coin:h,target_coin:a,price:s,reseverPrice:c}})})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(_,{children:"Expires in"}),e.jsx(_,{color:"text_caption",children:l})]}),e.jsx(G,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(G,{borderRadius:"12px",p:"8px",children:e.jsx(_,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(I,{onClick:()=>{m(),r()},disabled:x,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},Es=({isOpen:t,onClose:n})=>{const{isApp:r}=re(),{setCustomExpiresVal:m,setExpiresIn:x}=ae(),[p,g]=d.useState(""),[h,a]=d.useState(""),o=L=>{const O=L.target.value.replace(/[^\d]/g,"");g(O)},l=L=>{const O=L.target.value.replace(/[^\d]/g,"");a(O)},[i,s]=d.useState({}),c=(L,O)=>{const v=Number(L||0)*60+Number(O||0),M=Math.floor(v/(60*24)),y=Math.floor(v%(60*24)/60),S=v%60;let w="";M>0&&(w+=M+"d "),y>0&&(w+=y+"h "),S>0&&(w+=S+"m "),s({timeText:w.trim()||"0 m",time:v*60*1e3})};d.useEffect(()=>{c(p,h)},[p,h]);const b=d.useMemo(()=>!p&&!h||Number(p)==0&&!h||Number(h)==0&&!p||Number(p)==0&&Number(h)==0,[p,h]),f=()=>{x(i==null?void 0:i.timeText),m(i==null?void 0:i.time),n()};return e.jsxs(Fe,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Ne,{}),e.jsxs(De,{maxW:"1200px",w:r?"calc(100vw - 32px)":"440px",children:[e.jsx(Be,{mr:"-10px",children:e.jsxs(j,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(j,{gap:"0",align:"center",children:e.jsx(We,{mt:"0",position:"static"})})]})}),e.jsx($e,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(P,{w:"100%",children:[e.jsx(Ce,{children:e.jsxs(j,{children:[e.jsx(ct,{value:p,onChange:o,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Hours"})]})}),e.jsx(Ce,{children:e.jsxs(j,{children:[e.jsx(ct,{value:h,onChange:l,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(_,{children:"Minutes"})]})}),e.jsx(I,{onClick:f,disabled:b,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function Hs(t){const{expiresIn:n,setExpiresIn:r}=ae(),[m,x]=d.useState(!1),p=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(Ce,{w:"156px",borderRadius:"16px",children:[e.jsxs(P,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(Ge,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(j,{gap:"4px",children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(ee,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(xs,{label:n||"",list:p,onListItemClick:g=>{g=="Custom"?x(!0):r(g)}})]}),m&&e.jsx(Es,{isOpen:m,onClose:()=>x(!1)})]})}function As(t){re();const{marketPrice:n,priceImpactInfo:r,priceImpactInfoLoading:m,priceImpact:x,inputPrice:p,handleMarketPriceClick:g,setInputPrice:h}=t,{payCoin:a,targetCoin:o,quoteToken:l,refreshPriceLoading:i,setQuoteToken:s}=ae();return e.jsx(Ce,{w:"calc(100% - 156px)",children:e.jsxs(P,{w:"100%",gap:"20px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsxs(j,{children:[e.jsx(_,{fontSize:"13px",fontWeight:"500",children:(l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?`Buy ${dt(o==null?void 0:o.symbol,10)} at rate`:`Sell ${dt(a==null?void 0:a.symbol,10)} at rate`}),Number(x)!==0&&!i&&(m?e.jsx(Xt,{size:"sm"}):e.jsx(Ge,{placement:"top",tooltip:e.jsx(_,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:r.tooltip}),children:e.jsxs(_,{color:r.color,children:[z(x).gt(0)?"+":"",Number(x)>1e4?">10000%":St(x)]})}))]}),(n||i)&&e.jsx(I,{isLoading:i,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>g(!0),children:"Market"})]}),e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsx(Tt,{value:p?ss(p).toString():"",onChange:c=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",p,c),g(!1),h(c)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(_,{textColor:"text_caption",children:l==null?void 0:l.symbol}),e.jsx(ee,{xlinkHref:"#icon-icon_swap1",onClick:()=>{o&&a&&((l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?s(o):s(a))}})]})]})]})})}function Rs(){const{expiresIn:t}=ae(),{buttonTextStatus:n,payBalanceInfo:r,targetBalanceInfo:m,payAmountValue:x,targetAmountValue:p,payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,marketPrice:l,handleAmountChange:i,handleMarketPriceClick:s,handleSelectToken:c,inputPrice:b,setInputPrice:f,priceImpact:L,quoteToken:O,handleSubmitOrder:v,submitOrderLoading:M,onReverseClick:y,priceImpactInfoLoading:S,priceImpactInfo:w}=ks(),E=d.useMemo(()=>({payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,inputPrice:b,expiresIn:t,quoteToken:O}),[g,h,a,o,b,t,O]),{onWalletModal:N}=se(),[H,J]=d.useState("#icon-a-icon_trade"),D=C=>J(C?"#icon-icon_swap1":"#icon-a-icon_trade"),[V,T]=d.useState(!1),$=yt(),k=d.useMemo(()=>{const C=[];return a&&C.push(a),o&&C.push(o),C},[a,o]);return e.jsxs(P,{w:{base:"100%",lg:"470px"},gap:"8px",mb:"8px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(ms,{currTradeTab:gs.Limit}),e.jsx(us,{})]}),e.jsx(ds,{onClick:y,from:{title:"You Pay",balance:(r==null?void 0:r.balanceFormat)||"",value:g,amountValue:x,onChange:C=>{i(C,!0)},selectable:!0,placeholder:"0.0",token:a,onTokenChange:C=>{c(C,!0)}},to:{title:"You Receive",balance:(m==null?void 0:m.balanceFormat)||"",value:h,amountValue:p,onTokenChange:C=>{c(C,!1)},onChange:C=>{i(C,!1)},selectable:!0,placeholder:"0.0",token:o,half:!1,max:!1},iconParams:{xlinkHref:H,svgFill:"text_caption",transform:H==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:H==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>D(!0),onMouseLeave:()=>D(!1)}}),e.jsxs(j,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(As,{marketPrice:l,priceImpactInfoLoading:S,priceImpactInfo:w,priceImpact:L,inputPrice:b,setInputPrice:f,handleMarketPriceClick:s}),e.jsx(Hs,{})]}),(w==null?void 0:w.text)&&l&&Number(L)!==0&&b&&e.jsxs(_,{color:w==null?void 0:w.color,lineHeight:"20px",bg:w==null?void 0:w.bg,p:"12px",borderRadius:"8px",children:[w==null?void 0:w.text,"Â ",e.jsx(_,{color:w==null?void 0:w.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>$(`/swap/${a==null?void 0:a.coin_type}/${o==null?void 0:o.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(I,{disabled:(n==null?void 0:n.disabled)||M,isLoading:M,mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",onClick:(n==null?void 0:n.text)=="Connect Wallet"?()=>N(!0):()=>T(!0),children:n==null?void 0:n.text}),V&&e.jsx(Ms,{confirmData:E,isOpen:V,onClose:()=>T(!1),handleSubmitOrder:v,submitOrderLoading:M}),(a||o)&&e.jsx(ps,{addToken:!0,tokensInfo:k,waringModalCancel:C=>{C.forEach(q=>{(q.coin_type===(a==null?void 0:a.coin_type)||q.coin_type===(o==null?void 0:o.coin_type))&&c(void 0,q.coin_type===(a==null?void 0:a.coin_type))})}})]})}function zs({orderInfo:t}){return e.jsxs(Le.Fragment,{children:[e.jsxs(U,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(F,{w:"30%",children:e.jsx(je,{info:t})}),e.jsx(F,{w:"20%",textAlign:"right",children:e.jsx(le,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(fe,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(be,{info:t})}),e.jsx(F,{textAlign:"right",children:e.jsx(ze,{orderInfo:t})})]}),e.jsx(U,{h:"16px"})]},t==null?void 0:t.order_id)}function Fs(){const{currentAccount:t,onWalletModal:n}=se(),{myOrderList:r,orderListLoading:m}=Pe();console.log("ðŸš€ ~ OrderTableList ~ myOrderList:",r);const x=10,[p,g]=d.useState([]),[h,a]=d.useState(0),[o,l]=d.useState(1);return d.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const i=(o-1)*x,s=i+x;g(r.slice(i,s))}},[o,r]),e.jsxs(ft,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(_t,{children:e.jsxs(U,{children:[e.jsx(Z,{children:"Order Info"}),e.jsx(Z,{textAlign:"right",children:"Price"}),e.jsx(Z,{textAlign:"right",children:"Filled Size"}),e.jsx(Z,{textAlign:"right",children:"Expiry"}),e.jsx(Z,{textAlign:"right",children:"Action"})]})}),e.jsx(wt,{children:t!=null&&t.address?m?e.jsx(Pt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):r.length===0?e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(F,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(Le.Fragment,{children:[p.map(i=>e.jsx(zs,{orderInfo:i},i.order_id)),!m&&(r==null?void 0:r.length)>x&&e.jsx(F,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(he,{w:"100%",children:e.jsx(ve,{total:h,size:x,currentPage:o,onChange:l})})})]}):e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(F,{colSpan:5,w:"100%",children:e.jsx(te,{type:"nowallet",onboard:()=>{n(!0)},borderRadius:"16px"})})})})]})}function Ns(){const{fetchByApi:t}=is(),{getTokenListInfo:n}=Je(),{currentAccount:r}=se(),[m,x]=d.useState(!1),[p,g]=d.useState([]);d.useEffect(()=>{g([])},[r==null?void 0:r.address]);const h=async(o,l)=>{var i;try{l&&x(!0);const s=await t(ns,"GET",{wallet_address:o});if(console.log(s,"getLimitOrderHistory"),s!=null&&s.list&&((i=s==null?void 0:s.list)==null?void 0:i.length)>0){const c=await a((s==null?void 0:s.list)||[]);return g(c),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",c),c}return[]}catch(s){return console.log("getLimitOrderHistory ~ error:",s),[]}finally{x(!1)}},a=async o=>{const l=[],i=[];for(const c of o)i.push(ne(c.pay_coin,!1)),i.push(ne(c.target_coin,!1));const s=await n(i);for(const c of o){const[b,f]=[s==null?void 0:s.get(ne(c.pay_coin,!1)),s==null?void 0:s.get(ne(c.target_coin,!1))];if(b&&f){const{total_pay_amount:L,remaining_amount:O,rate:v,obtained_amount:M,claimed_amount:y,target_balance:S,created_ts:w,expire_ts:E,cancel_reason:N,events:H}=c,J=H;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",c,J),J.sort((C,q)=>q.block_time-C.block_time);const D=ie(L,b.decimals).toString(),V=Ot.rateToPrice(v.toString(),b.decimals,f.decimals),T=X(1).div(V).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",V,T);const $=ie(X(L).sub(O).toFixed(0),b.decimals).toString(),k={order_id:c.order_id,pay_coin:b,target_coin:f,price:V,reseverPrice:T,total_pay_amount:D,remaining_amount:O,deal_amount:$,deal_rate:X($).div(D).toString(),expect_obtain_amount:X(D).mul(V).toString(),obtained_amount:M,claimed_amount:y,un_claimed_amount:"0",created_ts:w,expire_ts:E,status:Number(N)===0?ye.Completed:ye.Cancelled,events:J};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",k),l.push(k)}}return l.sort((c,b)=>b.created_ts=c.created_ts),l};return{getLimitOrderHistory:h,historyOrderLoading:m,historyOrderList:p}}function Ai(){const{currentAccount:t}=se(),{getLimitOrderHistory:n,historyOrderList:r,historyOrderLoading:m}=Ns(),{fetchMyLimitOrder:x}=ke(),{setMyOrderList:p,myOrderList:g,orderListLoading:h}=Pe(),{payCoin:a,targetCoin:o}=ae(),{fetchAccountBalance:l}=Te();d.useEffect(()=>{t!=null&&t.address&&l()},[]);const{isShowTradeChart:i,isShowTradeOrders:s}=hs(),[c,b]=d.useState([]),[f,L]=d.useState({label:"Open Orders"}),O=d.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",g);const H=[];return H.push({label:"Open Orders",num:f.label==="Open Orders"&&g.length>0&&!h?g.length.toString():void 0}),H.push({label:"Order History",num:f.label==="Order History"&&c.length>0&&!m?c.length.toString():void 0}),H},[f.label,g,c,m,h]);d.useEffect(()=>{v(!0)},[f.label,t,s]),_s({onRpcChange:()=>{v(!0),t!=null&&t.address&&l()}});const v=H=>{s&&(N(0),console.log("ðŸš€  ~ currentAccount:",f.label==="Open Orders",t==null?void 0:t.address),t!=null&&t.address&&(f.label==="Open Orders"?x(t.address,H):(console.log("ðŸš€ ~  ~ currentAccount:",t),n(t.address,H))))};d.useEffect(()=>{t!=null&&t.address&&(r==null?void 0:r.length)>0?b(r):(b([]),p([]))},[r,t==null?void 0:t.address]);const M=H=>{L(H)},{windowWidth:y,isApp:S}=re(),{refreshCoinMarketPrice:w}=At(),[E,N]=d.useState(0);return fs({interval:1e3,callback:()=>{N(E+1),E>=20&&(N(0),w(),t!=null&&t.address&&l(),v(!1))}}),e.jsxs(P,{mt:y&&y<1024?"28px":"42px",w:"100%",gap:"0px",className:S||i||s?"":"bg_img",children:[e.jsxs(j,{w:"100%",justifyContent:"center",alignItems:"start",gap:"16px",flexDirection:{base:i?"column":"column-reverse",lg:"row"},children:[(s||i)&&e.jsx(j,{gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:i?e.jsx(bs,{baseToken:a,quoteToken:o}):e.jsxs(P,{w:"100%",children:[e.jsx(ht,{tabList:O,currTab:f,myOrderList:g,handleChangeTab:M,handleGetOrderList:v}),f.label==="Open Orders"&&e.jsx(mt,{}),f.label==="Order History"&&e.jsx(gt,{historyOrderList:c,historyOrderLoading:m})]})}),e.jsx(Rs,{})]}),s&&i&&e.jsxs(P,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(ht,{handleGetOrderList:()=>v(!0),tabList:O,currTab:f,myOrderList:g,handleChangeTab:M}),S&&e.jsx(bt,{h:"16px"}),f.label==="Open Orders"&&(S?e.jsx(mt,{}):e.jsx(Fs,{})),f.label==="Order History"&&(S?e.jsx(gt,{historyOrderList:c,historyOrderLoading:m}):e.jsx(vs,{historyOrderList:c,historyOrderLoading:m}))]})]})}const ht=({tabList:t,currTab:n,myOrderList:r,handleChangeTab:m,handleGetOrderList:x})=>{const{handleCancelOrder:p,cancelOrderLoading:g}=Et(),{isApp:h}=re(),a=n.label==="Open Orders"&&r.length>1;return e.jsxs(j,{w:"100%",justifyContent:"space-between",flexDirection:{base:n.label==="Open Orders"&&r.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(j,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx(vt,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:t,currentTab:n.label,handleChangeTab:m}),h&&e.jsx(ut,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!h||a)&&e.jsxs(j,{gap:"8px",w:{base:"100%",lg:"unset"},children:[a&&e.jsx(I,{onClick:()=>{p(r)},disabled:g,isLoading:g,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"-8px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!h&&e.jsx(ut,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{Ai as default};
//# sourceMappingURL=Limit-Cro0CBpe.js.map

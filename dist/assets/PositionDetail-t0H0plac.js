import{a1 as ae,r as b,ab as U,d as V,b as te,j as e,W as N,m as se,T as c,V as L,H as d,g as P,S as z,as as pe,aB as ge,$ as xe,a$ as Ce,e as he,a5 as be,aO as Se,B as je,aN as ue,aQ as ve,bb as Ae,Y as ke,a as Re,bc as Le,a_ as We,k as Ee}from"./index-c8x0neDx.js";import{A as Fe}from"./AprTooltip-CSg3mjFm.js";import{C as He}from"./CoinPairInfo-DomE04Yu.js";import{S as Ve}from"./Slippage-D4t4y3eq.js";import{u as ze,c as Me,L as Ne,b as fe,S as I}from"./useGetContractPoolInfo-Cl2Izg4L.js";import{u as De,a as Ge,P as Ue}from"./PositionCurrentPrice-D6GxFQKB.js";import{u as ee,a as ye}from"./useCurrentPos-Bg9_OBWV.js";import{e as Ye,f as Oe,c as Q,b as qe}from"./usePositionList-jMKEHL_-.js";import{A as we}from"./AddressCopyLink-CXikOUHz.js";import{C as $e}from"./CetusTooltip-CGhijhrv.js";import{u as Te}from"./useAccountBalance-CZOHOa8D.js";import{u as Qe}from"./useTransaction-DAoWoqXP.js";import{L as Je}from"./PriceRange-lF99gfNF.js";import{P as Ke}from"./progress-BaDu_ehH.js";import{L as le}from"./LockInput-C6EUUthc.js";import{u as Xe}from"./usePosAdd-3nc6fJ9x.js";import{T as Ze}from"./TradeInputGroup-DQRm61m2.js";import{F as Be,R as Ie}from"./RemoveBlock-CY8GubRl.js";import{R as Pe}from"./RangeAlerts-CxUCJldo.js";import{T as ei}from"./TooltipIcon-B5wViqRg.js";import{P as ii}from"./PositionStatus-BMJM4Hh1.js";import{R as si}from"./RangeValue-qMaWWfA-.js";import{u as li}from"./index-DI5Q0fYc.js";import{b as pi,u as ai}from"./useGetPoolList-COr9_t00.js";import{R as re}from"./RefreshButton-S2zh08Pz.js";import{u as ti}from"./useRpcListener-BS06EUQo.js";import"./useToken-D-6xB-ST.js";import"./generateCategoricalChart-BQB8abrb.js";import"./debounce-Cbctf6FT.js";import"./throttle-Ci4i6U0I.js";import"./index-DwhjM_Xa.js";import"./global-DLT0J0mI.js";import"./index-9_VNld9X.js";import"./useTokenBalance-eq1GEE9D.js";import"./switch-81cBGCWx.js";import"./liquidity-w8VwWcFh.js";import"./usePreviousValue-B4Ws-I5w.js";import"./ActionButton-Db0-lE8T.js";import"./HTextLabelBox-C9FZcI0L.js";import"./VTextLabelBox-dt-U3a_S.js";import"./useBurn-BFWB3TFT.js";import"./msafe-oYBkW7LJ.js";import"./api-data-utils-0d_jjn6h.js";import"./AddressUnderline-D-OGLlr6.js";import"./SingleTokenInfo-DeVv6bgN.js";import"./progress.utils-lPdRWm8i.js";import"./icon_lock@2x-OdzkPjmc.js";import"./useInsufficientBalanceToast-CiJ4SaVO.js";import"./_getAllKeysIn-C6E0GMPP.js";import"./useNotifiSubscription-La67Z7V_.js";import"./useXCetusHelper-C-BGnfq1.js";import"./ExpendItem-CMlZ1emu.js";function xi(){var X,Z,O,q,H,de;const{tokenAmountA:s,tokenAmountB:p,currentPosDetailTab:x,curPosContractPoolInfo:a}=ee(),{getPosFeeData:u}=Ye(),{getPosRewardsData:r}=Oe(),{currentAccount:n}=ae(),{currentPosBaseInfo:i,posFeeData:g,posRewardsData:m,posLiquidityData:j,currentPosBaseInfoLoading:R,posFeeDataLoading:v,posRewardsDataLoading:l}=Q();ye();const t=b.useMemo(()=>j[i==null?void 0:i.posId],[j,i==null?void 0:i.posId]),y=b.useMemo(()=>(console.log("ðŸš€ ~ currentPosFeeData ~ posFeeData[currentPosBaseInfo?.posId as string]:",g[i==null?void 0:i.posId]),g[i==null?void 0:i.posId]),[g,i==null?void 0:i.posId]),_=b.useMemo(()=>(console.log("ðŸš€ ~ currentPosRewardsData ~ posRewardsData[currentPosBaseInfo?.posId as string]:",m[i==null?void 0:i.posId]),m[i==null?void 0:i.posId]),[m,i==null?void 0:i.posId]),w=U(t==null?void 0:t.displayCoinAmountA,void 0,!0),W=U(t==null?void 0:t.displayCoinAmountB,void 0,!0),[C,A]=b.useState(!1),[E,T]=b.useState("--"),{signAndExecuteTransaction:S}=Qe(),{getPosClaimFeeAndRewardTxPayload:f}=De(),{calculatePendingYield:D}=Ge();b.useEffect(()=>{if(!R&&!v&&!l){const{total:h}=D([i],g,m);T(h)}},[R,v,l]);const{fetchAccountBalance:k}=Te(),M=async()=>{A(!0);try{const h=(_==null?void 0:_.map(ie=>ie.coin_address))||[],B={posType:i==null?void 0:i.posType,id:i==null?void 0:i.id,clmmPool:i==null?void 0:i.clmmPool,coinTypeA:i==null?void 0:i.coinTypeA,coinTypeB:i==null?void 0:i.coinTypeB,rewarderCoinTypes:h,account:n==null?void 0:n.address};console.log("ðŸš€ ~ toClaim ~ params.currentPosBaseInfo:",B,i);const{tx:ne,msafeParams:_e}=await f(B);console.log("ðŸš€ ~ toClaim ~ tx:",ne);const oe=await S(ne,{getShowInfo:ie=>{const ce={modalDescriptionText:"",toastTitleText:""};return ie==="success"&&(ce.toastTitleText="Claim Successful"),ce}},{msafeParams:_e});console.log("ðŸš€ ~ toClaim ~ res:",oe),oe&&setTimeout(()=>{k(),u([i]),r([i],{[a.poolAddress]:a})},2e3),A(!1)}catch(h){A(!1),console.log("ðŸš€ ~ toClaim ~ error:",h)}},F=s!==""||p!=="",G=V(+w).sub(+s).toString(),J=F?V(w).eq(0)?"0":x=="increase"?V(s).plus(w).toString():V(G).gt(0)?G:"0":"",Y=V(+W).sub(+p).toString(),o=F?V(W).eq(0)?"0":x=="increase"?V(p).plus(W).toString():V(Y).gt(0)?Y:"0":"",{isApp:K}=te();return e.jsxs(N,{w:"100%",borderRadius:"16px",p:"0",children:[e.jsx(N,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"auto",lg:"80px"},p:{base:"20px 8px",lg:"20px 20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(se,{flexDir:{base:"column",lg:"row"},w:"100%",justify:{base:"center",lg:"space-between"},gap:{base:"16px",lg:"0"},children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},align:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},mt:{base:"-12px",lg:"0"},children:[e.jsx(c,{color:"primary_gray",mb:{base:"0",lg:"-12px"},children:"Liquidity"}),e.jsx(Je,{positionInfo:i,haveTooltip:!1})]}),e.jsxs(L,{minW:"200px",align:{base:"center",lg:"flex-end"},pb:{base:"0",lg:"12px"},gap:"12px",children:[e.jsxs(d,{w:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(d,{gap:"4px",children:[e.jsx(P,{imageUrl:(X=i==null?void 0:i.displayTokenA)==null?void 0:X.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?(Z=i==null?void 0:i.displayTokenA)==null?void 0:Z.coin_type:""}),e.jsx(z,{isLoaded:!!i&&!!t,children:e.jsxs(d,{gap:"4px",children:[e.jsx(c,{color:"primary",children:pe((O=i==null?void 0:i.displayTokenA)==null?void 0:O.symbol)}),e.jsxs(c,{color:"primary",children:[t==null?void 0:t.displayPercentA,"%"]})]})})]}),e.jsxs(d,{gap:"4px",children:[e.jsx(P,{imageUrl:(q=i==null?void 0:i.displayTokenB)==null?void 0:q.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:i?(H=i==null?void 0:i.displayTokenB)==null?void 0:H.coin_type:""}),e.jsx(z,{isLoaded:!!i&&!!t,children:e.jsxs(d,{gap:"4px",children:[e.jsx(c,{color:"primary_green",children:pe((de=i==null?void 0:i.displayTokenB)==null?void 0:de.symbol)}),e.jsxs(c,{color:"primary_green",children:[t==null?void 0:t.displayPercentB,"%"]})]})})]})]}),e.jsx(Ke,{w:"200px",h:"4px",value:t==null?void 0:t.displayPercentA,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})}),e.jsxs(d,{gap:{base:"20px",lg:"8px"},p:{base:"20px 8px",lg:"40px 8px"},w:"100%",justify:"space-around",flexDirection:{base:"column",lg:"row"},children:[e.jsx($,{label:"Base",token:i==null?void 0:i.displayTokenA,amount:t==null?void 0:t.displayCoinAmountA,afterAmount:J}),e.jsx($,{label:"Quote",token:i==null?void 0:i.displayTokenB,amount:t==null?void 0:t.displayCoinAmountB,afterAmount:o})]}),e.jsx(N,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"70px",lg:"80px"},p:{base:"20px 8px",lg:"20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},alignItems:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},w:{base:"100%",lg:"auto"},children:[e.jsx(c,{color:"primary_gray",children:"Pending Yield"}),e.jsx(z,{isLoaded:!!E&&!!i&&!!g&&!!m,children:e.jsx(c,{color:"text_caption",fontSize:"16px",children:ge(E,2)})})]}),e.jsx(xe,{isLoading:C,disabled:Number(E)==0||v||l||C||!y,onClick:M,w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",children:"Claim"})]})}),e.jsxs(d,{p:{base:"20px 8px 0",lg:"40px 8px 20px"},w:"100%",justify:"space-between",flexWrap:"wrap",sx:{">div":{mb:{base:"12px",lg:"20px"}}},flexDirection:{base:"column",lg:"row"},children:[e.jsx($,{label:"Fees",token:i==null?void 0:i.displayTokenA,amount:y==null?void 0:y.displayFeeOwedA,afterAmount:F?"0":""}),e.jsx($,{label:K?"":"Fees",token:i==null?void 0:i.displayTokenB,amount:y==null?void 0:y.displayFeeOwedB,afterAmount:F?"0":""}),_==null?void 0:_.map((h,B)=>e.jsx(Ce.Fragment,{children:V(h.amount_owed).gt(0)&&e.jsx($,{label:K?B==0?"Mining Rewards":"":"Mining Rewards",token:h==null?void 0:h.token,amount:h==null?void 0:h.display_amount_owed,afterAmount:F?"0":""})},h==null?void 0:h.coin_address))]})]})}const $=({label:s,token:p,amount:x,afterAmount:a,isLoading:u})=>{const{isApp:r}=te(),{getExplorerUrl:n}=he();return e.jsxs(L,{align:{base:"flex-end",lg:"center"},gap:{base:"4px",lg:"8px"},w:{base:"100%",lg:"calc(50% - 4px)"},children:[e.jsxs(d,{w:"100%",justify:{base:"space-between"},flexDirection:{base:"row",lg:"column"},children:[e.jsx(c,{color:"primary_gray",children:s}),e.jsxs(d,{children:[e.jsx($e,{showTooltip:!r,placement:"top",tooltip:e.jsxs(d,{children:[e.jsx(P,{imageUrl:p==null?void 0:p.logo_url,w:"20px",h:"20px",minH:"20px",minW:"20px",showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:""}),e.jsx(c,{color:"text_caption",children:p==null?void 0:p.symbol}),e.jsx(we,{address:p==null?void 0:p.coin_type,onClickLink:()=>window.open(n(p==null?void 0:p.coin_type,"coin"))})]}),children:e.jsx(P,{imageUrl:p==null?void 0:p.logo_url,w:{base:"20px",lg:"28px"},h:{base:"20px",lg:"28px"},minH:{base:"20px",lg:"28px"},minW:{base:"20px",lg:"28px"},showTagWidth:"14px",showTagHeight:"14px",coinType:p?p==null?void 0:p.coin_type:"",onClick:r?()=>window.open(n(p==null?void 0:p.coin_type,"coin")):()=>{}})}),e.jsx(z,{isLoaded:!u&&!!x,children:e.jsx(c,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:U(x)})}),e.jsx(c,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:pe(p==null?void 0:p.symbol)})]})]}),a!==""&&a&&e.jsxs(d,{bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(c,{color:"primary",children:U(a)}),e.jsx(c,{color:"primary",children:"after"})]})]})};function di(){const{currentPosBaseInfo:s,posPoolsRelatedData:p}=Q(),{currentAccount:x,onWalletModal:a}=ae(),{tokenAmountA:u,tokenAmountB:r,isFixedDisplayTokenA:n,curPosContractPoolInfo:i}=ee(),{displayTokenA:g,displayTokenB:m,tokenABalanceInfo:j,tokenBBalanceInfo:R,tokenAmountValueA:v,tokenAmountValueB:l,handleAmountChange:t,preAddLoading:y,btnStatusText:_,toAdd:w,isAddLoading:W,showDisplayTokenALock:C,showDisplayTokenBLock:A,resetInputAmount:E}=Xe();b.useEffect(()=>()=>{E()},[]);const{getTokenAmountValue:T}=be(),S=T(g==null?void 0:g.coin_type,u,"--"),f=T(m==null?void 0:m.coin_type,r,"--"),D=S=="--"||f=="--"?"--":Se(v).plus(l).toString(),k=p[s==null?void 0:s.posId];return e.jsxs(L,{w:"100%",gap:"8px",children:[e.jsxs(je,{w:"100%",position:"relative",children:[e.jsx(Ze,{from:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(j==null?void 0:j.balanceFormat)||"",value:u,amountValue:v,loading:!n&&y,onChange:M=>{t(M,!0)},placeholder:"0.0",token:g},to:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(R==null?void 0:R.balanceFormat)||"",value:r,amountValue:l,loading:n&&y,onChange:M=>{t(M,!1)},placeholder:"0.0",token:m},iconParams:C||A?void 0:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),(!s||!i)&&e.jsx(le,{position:"absolute",top:"0px",left:"0",borderRadius:"12px",h:"224px",zIndex:9999}),s&&(s==null?void 0:s.posType)=="burn"&&e.jsx(le,{position:"absolute",top:"0px",left:"0",h:"224px",borderRadius:"12px",text:"Your liquidity has been permanently locked",zIndex:9999}),s&&i&&(C||A)&&e.jsx(le,{position:"absolute",top:C?"0px":"116px",borderRadius:"12px",h:"108px",left:"0"})]}),e.jsx(xe,{onClick:()=>{x?w():a(!0)},isLoading:W,disabled:_.disabled||W,w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:_.text}),+D&&e.jsx(N,{borderRadius:"0 0 12px 12px",pt:"36px",mt:"-28px",children:e.jsxs(d,{w:"100%",justify:"space-between",children:[e.jsx(c,{children:"Total Amount"}),e.jsx(c,{color:"text_caption",children:ge(D,2)})]})}),(s==null?void 0:s.posType)!=="burn"&&e.jsx(Be,{}),k&&(k==null?void 0:k.minPrice)!=="0"&&(k==null?void 0:k.maxPrice)!=="âˆž"&&e.jsx(Pe,{subscriptionSource:"PositionDetail"})]})}function ni(){const{currentPosBaseInfo:s}=Q(),{currentPosPoolInfo:p,curPosContractPoolInfo:x}=ee(),{setContractPoolInfo:a,setApiPoolInfo:u}=li(),{lowerTickData:r,upperTickData:n,setLowerTickData:i,setUpperTickData:g}=ze();ue(()=>{u(p)},[p]);const m=(v,l,t)=>{var T,S;const y=(T=t==null?void 0:t.tokenA)==null?void 0:T.decimals,_=(S=t==null?void 0:t.tokenB)==null?void 0:S.decimals;let w;Math.abs(v)==Math.abs(ve.getMinIndex(Number(t.tickSpacing)))?w=l==="lower"?"0":"âˆž":w=Ae.tickIndexToPrice(v,y,_).toString();const W=w==="âˆž"?"âˆž":U(w,6),C=pi(w),A=C==="âˆž"?"âˆž":U(C,6),E={id:l,tokenA:t==null?void 0:t.tokenA,tokenB:t==null?void 0:t.tokenB,tick:v,price:w,displayPrice:W,reversePrice:C,displayReversePrice:A,tickSpacing:t==null?void 0:t.tickSpacing,pool:t==null?void 0:t.poolAddress};l==="lower"?i({...E}):g({...E})},{getCurrentPrice:j}=Me();b.useEffect(()=>{s!=null&&s.lowerTick&&(x!=null&&x.current_sqrt_price)&&(p!=null&&p.poolAddress)&&(m(s==null?void 0:s.lowerTick,"lower",p),m(s==null?void 0:s.upperTick,"upper",p),j(x==null?void 0:x.current_sqrt_price,p),a(x))},[s==null?void 0:s.lowerTick,x==null?void 0:x.current_sqrt_price,p==null?void 0:p.poolAddress]);const R=b.useMemo(()=>(s==null?void 0:s.posId)&&(r==null?void 0:r.pool)&&(n==null?void 0:n.pool),[r==null?void 0:r.pool,n==null?void 0:n.pool,s==null?void 0:s.posId]);return e.jsx(je,{className:"chart-block",w:{base:"100%",lg:"200px"},h:"85px",mb:"8px",overflow:"hidden",children:R&&e.jsx(Ne,{isFrom:"position",handleClickRefresh:()=>{},direct:!(s!=null&&s.isReverse),minPriceData:s!=null&&s.isReverse?n:r,maxPriceData:s!=null&&s.isReverse?r:n,readonly:!0})})}function oi(){const{currentPosBaseInfo:s,posPoolsRelatedData:p,posPoolsOriginalData:x}=Q(),a=p[s==null?void 0:s.posId],{getClmmPosName:u}=qe(),r=b.useMemo(()=>{var m;if(s!=null&&s.tokenName)return s==null?void 0:s.tokenName;{const j=(m=x==null?void 0:x[s==null?void 0:s.clmmPool])==null?void 0:m.index;return u(s==null?void 0:s.index,j)}},[s==null?void 0:s.tokenName,s==null?void 0:s.index,s==null?void 0:s.clmmPool,x]);(a==null?void 0:a.displayFee)+"";const n=(a==null?void 0:a.currentStatus)=="Active",i=b.useMemo(()=>{console.log("ðŸš€ ~ leverage ~ currentPosPoolsRelatedData:",a);const m=a==null?void 0:a.minPriceOrigin,j=a==null?void 0:a.maxPriceOrigin;return m!=="0"&&j!=="âˆž"?ke(1/(1-Number((m/j)**.25)),2)+"x":"1x"},[a==null?void 0:a.minPriceOrigin,a==null?void 0:a.maxPriceOrigin]),{getExplorerUrl:g}=he();return e.jsxs(N,{w:"100%",borderRadius:"20px 20px 16px 16px",children:[e.jsx(N,{p:{base:"16px 8px",lg:"16px"},w:"calc(100% + 34px)",ml:"-17px",mt:"-21px",bg:"bg_primary",children:e.jsxs(d,{justify:"space-between",children:[e.jsxs(d,{h:{base:"40px",lg:"32px"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(d,{w:{base:"100%",lg:"unset"},children:[e.jsx(c,{children:"Position ID"}),e.jsx(z,{isLoaded:!!r,children:e.jsx(c,{color:"text_caption",children:r==null?void 0:r.split("|")[1]})})]}),e.jsxs(d,{w:{base:"100%",lg:"unset"},children:[e.jsx(c,{children:"Position NFT"}),e.jsx(z,{isLoaded:!!(s!=null&&s.id),children:e.jsx(we,{fontWeight:"500",color:"text_caption",fontSize:"14px",address:s==null?void 0:s.id,showLink:!1,onClickLink:()=>{window.open(g(s==null?void 0:s.id,"nftAddress"),"_blank")}})})]})]}),a&&e.jsx(ii,{isActive:n,isLoading:(a==null?void 0:a.currentStatus)=="",h:"32px",p:"0 12px",w:"unset",isRow:!0,imgStyle:{imgW:"30px",imgH:"16px"}})]})}),e.jsxs(d,{gap:{base:"20px",lg:"8px"},w:"100%",justify:"space-between",p:"28px 0 20px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(L,{gap:{base:"16px",lg:"32px"},children:[e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(c,{color:"primary_gray",children:"Current Price"}),e.jsx(Ue,{posId:(s==null?void 0:s.posId)||"",displayTokenA:s==null?void 0:s.displayTokenA,displayTokenB:s==null?void 0:s.displayTokenB})]}),e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(c,{color:"primary_gray",children:"Position Range"}),e.jsx(si,{displayTokenA:s==null?void 0:s.displayTokenA,displayTokenB:s==null?void 0:s.displayTokenB,justify:"center",priceInfo:{minPrice:a==null?void 0:a.minPrice,maxPrice:a==null?void 0:a.maxPrice,minPriceResever:a==null?void 0:a.minPriceResever,maxPriceResever:a==null?void 0:a.maxPriceResever},fontSize:"14px"})]})]}),e.jsxs(L,{gap:"0",children:[e.jsx(ni,{}),e.jsx(L,{zIndex:"9",children:e.jsxs(d,{gap:"2px",bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(c,{color:"primary",fontSize:"12px",children:"Leverage"}),e.jsx(ei,{type:"leverage"}),e.jsx(z,{ml:"4px",isLoaded:!!i&&!!a,children:e.jsx(c,{color:"primary",children:i})})]})})]})]})]})}function ns(){var J,Y;const s=Re(),{fetchAccountBalance:p}=Te(),{currentAccount:x}=ae(),{position_nft_id:a}=Le(),{getCurrentPosBaseInfo:u,getCurrentPosHistory:r}=ye(),{currentPosDetailTab:n,currentPosPoolInfo:i,setCurrentPosDetailTab:g,setCurrentPosPoolInfo:m,setCurrentPoolSqrtPrice:j,setCurPosContractPoolInfo:R}=ee(),{posPoolsRelatedData:v,currentPosBaseInfo:l,setCurrentPosBaseInfo:t,farmsPosRewardsData:y,posRewardsData:_}=Q(),w=(((J=v[l==null?void 0:l.posId])==null?void 0:J.displayFee)||"--")+"%",W=[{label:"Increase",value:"increase"},{label:"Remove",value:"remove"}],C=()=>{console.log("ðŸš€ ~ handleRefresh ~ handleRefresh:"),A(!0),k(),f(),p(),F()},A=(o=!1)=>{x!=null&&x.address&&a&&u(x==null?void 0:x.address,a,o)};b.useEffect(()=>{console.log("ðŸš€ ~ PositionDetail ~ position_nft_id:",a),A()},[x==null?void 0:x.address,a]),b.useEffect(()=>{console.log("ðŸš€ ~ PositionHistory ~ currentPosBaseInfo?.id:",l==null?void 0:l.id)},[l==null?void 0:l.id]);const{fetchTokenPrices:E}=be(),T=y[l==null?void 0:l.id],S=_[l==null?void 0:l.posId],f=()=>{var O,q;const o=(S==null?void 0:S.map(H=>H==null?void 0:H.coin_address))||[],K=(T==null?void 0:T.map(H=>H==null?void 0:H.rewarder_type))||[],X=[(O=l==null?void 0:l.tokenA)==null?void 0:O.coin_type,(q=l==null?void 0:l.tokenB)==null?void 0:q.coin_type].filter(Boolean),Z=Array.from(new Set([...o,...X,...K]));E(Z)};b.useEffect(()=>{f()},[l==null?void 0:l.posId,S==null?void 0:S.length,T==null?void 0:T.length]);const{getPoolList:D}=ai(),k=async()=>{if(!(l!=null&&l.clmmPool))return;const o=await D({pool:l==null?void 0:l.clmmPool});if(console.log("ðŸš€ ~ getPoolData ~ poolInfo:",l,o),o)return m(o==null?void 0:o.list[0])},{getContractPoolInfo:M}=fe(),F=async()=>{if(console.log("ðŸš€ ~ handleGetPrice ~ currentPosBaseInfo?.clmmPool:",l==null?void 0:l.clmmPool),l!=null&&l.clmmPool){const o=await M(l==null?void 0:l.clmmPool);console.log("ðŸš€ ~ handleGetPrice ~ contractPoolInfo:",o),o&&(j(o.current_sqrt_price),R(o))}};b.useEffect(()=>{k(),F();let o;return l!=null&&l.clmmPool&&(o=setInterval(()=>{F()},2e4)),()=>{clearInterval(o)}},[l==null?void 0:l.clmmPool]),b.useEffect(()=>(g("increase"),x!=null&&x.address&&p(),()=>{R(null),t(null),m(null)}),[]),ti({onRpcChange:()=>{A(!0),F(),x!=null&&x.address&&p()}});const{isApp:G}=te();return e.jsxs(L,{gap:"12px",w:"100%",pt:"20px",align:"flex-start",children:[e.jsxs(d,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(d,{w:{base:"100%",lg:"unset"},justifyContent:"space-between",children:[e.jsx(We,{}),G&&e.jsxs(d,{children:[e.jsx(me,{}),e.jsx(re,{handleRefresh:C,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(d,{w:{base:"100%",lg:"unset"},children:[e.jsx(xe,{w:{base:"100%",lg:"unset"},bg:"bg_secondary",fontSize:"14px",p:"0 16px",h:"32px",borderRadius:"8px",fontWeight:"500",variant:"outline",onClick:o=>{s(`/liquidity?poolAddress=${l==null?void 0:l.clmmPool}`)},children:"Create a new position"}),!G&&e.jsx(re,{handleRefresh:C,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(d,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(z,{w:{base:"100%",lg:"unset"},isLoaded:!!(l!=null&&l.clmmPool),children:e.jsx(He,{symbolFontWeight:"600",haveName:!0,poolInfo:{feeDisplay:w,poolAddress:l==null?void 0:l.clmmPool,...l},symbolEllipsesDecimals:10,nameEllipsesDecimals:20,placement:"bottom-start"})}),e.jsxs(d,{w:{base:"100%",lg:"unset"},gap:{base:"12px",lg:"28px"},flexDirection:{base:"column",lg:"row"},children:[e.jsx(I,{label:"Pool APR",value:e.jsx(Fe,{poolInfo:i,children:e.jsxs(d,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsx(c,{as:"span",fontSize:"14px",color:"text_caption",fontWeight:"500",cursor:i!=null&&i.farmingAprDisplay||((Y=i==null?void 0:i.miningAprList)==null?void 0:Y.length)>0?"help":"text",children:i==null?void 0:i.feeAndMiningAprDisplay}),(i==null?void 0:i.haveFarming)&&e.jsxs(c,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",i==null?void 0:i.farmingAprDisplay]})]})}),loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"TVL",value:(i==null?void 0:i.tvlDisplay)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"Volume (24H)",value:(i==null?void 0:i.volume24Display)||"",loading:!(i!=null&&i.poolAddress)}),e.jsx(I,{label:"Fees (24H)",value:(i==null?void 0:i.fees24Display)||"",loading:!(i!=null&&i.poolAddress)})]})]}),e.jsxs(d,{w:"100%",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(L,{w:{base:"100%",lg:"60%"},gap:"8px",children:[e.jsx(oi,{}),e.jsx(xi,{})]},`${l==null?void 0:l.posId}-posInfo`),e.jsxs(L,{w:{base:"100%",lg:"40%"},children:[e.jsx(N,{p:"0",borderRadius:"12px",children:e.jsxs(d,{w:"100%",p:"0 16px",children:[e.jsx(Ee,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{w:{base:"50%",lg:"unset"},fontSize:"16px",mr:"28px"},tabList:W,currentTab:n=="increase"?"Increase":"Remove",handleChangeTab:o=>{g(o==null?void 0:o.value)}}),!G&&e.jsx(me,{})]})}),n=="increase"&&e.jsx(di,{}),n=="remove"&&e.jsx(Ie,{})]})]})]})}const me=()=>e.jsx(d,{children:e.jsx(Ve,{})});export{ns as default};

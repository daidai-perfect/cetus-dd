import{a as p,D as Qe,j as e,V as H,F as Ye,aa as Le,H as v,T as f,C as Q,u as I,f as G,v as $,X as Ze,Y as Je,Z as Ie,$ as et,a0 as tt,a1 as st,ab as Re,I as nt,N as ft,aA as jt,O as mt,Q as bt,ar as Me,ag as wt}from"./vendor-C6OgHlW5.js";import{u as ot}from"./global-QtViurKp.js";import{j as X,F as re,I as M,O as oe,aU as Ct,i as je,e as it,q as Xe,d as z,aV as he,B as K,v as se,c as Te,a as q,G as yt,z as J,R as at,n as ce,M as ie,p as _t,X as vt,f as rt,am as St,w as V,m as De,as as Y,ar as ke,k as me,aW as Tt,aX as We,Q as ge,V as lt,aY as Ne,aR as kt,al as Pt,aI as ye,a0 as Lt,aZ as $e,a_ as Ve}from"./index-BcaB9c-7.js";import{N as ee}from"./NoData-xr_zMTci.js";import{u as Rt,A as Dt,R as Ot}from"./RecentTransactions-Cc_5cnUk.js";import{A as At}from"./AccountSwitchDrawer-CkkH6lQO.js";import{u as ct,D as dt,g as Ft,e as Ht,f as zt,W as Bt,b as Et,R as Ut,a as Mt,d as Xt}from"./OverviewOrders-DVp94GYf.js";import{I as _e}from"./IconText-COTm5ial.js";import{u as Wt}from"./RangeValue-CLNb11km.js";import{H as te}from"./HTextLabelBox-BylzsszM.js";import{u as Z}from"./activeOrders-CFOVuO72.js";import{H as Oe,T as Ae}from"./Table-dcodIZbo.js";import{P as be}from"./Pagination-CaGyCF9o.js";import{b as Nt,u as de,c as $t,C as Vt,P as Gt,F as qt,E as Kt,S as Qt,O as Yt,a as Zt}from"./useGetLimitOrderHistory-Cm1j9JvD.js";import{u as Jt}from"./useRpcListener-C4BP2Br3.js";import{R as It}from"./RefreshButton-BjGIuKAL.js";import{a as ae,d as es,u as pt,e as ts,f as ss,g as ns,c as os,b as is}from"./usePositionList-CBEmR193.js";import{P as as,a as rs,b as ls,u as cs}from"./PoolItem-DQw2ANpp.js";import{P as ds,H as fe,u as ps}from"./PositionListLoading-DBM_CWXK.js";import{u as us}from"./useAccountBalance-C2pgGwpm.js";import{u as ut}from"./useToken-swJ9eiro.js";import{f as Fe,a as xs,b as gs,u as hs,X as fs,c as js,C as ms,e as bs,d as ws,g as Cs}from"./useXCetus-DAKDumuS.js";import{S as xt}from"./SingleTokenInfo-5fekhlrG.js";import{S as ys}from"./SortDropBlock-D-jGrffV.js";import{T as ve}from"./TableSortTh-Cl33bCJQ.js";import{u as _s}from"./useTokenBalance-B7qMGQH9.js";import{X as vs,a as Ss,b as Ts,c as ks}from"./useXCetusHelper-CKgvisOr.js";import"./CopyButton-DaiQuOy_.js";import"./Drawer-CI9nI4Be.js";import"./useTransaction-DmUGgHnq.js";import"./useTrack-JsQBLEWK.js";import"./useSigner-BWOTG8x9.js";import"./ErrorTips-BlFq-qIo.js";import"./usePreviousValue-DjVUyQL4.js";import"./useFavoritePool-BF-XZ1F4.js";import"./useGetPoolList-DFxZuwZX.js";import"./useWrapPoolData-B1gPOuKW.js";import"./CheckBox-DsmyCmYu.js";import"./SearchInputBlock-CncgoN2z.js";import"./index-CTjeTJlN.js";import"./Loading-Cr8zZo2a.js";import"./TooltipIcon-CvCXDIRN.js";import"./PositionCurrentPrice-aHkRP-sf.js";import"./useBurn-BYkP9tnG.js";import"./msafe-oYBkW7LJ.js";import"./CoinPairInfo-tDoJuxNG.js";import"./PoweredByHaedal-KQFLIkb-.js";import"./PriceRange-MiEdJL9c.js";import"./PositionStatus-Dp08-JvW.js";import"./detail-Bt4ObaKR.js";import"./TradeInputGroup-CImutm3p.js";import"./_getAllKeysIn-B3sS68DW.js";import"./HighlightText-DidJZTw1.js";import"./index-Bh_ofGSv.js";import"./debounce-DEs80Dpt.js";import"./index-Bs01GPRg.js";function Ps(t=100){const o=p.useRef([]),s=p.useRef(!1),a=p.useRef(void 0),l=p.useCallback(async()=>{if(!s.current){for(s.current=!0;o.current.length>0;){const r=o.current.shift();if(!r)continue;const{id:c,run:u,onStart:x,onSuccess:d,onError:m}=r;if(r._cancelled){console.log(`[task:${r.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),x==null||x(c);const j=await u(a.current,c);a.current=j,console.log(`[task:${c}] success`,j),d==null||d(j,c)}catch(j){console.error(`[task:${c}] failed`,j),m==null||m(j,c)}await new Promise(j=>setTimeout(j,t))}s.current=!1}},[t]),i=r=>{o.current.push(r),l()},n=r=>{const c=o.current.find(u=>u.id===r);c&&(c._cancelled=!0),o.current=o.current.filter(u=>u.id!==r)};return p.useEffect(()=>()=>{o.current=[],s.current=!1,a.current=void 0},[]),{addTask:i,removeTask:n}}const gt=(t,o)=>o?t:"********";function Ls({totalValue:t,onRefreshTask:o,isLoading:s,children:a}){const[l,i]=p.useState(!1),{currentAccount:n,onWalletModal:r,accounts:c,accountServiceNameObj:u}=X(),{isShowProfileAssets:x,setIsShowProfileAssets:d}=ot();p.useEffect(()=>{i(!0)},[]);const{isOpen:m,onClose:j,onToggle:b}=Qe(),{getServiceNames:R}=Rt(),A=p.useCallback(()=>{m||R(c),b(),console.log("AccountSwitch###handleClick###isOpen: ",m)},[m,c]);return console.log(n,u,c,"currentAccount-H5Main"),e.jsxs(H,{w:"100%",mt:"28px",children:[l?n!=null&&n.address?e.jsxs(H,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(v,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(v,{h:"18px",children:[e.jsx(f,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(f,{fontSize:"12px",children:x?"Hide Value":"Show Value"}),children:e.jsx(Q,{children:e.jsx(M,{xlinkHref:x?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>d(!x)})})})]}),e.jsxs(v,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(f,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(M,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(I,{isLoaded:!s,h:"32px",children:e.jsx(f,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(oe(t,2),x)})}),c.length>1&&e.jsxs(v,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:A,cursor:"pointer",children:[e.jsxs(v,{children:[e.jsx(M,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(f,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[n!=null&&n.label?`${n==null?void 0:n.label} : `:"",(u==null?void 0:u[n==null?void 0:n.address])||Ct(n==null?void 0:n.address)]})]}),e.jsx(M,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),a]}):e.jsx(ee,{type:"nowallet",mt:"20px",onboard:()=>r(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Le,{})}),e.jsx(At,{isOpen:m,onClose:j})]})}function He(t){const{type:o,children:s,wrapStyle:a={h:"60px"},textStyle:l={fontSize:"16px"}}=t,i=(n,r)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(n,r):n===r.value;return e.jsxs(v,{justify:"space-between",w:"100%",h:"60px",...a,children:["title"in t?e.jsx(f,{color:"text_caption",...l,children:t==null?void 0:t.title}):e.jsx(je,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(n,r)=>i(n,r),wrapStyle:{h:"60px",border:"none",gap:"38px",...a},itemStyle:l}),s]})}function Rs({orderInfo:t,isActiveOrder:o,pageDirect:s}){const{inCoin:a,outCoin:l}=t,{orderHistoryList:i,handleGetDcaOrderHistory:n,orderHistoryListLoading:r}=ct();p.useEffect(()=>{t!=null&&t.orderID&&n(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=it(),[u,x]=p.useState(s),d=142,m=(i==null?void 0:i.length)||0,j=(i==null?void 0:i.length)<=1?`${d*m-8}px`:`${d*m+(m-1)*32-8}px`;return e.jsxs(H,{align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(i==null?void 0:i.length)>=3?"460px":"unset",overflowY:"auto",children:[!r&&e.jsx(G,{h:j,w:"1px",bg:"border",position:"absolute",left:"6px",top:"8px"}),r?e.jsx(v,{h:"100px",w:"100%",justify:"center",children:e.jsx(Le,{})}):(i==null?void 0:i.length)===0?e.jsx(ee,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):i.map(b=>{const R=Xe(b.inAmount,a==null?void 0:a.decimals),A=Xe(b.outAmount,l==null?void 0:l.decimals),O=z(R).div(A).toString(),g=z(1).div(O).toString();return e.jsxs(H,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(v,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(f,{h:"20px",lineHeight:"20px",children:[he((b==null?void 0:b.time)*1e3)," (UTC)"]}),e.jsx(M,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(b==null?void 0:b.tx,"tx"))}}),e.jsx(v,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(G,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(K,{p:"16px",borderRadius:"12px",children:e.jsxs(H,{align:"flex-start",gap:"20px",children:[e.jsxs(H,{gap:"0px",align:"flex-start",children:[e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:u?`${se(O)} `:`${se(g)} `}),e.jsxs(v,{children:[e.jsxs(f,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",u?` ${a.symbol} per ${l.symbol}`:` ${l.symbol} per ${a.symbol}`,")"]}),e.jsx(M,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>x(!u)})]})]}),e.jsxs(v,{w:"100%",gap:"4px",children:[e.jsx(Te,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px"}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(R)}`}),e.jsx(f,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${a.symbol}`}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(Te,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${se(A)}`}),e.jsx(f,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${l.symbol}`})]})]})})]},b==null?void 0:b.tx)})]})}function Ds({orderInfo:t,isActiveOrder:o,pageDirect:s,isClaimLoading:a=!1,toClaim:l}){const{inCoin:i,outCoin:n}=t;return e.jsxs(H,{children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&o&&e.jsx(Os,{}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(dt,{orderInfo:t}),o&&l&&e.jsx($,{isLoading:a,onClick:()=>l(t),disabled:(t==null?void 0:t.outBalance)<=0||a,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(f,{fontSize:"16px",color:"text_caption",children:Ft(t,o,!0)}),e.jsx(f,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(v,{w:"100%",justify:"space-around",children:[e.jsxs(H,{children:[e.jsx(f,{fontSize:"16px",color:"text_caption",children:Ht(t)}),e.jsxs(f,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]})]}),e.jsx(G,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(H,{children:[e.jsx(f,{color:"text_caption",fontSize:"16px",children:zt(t)}),e.jsxs(f,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance "]})]})]}),e.jsxs(H,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(te,{label:"Invest Every",value:t==null?void 0:t.investEvery}),e.jsx(te,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(te,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${i==null?void 0:i.symbol}`}),o&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(te,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),!o&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(te,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`}),o&&e.jsx(te,{label:"Next Order (UTC)",value:he(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(te,{label:"Created (UTC)",value:he(t==null?void 0:t.createdAt)||""})]})]})}const Os=()=>{const[t,o]=p.useState(!1);return e.jsxs(H,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(v,{align:"center",w:"100%",cursor:"pointer",onClick:()=>o(!t),children:[e.jsx(f,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(M,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(H,{align:"flex-start",w:"100%",children:[e.jsx(G,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(Bt,{})]})]})};function As({isOpen:t,onClose:o,orderInfo:s,isActiveOrder:a,isClaimLoading:l=!1,toClaim:i}){const{isApp:n}=q(),r=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,u]=p.useState("overview"),{inCoin:x,outCoin:d}=s,[m,j]=p.useState(!1),{getTokenRank:b}=Wt();return p.useEffect(()=>{const R=b(x,d);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",d,x,R),j(!R)},[x==null?void 0:x.coin_type,d==null?void 0:d.coin_type]),e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Je,{}),e.jsxs(Ie,{minWidth:n?"300px":"482px",children:[e.jsx(et,{children:e.jsx(G,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(He,{type:"tab",currentTab:c,tabs:r,onTabChange:R=>u(R.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(tt,{}),e.jsxs(st,{p:"0 16px 16px",textAlign:"center",children:[c=="overview"&&e.jsx(Ds,{orderInfo:s,isActiveOrder:a,pageDirect:m,isClaimLoading:l,toClaim:i}),c=="orders"&&e.jsx(Rs,{orderInfo:s,isActiveOrder:a,pageDirect:m})]})]})]})}function Fs({orderInfo:t,isActiveOrder:o=!0}){const{isApp:s}=q(),[a,l]=p.useState(!1),{getExplorerUrl:i}=it(),{isClaimLoading:n,toClaim:r,closeOrderAction:c,isCloseLoading:u}=ct();return e.jsxs(e.Fragment,{children:[o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx($,{isLoading:n,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||n,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(re,{placement:"bottom-end",tooltip:e.jsxs(H,{align:"flex-start",children:[e.jsx(_e,{text:"View Details",onClick:()=>{l(!0)}}),e.jsx(_e,{text:"View on Explorer",onClick:()=>{window.open(i(t.orderID,"poolAddress"))}}),e.jsx(_e,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:u?()=>{}:()=>{c(t)}})]}),children:e.jsx(Q,{children:e.jsx($,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(M,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!o&&e.jsxs(v,{justify:"flex-end",children:[e.jsx($,{onClick:()=>{l(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx($,{onClick:x=>{yt(x),window.open(i(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(M,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),a&&e.jsx(As,{isOpen:a,onClose:()=>l(!1),orderInfo:t,isActiveOrder:o,isClaimLoading:n,toClaim:r})]})}function Hs(){const{isAutoRefresh:t,dcaOrderListLoading:o,dcaActiveOrderList:s,dcaPastOrderList:a}=Z(),[l,i]=p.useState("activeDCAs"),n=p.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&o?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&o?"":a==null?void 0:a.length}],[o,a,s]),r=p.useMemo(()=>l=="activeDCAs"?s:a,[l,s,a]),{isApp:c}=q(),{closeAll:u,claimAll:x,isClaimAllLoading:d,isCloseAllLoading:m}=Et(),j=p.useMemo(()=>l==="pastDCAs"||(r==null?void 0:r.length)===0?0:r==null?void 0:r.reduce((_,C)=>z(_).plus(C==null?void 0:C.outBalance),z(0)).toString(),[l,r]),[b,R]=p.useState([]),[A,O]=p.useState(0),[g,w]=p.useState(1),S=10,T=Ge(l=="activeDCAs");return p.useEffect(()=>{if((r==null?void 0:r.length)>0){const _=(g-1)*S;(r==null?void 0:r.length)<=_&&w(1)}},[r]),p.useEffect(()=>{if((r==null?void 0:r.length)>0){O(r==null?void 0:r.length);const _=(g-1)*S,C=_+S;console.log("ðŸš€ ~ useEffect ~ start:",g,r.slice(0,C),_,C),(r==null?void 0:r.length)>_&&R(r.slice(_,C))}},[g,r]),e.jsxs(H,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:n,currentTab:l,handleChangeTab:_=>i(_==null?void 0:_.value),isActive:(_,C)=>_===C.value,wrapStyle:{border:"none",h:"32px",gap:"8px"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(r==null?void 0:r.length)>1&&l=="activeDCAs"&&e.jsxs(v,{children:[e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:d,disabled:Number(j)===0||d,onClick:()=>{x(r)},children:"Claim All"}),e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:m,disabled:(r==null?void 0:r.length)==0||m,onClick:()=>{u(r)},children:"Close All"})]})]}),e.jsxs(H,{w:"100%",position:"relative",gap:"20px",children:[(t||!o)&&(r==null?void 0:r.length)===0?e.jsx(ee,{type:"nodata",text:l==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(H,{w:"100%",gap:"4px",children:e.jsx(Oe,{rowKey:"orderID",columns:T,dataSource:b,loading:!t&&o,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ae,{rowKey:"orderID",columns:Ge(l=="activeDCAs"),dataSource:b,loading:!t&&o,rowStyle:{h:"80px",cursor:"pointer"}}),(r==null?void 0:r.length)>S&&e.jsx(Q,{children:e.jsx(be,{total:A,size:S,currentPage:g,onChange:_=>{w(_)}})})]})]})}const Ge=t=>[{title:e.jsx(f,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:s=>e.jsx(dt,{orderInfo:s})},{title:e.jsx(f,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Ut,{orderInfo:s,isProfile:!0,isRank:!0})},{title:e.jsx(f,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(Mt,{orderInfo:s,isProfile:!0})},t&&{title:e.jsx(f,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(f,{color:"text_caption",children:he(s)})},{title:e.jsx(f,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:s=>e.jsx(Fs,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function zs(){const{currentAccount:t}=X(),{getLimitOrderHistory:o,historyOrderList:s,historyOrderLoading:a}=Nt(),{myOrderList:l,orderListLoading:i}=de(),{isAutoRefresh:n,autoRefreshCount:r}=Z(),[c,u]=p.useState("openOrders"),x=p.useMemo(()=>c=="openOrders"?i:a,[c,i,a]),d=p.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",l,s),c=="openOrders"?l:s),[c,l,s]),m=p.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:(n||!x)&&(l==null?void 0:l.length)===0?0:!n&&i?"":l==null?void 0:l.length},{label:"Orders History",value:"ordersHistory",num:(n||!x)&&(s==null?void 0:s.length)===0?0:!n&&a?"":s==null?void 0:s.length}],[i,a,l,s]),j=h=>{t!=null&&t.address&&o(t.address,h)};p.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",r),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),r>0&&j(!0)},[r]),p.useEffect(()=>{j(!1)},[c,t]),Jt({onRpcChange:()=>{j(!0)}});const{isApp:b}=q(),{handleCancelOrder:R,cancelOrderLoading:A}=$t(),[O,g]=p.useState([]),[w,S]=p.useState(0),[T,_]=p.useState(1),C=10,P=Bs(c=="openOrders");return p.useEffect(()=>{if((d==null?void 0:d.length)>0){const h=(T-1)*C;(d==null?void 0:d.length)<=h&&_(1)}},[d]),p.useEffect(()=>{if((d==null?void 0:d.length)>0){S(d==null?void 0:d.length);const h=(T-1)*C,L=h+C;console.log("ðŸš€ ~ useEffect ~ start:",T,d.slice(0,L),h,L),(d==null?void 0:d.length)>h&&g(d.slice(h,L))}},[T,d]),e.jsxs(H,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(je,{type:"outlineTab",tabList:m,currentTab:c,handleChangeTab:h=>u(h==null?void 0:h.value),isActive:(h,L)=>h===L.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(d==null?void 0:d.length)>1&&c=="openOrders"&&e.jsx(v,{children:e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:A,onClick:()=>{R(l)},children:"Cancel All"})})]}),e.jsxs(H,{w:"100%",position:"relative",gap:"20px",children:[(n||!x)&&(d==null?void 0:d.length)===0?e.jsx(ee,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):b?e.jsx(H,{w:"100%",gap:"4px",children:e.jsx(Oe,{rowKey:"order_id",columns:P,dataSource:O,loading:!n&&x,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Ae,{rowKey:"order_id",columns:P,dataSource:O,loading:!n&&x,rowStyle:{h:"80px",cursor:"pointer"}}),(d==null?void 0:d.length)>C&&e.jsx(Q,{children:e.jsx(be,{total:w,size:C,currentPage:T,onChange:h=>{_(h)}})})]})]})}const Bs=t=>[{title:e.jsx(f,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:s=>e.jsx(Vt,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(Gt,{info:s,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(qt,{info:s,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Kt,{info:s,isProfile:!0})},!t&&{title:e.jsx(f,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Qt,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:s=>e.jsx(Yt,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function Es(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[o,s]=p.useState("limitOrders");return e.jsx(K,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(H,{align:"flex-start",gap:"20px",children:[e.jsx(G,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(He,{type:"tab",currentTab:o,tabs:t,onTabChange:a=>s(a.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),o==="limitOrders"&&e.jsx(zs,{}),o==="dca"&&e.jsx(Hs,{})]})})}function Us({handleRefresh:t,totalValue:o,isLoading:s}){const{isApp:a}=q(),{currentAccount:l,accounts:i}=X(),{isShowProfileAssets:n,setIsShowProfileAssets:r}=ot(),[c,u]=p.useState(!1),{onClose:x}=Qe();return e.jsxs(H,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsxs(v,{gap:"4px",children:[e.jsx(f,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(re,{showTooltip:!a,placement:"bottom-end",tooltip:e.jsx(f,{fontSize:"12px",children:n?"Hide Value":"Show Value"}),children:e.jsx(Q,{children:e.jsx(M,{xlinkHref:n?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>r(!n)})})})]}),e.jsxs(v,{children:[e.jsxs(v,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{u(!0)},children:[e.jsx(M,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(f,{children:"Transactions"})]}),e.jsx(It,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),e.jsx(v,{w:"100%",justify:"space-between",mt:"2px",children:e.jsx(I,{isLoaded:!s,h:"22px",children:e.jsx(f,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:gt(oe(o,2),n)})})}),i.length>1&&e.jsx(Dt,{currentAccount:l,accounts:i,onClose:x,isProfile:!0}),c&&e.jsx(Ot,{isOpen:c,onClose:()=>u(!1)})]})}function Ms(){var A;const{currentAccount:t,onWalletModal:o}=X(),{showPosListLength:s,setShowPosListLength:a,posBaseListLoading:l,posBaseListGroupByPool:i}=ae(),[n,r]=p.useState([]),{isAutoRefresh:c}=Z(),[u,x]=p.useState([]),d=O=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",O),x(g=>[...g,O])},m=O=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",O),x(g=>g.filter(w=>(w==null?void 0:w.coin_type)!==(O==null?void 0:O.coin_type)))};p.useEffect(()=>{t!=null&&t.address||a("")},[t==null?void 0:t.address]),p.useEffect(()=>{var T,_,C,P;const O=(T=u[0])!=null&&T.coin_type?J((_=u[0])==null?void 0:_.coin_type):void 0,g=(C=u[1])!=null&&C.coin_type?J((P=u[1])==null?void 0:P.coin_type):void 0,w=Object.values(i).filter(h=>O&&g?J(h.tokenA.coin_type)==O&&J(h.tokenB.coin_type)==g||J(h.tokenA.coin_type)==g&&J(h.tokenB.coin_type)==O:O?J(h.tokenA.coin_type)==O||J(h.tokenB.coin_type)==O:h);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(i),w),r(w);const S=w.reduce((h,L)=>h+(L.list?L.list.length:0),0);t!=null&&t.address&&a(S.toString())},[u,i]),p.useEffect(()=>()=>{a("")},[]);const j=p.useMemo(()=>[{label:"Positions",value:"positions",num:Number(s)}],[s]),[b,R]=p.useState("positions");return e.jsx(K,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(H,{gap:"16px",w:"100%",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(He,{type:"tab",currentTab:b,tabs:j,onTabChange:O=>R(O.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(as,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:u,onClickSelectCoinList:d,onDeleteSelectCoinList:m})]}),e.jsx(G,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),e.jsx(rs,{isProfile:!0}),t!=null&&t.address?!c&&l?[{},{},{},{}].map((O,g)=>e.jsx(ds,{},g)):((A=Object.values(n))==null?void 0:A.length)>0?Object.values(n).map((O,g)=>e.jsx(ls,{poolInfo:O,isProfile:!0},g)):e.jsx(ee,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(ee,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})})}function Xs({tabList:t,tabData:o,onClickTab:s}){return e.jsx(H,{w:"100%",children:t==null?void 0:t.map(a=>e.jsx(Ws,{imgUrl:a.activeImgUrl,value:o[a.value].totalValue,title:a.title,url:a.route,tooltip:a==null?void 0:a.tooltip,onClick:()=>s(a.value),isLoading:o[a.value].isLoading},a.title))})}const Ws=({imgUrl:t,value:o,title:s,url:a,tooltip:l,isLoading:i,onClick:n})=>(Re(),e.jsxs(v,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:n,children:[e.jsxs(v,{gap:"12px",children:[e.jsx(nt,{w:"36px",h:"36px",src:t}),e.jsxs(H,{gap:"2px",align:"flex-start",children:[e.jsx(I,{h:"24px",isLoaded:!i,children:e.jsx(f,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:o})}),e.jsxs(v,{gap:"4px",children:[e.jsx(f,{fontSize:"12px",h:"15px",lineHeight:"15px",children:s}),l&&e.jsx(re,{tooltip:l,children:e.jsx(G,{children:e.jsx(M,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(Q,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(M,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function Ns({tabList:t,activeTab:o,tabData:s,onClickTab:a}){return e.jsx(v,{w:"100%",mt:"12px",gap:"12px",children:t.map(l=>{var i,n;return e.jsxs(K,{w:"25%",p:"27px 16px",bgImage:o===l.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:o===l.value?"primary":"border",onClick:()=>a(l.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(H,{align:"flex-start",gap:"10px",children:[e.jsx(f,{fontSize:"14px",color:"text_caption",children:l.title}),e.jsx(v,{h:"22px",children:e.jsx(fe,{size:"l",children:e.jsx(re,{placement:"top",tooltip:e.jsx(f,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:l.tooltip}),showTooltip:l.showTooltip,children:e.jsx(Q,{as:"button",children:e.jsx(I,{isLoaded:!((i=s[l.value])!=null&&i.isLoading),children:e.jsx(f,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(n=s[l.value])==null?void 0:n.totalValue})})})})})})]}),e.jsx(nt,{w:"38px",h:"38px",src:l.activeImgUrl,opacity:o===l.value?"0.8":"0.4"})]},l.value)})})}function qe(t){const{isApp:o}=q();return o?e.jsx(Xs,{...t}):e.jsx(Ns,{...t})}const $s=(t,o)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s})}),we=at($s);function ht(){const{currentAccount:t}=X(),{fetchAccountBalance:o}=us(),{coinHoldingList:s,setCoinHoldingList:a,setIsCoinHoldingLoading:l,setIsCoinPriceLoading:i,setHoldingsTotalUsd:n,isCoinPriceLoading:r,setUnknownCoinCount:c}=we(),{getTokenListInfo:u}=ut(),{getTokenPrice:x}=ce(),{refreshCoinPriceInfo:d}=Fe(),m=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{m.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const j=async()=>{const g=m.current;if(g){l(!0);const w=await o(g,!0);if(w){const S=await u(w.filter(C=>z(C.totalBalance).gt(0)).map(C=>C.coinType));if(!S)throw l(!1),a([]),new Error("get token list info error");const T=[];let _=0;return w.forEach(C=>{const P=S.get(C.coinType);if(P){const h=C.totalBalance,L=ie(h,P.decimals).toString(),D=se(L,void 0,void 0,_t.ROUND_DOWN).toString(),y={balance:h,balance_format:L,balance_display:D,balance_usd:void 0,coin:P,coin_type:P==null?void 0:P.coin_type,price:"",price_diff_24:""};T.push(y),P.is_verified||_++}}),R(T),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",g),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",m.current),g===m.current&&(a(T),c(_),b([...T])),l(!1),T}}else l(!1),a([]);return[]},b=async g=>{i(!0);try{await d(g.filter(w=>w.coin.is_verified).map(w=>w.coin.coin_type),!0)}catch(w){console.error("fetch coin price info error",w)}finally{i(!1)}},R=g=>{g.map(w=>{const{coin:S}=w;if(S.is_verified){const T=x(S.coin_type);T&&(w.price=T.price,w.price_diff_24=T.price_change||"",w.balance_usd=z(w.balance_format).mul(T.price).toString())}})},A=async g=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:g,coinHoldingList:s,currentAccount:t}),t){const{search:w,current_sort:S,current_sort_order:T,is_show_unknown:_=!1,is_hide_small_balance:C=!0}=g;let P=[];if(_?P.push(...s):P=s.filter(h=>h.coin.is_verified),w){const h=w.toLowerCase();P=P.filter(L=>L.coin.coin_type.toLowerCase().includes(h)||L.coin.symbol.toLowerCase().includes(h)||L.coin.name.toLowerCase().includes(h))}return R(P),C&&!r&&(P=P.filter(h=>h.balance_usd===void 0||z(h.balance_usd).gt(.01))),P.sort((h,L)=>{if(S==="balance"){const D=z(h.balance_format).cmp(z(L.balance_format));if(D!==0)return T==="desc"?-D:D}if(S==="value"){const D=z(h.balance_usd).cmp(z(L.balance_usd));return D!==0?T==="desc"?-D:D:z(L.balance_format).cmp(z(h.balance_format))}if(S==="price"){const D=z(h.price||"0").cmp(z(L.price||"0"));return D!==0?T==="desc"?-D:D:z(L.balance_format).cmp(z(h.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",P),P}return[]};return p.useEffect(()=>{R(s);const g=s.reduce((w,S)=>w+Number(S.balance_usd||0),0);n(g.toString())},[s,r]),{getFilterCoinHoldingList:A,fetchCoinHoldingList:j,resetUserData:()=>{a([]),n("0"),c(0)}}}function Vs({inputValue:t,changeInputValue:o}){const s=p.useRef(null),[a,l]=p.useState(!1);return q(),e.jsxs(ft,{w:a?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(jt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(M,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:i=>{var n;(n=s.current)==null||n.focus(),l(!0)}})}),e.jsx(mt,{bg:"background",ref:s,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:i=>{o(i.target.value)},onFocus:()=>{l(!0)},onBlur:()=>{o(""),l(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:a?"28px":"8px",pl:a?"28px":"8px"}),t?e.jsx(bt,{right:"5px",children:e.jsx(M,{xlinkHref:"#icon-icon_close",onMouseDown:i=>i.preventDefault(),onClick:i=>{o(""),setTimeout(()=>{var n;(n=s.current)==null||n.focus()},0)}})}):null]})}function Gs({inputValue:t,changeInputValue:o,isShowUnknownCoin:s,handleIsShowUnknownCoin:a,isHideLowAsset:l,handleIsHideLowAsset:i,unknownCoinCount:n}){return q(),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(f,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(v,{children:[e.jsx(Vs,{inputValue:t,changeInputValue:o}),e.jsx(K,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsxs(f,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",n,")"]}),e.jsx(Me,{isChecked:s,onChange:a})]})}),e.jsx(K,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsx(f,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Me,{isChecked:l,onChange:i})]})})]})]})}function qs(){const{isApp:t}=q(),{getFilterCoinHoldingList:o}=ht(),{isCoinHoldingLoading:s,isCoinPriceLoading:a,unknownCoinCount:l}=we(),{isAutoRefresh:i}=Z(),[n,r]=p.useState([]),[c,u]=p.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[x,d]=p.useState(!1),[m,j]=p.useState(!0),[b,R]=p.useState("desc"),[A,O]=p.useState(Pe[2]),g=k=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",k),i||y(1),u(k),o(k).then(r)},w=k=>{g({...c,search:k})},S=k=>{const W=(k==null?void 0:k.value)===(A==null?void 0:A.value),N=t||!W?"desc":b==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",N,k),O(k),R(N),g({...c,current_sort:k.value,current_sort_order:N})};p.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,a,n),!s&&!a&&g(c)},[s,a]);const T=Re(),_=k=>{T(`/swap/${k}/''`)},[C,P]=p.useState([]),[h,L]=p.useState(0),[D,y]=p.useState(1),B=10;p.useEffect(()=>{if((n==null?void 0:n.length)>0){const k=(D-1)*B;(n==null?void 0:n.length)<=k&&y(1)}},[n]),p.useEffect(()=>{if((n==null?void 0:n.length)>0){L(n==null?void 0:n.length);const k=(D-1)*B,W=k+B;console.log("ðŸš€ ~ useEffect ~ start:",D,n.slice(0,W),k,W),(n==null?void 0:n.length)>k&&P(n.slice(k,W))}else P([])},[D,n]);const F=(k,W)=>{g({...c,[k]:W}),k==="is_show_unknown"&&d(W),k==="is_hide_small_balance"&&j(W)},E=k=>{F("is_show_unknown",k.target.checked),k.target.checked&&!x&&F("is_hide_small_balance",!1)},U=k=>{F("is_hide_small_balance",k.target.checked)};return e.jsx(K,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(H,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Gs,{unknownCoinCount:l,inputValue:c.search||"",changeInputValue:w,isShowUnknownCoin:x,handleIsShowUnknownCoin:E,isHideLowAsset:m,handleIsHideLowAsset:U}),e.jsx(G,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(H,{w:"100%",position:"relative",gap:"20px",children:[(!s&&!a||i)&&(n==null?void 0:n.length)===0?e.jsx(ee,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(H,{w:"100%",gap:"4px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(f,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(ys,{sortText:"Sort by",minW:"180px",currentSort:A,sortByList:Pe,onSortByChange:S,xlinkHref:b==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>R(k=>k==="desc"?"asc":"desc")})]}),e.jsx(Oe,{rowKey:"coin_type",columns:Ke(b,A,S,_,!i&&a),dataSource:C,loading:!i&&(s||a),itemSkeletonLength:5,itemHeight:"30px",onRowClick:k=>{_(k==null?void 0:k.coin_type)}})]}):e.jsx(Ae,{rowKey:"coin_type",columns:Ke(b,A,S,_,!i&&a),dataSource:C,skeletonLength:5,loading:!i&&(s||a),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:k=>{_(k==null?void 0:k.coin_type)}}),(n==null?void 0:n.length)>B&&e.jsx(Q,{children:e.jsx(be,{total:h,size:B,currentPage:D,onChange:k=>{y(k)}})})]})]})})}const Pe=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],Se=Object.fromEntries(Pe.map(t=>[t.value,t])),Ke=(t,o,s,a,l)=>[{title:e.jsx(f,{children:"Token"}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:i})=>e.jsx(xt,{haveTooltip:!0,token:i,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(ve,{labelInfo:Se.balance,sortRule:t,sortBy:o,clickSort:s}),key:"balance",thConfig:{w:"25%"},render:({coin:i,balance_display:n})=>e.jsx(v,{justify:"flex-end",children:e.jsx(fe,{children:e.jsxs(f,{color:"text_caption",children:[n," ",vt(i==null?void 0:i.symbol,10)]})})})},{title:e.jsx(ve,{labelInfo:Se.price,sortRule:t,sortBy:o,clickSort:s}),key:"price",thConfig:{w:"25%"},render:({price:i,price_diff_24:n})=>{const r=z(n).gt(0);return e.jsx(v,{justify:"flex-end",children:e.jsx(I,{isLoaded:!l,children:e.jsx(v,{gap:"2px",children:i===void 0?e.jsx(f,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(f,{color:"text_caption",children:["$",rt(i)]}),e.jsxs(f,{color:Number(n)===0?"text_caption":r?"primary_green":"primary_red",children:["(",r?"+":z(n).gt(-1e-4)&&z(n).lt(0)?"-":"",z(n).gt(-1e-4)&&z(n).lt(1e-4)?"0%":St(z(n).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(ve,{labelInfo:Se.value,sortRule:t,sortBy:o,clickSort:s}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:i})=>e.jsx(v,{justify:"flex-end",children:e.jsx(I,{isLoaded:!l,children:e.jsx(fe,{children:e.jsx(f,{color:"text_caption",children:oe(i,2)})})})})},{title:e.jsx(f,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:i=>e.jsx($,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{a(i==null?void 0:i.coin_type)},children:"Swap"})}],Ks=(t,o)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),Ce=at(Ks),Qs={cetus:{title:"CETUS Holdings",imgUrl:V.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:V.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function ze({type:t,amount:o,amountUSD:s,isLoading:a,children:l}){const{title:i,imgUrl:n,bgUrl:r}=Qs[t];return e.jsx(K,{flex:"1",bg:`center / cover no-repeat url(${r})`,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(H,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(v,{children:[e.jsx(Te,{imageUrl:n,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(f,{children:i})]}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(fe,{children:e.jsxs(H,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(I,{isLoaded:!a,h:"24px",children:e.jsx(f,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:o})}),s!==void 0&&e.jsx(I,{isLoaded:!a,h:"17px",children:e.jsxs(f,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",rt(s,2)]})})]})}),l]})]})})}function Ys(){const{currentAccount:t}=X(),{balanceInfo:o}=_s(V.cetus_coin),{getTokenAmountValue:s}=ce(),{coinPriceObj:a}=De(),l=p.useMemo(()=>s(V.cetus_coin.coin_type,ie((o==null?void 0:o.balance)||"0",V.cetus_coin.decimals)).toString(),[o==null?void 0:o.balance,t==null?void 0:t.address,a]),{setCurrentXCetusTab:i,setIsXCetusModalOpen:n}=Ce(),r=()=>{n(!0),i("Get xCETUS")},{veNFT:c,veNFTLoading:u,lockCetusListLoading:x}=Y();return e.jsx(ze,{type:"cetus",amount:t?(o==null?void 0:o.balanceFormat)||"0":"--",amountUSD:l,isLoading:(x||u)&&c!==void 0,children:e.jsx($,{onClick:r,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Convert to xCETUS"})})}function Zs(){const{lockCetusList:t,lockCetusListLoading:o}=Y(),[s,a]=p.useState([]),[l,i]=p.useState(0),[n,r]=p.useState(1),c=10;return p.useEffect(()=>{if((t==null?void 0:t.length)>0){const u=(n-1)*c;(t==null?void 0:t.length)<=u&&r(1)}},[t]),p.useEffect(()=>{if((t==null?void 0:t.length)>0){i(t==null?void 0:t.length);const u=(n-1)*c,x=u+c;console.log("ðŸš€ ~ useEffect ~ start:",n,t.slice(0,x),u,x),(t==null?void 0:t.length)>u&&a(t.slice(u,x))}},[n,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(wt,{orientation:"horizontal"}),e.jsxs(H,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(f,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(H,{w:"100%",gap:"12px",children:s==null?void 0:s.map(u=>e.jsx(Js,{order:u},u==null?void 0:u.id))}),(t==null?void 0:t.length)>c&&e.jsx(Q,{w:"100%",children:e.jsx(be,{total:l,size:c,currentPage:n,onChange:u=>{r(u)}})})]})]})}const Js=({order:t})=>{const[o,s]=p.useState(!ke.isLocked(t));p.useEffect(()=>{s(!ke.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:a,handleCancelOrder:l}=xs(),{claimOrderLoading:i,handleClaimOrder:n}=gs(),{days:r,hours:c,minutes:u,seconds:x}=hs(t.locked_until_time*1e3,()=>{s(!0)},"days"),d=m=>{m?n(t.id):l(t)};return e.jsxs(v,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",bg:"bg_nine",borderRadius:"12px",children:[o?e.jsxs(v,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(M,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(f,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(v,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(M,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(G,{as:"div",children:[e.jsxs(f,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(f,{as:"span",color:"text_caption",fontSize:"13px",children:[r,"d : ",c,"h : ",u,"m : ",x,"s"]})]})]}),e.jsxs(v,{gap:"12px",children:[e.jsx(fs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx($,{onClick:()=>{a||i||d(o)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:a||i,color:o?"background":"primary_gray",bg:o?"primary":"card_bg",_hover:{bg:o?"primary_hover":"button_ghost_hov_bg",color:o?"background":"text_caption"},children:o?"Claim":"Cancel"})]})]})};function Is({totalRewardValue:t,rewardList:o,summaryRewardList:s}){const{currentAccount:a}=X(),{veNFTLoading:l}=Y(),{claimRewardLoading:i,handleClaimReward:n}=js(),r=()=>{i||n(o)};return q(),e.jsx(ze,{type:"rewards",amount:a?e.jsx(re,{tooltip:e.jsx(H,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(c=>(console.log("ðŸš€ ~ {yieldList?.map ~ item:",c),e.jsxs(v,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(xt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(v,{gap:"4px",children:[e.jsx(f,{fontSize:"12px",color:"text_caption",children:se(c==null?void 0:c.amount,6)}),e.jsxs(f,{fontSize:"12px",children:["(",oe(c==null?void 0:c.value,2),")"]})]})]},c.coin_type)))}),children:e.jsx(f,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:oe(t,2)})}):"--",isLoading:l,children:s.length>0&&e.jsx($,{onClick:r,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Claim"})})}function en({availableXCetusAmount:t}){const{currentAccount:o}=X(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=Y(),{getTokenAmountValue:i}=ce(),{coinPriceObj:n}=De(),r=p.useMemo(()=>i(V.cetus_coin.coin_type,ie(t||"0",V.x_cetus_coin.decimals)).toString(),[t,o==null?void 0:o.address,n]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:u}=Ce(),x=()=>{u(!0),c("Redeem CETUS")},d=(l||a)&&s!==void 0;return e.jsx(ze,{type:"xcetus",amount:o?se(ie(t||"0",9),9).toString():"--",amountUSD:r,isLoading:d,children:e.jsx($,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Redeem"})})}const ue=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function tn({isOpen:t,onClose:o,availableXCetusAmount:s}){const{currentXCetusTab:a,setCurrentXCetusTab:l}=Ce(),[i,n]=p.useState("#icon-a-icon_trade"),r=()=>{n("#icon-icon_swap1")},c=()=>{n("#icon-a-icon_trade")},u=()=>{var d;const x=(d=ue==null?void 0:ue.find(m=>(m==null?void 0:m.value)!==a))==null?void 0:d.value;x&&l(x)};return e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:o,isCentered:!0,children:[e.jsx(Je,{}),e.jsxs(Ie,{children:[e.jsx(et,{p:"0 16px",children:e.jsx(G,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(je,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:ue,currentTab:a,handleChangeTab:x=>{l(x==null?void 0:x.value)}})})}),e.jsx(tt,{}),e.jsxs(st,{p:"20px 16px 16px",children:[a==="Get xCETUS"&&e.jsx(ms,{onClose:o,availableXCetusAmount:s,onIconClick:u,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}}),a==="Redeem CETUS"&&e.jsx(bs,{onClose:o,availableXCetusAmount:ie(s,9),onIconClick:u,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:r,onMouseLeave:c}})]})]})]})}function sn(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:o}=Ce(),{availableXCetusAmount:s,totalRewardValue:a,rewardList:l,summaryRewardList:i}=ws();return e.jsx(K,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(H,{w:"100%",gap:"16px",children:[e.jsxs(v,{w:"100%",gap:"10px",children:[e.jsx(en,{availableXCetusAmount:s}),e.jsx(Ys,{}),e.jsx(Is,{totalRewardValue:a,rewardList:l,summaryRewardList:i})]}),e.jsx(Zs,{}),t&&e.jsx(tn,{isOpen:t,onClose:()=>o(!1),availableXCetusAmount:s})]})})}function nn(){const{currentAccount:t}=X(),{orderListLoading:o,myOrderList:s}=de(),{isAutoRefresh:a,dcaOrderListLoading:l,dcaActiveOrderList:i}=Z(),{getTokenAmountValue:n,coinPriceObj:r}=ce(),c=p.useMemo(()=>{let d=z(0);if(a||!o)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(m=>{const{pay_coin:j,target_coin:b,un_claimed_amount:R,remaining_amount:A}=m,O=n(j.coin_type,A),g=n(b.coin_type,R);d=z(d).plus(O).plus(g),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",d.toString())}),d.toString()):"0"},[a,s,t==null?void 0:t.address,o,r]),u=p.useMemo(()=>{let d=z(0);if(a||!l)return(i==null?void 0:i.length)>0&&(t!=null&&t.address)?(i.forEach(m=>{const{inBalance:j,inCoin:b,outBalance:R,outCoin:A}=m,O=n(b.coin_type,j),g=n(A.coin_type,R);d=z(d).plus(O).plus(g),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",d.toString())}),d):"0"},[a,i,t==null?void 0:t.address,l,r]),x=p.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",u,c),u&&c){let d=z(0);return d=z(d).plus(u).plus(c),d.toString()}return"--"},[u,c]);return{limitTotalTvl:c,dcaTotalTvl:u,orderTotalTvl:x}}function on(){const{currentAccount:t}=X(),{isAutoRefresh:o}=Z(),{veNFT:s,veNFTLoading:a,lockCetusListLoading:l}=Y(),{getTokenAmountValue:i}=ce(),{coinPriceObj:n}=De();return{xCetusTotalTvl:p.useMemo(()=>{if(o||!a&&!l)return t!=null&&t.address&&s?i(V.cetus_coin.coin_type,ie(s==null?void 0:s.xcetus_balance,V.cetus_coin.decimals)).toString():"0"},[o,s==null?void 0:s.xcetus_balance,l,a,t==null?void 0:t.address,n])}}const an="fetch-coin-holding-list",rn="fetch-owner-nft",ln="fetch-active-order-list",cn="fetch-xcetus-base-info";function dn(){const{currentAccount:t}=X(),{getTokenListInfo:o}=ut(),{getLimitUserIndexer:s,getDcaUserIndexer:a}=Cs(),{setOrderListLoading:l,setMyOrderList:i}=de(),{setDcaOrderListLoading:n,setDcaActiveOrderList:r,setDcaPastOrderList:c}=Z(),{refreshCoinPriceInfo:u}=Fe(),{buildDcaOrderList:x}=Xt(),{peripherySdk:d}=me(),{formatLimitOrderList:m}=Zt(),j=p.useRef(t==null?void 0:t.address);p.useEffect(()=>{j.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const b=async()=>{if(t){l(!0);const g=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",g),g)try{return(await d.ClmmSDK.fullClient.getDynamicFieldsByPage(g)).data.map(T=>T.name.value)}catch(w){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",w)}}return[]},R=async()=>{if(t){n(!0);const g=await a(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",g),g)try{return(await d.ClmmSDK.fullClient.getDynamicFieldsByPage(g)).data.map(T=>T.name.value)}catch(w){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",w)}}return[]};return{fetchActiveOrderList:async()=>{try{const g=await b(),w=await R(),S=await d.ClmmSDK.fullClient.batchGetObjects([...g,...w],{showType:!0,showContent:!0}),T=S.filter(F=>{var E,U;return(U=(E=F.data)==null?void 0:E.type)==null?void 0:U.includes("limit_order::LimitOrder")}),_=S.filter(F=>{var E,U;return(U=(E=F.data)==null?void 0:E.type)==null?void 0:U.includes("order::Order")}),P=T.map(F=>Tt.buildLimitOrderInfo(F)).filter(F=>F!==void 0).filter(F=>F.status===We.PartialCompleted||F.status===We.Running),h=_.map(F=>{var W,N,le,ne,pe,Be,Ee,Ue;const E=ge(((W=F.data)==null?void 0:W.type)||""),U=E.type_arguments[0],k=E.type_arguments[1];return{in_coin_type:U,out_coin_type:k,...(le=(N=F.data)==null?void 0:N.content)==null?void 0:le.fields,id:(Ee=(Be=(pe=(ne=F.data)==null?void 0:ne.content)==null?void 0:pe.fields)==null?void 0:Be.id)==null?void 0:Ee.id,version:(Ue=F.data)==null?void 0:Ue.version}}),L=new Set;for(const F of P)L.add(F.pay_coin_type),L.add(F.target_coin_type);for(const F of h)L.add(F.in_coin_type),L.add(F.out_coin_type);await o(Array.from(L));const D=await m(P);i(D);const{activeResult:y,pastResult:B}=await x(h);j.current===(t==null?void 0:t.address)&&(r(y),c(B),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",D),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",h)),u(Array.from(L))}catch(g){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",g)}finally{l(!1),n(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),i([]),r([]),c([])}}}function pn(){const{currentAccount:t}=X(),{clmmSdk:o}=lt(),{xCetusSdk:s}=me(),{buildFarmsPositionType:a,buildBurnPositionType:l}=es(),{setPosBaseList:i,setFullRangePosBaseList:n,setPosBaseListLoading:r}=ae(),{setVeNFT:c,setVeNFTLoading:u,setLockCetusList:x,clearData:d,setLockCetusListLoading:m,setAvailableXCetusAmount:j}=Y(),{formatPosBaseList:b}=pt(),R=p.useRef(t==null?void 0:t.address);return p.useEffect(()=>{R.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const g=R.current;if(g){r(!0),u(!0);const w=await o.fullClient.getOwnedObjectsByPage(g,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:V.clmm_sdk_options.clmm_pool.package_id},{StructType:a},{StructType:l},{StructType:vs},{StructType:Ss}]}});let S=await b(w);i(S),r(!1),(S==null?void 0:S.length)==0&&n([]);const T=Ts(w.data);if(T&&g===R.current){c(T,g);const _=await ks(w.data,s);_.sort((C,P)=>C.locked_until_time-P.locked_until_time),console.log("ðŸš€ ~ fetchOwnerNFT ~ lockList1:",{lockList:_,veNFT:T,availableXCetusAmount:Ne.getAvailableXCetus(T,_)}),x(_),j(Ne.getAvailableXCetus(T,_))}else m(!1);return{veNFT:T,posBaseList:S}}}catch(g){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",g),g instanceof TypeError&&(r(!1),i([]))}finally{r(!1),m(!1),u(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{i([]),d()}}}function un(){const{currentAccount:t}=X(),{peripherySdk:o}=me(),{clmmSdk:s}=lt();pt();const{getPosPoolsOriginalObj:a,getPosPoolsRelatedData:l}=ts(),{getPosLiquidityData:i}=ss(),{setPosLiquidityData:n,setFarmsPosRewardsData:r,setFarmsPosRewardsDataLoading:c,setPosRewardsData:u,setPosRewardsDataLoading:x,setPosFeeData:d,setPosFeeDataLoading:m}=ae(),{formatFarmsRewardsData:j}=ns(),{formatPosRewardsData:b}=os(),{formatPosFeeData:R}=is(),{posBaseList:A,setShowPosListLength:O,setMyPosYieldValue:g}=ae(),{refreshCoinPriceInfo:w}=Fe(),S=async C=>{var D;const P=C.filter(y=>y.posType==="farms"&&y.farmsPool),h=await a(C);if(l(C,h),((D=Object.keys(h))==null?void 0:D.length)===0)throw n({}),new Error("No pool data found");i(C,h);const L=new kt;P.length>0&&P.forEach(y=>{o.Farms.buildCalculateFarmingReward({pool_id:y.farmsPool,position_nft_id:y.id},L)}),C.forEach(y=>{s.Rewarder.buildFetchPosFee({poolAddress:y.clmmPool,positionId:y.posId,coinTypeA:y.coinTypeA,coinTypeB:y.coinTypeB},L)}),C.filter(y=>y.posType!=="farms").forEach(y=>{const B=h[y.clmmPool];s.Rewarder.buildFetchPosReward({poolAddress:y.clmmPool,positionId:y.posId,coinTypeA:y.coinTypeA,coinTypeB:y.coinTypeB,rewarderInfo:B.rewarder_infos},L)});try{c(!0),x(!0),m(!0);const y=await s.fullClient.devInspectTransactionBlock({transactionBlock:L,sender:Pt("0x0")}),B=o.Farms.parsedPosRewardData(y),F=s.Rewarder.parsedPosRewardData(y),E=s.Rewarder.parsedPosFeeData(y);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:B,clmmRewardData:F,clmmFeeData:E});const U=await j(B);r(U);const k=await b(Object.values(F).map(N=>{const le=h[C.find(ne=>ne.posId===N.position_id).clmmPool];return{poolAddress:le.pool_address,positionId:N.position_id,rewarderAmountOwed:N.rewarder_amount.map((ne,pe)=>({coin_address:le.rewarder_infos[pe].coinAddress,amount_owed:new ye(ne)}))}}));u(k);const W=await R(Object.values(E).map(N=>({position_id:N.position_id,feeOwedA:new ye(N.fee_owned_a),feeOwedB:new ye(N.fee_owned_b)})),C);d(W),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:W,posRewardsData:k,posFarmsRewardsObj:U}),T(k,U)}catch(y){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",y)}finally{c(!1),x(!1),m(!1)}},T=async(C,P)=>{const h=[];if(A.length>0){A.map(D=>{h.push(ge(D==null?void 0:D.coinTypeA).full_address),h.push(ge(D==null?void 0:D.coinTypeB).full_address);const y=C[D==null?void 0:D.posId]||[],B=P[D==null?void 0:D.id]||[],F=y.concat(B);F==null||F.map(E=>{var U;Lt(E==null?void 0:E.display_amount_owed).gt(0)&&h.push(ge((U=E==null?void 0:E.token)==null?void 0:U.coin_type).full_address)})});const L=Array.from(new Set(h));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",L),w(L)}};return{fetchPosRelatedData:S,resetUserData:()=>{n({}),r({}),u({}),d({})}}}function xn(){const{currentAccount:t}=X(),{setXCetusManager:o,setDividendManager:s}=Y(),{xCetusSdk:a}=me();return{fetchXCetusBaseInfo:async i=>{try{const{xcetus:n,xcetus_dividends:r}=V.xcetus_sdk_options,{dividend_manager_id:c}=$e(r),{xcetus_manager_id:u}=$e(n),x=await a.fullClient.batchGetObjects([u,c],{showType:!0,showContent:!0}),d=x.find(j=>{var b,R;return(R=(b=j.data)==null?void 0:b.type)==null?void 0:R.includes("xcetus::XcetusManager")});if(d){const j=Ve(d),b={id:j.id.id,index:Number(j.index),has_venft:{handle:j.has_venft.fields.id.id,size:j.has_venft.fields.size},nfts:{handle:j.nfts.fields.id.id,size:j.nfts.fields.size},total_locked:j.total_locked,treasury:j.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",b),o(b)}const m=x.find(j=>{var b,R;return(R=(b=j.data)==null?void 0:b.type)==null?void 0:R.includes("dividend::DividendManager")});if(m){const j=Ve(m),b=ke.buildDividendManager(j);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",b),a.XCetusModule.updateCache(`${c}_getDividendManager`,b),s(b)}}catch(n){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",n)}}}}function gn(t){const{currentAccount:o}=X(),{fetchCoinHoldingList:s,resetUserData:a}=ht(),{fetchPosRelatedData:l,resetUserData:i}=un(),{fetchActiveOrderList:n,resetUserData:r}=dn(),{setAutoRefreshCount:c}=Z(),{fetchOwnerNFT:u,resetUserData:x}=pn(),{fetchXCetusBaseInfo:d}=xn(),{addTask:m,removeTask:j}=Ps(),[b,R]=p.useState([]),A=p.useRef(o),{setOrderListLoading:O}=de(),{setLockCetusListLoading:g}=Y(),{setPosBaseListLoading:w}=ae(),{setIsCoinHoldingLoading:S}=we(),T=()=>{a(),i(),r(),x()};p.useEffect(()=>{var y,B;o?((y=A.current)!=null&&y.address&&((B=A.current)==null?void 0:B.address)!==(o==null?void 0:o.address)&&(c(!1),T(),b.forEach(F=>{j(F.id)})),L()):(T(),b.forEach(F=>{j(F.id)})),A.current=o},[o==null?void 0:o.address]);const _={id:an,run:s},C={id:rn,run:u,onSuccess:y=>{const{posBaseList:B}=y;l(B)}},P={id:cn,run:d},h={id:ln,run:n},L=()=>{const y=[];O(!0),g(!0),w(!0),S(!0),t==="wallet"?y.push(_,C,h,P):t==="liquidity"?y.push(C,_,h,P):t==="orders"?y.push(h,_,C,P):y.push(C,P,_,h),R(y),y.forEach(B=>{m(B)})};return{refreshTask:()=>{o&&(b.forEach(y=>{j(y.id)}),L())}}}const xe=t=>t?oe(t,2):"$--",hn=(...t)=>t.reduce((o,s)=>o.plus(s&&+s?s:0),z(0)).toString();function bo(){const{tab:t}=ps(),{currentAccount:o,onWalletModal:s}=X(),a=Re(),{posBaseListLoading:l,posLiquidityDataLoading:i}=ae(),{holdingsTotalUsd:n,isCoinPriceLoading:r,isCoinHoldingLoading:c}=we(),{clmmTotalTvl:u}=cs(),{orderTotalTvl:x}=nn(),{orderListLoading:d}=de(),{isAutoRefresh:m,dcaOrderListLoading:j,setAutoRefreshCount:b,resetAutoRefreshCount:R}=Z(),{xCetusTotalTvl:A}=on(),{lockCetusListLoading:O,veNFTLoading:g,veNFT:w}=Y(),S=p.useMemo(()=>t||"wallet",[t]),{refreshTask:T}=gn(S),_=!m&&(c||r),C=!m&&(l||i||r),P=!m&&(d||j||r),h=!m&&(O||g||r),L=p.useMemo(()=>(console.log("ðŸš€ ~ ProfilePage ~ holdingsTotalUsd",n,u,x,A),{wallet:{totalValue:xe(n),isLoading:_},liquidity:{totalValue:xe(u),isLoading:C},orders:{totalValue:xe(x),isLoading:P},xCetus:{totalValue:xe(A),isLoading:h}}),[n,u,x,A,_,C,P,h]),D=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],y=p.useMemo(()=>hn(A,u,x,n),[A,u,x,n]);p.useEffect(()=>R(!1),[]);const[B,F]=p.useState(!1);p.useEffect(()=>{F(!0)},[]);const{isApp:E}=q();return E?e.jsx(Ls,{totalValue:y,onRefreshTask:T,isLoading:!m&&(g||l||d||j),children:e.jsx(qe,{tabList:D,activeTab:S,tabData:L,onClickTab:U=>a(`/profile?tab=${U}`)})}):e.jsx(H,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:B?o!=null&&o.address?e.jsxs(H,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Us,{handleRefresh:U=>{b(!U),T()},totalValue:y,isLoading:!m&&(g||l||d||j)}),e.jsx(qe,{tabList:D,activeTab:S,tabData:L,onClickTab:U=>a(`/profile?tab=${U}`)}),S==="wallet"&&e.jsx(qs,{}),S==="liquidity"&&e.jsx(Ms,{}),S==="orders"&&e.jsx(Es,{}),S==="xCetus"&&e.jsx(sn,{})]}):e.jsx(ee,{type:"nowallet",mt:"20px",onboard:()=>s(!0)}):e.jsx(Ye,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(Le,{})})})}export{bo as default};
//# sourceMappingURL=Profile-3sG3N3Sw.js.map

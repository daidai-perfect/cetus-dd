import{j as e,H as j,T as b,a as c,V as T,X as ke,Y as Te,Z as Pe,$ as Me,a8 as rt,a0 as Ee,a1 as He,v as X,u as J,C as pe,S as Ke,f as at,R as be,at as U,au as N,aw as ot,ax as lt,ay as K,as as ct,ab as dt,az as Bt,O as Ze,aa as Wt}from"./vendor-_1sPVx0S.js";import{C as $t,j as D,t as Ae,ag as pt,b as xt,a as ne,B as G,I as q,z as Re,i as Oe,h as ut,k as ee,e as fe,ah as ge,ai as se,aj as mt,R as Z,d as F,c as gt,N as ht,S as Vt,y as ze,q as he,m as Fe,p as Xe,O as qe,r as Yt,u as Gt}from"./index-DZworFuu.js";import{P as _e}from"./Pagination-mtBmubrM.js";import{N as I}from"./NoData-CxevJSkT.js";import{u as Ut}from"./RangeValue-CZfdgmR_.js";import{u as de}from"./useTransaction-DopuwF40.js";import{u as we}from"./useAccountBalance-Bqky3zOE.js";import{u as Ne}from"./useToken-BWHB2fhl.js";import{S as Qt}from"./SingleTokenInfo-BOld9qyS.js";import{b as jt}from"./FarmsTable-BByt0XHq.js";import{A as Jt}from"./aggregator-Dpwk2mAM.js";import{A as Ie}from"./useSwapHelper-5Q8nfW7L.js";import{u as et}from"./useTokenBalance-Bm-sJqFs.js";import{u as Kt}from"./useInsufficientBalanceToast-DGofqIoS.js";import{u as Zt}from"./useFindBestRouting-Lj4RLbMT.js";import{T as Xt}from"./TradeInputGroup-BU_bV5JV.js";import{W as qt}from"./WarningTokenTipModal-C36z3uwB.js";import{M as It,C as es}from"./MenuDropBlock-CeK2yNtB.js";import{T as ts,a as ss}from"./TradeTab-CZ-zbyAg.js";import"./index-DrRqZ10E.js";import{u as is}from"./global-CG4XJcf0.js";import"./swap-hrI2JH4_.js";import"./AggregatorModal-bAZJ8lJs.js";import"./FreshProgressV2-B_THDS6m.js";import{T as ns}from"./TradeConfirmAmountInfo-BPifKUfb.js";import{I as je}from"./InputBox-DNXDX2jY.js";import{LimitPriceChart as rs}from"./LimitPriceChart-CN8wSsK1.js";import{L as as}from"./useWrapPoolData-CDrg47b6.js";import{u as os}from"./useInterval-DnUakcwK.js";import{u as ls}from"./useRpcListener-DH9nq8gz.js";import{R as tt}from"./RefreshButton-C6wipRYR.js";import"./useSigner-CskzV9L0.js";import"./CopyButton-Dh94jbmg.js";import"./usePositionList-DCRYUjtM.js";import"./useFavoritePool-C-y3K2CF.js";import"./useGetPoolList-CsB88aY2.js";import"./index-OPMiavju.js";import"./ExpendItem-Bu-QAEwU.js";import"./msafe-oYBkW7LJ.js";import"./PriceRange-BlxARJmW.js";import"./PositionStatus-C0rs2j01.js";import"./CoinPairInfo-B7zOIt9d.js";import"./PoweredByHaedal-BByOfacs.js";import"./_getAllKeysIn-BnIExAEt.js";import"./CheckBox-BlDWS91y.js";import"./IconBg-DlQiyDex.js";import"./TooltipIcon-2k0oF2Ae.js";import"./usePreviousValue-CZ-jBHri.js";const xe=({info:t,imgSize:n="32px"})=>{const{pay_coin:r,target_coin:u,total_pay_amount:x,expect_obtain_amount:d}=t;return e.jsxs(j,{children:[e.jsx($t,{w:n,h:n,coinAIconUrl:r.logo_url,coinBIconUrl:u.logo_url}),e.jsxs(b,{color:"text_caption",children:[D(x)," ",r.symbol," â†’ ",D(d)," ",u.symbol]})]})},ue=({info:t})=>e.jsx(j,{justifyContent:"end",gap:"2px",children:e.jsxs(b,{color:"text_caption",children:[Ae(t==null?void 0:t.expire_ts,"")," (UTC)"]})}),me=({info:t})=>{const{pay_coin:n,total_pay_amount:r,deal_amount:u,deal_rate:x}=t;return e.jsxs(j,{justifyContent:"end",gap:"2px",children:[e.jsxs(b,{color:"text_caption",children:[D(u),"/",D(r)," ",n.symbol]}),e.jsxs(b,{color:"primary_gray",children:["(",pt(Number(x)*100),")"]})]})},bt=({historyInfo:t,type:n,...r})=>{const{getExplorerUrl:u}=xt(),{pay_coin:x,target_coin:d}=t,g=c.useMemo(()=>(t==null?void 0:t.events)||[],[t]),h=o=>{const l=o==null?void 0:o.event_type;return l.includes("OrderCanceledEvent")?{text:"Cancel",color:"primary_yellow",icon:"#icon-tx_remove",tokenInfo:x,num:`+${D(Oe(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`}:l.includes("FlashLoanEvent")?{text:"Trade",color:"primary",icon:"#icon-a-icon_swap2",tokenInfo:d,num:`+${D(Oe(o==null?void 0:o.amount,d==null?void 0:d.decimals))}`}:l.includes("OrderPlacedEvent")?{text:"Create",color:"primary_green",icon:"#icon-a-icon_add1",num:`-${D(Oe(o==null?void 0:o.amount,x==null?void 0:x.decimals))}`,tokenInfo:x}:{text:"",icon:"",color:"",num:"",tokenInfo:null}},{isApp:a}=ne();return e.jsx(G,{p:"16px",borderTop:"none",borderRadius:" 0 0 16px 16px",...r,children:e.jsx(T,{align:"flex-start",children:g.map(o=>{const{tokenInfo:l,text:s,icon:i,color:p,num:f}=h(o);return e.jsxs(T,{align:"flex-start",w:"100%",bg:"card_bg",borderRadius:"8px",p:"12px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(j,{align:{base:"flex-start",lg:"center"},w:"100%",gap:"16px",justifyContent:"space-between",children:[e.jsxs(j,{gap:n=="card"?"4px":"8px",flexDirection:n=="card"?"column":"row",align:n=="card"?"flex-start":"center",children:[e.jsxs(j,{w:"68px",justify:"flex-start",gap:"4px",children:[e.jsx(q,{svgW:"14px",xlinkHref:i,svgFill:p,svgHover:p}),e.jsx(b,{color:p,children:s})]}),!a&&e.jsxs(b,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[f,"Â ",l==null?void 0:l.symbol]})]}),e.jsxs(j,{gap:n=="card"?"4px":"20px",flexDirection:n=="card"&&!a?"column":"row",align:n=="card"?"flex-end":"center",children:[e.jsxs(b,{h:"20px",lineHeight:"20px",children:[Ae(Number(o.block_time),"")," (UTC)"]}),e.jsxs(j,{gap:"4px",cursor:"pointer",onClick:_=>{Re(_),window.open(u(o.tx,"tx"))},_hover:{svg:{fill:"text_caption"}},children:[!a&&e.jsx(b,{color:"text_caption",children:"View Transaction"}),e.jsx(q,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]}),a&&e.jsxs(b,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:[f,"Â ",l==null?void 0:l.symbol]})]},o==null?void 0:o.tx)})})})},oe=({info:t})=>{const[n,r]=c.useState(!0),{getTokenRank:u}=Ut();c.useEffect(()=>{const a=u(t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin);console.log("ðŸš€ ~ useEffect PriceBlock ~ direct:",a),r(a)},[t==null?void 0:t.pay_coin,t==null?void 0:t.target_coin]);const{pay_coin:x,target_coin:d,price:g,reseverPrice:h}=t;return e.jsxs(j,{justifyContent:"end",children:[n?e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(b,{color:"text_caption",lineHeight:"1",children:D(g)}),e.jsxs(b,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[d.symbol," per ",x.symbol]})]}):e.jsxs(j,{flexWrap:"wrap",justify:"flex-end",children:[e.jsx(b,{color:"text_caption",children:D(h)}),e.jsxs(b,{color:"text_caption",whiteSpace:"nowrap",lineHeight:"1",children:[x.symbol," per ",d.symbol]})]}),e.jsx(q,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:a=>{Re(a),r(!n)}})]})},ft=({historyInfo:t,openExpendItemObj:n})=>e.jsxs(j,{justifyContent:"end",gap:"4px",children:[(t==null?void 0:t.status)=="Cancelled"?e.jsx(q,{svgW:"20px",xlinkHref:"#icon-icon_cancelled",svgFill:"primary_yellow",svgHover:"primary_yellow"}):e.jsx(q,{svgW:"18px",xlinkHref:"#icon-icon_check",svgFill:"primary_green",svgHover:"primary_green"}),e.jsx(b,{color:(t==null?void 0:t.status)=="Cancelled"?"primary_yellow":"primary_green",children:t==null?void 0:t.status}),e.jsx(q,{svgW:"12px",xlinkHref:"#icon-icon_arrow",variant:"gray",transition:"transform 0.5s",transform:n[t==null?void 0:t.order_id]?"rotate(180deg)":"rotate(0deg)"})]}),cs=(t,n)=>({orderListLoading:!1,myOrderList:[],setOrderListLoading:r=>{t(()=>({orderListLoading:r}))},setMyOrderList:r=>{t(()=>({myOrderList:r}))}}),ye=ut(cs);function Se(){const{currentAccount:t,addressChangeVersion:n}=ee(),{peripherySdk:r}=fe(),{setOrderListLoading:u,setMyOrderList:x,myOrderList:d,orderListLoading:g}=ye(),{fetchTokenInfo:h}=Ne(),a=async(l=t==null?void 0:t.address,s)=>{console.log("ðŸš€ ~ fetchMyLimitOrder ~ account:",l);try{if(!l){u(!1),x([]);return}s&&u(!0);const i=await r.LimitOrder.getOwnerLimitOrderList(l,"all"),p=await o(i.data.filter(f=>f.status===ge.PartialCompleted||f.status===ge.Running));x(p),console.log("ðŸš€ ~ fetchMyLimitOrder ~ list:",p)}catch(i){console.log("ðŸš€ ~ fetchMyLimitOrder ~ error:",i)}finally{u(!1)}},o=async l=>{const s=[];for(const i of l){const[p,f]=await Promise.all([h(i.pay_coin_type),h(i.target_coin_type)]);if(p&&f){const{total_pay_amount:_,pay_balance:P,rate:O,obtained_amount:L,claimed_amount:E,target_balance:y,created_ts:S,expire_ts:w,status:M,id:A}=i,k=se(_,p.decimals).toString(),V=se(P,p.decimals).toString(),W=se(L,f.decimals).toString(),Y=se(E,f.decimals).toString(),v=se(y,f.decimals).toString(),$=mt.rateToPrice(O.toString(),p.decimals,f.decimals),H=Z(1).div($).toString(),C=se(Z(_).sub(P).toFixed(0),p.decimals).toString(),ie={order_id:A,pay_coin:p,target_coin:f,price:$,reseverPrice:H,total_pay_amount:k,expect_obtain_amount:Z(k).mul($).toString(),remaining_amount:V,deal_amount:C,deal_rate:Z(C).div(k).toString(),obtained_amount:W,claimed_amount:Y,un_claimed_amount:Z(v).sub(Y).toString(),created_ts:S,expire_ts:w,status:M};s.push(ie)}}return s.sort((i,p)=>p.created_ts-i.created_ts)};return{fetchMyLimitOrder:a,orderListLoading:g,myOrderList:d}}function _t(){const{fetchAccountBalance:t}=we(),{fetchMyLimitOrder:n}=Se(),{signAndExecuteTransaction:r}=de(),{peripherySdk:u}=fe(),[x,d]=c.useState(!1),{transactionConfirmation:g}=de();return{handleCancelOrder:async a=>{d(!0);const o={getShowInfo:p=>{const f="Canceling order",_={modalDescriptionText:f,toastTitleText:f};return p==="success"&&(_.toastDescriptionContent="Order cancelled successfully",_.modalDescriptionText="Order cancelled successfully",_.toastTitleText="Order cancelled"),_}};g(o);const l=a.map(p=>({pay_coin_type:p.pay_coin.coin_type,target_coin_type:p.target_coin.coin_type,order_id:p.order_id})),s=await u.LimitOrder.cancelOrdersByOwner(l),i=await r(s,o);d(!1),i&&setTimeout(()=>{t(),n()},2e3)},cancelOrderLoading:x}}function ds(){const{fetchAccountBalance:t}=we(),{fetchMyLimitOrder:n}=Se(),{signAndExecuteTransaction:r}=de(),{peripherySdk:u}=fe(),[x,d]=c.useState(!1),[g,h]=c.useState(!1);return{handleClaimOrder:async(l,s)=>{console.log("ðŸš€ ~ handleClaimOrder ~ info:",l),d(!0);const i={pay_coin_type:l.pay_coin.coin_type,target_coin_type:l.target_coin.coin_type,order_id:l.order_id},p=await u.LimitOrder.claimTargetCoin(i),f=await r(p,{getShowInfo:(_,P)=>{var E;const O=`Claim ${D(s)} ${(E=l==null?void 0:l.target_coin)==null?void 0:E.symbol}`,L={modalDescriptionText:O,toastTitleText:O};return _==="success"&&(L.toastDescriptionContent="",L.modalDescriptionText="",L.toastTitleText="Claim successfully"),L}});d(!1),f&&setTimeout(()=>{t(),n()},2e3)},getLimitOrderClaimHistory:async l=>{h(!0);const s=await u.LimitOrder.getLimitOrderClaimLogs(l.order_id);return console.log("ðŸš€ ~ getLimitOrderClaimHistory ~ result:",l,s),s?(h(!1),s.map(i=>{var f;const p=F(i.parsedJson.claimed_amount).div(Math.pow(10,(f=l.target_coin)==null?void 0:f.decimals));return{...i,...i.parsedJson,claimed_amount:p}})):[]},isClaimHistoryLoading:g,claimLoading:x}}const ps=({orderInfo:t,isOpen:n,onClose:r,handleClaim:u,claimLoading:x,getLimitOrderClaimHistory:d,isClaimHistoryLoading:g})=>{const{getExplorerUrl:h}=xt(),[a,o]=c.useState(""),[l,s]=c.useState([]),[i,p]=c.useState({label:"Claim",value:"claim"}),f=[{label:"Claim",value:"claim"},{label:"History",value:"history"}],_=y=>{p(y),(y==null?void 0:y.value)=="history"&&P()},P=async()=>{const y=await d();y&&s(y)},O=c.useMemo(()=>!a||x?{disabled:!0,text:"Claim"}:F(a).gt(t.un_claimed_amount)||F(t.un_claimed_amount).eq(0)?{disabled:!0,text:"Maximum amount that can be withdrawn"}:{disabled:!1,text:"Claim"},[a,t.un_claimed_amount]),[L,E]=c.useState(!0);return c.useEffect(()=>{L&&(E(!1),o(t.un_claimed_amount))},[L,t.un_claimed_amount]),e.jsxs(ke,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(Pe,{children:[e.jsx(Me,{children:e.jsx(rt,{fontWeight:"500",fontSize:"16px",children:"Claim"})}),e.jsx(Ee,{}),e.jsx(He,{textAlign:"center",p:"0px",children:e.jsxs(T,{w:"100%",gap:"20px",p:"16px",pt:"0",align:"flex-start",children:[e.jsx(G,{borderRadius:"8px",p:"8px",children:e.jsx(b,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."})}),e.jsx(xe,{info:t,imgSize:"28px"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Filled Size"}),e.jsx(me,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Expiry"}),e.jsx(ue,{info:t})]}),e.jsx(gt,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:f,currentTab:i.label,handleChangeTab:_}),(i==null?void 0:i.value)=="claim"&&e.jsxs(e.Fragment,{children:[e.jsx(G,{w:"100%",p:"16px",mt:"-4px",children:e.jsxs(T,{gap:"16px",align:"flex-start",children:[e.jsx(b,{lineHeight:"18px",children:"Available to claim"}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(ht,{value:a?D(a).toString():"",onChange:y=>{o(y)},decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"28px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(j,{children:e.jsx(Qt,{portal:!1,token:t==null?void 0:t.target_coin,haveName:!1,imgBoxStyle:{w:"28px",h:"28px"}})})]})]})}),e.jsx(X,{onClick:()=>{u(a),r()},disabled:O.disabled,w:"calc(100% + 32px)",mb:"-30px",ml:"-16px",h:"52px",fontWeight:"500",children:O.text})]}),(i==null?void 0:i.value)=="history"&&e.jsx(T,{w:"100%",gap:"12px",children:g?e.jsxs(G,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:[e.jsxs(j,{justify:"space-between",children:[e.jsx(J,{height:"4",width:"150px"}),e.jsx(J,{height:"4",width:"150px"})]}),e.jsxs(j,{justify:"space-between",mt:"16px",children:[e.jsx(J,{height:"4",width:"150px"}),e.jsx(J,{height:"4",width:"150px"})]})]},history==null?void 0:history.id):(l==null?void 0:l.length)==0?e.jsx(I,{type:"nodata",text:"No History.",p:"20px"}):l==null?void 0:l.map(y=>{var S,w;return e.jsx(G,{w:"100%",p:"16px",mt:"-4px",borderRadius:"12px",children:e.jsxs(T,{gap:"16px",align:"flex-start",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Amount"}),e.jsxs(j,{gap:"4px",children:[e.jsx(Vt,{imageUrl:(S=t==null?void 0:t.target_coin)==null?void 0:S.logo_url,w:"20px",h:"20px"}),e.jsxs(b,{color:"text_caption",lineHeight:"18px",children:[D(y==null?void 0:y.claimed_amount)," ",(w=t==null?void 0:t.target_coin)==null?void 0:w.symbol]})]})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Time"}),e.jsxs(j,{gap:"4px",cursor:"pointer",mr:"-4px",onClick:M=>{Re(M),window.open(h(y.digest,"tx"))},children:[e.jsxs(b,{color:"text_caption",children:[Ae(Number(y==null?void 0:y.timestampMs),"")," (UTC)"]}),e.jsx(q,{svgW:"20px",xlinkHref:"#icon-icon_link1"})]})]})]})},y.digest)})})]})})]})]})},ve=({orderInfo:t})=>{const{handleCancelOrder:n,cancelOrderLoading:r}=_t(),{handleClaimOrder:u,claimLoading:x,getLimitOrderClaimHistory:d,isClaimHistoryLoading:g}=ds(),[h,a]=c.useState(),[o,l]=c.useState(!1),s=(i,p)=>{a(i),p==="cancel"&&n([i]),p==="claim"&&l(!0)};return ne(),e.jsxs(j,{w:{base:"calc(100vw - 32px)",lg:"unset"},pl:{base:"8px",lg:"0px"},pr:{base:"8px",lg:"0px"},justify:"space-between",gap:"8px",children:[F(t==null?void 0:t.obtained_amount).lte(0)&&F(t.un_claimed_amount).lte(0)?e.jsx(ze,{placement:"top",tooltip:e.jsx(b,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled."}),children:e.jsx(pe,{w:{base:"calc(50vw - 28px)",lg:"80px"},children:e.jsx(X,{disabled:!0,w:"100%",h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",children:"Claim"})})}):e.jsx(X,{isLoading:x,disabled:x,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",onClick:()=>{x||s(t,"claim")},children:"Claim"}),e.jsx(X,{isLoading:r,disabled:r,w:{base:"50%",lg:"80px"},h:"28px",variant:"outline",borderRadius:"8px",fontSize:"14px",color:"primary_gray",bg:"button_ghost_bg",onClick:()=>{r||s(t,"cancel")},children:"Cancel"}),o&&e.jsx(ps,{orderInfo:t,claimLoading:x,isOpen:o,onClose:()=>l(!1),handleClaim:i=>u(t,i),getLimitOrderClaimHistory:()=>d(t),isClaimHistoryLoading:g})]})};function st(){const{currentAccount:t,onWalletModal:n}=ee(),{myOrderList:r,orderListLoading:u}=ye(),x=10,[d,g]=c.useState([]),[h,a]=c.useState(0),[o,l]=c.useState(1);return c.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const s=(o-1)*x,i=s+x;g(r.slice(s,i))}},[o,r]),e.jsx(T,{w:"100%",children:t!=null&&t.address?u?e.jsx(G,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(T,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((s,i)=>e.jsx(wt,{},i))})}):r.length===0?e.jsx(I,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"}):e.jsxs(G,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(d==null?void 0:d.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(T,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:d==null?void 0:d.map(s=>e.jsx(xs,{orderInfo:s},s==null?void 0:s.order_id))}),!u&&(r==null?void 0:r.length)>x&&e.jsx(pe,{mt:"12px",children:e.jsx(_e,{total:h,size:x,currentPage:o,onChange:l})})]}):e.jsx(I,{type:"nowallet",onboard:()=>n(!0),borderRadius:"16px"})})}const xs=({orderInfo:t})=>{const{isApp:n}=ne();return e.jsxs(T,{w:"100%",gap:"16px",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(xe,{info:t,imgSize:"28px"}),!n&&e.jsx(ve,{orderInfo:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Filled Size"}),e.jsx(me,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Expiry"}),e.jsx(ue,{info:t})]}),n&&e.jsx(ve,{orderInfo:t})]})},wt=()=>e.jsxs(T,{w:"100%",gap:"12px",align:"flex-start",children:[e.jsx(j,{w:"100%",gap:"0",justify:"space-between",children:e.jsxs(j,{gap:"0",children:[e.jsxs(j,{gap:"0px",mr:"8px",align:"flex-start",children:[e.jsx(Ke,{size:"8"}),e.jsx(Ke,{size:"8"})]}),e.jsx(J,{height:"4",width:"100px"})]})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(J,{height:"4",width:"180px"}),e.jsx(J,{height:"4",width:"150px"})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(J,{height:"4",width:"180px"}),e.jsx(J,{height:"4",width:"150px"})]})]});function it(t){const{historyOrderList:n,historyOrderLoading:r}=t,{currentAccount:u,onWalletModal:x}=ee();console.log("ðŸš€ ~ OrderTableList ~ historyOrderList:",n);const d=10,[g,h]=c.useState([]),[a,o]=c.useState(0),[l,s]=c.useState(1);return c.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const i=(l-1)*d,p=i+d;h(n.slice(i,p))}},[l,n]),e.jsx(T,{w:"100%",children:u!=null&&u.address?r?e.jsx(G,{p:{base:"12px",lg:"20px 16px"},borderRadius:"16px",children:e.jsx(T,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((i,p)=>e.jsx(wt,{},p))})}):n.length===0?e.jsx(I,{type:"nodata",text:"You don't have any order history.",borderRadius:"16px"}):e.jsxs(G,{borderRadius:"16px",p:{base:"12px",lg:"20px 16px"},h:(g==null?void 0:g.length)>8?"927px":"unset",overflowY:"auto",children:[e.jsx(T,{gap:"20px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"20px",_last:{borderBottom:"none",pb:"0px"}}},children:g==null?void 0:g.map(i=>e.jsx(us,{historyInfo:i},i==null?void 0:i.order_id))}),!r&&(n==null?void 0:n.length)>d&&e.jsx(pe,{mt:"12px",children:e.jsx(_e,{total:a,size:d,currentPage:l,onChange:s})})]}):e.jsx(I,{type:"nowallet",onboard:()=>x(!0),borderRadius:"16px"})})}const us=({historyInfo:t})=>{const[n,r]=c.useState({});return e.jsxs(T,{w:"100%",gap:"16px",children:[e.jsx(j,{w:"100%",justify:"space-between",children:e.jsx(xe,{info:t,imgSize:"28px"})}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Limit Price"}),e.jsx(oe,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Expiry"}),e.jsx(ue,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Filled Size"}),e.jsx(me,{info:t})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Status"}),e.jsx(at,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},children:e.jsx(ft,{historyInfo:t,openExpendItemObj:n})})]}),n[t==null?void 0:t.order_id]&&e.jsx(bt,{historyInfo:t,p:"0",border:"none",type:"card"})]})};function ms({historyInfo:t}){const[n,r]=c.useState({});return e.jsxs(be.Fragment,{children:[e.jsxs(U,{cursor:"pointer",onClick:()=>{n[t==null?void 0:t.order_id]?n[t==null?void 0:t.order_id]=!1:n[t==null?void 0:t.order_id]=!0,r({...n})},sx:{td:{pb:n[t==null?void 0:t.order_id]?"20px !important":"16px !important"}},children:[e.jsx(N,{w:"30%",children:e.jsx(xe,{info:t})}),e.jsx(N,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(ue,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(me,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(ft,{historyInfo:t,openExpendItemObj:n})})]}),!n[t==null?void 0:t.order_id]&&e.jsx(U,{h:"16px"}),e.jsx(U,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:n[t==null?void 0:t.order_id]&&e.jsx(N,{colSpan:5,children:e.jsx(bt,{historyInfo:t})})})]},t==null?void 0:t.order_id)}function gs(t){const{historyOrderList:n,historyOrderLoading:r}=t;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",n);const{currentAccount:u,onWalletModal:x}=ee(),d=10,[g,h]=c.useState([]),[a,o]=c.useState(0),[l,s]=c.useState(1);return c.useEffect(()=>{if((n==null?void 0:n.length)>0){o(n==null?void 0:n.length);const i=(l-1)*d,p=i+d;h(n.slice(i,p))}},[l,n]),e.jsxs(ot,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(lt,{children:e.jsxs(U,{children:[e.jsx(K,{children:"Order Info"}),e.jsx(K,{textAlign:"right",children:"Limit Price"}),e.jsx(K,{textAlign:"right",children:"Expiry"}),e.jsx(K,{textAlign:"right",children:"Filled Size"}),e.jsx(K,{textAlign:"right",children:"Status"})]})}),e.jsx(ct,{children:u!=null&&u.address?r?e.jsx(jt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):n.length===0?e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(N,{colSpan:5,w:"100%",children:e.jsx(I,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(be.Fragment,{children:[g.map(i=>e.jsx(ms,{historyInfo:i},i.order_id)),!r&&(n==null?void 0:n.length)>d&&e.jsx(N,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(pe,{w:"100%",children:e.jsx(_e,{total:a,size:d,currentPage:l,onChange:s})})})]}):e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(N,{colSpan:5,w:"100%",children:e.jsx(I,{type:"nowallet",onboard:()=>{x(!0)}})})})})]})}const hs=(t,n)=>({quoteToken:void 0,payCoin:he.clmm_swap.from_coin,targetCoin:he.clmm_swap.to_coin,setPayCoin:r=>{t(()=>({payCoin:r}))},setTargetCoin:r=>{t(()=>({targetCoin:r}))},setQuoteToken:r=>{t(()=>({quoteToken:r}))},expiresIn:"7 Days",setExpiresIn:r=>{t(()=>({expiresIn:r}))},customExpiresVal:null,setCustomExpiresVal:r=>{t(()=>({customExpiresVal:r}))},refreshPriceLoading:!1,setRefreshPriceLoading:r=>{t(()=>({refreshPriceLoading:r}))}}),re=ut(hs);function js(t,n){const{getTokenPrice:r}=Fe(),u=r(t),x=r(n),d=c.useMemo(()=>{if(u&&x){const g=Z(u.price).div(x.price).toString(),h=g.toString();return{price:g,displayPrice:h}}},[u,x]);return{price:d==null?void 0:d.price,displayPrice:d==null?void 0:d.displayPrice}}function yt(){const{payCoin:t,targetCoin:n,setRefreshPriceLoading:r}=re(),{fetchTokenPrices:u}=Fe();return{refreshCoinMarketPrice:()=>{const d=[];t&&d.push(t.coin_type),n&&d.push(n.coin_type),d.length>0&&(r(!0),u(d).finally(()=>{r(!1)}))}}}function bs(){const{refreshCoinMarketPrice:t}=yt(),{fetchAccountBalance:n}=we(),{fetchMyLimitOrder:r}=Se(),{signAndExecuteTransaction:u}=de(),{peripherySdk:x}=fe(),{findBestRouters:d}=Zt(),{getTokenAmountValue:g}=Fe(),h=dt(),{pay:a,target:o}=Bt(),{getTokenInfo:l}=Ne(),{payCoin:s,targetCoin:i,quoteToken:p,expiresIn:f,setPayCoin:_,setTargetCoin:P,setQuoteToken:O,customExpiresVal:L,setExpiresIn:E,setRefreshPriceLoading:y}=re(),[S,w]=c.useState(""),[M,A]=c.useState(""),[k,V]=c.useState(!0),[W,Y]=c.useState(!0),[v,$]=c.useState(""),{displayPrice:H}=js((p==null?void 0:p.coin_type)===(s==null?void 0:s.coin_type)?i==null?void 0:i.coin_type:s==null?void 0:s.coin_type,p==null?void 0:p.coin_type),{balanceInfo:C}=et(s),{balanceInfo:ie}=et(i),De=g(s==null?void 0:s.coin_type,S),St=g(i==null?void 0:i.coin_type,M),[Ce,Ct]=c.useState(""),Be=c.useRef(Ce);c.useEffect(()=>{Be.current=Ce},[Ce]);const[le,We]=c.useState(void 0),[Lt,$e]=c.useState(""),Ot=c.useRef(S),vt=c.useRef(M);c.useEffect(()=>{Ot.current=S},[S]),c.useEffect(()=>{vt.current=M},[M]),c.useEffect(()=>{_(l(a)||he.clmm_swap.from_coin),P(l(o)||he.clmm_swap.to_coin)},[a,o]),c.useEffect(()=>{if(We(void 0),t(),kt(),s&&i){const m=s.extensions&&s.extensions.rank||"0",R=i.extensions&&i.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",s,i),F(m).gte(R)?O({...s}):O({...i})}},[s==null?void 0:s.coin_type,i==null?void 0:i.coin_type]);const kt=async()=>{if(s&&i){const m=`${s.coin_type}_${i.coin_type}`;Ct(m);const R=Object.entries(Jt).map(([B,te])=>te.id),Q=await d({fromToken:s,toToken:i,amount:Xe(1,s.decimals).toFixed(0),providersKeys:R,by_amount_in:!0,uuid:m});m===Be.current&&We(Q)}};c.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",W,H),W?$(H||""):Ye()},[H]),c.useEffect(()=>{p&&!W&&+v&&$(D(F(1).div(v).toFixed(p.decimals)).toString())},[p]),c.useEffect(()=>{Ge(k?S:M,k),Ye()},[v]);const[Tt,Pt]=c.useState({tooltip:"",color:"",text:"",bg:""}),[Mt,Ve]=c.useState(!1),Ye=()=>{var m,R;if(!W&&H&&v){Ve(!0);const Q=F(v).sub(H).div(H).mul(100).toFixed(2);$e(Q);const B=F(Q).gt(0),te=B?Q:Q.split("-")[1],z={tooltip:"",color:"",text:"",bg:""};z.tooltip=`Limit order price is ${te}% ${B?"higher":"lower"} than the market.`,((m=p==null?void 0:p.coin_type)==null?void 0:m.toLowerCase())==((R=i==null?void 0:i.coin_type)==null?void 0:R.toLowerCase())?Number(v)>Number(H)?(z.text="",z.color="#68FFD8"):Number(H)>Number(v)&&(z.text=`Your limit order price is ${te}% ${B?"higher":"lower"} than market. You are selling at a much ${B?"higher":"lower"} rate. We recommend you to use`,z.color="#ffb62d",z.bg="rgba(255,202,104,0.1)"):Number(v)>Number(H)?(z.text=`Your limit order price is ${te}% ${B?"higher":"lower"} than market. You are buying at a much ${B?"higher":"lower"} rate. We recommend you to use`,z.color="#ffb62d",z.bg="rgba(255,202,104,0.1)"):Number(H)>Number(v)&&(z.text="",z.color="#68FFD8"),Pt(z),Ve(!1);return}$e("")},Et=(m=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",H),Y(m),m&&($(H||""),t())},Ge=(m,R)=>{if(V(R),R?w(m):A(m),p&&s&&i&&+v&&+m)if(R){p.coin_type===s.coin_type?A(F(m).div(v).toString().toString()):A(F(m).mul(v).toString().toString());return}else{p.coin_type===i.coin_type?w(F(m).div(v).toString().toString()):w(F(m).mul(v).toString().toString());return}R?A(""):w("")},Ue=(m,R)=>{Qe(),V(R),Y(!0),R?m.coin_type===(i==null?void 0:i.coin_type)?h(`/limit/${m==null?void 0:m.coin_type}/${s==null?void 0:s.coin_type}`):h(`/limit/${m==null?void 0:m.coin_type}/${i==null?void 0:i.coin_type}`):m.coin_type===(s==null?void 0:s.coin_type)?h(`/limit/${i==null?void 0:i.coin_type}/${m==null?void 0:m.coin_type}`):h(`/limit/${s==null?void 0:s.coin_type}/${m==null?void 0:m.coin_type}`)},Ht=async()=>{i&&(Ue(i,!0),w(M),A(S))},Qe=()=>{w(""),A("")};c.useEffect(()=>()=>{E("7 Days")},[]);const[At,Le]=c.useState(!1),Rt=m=>{switch(m){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:zt}=Kt(),{transactionConfirmation:Ft}=de(),Nt=async()=>{const m={getShowInfo:(B,te)=>{const z="Creating order",ce={modalDescriptionText:z,toastTitleText:z};return B==="success"&&(ce.toastDescriptionContent="",ce.modalDescriptionText="Created order successfully",ce.toastTitleText="Created order successfully"),B==="rejected"&&(ce.toastTitleText="Create order"),ce}};Ft(m);const R=Date.parse(new Date().toString())+(Rt(f)||L);console.log(" ~ handleSubmitOrder ~ expired_ts:",R),Le(!0);let Q;(p==null?void 0:p.coin_type)===(i==null?void 0:i.coin_type)?Q=v:Q=F(1).div(v).toFixed(i.decimals);try{const B={pay_coin_type:s.coin_type,target_coin_type:i.coin_type,expired_ts:R,target_decimal:i.decimals,pay_decimal:s.decimals,price:Number(Q),pay_coin_amount:Number(Xe(S,s.decimals).toFixed(0))},te=await x.LimitOrder.placeLimitOrder(B),z=await u(te,m);Le(!1),z&&(n(),r(),Qe())}catch(B){zt(String(B)),Le(!1)}},{currentAccount:ae}=ee(),Je=c.useMemo(()=>{const m=g(s==null?void 0:s.coin_type,S);return Number(m)==0&&Number(S)>0?!1:Number(m)<5},[s,S]),Dt=c.useMemo(()=>{const m={text:"Place Limit Order",disabled:!1};return ae!=null&&ae.address?!s||!i?(m.disabled=!0,m.text=" Select a token",m):!Number(S)||!Number(M)?(m.disabled=!0,m.text="Enter an amount",m):Je?(m.disabled=!0,m.text="Order size should be higher than $5",m):Number(S)>Number(C==null?void 0:C.balanceFormat)||!(C!=null&&C.balanceFormat)?(m.disabled=!0,m.text=`Insufficient ${s==null?void 0:s.symbol} balance`,m):(le&&le.errorCode&&(le.errorCode===Ie.NoRouter||le.errorCode===Ie.HoneyPot)&&(m.text="No Available Route",m.disabled=!0),m):(m.disabled=!1,m.text="Connect Wallet",m)},[ae==null?void 0:ae.address,s,i,le,S,M,Je,C]);return{priceImpactInfoLoading:Mt,priceImpactInfo:Tt,fixPayCoin:k,onReverseClick:Ht,handleSelectToken:Ue,marketPrice:H,payCoin:s,targetCoin:i,handleAmountChange:Ge,payAmount:S,targetAmount:M,payBalanceInfo:C,targetBalanceInfo:ie,payAmountValue:De,targetAmountValue:St,useMarketPrice:W,handleMarketPriceClick:Et,inputPrice:v,setInputPrice:$,priceImpact:Lt,quoteToken:p,setQuoteToken:O,handleSubmitOrder:Nt,submitOrderLoading:At,buttonTextStatus:Dt}}const fs=({confirmData:t,isOpen:n,onClose:r,handleSubmitOrder:u,submitOrderLoading:x})=>{const{payAmount:d,targetAmount:g,payCoin:h,targetCoin:a,inputPrice:o,expiresIn:l,quoteToken:s}=t,i=c.useMemo(()=>{var f,_;return console.log("ðŸš€ ~ price ~ inputPrice:",o),o?((f=s==null?void 0:s.coin_type)==null?void 0:f.toLowerCase())==((_=a==null?void 0:a.coin_type)==null?void 0:_.toLowerCase())?o:F(1).div(o).toString():""},[s,a,o]),p=c.useMemo(()=>{var f,_;return o?((f=s==null?void 0:s.coin_type)==null?void 0:f.toLowerCase())==((_=a==null?void 0:a.coin_type)==null?void 0:_.toLowerCase())?F(1).div(o).toString():o:""},[s,a,o]);return e.jsxs(ke,{autoFocus:!1,returnFocusOnClose:!1,isOpen:n,onClose:r,isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(Pe,{children:[e.jsx(Me,{children:e.jsx(rt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(Ee,{}),e.jsx(He,{textAlign:"center",p:"0px",children:e.jsxs(T,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(ns,{coinA:{amount:D(d,h==null?void 0:h.decimals).toString()||"0",...h},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:D(g,a==null?void 0:a.decimals).toString()||"0",...a}}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Price"}),e.jsx(J,{isLoaded:!!o,children:e.jsx(oe,{info:{pay_coin:h,target_coin:a,price:i,reseverPrice:p}})})]}),e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(b,{children:"Expires in"}),e.jsx(b,{color:"text_caption",children:l})]}),e.jsx(G,{borderRadius:"12px",p:"8px",children:e.jsx(b,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(G,{borderRadius:"12px",p:"8px",children:e.jsx(b,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(X,{onClick:()=>{u(),r()},disabled:x,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},_s=({isOpen:t,onClose:n})=>{const{isApp:r}=ne(),{setCustomExpiresVal:u,setExpiresIn:x}=re(),[d,g]=c.useState(""),[h,a]=c.useState(""),o=P=>{const O=P.target.value.replace(/[^\d]/g,"");g(O)},l=P=>{const O=P.target.value.replace(/[^\d]/g,"");a(O)},[s,i]=c.useState({}),p=(P,O)=>{const L=Number(P||0)*60+Number(O||0),E=Math.floor(L/(60*24)),y=Math.floor(L%(60*24)/60),S=L%60;let w="";E>0&&(w+=E+"d "),y>0&&(w+=y+"h "),S>0&&(w+=S+"m "),i({timeText:w.trim()||"0 m",time:L*60*1e3})};c.useEffect(()=>{p(d,h)},[d,h]);const f=c.useMemo(()=>!d&&!h||Number(d)==0&&!h||Number(h)==0&&!d||Number(d)==0&&Number(h)==0,[d,h]),_=()=>{x(s==null?void 0:s.timeText),u(s==null?void 0:s.time),n()};return e.jsxs(ke,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(Pe,{maxW:"1200px",w:r?"calc(100vw - 32px)":"440px",children:[e.jsx(Me,{mr:"-10px",children:e.jsxs(j,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(b,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(j,{gap:"0",align:"center",children:e.jsx(Ee,{mt:"0",position:"static"})})]})}),e.jsx(He,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(T,{w:"100%",children:[e.jsx(je,{children:e.jsxs(j,{children:[e.jsx(Ze,{value:d,onChange:o,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(b,{children:"Hours"})]})}),e.jsx(je,{children:e.jsxs(j,{children:[e.jsx(Ze,{value:h,onChange:l,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(b,{children:"Minutes"})]})}),e.jsx(X,{onClick:_,disabled:f,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function ws(t){const{expiresIn:n,setExpiresIn:r}=re(),[u,x]=c.useState(!1),d=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(je,{w:"156px",borderRadius:"16px",children:[e.jsxs(T,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(ze,{placement:"top",tooltip:e.jsx(b,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(j,{gap:"4px",children:[e.jsx(b,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(q,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(It,{label:n||"",list:d,onListItemClick:g=>{g=="Custom"?x(!0):r(g)}})]}),u&&e.jsx(_s,{isOpen:u,onClose:()=>x(!1)})]})}function ys(t){ne();const{marketPrice:n,priceImpactInfo:r,priceImpactInfoLoading:u,priceImpact:x,inputPrice:d,handleMarketPriceClick:g,setInputPrice:h}=t,{payCoin:a,targetCoin:o,quoteToken:l,refreshPriceLoading:s,setQuoteToken:i}=re();return e.jsx(je,{w:"calc(100% - 156px)",children:e.jsxs(T,{w:"100%",gap:"20px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsxs(j,{children:[e.jsx(b,{fontSize:"13px",fontWeight:"500",children:(l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?`Buy ${qe(o==null?void 0:o.symbol,10)} at rate`:`Sell ${qe(a==null?void 0:a.symbol,10)} at rate`}),Number(x)!==0&&!s&&(u?e.jsx(Wt,{size:"sm"}):e.jsx(ze,{placement:"top",tooltip:e.jsx(b,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:r.tooltip}),children:e.jsxs(b,{color:r.color,children:[F(x).gt(0)?"+":"",Number(x)>1e4?">10000%":pt(x)]})}))]}),(n||s)&&e.jsx(X,{isLoading:s,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>g(!0),children:"Market"})]}),e.jsxs(j,{w:"100%",justifyContent:"space-between",children:[e.jsx(ht,{value:d?Yt(d).toString():"",onChange:p=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",d,p),g(!1),h(p)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(b,{textColor:"text_caption",children:l==null?void 0:l.symbol}),e.jsx(q,{xlinkHref:"#icon-icon_swap1",onClick:()=>{o&&a&&((l==null?void 0:l.coin_type)===(a==null?void 0:a.coin_type)?i(o):i(a))}})]})]})]})})}function Ss(){const{expiresIn:t}=re(),{buttonTextStatus:n,payBalanceInfo:r,targetBalanceInfo:u,payAmountValue:x,targetAmountValue:d,payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,marketPrice:l,handleAmountChange:s,handleMarketPriceClick:i,handleSelectToken:p,inputPrice:f,setInputPrice:_,priceImpact:P,quoteToken:O,handleSubmitOrder:L,submitOrderLoading:E,onReverseClick:y,priceImpactInfoLoading:S,priceImpactInfo:w}=bs(),M=c.useMemo(()=>({payAmount:g,targetAmount:h,payCoin:a,targetCoin:o,inputPrice:f,expiresIn:t,quoteToken:O}),[g,h,a,o,f,t,O]),{onWalletModal:A}=ee(),[k,V]=c.useState("#icon-a-icon_trade"),W=C=>V(C?"#icon-icon_swap1":"#icon-a-icon_trade"),[Y,v]=c.useState(!1),$=dt(),H=c.useMemo(()=>{const C=[];return a&&C.push(a),o&&C.push(o),C},[a,o]);return e.jsxs(T,{w:{base:"100%",lg:"470px"},gap:"8px",mb:"8px",children:[e.jsxs(j,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(ts,{currTradeTab:ss.Limit}),e.jsx(es,{})]}),e.jsx(Xt,{onClick:y,from:{title:"You Pay",balance:(r==null?void 0:r.balanceFormat)||"",value:g,amountValue:x,onChange:C=>{s(C,!0)},selectable:!0,placeholder:"0.0",token:a,onTokenChange:C=>{p(C,!0)}},to:{title:"You Receive",balance:(u==null?void 0:u.balanceFormat)||"",value:h,amountValue:d,onTokenChange:C=>{p(C,!1)},onChange:C=>{s(C,!1)},selectable:!0,placeholder:"0.0",token:o,half:!1,max:!1},iconParams:{xlinkHref:k,svgFill:"text_caption",transform:k==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:k==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>W(!0),onMouseLeave:()=>W(!1)}}),e.jsxs(j,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(ys,{marketPrice:l,priceImpactInfoLoading:S,priceImpactInfo:w,priceImpact:P,inputPrice:f,setInputPrice:_,handleMarketPriceClick:i}),e.jsx(ws,{})]}),(w==null?void 0:w.text)&&l&&Number(P)!==0&&f&&e.jsxs(b,{color:w==null?void 0:w.color,lineHeight:"20px",bg:w==null?void 0:w.bg,p:"12px",borderRadius:"8px",children:[w==null?void 0:w.text,"Â ",e.jsx(b,{color:w==null?void 0:w.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>$(`/swap/${a==null?void 0:a.coin_type}/${o==null?void 0:o.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(X,{disabled:(n==null?void 0:n.disabled)||E,isLoading:E,mt:"-1px",w:"100%",borderRadius:"12px",h:"56px",fontSize:"20px",fontWeight:"500",onClick:(n==null?void 0:n.text)=="Connect Wallet"?()=>A(!0):()=>v(!0),children:n==null?void 0:n.text}),Y&&e.jsx(fs,{confirmData:M,isOpen:Y,onClose:()=>v(!1),handleSubmitOrder:L,submitOrderLoading:E}),(a||o)&&e.jsx(qt,{addToken:!0,tokensInfo:H,waringModalCancel:C=>{C.forEach(ie=>{(ie.coin_type===(a==null?void 0:a.coin_type)||ie.coin_type===(o==null?void 0:o.coin_type))&&p(void 0,ie.coin_type===(a==null?void 0:a.coin_type))})}})]})}function Cs({orderInfo:t}){return e.jsxs(be.Fragment,{children:[e.jsxs(U,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(N,{w:"30%",children:e.jsx(xe,{info:t})}),e.jsx(N,{w:"20%",textAlign:"right",children:e.jsx(oe,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(me,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(ue,{info:t})}),e.jsx(N,{textAlign:"right",children:e.jsx(ve,{orderInfo:t})})]}),e.jsx(U,{h:"16px"})]},t==null?void 0:t.order_id)}function Ls(){const{currentAccount:t,onWalletModal:n}=ee(),{myOrderList:r,orderListLoading:u}=ye(),x=10,[d,g]=c.useState([]),[h,a]=c.useState(0),[o,l]=c.useState(1);return c.useEffect(()=>{if((r==null?void 0:r.length)>0){a(r==null?void 0:r.length);const s=(o-1)*x,i=s+x;g(r.slice(s,i))}},[o,r]),e.jsxs(ot,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(lt,{children:e.jsxs(U,{children:[e.jsx(K,{children:"Order Info"}),e.jsx(K,{textAlign:"right",children:"Price"}),e.jsx(K,{textAlign:"right",children:"Filled Size"}),e.jsx(K,{textAlign:"right",children:"Expiry"}),e.jsx(K,{textAlign:"right",children:"Action"})]})}),e.jsx(ct,{children:t!=null&&t.address?u?e.jsx(jt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):r.length===0?e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(N,{colSpan:5,w:"100%",children:e.jsx(I,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(be.Fragment,{children:[d.map(s=>e.jsx(Cs,{orderInfo:s},s.order_id)),!u&&(r==null?void 0:r.length)>x&&e.jsx(N,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(pe,{w:"100%",children:e.jsx(_e,{total:h,size:x,currentPage:o,onChange:l})})})]}):e.jsx(U,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(N,{colSpan:5,w:"100%",children:e.jsx(I,{type:"nowallet",onboard:()=>{n(!0)},borderRadius:"16px"})})})})]})}function Os(){const{fetchByApi:t}=Gt(),{fetchTokenInfo:n}=Ne(),{currentAccount:r}=ee(),[u,x]=c.useState(!1),[d,g]=c.useState([]);c.useEffect(()=>{g([])},[r==null?void 0:r.address]);const h=async(o,l)=>{try{l&&x(!0);const s=await t(as,"GET",{wallet_address:o});if(s!=null&&s.list){const i=await a((s==null?void 0:s.list)||[]);return g(i),console.log("ðŸš€ ~ file: useGetLimitOrderHistory.ts:10 ~ getLimitOrderHistory ~ res:",i),i}}catch(s){console.log("getLimitOrderHistory ~ error:",s)}finally{x(!1)}},a=async o=>{const l=[];for(const s of o){const[i,p]=await Promise.all([n(s.pay_coin),n(s.target_coin)]);if(i&&p){const{total_pay_amount:f,remaining_amount:_,rate:P,obtained_amount:O,claimed_amount:L,target_balance:E,created_ts:y,expire_ts:S,cancel_reason:w,events:M}=s,A=M;console.log("ðŸš€ ~ formatLimitOrderList ~ eventList:",s,A),A.sort(($,H)=>H.block_time-$.block_time);const k=se(f,i.decimals).toString(),V=mt.rateToPrice(P.toString(),i.decimals,p.decimals),W=Z(1).div(V).toString();console.log("ðŸš€ ~ formatLimitOrderList ~ reseverPrice:",V,W);const Y=se(Z(f).sub(_).toFixed(0),i.decimals).toString(),v={order_id:s.order_id,pay_coin:i,target_coin:p,price:V,reseverPrice:W,total_pay_amount:k,remaining_amount:_,deal_amount:Y,deal_rate:Z(Y).div(k).toString(),expect_obtain_amount:Z(k).mul(V).toString(),obtained_amount:O,claimed_amount:L,un_claimed_amount:"0",created_ts:y,expire_ts:S,status:Number(w)===0?ge.Completed:ge.Cancelled,events:A};console.log("ðŸš€ ~ formatLimitOrderList ~ info:",v),l.push(v)}}return l.sort((s,i)=>i.created_ts=s.created_ts),l};return{getLimitOrderHistory:h,historyOrderLoading:u,historyOrderList:d}}function wi(){const{currentAccount:t}=ee(),{getLimitOrderHistory:n,historyOrderList:r,historyOrderLoading:u}=Os(),{fetchMyLimitOrder:x}=Se(),{setMyOrderList:d,myOrderList:g,orderListLoading:h}=ye(),{payCoin:a,targetCoin:o}=re(),{fetchAccountBalance:l}=we();c.useEffect(()=>{t!=null&&t.address&&l()},[]);const{isShowTradeChart:s,isShowTradeOrders:i}=is(),[p,f]=c.useState([]),[_,P]=c.useState({label:"Open Orders"}),O=c.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",g);const k=[];return k.push({label:"Open Orders",num:_.label==="Open Orders"&&g.length>0&&!h?g.length.toString():void 0}),k.push({label:"Order History",num:_.label==="Order History"&&p.length>0&&!u?p.length.toString():void 0}),k},[_.label,g,p,u,h]);c.useEffect(()=>{L(!0)},[_.label,t,i]),ls({onRpcChange:()=>{L(!0),t!=null&&t.address&&l()}});const L=k=>{i&&(A(0),console.log("ðŸš€  ~ currentAccount:",_.label==="Open Orders",t==null?void 0:t.address),t!=null&&t.address&&(_.label==="Open Orders"?x(t.address,k):(console.log("ðŸš€ ~  ~ currentAccount:",t),n(t.address,k))))};c.useEffect(()=>{t!=null&&t.address&&(r==null?void 0:r.length)>0?f(r):(f([]),d([]))},[r,t==null?void 0:t.address]);const E=k=>{P(k)},{windowWidth:y,isApp:S}=ne(),{refreshCoinMarketPrice:w}=yt(),[M,A]=c.useState(0);return os({interval:1e3,callback:()=>{A(M+1),M>=20&&(A(0),w(),t!=null&&t.address&&l(),L(!1))}}),e.jsxs(T,{mt:y&&y<1024?"28px":"42px",w:"100%",gap:"0px",className:S||s||i?"":"bg_img",children:[e.jsxs(j,{w:"100%",justifyContent:"center",alignItems:"start",gap:"16px",flexDirection:{base:s?"column":"column-reverse",lg:"row"},children:[(i||s)&&e.jsx(j,{gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:s?e.jsx(rs,{baseToken:a,quoteToken:o}):e.jsxs(T,{w:"100%",children:[e.jsx(nt,{tabList:O,currTab:_,myOrderList:g,handleChangeTab:E,handleGetOrderList:L}),_.label==="Open Orders"&&e.jsx(st,{}),_.label==="Order History"&&e.jsx(it,{historyOrderList:p,historyOrderLoading:u})]})}),e.jsx(Ss,{})]}),i&&s&&e.jsxs(T,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(nt,{handleGetOrderList:()=>L(!0),tabList:O,currTab:_,myOrderList:g,handleChangeTab:E}),S&&e.jsx(at,{h:"16px"}),_.label==="Open Orders"&&(S?e.jsx(st,{}):e.jsx(Ls,{})),_.label==="Order History"&&(S?e.jsx(it,{historyOrderList:p,historyOrderLoading:u}):e.jsx(gs,{historyOrderList:p,historyOrderLoading:u}))]})]})}const nt=({tabList:t,currTab:n,myOrderList:r,handleChangeTab:u,handleGetOrderList:x})=>{const{handleCancelOrder:d,cancelOrderLoading:g}=_t(),{isApp:h}=ne(),a=n.label==="Open Orders"&&r.length>1;return e.jsxs(j,{w:"100%",justifyContent:"space-between",flexDirection:{base:n.label==="Open Orders"&&r.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(j,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx(gt,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:t,currentTab:n.label,handleChangeTab:u}),h&&e.jsx(tt,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!h||a)&&e.jsxs(j,{gap:"8px",w:{base:"100%",lg:"unset"},children:[a&&e.jsx(X,{onClick:()=>{d(r)},disabled:g,isLoading:g,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"-8px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!h&&e.jsx(tt,{handleRefresh:x,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{wi as default};
//# sourceMappingURL=Limit-BEWFCyZP.js.map

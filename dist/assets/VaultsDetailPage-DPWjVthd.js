import{r as o,d as g,j as t,ar as De,V as $,T as S,S as Ne,H as _,bG as qe,Y as A,a6 as Ge,B as Ye,an as wt,C as Le,b as st,W as ae,bo as _t,aA as pe,g as me,as as ie,m as We,aO as Ke,I as Ct,bj as je,bq as Rt,ad as Pt,ae as zt,af as Dt,ag as Mt,ah as Lt,ai as Wt,aj as $t,a0 as rt,$ as Je,a4 as it,R as ot,a7 as lt,aJ as ne,bH as Me,a8 as Ce,bI as ve,aS as $e,a1 as Fe,k as nt,e as Tt,bc as Ft,a_ as Et}from"./index-VLgXFcAE.js";import{S as At}from"./Slippage-CI7K23DE.js";import{d as Ot,b as at,e as ct,f as he,g as ut,h as pt,i as Be,C as Ie,u as Ut,c as Ht}from"./useGetVaultList-DnNvnAaD.js";import{R as Nt}from"./RefreshButton-p_JoCcYo.js";import{u as qt}from"./useAccountBalance-DFcM11B7.js";import{H as oe}from"./HTextLabelBox-Agjy5cmt.js";import{V as fe}from"./VTextLabelBox-BoN03IS-.js";import{i as Gt}from"./icon_currentprice@2x-DeObnx8l.js";import{T as Yt}from"./TradeConfirmAmountInfo-B3rX7zvR.js";import{u as Qe}from"./global-cGxABOvJ.js";import{M as xt}from"./msafe-oYBkW7LJ.js";import{u as ke}from"./useTokenBalance-HQszcRad.js";import{u as dt}from"./useTransaction-CwuJvIz0.js";import{v as Te}from"./index-DH-YXT4H.js";import{T as mt}from"./TradeInputGroup-OVoW2Gib.js";import{P as Kt}from"./progress-7TrOxidA.js";import{A as et}from"./AddressCopyLink-DIuo_-2p.js";import{C as tt}from"./CetusTooltip-CS_PI-uB.js";import{P as Jt}from"./RemoveBlock-DIG16fyH.js";import{u as Qt}from"./useFindBestRouting-D0XmbVlV.js";import"./TooltipIcon-C1BhJ_Wg.js";import"./switch-Bt9UproK.js";import"./useGetPoolList-CaGE_SQ5.js";import"./api-data-utils-v1HaZikb.js";import"./useToken-BPa2fJ0v.js";import"./_getAllKeysIn-R6gKGWGk.js";import"./progress.utils-B9S23sOt.js";import"./AddressUnderline-Vqf2iAoT.js";import"./LockInput-BweDoGQ2.js";import"./icon_lock@2x-OdzkPjmc.js";import"./usePositionList-4KJFm0UW.js";import"./useCurrentPos-3fPYIdUG.js";import"./usePosAdd-X8Yo34Cd.js";import"./useInsufficientBalanceToast-DRsPbTI7.js";import"./index-C64YVrAK.js";import"./ExpendItem-CF4vYGIc.js";import"./SingleTokenInfo-fnjtOwas.js";import"./PriceRange-_k4AK1vq.js";import"./PositionStatus-Dk3PC1ub.js";import"./RangeValue-6rXUQHvF.js";import"./RangeAlerts-BfegULf6.js";import"./useNotifiSubscription-5WaRPq3_.js";import"./useXCetusHelper-27gEZAwL.js";function Xt(a){const{displayMaxPrice:i,displayMinPrice:e,displayPrice:r,isLoading:s}=a,[x,l]=o.useState(0),n=o.useRef(null);o.useEffect(()=>{const p=()=>{n.current&&l(n.current.offsetWidth)};p();const c=new ResizeObserver(p);return n.current&&c.observe(n.current),()=>{n.current&&c.unobserve(n.current)}},[]);const d=o.useMemo(()=>{if(i==="∞")return"center";if(r&&e&&i){if(g(r).greaterThanOrEqualTo(i))return"end";if(g(e).greaterThanOrEqualTo(r))return"start"}return"center"},[r,e,i]),u=o.useMemo(()=>{if(i==="∞")return"0px";if(r&&e&&i&&g(r).lessThanOrEqualTo(i)&&g(r).greaterThanOrEqualTo(e)){const p=g(i).add(e).div(2),c=g(r).gt(p);let h=g(0);if(c){const b=g(p).sub(e);h=g(r).sub(p).div(b)}else{const b=g(i).sub(p);h=g(r).sub(e).div(b)}return c?`${g(x).mul(h).toFixed(0)}px`:`-${g(x).mul(g(1).sub(h)).toFixed(0)}px`}return"0px"},[r,e,i,x]);return t.jsxs(De,{w:"100%",direction:"column",alignItems:d,children:[t.jsxs($,{w:{md:"100%",lg:"max-content"},justifyContent:"center",mb:"-22px",gap:"8px",ml:u,children:[t.jsxs($,{p:"6px 24px",borderRadius:"8px",bg:"bg_secondary",gap:"4px",children:[t.jsx(S,{fontSize:"xs",h:"14px",children:"Current Price"}),s?t.jsx(De,{h:"18px",align:"center",children:t.jsx(Ne,{})}):t.jsx(_,{children:t.jsx(S,{fontSize:"16px",color:"text_highlight",children:t.jsx(qe,{value:A(r,6,!0,Ge.ROUND_DOWN)})})})]}),d==="center"&&t.jsxs($,{zIndex:"100",children:[t.jsx(Ye,{w:"2px",h:"98px",bg:"#76C8FF"}),t.jsx(wt,{src:Gt,w:"30px",h:"30px",mt:"-18px"})]}),d!=="center"&&t.jsx(Ye,{h:"25px"})]}),t.jsx(Le,{zIndex:"99",mt:"-48px",ref:n,pl:"60px",pr:"60px",h:"50px",w:"90%",bg:"linear-gradient( 180deg, rgba(22,22,22,0) 0%, #191919 100%)",borderBottom:"1px solid",borderBottomColor:"border",children:t.jsx(Le,{w:"100%",h:"48px",bg:"linear-gradient( 180deg, rgba(22,22,22,0) 0%, #1A5780 100%)"})}),t.jsxs(_,{justifyContent:"space-between",pl:{md:"0",lg:"14px"},pr:"2px",mt:"8px",w:"90%",children:[t.jsxs($,{pl:"16px",pr:"16px",pt:"5px",pb:"5px",borderRadius:"8px",bg:"bg_secondary",gap:"6px",maxW:{md:"48%",lg:"auto"},children:[t.jsx(S,{fontSize:"12px",children:"Min Price"}),s?t.jsx(De,{h:"18px",align:"center",children:t.jsx(Ne,{})}):t.jsx(S,{fontSize:"14px",fontWeight:"500",color:"text_caption",maxW:{md:"100%",lg:"auto"},children:t.jsx(qe,{value:A(e,6,!0,Ge.ROUND_DOWN)})})]}),t.jsxs($,{pl:"16px",pr:"24px",pt:"5px",pb:"5px",borderRadius:"8px",bg:"bg_secondary",gap:"6px",maxW:{md:"48%",lg:"auto"},children:[t.jsx(S,{fontSize:"12px",children:"Max Price"}),s?t.jsx(De,{h:"18px",align:"center",children:t.jsx(Ne,{})}):t.jsx(S,{fontSize:"14px",fontWeight:"500",color:"text_caption",maxW:{md:"100%",lg:"auto"},children:t.jsx(qe,{value:A(i,6,!0,Ge.ROUND_DOWN)})})]})]})]})}function Zt(a){const{getVaultList:i,getVaultListFromCache:e}=Ot(),[r,s]=o.useState(void 0),[x,l]=o.useState(!1),n=async(u,p)=>{var b;(r===void 0||p)&&l(!0);const c=await i({sortRule:"desc",sortType:"apr"}),h=((b=c==null?void 0:c.filter(v=>v.vaultsId===u))==null?void 0:b[0])||null;return l(!0),h&&s(h),h},d=u=>{var h;const p=e({sortRule:"desc",sortType:"apr"});return((h=p==null?void 0:p.filter(b=>b.vaultsId===u))==null?void 0:h[0])||null};return o.useEffect(()=>{if(a){const u=d(a);u&&s(u),n(a,!1)}},[a]),{vaultInfoLoading:x,apiVaultInfo:r,getApiVaultInfo:n}}function Vt(a){const{holdCoinAmounts:i,lpLogoUrl:e,displayTokenA:r,displayTokenB:s,sharePoolRate:x,balanceInfo:l,totalValue:n,isReverse:d,holdCoinAValue:u,holdCoinBValue:p,rewardPerA:c,rewardPerB:h}=a,b=o.useMemo(()=>d?p:u,[d,u,p]),v=o.useMemo(()=>d?u:p,[d,u,p]),{isApp:C}=st();return t.jsx(ae,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs($,{w:"100%",gap:{base:"24px",lg:"8px"},children:[t.jsxs(_,{w:"100%",justifyContent:"space-between",children:[t.jsx(_,{children:t.jsx(S,{textAlign:"start",fontSize:"16px",color:"text_caption",children:"Your Liquidity"})}),t.jsxs(_,{gap:"8px",children:[t.jsx(S,{whiteSpace:"nowrap",children:"Your share of pool"}),t.jsx(S,{color:"text_highlight",fontWeight:"500",children:_t(x,6)})]})]}),C?t.jsxs($,{w:"100%",gap:"16px",children:[t.jsx(oe,{label:"LP Token Balance",labelStyle:{fontSize:"13px"},value:t.jsxs(_,{children:[t.jsx(me,{imageUrl:e,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsxs(S,{color:"text_caption",ml:"4px",fontWeight:"500",fontSize:"13px",children:[A(l==null?void 0:l.balanceFormat,9)," LP"]})]}),subValue:t.jsx(S,{children:pe(n,2)}),subValueStyle:{fontSize:"13px"}}),t.jsx(oe,{label:ie(r==null?void 0:r.symbol,10),labelStyle:{fontSize:"13px"},value:t.jsxs(_,{children:[t.jsx(me,{imageUrl:r==null?void 0:r.logo_url,coinType:r==null?void 0:r.coin_type,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsx(S,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${A(i==null?void 0:i.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`})]}),subValue:pe(b,2),subValueStyle:{fontSize:"13px"}}),t.jsx(oe,{label:ie(s==null?void 0:s.symbol,10),labelStyle:{fontSize:"13px"},value:t.jsxs(_,{children:[t.jsx(me,{imageUrl:s==null?void 0:s.logo_url,coinType:s==null?void 0:s.coin_type,w:"28px",h:"28px",imageStyle:{w:"20px",h:"20px"}}),t.jsx(S,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${A(i==null?void 0:i.displayCoinB,6)} ${ie(s==null?void 0:s.symbol,10)}`})]}),subValue:pe(v,2),subValueStyle:{fontSize:"13px"}})]}):t.jsxs(t.Fragment,{children:[t.jsxs(We,{flexDir:{base:"column",lg:"row"},mt:"16px",gap:{base:"8px",lg:"4px"},align:"center",children:[t.jsx(S,{children:"LP Token Balance"}),t.jsxs(S,{color:"text_caption",ml:"4px",fontWeight:"500",children:[A(l==null?void 0:l.balanceFormat,9)," LP"]}),t.jsx(S,{children:pe(n,2)})]}),t.jsxs(_,{w:{base:"100%",lg:"90%"},mt:"12px",justifyContent:"space-between",pos:"relative",bg:"linear-gradient(270deg, #0F0F0F 0%, #252525 50%, #0F0F0F 100%)",borderRadius:"69px",gap:"0",children:[t.jsxs($,{flex:"1",h:"106px",justifyContent:"center",alignItems:"start",children:[t.jsxs(_,{children:[t.jsx(me,{imageUrl:r==null?void 0:r.logo_url,coinType:r==null?void 0:r.coin_type,imageStyle:{w:"28px",h:"28px"}}),t.jsx(S,{color:"text_caption",fontSize:"16px",fontWeight:"600",children:ie(r==null?void 0:r.symbol,10)})]}),t.jsx(fe,{wrapStyle:{gap:"4px",w:"calc(100% - 60px)"},title:`${A(i==null?void 0:i.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500},value:pe(b,2),valueStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500}})]}),t.jsxs($,{flex:"1",h:"106px",justifyContent:"center",alignItems:"end",children:[t.jsxs(_,{children:[t.jsx(S,{color:"text_caption",fontSize:"16px",fontWeight:"600",children:ie(s==null?void 0:s.symbol,10)}),t.jsx(me,{imageUrl:s==null?void 0:s.logo_url,coinType:s==null?void 0:s.coin_type,imageStyle:{w:"28px",h:"28px"}})]}),t.jsx(fe,{wrapStyle:{gap:"4px",alignItems:"flex-end",w:"calc(100% - 60px)"},title:`${A(i==null?void 0:i.displayCoinB,6)} ${ie(s==null?void 0:s.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500},value:pe(v,2),valueStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all",fontWeight:500}})]}),t.jsx(ae,{pos:"absolute",left:"calc(50% - 52px)",w:"104px",h:"104px",borderRadius:"70px",p:"8px 0px",children:t.jsxs($,{justify:"center",gap:"4px",children:[t.jsx(me,{imageUrl:e,imgBoxStyle:{w:"58px",h:"58px"}}),t.jsx(S,{color:"#8BAABE",fontSize:"12px",children:"Pooled Assets"})]})})]})]})]})})}function Bt(a){const{price:i,changeSide:e}=a;return{displayPrice:o.useMemo(()=>{if(i)return e?A(Ke(1).div(i).toString(),10,!0).toString():i},[i,e])}}function It(a){const{minPrice:i,maxPrice:e,changeSide:r}=a,s=o.useMemo(()=>{if(i&&e)return r?i==="0"||i==="∞"?"0":A(Ke(1).div(e).toString(),10,!0).toString():i},[i,e,r]),x=o.useMemo(()=>{if(i&&e)return r?e==="0"||e==="∞"?"∞":A(Ke(1).div(i).toString(),10,!0).toString():e},[i,e,r]);return{displayMinPrice:s,displayMaxPrice:x}}function kt(a){const[i,e]=o.useState(!1),{currentPrice:r,minPrice:s,maxPrice:x,displayTokenA:l,displayTokenB:n,isLoading:d,isReverse:u}=a,{displayPrice:p}=Bt({price:r,changeSide:i}),{displayMaxPrice:c,displayMinPrice:h}=It({minPrice:s,maxPrice:x,changeSide:i});o.useEffect(()=>{e(u)},[u]);const b=o.useMemo(()=>i?n:l,[l,n,i]);return t.jsx(ae,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs($,{w:"100%",children:[t.jsxs(_,{w:"100%",justifyContent:"space-between",mb:"6px",children:[t.jsx(S,{fontSize:"16px",color:"text_caption",children:"Position Range"}),t.jsxs(_,{gap:"0px",children:[t.jsx(me,{imageUrl:b==null?void 0:b.logo_url,imageStyle:{w:"20px",h:"20px"}}),t.jsxs(S,{color:"text_caption",children:[" ",b==null?void 0:b.symbol]}),t.jsxs(_,{ml:"8px",gap:"4px",cursor:"pointer",onClick:()=>e(!i),children:[t.jsx(S,{fontSize:"12px",children:" Base coin"}),t.jsx(Ct,{xlinkHref:"#icon-icon_swap1"})]})]})]}),t.jsx(Xt,{displayPrice:p,displayMaxPrice:c,displayMinPrice:h})]})})}function ft(a){const{poolName:i,amountLimit:e,lpRate:r,inputTotalValue:s,preCalculateLoading:x}=a;return t.jsxs($,{w:"100%",gap:"20px",children:[t.jsx(oe,{label:"Total Amount",labelStyle:{fontSize:"14px"},value:pe(s,2),valueStyle:{fontSize:"14px",h:"14px"},isLoading:x}),t.jsx(oe,{label:"Share of Pool",labelStyle:{fontSize:"14px"},value:r,isLoading:x,valueStyle:{fontSize:"14px",h:"14px"}}),t.jsx(oe,{label:"Minimum Received LP",labelStyle:{fontSize:"14px"},value:`${je(A(Rt(e||"0",9)).toString(),9)} ${i}`,valueStyle:{fontSize:"14px",h:"14px"},isLoading:x})]})}function es(a){const{isOpen:i,onClose:e,data:r,onSubmitClick:s}=a,{feeTier:x,displayTokenA:l,displayTokenB:n,displayAmountA:d,displayAmountB:u,totalAmountValue:p,sharePool:c,lpAmountLimit:h}=r;return t.jsxs(Pt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:i,onClose:e,isCentered:!0,children:[t.jsx(zt,{}),t.jsxs(Dt,{children:[t.jsx(Mt,{children:t.jsx(Lt,{fontWeight:"500",fontSize:"16px",children:"Deposit"})}),t.jsx(Wt,{}),t.jsx($t,{textAlign:"center",p:"0px",children:t.jsxs($,{w:"100%",gap:"20px",p:"16px",pb:"0px",pos:"relative",children:[t.jsxs(_,{w:"100%",justifyContent:"space-between",children:[t.jsxs(_,{children:[t.jsx(rt,{coinAIconUrl:l==null?void 0:l.logo_url,coinBIconUrl:n==null?void 0:n.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),t.jsx(S,{fontSize:"16px",color:"text_caption",children:`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`})]}),t.jsx(ae,{w:"unset",p:"6px 8px",borderRadius:"12px",ml:"4px",children:t.jsxs(_,{children:[t.jsx(S,{children:"Fee Tier"}),t.jsx(S,{color:"primary",children:x})]})})]}),t.jsx(Yt,{coinA:{amount:d,...l},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},coinB:{amount:u,...n}}),t.jsx(ft,{amountLimit:h,inputTotalValue:p,preCalculateLoading:!1,lpRate:c,poolName:`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`}),t.jsx(Ye,{h:"52px"}),t.jsx(Je,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{s()},children:"Deposit"})]})})]})]})}function ts(a,i,e,r,s){const{fetchTokenPrices:x,getTokenAmountValue:l}=it(),{setDetailRefreshCount:n}=at(),{vaultsSdk:d}=ot(),{vaultsSlippage:u,mevProtect:p,maxCapForGas:c,transactionMode:h,customGasPrice:b}=Qe(),[v,C]=o.useState(""),[y,U]=o.useState(""),[D,E]=o.useState(!0),[w,M]=o.useState(""),H=o.useRef(""),L=o.useRef(!0),T=o.useRef(""),Q=o.useRef("");o.useEffect(()=>{H.current=w},[w]),o.useEffect(()=>{L.current=D},[D]),o.useEffect(()=>{T.current=v},[v]),o.useEffect(()=>{Q.current=y},[y]),o.useEffect(()=>{const R=[];r&&s&&(R.push(r.coin_type),R.push(s.coin_type)),R.length>0&&x(R)},[r==null?void 0:r.coin_type,s==null?void 0:s.coin_type]);const{balanceInfo:N}=ke(r),{balanceInfo:se}=ke(s),X=l(r==null?void 0:r.coin_type,v),Z=l(s==null?void 0:s.coin_type,y),ce=o.useMemo(()=>g(X||"0").add(Z||"0").toString(),[X,Z]),[te,Y]=o.useState(!1),[q,V]=o.useState(void 0),G=lt(async(R,f,z)=>{if(r&&s&&e)try{Y(!0),n(0);const B=Ce(R,(f?r:s).decimals).toFixed(0),ue={vault_id:e,fix_amount_a:f,input_amount:B,slippage:Number(u),request_id:z,side:a==="both"?ve.Both:ve.OneSide};console.log("🚀 ~ preCalculate ~ params:",ue,z);const I=await d.Vaults.calculateDepositAmount(ue,!1,!0);console.log("🚀 ~ preCalculate ~ res:",{...I,uuid:z,assetAction:a,"+amountInputARef.current":+T.current}),H.current===z&&(a==="both"&&(f?+T.current?(U(ne(I.amount_b.toString(),s.decimals).toString()),V(I)):U(""):+Q.current?(C(ne(I.amount_a.toString(),r.decimals).toString()),V(I)):C("")),a!=="both"&&V(I))}catch(J){console.log("🚀 ~ preCalculate ~ error:",J),V(void 0)}finally{Y(!1)}},500),W=(R,f,z=!0)=>{if(E(f),f?(C(R),z&&U("")):(U(R),z&&C("")),+R){const J=Me.isSuiCoin(a);if(J&&g(R).lt(3)){M(""),V(void 0),Y(!1);return}if(!J){const ue=l(a,R);if(g(ue).gt(1e4)){M(""),V(void 0),Y(!1);return}}const B=Te();M(B),a==="both"&&Y(!0),G(R,f,B)}else be()},K=()=>{const R=L.current?T.current:Q.current;if(+R){const f=Te();M(f),G(R,L.current,f)}};o.useEffect(()=>{be()},[a]);const[ee,we]=o.useState(!1),{signAndExecuteTransaction:le,transactionRejected:xe}=dt(),de=async()=>{if(e){we(!0);const R=Ce(D?v:y,9),f={vault_id:e,side:a==="both"?ve.Both:ve.OneSide,fix_amount_a:D,input_amount:R.toString(),slippage:Number(u)};console.log("🚀 ~ doAddAction ~ params:",f);const z={getShowInfo:(J,B)=>{const ue="Deposit "+[he(v,r==null?void 0:r.symbol),he(y,s==null?void 0:s.symbol)].filter(Boolean).join(" and "),I={modalDescriptionText:ue,toastTitleText:ue};if(J==="success"){let _e=v,Oe=y;B&&(_e=g(v).gt(0)?$e(B,r)||v:"",Oe=g(y).gt(0)?$e(B,s)||y:"");const Re="Deposit "+[he(_e,r==null?void 0:r.symbol),he(Oe,s==null?void 0:s.symbol)].filter(Boolean).join(" and ");I.toastDescriptionContent=Re,I.modalDescriptionText=Re}return I}};try{await le(async()=>await d.Vaults.deposit(f),z,{useMev:p,txAction:"signTransactionBlock",useFastMode:h==="Fast Mode",maxCapForGas:c,customGasPrice:b,msafeParams:{action:xt.AddVaultsPosition,txbParams:f}})?(be(),i()):K()}catch(J){console.log("🚀 ~ doAddAction ~ error:",J),xe(z)}}},be=()=>{C(""),U(""),Y(!1),V(void 0),M("")},{stakeProtocolName:Ee}=ct(L.current?s==null?void 0:s.coin_type:r==null?void 0:r.coin_type),Ae=o.useMemo(()=>{if(a!=="both"&&r&&s){const R=L.current?v:y,f=L.current?r:s,z=L.current?s:r;if(q&&q.swap_result){const J=ne(q.swap_result.swap_in_amount,f.decimals),B=ne(g(q.swap_result.swap_out_amount).mul(1-Number(u)).toString(),z.decimals);return Me.isSuiCoin(f.coin_type)?`By depositing ${je(A(R,9).toString(),9)} SUI, ${je(A(J,9).toString(),9)} SUI will be converted to ${z==null?void 0:z.symbol} via ${Ee} liquid staking and added to the pool together.`:`By depositing ${je(A(R,9).toString(),9)} ${f==null?void 0:f.symbol}, ${je(A(J,9).toString(),9)} ${f==null?void 0:f.symbol} will be traded for ${je(A(B,9).toString(),9)} ${z==null?void 0:z.symbol} and then added to the pool together.`}else if(!Me.isSuiCoin(a)){const J=l(a,R);if(g(J).gt(1e4))return"Single-asset deposit can't be higher than $10,000 at a time."}}},[a,q,v,y]);return{handleAmountInputChange:W,fixAmountA:D,amountInputA:v,amountInputB:y,balanceInfoA:N,balanceInfoB:se,amountValueA:X,amountValueB:Z,preCalculateLoading:te,inputTotalValue:ce,calculateResult:q,showOnlySideTips:Ae,doAddAction:de,reCalculateResult:K}}function gt(a,i,e,r,s,x,l,n,d){const{currentAccount:u}=Fe(),p=o.useMemo(()=>{const c={text:void 0,disabled:!1};if(!(u!=null&&u.address))return c.text="Connect Wallet",c.disabled=!1,c;if(!n||!d)return c.disabled=!0,c;if(a==="both"&&!+e&&!+r)return c.text="Enter an amount",c.disabled=!0,c;if(a!=="both"){if(!(+e||+r))return c.text="Enter an amount",c.disabled=!0,c;if(i){const h=Me.isSuiCoin(a);if(h&&a===(n==null?void 0:n.coin_type)&&g(e).lt(3)||h&&a===(d==null?void 0:d.coin_type)&&g(r).lt(3))return c.text="Minimum deposit 3 SUI",c.disabled=!0,c}}if(a==="both"){if(g(e).gt(x||"0"))return c.disabled=!0,c.text=i?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",c;if(g(r).gt(l||"0"))return c.disabled=!0,c.text=i?`Insufficient ${d==null?void 0:d.symbol} Balance`:"Invalid Amount",c}if(a!=="both"){if(s&&g(e).gt(x||"0"))return c.disabled=!0,c.text=i?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",c;if(!s&&g(r).gt(l||"0"))return c.disabled=!0,c.text=i?`Insufficient ${d==null?void 0:d.symbol} Balance`:"Invalid Amount",c}return c},[u==null?void 0:u.address,a,e,r,x,l]);return{btnText:p.text,btnDisabled:p.disabled}}const ss="You can also choose to deposit in only one asset type. In that case,the vault will convert your asset to the required propositions using Cetus.Please note that trading fees & slippage will be applied. When slippage is involved,a certain amount of post-swap dust (no loss of funds) will be returned to you.",rs=(a,i)=>`When you deposit in only SUI tokens, a part of your SUI amount will be converted to ${i} via ${a} liquid staking services to match required liquidity compositions of the liquidity pool on Cetus. A certain amount of dust (no loss of funds) will be returned to you if slippage is involved.`;function ht(a){const{displayTokenA:i,displayTokenB:e,onSelectAssetTab:r,showAfterIcon:s=!1,label:x="Deposit Amounts",handleRefreshClick:l}=a,{stakeProtocolName:n}=ct(i==null?void 0:i.coin_type),d=o.useMemo(()=>i&&e?[{label:`${i.symbol}+${e.symbol}`,action:"both"},{label:`${i.symbol} only`,action:i.coin_type,afterIcon:s?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:ss},{label:`${e.symbol} only`,action:e.coin_type,afterIcon:s?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:rs(n,i==null?void 0:i.symbol)}]:[],[i,n]),[u,p]=o.useState("both"),c=o.useMemo(()=>{if(d.length!==0)return u===(i==null?void 0:i.coin_type)?d[1].label:u===(e==null?void 0:e.coin_type)?d[2].label:d[0].label},[u,d]);return t.jsx(ae,{borderRadius:"12px",p:{base:"16px 8px 8px",lg:"16px"},children:t.jsxs($,{w:"100%",gap:"16px",children:[t.jsx(_,{w:"100%",justifyContent:"space-between",children:t.jsx(S,{fontWeight:"500",children:x})}),t.jsx(nt,{wrapStyle:{w:"100%",h:"48px",borderRadius:"8px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"6px",fontWeight:"500"},type:"outlineTab",currentTab:c,tabList:d,handleChangeTab:h=>{p(h.action),r(h.action)}})]})})}function is(a){const{apiVaultInfo:i,tokenA:e,tokenB:r,isReverse:s,vaultsId:x,totalLp:l,feeTier:n,handleRefreshClick:d}=a,[u,p]=o.useState("both"),{currentAccount:c,onWalletModal:h}=Fe(),{amountInputA:b,amountInputB:v,balanceInfoA:C,balanceInfoB:y,amountValueA:U,amountValueB:D,preCalculateLoading:E,fixAmountA:w,inputTotalValue:M,handleAmountInputChange:H,calculateResult:L,showOnlySideTips:T,doAddAction:Q,reCalculateResult:N}=ts(u,d,x,e,r),{vaultsSlippage:se}=Qe(),{btnText:X,btnDisabled:Z}=gt(u,!0,b,v,w,C==null?void 0:C.balanceFormat,y==null?void 0:y.balanceFormat,e,r),{lpRate:ce}=ut(L==null?void 0:L.ft_amount,l),{amountLimit:te}=pt(Number(se),L==null?void 0:L.ft_amount,!1),[Y,q]=o.useState(!1),V=o.useMemo(()=>s?y:C,[C==null?void 0:C.balance,y==null?void 0:y.balance,s]),ge=o.useMemo(()=>s?C:y,[C==null?void 0:C.balance,y==null?void 0:y.balance,s]),G=o.useMemo(()=>s?r:e,[s,e,r]),W=o.useMemo(()=>s?e:r,[s,e,r]),K=()=>({feeTier:n||"",displayTokenA:G,displayTokenB:W,displayAmountA:s?v:b,displayAmountB:s?b:v,totalAmountValue:M,sharePool:ce,lpAmountLimit:te||"0"});return o.useEffect(()=>{N()},[i]),t.jsxs($,{gap:"8px",w:"100%",align:"flex-start",children:[t.jsx(ht,{showAfterIcon:!0,displayTokenB:s?e:r,displayTokenA:s?r:e,onSelectAssetTab:p,handleRefreshClick:()=>{d(),N()}}),t.jsx(mt,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:u!=="both"&&u!==(G==null?void 0:G.coin_type),balance:(V==null?void 0:V.balanceFormat)||"",value:s?v:b,amountValue:s?D:U,loading:!w&&E,onChange:ee=>{H(ee,!s)},selectable:!1,placeholder:"0.0",token:G},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:u!=="both"&&u!==(W==null?void 0:W.coin_type),balance:(ge==null?void 0:ge.balanceFormat)||"",value:s?b:v,amountValue:s?U:D,loading:w&&E,onChange:ee=>{H(ee,s)},selectable:!1,placeholder:"0.0",token:W},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),t.jsx(ae,{borderRadius:"12px",p:"0px",children:t.jsxs($,{w:"100%",gap:"20px",children:[t.jsx(Je,{m:"-1px",isLoading:E,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",disabled:Z||E,onClick:()=>{c?q(!0):h(!0)},children:X||"Deposit"}),(L||T)&&t.jsxs($,{w:"100%",pb:"20px",pl:"16px",pr:"16px",gap:"20px",alignItems:"start",children:[u!=="both"&&t.jsx(S,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",children:T}),L&&t.jsx(ft,{amountLimit:te,inputTotalValue:M,preCalculateLoading:E,lpRate:ce,poolName:`${G==null?void 0:G.symbol} - ${W==null?void 0:W.symbol}`})]})]})}),Y&&t.jsx(es,{data:K(),isOpen:Y,onClose:()=>{q(!1)},onSubmitClick:()=>{q(!1),Q()}})]})}function os(a){const{vaultsCoinPercent:i,displayTokenB:e,displayTokenA:r,vaultCoinAmounts:s,vaultsCoinAValue:x,vaultsCoinBValue:l,isReverse:n}=a,d=o.useMemo(()=>n?l:x,[n,x,l]),u=o.useMemo(()=>n?x:l,[n,x,l]),p=o.useMemo(()=>n?i==null?void 0:i.percentB:i==null?void 0:i.percentA,[n,i]),c=o.useMemo(()=>n?i==null?void 0:i.percentA:i==null?void 0:i.percentB,[n,i]);return t.jsx(ae,{p:{base:"16px 8px",lg:"20px 16px"},children:t.jsxs($,{w:"100%",gap:"0px",children:[t.jsx(S,{w:"100%",textAlign:"start",fontSize:"16px",color:"text_caption",children:"Vault Composition"}),t.jsxs(_,{w:{base:"96%",lg:"90%"},justifyContent:"space-between",mt:"20px",children:[t.jsxs(_,{children:[t.jsx(me,{imageUrl:r==null?void 0:r.logo_url,imageStyle:{w:"28px",h:"28px"}}),t.jsx(fe,{wrapStyle:{gap:"4px"},title:ie(r==null?void 0:r.symbol,10)||"",titleStyle:{fontSize:"16px",color:"text_caption",fontWeight:"600"},value:`${p}%`,valueStyle:{fontSize:"12px",color:"text_paragraph",fontWeight:"500"}})]}),t.jsx(Kt,{ml:"16px",mr:"16px",flex:"1",h:"4px",value:p,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}}),t.jsxs(_,{children:[t.jsx(fe,{wrapStyle:{gap:"4px",alignItems:"flex-end"},title:ie(e==null?void 0:e.symbol,10)||"",titleStyle:{fontSize:"16px",color:"text_caption",fontWeight:"600"},value:`${c}%`,valueStyle:{fontSize:"12px",color:"text_paragraph",fontWeight:"500"}}),t.jsx(me,{imageUrl:e==null?void 0:e.logo_url,coinType:e==null?void 0:e.coin_type})]})]}),t.jsxs(_,{w:{base:"100%",lg:"90%"},justifyContent:"space-between",mt:"12px",children:[t.jsx(fe,{wrapStyle:{gap:{base:"8px",lg:"4px"}},title:`${A(s==null?void 0:s.displayCoinA,6)} ${ie(r==null?void 0:r.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",fontWeight:"500"},value:pe(d,2),valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"14px"},fontWeight:"500"}}),t.jsx(fe,{wrapStyle:{gap:{base:"8px",lg:"4px"},alignItems:"flex-end"},title:`${A(s==null?void 0:s.displayCoinB,6)} ${ie(e==null?void 0:e.symbol,10)}`,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",fontWeight:"500"},value:pe(u,2),valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"14px"},fontWeight:"500"}})]})]})})}function ls(a){var s,x,l,n,d,u;const{isApp:i}=st(),{apiVaultInfo:e}=a,{getExplorerUrl:r}=Tt();return t.jsxs(We,{flexDir:{base:"column",lg:"row"},w:"100%",justifyContent:"space-between",children:[t.jsxs(_,{children:[t.jsx(rt,{coinACoinType:(s=e==null?void 0:e.displayTokenA)==null?void 0:s.coin_type,coinBCoinType:(x=e==null?void 0:e.displayTokenB)==null?void 0:x.coin_type,coinAIconUrl:(l=e==null?void 0:e.displayTokenA)==null?void 0:l.logo_url,coinBIconUrl:(n=e==null?void 0:e.displayTokenB)==null?void 0:n.logo_url}),t.jsx(S,{fontSize:"16px",color:"text_caption",fontWeight:"500",children:(e==null?void 0:e.name)||`${(d=e==null?void 0:e.displayTokenA)==null?void 0:d.symbol} - ${(u=e==null?void 0:e.displayTokenB)==null?void 0:u.symbol}`}),t.jsx(ae,{w:"unset",p:{base:"8px 12px",lg:"4px 6px"},borderRadius:"12px",ml:"4px",children:t.jsx(_,{children:t.jsx(S,{fontSize:{base:"14px",lg:"12px"},color:"primary",children:e==null?void 0:e.feeDisplay})})}),!i&&t.jsxs(_,{ml:"12px",gap:"4px",children:[t.jsx(S,{fontSize:"14px",children:"Vault Address"}),t.jsx(et,{fontSize:"14px",address:(e==null?void 0:e.vaultsId)||"",onClickLink:()=>{window.open(r(e==null?void 0:e.vaultsId,"poolAddress"),"_blank")}})]})]}),t.jsx(We,{flexDir:{base:"column",lg:"row"},gap:{base:"8px",lg:"60px"},children:i?t.jsxs(t.Fragment,{children:[t.jsx(oe,{label:"Vault Address",labelStyle:{fontSize:"14px"},value:t.jsx(et,{fontSize:"14px",color:"text_caption",address:(e==null?void 0:e.vaultsId)||"",onClickLink:()=>{window.open(r(e==null?void 0:e.vaultsId,"poolAddress"),"_blank")}})}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"APY",labelStyle:{fontSize:"14px"},rightValueTip:t.jsx(Be,{vaultsLstApyDisplay:e==null?void 0:e.vaultsLstApyDisplay,vaultsApyDisplay:e==null?void 0:e.vaultsApyDisplay,vaultsTotalApyDisplay:e==null?void 0:e.vaultsTotalApyDisplay}),value:(e==null?void 0:e.vaultsTotalApyDisplay)||"-",valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500"}}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"Rewards",labelStyle:{fontSize:"14px"},value:t.jsx(tt,{placement:"top",tooltip:t.jsx(S,{fontSize:"12px",lineHeight:"20px",maxW:"240px",children:"Rewards will be auto harvested and compounded to your position."}),children:t.jsx(Le,{children:t.jsx(_,{w:"100px",justifyContent:"end",children:e==null?void 0:e.vaultsRewards.map(p=>t.jsx(Ie,{coinType:p},p))})})}),valueStyle:{h:"20px",lineHeight:"20px"}}),t.jsx(oe,{wrapStyle:{gap:"6px"},label:"TVL",labelStyle:{fontSize:"14px"},value:(e==null?void 0:e.vaultsTvlDisplay)||"-",valueStyle:{color:"text_caption",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500"}})]}):t.jsxs(t.Fragment,{children:[t.jsx(fe,{wrapStyle:{alignItems:"flex-end",gap:"6px"},title:"APY",titleStyle:{fontSize:"12px"},valueTooltip:t.jsx(Be,{vaultsLstApyDisplay:e==null?void 0:e.vaultsLstApyDisplay,vaultsApyDisplay:e==null?void 0:e.vaultsApyDisplay,vaultsTotalApyDisplay:e==null?void 0:e.vaultsTotalApyDisplay}),value:(e==null?void 0:e.vaultsTotalApyDisplay)||"-",valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontWeight:"500"}}),t.jsx(fe,{wrapStyle:{gap:"6px",alignItems:"flex-end"},title:"Rewards",titleStyle:{fontSize:"12px"},value:t.jsx(tt,{placement:"top",tooltip:t.jsx(S,{fontSize:"12px",lineHeight:"20px",maxW:"240px",children:"Rewards will be auto harvested and compounded to your position."}),children:t.jsx(Le,{children:t.jsx(_,{w:"100px",justifyContent:"end",children:e==null?void 0:e.vaultsRewards.map(p=>t.jsx(Ie,{coinType:p},p))})})}),valueStyle:{h:"20px"}}),t.jsx(fe,{wrapStyle:{alignItems:"flex-end",gap:"6px"},title:"TVL",titleStyle:{fontSize:"12px"},value:(e==null?void 0:e.vaultsTvlDisplay)||"-",valueStyle:{color:"text_caption",h:"20px",lineHeight:"20px",fontWeight:"500"}})]})})]})}function ns(a,i,e,r,s,x,l,n){const{setDetailRefreshCount:d}=at(),{fetchTokenPrices:u,getTokenAmountValue:p}=it(),{vaultsSdk:c}=ot(),{vaultsSlippage:h,mevProtect:b,maxCapForGas:v,transactionMode:C,customGasPrice:y}=Qe(),{findBestRouters:U}=Qt(),[D,E]=o.useState(""),[w,M]=o.useState(""),[H,L]=o.useState(!0),[T,Q]=o.useState(""),[N,se]=o.useState(!1),[X,Z]=o.useState(0),ce=o.useRef(T),te=o.useRef(H),Y=o.useRef(D),q=o.useRef(w),V=o.useRef(N),ge=o.useRef(X);o.useEffect(()=>{ge.current=X},[X]),o.useEffect(()=>{V.current=N},[N]),o.useEffect(()=>{ce.current=T},[T]),o.useEffect(()=>{te.current=H},[H]),o.useEffect(()=>{Y.current=D},[D]),o.useEffect(()=>{q.current=w},[w]),o.useEffect(()=>{const m=[];l&&n&&(m.push(l.coin_type),m.push(n.coin_type)),m.length>0&&u(m)},[l==null?void 0:l.coin_type,n==null?void 0:n.coin_type]);const[G,W]=o.useState("0"),[K,ee]=o.useState("0"),[we,le]=o.useState(!1);o.useEffect(()=>{Pe(),xe()},[a]),o.useEffect(()=>{xe()},[e.coinAmountA]);const xe=()=>{const{coinAmountA:m,coinAmountB:P}=e;if(console.log("🚀 ~ useEffect ~ holdCoinAmounts:",e),le(!1),a==="both"){W(m),ee(P);return}const j=a===(l==null?void 0:l.coin_type),O=j?P:m;let F=j?m:P;const re=j?n:l,Se=j?l:n;g(O).gt(0)?(le(!0),W("0"),ee("0"),U({fromToken:re,toToken:Se,amount:Ce(O,re.decimals).toString(),providersKeys:c.sdkOptions.aggregator.providers,by_amount_in:!0,uuid:T}).then(ye=>{console.log("🚀 ~ calculateAvailableAmount ~ uuid:",{result:ye}),ye.toAmountUi&&(F=g(F).add(ye.toAmountUi).toString()),j?W(F):ee(F)}).finally(()=>{le(!1)})):j?W(F):ee(F)},de=p(l==null?void 0:l.coin_type,D),be=p(n==null?void 0:n.coin_type,w),Ee=o.useMemo(()=>g(de||"0").add(be||"0").toString(),[de,be]),[Ae,R]=o.useState(!1),[f,z]=o.useState(void 0),B=lt(async(m,P,j,O,F)=>{var re,Se;if(l&&n&&x&&s){if(!F){if(j){if(g(m).gt(G)){Q(""),z(void 0),R(!1);return}}else if(g(m).gt(K)){Q(""),z(void 0),R(!1);return}}d(0),(+Y.current||+q.current||F)&&R(!0);const ze=P?m:Ce(m,(j?l:n).decimals).toFixed(0),Xe={vault_id:x,fix_amount_a:j,input_amount:ze,slippage:Number(h),request_id:O,side:a==="both"?ve.Both:ve.OneSide,is_ft_input:P,max_ft_amount:s};console.log("🚀 ~ preCalculate ~ params:",Xe,O,F);try{const k=await c.Vaults.calculateWithdrawAmount(Xe);if(console.log("🚀 ~ preCalculate ~ res:",{...k,uuid:O,assetAction:a}),ce.current===O){const Ue=ne(k.amount_a.toString(),l.decimals).toString(),He=ne(k.amount_b.toString(),n.decimals).toString();if(a==="both"&&(P?(M(He),E(Ue),F===100&&(W(Ue),ee(He)),z(k)):j?+Y.current?(M(He),z(k)):M(""):+q.current?(E(Ue),z(k)):E("")),a!=="both"){if(F){const Ze=ne(g(k.amount_a).add(((re=k.swap_result)==null?void 0:re.swap_out_amount)||"0").toString(),l.decimals).toString();if(j)E(Ze),M(""),F===100&&(k.burn_ft_amount=s,W(Ze));else{const Ve=ne(g(k.amount_b).add(((Se=k.swap_result)==null?void 0:Se.swap_out_amount)||"0").toString(),n.decimals).toString();E(""),M(Ve),F===100&&(k.burn_ft_amount=s,ee(Ve))}}z(k)}}}catch(k){console.log("🚀 ~ preCalculate ~ error:",k),z(void 0)}finally{R(!1)}}},500),ue=(m,P,j=!1,O=!1,F=!0)=>{if(j){I(100);return}if(O){I(50);return}if(L(P),se(!1),P?(E(m),F&&M("")):(M(m),F&&E("")),+m){const re=Te();Q(re),B(m,!1,P,re)}else Pe()},I=m=>{if(se(!0),Z(m),s&&+s)if(m===0)Pe();else{const P=a===(l==null?void 0:l.coin_type);if(L(P),m===100||a==="both"){const j=Te();Q(j);const O=m===100?s:g(s).mul(m).div(100).toFixed(0);B(O,!0,P,j,m)}else{L(P);const j=g(a===(l==null?void 0:l.coin_type)?G:K).mul(m).div(100).toFixed();B(j,!1,P,T,m)}}},_e=()=>{if(console.log("🚀 ~ reCalculateResult ~ isPercentInput:",{isPercentInput:N,removePercent:X}),N)I(X);else{const m=te.current?Y.current:q.current;ue(m,te.current)}};o.useEffect(()=>{if(!N)if(f&&s&&+s){let m=Number(g(f.burn_ft_amount).div(s).mul(100));m>100&&(m=100),Z(m)}else Z(0)},[f==null?void 0:f.burn_ft_amount]);const[Oe,Re]=o.useState(!1),{signAndExecuteTransaction:bt,transactionConfirmation:St,transactionRejected:yt}=dt(),jt=async()=>{if(x&&f&&s){Re(!0);let m;if(a==="both")m={vault_id:x,ft_amount:f==null?void 0:f.burn_ft_amount,slippage:Number(h)};else{const j=a===(l==null?void 0:l.coin_type);if(X===100)m={vault_id:x,is_ft_input:!0,input_amount:s,slippage:Number(h),max_ft_amount:s,fix_amount_a:j};else{const O=Ce(H?D:w,9);m={vault_id:x,is_ft_input:!1,input_amount:O.toString(),slippage:Number(h),max_ft_amount:s,fix_amount_a:j}}}console.log("🚀 ~ doRemoveAction ~ params:",m);const P={getShowInfo:(j,O)=>{const F="Withdraw "+[he(D,l==null?void 0:l.symbol),he(w,n==null?void 0:n.symbol)].filter(Boolean).join(" and "),re={modalDescriptionText:F,toastDescriptionContent:F};if(j==="success"){let Se=D,ye=w;O&&(Se=g(D).gt(0)?$e(O,l)||D:"",ye=g(w).gt(0)?$e(O,n)||w:"");const ze="Removed "+[he(Se,l==null?void 0:l.symbol),he(ye,n==null?void 0:n.symbol)].filter(Boolean).join(" and ");re.toastDescriptionContent=ze,re.modalDescriptionText=ze}return re}};St(P);try{const j=await c.Vaults.withdraw(m);await bt(j,P,{useMev:b,txAction:"signTransactionBlock",useFastMode:C==="Fast Mode",maxCapForGas:v,customGasPrice:y,msafeParams:{action:xt.RemoveVaultsPosition,txbParams:m}})?Pe():_e(),i()}catch(j){console.log("🚀 ~ doAddAction ~ error:",j),yt(P)}}},Pe=()=>{E(""),M(""),Z(0),R(!1),z(void 0),Q("")},vt=o.useMemo(()=>{if(f&&f.swap_result&&a!=="both"&&l&&n){const m=H?D:w,P=te.current?l:n,j=te.current?n:l,O=ne(f.swap_result.swap_in_amount,P.decimals),F=ne(g(f.swap_result.swap_out_amount).mul(1-Number(h)).toString(),j.decimals);return console.log("vaultsSlippage: ",{vaultsSlippage:h,calculateResult:f,swapOutAmount:F}),`To withdraw ${m} ${P==null?void 0:P.symbol}, ${O} ${j==null?void 0:j.symbol} in the pool will be traded for ${F} ${P==null?void 0:P.symbol}`}},[a,f,D,w]);return{handleAmountInputChange:ue,fixAmountA:H,amountInputA:D,amountInputB:w,availableAmountA:G,availableAmountB:K,amountValueA:de,amountValueB:be,preCalculateLoading:Ae,inputTotalValue:Ee,calculateResult:f,showOnlySideTips:vt,doRemoveAction:jt,handlePercentInputChange:I,isPercentInput:N,removePercent:X,reCalculateResult:_e,calculateAvailableAmount:xe,calculateAvailableLoading:we}}function as(a){const{apiVaultInfo:i,tokenA:e,tokenB:r,isReverse:s,vaultsId:x,totalLp:l,holdCoinAmounts:n,holdLpAmount:d,handleRefreshClick:u}=a,[p,c]=o.useState("both"),{currentAccount:h,onWalletModal:b}=Fe(),{amountInputA:v,amountInputB:C,availableAmountA:y,availableAmountB:U,amountValueA:D,amountValueB:E,preCalculateLoading:w,fixAmountA:M,inputTotalValue:H,handleAmountInputChange:L,calculateResult:T,showOnlySideTips:Q,doRemoveAction:N,handlePercentInputChange:se,removePercent:X,isPercentInput:Z,reCalculateResult:ce,calculateAvailableLoading:te}=ns(p,u,n,l,d,x,e,r),{btnText:Y,btnDisabled:q}=gt(p,!1,v,C,M,y,U,e,r);ut(T==null?void 0:T.burn_ft_amount,l);const{amountLimit:V}=pt(0,T==null?void 0:T.burn_ft_amount,!1),ge=o.useMemo(()=>s?U:y,[U,y,s]),G=o.useMemo(()=>s?y:U,[y,U,s]),W=o.useMemo(()=>s?r:e,[s,e,r]),K=o.useMemo(()=>s?e:r,[s,e,r]),ee=o.useMemo(()=>w?Z?!0:s?M:!M:!1,[w,Z]),we=o.useMemo(()=>w?Z?!0:s?!M:M:!1,[w,Z]);return o.useEffect(()=>{ce()},[i]),t.jsxs($,{gap:"8px",w:"100%",align:"flex-start",children:[t.jsx(ht,{label:"Remove Amounts",displayTokenB:s?e:r,displayTokenA:s?r:e,onSelectAssetTab:c,handleRefreshClick:()=>{u(),ce()}}),t.jsx(mt,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},calculateAvailableLoading:te,hideSelf:p!=="both"&&p!==(W==null?void 0:W.coin_type),balance:ge||"",value:s?C:v,amountValue:s?E:D,loading:ee,onChange:(le,xe,de)=>{L(le,!s,xe,de)},needRemainBalance:!1,selectable:!1,placeholder:"0.0",token:W,balanceLabel:"Available"},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},balanceLabel:"Available",calculateAvailableLoading:te,needRemainBalance:!1,hideSelf:p!=="both"&&p!==(K==null?void 0:K.coin_type),balance:G||"",value:s?v:C,amountValue:s?D:E,loading:we,onChange:(le,xe,de)=>{L(le,s,xe,de)},selectable:!1,placeholder:"0.0",token:K}}),t.jsxs(ae,{borderRadius:"12px",p:{base:"16px 8px",lg:"16px"},children:[t.jsx(S,{color:"primary_gray",children:"Amount"}),t.jsx(Jt,{percentage:X,onChange:le=>{se(Number(le.toString().replace("%","")))}})]}),t.jsx(ae,{borderRadius:"12px",p:"0px",children:t.jsxs($,{w:"100%",gap:"20px",children:[t.jsx(Je,{m:"-1px",isLoading:w,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",disabled:q||w,onClick:()=>{h?N():b(!0)},children:Y||"Withdraw"}),T&&t.jsxs($,{w:"100%",pb:"20px",pl:"16px",pr:"16px",gap:"20px",children:[p!=="both"&&t.jsx(S,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",children:Q}),t.jsxs($,{w:"100%",gap:"20px",children:[t.jsx(oe,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:pe(H,2),valueStyle:{fontSize:"14px"},isLoading:w}),t.jsx(oe,{label:"LP Burn Amount",value:`${A(ne(V||"0",9),9)} ${`${W==null?void 0:W.symbol} - ${K==null?void 0:K.symbol}`}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},isLoading:w})]})]})]})})]})}const cs=[{label:"Deposit",value:"Deposit"},{label:"Withdraw",value:"Withdraw"}];function ks(){const{vaultId:a}=Ft(),{currentAccount:i}=Fe(),{apiVaultInfo:e,getApiVaultInfo:r}=Zt(a),{fetchAccountBalance:s}=qt(),{contractVault:x,lpTokenInfo:l,minPrice:n,maxPrice:d,vaultCoinAmounts:u,vaultsCoinAValue:p,vaultsCoinBValue:c,currPrice:h,balanceInfo:b,totalValue:v,fetchClmmPoolFromContract:C,fetchVaultInfoFromContract:y,vaultsCoinPercent:U,sharePoolRate:D,holdCoinAmounts:E,holdCoinAValue:w,holdCoinBValue:M}=Ut(e==null?void 0:e.vaultsId,e==null?void 0:e.clmmPoolAddress,e==null?void 0:e.tokenA,e==null?void 0:e.tokenB,e==null?void 0:e.isReverse),[H,L]=o.useState("Deposit"),{rewardPerA:T,rewardPerB:Q}=Ht(b==null?void 0:b.balanceFormat,e);o.useEffect(()=>{a&&y(a,!0)},[a]),o.useEffect(()=>{e&&C(e.clmmPoolAddress,!0)},[e==null?void 0:e.clmmPoolAddress]),o.useEffect(()=>{i!=null&&i.address&&s()},[]);const N=()=>{s(),e&&C(e.clmmPoolAddress,!0),a&&(y(a,!0),r(a,!0))};return t.jsxs($,{gap:"20px",w:"100%",pt:"40px",align:"flex-start",children:[t.jsxs(_,{w:"100%",justify:"space-between",children:[t.jsx(Et,{}),t.jsx(Nt,{handleRefresh:N,isAutoRefresh:!0,refreshInterval:20,innerStyle:{bg:"background"},w:"32px",h:"32px",borderRadius:"8px",bg:"background"})]}),t.jsx(ls,{apiVaultInfo:e}),t.jsxs(We,{flexDir:{base:"column-reverse",lg:"row"},w:"100%",justifyContent:"space-between",gap:"16px",alignItems:"start",children:[t.jsxs($,{w:{base:"100%",lg:"auto"},flex:"1",gap:"8px",children:[t.jsx(kt,{minPrice:n,maxPrice:d,currentPrice:h,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,isReverse:(e==null?void 0:e.isReverse)||!1}),t.jsx(os,{vaultCoinAmounts:u,vaultsCoinAValue:p,vaultsCoinBValue:c,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsCoinPercent:U}),t.jsx(Vt,{sharePoolRate:D,balanceInfo:b,totalValue:v,displayTokenB:e==null?void 0:e.displayTokenB,displayTokenA:e==null?void 0:e.displayTokenA,lpLogoUrl:l==null?void 0:l.logo_url,holdCoinAmounts:E,holdCoinAValue:w,holdCoinBValue:M,isReverse:(e==null?void 0:e.isReverse)||!1,rewardPerA:T,rewardPerB:Q})]}),t.jsxs($,{w:{base:"100%",lg:"40%"},justifyContent:"start",gap:"8px",children:[t.jsx(ae,{p:"0",borderRadius:"12px",children:t.jsxs(_,{w:"100%",p:{base:"0 8px",lg:"0 16px"},children:[t.jsx(nt,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{fontSize:"16px",mr:"28px"},tabList:cs,currentTab:H,handleChangeTab:se=>{L(se==null?void 0:se.value)}}),t.jsx(At,{slippageType:"vaults",compact:!0})]})}),H==="Deposit"&&t.jsx(is,{apiVaultInfo:e,feeTier:e==null?void 0:e.feeDisplay,tokenA:e==null?void 0:e.tokenA,tokenB:e==null?void 0:e.tokenB,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsId:e==null?void 0:e.vaultsId,totalLp:x==null?void 0:x.total_supply,handleRefreshClick:N}),H==="Withdraw"&&t.jsx(as,{apiVaultInfo:e,holdCoinAmounts:E,tokenA:e==null?void 0:e.tokenA,tokenB:e==null?void 0:e.tokenB,isReverse:(e==null?void 0:e.isReverse)||!1,vaultsId:e==null?void 0:e.vaultsId,totalLp:x==null?void 0:x.total_supply,holdLpAmount:b==null?void 0:b.balance,handleRefreshClick:N})]})]})]})}export{ks as default};

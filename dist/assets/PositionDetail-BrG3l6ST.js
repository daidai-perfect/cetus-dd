import{a1 as ae,r as j,ab as U,d as z,b as te,j as e,W as f,m as se,T as r,V as L,H as n,g as P,S as H,as as pe,aA as ge,$ as xe,a$ as ue,e as he,a5 as be,aO as Se,B as je,az as Ce,aQ as ve,bb as Ae,Y as ke,a as Re,bc as Le,a_ as We,k as Ee}from"./index-CrLDUzf4.js";import{A as Fe}from"./index-B8dGYaZb.js";import{C as Ve}from"./CoinPairInfo-BfDsONRq.js";import{S as ze}from"./Slippage-DNew12u8.js";import{u as He,c as Me,L as fe,b as Ne,S as I}from"./useGetContractPoolInfo-BVidj5hf.js";import{u as De,a as Ge,P as Ue}from"./PositionCurrentPrice-Cxe9L1Mm.js";import{u as ee,a as ye}from"./useCurrentPos-DRIoDsPS.js";import{e as Ye,f as Oe,c as Q,b as qe}from"./usePositionList-C6hCOMJ_.js";import{A as we}from"./AddressCopyLink-CqSacTr3.js";import{C as $e}from"./CetusTooltip-BUG0NyC7.js";import{u as Te}from"./useAccountBalance-CXZi51PX.js";import{u as Qe}from"./useTransaction-DsGcn4o8.js";import{L as Je}from"./PriceRange-BdvwMxps.js";import{P as Ke}from"./progress-ChsYoC9B.js";import{L as le}from"./LockInput-CNW1ATmQ.js";import{u as Xe}from"./usePosAdd-j54rBoeD.js";import{T as Ze}from"./TradeInputGroup-DlCMUkdy.js";import{F as Be,R as Ie}from"./RemoveBlock-IuhlN3kY.js";import{R as Pe}from"./RangeAlerts-DGKHF2-C.js";import{T as ei}from"./TooltipIcon-1De9lktN.js";import{P as ii}from"./PositionStatus-CK4NxSmn.js";import{R as si}from"./RangeValue-B1QGXn6d.js";import{u as li}from"./index-XGXiGOWa.js";import{b as pi,u as ai}from"./useGetPoolList-DH_ZoZq7.js";import{R as re}from"./RefreshButton-CtgwEHuv.js";import{u as ti}from"./useRpcListener-DxPF9xu6.js";import"./global-CUa47jxk.js";import"./index-jR-4a9Sq.js";import"./useTokenBalance-AztDpMX4.js";import"./switch-zooPS-Dj.js";import"./linear-DYpwdEgO.js";import"./liquidity-CbXFzhlr.js";import"./usePreviousValue-I2C_cVB5.js";import"./ActionButton-Dv102X4i.js";import"./HTextLabelBox-DTpPKvWZ.js";import"./VTextLabelBox-Cvr_KOOS.js";import"./useToken-DDK1y6Ol.js";import"./useBurn-CImvgiBP.js";import"./msafe-oYBkW7LJ.js";import"./api-data-utils-CbMpbpVK.js";import"./AddressUnderline-UBqmtWNP.js";import"./SingleTokenInfo-D05DhnKv.js";import"./progress.utils-CevYo8M6.js";import"./icon_lock@2x-OdzkPjmc.js";import"./useInsufficientBalanceToast-DEQnfiG-.js";import"./_getAllKeysIn-DEJsZXHN.js";import"./ExpendItem-CB2ZjIzH.js";import"./useNotifiSubscription-DXuesVfe.js";import"./useXCetusHelper-Dr2BQZTm.js";function xi(){var X,Z,O,q,V,de;const{tokenAmountA:i,tokenAmountB:a,currentPosDetailTab:d,curPosContractPoolInfo:t}=ee(),{getPosFeeData:C}=Ye(),{getPosRewardsData:o}=Oe(),{currentAccount:p}=ae(),{currentPosBaseInfo:s,posFeeData:g,posRewardsData:m,posLiquidityData:h,currentPosBaseInfoLoading:R,posFeeDataLoading:v,posRewardsDataLoading:l}=Q();ye();const x=j.useMemo(()=>h[s==null?void 0:s.posId],[h,s==null?void 0:s.posId]),y=j.useMemo(()=>(console.log("ðŸš€ ~ currentPosFeeData ~ posFeeData[currentPosBaseInfo?.posId as string]:",g[s==null?void 0:s.posId]),g[s==null?void 0:s.posId]),[g,s==null?void 0:s.posId]),_=j.useMemo(()=>(console.log("ðŸš€ ~ currentPosRewardsData ~ posRewardsData[currentPosBaseInfo?.posId as string]:",m[s==null?void 0:s.posId]),m[s==null?void 0:s.posId]),[m,s==null?void 0:s.posId]),w=U(x==null?void 0:x.displayCoinAmountA,void 0,!0),W=U(x==null?void 0:x.displayCoinAmountB,void 0,!0),[u,A]=j.useState(!1),[E,T]=j.useState("--"),{signAndExecuteTransaction:S}=Qe(),{getPosClaimFeeAndRewardTxPayload:N}=De(),{calculatePendingYield:D}=Ge();j.useEffect(()=>{if(!R&&!v&&!l){const{total:b}=D([s],g,m);T(b)}},[R,v,l]);const{fetchAccountBalance:k}=Te(),M=async()=>{A(!0);try{const b=(_==null?void 0:_.map(ie=>ie.coin_address))||[],B={posType:s==null?void 0:s.posType,id:s==null?void 0:s.id,clmmPool:s==null?void 0:s.clmmPool,coinTypeA:s==null?void 0:s.coinTypeA,coinTypeB:s==null?void 0:s.coinTypeB,rewarderCoinTypes:b,account:p==null?void 0:p.address};console.log("ðŸš€ ~ toClaim ~ params.currentPosBaseInfo:",B,s);const{tx:ne,msafeParams:_e}=await N(B);console.log("ðŸš€ ~ toClaim ~ tx:",ne);const oe=await S(ne,{getShowInfo:ie=>{const ce={modalDescriptionText:"",toastTitleText:""};return ie==="success"&&(ce.toastTitleText="Claim Successful"),ce}},{msafeParams:_e});console.log("ðŸš€ ~ toClaim ~ res:",oe),oe&&setTimeout(()=>{k(),C([s]),o([s],{[t.poolAddress]:t})},2e3),A(!1)}catch(b){A(!1),console.log("ðŸš€ ~ toClaim ~ error:",b)}},F=i!==""||a!=="",G=z(+w).sub(+i).toString(),J=F?z(w).eq(0)?"0":d=="increase"?z(i).plus(w).toString():z(G).gt(0)?G:"0":"",Y=z(+W).sub(+a).toString(),c=F?z(W).eq(0)?"0":d=="increase"?z(a).plus(W).toString():z(Y).gt(0)?Y:"0":"",{isApp:K}=te();return e.jsxs(f,{w:"100%",borderRadius:"16px",p:"0",children:[e.jsx(f,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"auto",lg:"80px"},p:{base:"20px 8px",lg:"20px 20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(se,{flexDir:{base:"column",lg:"row"},w:"100%",justify:{base:"center",lg:"space-between"},gap:{base:"16px",lg:"0"},children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},align:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},mt:{base:"-12px",lg:"0"},children:[e.jsx(r,{color:"primary_gray",mb:{base:"0",lg:"-12px"},children:"Liquidity"}),e.jsx(Je,{positionInfo:s,haveTooltip:!1})]}),e.jsxs(L,{minW:"200px",align:{base:"center",lg:"flex-end"},pb:{base:"0",lg:"12px"},gap:"12px",children:[e.jsxs(n,{w:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsxs(n,{gap:"4px",children:[e.jsx(P,{imageUrl:(X=s==null?void 0:s.displayTokenA)==null?void 0:X.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:s?(Z=s==null?void 0:s.displayTokenA)==null?void 0:Z.coin_type:""}),e.jsx(H,{isLoaded:!!s&&!!x,children:e.jsxs(n,{gap:"4px",children:[e.jsx(r,{color:"primary",children:pe((O=s==null?void 0:s.displayTokenA)==null?void 0:O.symbol)}),e.jsxs(r,{color:"primary",children:[x==null?void 0:x.displayPercentA,"%"]})]})})]}),e.jsxs(n,{gap:"4px",children:[e.jsx(P,{imageUrl:(q=s==null?void 0:s.displayTokenB)==null?void 0:q.logo_url,w:"20px",h:"20px",showTagWidth:"10px",showTagHeight:"10px",coinType:s?(V=s==null?void 0:s.displayTokenB)==null?void 0:V.coin_type:""}),e.jsx(H,{isLoaded:!!s&&!!x,children:e.jsxs(n,{gap:"4px",children:[e.jsx(r,{color:"primary_green",children:pe((de=s==null?void 0:s.displayTokenB)==null?void 0:de.symbol)}),e.jsxs(r,{color:"primary_green",children:[x==null?void 0:x.displayPercentB,"%"]})]})})]})]}),e.jsx(Ke,{w:"200px",h:"4px",value:x==null?void 0:x.displayPercentA,bg:"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}})]})]})}),e.jsxs(n,{gap:{base:"20px",lg:"8px"},p:{base:"20px 8px",lg:"40px 8px"},w:"100%",justify:"space-around",flexDirection:{base:"column",lg:"row"},children:[e.jsx($,{label:"Base",token:s==null?void 0:s.displayTokenA,amount:x==null?void 0:x.displayCoinAmountA,afterAmount:J}),e.jsx($,{label:"Quote",token:s==null?void 0:s.displayTokenB,amount:x==null?void 0:x.displayCoinAmountB,afterAmount:c})]}),e.jsx(f,{bg:"bg_primary",borderRadius:"16px",mt:"-1px",h:{base:"70px",lg:"80px"},p:{base:"20px 8px",lg:"20px"},borderLeft:"none",borderRight:"none",children:e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsxs(se,{flexDir:{base:"row",lg:"column"},alignItems:{base:"center",lg:"flex-start"},justify:{base:"space-between",lg:"center"},w:{base:"100%",lg:"auto"},children:[e.jsx(r,{color:"primary_gray",children:"Pending Yield"}),e.jsx(H,{isLoaded:!!E&&!!s&&!!g&&!!m,children:e.jsx(r,{color:"text_caption",fontSize:"16px",children:ge(E,2)})})]}),e.jsx(xe,{isLoading:u,disabled:Number(E)==0||v||l||u||!y,onClick:M,w:"112px",h:"28px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",children:"Claim"})]})}),e.jsxs(n,{p:{base:"20px 8px 0",lg:"40px 8px 20px"},w:"100%",justify:"space-between",flexWrap:"wrap",sx:{">div":{mb:{base:"12px",lg:"20px"}}},flexDirection:{base:"column",lg:"row"},children:[e.jsx($,{label:"Fees",token:s==null?void 0:s.displayTokenA,amount:y==null?void 0:y.displayFeeOwedA,afterAmount:F?"0":""}),e.jsx($,{label:K?"":"Fees",token:s==null?void 0:s.displayTokenB,amount:y==null?void 0:y.displayFeeOwedB,afterAmount:F?"0":""}),_==null?void 0:_.map((b,B)=>e.jsx(ue.Fragment,{children:z(b.amount_owed).gt(0)&&e.jsx($,{label:K?B==0?"Mining Rewards":"":"Mining Rewards",token:b==null?void 0:b.token,amount:b==null?void 0:b.display_amount_owed,afterAmount:F?"0":""})},b==null?void 0:b.coin_address))]})]})}const $=({label:i,token:a,amount:d,afterAmount:t,isLoading:C})=>{const{isApp:o}=te(),{getExplorerUrl:p}=he();return e.jsxs(L,{align:{base:"flex-end",lg:"center"},gap:{base:"4px",lg:"8px"},w:{base:"100%",lg:"calc(50% - 4px)"},children:[e.jsxs(n,{w:"100%",justify:{base:"space-between"},flexDirection:{base:"row",lg:"column"},children:[e.jsx(r,{color:"primary_gray",children:i}),e.jsxs(n,{children:[e.jsx($e,{showTooltip:!o,placement:"top",tooltip:e.jsxs(n,{children:[e.jsx(P,{imageUrl:a==null?void 0:a.logo_url,w:"20px",h:"20px",minH:"20px",minW:"20px",showTagWidth:"14px",showTagHeight:"14px",coinType:a?a==null?void 0:a.coin_type:""}),e.jsx(r,{color:"text_caption",children:a==null?void 0:a.symbol}),e.jsx(we,{address:a==null?void 0:a.coin_type,onClickLink:()=>window.open(p(a==null?void 0:a.coin_type,"coin"))})]}),children:e.jsx(P,{imageUrl:a==null?void 0:a.logo_url,w:{base:"20px",lg:"28px"},h:{base:"20px",lg:"28px"},minH:{base:"20px",lg:"28px"},minW:{base:"20px",lg:"28px"},showTagWidth:"14px",showTagHeight:"14px",coinType:a?a==null?void 0:a.coin_type:"",onClick:o?()=>window.open(p(a==null?void 0:a.coin_type,"coin")):()=>{}})}),e.jsx(H,{isLoaded:!C&&!!d,children:e.jsx(r,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:U(d)})}),e.jsx(r,{color:"text_caption",fontSize:{base:"14px",lg:"16px"},children:pe(a==null?void 0:a.symbol)})]})]}),t!==""&&t&&e.jsxs(n,{bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(r,{color:"primary",children:U(t)}),e.jsx(r,{color:"primary",children:"after"})]})]})};function di(){const{currentPosBaseInfo:i,posPoolsRelatedData:a}=Q(),{currentAccount:d,onWalletModal:t}=ae(),{tokenAmountA:C,tokenAmountB:o,isFixedDisplayTokenA:p,curPosContractPoolInfo:s}=ee(),{displayTokenA:g,displayTokenB:m,tokenABalanceInfo:h,tokenBBalanceInfo:R,tokenAmountValueA:v,tokenAmountValueB:l,handleAmountChange:x,preAddLoading:y,btnStatusText:_,toAdd:w,isAddLoading:W,showDisplayTokenALock:u,showDisplayTokenBLock:A,resetInputAmount:E}=Xe();j.useEffect(()=>()=>{E()},[]);const{getTokenAmountValue:T}=be(),S=T(g==null?void 0:g.coin_type,C,"--"),N=T(m==null?void 0:m.coin_type,o,"--"),D=S=="--"||N=="--"?"--":Se(v).plus(l).toString(),k=a[i==null?void 0:i.posId];return e.jsxs(L,{w:"100%",gap:"8px",children:[e.jsxs(je,{w:"100%",position:"relative",children:[e.jsx(Ze,{from:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(h==null?void 0:h.balanceFormat)||"",value:C,amountValue:v,loading:!p&&y,onChange:M=>{x(M,!0)},placeholder:"0.0",token:g},to:{wrapStyle:{h:"108px",borderRadius:"12px"},balance:(R==null?void 0:R.balanceFormat)||"",value:o,amountValue:l,loading:p&&y,onChange:M=>{x(M,!1)},placeholder:"0.0",token:m},iconParams:u||A?void 0:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"}}),(!i||!s)&&e.jsx(le,{position:"absolute",top:"0px",left:"0",borderRadius:"12px",h:"224px",zIndex:9999}),i&&(i==null?void 0:i.posType)=="burn"&&e.jsx(le,{position:"absolute",top:"0px",left:"0",h:"224px",borderRadius:"12px",text:"Your liquidity has been permanently locked",zIndex:9999}),i&&s&&(u||A)&&e.jsx(le,{position:"absolute",top:u?"0px":"116px",borderRadius:"12px",h:"108px",left:"0"})]}),e.jsx(xe,{onClick:()=>{d?w():t(!0)},isLoading:W,disabled:_.disabled||W,w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:_.text}),+D&&e.jsx(f,{borderRadius:"0 0 12px 12px",pt:"36px",mt:"-28px",children:e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsx(r,{children:"Total Amount"}),e.jsx(r,{color:"text_caption",children:ge(D,2)})]})}),(i==null?void 0:i.posType)!=="burn"&&e.jsx(Be,{}),k&&(k==null?void 0:k.minPrice)!=="0"&&(k==null?void 0:k.maxPrice)!=="âˆž"&&e.jsx(Pe,{subscriptionSource:"PositionDetail"})]})}function ni(){const{currentPosBaseInfo:i}=Q(),{currentPosPoolInfo:a,curPosContractPoolInfo:d}=ee(),{setContractPoolInfo:t,setApiPoolInfo:C}=li(),{lowerTickData:o,upperTickData:p,setLowerTickData:s,setUpperTickData:g}=He();Ce(()=>{C(a)},[a]);const m=(v,l,x)=>{var T,S;const y=(T=x==null?void 0:x.tokenA)==null?void 0:T.decimals,_=(S=x==null?void 0:x.tokenB)==null?void 0:S.decimals;let w;Math.abs(v)==Math.abs(ve.getMinIndex(Number(x.tickSpacing)))?w=l==="lower"?"0":"âˆž":w=Ae.tickIndexToPrice(v,y,_).toString();const W=w==="âˆž"?"âˆž":U(w,6),u=pi(w),A=u==="âˆž"?"âˆž":U(u,6),E={id:l,tokenA:x==null?void 0:x.tokenA,tokenB:x==null?void 0:x.tokenB,tick:v,price:w,displayPrice:W,reversePrice:u,displayReversePrice:A,tickSpacing:x==null?void 0:x.tickSpacing,pool:x==null?void 0:x.poolAddress};l==="lower"?s({...E}):g({...E})},{getCurrentPrice:h}=Me();j.useEffect(()=>{i!=null&&i.lowerTick&&(d!=null&&d.current_sqrt_price)&&(a!=null&&a.poolAddress)&&(m(i==null?void 0:i.lowerTick,"lower",a),m(i==null?void 0:i.upperTick,"upper",a),h(d==null?void 0:d.current_sqrt_price,a),t(d))},[i==null?void 0:i.lowerTick,d==null?void 0:d.current_sqrt_price,a==null?void 0:a.poolAddress]);const R=j.useMemo(()=>(i==null?void 0:i.posId)&&(o==null?void 0:o.pool)&&(p==null?void 0:p.pool),[o==null?void 0:o.pool,p==null?void 0:p.pool,i==null?void 0:i.posId]);return e.jsx(je,{className:"chart-block",w:{base:"100%",lg:"200px"},h:"85px",mb:"8px",overflow:"hidden",children:R&&e.jsx(fe,{isFrom:"position",handleClickRefresh:()=>{},direct:!(i!=null&&i.isReverse),minPriceData:i!=null&&i.isReverse?p:o,maxPriceData:i!=null&&i.isReverse?o:p,readonly:!0})})}function oi(){const{currentPosBaseInfo:i,posPoolsRelatedData:a,posPoolsOriginalData:d}=Q(),t=a[i==null?void 0:i.posId],{getClmmPosName:C}=qe(),o=j.useMemo(()=>{var m;if(i!=null&&i.tokenName)return i==null?void 0:i.tokenName;{const h=(m=d==null?void 0:d[i==null?void 0:i.clmmPool])==null?void 0:m.index;return C(i==null?void 0:i.index,h)}},[i==null?void 0:i.tokenName,i==null?void 0:i.index,i==null?void 0:i.clmmPool,d]);(t==null?void 0:t.displayFee)+"";const p=(t==null?void 0:t.currentStatus)=="Active",s=j.useMemo(()=>{console.log("ðŸš€ ~ leverage ~ currentPosPoolsRelatedData:",t);const m=t==null?void 0:t.minPriceOrigin,h=t==null?void 0:t.maxPriceOrigin;return m!=="0"&&h!=="âˆž"?ke(1/(1-Number((m/h)**.25)),2)+"x":"1x"},[t==null?void 0:t.minPriceOrigin,t==null?void 0:t.maxPriceOrigin]),{getExplorerUrl:g}=he();return e.jsxs(f,{w:"100%",borderRadius:"20px 20px 16px 16px",children:[e.jsx(f,{p:{base:"16px 8px",lg:"16px"},w:"calc(100% + 34px)",ml:"-17px",mt:"-21px",bg:"bg_primary",children:e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{h:{base:"40px",lg:"32px"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(r,{children:"Position ID"}),e.jsx(H,{isLoaded:!!o,children:e.jsx(r,{color:"text_caption",children:o==null?void 0:o.split("|")[1]})})]}),e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(r,{children:"Position NFT"}),e.jsx(H,{isLoaded:!!(i!=null&&i.id),children:e.jsx(we,{fontWeight:"500",color:"text_caption",fontSize:"14px",address:i==null?void 0:i.id,showLink:!1,onClickLink:()=>{window.open(g(i==null?void 0:i.id,"nftAddress"),"_blank")}})})]})]}),t&&e.jsx(ii,{isActive:p,isLoading:(t==null?void 0:t.currentStatus)=="",h:"32px",p:"0 12px",w:"unset",isRow:!0,imgStyle:{imgW:"30px",imgH:"16px"}})]})}),e.jsxs(n,{gap:{base:"20px",lg:"8px"},w:"100%",justify:"space-between",p:"28px 0 20px",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(L,{gap:{base:"16px",lg:"32px"},children:[e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(r,{color:"primary_gray",children:"Current Price"}),e.jsx(Ue,{posId:(i==null?void 0:i.posId)||"",displayTokenA:i==null?void 0:i.displayTokenA,displayTokenB:i==null?void 0:i.displayTokenB})]}),e.jsxs(L,{w:"100%",justify:"space-between",mt:"8px",align:{base:"center",lg:"flex-start"},children:[e.jsx(r,{color:"primary_gray",children:"Position Range"}),e.jsx(si,{displayTokenA:i==null?void 0:i.displayTokenA,displayTokenB:i==null?void 0:i.displayTokenB,justify:"center",priceInfo:{minPrice:t==null?void 0:t.minPrice,maxPrice:t==null?void 0:t.maxPrice,minPriceResever:t==null?void 0:t.minPriceResever,maxPriceResever:t==null?void 0:t.maxPriceResever},fontSize:"14px"})]})]}),e.jsxs(L,{gap:"0",children:[e.jsx(ni,{}),e.jsx(L,{zIndex:"9",children:e.jsxs(n,{gap:"2px",bg:"primary_opacity.10",borderRadius:"full",p:" 0 20px",h:"26px",align:"center",children:[e.jsx(r,{color:"primary",fontSize:"12px",children:"Leverage"}),e.jsx(ei,{type:"leverage"}),e.jsx(H,{ml:"4px",isLoaded:!!s&&!!t,children:e.jsx(r,{color:"primary",children:s})})]})})]})]})]})}function ts(){var J,Y;const i=Re(),{fetchAccountBalance:a}=Te(),{currentAccount:d}=ae(),{position_nft_id:t}=Le(),{getCurrentPosBaseInfo:C}=ye(),{currentPosDetailTab:o,currentPosPoolInfo:p,setCurrentPosDetailTab:s,setCurrentPosPoolInfo:g,setCurrentPoolSqrtPrice:m,setCurPosContractPoolInfo:h,setIsPosDetailRefresh:R}=ee(),{posPoolsRelatedData:v,currentPosBaseInfo:l,setCurrentPosBaseInfo:x,farmsPosRewardsData:y,posRewardsData:_}=Q(),w=(((J=v[l==null?void 0:l.posId])==null?void 0:J.displayFee)||"--")+"%",W=[{label:"Increase",value:"increase"},{label:"Remove",value:"remove"}],u=()=>{console.log("ðŸš€ ~ handleRefresh ~ handleRefresh:"),R(!0),A(!0),k(),N(),a(),F(),setTimeout(()=>{R(!1)},1e3)},A=(c=!1)=>{d!=null&&d.address&&t&&C(d==null?void 0:d.address,t,c)};j.useEffect(()=>{console.log("ðŸš€ ~ PositionDetail ~ position_nft_id:",t),A()},[d==null?void 0:d.address,t]),j.useEffect(()=>{console.log("ðŸš€ ~ PositionHistory ~ currentPosBaseInfo?.id:",l==null?void 0:l.id)},[l==null?void 0:l.id]);const{fetchTokenPrices:E}=be(),T=y[l==null?void 0:l.id],S=_[l==null?void 0:l.posId],N=()=>{var O,q;const c=(S==null?void 0:S.map(V=>V==null?void 0:V.coin_address))||[],K=(T==null?void 0:T.map(V=>V==null?void 0:V.rewarder_type))||[],X=[(O=l==null?void 0:l.tokenA)==null?void 0:O.coin_type,(q=l==null?void 0:l.tokenB)==null?void 0:q.coin_type].filter(Boolean),Z=Array.from(new Set([...c,...X,...K]));E(Z)};j.useEffect(()=>{N()},[l==null?void 0:l.posId,S==null?void 0:S.length,T==null?void 0:T.length]);const{getPoolList:D}=ai(),k=async()=>{if(!(l!=null&&l.clmmPool))return;const c=await D({pool:l==null?void 0:l.clmmPool});if(console.log("ðŸš€ ~ getPoolData ~ poolInfo:",l,c),c)return g(c==null?void 0:c.list[0])},{getContractPoolInfo:M}=Ne(),F=async()=>{if(console.log("ðŸš€ ~ handleGetPrice ~ currentPosBaseInfo?.clmmPool:",l==null?void 0:l.clmmPool),l!=null&&l.clmmPool){const c=await M(l==null?void 0:l.clmmPool);console.log("ðŸš€ ~ handleGetPrice ~ contractPoolInfo:",c),c&&(m(c.current_sqrt_price),h(c))}};j.useEffect(()=>{k(),F();let c;return l!=null&&l.clmmPool&&(c=setInterval(()=>{F()},2e4)),()=>{clearInterval(c)}},[l==null?void 0:l.clmmPool]),j.useEffect(()=>(s("increase"),d!=null&&d.address&&a(),()=>{h(null),x(null),g(null)}),[]),ti({onRpcChange:()=>{A(!0),F(),d!=null&&d.address&&a()}});const{isApp:G}=te();return e.jsxs(L,{gap:"12px",w:"100%",pt:"20px",align:"flex-start",children:[e.jsxs(n,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(n,{w:{base:"100%",lg:"unset"},justifyContent:"space-between",children:[e.jsx(We,{}),G&&e.jsxs(n,{children:[e.jsx(me,{}),e.jsx(re,{handleRefresh:u,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(n,{w:{base:"100%",lg:"unset"},children:[e.jsx(xe,{w:{base:"100%",lg:"unset"},bg:"bg_secondary",fontSize:"14px",p:"0 16px",h:"32px",borderRadius:"8px",fontWeight:"500",variant:"outline",onClick:c=>{i(`/liquidity?poolAddress=${l==null?void 0:l.clmmPool}`)},children:"Create a new position"}),!G&&e.jsx(re,{handleRefresh:u,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),e.jsxs(n,{w:"100%",justifyContent:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(H,{w:{base:"100%",lg:"unset"},isLoaded:!!(l!=null&&l.clmmPool),children:e.jsx(Ve,{symbolFontWeight:"600",haveName:!0,poolInfo:{feeDisplay:w,poolAddress:l==null?void 0:l.clmmPool,...l},symbolEllipsesDecimals:10,nameEllipsesDecimals:20,placement:"bottom-start"})}),e.jsxs(n,{w:{base:"100%",lg:"unset"},gap:{base:"12px",lg:"28px"},flexDirection:{base:"column",lg:"row"},children:[e.jsx(I,{label:"Pool APR",value:e.jsx(Fe,{poolInfo:p,children:e.jsxs(n,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsx(r,{as:"span",fontSize:"14px",color:"text_caption",fontWeight:"500",cursor:p!=null&&p.farmingAprDisplay||((Y=p==null?void 0:p.miningAprList)==null?void 0:Y.length)>0?"help":"text",children:p==null?void 0:p.feeAndMiningAprDisplay}),(p==null?void 0:p.haveFarming)&&e.jsxs(r,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",p==null?void 0:p.farmingAprDisplay]})]})}),loading:!(p!=null&&p.poolAddress)}),e.jsx(I,{label:"TVL",value:(p==null?void 0:p.tvlDisplay)||"",loading:!(p!=null&&p.poolAddress)}),e.jsx(I,{label:"Volume (24H)",value:(p==null?void 0:p.volume24Display)||"",loading:!(p!=null&&p.poolAddress)}),e.jsx(I,{label:"Fees (24H)",value:(p==null?void 0:p.fees24Display)||"",loading:!(p!=null&&p.poolAddress)})]})]}),e.jsxs(n,{w:"100%",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[e.jsxs(L,{w:{base:"100%",lg:"60%"},gap:"8px",children:[e.jsx(oi,{}),e.jsx(xi,{})]},`${l==null?void 0:l.posId}-posInfo`),e.jsxs(L,{w:{base:"100%",lg:"40%"},children:[e.jsx(f,{p:"0",borderRadius:"12px",children:e.jsxs(n,{w:"100%",p:"0 16px",children:[e.jsx(Ee,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",border:"none"},itemStyle:{w:{base:"50%",lg:"unset"},fontSize:"16px",mr:"28px"},tabList:W,currentTab:o=="increase"?"Increase":"Remove",handleChangeTab:c=>{s(c==null?void 0:c.value)}}),!G&&e.jsx(me,{})]})}),o=="increase"&&e.jsx(di,{}),o=="remove"&&e.jsx(Ie,{})]})]})]})}const me=()=>e.jsx(n,{children:e.jsx(ze,{})});export{ts as default};

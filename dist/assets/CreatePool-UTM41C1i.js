import{a as x,j as e,W as tt,X as rt,Y as ot,Z as it,a7 as Se,$ as nt,a0 as st,V,H as E,T as _,f as T,q as ee,ae as We,I as Rt,a6 as be,N as vt,a8 as yt,ak as ct,ay as Dt,x as De}from"./vendor-BowHGuwE.js";import{b as It,u as Ft,a as Pt}from"./SelectTokenAndFeeConfirm-DD7ruTlX.js";import{D as lt}from"./DepositRatio-DLGUvkQM.js";import{T as at}from"./TotalAmount-inLvFspw.js";import{P as Wt}from"./PositionStatus-CDhoSKyT.js";import{c as pt,b as Ie}from"./useGetPoolList-DGWy_Wlm.js";import{r as xt,d as xe,X as $,C as ze,B as Ne,ak as je,f as dt,I as Ce,n as ut,$ as H,a as ht,j as Ke,N as Nt,F as pe,an as Ye,a1 as Y,a9 as k,a5 as Fe,z as se,ao as zt,ap as Je,y as ce,w as $t,a3 as Be}from"./index-CHh_ib_A.js";import{T as Ot}from"./TradeConfirmAmountInfo-7uRFZTh0.js";import{u as Me}from"./useTokenBalance-ixOuC4qY.js";import{T as Lt}from"./TradeInputGroup-USnUgl_n.js";import{P as Qe}from"./PriceInput-BlDjRAzz.js";import{u as Et,a as Ht}from"./useCreatePoolHelper-CRHesOCj.js";import{E as qe}from"./ErrorTips-De8VCF23.js";import{I as Vt}from"./InputBox-DcOfvTu8.js";import{u as Ut}from"./useTransaction-CWfVBXqS.js";import{i as ke}from"./index-DLt-hnln.js";import{d as Gt}from"./FeeTierSelect-PfMFFf-J.js";import{u as gt}from"./useAccountBalance-kA9PTpYg.js";import{u as Xt}from"./index-DoMH3iiU.js";import{u as Zt}from"./usePreviousValue-ChnvxeJQ.js";import{u as Te}from"./useToken-D2aHLFAo.js";import{u as Kt}from"./global-jBtCojdm.js";import{R as Yt}from"./RefreshButton-DIrOjA_Q.js";import"./index-8WMkDPjK.js";import"./CheckBox-Cs6Rhs4Q.js";import"./Loading-9Flk9u0a.js";import"./SingleTokenInfo-D14D2WBC.js";import"./CopyButton-CiCnTzGA.js";import"./TooltipIcon-B6IRf7Ok.js";import"./HTextLabelBox-DQVZn89I.js";import"./useWrapPoolData-BeW6eicH.js";import"./_getAllKeysIn-DsQCss-S.js";import"./ActionButton-Dc4sN8pF.js";import"./usePosAdd-CJHsifQk.js";import"./msafe-oYBkW7LJ.js";import"./liquidity-pEOC9iIr.js";import"./useTrack-Cq3nAJr7.js";import"./useSigner-DJkRfTwJ.js";import"./useDocumentSize-BkQqV9EZ.js";import"./debounce-0tBm08Ev.js";import"./index-V0MTi46y.js";function Jt(u){const{isOpen:g,onClose:d,onSubmit:c,data:r}=u,{baseToken:t,quoteToken:o,feeDisplay:a,baseAmount:n,quoteAmount:i,isReverse:S,initPrice:s,minPrice:f,maxPrice:p,isFullRange:v}=r,[A,O]=x.useState(!0);console.log("ðŸš€ ~ file: CreateConfirmModal.tsx:49 ~ CreateConfirmModal ~ data:",r,A);const{getTokenAmountValue:z}=xt(),U=z(t==null?void 0:t.coin_type,n),G=z(o==null?void 0:o.coin_type,i),Z=x.useMemo(()=>xe(U||"0").plus(G||"0").toString(),[U,G]),R=x.useMemo(()=>pt(n,i,s,v),[n,i]),F=x.useMemo(()=>A?`${$(o==null?void 0:o.symbol)} per ${$(t==null?void 0:t.symbol)}`:`${$(t==null?void 0:t.symbol)} per ${$(o==null?void 0:o.symbol)}`,[A,t==null?void 0:t.symbol,o==null?void 0:o.symbol]),W=x.useMemo(()=>v?"0":S?A?f==null?void 0:f.displayReversePrice:p.displayPrice:A?f==null?void 0:f.displayPrice:p.displayReversePrice,[A]),K=x.useMemo(()=>v?"âˆž":S?A?p==null?void 0:p.displayReversePrice:f.displayPrice:A?p==null?void 0:p.displayPrice:f.displayReversePrice,[A]);return e.jsxs(tt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:g,onClose:d,isCentered:!0,children:[e.jsx(rt,{}),e.jsxs(ot,{children:[e.jsx(it,{children:e.jsx(Se,{fontWeight:"500",fontSize:"16px",children:"Preview"})}),e.jsx(nt,{}),e.jsx(st,{textAlign:"center",p:"0px",children:e.jsxs(V,{w:"100%",gap:"20px",p:"8px 16px",pb:"0px",children:[e.jsxs(E,{w:"100%",justifyContent:"space-between",h:"40px",children:[e.jsxs(E,{children:[e.jsx(ze,{coinACoinType:t==null?void 0:t.coin_type,coinBCoinType:o==null?void 0:o.coin_type,coinAIconUrl:t==null?void 0:t.logo_url,coinBIconUrl:o==null?void 0:o.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),e.jsx(_,{fontSize:"16px",color:"text_caption",children:`${$(t==null?void 0:t.symbol)} - ${$(o==null?void 0:o.symbol)}`})]}),e.jsx(Ne,{w:"unset",p:"8px 12px",borderRadius:"12px",ml:"4px",children:e.jsxs(E,{gap:"12px",children:[e.jsx(_,{children:"Fee Tier"}),e.jsx(_,{color:"primary",children:a})]})})]}),e.jsx(Ot,{coinA:{amount:n,...t},coinB:{amount:i,...o}}),e.jsxs(T,{w:"100%",children:[e.jsxs(E,{w:"100%",justify:"space-between",h:"32px",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Selected Range"}),e.jsx(Wt,{isActive:!0,isRow:!0,imgStyle:{imgW:"29px",imgH:"16px"},w:"105px",h:"32px"})]}),e.jsxs(E,{justify:"center",bg:"bg_secondary",borderRadius:"8px",h:"48px",w:"100%",gap:"4px",mt:"12px",children:[e.jsx(_,{children:"Current Price"}),e.jsx(_,{as:"span",color:"text_caption",children:je(A?s:dt(xe(1).div(s).toFixed(18),18,!0).toString(),18)}),e.jsx(_,{children:F}),e.jsx(ee,{variant:"unstyled",onClick:()=>O(!A),children:e.jsx(Ce,{xlinkHref:"#icon-icon_swap1"})})]}),e.jsxs(E,{w:"100%",h:"100px",bg:"bg_secondary",borderRadius:"12px",mt:"8px",children:[e.jsx(et,{title:"Min Price",price:W,perText:F}),e.jsx(We,{orientation:"vertical",h:"40px"}),e.jsx(et,{title:"Max Price",price:K,perText:F})]})]}),e.jsx(lt,{tokenA:t,tokenB:o,percentMap:R,type:"text"}),e.jsx(at,{totalAmount:Z}),e.jsx(ee,{w:"calc(100% + 32px)",bottom:"0px",mt:"4px",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:c,children:"Create and Add Liquidity"})]})})]})]})}const et=({title:u,price:g,perText:d})=>e.jsxs(V,{flex:"1",children:[e.jsx(_,{children:u}),e.jsx(_,{color:"text_caption",children:g}),e.jsx(_,{children:d})]});function Bt(u){const{isOpen:g,onClose:d,data:c}=u,{baseToken:r,quoteToken:t,feeDisplay:o}=c;return e.jsxs(tt,{autoFocus:!1,returnFocusOnClose:!1,isOpen:g,onClose:d,isCentered:!0,children:[e.jsx(rt,{}),e.jsxs(ot,{children:[e.jsx(it,{}),e.jsx(nt,{}),e.jsx(st,{children:e.jsx(V,{gap:"8px",pb:"8px",pt:"28px",w:"100%",children:e.jsxs(V,{gap:"8px",children:[e.jsx(Rt,{src:"/images/img_transactionsuccess@2x.png",w:"200px",h:"200px",alt:"icon"}),e.jsxs(V,{mt:"-155px",gap:"10px",children:[e.jsxs(E,{children:[e.jsx(ze,{coinACoinType:r==null?void 0:r.coin_type,coinBCoinType:t==null?void 0:t.coin_type,coinAIconUrl:r==null?void 0:r.logo_url,coinBIconUrl:t==null?void 0:t.logo_url,imageStyle:{w:"24px",h:"24px"},imgBoxStyle:{w:"24px",h:"24px"}}),e.jsx(_,{fontSize:"14px",color:"text_caption",children:`${r==null?void 0:r.symbol} - ${t==null?void 0:t.symbol}`})]}),e.jsx(Ne,{w:"unset",p:"4px 6px",borderRadius:"12px",children:e.jsxs(_,{fontSize:"12px",color:"primary",children:["Fee Tier ",o]})})]}),e.jsx(Ne,{mt:"80px",borderRadius:"16px",padding:"16px",children:e.jsx(_,{color:"primary_gray",fontSize:"12px",lineHeight:"20px",children:"The pool has been created. It will usually take up to 3 min for a new pool to be presented in front end interface. Thanks for creating this pool"})}),e.jsx(ee,{mt:"16px",fontSize:"14px",w:"100%",onClick:()=>{d()},children:"OK"})]})})})]})]})}function Mt(u,g,d,c,r,t){const{currentAccount:o}=ut(),a=x.useMemo(()=>{const n={text:"Create",disabled:!1};return o!=null&&o.address?!u||!g||u&&!+u||g&&!+g?(n.text="Enter an amount",n.disabled=!0,n):u&&+u&&xe(u).gt((r==null?void 0:r.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${$(d==null?void 0:d.symbol)} Balance`,n):g&&+g&&xe(g).gt((t==null?void 0:t.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${$(c==null?void 0:c.symbol)} Balance`,n):((!u||!g)&&(n.disabled=!0),n):(n.text="Connect Wallet",n.disabled=!1,n)},[o==null?void 0:o.address,u,g,r==null?void 0:r.balanceDisplay,t==null?void 0:t.balanceDisplay,d==null?void 0:d.coin_type,c==null?void 0:c.coin_type]);return{btnText:a.text,btnDisabled:a.disabled}}function Qt({currentStep:u,editStep:g,onCreate:d,baseToken:c,quoteToken:r,baseAmount:t,quoteAmount:o,onBaseAmountChange:a,onQuoteAmountChange:n,isReverse:i,percentMap:S}){const{balanceInfo:s}=Me(c),{balanceInfo:f}=Me(r),{btnText:p,btnDisabled:v}=Mt(t,o,c,r,s,f),{fetchTokenPrices:A,getTokenAmountValue:O}=xt(),z=()=>{const R=[];c!=null&&c.coin_type&&R.push(c==null?void 0:c.coin_type),r!=null&&r.coin_type&&R.push(r==null?void 0:r.coin_type),R.length>0&&A(R)};x.useEffect(()=>{z()},[c==null?void 0:c.coin_type,r==null?void 0:r.coin_type]);const U=O(c==null?void 0:c.coin_type,t),G=O(r==null?void 0:r.coin_type,o),Z=x.useMemo(()=>{if(+U&&+G)return H(U||"0").plus(G||"0").toString()},[U,G]);return e.jsx(e.Fragment,{children:u===3&&g===3?e.jsxs(V,{w:"100%",gap:"12px",bg:"bg_fifth",borderRadius:"12px",p:{base:"16px 8px",lg:"32px"},align:"flex-start",children:[e.jsx(Se,{fontSize:"16px",fontWeight:"500",children:"Deposit amounts"}),e.jsx(Lt,{wrapStyle:{mt:"4px"},from:{wrapStyle:{h:"108px"},balance:(s==null?void 0:s.balanceFormat)||"",value:t,amountValue:U,loading:!1,onChange:R=>{a(R)},selectable:!1,placeholder:"0.0",token:c},to:{wrapStyle:{h:"108px"},balance:(f==null?void 0:f.balanceFormat)||"",value:o,amountValue:G,loading:!1,onChange:R=>{n(R)},selectable:!1,placeholder:"0.0",token:r}}),e.jsxs(V,{gap:"16px",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"16px",p:{base:"16px 8px",lg:"16px"},children:[e.jsx(at,{totalAmount:Z}),e.jsx(lt,{tokenA:c,tokenB:r,percentMap:S,isReverse:i,type:"image"})]}),e.jsx(ee,{w:"100%",onClick:d,h:"48px",fontSize:"16px",borderRadius:"12px",disabled:v,children:p})]}):null})}function ft({onEdit:u,children:g}){return e.jsxs(E,{w:"100%",p:{base:"16px 8px",lg:"20px 32px"},border:"0px solid",borderColor:"border",borderRadius:"12px",bg:"bg_fifth",justify:"space-between",children:[g,e.jsxs(ee,{onClick:u,variant:"unstyled",border:"1px solid",borderColor:"border",cursor:"pointer",borderRadius:"8px",p:"5px 8px",display:"flex",h:"32px",alignItems:"center",gap:"8px",minW:"auto",_hover:{p:{color:"#fff"},svg:{fill:"#fff"}},children:[e.jsx(Ce,{xlinkHref:"#icon-icon_edit"}),e.jsx(_,{fontSize:"12px",fontWeight:"500",children:"Edit"})]})]})}function qt({onEdit:u,editStep:g,currentStep:d,onContinue:c,baseToken:r,quoteToken:t,onBaseTokenChange:o,onQuoteTokenChange:a,feeTier:n,feeTierList:i,onFeeTierChange:S,quoteWhiteTokenList:s}){return e.jsx(e.Fragment,{children:g===1||d===1?e.jsx(It,{title:"Select pair",description:"Select the token you want to create a liquidity pool for.",onContinue:c,baseToken:r,onBaseTokenChange:o,quoteToken:t,onQuoteTokenChange:a,quoteWhiteTokenList:s,feeTier:n,feeTierList:i,onFeeTierChange:S,wrapStyle:{p:{base:"16px 8px",lg:"32px"}},fromSource:"createPool"}):e.jsx(ft,{onEdit:u,children:e.jsxs(E,{gap:"12px",children:[e.jsx(ze,{coinAIconUrl:r==null?void 0:r.logo_url,coinBIconUrl:t==null?void 0:t.logo_url,coinACoinType:r==null?void 0:r.coin_type,coinBCoinType:t==null?void 0:t.coin_type,w:"36px",h:"36px"}),e.jsxs(E,{children:[e.jsx(_,{color:"text_caption",fontWeight:"500",children:`${$(r==null?void 0:r.symbol)}-${$(t==null?void 0:t.symbol)}`}),e.jsx(T,{h:"16px",p:"1px 8px",borderRadius:"16px",border:"1px solid",borderColor:"border",bg:"bg_secondary",children:e.jsx(_,{fontSize:"12px",fontWeight:"500",color:"text_highlight",children:typeof n=="string"?`${xe(n).div(100).toString()}%`:n==null?void 0:n.feeDisplay})})]})]})})})}const kt=[{label:"Full Range"},{label:"Custom Range"}];function Tt({editStep:u,currTick:g,currentStep:d,onEdit:c,onContinue:r,displayBaseToken:t,displayQuoteToken:o,initPrice:a,onInitPriceChange:n,displayMinPrice:i,onMinPriceChange:S,displayMaxPrice:s,onMaxPriceChange:f,isFullRange:p,isReverse:v,handleRangeModeChange:A,handleSwitchDirectionChange:O,handlePriceAction:z}){const[U,G]=x.useState("Full Range"),{isApp:Z}=ht(),R=x.useMemo(()=>i?[i.tokenA,i.tokenB].filter(Boolean).map(h=>({label:h==null?void 0:h.symbol,isToken:!0,imgInfo:{src:h==null?void 0:h.logo_url,w:"16px",h:"16px",borderRadius:"50%",fallbackSrc:"/images/placeholder-token@2x.png"}})):[],[i==null?void 0:i.tokenA,i==null?void 0:i.tokenB]),F=x.useMemo(()=>`${$(o==null?void 0:o.symbol)} per ${$(t==null?void 0:t.symbol)}`,[t==null?void 0:t.symbol,o==null?void 0:o.symbol]),W=x.useMemo(()=>{var h;return p?!0:((h=i==null?void 0:i.tokenA)==null?void 0:h.coin_type)===(t==null?void 0:t.coin_type)},[p,i==null?void 0:i.tokenA,i==null?void 0:i.tokenB,t==null?void 0:t.coin_type]),{showInputPriceWarn:K,showPriceRangeWarn:M}=Et(p,g,v?s.tick:i.tick,v?i.tick:s.tick),te=x.useMemo(()=>(i==null?void 0:i.price)==="0"&&(s==null?void 0:s.price)==="âˆž",[i==null?void 0:i.price,s==null?void 0:s.price]),C=x.useMemo(()=>!+a&&!p,[a,p]);return e.jsx(e.Fragment,{children:d>=2?u===2||d===2?e.jsxs(V,{w:"100%",gap:"32px",bg:"bg_fifth",borderRadius:"12px",p:{base:"16px 8px",lg:"32px"},children:[e.jsxs(V,{gap:"8px",w:"100%",align:"flex-start",children:[e.jsx(Se,{fontSize:"16px",fontWeight:"500",children:"Set initial Price"}),e.jsxs(be,{flexDir:{base:"column",lg:"row"},w:"100%",justify:"space-between",mt:"-2px",alignItems:"center",children:[e.jsx(_,{fontSize:"12px",children:"Please set an initial price for this new pool to start."}),e.jsx(Ke,{type:"outlineTab",tabList:R,currentTab:t==null?void 0:t.symbol,handleChangeTab:h=>{h.label!==(t==null?void 0:t.symbol)&&O()},wrapStyle:{w:{base:"100%",lg:"auto"},h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px"},itemStyle:{flex:1,h:"24px",p:"4px 12px",borderRadius:"4px",gap:"4px"}})]}),e.jsx(Vt,{mt:"4px",h:"48px",borderRadius:"12px",p:"16px",children:e.jsxs(vt,{fontFamily:"Inter",justifyContent:"space-between",gap:"12px",children:[e.jsx(Nt,{value:a?je(a,18):"",onChange:h=>{n==null||n(h)},placeholder:"0.0",inputAllowed:!0,decimals:18,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"16px",fontWeight:"500",height:"14px",lineHeight:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(yt,{children:e.jsx(_,{children:F})})]})}),a&&e.jsxs(E,{h:"20px",w:"100%",children:[e.jsxs(_,{color:"text_caption",fontSize:"12px",children:["Current Price: 1 ",$(t==null?void 0:t.symbol)," = ",pe(je(a,18))," ",$(o==null?void 0:o.symbol)]}),e.jsx(Ce,{w:"16px",h:"16px",svgW:"16px",svgH:"16px",xlinkHref:"#icon-icon_swap1",fontSize:"12px",onClick:O})]})]}),e.jsxs(V,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(Se,{fontSize:"16px",fontWeight:"500",children:"Set Price Range"}),e.jsx(_,{fontSize:"12px",children:"Please specify a price range that you want to provide your liquidity within."}),e.jsx(Ke,{type:"outlineTab",tabList:kt,currentTab:p?"Full Range":"Custom Range",handleChangeTab:h=>{G(h==null?void 0:h.label),A((h==null?void 0:h.label)==="Full Range")},wrapStyle:{w:"100%",h:"40px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"12px",gap:"4px"},itemStyle:{flex:"1",h:"32px",p:"8px",borderRadius:"8px",fontSize:"14px"}}),e.jsxs(be,{mt:"4px",position:"relative",flexDir:{base:"column",lg:"row"},w:"100%",gap:{base:"8px",lg:"16px"},children:[e.jsx(T,{opacity:C?0:1,w:{base:"100%",lg:"50%"},children:e.jsx(Qe,{title:"Min Price",perText:F,data:i,direct:W,loading:!1,handleAddPrice:h=>z("Add",h),handleSubPrice:h=>z("Sub",h),setTickDataBasedOnPrice:S,isFullRange:te})}),e.jsx(T,{opacity:C?0:1,w:{base:"100%",lg:"50%"},children:e.jsx(Qe,{title:"Max Price",perText:F,data:s,direct:W,loading:!1,handleAddPrice:h=>z("Add",h),handleSubPrice:h=>z("Sub",h),setTickDataBasedOnPrice:f,isFullRange:te})}),!+a&&!p&&e.jsx(Ye,{position:"absolute",top:"0px",left:"0",w:"100%",h:"80px",borderRadius:"12px",text:""}),Z&&!+a&&!p&&e.jsx(Ye,{position:"absolute",top:"88px",left:"0",w:"100%",h:"80px",borderRadius:"12px",text:""})]}),!p&&K&&!M&&e.jsx(qe,{p:"8px 16px",w:"100%",isShowIcon:!1,type:"warning",borderRadius:"8px",tipsFontSize:"12px",tipsLineHeight:"16px",tips:"To create a new pool, the initial price you set must be within your price range."}),!p&&M&&e.jsx(qe,{isShowIcon:!1,tipsFontSize:"12px",justifyContent:"center",tips:"The max price should be higher than min price.",p:"0 16px",h:"28px",borderRadius:"8px"}),e.jsx(ee,{mt:"4px",w:"100%",onClick:r,disabled:!a||!+a||!i.price||!s.price||K||M,h:"48px",fontSize:"16px",borderRadius:"12px",children:!a||!+a?"Enter initial price":"Continue"})]})]}):e.jsx(ft,{onEdit:c,children:e.jsxs(V,{gap:"12px",align:"flex-start",children:[e.jsxs(E,{children:[e.jsx(_,{whiteSpace:"nowrap",children:"Initial Price"}),e.jsx(_,{color:"text_caption",fontWeight:"500",children:`${je(a,18)} ${F}`})]}),e.jsxs(E,{children:[e.jsx(_,{whiteSpace:"nowrap",children:"Price Range"}),e.jsxs(_,{color:"text_caption",fontWeight:"500",children:[p?"0 - âˆž":`${v?i.displayReversePrice:i==null?void 0:i.displayPrice} - ${v?s==null?void 0:s.displayReversePrice:s==null?void 0:s.displayPrice} `," ",`${F}`," "]})]})]})}):null})}function er({currentStep:u,handleStepClick:g}){const{isApp:d}=ht();return e.jsxs(be,{flexDir:{base:"row",lg:"column"},gap:"12px",flex:{base:"1",lg:"0 0 258px"},w:{base:"100%",lg:"258px"},p:{base:"12px",lg:"32px"},justify:"center",align:{base:"center",lg:"flex-start"},bg:"bg_fifth",borderRadius:"12px",children:[e.jsx(Pe,{step:1,title:"Select token & fee tier",isActive:u>=1,handleStepClick:g}),e.jsx(T,{w:"32px",h:{base:"1px",lg:"32px"},children:e.jsx(We,{orientation:d?"horizontal":"vertical",ml:{base:"0",lg:"16px"}})}),e.jsx(Pe,{step:2,title:"Set initial price & range",isActive:u>=2,handleStepClick:g}),e.jsx(T,{w:"32px",h:{base:"1px",lg:"32px"},children:e.jsx(We,{orientation:d?"horizontal":"vertical",ml:{base:"0",lg:"16px"}})}),e.jsx(Pe,{step:3,title:"Enter deposit amounts",isActive:u>=3})]})}function Pe({step:u,title:g,isActive:d,handleStepClick:c}){return e.jsxs(E,{w:{base:"32px",lg:"100%"},cursor:c&&d?"pointer":"unset",onClick:()=>{c&&d&&c(u)},children:[e.jsx(T,{as:"div",flex:"0 0 32px",h:"32px",lineHeight:"32px",textAlign:"center",border:"1px solid",fontSize:"12px",fontWeight:"500",color:d?"text_highlight":"text_paragraph",borderColor:"border",borderRadius:"8px",bg:d?"primary_disabled":"transparent",children:u}),e.jsxs(V,{align:"flex-start",display:{base:"none",lg:"flex"},children:[e.jsxs(_,{fontSize:"14px",color:d?"text_caption":"text_paragraph",fontWeight:"500",children:["Step Â ",u]}),e.jsx(_,{fontSize:"12px",color:d?"primary":"text_paragraph",fontWeight:"500",children:g})]})]})}function tr(){const u=(r,t,o,a,n)=>{const i=o.decimals,S=a.decimals;let s;Math.abs(r)==Math.abs(Y.getMinIndex(n))?s=t==="lower"?"0":"âˆž":s=k.tickIndexToPrice(r,i,S).toString();const f=s==="âˆž"?"âˆž":se(s,6).toString(),p=Ie(s),v=p==="âˆž"?"âˆž":se(p,6).toString();return{id:t,tokenA:o,tokenB:a,tick:r,price:s,displayPrice:f,reversePrice:p,displayReversePrice:v,tickSpacing:n.toString(),pool:"1"}},g=(r,t)=>{const o=r.tokenA,a=r.tokenB;if(!o||!a||t.length===0)return;let n,i="";if(t==="âˆž")n=Y.getMaxIndex(Number(r.tickSpacing)),i="âˆž";else if(H(t).equals(0))n=Y.getMinIndex(Number(r.tickSpacing)),i="0";else if(H(t).gt(0)){const p=k.priceToTickIndex(H(t),o.decimals,a.decimals);n=Fe(Number(p),Number(r.tickSpacing)),i=k.tickIndexToPrice(Number(n),o.decimals,a.decimals).toString()}const S=i==="âˆž"?"âˆž":se(i,6),s=Ie(i),f=s==="âˆž"?"âˆž":se(s,6);if(n!==void 0)return{...r,tick:n,price:i,displayPrice:S.toString(),reversePrice:s,displayReversePrice:f.toString()}},d=(r,t="Add")=>{const{tokenA:o,tokenB:a,tick:n,tickSpacing:i}=r;if(o&&a&&i){const S=t==="Add"?H(n).add(i).toNumber():H(n).sub(i).toNumber();if(H(S).gt(Y.getMaxIndex(Number(r.tickSpacing)))||H(S).lt(Y.getMinIndex(Number(r.tickSpacing))))return;const s=k.tickIndexToPrice(S,o.decimals,a.decimals).toString(),f=s==="âˆž"?"âˆž":se(s,6);if(f===r.displayPrice){const p=Number(r.tickSpacing)<20?40:1;return d({...r,tick:t==="Add"?H(n).add(Number(i)*p).toNumber():H(n).sub(Number(i)*p).toNumber()},t)}else{const p=Ie(s),v=p==="âˆž"?"âˆž":se(p,6);return{id:r.id,tick:S,price:s.toString(),displayPrice:f.toString(),reversePrice:p.toString(),displayReversePrice:v.toString(),tokenA:o,tokenB:a,tickSpacing:i,pool:"1"}}}};return{calcInitPriceRange:(r,t,o,a,n,i,S)=>{console.log("ðŸš€ ~ file: useCreatePriceRange.ts:84 ~ useCreatePriceRange ~ calcInitPriceRange:",{tickSpacing:o,baseToken:a,quoteToken:n});try{if(o&&a&&n){const s=Y.getMaxIndex(o),f=Y.getMinIndex(o);if(r){const p={id:"lower",tokenA:a,tokenB:n,tick:f,price:"0",displayPrice:"0",reversePrice:"âˆž",displayReversePrice:"âˆž",tickSpacing:o.toString(),pool:new Date().getTime().toString()},v={id:"upper",tokenA:a,tokenB:n,tick:s,price:"âˆž",displayPrice:"âˆž",reversePrice:"0",displayReversePrice:"0",tickSpacing:o.toString(),pool:new Date().getTime().toString()};if(t&&+t){const A=k.priceToTickIndex(H(t),a.decimals,n.decimals);return{minData:p,maxData:v,currTick:A}}return{minData:p,maxData:v,currTick:void 0}}else if(t&&+t){const p=k.priceToTickIndex(H(t),a.decimals,n.decimals),v=i||Fe(Number(p-o*5),Number(o));v<f&&(i=f);const A=S||Fe(Number(p+o*5),Number(o));A>s&&(S=s);const O=u(v,"lower",a,n,o),z=u(A,"upper",a,n,o);return{minData:O,maxData:z,currTick:p}}}}catch(s){console.log("ðŸš€ ~ file: useCreatePriceRange.ts:228 ~ useCreatePriceRange ~ error:",s)}},handleActionPrice:d,updateTickDataBasedOnPrice:g}}function rr(){ct();const{base:u,quote:g,fee:d}=Dt(),{tokenInfo:c}=Te(u),{tokenInfo:r}=Te(g),[t,o]=x.useState(void 0),[a,n]=x.useState([]),[i,S]=x.useState(1),[s,f]=x.useState(0),{signAndExecuteTransaction:p,transactionConfirmation:v,transactionRejected:A}=Ut(),{fetchAccountBalance:O}=gt(),{preAddPool:z,fetchFeeTierList:U,getCreatePoolTxPayload:G}=Ht(),{quoteWhiteTokenList:Z}=Ft(),[R,F]=x.useState(),[W,K]=x.useState(),[M,te]=x.useState(!0);x.useEffect(()=>{O()},[]);const[C,h]=x.useState(),[w,J]=x.useState(),[N,re]=x.useState(""),[L,de]=x.useState(!0),[y,oe]=x.useState({}),[P,ie]=x.useState({}),[ue,he]=x.useState(),[we,ge]=x.useState(void 0),I=x.useMemo(()=>C&&w?zt(Je(C.coin_type),Je(w.coin_type)):!1,[C,w]),[_e,fe]=x.useState(void 0),{calcInitPriceRange:Ae,handleActionPrice:Re,updateTickDataBasedOnPrice:ve}=tr(),[D,B]=x.useState(""),[le,me]=x.useState("");x.useEffect(()=>{r&&!ke(r,Z)?ke(c,Z)?(F(r),h(r),J(c||ce.sui_coin),K(c||ce.sui_coin)):(F(void 0),h(void 0),J(ce.sui_coin),K(ce.sui_coin)):(F(c),h(c),J(r||ce.sui_coin),K(r||ce.sui_coin))},[c==null?void 0:c.coin_type,r==null?void 0:r.coin_type,Z]),x.useEffect(()=>{$e()},[R==null?void 0:R.coin_type,W==null?void 0:W.coin_type]);const $e=()=>{var l;R&&W?U(R.coin_type,W.coin_type).then(j=>{n(j);const m=j.filter(X=>X.poolAddress===void 0),b=m.find(X=>X.feeRate===d)||m.find(X=>X.feeRate==="25")||(m.length>0?m[0]:void 0)||(j.length>0?j[0]:void 0);b&&Oe(b)}):(n((l=Gt)==null?void 0:l.map(j=>({...j,title:""}))),o(void 0))},mt=(l,j=!0)=>{ye(1),j?(F(l),h(l),J(W),(l==null?void 0:l.coin_type)===(W==null?void 0:W.coin_type)&&(K(void 0),J(void 0))):(K(l),J(l),h(R),(l==null?void 0:l.coin_type)===(R==null?void 0:R.coin_type)&&(F(void 0),h(void 0)))},Oe=l=>{o(l),S(1),At(),Q(!0)},jt=()=>{const l=C;if(h(w),J(l),+N){const m=dt(H(1).div(N).toFixed(18),18,!0).toString();re(m)}};x.useEffect(()=>{Le(L)},[N,t==null?void 0:t.tickSpacing]);const Le=(l,j,m)=>{ne();const b=Ae(l,N&&+N?I?(1/Number(N)).toString():N:"",Number((t==null?void 0:t.tickSpacing)||0),I?w:C,I?C:w,j,m);console.log("ðŸš€ ~ handleInitPriceRange ~ data:",b),b?(ie(b.maxData),oe(b.minData),he(b.currTick)):he(void 0)};x.useMemo(()=>{if(t&&C&&w)return k.tickIndexToPrice(Y.getMaxIndex(20),6,6).toFixed(9,$t.ROUND_DOWN)},[t==null?void 0:t.tickSpacing,C==null?void 0:C.decimals,w==null?void 0:w.decimals]);const St=l=>{re(l)},Q=(l,j,m)=>{de(l),ne(),Le(l,j,m)},Ee=x.useMemo(()=>L?y:I?P:y,[L,y,P,I]),He=x.useMemo(()=>L?P:I?y:P,[L,y,P,I]),bt=(l,j)=>{ne();const m=Re(j,l);m&&((m==null?void 0:m.id)===(y==null?void 0:y.id)?oe(m):ie(m))},Ct=Zt(L),wt=(l,j,m)=>{const b=ve(l,j);if(b){b.pool=new Date().getTime().toString();let X=y==null?void 0:y.tick,q=P==null?void 0:P.tick;b.id==="lower"?(oe({...b}),X=b.tick):(ie({...b}),q=b.tick),X!==void 0&&q!==void 0&&t?Ct&&(Y.getMaxIndex(Number(t.tickSpacing))!==q||Y.getMinIndex(Number(t.tickSpacing))!==X?Q(!1):Q(!0)):Q(!1,X,q)}else Q(!1)},_t=(l,j)=>{te(j),j?B(l):me(l);const m=Ve(l,j);m?(fe(m),j?me(I?m.coinAmountA:m.coinAmountB):B(I?m.coinAmountB:m.coinAmountA)):(j?me(""):B(""),fe(void 0))},ye=l=>{console.log("ðŸš€ ~ file: useCreatePool.ts:288 ~ handleStepClick ~ step:",l,i,s),l===1?(S(1),f(1),re(""),Q(!0),ne()):l===2?(S(2),f(2),ne()):(S(3),f(3))},Ve=(l,j,m)=>{if(w&&C&&N&&t&&l&&+l&&(y!=null&&y.price)&&(P!=null&&P.price))try{const b=z({realTokenA:I?w:C,realTokenB:I?C:w,needReverse:y.tokenA.coin_type!==C.coin_type,tickSpacing:Number(t.tickSpacing),amount:l,amountCoinType:j?C.coin_type:w.coin_type,maxPrice:L?P.price:I?y.reversePrice:P.price,minPrice:L?y.price:I?P.reversePrice:y.price,price:I?H(1).div(N).toString():N});return console.log("ðŸš€ ~ file: useCreatePool.ts:212 ~ handleAmountChange ~ res:",b),b}catch(b){console.log("ðŸš€ ~ file: useCreatePool.ts:240 ~ preCalcAddPool ~ error:",b)}};Xt(()=>{const l=Ve("1",!0);if(l){const j=pt(l==null?void 0:l.coinAmountA,l==null?void 0:l.coinAmountB,I?(1/Number(N)).toString():N,L);console.log("ðŸš€ ~ file: useCreatePool.ts:273 ~ useCreatePool ~ perMap:",j),ge(j)}else ge(void 0)},[N,y.tick,P.tick,L,I,t==null?void 0:t.tickSpacing],{wait:500});const At=()=>{re(""),ne(),de(!0)},ne=()=>{B(""),me("")};return{baseToken:R,quoteToken:W,handleSelectTokenChange:mt,displayQuoteWhiteTokenList:Z,feeTier:t,setFeeTier:o,feeTierList:a,currentStep:i,editStep:s,setCurrentStep:S,setEditStep:f,displayBaseToken:C,displayQuoteToken:w,handleSwitchDirectionChange:jt,initPrice:N,handleInitPriceChange:St,isFullRange:L,handleRangeModeChange:Q,minTickData:y,maxTickData:P,isReverse:I,handleFeeTierChange:Oe,handlePriceAction:bt,baseAmount:D,quoteAmount:le,handleAmountChange:_t,getConfirmData:()=>({isReverse:I,baseToken:C,quoteToken:w,baseAmount:D,quoteAmount:le,minPrice:Ee,maxPrice:He,initPrice:N,feeDisplay:t.feeDisplay,isFullRange:L}),handleCreateAction:async()=>{const l=y.tokenA;y.tokenB,l.coin_type,M?C.coin_type:w.coin_type;const j={getShowInfo:(m,b)=>{const X=$(C==null?void 0:C.symbol),q=$(w==null?void 0:w.symbol),Ue=`Add ${pe(D)} ${X} and ${pe(le)} ${q}`,ae={modalDescriptionText:Ue,toastTitleText:Ue};if(m==="success"){let Ge=D,Xe=le;b&&(Ge=Be(b,C)||D,Xe=Be(b,w)||le);const Ze=`Add ${pe(Ge)} ${X} and ${pe(Xe)} ${q}`;ae.toastDescriptionContent=Ze,ae.modalDescriptionText=Ze,ae.toastTitleText="Create Success"}return m==="rejected"&&(ae.toastTitleText="Create pool"),ae}};v(j);try{const m=await G(_e),b=await p(m,j,{showSuccessModal:!1,useDevInspect:!0});if(console.log("ðŸš€ ~ handleCreateAction ~ res:",b),b)return O(),$e(),ye(1),t.feeDisplay}catch(m){console.log("ðŸš€ ~ file: useCreatePool.ts:341 ~ handleCreateAction ~ error:",m),A(j)}},percentMap:we,currTick:ue,displayMinPrice:Ee,displayMaxPrice:He,handleTickPriceChange:wt,handleStepClick:ye,fetchFeeTierList:U}}function Yr(){const u=ct(),{baseToken:g,quoteToken:d,feeTier:c,currentStep:r,editStep:t,feeTierList:o,handleSelectTokenChange:a,displayQuoteWhiteTokenList:n,displayBaseToken:i,displayQuoteToken:S,handleSwitchDirectionChange:s,initPrice:f,handleInitPriceChange:p,isFullRange:v,handleRangeModeChange:A,handleTickPriceChange:O,isReverse:z,handleFeeTierChange:U,handlePriceAction:G,baseAmount:Z,quoteAmount:R,handleAmountChange:F,getConfirmData:W,handleCreateAction:K,percentMap:M,currTick:te,displayMinPrice:C,displayMaxPrice:h,handleStepClick:w,fetchFeeTierList:J}=rr(),{currentAccount:N,onWalletModal:re}=ut(),{isOpen:L,onOpen:de,onClose:y}=De(),{isOpen:oe,onOpen:P,onClose:ie}=De(),{isOpen:ue,onOpen:he,onClose:we}=De(),{fetchAccountBalance:ge}=gt(),[I,_e]=x.useState(),{setBackUrl:fe}=Kt(),Ae=()=>{g&&d&&c&&(fe("/create-pool"),u(`/liquidity?tab=deposit&poolAddress=${c==null?void 0:c.poolAddress}`,{replace:!0}))},Re=()=>({baseToken:i,quoteToken:S,feeDisplay:I}),ve=()=>{g&&d&&J(g.coin_type,d.coin_type),ge()};return e.jsxs(V,{w:"814px",align:"flex-start",gap:"20px",mt:"20px",children:[e.jsxs(E,{w:"100%",justifyContent:"space-between",children:[e.jsxs(ee,{variant:"outline",h:"32px",onClick:()=>u("/pools"),p:"0 12px",borderRadius:"8px",bg:"background",children:[e.jsx(Ce,{xlinkHref:"#icon-icon_descending",transform:"rotate(90deg)"}),e.jsx(_,{fontSize:"12px",children:"Back"})]}),e.jsx(Yt,{handleRefresh:ve,w:"32px",h:"32px",borderRadius:"8px",bg:"background",innerStyle:{bg:"background"}})]}),e.jsxs(be,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",align:"flex-start",children:[e.jsx(er,{currentStep:r,handleStepClick:w}),e.jsxs(V,{w:"100%",gap:"16px",children:[e.jsx(qt,{editStep:t,currentStep:r,onEdit:()=>{w(1)},onContinue:()=>{c&&(c.poolAddress?de():w(2))},baseToken:g,onBaseTokenChange:D=>a(D,!0),quoteToken:d,onQuoteTokenChange:D=>a(D,!1),feeTier:c,feeTierList:o,quoteWhiteTokenList:n,onFeeTierChange:D=>U(D),fromSource:"createPool"}),e.jsx(Tt,{editStep:t,currentStep:r,onEdit:()=>w(2),onContinue:()=>{w(3)},displayBaseToken:i,displayQuoteToken:S,initPrice:f,currTick:te,isReverse:z,onInitPriceChange:D=>p(D),handlePriceAction:G,displayMinPrice:C,onMinPriceChange:(D,B)=>{O(D,B,!0)},displayMaxPrice:h,onMaxPriceChange:(D,B)=>{O(D,B,!1)},handleSwitchDirectionChange:s,isFullRange:v,handleRangeModeChange:A}),e.jsx(Qt,{currentStep:r,editStep:t,onCreate:()=>{N?P():re(!0)},percentMap:M,baseToken:i,quoteToken:S,baseAmount:Z,quoteAmount:R,onBaseAmountChange:D=>F(D,!0),onQuoteAmountChange:D=>F(D,!1),isReverse:z})]})]}),L&&e.jsx(Pt,{title:"This Pool already exists",subTitle:"Do you want to provide liquidity?",btnText:"Add liquidity",isOpen:L,onClose:y,onConfirm:Ae}),oe&&e.jsx(Jt,{isOpen:oe,onClose:ie,onSubmit:async()=>{ie();const D=await K();D&&(_e(D),he())},data:W()}),ue&&I&&e.jsx(Bt,{isOpen:ue,onClose:we,data:Re()})]})}export{Yr as default};
//# sourceMappingURL=CreatePool-UTM41C1i.js.map

import{e as y,k as v,ao as k,m as O,d as g,J as b,ai as N,l as p,q as R,ap as x}from"./index-nq5C95Tz.js";import{u as h}from"./useToken-Bsr24yyi.js";import{a as l}from"./vendor-DYqnJE5Q.js";function X(){const{xCetusSdk:e}=y(),{currentAccount:t}=v(),{setLockCetusListLoading:r,clearData:a,setLockCetusList:o}=k();return{fetchOwnerLockCetusList:async(n=t==null?void 0:t.address)=>{if(!n){r(!1),a();return}r(!0);try{const c=await e.XCetusModule.getOwnerRedeemLockList(n);console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList:",c,n),n===(t==null?void 0:t.address)&&(c.sort((s,w)=>s.locked_until_time-w.locked_until_time),o(c))}catch(c){console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ error:",c)}finally{r(!1)}}}}function A(){const{xCetusSdk:e}=y(),{setDividendRewardList:t}=k();return{fetchVeNFTDividendInfo:async a=>{try{const o=await e.XCetusModule.getVeNFTDividendInfo(a);console.log("ðŸš€ ~ file: useXCetusHelper.ts:62 ~ fetchVeNFTDividendInfo ~ dividendInfo:",o),o&&t(o.rewards)}catch(o){console.log("ðŸš€ ~ fetchVeNFTDividendInfo ~ error:",o,a)}}}}function M(){const{xCetusSdk:e}=y(),{currentAccount:t}=v(),{setVeNFTLoading:r,clearData:a,setVeNFT:o}=k();return{fetchOwnerVeNFT:async(n=t==null?void 0:t.address,c)=>{if(!n){r(!1),a();return}r(!0);try{const s=await e.XCetusModule.getOwnerVeNFT(n,c);if(console.log("ðŸš€ ~ fetchOwnerVeNFT ~ veNFT:",s),s)return o(s,n),s}catch(s){console.log("ðŸš€ ~ fetchOwnerVeNFT ~ error:",s)}finally{r(!1)}}}}function E(){const{dividendManager:e}=k(),[t,r]=l.useState(),[a,o]=l.useState(),d=n=>{const c=Date.now()/1e3,{start_time:s,interval_day:w}=n,S=Number(x.getNextStartTime(n).toString()),f=R.env=="testnet"?Math.ceil((c-s)/(w*60)):Math.ceil((c-s)/(w*24*3600));r(f),o(S)};return l.useEffect(()=>{e&&d(e)},[e]),{currentPeriod:t,nextStartTime:a,calculateCurrPeriod:d}}function j(e,t){const{fetchTokenInfo:r}=h(),{getTokenAmountValue:a}=O(),{coinPriceObj:o}=p(),[d,n]=l.useState("0"),c=l.useCallback(async()=>{if(!(!e||!t))try{const s=e.bonus,w=await Promise.all(s.map(async T=>{const i=b(T.name,!1),u=await r(i);if(u){const L=N(T.value,u.decimals).toString();return a(i,L)}return"0"})).then(T=>T.reduce((i,u)=>i.add(u),g(0))),S=a(R.cetus_coin.coin_type,N(t,9).toString()),f=g(S).gt(0)?w.div(7).mul(365).div(S).mul(100).toFixed(2):"0";n(Number(f)>0&&Number(f)<.01?"0.01":f.toString())}catch(s){console.error("Error calculating APR:",s),n("0.01")}},[e==null?void 0:e.bonus,t,o]);return l.useEffect(()=>{c()},[e==null?void 0:e.bonus,t,o]),{cetusApr:d}}function q(e){const{dividendRewardList:t}=k(),{fetchTokenInfo:r}=h(),{getTokenAmountValue:a}=O(),[o,d]=l.useState([]),[n,c]=l.useState([]),[s,w]=l.useState("0"),S=l.useCallback(async()=>{let f=g(0);const T=t.filter(u=>!(u.period===e||u.rewards.find(L=>g(L.amount).eq(0))));console.log("ðŸš€ ~ file: useXCetusHelper.ts:107 ~ calculateRewards ~ filteredList:",{filteredList:T,dividendRewardList:t,currentPeriod:e}),c(T);const i={};await Promise.all(T.map(async u=>{for(const L of u.rewards){const m=b(L.coin_type,!1),F=await r(m);if(F){const C=N(L.amount,F.decimals).toString(),V=a(m,C);f=f.add(V),i[m]=i[m]?{...i[m],amount:g(i[m].amount).add(C).toString(),value:g(i[m].value).add(V).toString()}:{amount:C,coin_type:m,value:V}}}})),d(Object.values(i).filter(u=>g(u.amount).gt(0)).sort((u,L)=>g(L.value).sub(u.value).toNumber())),w(f.toString())},[t,r,a,e]);return l.useEffect(()=>{e&&S()},[t,e]),{summaryRewardList:o,rewardList:n,totalRewardValue:s}}export{M as a,A as b,E as c,q as d,j as e,X as u};
//# sourceMappingURL=useXCetusHelper-Bbv1m28d.js.map

<<<<<<< HEAD:dist/assets/useFindBestRouting-BOYs32yR.js
import{e as v,A as f}from"./useSwapHelper-BR8zHa8J.js";import{aW as I,a9 as S,E as b,aJ as m,M as y}from"./index-ChSVVHaJ.js";import"./vendor-BFGDaAdA.js";function k(){const{aggregatorSDK:g}=I(),{getSwapPoolAddress:w}=v(),{deepbookV3Config:A,setDeepbookV3Config:R,providers:p}=S(),D=n=>n&&n.error?n.error.code===f.InsufficientLiquidity||f.HoneyPot||f.NumberTooLarge:!1,P=async n=>{const e=p.length>0?n.filter(t=>p.includes(t)):n;if(n.includes("DEEPBOOKV3")){let t=A;const a=new Date().getTime()/1e3;if(t===null||a-((t==null?void 0:t.last_update_time)||0)>60)try{t=await g.getDeepbookV3Config(),R(t)}catch(u){console.log("ðŸš€ ~ checkProvidersKeys ~ error:",u)}if(t&&t.is_alternative_payment){const{deep_fee_vault:u}=t;if(u<b(20,6))return e.filter(o=>o!=="DEEPBOOKV3")}}return e},h=async n=>{const{fromToken:e,toToken:t,amount:a,providersKeys:u,by_amount_in:o,uuid:s}=n;try{const i={from:e.coin_type,target:t.coin_type,amount:new m(a),byAmountIn:o,depth:3,splitAlgorithm:void 0,splitFactor:void 0,splitCount:void 0,providers:u};console.log("ðŸš€ ~ file: useFindBestRouting.ts:26 ~ findBestRouters ~ routerParams:",i);const r=await g.findRouters(i);if(console.log("ðŸš€ ~ file: useFindBestRouting.ts:145 ~ findBestRouters ~ res:",r),r&&D(r))return c(!1,o,s,e,t,r);if(!r||r.routes.length===0)throw Error("not find router");return c(!1,o,s,e,t,r)}catch(i){try{console.log("ðŸš€ ~ file: useFindBestRouting.ts:105 ~ findRouters ~ error:",i);const r=await w(e,t);if(r.length===0){const B={amountIn:new m("0"),amountOut:new m("0"),byAmountIn:o,routes:[],insufficientLiquidity:!0,error:{code:f.NoRouter,msg:""}};return c(!0,o,s,e,t,B)}const l={from:e.coin_type,target:t.coin_type,amount:new m(a),byAmountIn:o,pools:r};console.log("ðŸš€ ~ file: useFindBestRouting.ts:115 ~ findRouters ~ routerParams:",l);const d=await g.swapInPools(l);return console.log("ðŸš€ ~ file: useFindBestRouting.ts:170 ~ swapInPools ~ res:",d),!d||!d.routeData?c(!0,o,s,e,t):c(!0,o,s,e,t,d.routeData)}catch(r){return console.log("ðŸš€ ~ file: useFindBestRouting.ts:120 ~ swapInPools ~  error:",r),{uuid:s,byAmountIn:o,isDegrade:!0}}}},c=(n,e,t,a,u,o)=>{var s;if(console.log("ðŸš€ ~ file: useSwap.ts:166 ~ handleRouterData ~ res:",{isDegrade:n,routerData:o}),o){const i=o.error!==void 0,r=y(o.amountIn.toString(),a.decimals).toString(),l=y(o.amountOut.toString(),u.decimals).toString();return{routerData:i?void 0:o,fromAmountUi:i?e?r:"":r,toAmountUi:i&&e?"":l,uuid:t,byAmountIn:e,isDegrade:n,errorCode:(s=o.error)==null?void 0:s.code}}else return{uuid:t,byAmountIn:e,isDegrade:n}};return{findBestRouters:h,checkProvidersKeys:P}}export{k as u};
//# sourceMappingURL=useFindBestRouting-BOYs32yR.js.map
=======
import{e as v,A as f}from"./useSwapHelper-BbrB3cYm.js";import{aW as I,a9 as S,E as b,aJ as m,M as y}from"./index-Fe2tZAmL.js";import"./vendor-BFGDaAdA.js";function k(){const{aggregatorSDK:g}=I(),{getSwapPoolAddress:w}=v(),{deepbookV3Config:A,setDeepbookV3Config:R,providers:p}=S(),D=n=>n&&n.error?n.error.code===f.InsufficientLiquidity||f.HoneyPot||f.NumberTooLarge:!1,P=async n=>{const e=p.length>0?n.filter(t=>p.includes(t)):n;if(n.includes("DEEPBOOKV3")){let t=A;const a=new Date().getTime()/1e3;if(t===null||a-((t==null?void 0:t.last_update_time)||0)>60)try{t=await g.getDeepbookV3Config(),R(t)}catch(u){console.log("ðŸš€ ~ checkProvidersKeys ~ error:",u)}if(t&&t.is_alternative_payment){const{deep_fee_vault:u}=t;if(u<b(20,6))return e.filter(o=>o!=="DEEPBOOKV3")}}return e},h=async n=>{const{fromToken:e,toToken:t,amount:a,providersKeys:u,by_amount_in:o,uuid:s}=n;try{const i={from:e.coin_type,target:t.coin_type,amount:new m(a),byAmountIn:o,depth:3,splitAlgorithm:void 0,splitFactor:void 0,splitCount:void 0,providers:u};console.log("ðŸš€ ~ file: useFindBestRouting.ts:26 ~ findBestRouters ~ routerParams:",i);const r=await g.findRouters(i);if(console.log("ðŸš€ ~ file: useFindBestRouting.ts:145 ~ findBestRouters ~ res:",r),r&&D(r))return c(!1,o,s,e,t,r);if(!r||r.routes.length===0)throw Error("not find router");return c(!1,o,s,e,t,r)}catch(i){try{console.log("ðŸš€ ~ file: useFindBestRouting.ts:105 ~ findRouters ~ error:",i);const r=await w(e,t);if(r.length===0){const B={amountIn:new m("0"),amountOut:new m("0"),byAmountIn:o,routes:[],insufficientLiquidity:!0,error:{code:f.NoRouter,msg:""}};return c(!0,o,s,e,t,B)}const l={from:e.coin_type,target:t.coin_type,amount:new m(a),byAmountIn:o,pools:r};console.log("ðŸš€ ~ file: useFindBestRouting.ts:115 ~ findRouters ~ routerParams:",l);const d=await g.swapInPools(l);return console.log("ðŸš€ ~ file: useFindBestRouting.ts:170 ~ swapInPools ~ res:",d),!d||!d.routeData?c(!0,o,s,e,t):c(!0,o,s,e,t,d.routeData)}catch(r){return console.log("ðŸš€ ~ file: useFindBestRouting.ts:120 ~ swapInPools ~  error:",r),{uuid:s,byAmountIn:o,isDegrade:!0}}}},c=(n,e,t,a,u,o)=>{var s;if(console.log("ðŸš€ ~ file: useSwap.ts:166 ~ handleRouterData ~ res:",{isDegrade:n,routerData:o}),o){const i=o.error!==void 0,r=y(o.amountIn.toString(),a.decimals).toString(),l=y(o.amountOut.toString(),u.decimals).toString();return{routerData:i?void 0:o,fromAmountUi:i?e?r:"":r,toAmountUi:i&&e?"":l,uuid:t,byAmountIn:e,isDegrade:n,errorCode:(s=o.error)==null?void 0:s.code}}else return{uuid:t,byAmountIn:e,isDegrade:n}};return{findBestRouters:h,checkProvidersKeys:P}}export{k as u};
//# sourceMappingURL=useFindBestRouting-iZLE70Rn.js.map
>>>>>>> 618a0176653140f5c93e017a1cc36f7fe995b39f:dist/assets/useFindBestRouting-iZLE70Rn.js

import{a as d,x as Ye,j as e,V as R,F as Je,a9 as ze,H as v,T as f,C as I,p as ae,q,f as K,W as Ze,X as et,Y as tt,Z as st,$ as nt,a0 as ot,aa as Be,I as it,N as jt,az as mt,O as bt,Q as yt,aq as Ne,af as wt}from"./vendor-BFGDaAdA.js";import{u as at}from"./global-DaL79zhi.js";import{k as X,C as ce,I as N,O as Z,aD as Ct,j as me,a as Q,n as ke,o as ue,a1 as _t,d as F,s as St,e as fe,f as J,G as oe,B as te,h as lt,r as Xe,aE as Te,F as vt,Q as rt,M as de,q as Tt,V as kt,c as ct,aj as Pt,v as ee,ao as ne,an as je,l as re,aF as Lt,aG as $e,p as ve,aH as At,aI as Ot,ai as Rt,aJ as Dt,Z as Ht,aK as Ft,aL as Ge,aM as qe}from"./index-CJa1Q5Eu.js";import{N as se}from"./NoData-DtiZhmrM.js";import{u as zt,A as Bt,R as Et}from"./RecentTransactions-Dxy6s8YG.js";import{A as Vt}from"./AccountSwitchDrawer-5u5ZLHuI.js";import{a as be,u as Ee,e as Ve,i as Ut,j as Mt,f as Wt,c as Nt,k as Xt}from"./VaultsAprBlock-BN9YfW1L.js";import{a as xe,d as $t,u as Gt,g as qt,e as Kt,f as Qt,h as It,c as Yt,b as Jt}from"./usePositionList-B4CPJwxw.js";import{a as Zt,b as es,P as ts,u as ss}from"./PoolItem-Cn-Qc64k.js";import{u as Y}from"./activeOrders-BoeF8gqp.js";import{P as ns,V as os,H as ie,u as is}from"./PositionListLoading-CuIvhI1D.js";import{C as as}from"./CoinPairInfo-BTtsocOl.js";import{u as pt}from"./VaultsAction-1iPBUSj9.js";import{V as ls}from"./VaultsHoldings-yk6R_fRi.js";import{H as Pe,T as Le}from"./Table-RSy0d7Tc.js";import{T as he}from"./TableSortTh-D2njcinr.js";import{u as dt,D as ut,g as rs,e as cs,f as ps,W as ds,b as us,R as xs,a as gs,d as hs}from"./OverviewOrders-D55vePnH.js";import{I as De}from"./IconText-D1InQAKf.js";import{u as fs}from"./RangeValue-DSKhYm1I.js";import{H as le}from"./HTextLabelBox-BT9c1ibT.js";import{P as Ae}from"./Pagination-DUFXv6nu.js";import{b as js,u as ye,c as ms,C as bs,P as ys,F as ws,E as Cs,S as _s,O as Ss,a as vs}from"./useGetLimitOrderHistory-C_NbYwpl.js";import{u as Ts}from"./useRpcListener-COZ8ztFC.js";import{R as ks}from"./RefreshButton-D05mNjjf.js";import{u as Ps}from"./useAccountBalance-CeUdpiKX.js";import{u as xt}from"./useToken-DcLYM1a2.js";import{f as Ue,a as Ls,b as As,u as Os,X as Rs,c as Ds,C as Hs,e as Fs,d as zs,g as Bs}from"./useXCetus-BtzdDwHf.js";import{S as gt}from"./SingleTokenInfo-DvfSTCmR.js";import{S as Es}from"./SortDropBlock-BW1Pm-Zk.js";import{u as Vs}from"./useTokenBalance-CeWcIfEX.js";import{X as Us,a as Ms,b as Ws,c as Ns}from"./useXCetusHelper-DPbVtYc4.js";import"./CopyButton-YuSxCk7k.js";import"./Drawer-Dz9Aj4rR.js";import"./useGetPoolList-sKGYxkhS.js";import"./useWrapPoolData-6jgPzxLW.js";import"./useFavoritePool-Bb9nHdPu.js";import"./CheckBox-DKraExiP.js";import"./SearchInputBlock-C_-D9XzV.js";import"./index-DUawbb2i.js";import"./Loading-yKVeoG31.js";import"./TooltipIcon-Pt406Jfg.js";import"./PositionCurrentPrice-DQC6iWOF.js";import"./contract-helper-BB8VGIMo.js";import"./msafe-oYBkW7LJ.js";import"./useTransaction-Cc765MUE.js";import"./useTrack-9gGG2G-b.js";import"./useSigner-B8FtJCBW.js";import"./ExpendItem-C_e8gEdY.js";import"./PositionStatus-NG03D-02.js";import"./useInterval-BQqGpXj5.js";import"./PoweredByHaedal-Bke0Bj0w.js";import"./VTextLabelBox-DTl1JdvO.js";import"./useNotifiSubscription-B8rUUuCQ.js";import"./useNotifiAlerts-BPznGicf.js";import"./usePriceImpact-DhEpoyWT.js";import"./index-BleV78I3.js";import"./useSwapHelper-BTHj2AcR.js";import"./TradeConfirmAmountInfo-CcbHRYfi.js";import"./TotalAmount-rygmslhD.js";import"./TradeInputGroup-DATFBLnD.js";import"./_getAllKeysIn-9Vk7AOo9.js";import"./RemoveBlock-OIfyDiw9.js";import"./DepositRatio-DbH1JwsR.js";import"./FreshProgressV2-UCJ6Olyb.js";import"./ErrorTips-miVRYnRY.js";import"./index-BltWaZyP.js";import"./usePosAdd-D0ti9xh9.js";import"./index-5XWuGyiv.js";import"./useFindBestRouting-u1qIkehW.js";import"./useVaultsHoldings-BGVVhJMw.js";import"./usePreviousValue-DoVr3Y3V.js";import"./HighlightText-fkyigc44.js";import"./index-D1m9ooSc.js";import"./debounce-B8kzHASh.js";import"./index-BLCSsYSf.js";function Xs(t=100){const i=d.useRef([]),o=d.useRef(!1),l=d.useRef(void 0),r=d.useCallback(async()=>{if(!o.current){for(o.current=!0;i.current.length>0;){const n=i.current.shift();if(!n)continue;const{id:c,run:x,onStart:g,onSuccess:p,onError:b}=n;if(n._cancelled){console.log(`[task:${n.id}] skipped (cancelled)`);continue}try{console.log(`[task:${c}] start`),g==null||g(c);const y=await x(l.current,c);l.current=y,console.log(`[task:${c}] success`,y),p==null||p(y,c)}catch(y){console.error(`[task:${c}] failed`,y),b==null||b(y,c)}await new Promise(y=>setTimeout(y,t))}o.current=!1}},[t]),a=n=>{i.current.push(n),r()},s=n=>{const c=i.current.find(x=>x.id===n);c&&(c._cancelled=!0),i.current=i.current.filter(x=>x.id!==n)};return d.useEffect(()=>()=>{i.current=[],o.current=!1,l.current=void 0},[]),{addTask:a,removeTask:s}}const ht=(t,i)=>i?t:"********";function $s({totalValue:t,onRefreshTask:i,isLoading:o,children:l}){const[r,a]=d.useState(!1),{currentAccount:s,onWalletModal:n,accounts:c,accountServiceNameObj:x}=X(),{isShowProfileAssets:g,setIsShowProfileAssets:p}=at();d.useEffect(()=>{a(!0)},[]);const{isOpen:b,onClose:y,onToggle:w}=Ye(),{getServiceNames:P}=zt(),L=d.useCallback(()=>{b||P(c),w(),console.log("AccountSwitch###handleClick###isOpen: ",b)},[b,c]);return console.log(s,x,c,"currentAccount-H5Main"),e.jsxs(R,{w:"100%",mt:"28px",children:[r?s!=null&&s.address?e.jsxs(R,{w:"100%",gap:"16px",alignItems:"start",children:[e.jsxs(v,{w:"100%",h:"18px",align:"flex-end",justify:"space-between",children:[e.jsxs(v,{h:"18px",children:[e.jsx(f,{h:"18px",lineHeight:"18px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ce,{showTooltip:!1,placement:"bottom-end",tooltip:e.jsx(f,{fontSize:"12px",children:g?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(N,{xlinkHref:g?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>p(!g)})})})]}),e.jsxs(v,{h:"16px",align:"center",gap:"0",cursor:"pointer",onClick:()=>console.log("jump to transactions"),children:[e.jsx(f,{h:"16px",lineHeight:"16px",fontSize:"12px",children:"Transactions"}),e.jsx(N,{xlinkHref:"#icon-icon_ascending",fontSize:"16px",transform:"rotate(90deg)"})]})]}),e.jsx(ae,{isLoaded:!o,h:"32px",children:e.jsx(f,{mt:"-6px",letterSpacing:"1px",h:"32px",fontSize:"28px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Z(t,2),g)})}),c.length>1&&e.jsxs(v,{w:"100%",h:"44px",borderRadius:"8px",bg:"account_switch_bg",backdropFilter:"blur(4px)",p:"12px 12px 12px 0",justify:"space-between",onClick:L,cursor:"pointer",children:[e.jsxs(v,{children:[e.jsx(N,{xlinkHref:"#icon-account",svgFill:"text_caption"}),e.jsxs(f,{color:"text_caption",fontSize:"14px",lineHeight:"14px",children:[s!=null&&s.label?`${s==null?void 0:s.label} : `:"",(x==null?void 0:x[s==null?void 0:s.address])||Ct(s==null?void 0:s.address)]})]}),e.jsx(N,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}),l]}):e.jsx(se,{type:"nowallet",mt:"20px",onboard:()=>n(!0)}):e.jsx(Je,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})}),e.jsx(Vt,{isOpen:b,onClose:y})]})}function Me(t){const{type:i,children:o,wrapStyle:l={h:"60px"},textStyle:r={fontSize:"16px"}}=t,a=(s,n)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(s,n):s===n.value;return e.jsxs(v,{justify:"space-between",w:"100%",h:"60px",...l,children:["title"in t?e.jsx(f,{color:"text_caption",...r,children:t==null?void 0:t.title}):e.jsx(me,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(s,n)=>a(s,n),wrapStyle:{h:"60px",border:"none",gap:"38px",...l},itemStyle:r}),o]})}function Gs({showPosListGroupByPool:t=[]}){var a;const{currentAccount:i,onWalletModal:o}=X(),{posBaseListLoading:l}=xe(),{isAutoRefresh:r}=Y();return e.jsxs(R,{w:"100%",children:[e.jsx(Zt,{isProfile:!0}),i!=null&&i.address?!r&&l?[{},{},{},{}].map((s,n)=>e.jsx(ns,{},n)):((a=Object.values(t))==null?void 0:a.length)>0?Object.values(t).map((s,n)=>e.jsx(es,{poolInfo:s,isProfile:!0},n)):e.jsx(se,{type:"nodata",text:"No liquidity positions",noBorder:!0}):e.jsx(se,{type:"nowallet",onboard:()=>o(!0),noBorder:!0})]})}function qs({poolInfo:t}){const{setProfileActionTab:i,isProfileOpenVaultModal:o,setIsProfileOpenVaultModal:l,clearVaultsActionData:r,setProfilePoolInfo:a}=pt();return d.useEffect(()=>{r()},[o]),e.jsx(e.Fragment,{children:e.jsxs(v,{justify:"flex-end",children:[e.jsx(q,{onClick:()=>{i("Deposit"),l(!0),a(t)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Deposit"}),e.jsx(q,{onClick:()=>{i("Withdraw"),l(!0),a(t)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Withdraw"})]})})}function Ks({selectCoinList:t=[]}){const{vaultsPositionObj:i}=be(),{vaultPageList:o,vaultListLoading:l,setVaultListLoading:r}=Ee(),{filterVaultList:a,getCurrentTabNum:s}=Ve(),[n,c]=d.useState([]),[x,g]=d.useState("desc"),[p,b]=d.useState({label:"",value:""}),{profileActionTab:y,isProfileOpenVaultModal:w,setIsProfileOpenVaultModal:P,profilePoolInfo:L}=pt();d.useEffect(()=>{p.value==""&&c(o)},[o]),console.log("ðŸš€ ~ ProfileVaults ~ pageList:",l,(n==null?void 0:n.length)===0,n);const{isAutoRefresh:B,autoRefreshCount:m}=Y(),{isApp:C}=Q(),h=!0,S={sortRule:"desc",sortType:"tvl"},_=d.useMemo(()=>[{label:"All Vault",value:"all",num:s({sortOptions:S,currentTab:"all",isYourHoldings:h,selectCoinList:t})||""},{label:"Cetus",value:"cetus",num:s({sortOptions:S,currentTab:"cetus",isYourHoldings:h,selectCoinList:t})||""},{label:"Haedal",value:"haedal",num:s({sortOptions:S,currentTab:"haedal",isYourHoldings:h,selectCoinList:t})||""}],[JSON.stringify(n),h,JSON.stringify(t)]),[T,O]=d.useState("all"),{coinPriceObj:u}=ke(),{getTokenAmountValue:A}=ue(),{getTokenAmountValueByPyth:k}=Ut(),{pythPriceMap:z}=Mt(),E=D=>{T===D||l||(O(D),a({sortOptions:S,currentTab:D,isYourHoldings:h,selectCoinList:t}),r(!0),setTimeout(()=>{r(!1)},200))};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ vaultsPositionObj:",i),_t(i)&&a({sortOptions:S,currentTab:T,isYourHoldings:h,selectCoinList:t})},[i,t]);const M=(D,$,W)=>D.category=="haedal"?k($,W):A($,W,"--");d.useEffect(()=>{if((o==null?void 0:o.length)>0&&p.value!==""){const $=o.map(W=>{const G=i[W==null?void 0:W.vaultId]||{},pe=M(W,G.displayCoinTypeA,G.displayAmountA),we=M(W,G.displayCoinTypeB,G.displayAmountB),ge=pe=="--"||pe=="--"?"0":F(pe).plus(we||0).toString(),Ce=St(ge,"$");return{...W,sharePoolRate:G==null?void 0:G.sharePoolRate,holdingAmount:parseFloat(ge||"0"),holdingAmountDisplay:Ce}}).sort((W,G)=>x==="asc"?p.value=="holdings"?W.holdingAmount-G.holdingAmount:W.sharePoolRate-G.sharePoolRate:p.value=="holdings"?G.holdingAmount-W.holdingAmount:G.sharePoolRate-W.sharePoolRate);console.log("ðŸš€ ~ useEffect ~ sorted:",i,$),c($)}},[o.length,p.value,x,u,z]);const H=D=>{if(C)(D==null?void 0:D.value)!==(p==null?void 0:p.value)&&(g("desc"),b(D));else if((D==null?void 0:D.value)==(p==null?void 0:p.value)){const $=x=="desc"?"asc":"desc";g($)}else g("desc"),b(D)},j=[{label:"Your Holdings",value:"holdings"},{label:"Share of Pool",value:"shareOfPool"}].reduce((D,$)=>(D[$.value]=$,D),{}),U=Qs({isShowPowered:T!=="Haedal",vaultsPositionObj:i,getAmountValue:M,sortRule:x,sortBy:p,sortByObject:j,clickSort:H});return e.jsxs(R,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",children:[e.jsx(me,{type:"outlineTab",tabList:_,currentTab:T,handleChangeTab:D=>E(D==null?void 0:D.value),isActive:(D,$)=>D===$.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),e.jsx(R,{w:"100%",position:"relative",gap:"20px",children:(B||!l)&&(n==null?void 0:n.length)===0?e.jsx(se,{type:"nodata",text:"No vaults found",noBorder:!0}):C?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"clmmPoolAddress",columns:U,dataSource:n,loading:!B&&l,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"clmmPoolAddress",columns:U,dataSource:n,loading:!B&&l,rowStyle:{h:"80px",cursor:"pointer"}})}),w&&e.jsx(os,{isOpen:w,setIsOpen:P,displayTokenA:L.displayTokenA,displayTokenB:L.displayTokenB,feeDisplay:L.feeDisplay,clmmPool:L.clmmPoolAddress,category:L.category,vaultId:L.vaultId,isReverse:L.isReverse,currentTab:y},L.vaultId)]})}const Qs=({isShowPowered:t,vaultsPositionObj:i,getAmountValue:o,sortRule:l,sortBy:r,sortByObject:a,clickSort:s})=>[{title:e.jsx(f,{children:"Pools"}),key:"pools",thConfig:{pl:"0px !important"},render:n=>e.jsx(as,{poolInfo:{...n,poolAddress:n==null?void 0:n.vaultId},isShowPowered:t,symbolFontSize:"15px"})},{title:e.jsx(he,{labelInfo:a.holdings,sortBy:r,sortRule:l,clickSort:n=>s(n)}),key:"holdings",render:n=>{var p,b,y,w;const c=i[n==null?void 0:n.vaultId]||{},x=o(n,(p=n==null?void 0:n.displayTokenA)==null?void 0:p.coin_type,c==null?void 0:c.displayAmountA),g=o(n,(b=n==null?void 0:n.displayTokenB)==null?void 0:b.coin_type,c==null?void 0:c.displayAmountB);return e.jsx(ce,{placement:"top",tooltip:e.jsxs(R,{gap:"8px",align:"flex-start",minW:"200px",children:[e.jsxs(v,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(v,{children:[e.jsx(fe,{imageUrl:n.displayTokenA.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(f,{color:"text_caption",fontSize:"12px",children:(y=n==null?void 0:n.displayTokenA)==null?void 0:y.symbol})]}),e.jsx(ie,{children:e.jsxs(R,{align:"flex-end",children:[e.jsx(f,{color:"text_caption",fontSize:"12px",children:J(c==null?void 0:c.displayAmountA)}),e.jsx(f,{fontSize:"12px",children:x=="--"?"$--":Z(x,2)})]})})]}),e.jsx(K,{w:"100%",height:"1px",bg:"border"}),e.jsxs(v,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(v,{children:[e.jsx(fe,{imageUrl:n.displayTokenB.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(f,{color:"text_caption",fontSize:"12px",children:(w=n==null?void 0:n.displayTokenB)==null?void 0:w.symbol})]}),e.jsx(ie,{children:e.jsxs(R,{align:"flex-end",children:[e.jsx(f,{color:"text_caption",fontSize:"12px",children:J(c==null?void 0:c.displayAmountB)}),e.jsx(f,{fontSize:"12px",children:g=="--"?"$--":Z(g,2)})]})})]})]}),children:e.jsx(I,{as:"button",ml:"4px",children:e.jsx(ie,{children:e.jsxs(v,{justifyContent:"flex-end",gap:"0",children:[e.jsx(f,{color:"text_caption",mr:"2px",textDecoration:"underline dotted",textUnderlineOffset:"3px",children:`${(c==null?void 0:c.balanceDisplay)||"0"} LP`}),e.jsx(f,{children:"("}),e.jsx(ls,{color:"text_paragraph",vaultId:n.vaultId,category:n.category}),e.jsx(f,{children:")"})]})})})})}},{title:e.jsx(he,{labelInfo:a.shareOfPool,sortBy:r,sortRule:l,clickSort:n=>s(n)}),key:"shareOfPool",render:n=>{const c=i[n==null?void 0:n.vaultId]||{};return console.log("ðŸš€ ~ vaultsPositionObj:",i,c),e.jsx(v,{justify:"flex-end",children:e.jsx(ie,{children:e.jsxs(f,{color:"text_caption",children:[" ",c==null?void 0:c.shartOfPoolDisplay]})})})}},{title:e.jsx(f,{textAlign:"right",children:"Actions"}),key:"actions",render:n=>e.jsx(qs,{poolInfo:n})}];function Is(){const{currentAccount:t}=X(),{vaultsPositionObj:i}=be(),{showPosListLength:o,posBaseListLoading:l,setShowPosListLength:r,posBaseListGroupByPool:a}=xe(),{getCurrentTabNum:s}=Ve(),[n,c]=d.useState([]),x=m=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",m),c(C=>[...C,m])},g=m=>{console.log("ðŸš€ ~ onClickIncentiveTypes ~ tokenInfo:",m),c(C=>C.filter(h=>(h==null?void 0:h.coin_type)!==(m==null?void 0:m.coin_type)))};d.useEffect(()=>{t!=null&&t.address||r("")},[t==null?void 0:t.address]),d.useEffect(()=>()=>{r("")},[]);const[p,b]=d.useState("positions"),y={sortRule:"desc",sortType:"tvl"},w=!0,P=d.useMemo(()=>{const m=p=="positions"?[]:n;return[{label:"Positions",value:"positions",num:l?"":Number(o)},{label:"Vaults",value:"vaults",num:s({sortOptions:y,currentTab:"all",isYourHoldings:w,selectCoinList:m})||""}]},[l,o,n,i]),[L,B]=d.useState([]);return d.useEffect(()=>{var T,O,u,A;const m=p=="vaults"?[]:n,C=(T=m[0])!=null&&T.coin_type?oe((O=m[0])==null?void 0:O.coin_type):void 0,h=(u=m[1])!=null&&u.coin_type?oe((A=m[1])==null?void 0:A.coin_type):void 0,S=Object.values(a).filter(k=>C&&h?oe(k.tokenA.coin_type)==C&&oe(k.tokenB.coin_type)==h||oe(k.tokenA.coin_type)==h&&oe(k.tokenB.coin_type)==C:C?oe(k.tokenA.coin_type)==C||oe(k.tokenB.coin_type)==C:k);console.log("ðŸš€ ~ useEffect ~ filterArr:",Object.values(a),S),B(S);const _=S.reduce((k,z)=>k+(z.list?z.list.length:0),0);t!=null&&t.address&&r(_.toString())},[n,a]),e.jsx(te,{p:"0 16px 16px",borderRadius:"16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{gap:"16px",w:"100%",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(Me,{type:"tab",currentTab:p,tabs:P,onTabChange:m=>{c([]),b(m.value)},textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(ts,{isProfile:!0,isPools:!1,handleRefresh:()=>{},selectCoinList:n,onClickSelectCoinList:x,onDeleteSelectCoinList:g})]}),e.jsx(K,{h:"1px",w:"100%",bg:"border",mt:"-16px"}),p==="positions"&&e.jsx(Gs,{showPosListGroupByPool:L}),p==="vaults"&&e.jsx(Ks,{selectCoinList:n})]})})}function Ys({orderInfo:t,isActiveOrder:i,pageDirect:o}){const{inCoin:l,outCoin:r}=t,{orderHistoryList:a,handleGetDcaOrderHistory:s,orderHistoryListLoading:n}=dt();d.useEffect(()=>{t!=null&&t.orderID&&s(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:c}=lt(),[x,g]=d.useState(o),p=142,b=(a==null?void 0:a.length)||0,y=(a==null?void 0:a.length)==0?"0px":(a==null?void 0:a.length)<=1?`${p*b+8}px`:`${p*b+(b-1)*32+8}px`;return e.jsxs(R,{pb:"16px",align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(a==null?void 0:a.length)>=3?"460px":"unset",overflowY:"auto",children:[!n&&e.jsx(K,{w:"0px",h:y,borderRight:"1px dashed",borderColor:"border",position:"absolute",left:"6px",top:"8px"}),n?e.jsx(v,{h:"100px",w:"100%",justify:"center",children:e.jsx(ze,{})}):(a==null?void 0:a.length)===0?e.jsx(se,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):a.map(w=>{const P=Xe(w.inAmount,l==null?void 0:l.decimals),L=Xe(w.outAmount,r==null?void 0:r.decimals),B=F(P).div(L).toString(),m=F(1).div(B).toString();return e.jsxs(R,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(v,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(f,{h:"20px",lineHeight:"20px",children:[Te((w==null?void 0:w.time)*1e3)," (UTC)"]}),e.jsx(N,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(c(w==null?void 0:w.tx,"tx"))}}),e.jsx(v,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(K,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(te,{p:"16px",borderRadius:"12px",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsxs(R,{gap:"0px",align:"flex-start",children:[e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:x?`${J(B)} `:`${J(m)} `}),e.jsxs(v,{children:[e.jsxs(f,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:["Rate(",x?` ${l.symbol} per ${r.symbol}`:` ${r.symbol} per ${l.symbol}`,")"]}),e.jsx(N,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>g(!x)})]})]}),e.jsxs(v,{w:"100%",gap:"4px",children:[e.jsx(fe,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${J(P)}`}),e.jsx(f,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${l.symbol}`}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(fe,{imageUrl:r==null?void 0:r.logo_url,w:"20px",h:"20px"}),e.jsx(f,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${J(L)}`}),e.jsx(f,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${r.symbol}`})]})]})})]},w==null?void 0:w.tx)})]})}function Js({orderInfo:t,isActiveOrder:i,pageDirect:o,isClaimLoading:l=!1,toClaim:r}){const{inCoin:a,outCoin:s}=t;return e.jsxs(R,{pb:"24px",children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&i&&e.jsx(Zs,{}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(ut,{orderInfo:t}),i&&r&&e.jsx(q,{isLoading:l,onClick:()=>r(t),disabled:(t==null?void 0:t.outBalance)<=0||l,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(f,{fontSize:"16px",color:"text_caption",children:rs(t,i,!0)}),e.jsx(f,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(v,{w:"100%",justify:"space-around",children:[e.jsxs(R,{children:[e.jsx(f,{fontSize:"16px",color:"text_caption",children:cs(t)}),e.jsxs(f,{fontSize:"12px",children:["DCA ",a==null?void 0:a.symbol," Balance"]})]}),e.jsx(K,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(R,{children:[e.jsx(f,{color:"text_caption",fontSize:"16px",children:ps(t)}),e.jsxs(f,{fontSize:"12px",children:["DCA ",s==null?void 0:s.symbol," Balance "]})]})]}),e.jsxs(R,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(le,{label:"Invest Every",value:t==null?void 0:t.investEvery}),F(t==null?void 0:t.ofOrderLeft).gt("0")&&e.jsx(le,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(le,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${a==null?void 0:a.symbol}`}),i&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(le,{label:"Current Avg. Price",value:o?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${a==null?void 0:a.symbol}`}),!i&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(le,{label:"Avg. Price",value:o?`${t==null?void 0:t.currentAvgPrice} ${a==null?void 0:a.symbol} per ${s==null?void 0:s.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${s==null?void 0:s.symbol} per ${a==null?void 0:a.symbol}`}),i&&e.jsx(le,{label:"Next Order (UTC)",value:Te(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(le,{label:"Created (UTC)",value:Te(t==null?void 0:t.createAt)||""})]})]})}const Zs=()=>{const[t,i]=d.useState(!1);return e.jsxs(R,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(v,{align:"center",w:"100%",cursor:"pointer",onClick:()=>i(!t),children:[e.jsx(f,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(N,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(R,{align:"flex-start",w:"100%",children:[e.jsx(K,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(ds,{})]})]})};function en({isOpen:t,onClose:i,orderInfo:o,isActiveOrder:l,isClaimLoading:r=!1,toClaim:a}){const{isApp:s}=Q(),n=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[c,x]=d.useState("overview"),{inCoin:g,outCoin:p}=o,[b,y]=d.useState(!1),{getTokenRank:w}=fs();return d.useEffect(()=>{const P=w(g,p);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",p,g,P),y(!P)},[g==null?void 0:g.coin_type,p==null?void 0:p.coin_type]),e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{minWidth:s?"300px":"482px",children:[e.jsx(st,{children:e.jsx(K,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Me,{type:"tab",currentTab:c,tabs:n,onTabChange:P=>x(P.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"0 16px 0px",textAlign:"center",children:[c=="overview"&&e.jsx(Js,{orderInfo:o,isActiveOrder:l,pageDirect:b,isClaimLoading:r,toClaim:a}),c=="orders"&&e.jsx(Ys,{orderInfo:o,isActiveOrder:l,pageDirect:b})]})]})]})}function tn({orderInfo:t,isActiveOrder:i=!0}){const{isApp:o}=Q(),[l,r]=d.useState(!1),{getExplorerUrl:a}=lt(),{isClaimLoading:s,toClaim:n,closeOrderAction:c,isCloseLoading:x}=dt();return e.jsxs(e.Fragment,{children:[i&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(q,{isLoading:s,onClick:()=>n(t),disabled:(t==null?void 0:t.outBalance)<=0||s,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Claim"}),e.jsx(ce,{placement:"bottom-end",tooltip:e.jsxs(R,{align:"flex-start",children:[e.jsx(De,{text:"View Details",onClick:()=>{r(!0)}}),e.jsx(De,{text:"View on Explorer",onClick:()=>{window.open(a(t.orderID,"poolAddress"))}}),e.jsx(De,{text:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw",onClick:x?()=>{}:()=>{c(t)}})]}),children:e.jsx(I,{children:e.jsx(q,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:o?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}),!i&&e.jsxs(v,{justify:"flex-end",children:[e.jsx(q,{onClick:()=>{r(!0)},h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(q,{onClick:g=>{vt(g),window.open(a(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(N,{svgW:"20px",xlinkHref:"#icon-icon_link1"})})]}),l&&e.jsx(en,{isOpen:l,onClose:()=>r(!1),orderInfo:t,isActiveOrder:i,isClaimLoading:s,toClaim:n})]})}function sn(){const{isAutoRefresh:t,dcaOrderListLoading:i,dcaActiveOrderList:o,dcaPastOrderList:l}=Y(),[r,a]=d.useState("activeDCAs"),s=d.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&i?"":o==null?void 0:o.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&i?"":l==null?void 0:l.length}],[i,l,o]),n=d.useMemo(()=>r=="activeDCAs"?o:l,[r,o,l]),{isApp:c}=Q(),{closeAll:x,claimAll:g,isClaimAllLoading:p,isCloseAllLoading:b}=us(),y=d.useMemo(()=>r==="pastDCAs"||(n==null?void 0:n.length)===0?0:n==null?void 0:n.reduce((_,T)=>F(_).plus(T==null?void 0:T.outBalance),F(0)).toString(),[r,n]),[w,P]=d.useState([]),[L,B]=d.useState(0),[m,C]=d.useState(1),h=10,S=Ke(r=="activeDCAs");return d.useEffect(()=>{if((n==null?void 0:n.length)>0){const _=(m-1)*h;(n==null?void 0:n.length)<=_&&C(1)}},[n]),d.useEffect(()=>{if((n==null?void 0:n.length)>0){B(n==null?void 0:n.length);const _=(m-1)*h,T=_+h;console.log("ðŸš€ ~ useEffect ~ start:",m,n.slice(0,T),_,T),(n==null?void 0:n.length)>_&&P(n.slice(_,T))}},[m,n]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:s,currentTab:r,handleChangeTab:_=>a(_==null?void 0:_.value),isActive:(_,T)=>_===T.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(n==null?void 0:n.length)>1&&r=="activeDCAs"&&e.jsxs(v,{children:[e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:p,disabled:Number(y)===0||p,onClick:()=>{g(n)},children:"Claim All"}),e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:b,disabled:(n==null?void 0:n.length)==0||b,onClick:()=>{x(n)},children:"Close All"})]})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(t||!i)&&(n==null?void 0:n.length)===0?e.jsx(se,{type:"nodata",text:r==="activeDCAs"?"No active DCAs":"No past DCAs",noBorder:!0}):c?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"orderID",columns:S,dataSource:w,loading:!t&&i,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"orderID",columns:Ke(r=="activeDCAs"),dataSource:w,loading:!t&&i,rowStyle:{h:"80px",cursor:"pointer"}}),(n==null?void 0:n.length)>h&&e.jsx(I,{children:e.jsx(Ae,{total:L,size:h,currentPage:m,onChange:_=>{C(_)}})})]})]})}const Ke=t=>[{title:e.jsx(f,{children:"Orders"}),key:"order",thConfig:{w:"18%"},render:o=>e.jsx(ut,{orderInfo:o})},{title:e.jsx(f,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:o=>e.jsx(xs,{orderInfo:o,isProfile:!0,isRank:!0})},{title:e.jsx(f,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:o=>e.jsx(gs,{orderInfo:o,isProfile:!0})},t&&{title:e.jsx(f,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:o})=>e.jsx(f,{color:"text_caption",children:Te(o)})},{title:e.jsx(f,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"15%"},render:o=>e.jsx(tn,{orderInfo:o,isActiveOrder:t})}].filter(Boolean);function nn(){const{currentAccount:t}=X(),{getLimitOrderHistory:i,historyOrderList:o,historyOrderLoading:l}=js(),{myOrderList:r,orderListLoading:a}=ye(),{isAutoRefresh:s,autoRefreshCount:n}=Y(),[c,x]=d.useState("openOrders"),g=d.useMemo(()=>c=="openOrders"?a:l,[c,a,l]),p=d.useMemo(()=>(console.log("ðŸš€ ~ currentList ~ myOrderList:",r,o),c=="openOrders"?r:o),[c,r,o]),b=d.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:(s||!g)&&(r==null?void 0:r.length)===0?0:!s&&a?"":r==null?void 0:r.length},{label:"Orders History",value:"ordersHistory",num:(s||!g)&&(o==null?void 0:o.length)===0?0:!s&&l?"":o==null?void 0:o.length}],[a,l,r,o]),y=u=>{t!=null&&t.address&&i(t.address,u)};d.useEffect(()=>{console.log("ðŸš€ ----------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ useEffect ~ autoRefreshCount:",n),console.log("ðŸš€ ----------------------------------------------------ðŸš€"),n>0&&y(!0)},[n]),d.useEffect(()=>{y(!1)},[c,t]),Ts({onRpcChange:()=>{y(!0)}});const{isApp:w}=Q(),{handleCancelOrder:P,cancelOrderLoading:L}=ms(),[B,m]=d.useState([]),[C,h]=d.useState(0),[S,_]=d.useState(1),T=10,O=on(c=="openOrders");return d.useEffect(()=>{if((p==null?void 0:p.length)>0){const u=(S-1)*T;(p==null?void 0:p.length)<=u&&_(1)}},[p]),d.useEffect(()=>{if((p==null?void 0:p.length)>0){h(p==null?void 0:p.length);const u=(S-1)*T,A=u+T;console.log("ðŸš€ ~ useEffect ~ start:",S,p.slice(0,A),u,A),(p==null?void 0:p.length)>u&&m(p.slice(u,A))}},[S,p]),e.jsxs(R,{w:"100%",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(me,{type:"outlineTab",tabList:b,currentTab:c,handleChangeTab:u=>x(u==null?void 0:u.value),isActive:(u,A)=>u===A.value,wrapStyle:{border:"none",h:"32px",gap:"8px",bg:"none"},itemStyle:{fontSize:"14px",borderRadius:"8px",p:"0 8px"}}),(p==null?void 0:p.length)>1&&c=="openOrders"&&e.jsx(v,{children:e.jsx(q,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:L,onClick:()=>{P(r)},children:"Cancel All"})})]}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(s||!g)&&(p==null?void 0:p.length)===0?e.jsx(se,{type:"nodata",text:c=="openOrders"?"No open orders":"No history orders",noBorder:!0}):w?e.jsx(R,{w:"100%",gap:"4px",children:e.jsx(Pe,{rowKey:"order_id",columns:O,dataSource:B,loading:!s&&g,itemSkeletonLength:5,itemHeight:"30px"})}):e.jsx(Le,{rowKey:"order_id",columns:O,dataSource:B,loading:!s&&g,rowStyle:{h:"80px",cursor:"pointer"}}),(p==null?void 0:p.length)>T&&e.jsx(I,{children:e.jsx(Ae,{total:C,size:T,currentPage:S,onChange:u=>{_(u)}})})]})]})}const on=t=>[{title:e.jsx(f,{children:"Order"}),key:"order",thConfig:{w:"20%"},render:o=>e.jsx(bs,{imgSize:"28px",info:o,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:o=>e.jsx(ys,{info:o,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:o=>e.jsx(ws,{info:o,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:o=>e.jsx(Cs,{info:o,isProfile:!0})},!t&&{title:e.jsx(f,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:o=>e.jsx(_s,{historyInfo:o,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(f,{textAlign:"right",children:"Actions"}),key:"actions",thConfig:{w:"8%"},render:o=>e.jsx(Ss,{orderInfo:o,isProfile:!0,isOpenOrder:t})}].filter(Boolean);function an(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[i,o]=d.useState("limitOrders");return e.jsx(te,{p:"0 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{align:"flex-start",gap:"20px",children:[e.jsx(K,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Me,{type:"tab",currentTab:i,tabs:t,onTabChange:l=>o(l.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),i==="limitOrders"&&e.jsx(nn,{}),i==="dca"&&e.jsx(sn,{})]})})}function ln({handleRefresh:t,totalValue:i,isLoading:o}){const{isApp:l}=Q(),{currentAccount:r,accounts:a}=X(),{isShowProfileAssets:s,setIsShowProfileAssets:n}=at(),[c,x]=d.useState(!1),{onClose:g}=Ye();return e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsxs(v,{gap:"4px",children:[e.jsx(f,{lineHeight:"20px",fontSize:{base:"14px",lg:"16px"},color:"text_caption",children:"Total Value"}),e.jsx(ce,{showTooltip:!l,placement:"bottom-end",tooltip:e.jsx(f,{fontSize:"12px",children:s?"Hide Value":"Show Value"}),children:e.jsx(I,{children:e.jsx(N,{xlinkHref:s?"#icon-hide_eyes":"#icon-show_eyes",svgFill:"text_caption",onClick:()=>n(!s)})})})]}),e.jsxs(v,{children:[e.jsxs(v,{p:"6px 5px 6px 3px",h:"32px",justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{bg:"button_outline_hov_bg",svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{x(!0)},children:[e.jsx(N,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),e.jsx(f,{children:"Transactions"})]}),e.jsx(ks,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:"32px",h:"32px",isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),e.jsx(v,{w:"100%",justify:"space-between",mt:"2px",children:e.jsx(ae,{isLoaded:!o,h:"22px",children:e.jsx(f,{mt:"-6px",letterSpacing:"1px",fontSize:"32px",lineHeight:"32px",color:"text_caption",fontWeight:"500",children:ht(Z(i,2),s)})})}),a.length>1&&e.jsx(Bt,{currentAccount:r,accounts:a,onClose:g,isProfile:!0}),c&&e.jsx(Et,{isOpen:c,onClose:()=>x(!1)})]})}function rn({tabList:t,tabData:i,onClickTab:o}){return e.jsx(R,{w:"100%",children:t==null?void 0:t.map(l=>e.jsx(cn,{imgUrl:l.activeImgUrl,value:i[l.value].totalValue,title:l.title,url:l.route,tooltip:l==null?void 0:l.tooltip,onClick:()=>o(l.value),isLoading:i[l.value].isLoading},l.title))})}const cn=({imgUrl:t,value:i,title:o,url:l,tooltip:r,isLoading:a,onClick:s})=>(Be(),e.jsxs(v,{bg:"bg_secondary",border:"1px solid",borderColor:"border",borderRadius:"16px",w:"100%",justify:"space-between",p:"16px 12px",onClick:s,children:[e.jsxs(v,{gap:"12px",children:[e.jsx(it,{w:"36px",h:"36px",src:t}),e.jsxs(R,{gap:"2px",align:"flex-start",children:[e.jsx(ae,{h:"24px",isLoaded:!a,children:e.jsx(f,{h:"24px",lineHeight:"24px",fontSize:"20px",fontWeight:"500",color:"text_caption",children:i})}),e.jsxs(v,{gap:"4px",children:[e.jsx(f,{fontSize:"12px",h:"15px",lineHeight:"15px",children:o}),r&&e.jsx(ce,{tooltip:r,children:e.jsx(K,{children:e.jsx(N,{xlinkHref:"#icon-icon_tips"})})})]})]})]}),e.jsx(I,{bg:"primary_opacity.15",w:"24px",h:"24px",borderRadius:"50%",children:e.jsx(N,{xlinkHref:"#icon-icon_ascending",transform:"rotate(90deg)",svgFill:"primary_blue",fontSize:"20px"})})]}));function pn({tabList:t,activeTab:i,tabData:o,onClickTab:l}){return e.jsx(v,{w:"100%",mt:"12px",gap:"12px",children:t.map(r=>{var a,s;return e.jsxs(te,{w:"25%",p:"28px 16px",bgImage:i===r.value?"url(/images/tab_active.png)":"none",bgSize:"100% 100%",borderRadius:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",bg:"bg_secondary",backdropFilter:"blur(20px)",borderColor:i===r.value?"primary":"border",onClick:()=>l(r.value),_hover:{bgImage:"url(/images/tab_active.png)",bgSize:"100% 100%",borderColor:"primary",img:{opacity:"0.8"}},children:[e.jsxs(R,{align:"flex-start",gap:"10px",children:[e.jsx(f,{fontSize:"14px",color:"text_caption",children:r.title}),e.jsx(v,{h:"22px",children:e.jsx(ie,{size:"l",children:e.jsx(ce,{placement:"top",tooltip:e.jsx(f,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:r.tooltip}),showTooltip:r.showTooltip,children:e.jsx(I,{as:"button",children:e.jsx(ae,{isLoaded:!((a=o[r.value])!=null&&a.isLoading),children:e.jsx(f,{fontSize:"22px",fontWeight:"500",color:"text_caption",children:(s=o[r.value])==null?void 0:s.totalValue})})})})})})]}),e.jsx(it,{w:"38px",h:"38px",src:r.activeImgUrl,opacity:i===r.value?"0.8":"0.4"})]},r.value)})})}function Qe(t){const{isApp:i}=Q();return i?e.jsx(rn,{...t}):e.jsx(pn,{...t})}const dn=(t,i)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:o=>t({isCoinHoldingLoading:o}),setCoinHoldingList:o=>t({coinHoldingList:o}),isCoinPriceLoading:!0,setIsCoinPriceLoading:o=>t({isCoinPriceLoading:o}),holdingsTotalUsd:"0",setHoldingsTotalUsd:o=>t({holdingsTotalUsd:o}),unknownCoinCount:0,setUnknownCoinCount:o=>t({unknownCoinCount:o})}),Oe=rt(dn);function ft(){const{currentAccount:t}=X(),{fetchAccountBalance:i}=Ps(),{coinHoldingList:o,setCoinHoldingList:l,setIsCoinHoldingLoading:r,setIsCoinPriceLoading:a,setHoldingsTotalUsd:s,isCoinPriceLoading:n,setUnknownCoinCount:c}=Oe(),{getTokenListInfo:x}=xt(),{getTokenPrice:g}=ue(),{refreshCoinPriceInfo:p}=Ue(),b=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{b.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const y=async()=>{const m=b.current;if(m){r(!0);const C=await i(m,!0);if(C){const h=await x(C.filter(T=>F(T.totalBalance).gt(0)).map(T=>T.coinType));if(!h)throw r(!1),l([]),new Error("get token list info error");const S=[];let _=0;return C.forEach(T=>{const O=h.get(T.coinType);if(O){const u=T.totalBalance,A=de(u,O.decimals).toString(),k=J(A,void 0,void 0,Tt.ROUND_DOWN).toString(),z={balance:u,balance_format:A,balance_display:k,balance_usd:void 0,coin:O,coin_type:O==null?void 0:O.coin_type,price:"",price_diff_24:""};S.push(z),O.is_verified||_++}}),P(S),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",m),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",b.current),m===b.current&&(l(S),c(_),w([...S])),r(!1),S}}else r(!1),l([]);return[]},w=async m=>{a(!0);try{await p(m.map(C=>C.coin.coin_type),!0)}catch(C){console.error("fetch coin price info error",C)}finally{a(!1)}},P=m=>{m.map(C=>{const{coin:h}=C,S=g(h.coin_type);S&&(C.price=S.price,C.price_diff_24=S.price_change||"",C.balance_usd=F(C.balance_format).mul(S.price).toString())})},L=async m=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:m,coinHoldingList:o,currentAccount:t}),t){const{search:C,current_sort:h,current_sort_order:S,is_show_unknown:_=!1,is_hide_small_balance:T=!0}=m;let O=[];if(_?O.push(...o):O=o.filter(u=>u.coin.is_verified),C){const u=C.toLowerCase();O=O.filter(A=>A.coin.coin_type.toLowerCase().includes(u)||A.coin.symbol.toLowerCase().includes(u)||A.coin.name.toLowerCase().includes(u))}return P(O),T&&!n&&(O=O.filter(u=>u.balance_usd===void 0||F(u.balance_usd).gt(.01))),O.sort((u,A)=>{if(h==="balance"){const k=F(u.balance_format).cmp(F(A.balance_format));if(k!==0)return S==="desc"?-k:k}if(h==="value"){const k=F(u.balance_usd).cmp(F(A.balance_usd));return k!==0?S==="desc"?-k:k:F(A.balance_format).cmp(F(u.balance_format))}if(h==="price"){const k=F(u.price||"0").cmp(F(A.price||"0"));return k!==0?S==="desc"?-k:k:F(A.balance_format).cmp(F(u.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",O),O}return[]};return d.useEffect(()=>{P(o);const m=o.reduce((C,h)=>C+Number(h.balance_usd||0),0);s(m.toString())},[o,n]),{getFilterCoinHoldingList:L,fetchCoinHoldingList:y,resetUserData:()=>{l([]),s("0"),c(0)}}}function un({inputValue:t,changeInputValue:i}){const o=d.useRef(null),[l,r]=d.useState(!1);return Q(),e.jsxs(jt,{w:l?"203px":"32px",h:"32px",transition:"width 0.1s ease",_hover:{bg:"bg_secondary"},border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(mt,{top:"calc(50% - 10px)",left:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:a=>{var s;(s=o.current)==null||s.focus(),r(!0)}})}),e.jsx(bt,{bg:"background",ref:o,h:"30px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:a=>{i(a.target.value)},onFocus:()=>{r(!0)},onBlur:()=>{i(""),r(!1)},fontWeight:"500",textAlign:"left",fontSize:"12px",pr:l?"28px":"8px",pl:l?"28px":"8px"}),t?e.jsx(yt,{right:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_close",onMouseDown:a=>a.preventDefault(),onClick:a=>{i(""),setTimeout(()=>{var s;(s=o.current)==null||s.focus()},0)}})}):null]})}function xn({inputValue:t,changeInputValue:i,isShowUnknownCoin:o,handleIsShowUnknownCoin:l,isHideLowAsset:r,handleIsHideLowAsset:a,unknownCoinCount:s}){return Q(),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(f,{fontSize:"16px",color:"text_caption",children:"Wallet Holdings"}),e.jsxs(v,{children:[e.jsx(un,{inputValue:t,changeInputValue:i}),e.jsx(te,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsxs(f,{whiteSpace:"nowrap",fontSize:"12px",children:["Show Unknown Coin (",s,")"]}),e.jsx(Ne,{isChecked:o,onChange:l})]})}),e.jsx(te,{w:"unset",borderRadius:"8px",p:"0px 8px",h:"32px",bg:"background",children:e.jsxs(v,{h:"100%",justify:"space-between",children:[e.jsx(f,{whiteSpace:"nowrap",fontSize:"12px",children:"Hide Low Asset"}),e.jsx(Ne,{isChecked:r,onChange:a})]})})]})]})}function gn(){const{isApp:t}=Q(),{getFilterCoinHoldingList:i}=ft(),{isCoinHoldingLoading:o,isCoinPriceLoading:l,unknownCoinCount:r}=Oe(),{isAutoRefresh:a}=Y(),[s,n]=d.useState([]),[c,x]=d.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[g,p]=d.useState(!1),[b,y]=d.useState(!0),[w,P]=d.useState("desc"),[L,B]=d.useState(Fe[2]),m=j=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",j),a||z(1),x(j),i(j).then(n)},C=j=>{m({...c,search:j})},h=j=>{const U=(j==null?void 0:j.value)===(L==null?void 0:L.value),D=t||!U?"desc":w==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",D,j),B(j),P(D),m({...c,current_sort:j.value,current_sort_order:D})};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",o,l,s),!o&&!l&&m(c)},[o,l]);const S=Be(),_=j=>{S(`/swap/${j}/''`)},[T,O]=d.useState([]),[u,A]=d.useState(0),[k,z]=d.useState(1),E=10;d.useEffect(()=>{if((s==null?void 0:s.length)>0){const j=(k-1)*E;(s==null?void 0:s.length)<=j&&z(1)}},[s]),d.useEffect(()=>{if((s==null?void 0:s.length)>0){A(s==null?void 0:s.length);const j=(k-1)*E,U=j+E;console.log("ðŸš€ ~ useEffect ~ start:",k,s.slice(0,U),j,U),(s==null?void 0:s.length)>j&&O(s.slice(j,U))}else O([])},[k,s]);const M=(j,U)=>{j==="is_show_unknown"&&p(U),j==="is_hide_small_balance"&&y(U)},H=j=>{M("is_show_unknown",j.target.checked),j.target.checked||m({...c,is_show_unknown:!1}),j.target.checked&&!g&&(M("is_hide_small_balance",!1),m({...c,is_show_unknown:!0,is_hide_small_balance:!1}))},V=j=>{M("is_hide_small_balance",j.target.checked),m({...c,is_hide_small_balance:j.target.checked})};return e.jsx(te,{p:"14px 16px 16px",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(xn,{unknownCoinCount:r,inputValue:c.search||"",changeInputValue:C,isShowUnknownCoin:g,handleIsShowUnknownCoin:H,isHideLowAsset:b,handleIsHideLowAsset:V}),e.jsx(K,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(R,{w:"100%",position:"relative",gap:"20px",children:[(!o&&!l||a)&&(s==null?void 0:s.length)===0?e.jsx(se,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsxs(R,{w:"100%",gap:"4px",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(f,{fontSize:"24px",color:"text_caption",children:"Tokens"}),e.jsx(Es,{sortText:"Sort by",minW:"180px",currentSort:L,sortByList:Fe,onSortByChange:h,xlinkHref:w==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>P(j=>j==="desc"?"asc":"desc")})]}),e.jsx(Pe,{rowKey:"coin_type",columns:Ie(w,L,h,_,!a&&l,s==null?void 0:s.length),dataSource:T,loading:!a&&(o||l),itemSkeletonLength:5,itemHeight:"30px",onRowClick:j=>{_(j==null?void 0:j.coin_type)}})]}):e.jsx(Le,{rowKey:"coin_type",columns:Ie(w,L,h,_,!a&&l,s==null?void 0:s.length),dataSource:T,skeletonLength:5,loading:!a&&(o||l),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:j=>{_(j==null?void 0:j.coin_type)}}),(s==null?void 0:s.length)>E&&e.jsx(I,{children:e.jsx(Ae,{total:u,size:E,currentPage:k,onChange:j=>{z(j)}})})]})]})})}const Fe=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],He=Object.fromEntries(Fe.map(t=>[t.value,t])),Ie=(t,i,o,l,r,a)=>[{title:e.jsxs(f,{children:["Token(",a,")"]}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:s})=>e.jsx(gt,{haveTooltip:!0,token:s,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(he,{labelInfo:He.balance,sortRule:t,sortBy:i,clickSort:o}),key:"balance",thConfig:{w:"25%"},render:({coin:s,balance_display:n})=>e.jsx(v,{justify:"flex-end",children:e.jsx(ie,{children:e.jsxs(f,{color:"text_caption",children:[n," ",kt(s==null?void 0:s.symbol,10)]})})})},{title:e.jsx(he,{labelInfo:He.price,sortRule:t,sortBy:i,clickSort:o}),key:"price",thConfig:{w:"25%"},render:({price:s,price_diff_24:n})=>{const c=F(n).gt(0);return e.jsx(v,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!r,children:e.jsx(v,{gap:"2px",children:s===void 0||s===""?e.jsx(f,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(f,{color:"text_caption",children:["$",ct(s)]}),e.jsxs(f,{color:Number(n)===0?"text_caption":c?"primary_green":"primary_red",children:["(",c?"+":F(n).gt(-1e-4)&&F(n).lt(0)?"-":"",F(n).gt(-1e-4)&&F(n).lt(1e-4)?"0%":Pt(F(n).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(he,{labelInfo:He.value,sortRule:t,sortBy:i,clickSort:o}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:s})=>(console.log(s,"balance_usd"),e.jsx(v,{justify:"flex-end",children:e.jsx(ae,{isLoaded:!r,children:e.jsx(ie,{children:e.jsx(f,{color:"text_caption",children:s===void 0?"--":Z(s,2)})})})}))},{title:e.jsx(f,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:s=>e.jsx(q,{w:{base:"calc(100% - 32px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{l(s==null?void 0:s.coin_type)},children:"Swap"})}],hn=(t,i)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:o=>t({isXCetusModalOpen:o}),isXCetusLoading:!1,setIsXCetusLoading:o=>t({isXCetusLoading:o}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:o=>t({currentXCetusTab:o})}),Re=rt(hn),fn={cetus:{title:"CETUS Holdings",imgUrl:ee.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:ee.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function We({type:t,amount:i,amountUSD:o,isLoading:l,children:r}){const{title:a,imgUrl:s,bgUrl:n}=fn[t];return e.jsx(te,{flex:"1",bg:`center / cover no-repeat url(${n})`,p:"20px",borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(R,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(v,{children:[e.jsx(fe,{imageUrl:s,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(f,{children:a})]}),e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(ie,{children:e.jsxs(R,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(ae,{isLoaded:!l,h:"24px",children:e.jsx(f,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:i})}),o!==void 0&&e.jsx(ae,{isLoaded:!l,h:"17px",children:e.jsxs(f,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ct(o,2)]})})]})}),r]})]})})}function jn(){const{currentAccount:t}=X(),{balanceInfo:i}=Vs(ee.cetus_coin),{getTokenAmountValue:o}=ue(),{coinPriceObj:l}=ke(),r=d.useMemo(()=>o(ee.cetus_coin.coin_type,de((i==null?void 0:i.balance)||"0",ee.cetus_coin.decimals)).toString(),[i==null?void 0:i.balance,t==null?void 0:t.address,l]),{setCurrentXCetusTab:a,setIsXCetusModalOpen:s}=Re(),n=()=>{s(!0),a("Get xCETUS")},{veNFT:c,veNFTLoading:x,lockCetusListLoading:g}=ne();return e.jsx(We,{type:"cetus",amount:t?(i==null?void 0:i.balanceFormat)||"0":"--",amountUSD:r,isLoading:(g||x)&&c!==void 0,children:e.jsx(q,{onClick:n,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Convert to xCETUS"})})}function mn(){const{lockCetusList:t,lockCetusListLoading:i}=ne(),[o,l]=d.useState([]),[r,a]=d.useState(0),[s,n]=d.useState(1),c=10;return d.useEffect(()=>{if((t==null?void 0:t.length)>0){const x=(s-1)*c;(t==null?void 0:t.length)<=x&&n(1)}},[t]),d.useEffect(()=>{if((t==null?void 0:t.length)>0){a(t==null?void 0:t.length);const x=(s-1)*c,g=x+c;console.log("ðŸš€ ~ useEffect ~ start:",s,t.slice(0,g),x,g),(t==null?void 0:t.length)>x&&l(t.slice(x,g))}},[s,t]),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(wt,{orientation:"horizontal"}),e.jsxs(R,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(f,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(R,{w:"100%",gap:"12px",children:o==null?void 0:o.map(x=>e.jsx(bn,{order:x},x==null?void 0:x.id))}),(t==null?void 0:t.length)>c&&e.jsx(I,{w:"100%",children:e.jsx(Ae,{total:r,size:c,currentPage:s,onChange:x=>{n(x)}})})]})]})}const bn=({order:t})=>{const[i,o]=d.useState(!je.isLocked(t));d.useEffect(()=>{o(!je.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:l,handleCancelOrder:r}=Ls(),{claimOrderLoading:a,handleClaimOrder:s}=As(),{days:n,hours:c,minutes:x,seconds:g}=Os(t.locked_until_time*1e3,()=>{o(!0)},"days"),p=b=>{b?s(t.id):r(t)};return e.jsxs(v,{justify:"space-between",w:"100%",h:"80px",p:"0 20px",bg:"bg_nine",borderRadius:"12px",children:[i?e.jsxs(v,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(f,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(v,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(K,{as:"div",children:[e.jsxs(f,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(f,{as:"span",color:"text_caption",fontSize:"13px",children:[n,"d : ",c,"h : ",x,"m : ",g,"s"]})]})]}),e.jsxs(v,{gap:"12px",children:[e.jsx(Rs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx(q,{onClick:()=>{l||a||p(i)},variant:"unstyled",border:"none",h:{base:"40px",lg:"28px"},w:{base:"168px",lg:"80px"},borderRadius:{base:"12px",lg:"8px"},fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:l||a,color:i?"background":"primary_gray",bg:i?"primary":"card_bg",_hover:{bg:i?"primary_hover":"button_ghost_hov_bg",color:i?"background":"text_caption"},children:i?"Claim":"Cancel"})]})]})};function yn({totalRewardValue:t,rewardList:i,summaryRewardList:o}){const{currentAccount:l}=X(),{veNFTLoading:r}=ne(),{claimRewardLoading:a,handleClaimReward:s}=Ds(),n=()=>{a||s(i)};return Q(),e.jsx(We,{type:"rewards",amount:l?F(t).gt("0")?e.jsx(ce,{tooltip:e.jsx(R,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:o==null?void 0:o.map(c=>e.jsxs(v,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(gt,{coinType:c.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(v,{gap:"4px",children:[e.jsx(f,{fontSize:"12px",color:"text_caption",children:J(c==null?void 0:c.amount,6)}),e.jsxs(f,{fontSize:"12px",children:["(",Z(c==null?void 0:c.value,2),")"]})]})]},c.coin_type))}),children:e.jsx(f,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Z(t,2)})}):e.jsx(f,{textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:Z(t,2)}):"--",isLoading:r,children:o.length>0&&e.jsx(q,{onClick:n,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Claim"})})}function wn({availableXCetusAmount:t}){const{currentAccount:i}=X(),{veNFT:o,veNFTLoading:l,lockCetusListLoading:r}=ne(),{getTokenAmountValue:a}=ue(),{coinPriceObj:s}=ke(),n=d.useMemo(()=>a(ee.cetus_coin.coin_type,de(t||"0",ee.x_cetus_coin.decimals)).toString(),[t,i==null?void 0:i.address,s]),{setCurrentXCetusTab:c,setIsXCetusModalOpen:x}=Re(),g=()=>{x(!0),c("Redeem CETUS")},p=(r||l)&&o!==void 0;return e.jsx(We,{type:"xcetus",amount:i?J(de(t||"0",9),9).toString():"--",amountUSD:n,isLoading:p,children:e.jsx(q,{onClick:g,variant:"outline",color:"primary",flex:"0 0 120px",fontSize:"14px",fontWeight:"500",children:"Redeem"})})}const _e=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function Cn({isOpen:t,onClose:i,availableXCetusAmount:o}){const{currentXCetusTab:l,setCurrentXCetusTab:r}=Re(),[a,s]=d.useState("#icon-a-icon_trade"),n=()=>{s("#icon-icon_swap1")},c=()=>{s("#icon-a-icon_trade")},x=()=>{var p;const g=(p=_e==null?void 0:_e.find(b=>(b==null?void 0:b.value)!==l))==null?void 0:p.value;g&&r(g)};return e.jsxs(Ze,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:i,isCentered:!0,children:[e.jsx(et,{}),e.jsxs(tt,{children:[e.jsx(st,{p:"0 16px",children:e.jsx(K,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(me,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:_e,currentTab:l,handleChangeTab:g=>{r(g==null?void 0:g.value)}})})}),e.jsx(nt,{}),e.jsxs(ot,{p:"20px 16px 16px",children:[l==="Get xCETUS"&&e.jsx(Hs,{onClose:i,availableXCetusAmount:o,onIconClick:x,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:n,onMouseLeave:c}}),l==="Redeem CETUS"&&e.jsx(Fs,{onClose:i,availableXCetusAmount:de(o,9),onIconClick:x,iconParams:{xlinkHref:a,svgFill:"text_caption",transform:a==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:a==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:n,onMouseLeave:c}})]})]})]})}function _n(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:i}=Re(),{availableXCetusAmount:o,totalRewardValue:l,rewardList:r,summaryRewardList:a}=zs();return e.jsx(te,{w:"100%",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",children:e.jsxs(R,{w:"100%",gap:"16px",children:[e.jsxs(v,{w:"100%",gap:"10px",children:[e.jsx(wn,{availableXCetusAmount:o}),e.jsx(jn,{}),e.jsx(yn,{totalRewardValue:l,rewardList:r,summaryRewardList:a})]}),e.jsx(mn,{}),t&&e.jsx(Cn,{isOpen:t,onClose:()=>i(!1),availableXCetusAmount:o})]})})}function Sn(){const{currentAccount:t}=X(),{orderListLoading:i,myOrderList:o}=ye(),{isAutoRefresh:l,dcaOrderListLoading:r,dcaActiveOrderList:a}=Y(),{getTokenAmountValue:s,coinPriceObj:n}=ue(),c=d.useMemo(()=>{let p=F(0);if(l||!i)return(o==null?void 0:o.length)>0&&(t!=null&&t.address)?(o.forEach(b=>{const{pay_coin:y,target_coin:w,un_claimed_amount:P,remaining_amount:L}=b,B=s(y.coin_type,L),m=s(w.coin_type,P);p=F(p).plus(B).plus(m),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",p.toString())}),p.toString()):"0"},[l,o,t==null?void 0:t.address,i,n]),x=d.useMemo(()=>{let p=F(0);if(l||!r)return(a==null?void 0:a.length)>0&&(t!=null&&t.address)?(a.forEach(b=>{const{inBalance:y,inCoin:w,outBalance:P,outCoin:L}=b,B=s(w.coin_type,y),m=s(L.coin_type,P);p=F(p).plus(B).plus(m),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",p.toString())}),p):"0"},[l,a,t==null?void 0:t.address,r,n]),g=d.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",x,c),x&&c){let p=F(0);return p=F(p).plus(x).plus(c),p.toString()}return"--"},[x,c]);return{limitTotalTvl:c,dcaTotalTvl:x,orderTotalTvl:g}}function vn(){const{currentAccount:t}=X(),{isAutoRefresh:i}=Y(),{veNFT:o,veNFTLoading:l,lockCetusListLoading:r}=ne(),{getTokenAmountValue:a}=ue(),{coinPriceObj:s}=ke();return{xCetusTotalTvl:d.useMemo(()=>{if(i||!l&&!r)return t!=null&&t.address&&o?a(ee.cetus_coin.coin_type,de(o==null?void 0:o.xcetus_balance,ee.cetus_coin.decimals)).toString():"0"},[i,o==null?void 0:o.xcetus_balance,r,l,t==null?void 0:t.address,s])}}const Tn="fetch-coin-holding-list",kn="fetch-owner-nft",Pn="fetch-active-order-list",Ln="fetch-xcetus-base-info",An="fetch-vaults-position-list";function On(){const{currentAccount:t}=X(),{getTokenListInfo:i}=xt(),{getLimitUserIndexer:o,getDcaUserIndexer:l}=Bs(),{setOrderListLoading:r,setMyOrderList:a}=ye(),{setDcaOrderListLoading:s,setDcaActiveOrderList:n,setDcaPastOrderList:c}=Y(),{refreshCoinPriceInfo:x}=Ue(),{buildDcaOrderList:g}=hs(),p=re("limit"),b=re("dca"),{formatLimitOrderList:y}=vs(),w=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{w.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const P=async()=>{if(t){r(!0);const C=await o(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",C),C)try{return(await p.FullClient.getDynamicFieldsByPage(C)).data.map(_=>_.name.value)}catch(h){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",h)}}return[]},L=async()=>{if(t){s(!0);const C=await l(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",C),C)try{return(await b.FullClient.getDynamicFieldsByPage(C)).data.map(_=>_.name.value)}catch(h){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",h)}}return[]};return{fetchActiveOrderList:async()=>{try{const C=await P(),h=await L(),S=await p.FullClient.batchGetObjects([...C,...h],{showType:!0,showContent:!0}),_=S.filter(H=>{var V,j;return(j=(V=H.data)==null?void 0:V.type)==null?void 0:j.includes("limit_order::LimitOrder")}),T=S.filter(H=>{var V,j;return(j=(V=H.data)==null?void 0:V.type)==null?void 0:j.includes("order::Order")}),u=_.map(H=>Lt.buildLimitOrderInfo(H)).filter(H=>H!==void 0).filter(H=>H.status===$e.PartialCompleted||H.status===$e.Running),A=T.map(H=>{var D,$,W,G,pe,we,ge,Ce;const V=ve(((D=H.data)==null?void 0:D.type)||""),j=V.type_arguments[0],U=V.type_arguments[1];return{in_coin_type:j,out_coin_type:U,...(W=($=H.data)==null?void 0:$.content)==null?void 0:W.fields,id:(ge=(we=(pe=(G=H.data)==null?void 0:G.content)==null?void 0:pe.fields)==null?void 0:we.id)==null?void 0:ge.id,version:(Ce=H.data)==null?void 0:Ce.version}}),k=new Set;for(const H of u)k.add(H.pay_coin_type),k.add(H.target_coin_type);for(const H of A)k.add(H.in_coin_type),k.add(H.out_coin_type);await i(Array.from(k));const z=await y(u);a(z);const{activeResult:E,pastResult:M}=await g(A);w.current===(t==null?void 0:t.address)&&(n(E),c(M),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",z),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",A)),x(Array.from(k))}catch(C){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",C)}finally{r(!1),s(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),a([]),n([]),c([])}}}function Rn(){const{currentAccount:t}=X(),i=re("clmm"),o=re("xcetus"),{buildFarmsPositionType:l,buildBurnPositionType:r}=$t(),{setPosBaseList:a,setFullRangePosBaseList:s,setPosBaseListLoading:n}=xe(),{setVeNFT:c,setVeNFTLoading:x,setLockCetusList:g,clearData:p,setLockCetusListLoading:b,setAvailableXCetusAmount:y}=ne(),{formatPosBaseList:w}=Gt(),P=d.useRef(t==null?void 0:t.address);return d.useEffect(()=>{P.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const m=P.current;if(m){n(!0),x(!0);const C=await i.FullClient.getOwnedObjectsByPage(m,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:At.clmm_pool.package_id},{StructType:l},{StructType:r},{StructType:Us},{StructType:Ms}]}});let h=await w(C);a(h),n(!1),(h==null?void 0:h.length)==0&&s([]);const S=Ws(C.data);if(S&&m===P.current){c(S,m);const _=await Ns(C.data,o);_.sort((T,O)=>T.locked_until_time-O.locked_until_time),console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:_,veNFT:S,availableXCetusAmount:je.getAvailableXCetus(S,_)}),g(_),y(je.getAvailableXCetus(S,_))}else b(!1);return{veNFT:S,posBaseList:h}}}catch(m){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",m),m instanceof TypeError&&(n(!1),a([]))}finally{n(!1),b(!1),x(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{a([]),p()}}}function Dn(){const t=re("farms"),i=re("clmm"),{getPosApiPoolData:o}=qt(),{getPosPoolsOriginalObj:l,getPosPoolsRelatedData:r}=Kt(),{getPosLiquidityData:a}=Qt(),{setPosLiquidityData:s,setFarmsPosRewardsData:n,setFarmsPosRewardsDataLoading:c,setPosRewardsData:x,setPosRewardsDataLoading:g,setPosFeeData:p,setPosFeeDataLoading:b}=xe(),{formatFarmsRewardsData:y}=It(),{formatPosRewardsData:w}=Yt(),{formatPosFeeData:P}=Jt(),{refreshCoinPriceInfo:L}=Ue(),B=async h=>{var O;const S=h.filter(u=>u.posType==="farms"&&u.farmsPool),_=await l(h);if(r(h,_),((O=Object.keys(_))==null?void 0:O.length)===0)throw s({}),new Error("No pool data found");o(h),a(h,_);const T=new Ot;S.length>0&&S.forEach(u=>{t.Farms.buildCalculateFarmingReward({pool_id:u.farmsPool,position_nft_id:u.id},T)}),h.forEach(u=>{i.Position.buildFetchPosFee({pool_id:u.clmmPool,position_id:u.posId,coin_type_a:u.coinTypeA,coin_type_b:u.coinTypeB},T)}),h.filter(u=>u.posType!=="farms").forEach(u=>{var k;const A=_[u.clmmPool];i.Rewarder.buildFetchPosReward({pool_id:u.clmmPool,position_id:u.posId,coin_type_a:u.coinTypeA,coin_type_b:u.coinTypeB,rewarder_types:(k=A.rewarder_infos)==null?void 0:k.map(z=>z.coinAddress)},T)});try{c(!0),g(!0),b(!0);const u=await i.FullClient.devInspectTransactionBlock({transactionBlock:T,sender:Rt("0x0")}),A=t.Farms.parsedPosRewardData(u),k=i.Rewarder.parsedPosRewardData(u),z=i.Position.parsedPosFeeData(u);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:A,clmmRewardData:k,clmmFeeData:z});const E=await y(A);n(E);const M=await w(Object.values(k).map(V=>{const j=_[h.find(U=>U.posId===V.position_id).clmmPool];return{poolAddress:j.pool_address,positionId:V.position_id,rewarderAmountOwed:V.rewarder_amount.map((U,D)=>({coin_address:j.rewarder_infos[D].coinAddress,amount_owed:new Dt(U)}))}}));x(M);const H=await P(Object.values(z).map(V=>({position_id:V.position_id,fee_owned_a:V.fee_owned_a,fee_owned_b:V.fee_owned_b})),h);p(H),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:H,posRewardsData:M,posFarmsRewardsObj:E}),m(h,M,E)}catch(u){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",u)}finally{c(!1),g(!1),b(!1)}},m=async(h,S,_)=>{console.log("ðŸš€ ~ fetchTokenPrice ~ posRewardsData:",h,S);const T=[];if(h.length>0){h.map(u=>{T.push(ve(u==null?void 0:u.coinTypeA).full_address),T.push(ve(u==null?void 0:u.coinTypeB).full_address);const A=S[u==null?void 0:u.posId]||[],k=_[u==null?void 0:u.id]||[],z=A.concat(k);z==null||z.map(E=>{var M;Ht(E==null?void 0:E.display_amount_owed).gt(0)&&T.push(ve((M=E==null?void 0:E.token)==null?void 0:M.coin_type).full_address)})}),console.log("ðŸš€ ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(T)));const O=Array.from(new Set(T));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",O),L(O)}};return{fetchPosRelatedData:B,resetUserData:()=>{s({}),n({}),x({}),p({})}}}function Hn(){const{getVaultsTokenList:t,getVaultsLpTokenList:i}=Ve(),{getVaultsContractInfo:o}=Wt(),{getVaultsPosition:l}=Nt(),{setVaultsPositionLoading:r,clearVaultsPositionObj:a}=be(),{setVaultListLoading:s}=Ee(),{getVaultPoolList:n}=Xt();return{fetchVaultsPositionList:async()=>{r(!0),s(!0);const g=await n();console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:",g),t(g),i(g);const{lstVaultContractInfoObj:p,haedalVaultContractInfoObj:b,allClmmPoolContractInfoObj:y}=await o(g);l(g,p,b,y,!0)},resetUserData:()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileVaults.ts:39 ~ resetUserData ~ clearVaultsPositionObj:",a),a()}}}function Fn(){const{currentAccount:t}=X(),{setXCetusManager:i,setDividendManager:o}=ne(),l=re("xcetus");return{fetchXCetusBaseInfo:async a=>{try{const{xcetus:s,xcetus_dividends:n}=Ft,{dividend_manager_id:c}=Ge(n),{xcetus_manager_id:x}=Ge(s),g=await l.FullClient.batchGetObjects([x,c],{showType:!0,showContent:!0}),p=g.find(y=>{var w,P;return(P=(w=y.data)==null?void 0:w.type)==null?void 0:P.includes("xcetus::XcetusManager")});if(p){const y=qe(p),w={id:y.id.id,index:Number(y.index),has_venft:{handle:y.has_venft.fields.id.id,size:y.has_venft.fields.size},nfts:{handle:y.nfts.fields.id.id,size:y.nfts.fields.size},total_locked:y.total_locked,treasury:y.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",w),i(w)}const b=g.find(y=>{var w,P;return(P=(w=y.data)==null?void 0:w.type)==null?void 0:P.includes("dividend::DividendManager")});if(b){const y=qe(b),w=je.buildDividendManager(y);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",w),l.updateCache(`${c}_getDividendManager`,w),o(w)}}catch(s){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",s)}}}}function zn(t){const{currentAccount:i}=X(),{fetchCoinHoldingList:o,resetUserData:l}=ft(),{fetchPosRelatedData:r,resetUserData:a}=Dn(),{fetchActiveOrderList:s,resetUserData:n}=On(),{fetchVaultsPositionList:c,resetUserData:x}=Hn(),{setAutoRefreshCount:g}=Y(),{fetchOwnerNFT:p,resetUserData:b}=Rn(),{fetchXCetusBaseInfo:y}=Fn(),{addTask:w,removeTask:P}=Xs(),[L,B]=d.useState([]),m=d.useRef(i),{setOrderListLoading:C}=ye(),{setLockCetusListLoading:h}=ne(),{setPosBaseListLoading:S}=xe(),{setIsCoinHoldingLoading:_}=Oe(),{setVaultListLoading:T}=Ee(),{setVaultsPositionLoading:O}=be(),u=()=>{l(),a(),n(),b(),x()};d.useEffect(()=>{var j,U;i?((j=m.current)!=null&&j.address&&((U=m.current)==null?void 0:U.address)!==(i==null?void 0:i.address)&&(g(!1),u(),L.forEach(D=>{P(D.id)})),H()):(u(),L.forEach(D=>{P(D.id)})),m.current=i},[i==null?void 0:i.address]);const A={id:Tn,run:o},k={id:kn,run:p,onSuccess:j=>{const{posBaseList:U}=j;r(U)}},z={id:Ln,run:y},E={id:Pn,run:s},M={id:An,run:c},H=()=>{const j=[];C(!0),h(!0),S(!0),_(!0),O(!0),T(!0),t==="wallet"?j.push(A,k,M,E,z):t==="liquidity"?j.push(k,M,A,E,z):t==="orders"?j.push(E,A,k,M,z):j.push(k,M,z,A,E),B(j),j.forEach(U=>{w(U)})};return{refreshTask:()=>{i&&(L.forEach(j=>{P(j.id)}),H())}}}const Se=t=>t?Z(t,2):"$--",Bn=(...t)=>t.reduce((i,o)=>i.plus(o&&+o?o:0),F(0)).toString();function ai(){const{tab:t}=is(),{currentAccount:i,onWalletModal:o}=X(),l=Be(),{posBaseListLoading:r,posLiquidityDataLoading:a}=xe(),{holdingsTotalUsd:s,isCoinPriceLoading:n,isCoinHoldingLoading:c}=Oe(),{liquidityTotalTvl:x}=ss(),{orderTotalTvl:g}=Sn(),{orderListLoading:p}=ye(),{isAutoRefresh:b,dcaOrderListLoading:y,setAutoRefreshCount:w,resetAutoRefreshCount:P}=Y(),{xCetusTotalTvl:L}=vn(),{vaultsPositionLoading:B}=be(),{lockCetusListLoading:m,veNFTLoading:C}=ne(),h=d.useMemo(()=>t,[t]),{refreshTask:S}=zn(h),_=!b&&(c||n),T=!b&&(r||a||n||B),O=!b&&(p||y||n),u=!b&&(m||C||n),A=d.useMemo(()=>({wallet:{totalValue:Se(s),isLoading:_},liquidity:{totalValue:Se(x),isLoading:T},orders:{totalValue:Se(g),isLoading:O},xCetus:{totalValue:Se(L),isLoading:u}}),[s,x,g,L,_,T,O,u]),k=[{title:"Wallet Holdings",value:"wallet",route:"/profile?tab=wallet",activeImgUrl:"/images/wallet_tab.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/profile?tab=liquidity",activeImgUrl:"/images/liquidity_tab.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/profile?tab=orders",activeImgUrl:"/images/order_tab.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/profile?tab=xCetus",activeImgUrl:"/images/xCetus_tab.png",showTooltip:!1}],z=d.useMemo(()=>Bn(L,x,g,s),[L,x,g,s]);d.useEffect(()=>P(!1),[]);const[E,M]=d.useState(!1);d.useEffect(()=>{M(!0)},[]);const{isApp:H}=Q();return H?e.jsx($s,{totalValue:z,onRefreshTask:S,isLoading:!b&&(C||r||p||y),children:e.jsx(Qe,{tabList:k,activeTab:h,tabData:A,onClickTab:V=>l(`/profile?tab=${V}`)})}):e.jsx(R,{minW:"1200px",p:"40px 20px 0",margin:"0px auto",gap:"12px",alignItems:"start",children:E?i!=null&&i.address?e.jsxs(R,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(ln,{handleRefresh:V=>{w(!V),S()},totalValue:z,isLoading:!b&&(C||r||p||y)}),e.jsx(Qe,{tabList:k,activeTab:h,tabData:A,onClickTab:V=>l(`/profile?tab=${V}`)}),h==="wallet"&&e.jsx(gn,{}),h==="liquidity"&&e.jsx(Is,{}),h==="orders"&&e.jsx(an,{}),h==="xCetus"&&e.jsx(_n,{})]}):e.jsx(se,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view profile page ",onboard:()=>o(!0)}):e.jsx(Je,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(ze,{})})})}export{ai as default};
//# sourceMappingURL=Profile-wqNy4zXi.js.map

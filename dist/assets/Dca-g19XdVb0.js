import{n as xt,o as It,p as es,r as p,q as ft,v as jt,t as ts,w as ss,x as as,y as ns,z as is,A as cs,D as Ye,E as dt,F as Pt,G as gt,J as ls,K as et,L as os,M as rs,N as us,j as t,O as zt,P as tt,Q as bt,R as Xe,U as ps,u as _t,b as lt,e as Lt,V as K,k as Wt,W as Qe,S as ct,d as b,H as R,X as ht,Y as G,T as E,Z as Ie,I as Re,C as Dt,$ as He,B as Bt,a0 as ms,a1 as ot,a2 as Tt,a3 as xs,a4 as ds,a5 as gs,a6 as Ce,a7 as at,a8 as yt,a9 as At,aa as Ke,ab as hs,g as ys,ac as nt,ad as vs,ae as Ss,af as bs,ag as _s,ah as Ds,ai as ws,aj as fs,ak as js,al as Ps,am as Ts,an as As,ao as ks}from"./index-BK3qBWSh.js";import{M as Os,C as Cs}from"./MenuDropBlock-C_Z9QXUp.js";import{L as Rs,T as Ns,a as Ms}from"./LimitPriceChart-CXBB9DQH.js";import{P as Ht}from"./Pagination-CwizWIDd.js";import{N as vt}from"./NoData-BhGkTf8z.js";import{R as kt}from"./RefreshButton-mdGmVCU4.js";import{u as rt}from"./useTransaction-DpwrswED.js";import{u as Vt,R as Ut}from"./RangeValue-CZnCh2wF.js";import{D as Es,e as $s,g as zs}from"./api-data-utils-DdJFeMQ-.js";import{H as we}from"./HTextLabelBox-2DdWq0e6.js";import{u as wt}from"./useAccountBalance-NcYomdwl.js";import{P as Ls}from"./progress-Cbj82vHE.js";import{u as Ws}from"./useInsufficientBalanceToast-C-hqlzj_.js";import{A as Bs}from"./aggregator-Bkrz9W-B.js";import{A as Ot}from"./useSwapHelper-Df7nVJNZ.js";import{u as Ct}from"./useTokenBalance-CVi8JO-l.js";import{u as Hs}from"./useFindBestRouting-DId-iVSt.js";import{u as Ft}from"./useToken-DpJnfVqM.js";import{i as Vs}from"./icon_currentprice@2x-DeObnx8l.js";import{C as Us}from"./CurrentPrice-B2BgMjpW.js";import{T as Fs}from"./TooltipIcon-CdD8MgA7.js";import{T as Gs}from"./TradeInputGroup-D4pAsmIv.js";import{W as qs}from"./WarningTokenTipModal-BG_knBy7.js";import{S as Rt}from"./SingleTokenInfo-xY1nD1m1.js";import{I as Gt}from"./InputBox-CM4JGRSy.js";import{u as Ys}from"./global-53UTVccp.js";import{u as Ks}from"./useRpcListener-C0dspcGl.js";import"./CetusTooltip-BsW2316G.js";import"./IconBg-CEM4uVwz.js";import"./progress.utils-C9hCHoTQ.js";import"./useGetPoolList-Dh5p8iGx.js";import"./_getAllKeysIn-BLU9PuTy.js";import"./AddressCopyLink-BGAzWPCI.js";import"./AddressUnderline-nUIj4Nzz.js";import"./usePreviousValue-C_PycxJ_.js";function Qs(a){const{min:s=0,max:e=100,onChange:h,value:o,defaultValue:c,isReversed:i,direction:n="ltr",orientation:u="horizontal",id:l,isDisabled:g,isReadOnly:m,onChangeStart:D,onChangeEnd:d,step:r=1,getAriaValueText:v,"aria-valuetext":T,"aria-label":P,"aria-labelledby":z,name:q,focusThumbOnChange:L=!0,minStepsBetweenThumbs:A=0,...X}=a,Z=xt(D),I=xt(d),H=xt(v),se=It({isReversed:i,direction:n,orientation:u}),[ne,$]=es({value:o,defaultValue:c??[25,75],onChange:h});if(!Array.isArray(ne))throw new TypeError(`[range-slider] You passed an invalid value for \`value\` or \`defaultValue\`, expected \`Array\` but got \`${typeof ne}\``);const[N,O]=p.useState(!1),[V,ae]=p.useState(!1),[_,S]=p.useState(-1),U=!(g||m),M=p.useRef(ne),k=ne.map(y=>ft(y,s,e)),C=A*r,ee=Xs(k,s,e,C),W=p.useRef({eventSource:null,value:[],valueBounds:[]});W.current.value=k,W.current.valueBounds=ee;const de=k.map(y=>e-y+s),Me=(se?de:k).map(y=>jt(y,s,e)),Ee=u==="vertical",ge=p.useRef(null),fe=p.useRef(null),be=p.useId(),J=ns(l??be),te=p.useCallback(y=>{var ie;if(!ge.current)return;W.current.eventSource="pointer";const w=ge.current.getBoundingClientRect(),{clientX:f,clientY:B}=((ie=y.touches)==null?void 0:ie[0])??y,Y=Ee?w.bottom-B:f-w.left,xe=Ee?w.height:w.width;let me=Y/xe;return se&&(me=1-me),ts(me,s,e)},[Ee,se,e,s]),je=(e-s)/10,ve=r||(e-s)/100,Q=p.useMemo(()=>({setValueAtIndex(y,w){if(!U)return;const f=W.current.valueBounds[y];w=parseFloat(ss(w,f.min,ve)),w=ft(w,f.min,f.max);const B=[...W.current.value];B[y]=w,$(B)},setActiveIndex:S,stepUp(y,w=ve){const f=W.current.value[y],B=se?f-w:f+w;Q.setValueAtIndex(y,B)},stepDown(y,w=ve){const f=W.current.value[y],B=se?f+w:f-w;Q.setValueAtIndex(y,B)},reset(){$(M.current)}}),[ve,se,$,U]),Pe=p.useCallback(y=>{const w=y.key,B={ArrowRight:()=>Q.stepUp(_),ArrowUp:()=>Q.stepUp(_),ArrowLeft:()=>Q.stepDown(_),ArrowDown:()=>Q.stepDown(_),PageUp:()=>Q.stepUp(_,je),PageDown:()=>Q.stepDown(_,je),Home:()=>{const{min:Y}=ee[_];Q.setValueAtIndex(_,Y)},End:()=>{const{max:Y}=ee[_];Q.setValueAtIndex(_,Y)}}[w];B&&(y.preventDefault(),y.stopPropagation(),B(y),W.current.eventSource="keyboard")},[Q,_,je,ee]),{getThumbStyle:Te,rootStyle:Ae,trackStyle:Ve,innerTrackStyle:$e}=p.useMemo(()=>as({isReversed:se,orientation:u,thumbPercents:Me}),[se,u,Me]),ke=p.useCallback(y=>{var f;const w=y??_;if(w!==-1&&L){const B=J.getThumb(w),Y=(f=fe.current)==null?void 0:f.ownerDocument.getElementById(B);Y&&setTimeout(()=>Y.focus())}},[L,_,J]);is(()=>{W.current.eventSource==="keyboard"&&(I==null||I(W.current.value))},[k,I]);const Ue=y=>{const w=te(y)||0,f=W.current.value.map(ie=>Math.abs(ie-w)),B=Math.min(...f);let Y=f.indexOf(B);const xe=f.filter(ie=>ie===B);xe.length>1&&w>W.current.value[Y]&&(Y=Y+xe.length-1),S(Y),Q.setValueAtIndex(Y,w),ke(Y)},ze=y=>{if(_==-1)return;const w=te(y)||0;S(_),Q.setValueAtIndex(_,w),ke(_)};cs(fe,{onPanSessionStart(y){U&&(O(!0),Ue(y),Z==null||Z(W.current.value))},onPanSessionEnd(){U&&(O(!1),I==null||I(W.current.value))},onPan(y){U&&ze(y)}});const _e=p.useCallback((y={},w=null)=>({...y,...X,id:J.root,ref:Pt(w,fe),tabIndex:-1,"aria-disabled":dt(g),"data-focused":Ye(V),style:{...y.style,...Ae}}),[X,g,V,Ae,J]),Le=p.useCallback((y={},w=null)=>({...y,ref:Pt(w,ge),id:J.track,"data-disabled":Ye(g),style:{...y.style,...Ve}}),[g,Ve,J]),he=p.useCallback((y={},w=null)=>({...y,ref:w,id:J.innerTrack,style:{...y.style,...$e}}),[$e,J]),Je=p.useCallback((y,w=null)=>{const{index:f,...B}=y,Y=k[f];if(Y==null)throw new TypeError(`[range-slider > thumb] Cannot find value at index \`${f}\`. The \`value\` or \`defaultValue\` length is : ${k.length}`);const xe=ee[f];return{...B,ref:w,role:"slider",tabIndex:U?0:void 0,id:J.getThumb(f),"data-active":Ye(N&&_===f),"aria-valuetext":(H==null?void 0:H(Y))??(T==null?void 0:T[f]),"aria-valuemin":xe.min,"aria-valuemax":xe.max,"aria-valuenow":Y,"aria-orientation":u,"aria-disabled":dt(g),"aria-readonly":dt(m),"aria-label":P==null?void 0:P[f],"aria-labelledby":P!=null&&P[f]||z==null?void 0:z[f],style:{...y.style,...Te(f)},onKeyDown:gt(y.onKeyDown,Pe),onFocus:gt(y.onFocus,()=>{ae(!0),S(f)}),onBlur:gt(y.onBlur,()=>{ae(!1),S(-1)})}},[J,k,ee,U,N,_,H,T,u,g,m,P,z,Te,Pe,ae]),Fe=p.useCallback((y={},w=null)=>({...y,ref:w,id:J.output,htmlFor:k.map((f,B)=>J.getThumb(B)).join(" "),"aria-live":"off"}),[J,k]),We=p.useCallback((y,w=null)=>{const{value:f,...B}=y,Y=!(f<s||f>e),xe=f>=k[0]&&f<=k[k.length-1];let me=jt(f,s,e);me=se?100-me:me;const ie={position:"absolute",pointerEvents:"none",...ls({orientation:u,vertical:{bottom:`${me}%`},horizontal:{left:`${me}%`}})};return{...B,ref:w,id:J.getMarker(y.value),role:"presentation","aria-hidden":!0,"data-disabled":Ye(g),"data-invalid":Ye(!Y),"data-highlighted":Ye(xe),style:{...y.style,...ie}}},[g,se,e,s,u,k,J]),pe=p.useCallback((y,w=null)=>{const{index:f,...B}=y;return{...B,ref:w,id:J.getInput(f),type:"hidden",value:k[f],name:Array.isArray(q)?q[f]:`${q}-${f}`}},[q,k,J]);return{state:{value:k,isFocused:V,isDragging:N,getThumbPercent:y=>Me[y],getThumbMinValue:y=>ee[y].min,getThumbMaxValue:y=>ee[y].max},actions:Q,getRootProps:_e,getTrackProps:Le,getInnerTrackProps:he,getThumbProps:Je,getMarkerProps:We,getInputProps:pe,getOutputProps:Fe}}function Xs(a,s,e,h){return a.map((o,c)=>{const i=c===0?s:a[c-1]+h,n=c===a.length-1?e:a[c+1]-h;return{min:i,max:n}})}const[Js,ut]=zt({name:"SliderContext",errorMessage:"useSliderContext: `context` is undefined. Seems you forgot to wrap all slider components within <RangeSlider />"}),[Zs,pt]=zt({name:"RangeSliderStylesContext",errorMessage:`useRangeSliderStyles returned is 'undefined'. Seems you forgot to wrap the components in "<RangeSlider />" `}),qt=et(function(s,e){const h={orientation:"horizontal",...s},o=os("Slider",h),c=rs(h),{direction:i}=us();c.direction=i;const{getRootProps:n,...u}=Qs(c),l=p.useMemo(()=>({...u,name:h.name}),[u,h.name]);return t.jsx(Js,{value:l,children:t.jsx(Zs,{value:o,children:t.jsx(tt.div,{...n({},e),className:"chakra-slider",__css:o.container,children:h.children})})})});qt.displayName="RangeSlider";const St=et(function(s,e){const{getThumbProps:h,getInputProps:o,name:c}=ut(),i=pt(),n=h(s,e);return t.jsxs(tt.div,{...n,className:bt("chakra-slider__thumb",s.className),__css:i.thumb,children:[n.children,c&&t.jsx("input",{...o({index:s.index})})]})});St.displayName="RangeSliderThumb";const Yt=et(function(s,e){const{getTrackProps:h}=ut(),o=pt(),c=h(s,e);return t.jsx(tt.div,{...c,className:bt("chakra-slider__track",s.className),__css:o.track,"data-testid":"chakra-range-slider-track"})});Yt.displayName="RangeSliderTrack";const Kt=et(function(s,e){const{getInnerTrackProps:h}=ut(),o=pt(),c=h(s,e);return t.jsx(tt.div,{...c,className:"chakra-slider__filled-track",__css:o.filledTrack})});Kt.displayName="RangeSliderFilledTrack";const Is=et(function(s,e){const{getMarkerProps:h}=ut(),o=pt(),c=h(s,e);return t.jsx(tt.div,{...c,className:bt("chakra-slider__marker",s.className),__css:o.mark})});Is.displayName="RangeSliderMark";function Qt(){const{peripherySdk:a}=Xe();return{dcaCloseOrderPayload:async e=>await a.Dca.dcaCloseOrderPayload(e)}}function Xt(){const{peripherySdk:a}=Xe();return{dcaWithdrawPayload:async e=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaClaim.ts:12 ~ params:",e),await a.Dca.withdrawAll(e))}}const ea=(a,s)=>({upperPriceSize:"0%",setUpperPriceSize:e=>{a(()=>({upperPriceSize:e}))},lowerPriceSize:"0%",setLowerPriceSize:e=>{a(()=>({lowerPriceSize:e}))},dcaMode:"total",setDcaMode:e=>{a(()=>({dcaMode:e}))},isDcaRefresh:!1,setIsDcaRefresh:e=>{a(()=>({isDcaRefresh:e}))},pageDirect:!1,setPageDirect:e=>{a(()=>({pageDirect:e}))},sellTotalAmount:"",setSellTotalAmount:e=>{a(()=>({sellTotalAmount:e}))},sellAmount:"",setSellAmount:e=>{a(()=>({sellAmount:e}))},buyAmount:"",setBuyAmount:e=>{a(()=>({buyAmount:e}))},sellCoin:void 0,setSellCoin:e=>{a(()=>({sellCoin:e}))},buyCoin:void 0,setBuyCoin:e=>{a(()=>({buyCoin:e}))},orderNum:"2",setOrderNum:e=>{a(()=>({orderNum:e}))},investNum:"1",setInvestNum:e=>{a(()=>({investNum:e}))},currentCoinKey:"sellCoin",setCurrentCoinKey:e=>{a(()=>({currentCoinKey:e}))},currentInvest:"Hour",setCurrentInvest:e=>{a(()=>({currentInvest:e}))},pageLoading:!0,setPageLoading:e=>{a(()=>({pageLoading:e}))},dcaConfig:{},setDcaConfig:e=>{a(()=>({dcaConfig:e}))},dcaQuote:{},setDcaQuote:e=>{a(()=>({dcaQuote:e}))},orderHistoryObj:{},setOrderHistoryObj:e=>{a(()=>({orderHistoryObj:{...s().orderHistoryObj,...e}}))},inCoinWhiteList:[],setInCoinWhiteList:e=>{a(()=>({inCoinWhiteList:e}))},outCoinWhiteList:[],setOutCoinWhiteList:e=>{a(()=>({outCoinWhiteList:e}))}}),ye=ps(ea);function ta(){const{fetchByApi:a}=_t(),{setOrderHistoryObj:s}=ye();return{getDcaOrderHistory:async({orderId:h,limit:o,offset:c})=>{var n;const i=await a(Es,"GET",{order_id:h,limit:o,offset:c});if(console.log("ðŸš€ ~ file: useGetDcaOrderHistory.ts:16 ~ useGetDcaOrderHistory ~ res:",i),i!=null&&i.list){const u={[h]:{list:((n=i==null?void 0:i.list)==null?void 0:n.map(l=>({inAmount:l==null?void 0:l.in_amount,outAmount:l==null?void 0:l.out_amount,inCoinType:l==null?void 0:l.in_coin,outCoinType:l==null?void 0:l.out_coin,time:l==null?void 0:l.execution_at,tx:l==null?void 0:l.tx})))||[],total:(i==null?void 0:i.total)||0}};return s(u),u}}}}function sa({isDetail:a,currentTabVal:s,orderInfo:e,handleRefresh:h,pageDirect:o}){const{isApp:c}=lt(),{inCoin:i,outCoin:n}=e,{getDcaOrderHistory:u}=ta(),[l,g]=p.useState(o),[m,D]=p.useState(o),d=10,[r,v]=p.useState([]),[T,P]=p.useState(0),[z,q]=p.useState(1),[L,A]=p.useState(!1),[X,Z]=p.useState({label:"Overview",value:"overview"}),I=p.useMemo(()=>[{label:"Overview",value:"overview"},{label:L||Number(T)===0?"Orders":`Orders (${T})`,value:"orders"}],[T]),H=S=>{Z(S),e!=null&&e.orderID&&ne(e==null?void 0:e.orderID,d,0,!1)};p.useEffect(()=>{a&&(e!=null&&e.orderID)&&ne(e==null?void 0:e.orderID,d,0,!1)},[e,a]);const se=S=>{console.log("ðŸš€ ~ handleCurrentPage ~ page:",S);const U=(S-1)*d;ne(e==null?void 0:e.orderID,d,U,!1),q(S)},ne=async(S,U,M,k=!1)=>{var ee,W,de,Ne;console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ loading:",k),A(k);const C=await u({orderId:S,limit:U,offset:M});console.log("ðŸš€ ~ handleGetDcaOrderHistory ~ res?.list:",C,C[S]),(ee=C[S])!=null&&ee.list&&v((W=C[S])==null?void 0:W.list),(de=C[S])!=null&&de.total&&P((Ne=C[S])==null?void 0:Ne.total),A(!1),console.log("ðŸš€ ~ file: TestData.tsx:170 ~ handleGetDcaOrderHistory ~ res:",C)},[$,N]=p.useState(!1),{dcaWithdrawPayload:O}=Xt();wt();const{signAndExecuteTransaction:V}=rt(),ae=async()=>{N(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",e);const S=[],U={order_id:e==null?void 0:e.orderID,in_coin_type:e==null?void 0:e.inCoin.coin_type,out_coin_type:e==null?void 0:e.outCoin.coin_type};S.push(U),console.log("ðŸš€ ~ toClaim ~ claimOrderParams:",S);const M=await O(S),k=await V(M,{getShowInfo:C=>{var W,de;const ee={modalDescriptionText:`${(W=e==null?void 0:e.outCoin)==null?void 0:W.symbol} Claimed`,toastTitleText:`${(de=e==null?void 0:e.outCoin)==null?void 0:de.symbol} Claimed`};return C==="success"&&(ee.toastDescriptionContent=""),ee}});k&&(console.log("ðŸš€ ~ toClaim ~ res:",k),setTimeout(()=>{h()},2e3)),N(!1)}catch(S){console.log("ðŸš€ ~ toClaim ~ error:",S),N(!1)}},{getExplorerUrl:_}=Lt();return t.jsxs(K,{w:"100%",gap:"20px",children:[t.jsx(Wt,{type:"outlineTab",wrapStyle:{w:"100%",h:"36px",borderRadius:"8px",p:"4px",mt:"-1px",zIndex:"1"},itemStyle:{w:"50%",fontSize:"12px"},tabList:I,currentTab:X.label,handleChangeTab:H}),t.jsxs(Qe,{p:"30px 8px 20px",mt:"-42px",borderRadius:"8px",zIndex:"0",bg:"bg_primary",children:[X.value=="orders"&&(L?t.jsx(ct,{height:"4",width:"100%"}):(r==null?void 0:r.length)===0?t.jsx(vt,{type:"nodata",text:"No orders",noBorder:!0,p:"12px",bg:"none"}):t.jsxs(K,{w:"100%",align:"flex-start",gap:"16px",mt:"12px",children:[!c&&t.jsxs(R,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[t.jsx(ue,{label:"Order info",value:"",w:{base:"100%",lg:"40%"}}),t.jsx(ue,{label:"Rate",value:"",w:{base:"100%",lg:"calc(32% - 16px)"},direct:m,onChangeDirect:()=>D(!m)}),t.jsx(ue,{label:"Time (UTC)",value:"",w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]}),r==null?void 0:r.map(S=>{console.log("ðŸš€ ~ {orderHistoryList?.map ~ orderHistory:",S);const U=ht(S.inAmount,i==null?void 0:i.decimals),M=ht(S.outAmount,n==null?void 0:n.decimals),k=b(U).div(M).toString(),C=b(1).div(k).toString();return t.jsxs(R,{w:"100%",flexDirection:{base:"column",lg:"row"},borderBottom:c?"1px solid":"none",pb:c?"16px":"0",borderColor:"border",_last:{borderBottom:"none",pb:"0"},children:[t.jsx(ue,{label:c?"Order info":"",value:`${G(U)} ${i.symbol} â†’ ${G(M)} ${n.symbol}`,w:{base:"100%",lg:"40%"}}),t.jsx(ue,{label:c?"Rate":"",value:m?`${G(k)} ${i.symbol} per ${n.symbol}`:`${G(C)} ${n.symbol} per ${i.symbol}`,w:{base:"100%",lg:"calc(32% - 16px)"},direct:m,showDirectIcon:!!c,onChangeDirect:()=>D(!m)}),t.jsx(ue,{label:c?"Time (UTC)":"",value:t.jsxs(R,{h:"12px",children:[t.jsx(E,{fontSize:"12px",color:"text_caption",children:Ie((S==null?void 0:S.time)*1e3,"YMDHM")}),t.jsx(Re,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(_(S==null?void 0:S.tx,"tx"))}})]}),w:{base:"100%",lg:"28%"},align:"flex-end",textAlign:"right"})]},S==null?void 0:S.time)}),b(T).gt(d)&&t.jsx(Dt,{w:"100%",children:t.jsx(Ht,{total:T,size:d,currentPage:z,onChange:se})})]})),X.value=="overview"&&t.jsxs(K,{align:"flex-start",gap:"20px",children:[(e==null?void 0:e.isShowTradeTips)&&(e==null?void 0:e.orderStatus)=="Active"&&s=="active"&&t.jsx(aa,{}),t.jsxs(K,{w:"100%",borderRadius:"8px",p:"12px",bg:"card_bg",gap:"12px",children:[t.jsx(we,{isLoading:!1,label:`DCA  ${i==null?void 0:i.symbol} Balance`,value:`${G(e==null?void 0:e.inBalance,2)||"0"} ${i==null?void 0:i.symbol}`,skeletonStyle:{valueW:"128px"}}),t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsxs(E,{fontSize:"12px",children:["DCA ",n==null?void 0:n.symbol," Balance"]}),t.jsxs(R,{children:[t.jsxs(E,{color:"text_caption",fontSize:"12px",children:[(e==null?void 0:e.outBalance)>0?G(e==null?void 0:e.outBalance):e==null?void 0:e.outBalance," ",n==null?void 0:n.symbol]}),s=="active"&&t.jsx(He,{isLoading:$,onClick:ae,disabled:(e==null?void 0:e.outBalance)<=0||$,w:"60px",h:"20px",fontSize:"12px",borderRadius:"4px",variant:"outline",children:"Claim"})]})]}),t.jsx(we,{isLoading:!1,label:"Amount Withdrawn",value:s=="active"?`${G(e==null?void 0:e.outWithdraw,2)}`:(e==null?void 0:e.orderStatus)=="PartialDeal"||(e==null?void 0:e.orderStatus)=="Close"?b(e==null?void 0:e.outWithdraw).gt(0)?`${G(e==null?void 0:e.inWithdrawn)} ${i==null?void 0:i.symbol} ${G(e==null?void 0:e.outWithdraw)} ${n==null?void 0:n.symbol}`:`${G(e==null?void 0:e.inWithdrawn)} ${i==null?void 0:i.symbol}`:`${G(e==null?void 0:e.outWithdraw)} ${n==null?void 0:n.symbol}`,skeletonStyle:{valueW:"128px"}})]}),t.jsxs(R,{flexWrap:"wrap",p:{base:"0",lg:"0 12px"},mt:{base:"-12px",lg:"-28px"},sx:{">div":{mt:{base:"12px",lg:"28px"},w:{base:"100%",lg:"calc((100% - 66px)/3)"},"&:nth-child(3n+1)":{mr:{base:"0",lg:"50px"}}}},children:[t.jsx(ue,{label:"Invest Every",value:e==null?void 0:e.investEvery}),t.jsx(ue,{label:"# of Orders Left",value:e==null?void 0:e.ofOrderLeft}),t.jsx(ue,{label:"Each Order Size",value:`${e==null?void 0:e.eachOrderSize} ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right"}),t.jsx(ue,{label:"Minimum Price",value:l?`${e==null?void 0:e.minPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.minPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,direct:l,onChangeDirect:()=>g(!l)}),t.jsx(ue,{label:"Maximum Price",value:l?`${e==null?void 0:e.maxPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.maxPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,direct:l,onChangeDirect:()=>g(!l)}),s=="active"&&t.jsx(ue,{label:"Current Avg. Price",value:l?`${e==null?void 0:e.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right",direct:l,onChangeDirect:()=>g(!l)}),s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"&&t.jsx(ue,{label:"Avg. Price",value:l?`${e==null?void 0:e.currentAvgPrice} ${i==null?void 0:i.symbol} per ${n==null?void 0:n.symbol}`:`${e==null?void 0:e.currentAvgPriceResever} ${n==null?void 0:n.symbol} per ${i==null?void 0:i.symbol}`,align:"flex-end",textAlign:"right",direct:l,onChangeDirect:()=>g(!l)}),s=="active"&&t.jsx(ue,{label:"Next Order (UTC)",value:e==null?void 0:e.nextCycleAt}),t.jsx(ue,{label:"Created (UTC)",value:e==null?void 0:e.createAt,align:s=="active"||s!=="active"&&(e==null?void 0:e.currentAvgPrice)!=="--"?"flex-start":"flex-end"})]})]})]})]})}const ue=({label:a,value:s,direct:e,onChangeDirect:h,textAlign:o="left",showDirectIcon:c=!0,...i})=>t.jsxs(K,{align:"flex-start",flexDirection:{base:"row",lg:"column"},w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"unset"},...i,children:[a!==""&&t.jsxs(R,{h:"12px",children:[t.jsx(E,{fontSize:"12px",children:a}),h&&c&&t.jsx(Re,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:h})]}),s!==""&&t.jsx(Bt,{fontSize:"12px",color:"text_caption",textAlign:o,children:s})]}),aa=()=>t.jsxs(K,{p:"12px 12px 0",align:"flex-start",children:[t.jsxs(R,{children:[t.jsx(Re,{xlinkHref:"#icon-icon-warning",variant:"warning",cursor:"text"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"})]}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market price is not in your required price range"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market no longer exit"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"- The market is extremely volatile"}),t.jsx(E,{color:"primary_yellow",lineHeight:"20px",fontSize:"12px",children:"This DCA will continue to be attempted and the estimated end date may be extended until your order is fully executed."})]});function na({currentTabVal:a,orderInfo:s,handleRefresh:e}){const{isApp:h}=lt(),{inCoin:o,outCoin:c}=s,[i,n]=p.useState(!1),[u,l]=p.useState(!1);p.useEffect(()=>{n(!1)},[a]);const{getTokenRank:g}=Vt(),[m,D]=p.useState(!1);p.useEffect(()=>{const P=g(o,c);console.log("ðŸš€ ~ useEffectDcaItem ~ direct:",c,o,P),D(!P)},[o==null?void 0:o.coin_type,c==null?void 0:c.coin_type]);const{dcaCloseOrderPayload:d}=Qt(),{signAndExecuteTransaction:r}=rt(),v=async()=>{l(!0);try{console.log("ðŸš€ ~ closeOrder ~ orderInfo:",s);const P=[{order_id:s==null?void 0:s.orderID,in_coin_type:s==null?void 0:s.inCoin.coin_type,out_coin_type:s==null?void 0:s.outCoin.coin_type}];console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-order-card.vue:280 ~ closeOrder ~ closeOrderParams:",P);const z=await d(P),q=await r(z,{getShowInfo:L=>{const A={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return L==="success"&&(A.modalDescriptionText="DCA Order Closed",A.toastDescriptionContent="DCA Order Closed",A.toastTitleText="DCA Order Closed"),A}});console.log("ðŸš€ ~ closeOrder ~ res:",q),q&&setTimeout(()=>{e()},2e3),l(!1)}catch(P){console.log("ðŸš€ ~ closeOrder ~ error:",P),l(!1)}},{getExplorerUrl:T}=Lt();return t.jsxs(K,{w:"100%",gap:"12px",align:"flex-start",children:[t.jsxs(R,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[t.jsxs(R,{children:[t.jsx(ms,{coinAIconUrl:o==null?void 0:o.logo_url,coinBIconUrl:c==null?void 0:c.logo_url,coinACoinType:o==null?void 0:o.coin_type,coinBCoinType:c==null?void 0:c.coin_type,w:"28px",h:"28px"}),t.jsxs(E,{color:"text_caption",children:[o==null?void 0:o.symbol," â†’ ",c==null?void 0:c.symbol]}),t.jsx(Re,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(T(s==null?void 0:s.orderID,"poolAddress"))}})]}),!h&&t.jsx(Nt,{currentTabVal:a,isCloseLoading:u,closeOrder:v,orderInfo:s,isDetail:i,onClickDetail:()=>n(!i)})]}),t.jsxs(R,{children:[t.jsxs(E,{color:"text_caption",fontSize:"12px",children:[G(s==null?void 0:s.inDepositedOut)," ",o==null?void 0:o.symbol]}),t.jsxs(E,{color:"primary_gray",fontSize:"12px",children:["/ ",G(s==null?void 0:s.inDeposited)," ",o==null?void 0:o.symbol]}),t.jsxs(E,{color:"primary_gray",fontSize:"12px",children:["(",s==null?void 0:s.inBalanceRatio,"%)"]}),t.jsx(Ls,{w:"50px",h:"4px",value:s==null?void 0:s.inBalanceRatio,bg:"#282828",sx:{'div[role="progressbar"]':{bg:"primary"}}})]}),t.jsxs(R,{w:"100%",children:[t.jsx(E,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),t.jsx(Ut,{displayTokenA:c,displayTokenB:o,isRank:!0,priceInfo:{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,minPriceResever:s==null?void 0:s.minPriceResever,maxPriceResever:s==null?void 0:s.maxPriceResever},fontSize:"12px"})]}),h&&t.jsx(Nt,{currentTabVal:a,isCloseLoading:u,closeOrder:v,orderInfo:s,isDetail:i,onClickDetail:()=>n(!i)}),i&&t.jsx(sa,{pageDirect:m,isDetail:i,currentTabVal:a,orderInfo:s,handleRefresh:e})]})}const Nt=({currentTabVal:a,isCloseLoading:s,closeOrder:e,orderInfo:h,isDetail:o,onClickDetail:c})=>t.jsxs(R,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[a=="active"&&t.jsx(He,{w:{base:"100%",lg:"unset"},isLoading:s,disabled:s,onClick:e,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(h==null?void 0:h.outBalance)<=0?"Close":"Close and Withdraw"}),t.jsx(He,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:t.jsx(Re,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:o?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:c,children:"Details"})]});function Mt({handleRefresh:a,activeList:s,pastList:e,isOrderLoading:h}){const[c,i]=p.useState([]),[n,u]=p.useState([]),[l,g]=p.useState(0),[m,D]=p.useState(1),{currentAccount:d,onWalletModal:r}=ot(),[v,T]=p.useState({label:"Active DCAs",value:"active"}),P=p.useMemo(()=>[{label:"Active DCAs",value:"active",num:(s==null?void 0:s.length)>0?s==null?void 0:s.length:void 0},{label:"Past DCAs",value:"past",num:(e==null?void 0:e.length)>0?e==null?void 0:e.length:void 0}],[v==null?void 0:v.value,s,e]),z=O=>{D(1),T(O)};p.useEffect(()=>{const O=(v==null?void 0:v.value)==="active"?s:e;i(O),g(O==null?void 0:O.length)},[v==null?void 0:v.value,s,e]),p.useEffect(()=>{const O=(m-1)*10,V=O+10;u(c==null?void 0:c.slice(O,V))},[m,c,v==null?void 0:v.value]);const q=p.useMemo(()=>(v==null?void 0:v.value)==="past"||(c==null?void 0:c.length)===0?0:c==null?void 0:c.reduce((O,V)=>b(O).plus(V==null?void 0:V.outBalance),b(0)).toString(),[v==null?void 0:v.value,c]),[L,A]=p.useState(!1),[X,Z]=p.useState(!1),{dcaWithdrawPayload:I}=Xt(),{dcaCloseOrderPayload:H}=Qt(),{signAndExecuteTransaction:se}=rt(),ne=async()=>{Z(!0);try{const O=c==null?void 0:c.map(_=>({order_id:_==null?void 0:_.orderID,in_coin_type:_==null?void 0:_.inCoin.coin_type,out_coin_type:_==null?void 0:_.outCoin.coin_type}));console.log("ðŸš€ ~ const closeOrderParams:any=pageList.map ~ closeOrderParams:",O);const V=await H(O),ae=await se(V,{getShowInfo:_=>{const S={modalDescriptionText:"Closing DCA order",toastTitleText:"Closing DCA order"};return _==="success"&&(S.modalDescriptionText="DCA Order Closed",S.toastDescriptionContent="DCA Order Closed",S.toastTitleText="DCA Order Closed"),S}});console.log("ðŸš€ ~ closeAll ~ res:",ae),ae&&setTimeout(()=>{a(!0)},2e3),Z(!1)}catch(O){console.log("ðŸš€ ~ closeAll ~ error:",O),Z(!1)}},$=async()=>{A(!0);try{const O=c==null?void 0:c.map(_=>({order_id:_==null?void 0:_.orderID,in_coin_type:_==null?void 0:_.inCoin.coin_type,out_coin_type:_==null?void 0:_.outCoin.coin_type}));console.log("ðŸš€ ~ const claimOrderParams:any=pageList.map ~ claimOrderParams:",O);const V=await I(O),ae=await se(V,{getShowInfo:_=>{const S={modalDescriptionText:"DCA Order Claimed",toastTitleText:"DCA Order Claimed"};return _==="success"&&(S.toastDescriptionContent=""),S}});console.log("ðŸš€ ~ claimAll ~ res:",ae),ae&&setTimeout(()=>{a(!0)},2e3),A(!1)}catch(O){console.log("ðŸš€ ~ claimAll ~ error:",O),A(!1)}},{isApp:N}=lt();return t.jsxs(K,{w:"100%",children:[t.jsxs(R,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[t.jsxs(R,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[t.jsx(Wt,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:P,currentTab:v.label,handleChangeTab:z}),N&&t.jsx(kt,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),t.jsxs(R,{w:{base:"100%",lg:"unset"},children:[v.value==="active"&&(c==null?void 0:c.length)>0&&(d==null?void 0:d.address)&&t.jsx(He,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:L,disabled:Number(q)===0||L,onClick:$,leftIcon:t.jsx(Re,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),v.value==="active"&&(c==null?void 0:c.length)>0&&(d==null?void 0:d.address)&&t.jsx(He,{w:{base:"50%",lg:"unset"},isLoading:X,disabled:(c==null?void 0:c.length)==0||X,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:ne,children:"Close All"}),!N&&t.jsx(kt,{handleRefresh:a,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),d!=null&&d.address?h?t.jsx(Qe,{children:t.jsx(K,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((O,V)=>t.jsx(ia,{},V))})}):(c==null?void 0:c.length)===0?t.jsx(vt,{type:"nodata",text:(v==null?void 0:v.value)==="active"?"No active orders":"No closed orders"}):t.jsxs(Qe,{h:(n==null?void 0:n.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[t.jsx(K,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:n==null?void 0:n.map(O=>t.jsx(na,{handleRefresh:()=>a(!0),currentTabVal:v.value,orderInfo:O},O==null?void 0:O.orderID))}),!h&&(c==null?void 0:c.length)>10&&t.jsx(Dt,{mt:"28px",children:t.jsx(Ht,{total:l,size:10,currentPage:m,onChange:D})})]}):t.jsx(vt,{type:"nowallet",onboard:()=>r(!0)})]})}const ia=()=>t.jsxs(K,{w:"100%",gap:"16px",align:"flex-start",children:[t.jsxs(R,{w:"100%",gap:"0",justify:"space-between",children:[t.jsxs(R,{gap:"0",children:[t.jsxs(R,{gap:"0px",mr:"8px",align:"flex-start",children:[t.jsx(Tt,{size:"8"}),t.jsx(Tt,{size:"8"})]}),t.jsx(ct,{height:"4",width:"100px"})]}),t.jsx(ct,{height:"4",width:"150px"})]}),t.jsx(ct,{height:"4",width:"180px"})]});function ca(){const{fetchByApi:a}=_t(),{peripherySdk:s}=Xe(),{setDcaConfig:e}=ye(),h=async()=>await a($s,"GET")||null,o=async()=>await s.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const i={};try{const n=await h();n&&(i.minCycleAmountInUsd=n==null?void 0:n.min_amount_in_usd)}catch(n){console.log("ðŸš€ ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",n)}try{const n=await o();i.minCycleCount=n==null?void 0:n.min_cycle_count,i.minCycleFrequency=n==null?void 0:n.min_cycle_frequency,i.whitelistMode=n==null?void 0:n.whitelist_mode}catch(n){console.log("ðŸš€ ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",n)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",i),e(i),i}}}function Jt(){const{fetchByApi:a}=_t(),{setDcaQuote:s}=ye();return{getDcaQuote:async({inCoin:h,freq:o,count:c,sender:i})=>{try{const n=await a(zs,"GET",{in_coin:h,freq:o,count:c,sender:i});if(n){const u={amountInLimitPerCycle:n==null?void 0:n.amount_in_limit_per_cycle,coinType:n==null?void 0:n.coin_type,feeRate:n==null?void 0:n.fee_rate,signature:n==null?void 0:n.signature,signer:n==null?void 0:n.signer,timestamp:n==null?void 0:n.timestamp};return s(u),u}}catch(n){console.log("getDcaQuote ~ error:",n)}return null}}}function la(){var Ge,Se;const{sellCoin:a,buyCoin:s,setSellCoin:e,setBuyCoin:h,sellAmount:o,buyAmount:c,setBuyAmount:i,setSellAmount:n,dcaConfig:u,setCurrentCoinKey:l,currentCoinKey:g,investNum:m,currentInvest:D,orderNum:d,dcaQuote:r,setInvestNum:v,setOrderNum:T,setCurrentInvest:P,setPageDirect:z,pageDirect:q,dcaMode:L,sellTotalAmount:A,setSellTotalAmount:X,setLowerPriceSize:Z,setUpperPriceSize:I}=ye(),{currentAccount:H}=ot(),{getDcaConfig:se}=ca(),{getDcaQuote:ne}=Jt(),{coinPriceObj:$}=xs(),{fetchTokenPrices:N,getTokenAmountValue:O}=ds(),[V,ae]=p.useState(""),_=p.useRef(V);p.useEffect(()=>{_.current=V},[V]);const S=async()=>{const x=await se();console.log("ðŸš€ ~ handleGetDcaConfig ~ res:",x)},U=()=>{console.log("ðŸš€ ~ initiaTokenSelect ~ setSellCoin:"),e(At.clmm_swap.from_coin),h(At.clmm_swap.to_coin)};p.useEffect(()=>(Z("0%"),I("0%"),U(),S(),()=>{fe()}),[]);const[M,k]=p.useState(""),[C,ee]=p.useState(""),{balanceInfo:W}=Ct(a),{balanceInfo:de}=Ct(s),Ne=O(a==null?void 0:a.coin_type,o),Me=x=>{l("sellCoin"),n(x),w()};p.useEffect(()=>{+o&&+d?L=="total"?X(o):X(b(o).mul(d).toString()):X("")},[o,L,d]);const Ee=()=>{const x=q?a==null?void 0:a.decimals:s==null?void 0:s.decimals;if(z(!q),M&&C){const F=M,ce=b(1).div(C).toString(),De=b(1).div(F).toString();k(Ke(ce,x,!0).toString()),ee(Ke(De,x,!0).toString())}},ge=(x,F=!0)=>{var ce,De,qe,Be;k(""),ee(""),F?(((ce=x==null?void 0:x.coin_type)==null?void 0:ce.toLowerCase())===((De=s==null?void 0:s.coin_type)==null?void 0:De.toLowerCase())?be():e(x),l("sellCoin")):(((qe=x==null?void 0:x.coin_type)==null?void 0:qe.toLowerCase())===((Be=a==null?void 0:a.coin_type)==null?void 0:Be.toLowerCase())?be():h(x),l("buyCoin"))},fe=()=>{n(""),k(""),ee(""),ae(""),v("1"),T("2"),P("Hour")},be=()=>{e(s),h(a)},st=p.useMemo(()=>{const x=u==null?void 0:u.whitelistMode;return console.log("ðŸš€ ~ useDcaHook ~ whitelistMode:",x),x===3?!0:x===0?!1:g==="sellCoin"?x===1:g==="buyCoin"?x===2:!1},[u==null?void 0:u.whitelistMode]),J=((Ge=$[gs(a==null?void 0:a.coin_type).full_address])==null?void 0:Ge.price)||0,te=p.useMemo(()=>A&&d?b(A).div(d).toString():0,[A,d]),je=p.useMemo(()=>A&&d&&J&&b(A).div(d).mul(J).toString()||0,[A,d,J]),ve=b(r==null?void 0:r.feeRate).div(Ce.pow(10,6)).mul(100).toString()+"%"||"0%",Q=p.useMemo(()=>{if(r!=null&&r.amountInLimitPerCycle&&(a!=null&&a.decimals))return ht(r==null?void 0:r.amountInLimitPerCycle,a==null?void 0:a.decimals)},[r==null?void 0:r.amountInLimitPerCycle]),Pe=p.useMemo(()=>(console.log("ðŸš€ ~ orderSizeError ~ sellPerOrder:",te,Q),u!=null&&u.minCycleAmountInUsd&&d&&o&&Q&&Number(te)<Number(Q)?{status:!0,tips:`Each order size should be higher than $${u==null?void 0:u.minCycleAmountInUsd}.`}:o&&d&&Number(je)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[L,Q,d,te,o,je,u==null?void 0:u.minCycleAmountInUsd]),Te=p.useMemo(()=>(console.log("ðŸš€ ~ orderInputError ~ orderNum:",d,d&&Number(d)<Number(u==null?void 0:u.minCycleCount)),u!=null&&u.minCycleCount&&d&&Number(d)<Number(u==null?void 0:u.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${u==null?void 0:u.minCycleCount}.`}:d&&Number(m)<=0?{status:!0,tips:"Please enter an interval above 0"}:d&&m&&Number(m)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[d,u==null?void 0:u.minCycleCount,m]),Ae=p.useMemo(()=>M&&Number(M)==0||C&&Number(C)==0?{status:!0,tips:"Please enter a price greater than 0."}:M&&C&&Number(M)>=Number(C)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[M,C]),[Ve,$e]=p.useState(""),[ke,Ue]=p.useState({status:!1,tips:""}),ze=()=>{const x=new Date().getTime();let F=0;switch(console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",D),D){case"Minute":F=Number(m)*60*1e3*(Number(d)-1)+6e4;break;case"Hour":F=Number(m)*60*60*1e3*(Number(d)-1)+6e4;break;case"Day":F=Number(m)*60*60*24*1e3*(Number(d)-1)+6e4;break;case"Week":F=Number(m)*60*60*24*7*1e3*(Number(d)-1)+6e4;break;case"Month":F=Number(m)*60*60*24*30*1e3*(Number(d)-1)+6e4;break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",d,x,F,F>60*60*24*365*1e3);const ce=Ie(x+F,"YMDHM");console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",ce),$e(ce),ce=="NaN-NaN-NaN NaN:NaN"&&$e("--"),F>60*60*24*365*1e3?Ue({status:!0,tips:"The maximum execution period is 1 year"}):Ue({status:!1,tips:"The maximum execution period is 1 year"})};p.useEffect(()=>{ze()},[o,m,d,M,C,D]);const _e=p.useMemo(()=>{let x=0;switch(D){case"Minute":x=Number(m)*60;break;case"Hour":x=Number(m)*60*60;break;case"Day":x=Number(m)*60*60*24;break;case"Week":x=Number(m)*60*60*24*7;break;case"Month":x=Number(m)*60*60*24*30;break}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",x),x},[D,m]);p.useEffect(()=>{a!=null&&a.coin_type&&_e&&d&&he(a==null?void 0:a.coin_type,_e,d,H==null?void 0:H.address)},[a==null?void 0:a.coin_type,_e,d,H==null?void 0:H.address]);const Le=async(x,F,ce,De)=>{const qe=De||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const Be=await ne({inCoin:x,freq:F,count:ce,sender:qe});return console.log("ðŸš€ ~ queryDcaQuote ~ result:",Be),Be}catch(Be){console.log("ðŸš€ðŸš€ðŸš€ ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",Be)}},he=at((x,F,ce,De)=>{Le(x,F,ce,De)},500),{findBestRouters:Je}=Hs(),[Fe,We]=p.useState(!1),[pe,Ze]=p.useState(void 0),{getTokenRank:y}=Vt();p.useEffect(()=>{Y();const x=y(a,s);console.log("ðŸš€ ~ useEffect ~ direct:",x),z(x)},[a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]),p.useEffect(()=>{w()},[te,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]);const w=()=>{b(te).gt(0)&&(a!=null&&a.coin_type)&&(s!=null&&s.coin_type)&&(We(!0),console.log("ðŸš€ ~ useDcaHook ~ sellAmountDebounce:",Number(te)>0,te,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,d),f())},f=at(()=>{B()},500),B=async()=>{if(console.log("ðŸš€ ~ findAvailableRouter ~ findAvailableRouter:",te),a&&s){const x=`${a.coin_type}_${s.coin_type}`;ae(x);const F=Object.entries(Bs).map(([De,qe])=>qe.id),ce=await Je({fromToken:a,toToken:s,amount:yt(te||1,a==null?void 0:a.decimals).toFixed(0),providersKeys:F,by_amount_in:!0,uuid:x});console.log("ðŸš€ ~ findAvailableRouter ~ newUuid:",x,V,ce),x===_.current&&(Ze(ce),i(ce==null?void 0:ce.toAmountUi),We(!1))}},Y=()=>{const x=((a==null?void 0:a.coin_type)||(s==null?void 0:s.coin_type))&&Array.from(new Set([a==null?void 0:a.coin_type,s==null?void 0:s.coin_type]));N(x||[])},xe=p.useMemo(()=>{console.log("ðŸš€ ~ btnStatus ~ routerData:",pe);const x={text:"Create DCA Order",disabled:!1};return H!=null&&H.address?!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)?(x.disabled=!0,x.text="Select a token",x):!o||Number(o)==0?(x.disabled=!0,x.text="Enter an amount",x):b(A).gt((W==null?void 0:W.balanceFormat)||0)?(x.disabled=!0,x.text=`Insufficient ${a==null?void 0:a.symbol} balance`,x):b(u==null?void 0:u.minCycleCount).gt(d||0)?(x.disabled=!0,x.text=`Minimum ${u==null?void 0:u.minCycleCount} orders`,x):b(Q).gt(te||0)?(x.disabled=!0,x.text=`Minimum $${u==null?void 0:u.minCycleAmountInUsd} per order`,x):Pe.status||Te.status||Ae.status||ke.status||!(a!=null&&a.coin_type)||!(s!=null&&s.coin_type)||!d||!m||!M||!C?(x.disabled=!0,x.text="Create DCA Order",x):(console.log("ðŸš€ ~ btnStatus ~ routerData:",pe),pe&&pe.errorCode&&(pe.errorCode===Ot.NoRouter||pe.errorCode===Ot.HoneyPot)&&(x.text="No Available Route",x.disabled=!0),x):(x.text="Connect Wallet",x.disabled=!1,x)},[H==null?void 0:H.address,W,Pe,Te,Ae,ke,a==null?void 0:a.coin_type,s==null?void 0:s.coin_type,A,m,d,M,C,(Se=pe==null?void 0:pe.routes)==null?void 0:Se.length]),me=p.useMemo(()=>{const x=[];return s&&x.push(s),a&&x.push(a),x},[s,a]),ie=p.useMemo(()=>q&&c&&te?G(b(c).div(te).toString(),s==null?void 0:s.decimals,!0):!q&&c&&te?G(b(te).div(c).toString(),a==null?void 0:a.decimals,!0):"",[q,te,c]),mt=at(x=>{k(x)},500),j=at(x=>{ee(x)},500),le=x=>{console.log("ðŸš€ ~ handleMinInputChange ~ val:",x),mt(x)},Oe=x=>{console.log("ðŸš€ ~ handleMaxInputChange ~ val:",x),j(x)};p.useEffect(()=>{oe(M)},[M,ie]),p.useEffect(()=>{re(C)},[C,ie]);const oe=x=>{if(console.log("ðŸš€ ~ changeLowerPriceSize ~ val:",x),ie&&x){const F=b(x).div(ie).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",F),Z(b(F).gt(1e4)?">10,000%":`${G(F,1,!1,Ce.ROUND_HALF_DOWN)}%`)}},re=x=>{if(ie&&x){const F=b(x).div(ie).sub(1).mul(100).toString();console.log("ðŸš€ ~ handleMaxInputChange ~ upperPrice:",F),I(b(F).gt(1e4)?">10,000%":`${G(F,1,!1,Ce.ROUND_HALF_DOWN)}%`)}};return{currentPrice:ie,handleMinInputChange:le,handleMaxInputChange:Oe,warningTokenList:me,resetInputAmount:fe,cycleFrequency:_e,btnStatus:xe,fetchFindAvailableRouterDebounce:w,queryDcaQuote:Le,findRouterLoading:Fe,platformFee:ve,estEndDate:Ve,sellPerOrder:te,isDcaSelect:st,onReverseClick:be,sellBalanceInfo:W,buyBalanceInfo:de,sellAmountValue:Ne,handleAmountChange:Me,handleSelectToken:ge,minPriceValue:M,maxPriceValue:C,handlePageToggleDirect:Ee,orderSizeError:Pe,orderInputError:Te,priceError:Ae,orderTimeError:ke}}function oa(){const{peripherySdk:a}=Xe(),{getTokenInfo:s}=Ft(),{setFilterTokenLoading:e}=hs(),{setInCoinWhiteList:h,setOutCoinWhiteList:o}=ye();return{getDcaCoinWhiteList:async i=>{var m,D;console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:"),e(!0);const{inCoinList:n,outCoinList:u}=await a.Dca.getDcaCoinWhiteList(i);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",u),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",n);const l=[],g=[];for(let d=0;d<n.length;d++){const r=await s(n[d]);l.push({...r,labels:((m=r==null?void 0:r.labels)==null?void 0:m.length)>0?r.labels:""})}for(let d=0;d<u.length;d++){const r=await s(u[d]);g.push({...r,labels:((D=r==null?void 0:r.labels)==null?void 0:D.length)>0?r.labels:""})}console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",g),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",l),h(l),o(g),e(!1)}}}function ra(){const{peripherySdk:a}=Xe(),{getDcaQuote:s}=Jt(),e=(c,i,n,u,l,g)=>{const m=b(yt(c,n)).div(i),D=b(m).div(b(l)),d=b(m).div(b(g));let r,v;if(n>u){const T=Ce.pow(10,n-u);r=d.div(T).ceil().toString(),v=D.div(T).ceil().toString()}else if(n<u){const T=Ce.pow(10,u-n);r=d.mul(T).ceil().toString(),v=D.mul(T).ceil().toString()}else r=d.ceil().toString(),v=D.ceil().toString();return{perCycleMinOutAmount:r,perCycleMaxOutAmount:v,cycleCountAmount:m}},h=(c,i,n,u)=>{const{in_coin:l,in_coin_amount:g,freq:m,cycle_count:D,out_coin:d}=c;return{in_coin_amount:String(yt(g,l.decimals)),in_coin_type:l.coin_type,out_coin_type:d.coin_type,cycle_frequency:m,cycle_count:D,per_cycle_min_out_amount:n,per_cycle_max_out_amount:u,per_cycle_in_amount_limit:i.amountInLimitPerCycle,fee_rate:i.feeRate,timestamp:i.timestamp,signature:i.signature}};return{openDcaOrder:async c=>{const{in_coin:i,out_coin:n,in_coin_amount:u,cycle_count:l,min_price:g,max_price:m,freq:D}=c,d=a.ClmmSDK.senderAddress||"0x0000000000000000000000000000000000000000000000000000000000000000",r=await s({inCoin:i.coin_type,freq:D,count:l,sender:d});if(!r)throw new Error("Request timed out");const{perCycleMinOutAmount:v,perCycleMaxOutAmount:T}=e(u,l,i.decimals,n.decimals,g,m),P=h(c,r,v,T);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",P);const z=await a.Dca.dcaOpenOrderPayload(P);return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",z),z}}}function Zt({detailsData:a,isConfirm:s=!1}){const{sellPerOrder:e,estEndDate:h,platformFee:o,minPriceValue:c,maxPriceValue:i,minPriceResever:n,maxPriceResever:u}=a,{sellCoin:l,buyCoin:g,sellTotalAmount:m,investNum:D,currentInvest:d,pageDirect:r}=ye();return console.log("ðŸš€ ~ DetailsBlock ~ investNum:",a,D),t.jsxs(K,{w:"100%",gap:s?"20px":"16px",children:[t.jsx(we,{isLoading:!1,label:"Sell total",value:m?`${G(m,l==null?void 0:l.decimals)} ${l==null?void 0:l.symbol}`:`-- ${l==null?void 0:l.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Sell per order",value:e?`${G(e,l==null?void 0:l.decimals)} ${l==null?void 0:l.symbol}`:`-- ${l==null?void 0:l.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!s&&t.jsx(we,{isLoading:!1,label:"Receive",value:t.jsxs(R,{gap:"4px",children:[t.jsx(ys,{imageUrl:g==null?void 0:g.logo_url,w:"20px",h:"20px",coinType:g==null?void 0:g.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),t.jsx(E,{color:"text_caption",children:g==null?void 0:g.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsx(E,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),t.jsx(Ut,{displayTokenA:g,displayTokenB:l,isRank:!0,justify:"flex-end",priceInfo:{minPrice:nt(c).toString(),maxPrice:nt(i).toString(),minPriceResever:nt(n).toString(),maxPriceResever:nt(u).toString()},fontSize:"14px",color:"text_caption"})]}),t.jsx(we,{isLoading:!1,label:"Invest every",value:Number(D)>1?`${D} ${d}s`:`${D} ${d}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s&&t.jsx(we,{isLoading:!1,label:"Start date",value:String(Ie(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Est. end date(UTC)",value:h,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),t.jsx(we,{isLoading:!1,label:"Platform fee",value:o,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const ua=({confirmData:a,isOpen:s,onClose:e,toOpenDca:h,toOpenDcaLoading:o})=>{const{sellCoin:c,buyCoin:i}=ye();return t.jsxs(vs,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:e,isCentered:!0,children:[t.jsx(Ss,{}),t.jsxs(bs,{children:[t.jsx(_s,{children:t.jsx(Ds,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),t.jsx(ws,{}),t.jsx(fs,{textAlign:"center",p:"0px",children:t.jsxs(K,{w:"100%",gap:"16px",p:"16px",children:[t.jsxs(Qe,{borderRadius:"8px",position:"relative",p:"0 12px",children:[t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsxs(K,{align:"flex-start",w:"calc(50% - 24px)",children:[t.jsx(E,{children:"Sell"}),t.jsx(Rt,{portal:!1,token:c,haveName:!1,symbolEllipsesDecimals:10})]}),t.jsx(Bt,{w:"1px",h:"100px",bg:"border"}),t.jsxs(K,{align:"flex-end",w:"calc(50% - 24px)",children:[t.jsx(E,{children:"Buy"}),t.jsx(Rt,{portal:!1,token:i,haveName:!1,symbolEllipsesDecimals:10})]})]}),t.jsx(Dt,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:t.jsx(Re,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),t.jsx(Zt,{detailsData:a,isConfirm:!0}),t.jsx(He,{mt:"12px",onClick:()=>{h(),e()},disabled:o,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function pa({detailsData:a}){return t.jsx(Qe,{children:t.jsxs(K,{gap:"20px",children:[t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsx(E,{color:"text_caption",children:"Details"}),t.jsx(E,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),t.jsx(Zt,{detailsData:a})]})})}function Et({title:a,label:s,inputValue:e,inputChange:h=()=>{},list:o=[],onListItemClick:c=()=>{}}){const i=n=>{const u=n.target.value.replace(/[^\d]/g,"");h(u)};return t.jsx(Gt,{w:"50%",borderRadius:"16px",children:t.jsxs(K,{gap:"16px",align:"flex-start",children:[typeof a=="string"?t.jsx(E,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:a}):a,t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsx(js,{value:e,onChange:i,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),o.length>0?t.jsx(Os,{label:s,list:o,onListItemClick:c}):t.jsx(E,{color:"text_caption",children:s})]})]})})}function $t({direct:a,text:s,align:e,inputValue:h,inputChange:o=()=>{}}){const{sellCoin:c,buyCoin:i}=ye();return t.jsx(Gt,{w:"unset",borderRadius:"8px",children:t.jsx(R,{children:t.jsxs(K,{align:e,children:[t.jsx(Ps,{value:h,placeholder:"0.0",decimals:18,onChange:n=>o(n),style:{width:"calc(100% - 8px)",textAlign:e=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),t.jsxs(R,{w:"100%",justify:"space-between",children:[t.jsx(E,{fontSize:"12px",fontWeight:"500",children:a?`${i==null?void 0:i.symbol} per ${c==null?void 0:c.symbol}`:`${c==null?void 0:c.symbol} per ${i==null?void 0:i.symbol}`}),s&&t.jsx(E,{fontSize:"12px",fontWeight:"500",children:s})]})]})})})}function ma({handleGetDcaOrderList:a}){const{sellCoin:s,buyCoin:e,sellAmount:h,buyAmount:o,setInvestNum:c,setOrderNum:i,investNum:n,orderNum:u,currentInvest:l,setCurrentInvest:g,pageDirect:m,isDcaRefresh:D,dcaMode:d,setDcaMode:r,sellTotalAmount:v,upperPriceSize:T,lowerPriceSize:P,setLowerPriceSize:z,setUpperPriceSize:q}=ye(),{currentPrice:L,btnStatus:A,findRouterLoading:X,sellBalanceInfo:Z,buyBalanceInfo:I,sellAmountValue:H,handleAmountChange:se,handleSelectToken:ne,minPriceValue:$,maxPriceValue:N,handleMinInputChange:O,handleMaxInputChange:V,handlePageToggleDirect:ae,onReverseClick:_,orderSizeError:S,orderInputError:U,orderTimeError:M,priceError:k,sellPerOrder:C,estEndDate:ee,platformFee:W,fetchFindAvailableRouterDebounce:de,cycleFrequency:Ne,resetInputAmount:Me,warningTokenList:Ee}=la();p.useEffect(()=>{D&&de()},[D]);const{currentAccount:ge,onWalletModal:fe}=ot(),[be,st]=p.useState("#icon-a-icon_trade"),J=["Minute","Hour","Day","Week","Month"],te=j=>st(j?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:je}=ra(),[ve,Q]=p.useState(!1),{fetchCoinBalance:Pe}=wt(),{signAndExecuteTransaction:Te,transactionRejected:Ae,transactionConfirmation:Ve}=rt(),{failedTsToast:$e}=Ts(),{showInsufficientBalanceToast:ke}=Ws(),Ue=async()=>{Q(!0);const j={getShowInfo:oe=>{`${G(v)}${s==null?void 0:s.symbol}${e==null?void 0:e.symbol}${u}`;const re={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return oe==="success"&&(re.modalDescriptionText="DCA Order Created",re.toastDescriptionContent="DCA Order Created",re.toastTitleText="DCA Order Created"),re}};Ve(j);const le=m?b(1).div(N).toString():$,Oe=m?b(1).div($).toString():N;try{const oe={in_coin:s,out_coin:e,in_coin_amount:v,cycle_count:u,min_price:le,max_price:Oe,freq:Ne};console.log("ðŸš€ ~ toOpenDca ~ params:",!m,$,N,le,Oe,oe);const re=await je(oe);console.log("ðŸš€ ~ toOpenDca ~ tx:",re);const Ge=await Te(re,j);console.log("ðŸš€ ~ toOpenDca ~ res:",Ge),Ge&&(Me(),setTimeout(()=>{Pe(ge==null?void 0:ge.address,s==null?void 0:s.coin_type),a(ge==null?void 0:ge.address)},2e3)),Q(!1)}catch(oe){const re={getShowInfo:Ge=>{const Se={};return String(oe)==="Error: Each order size should be higher than $10"&&(Se.toastTitleText="Transaction Submission Error",Se.toastDescriptionContent="Each order size should be higher than $10."),String(oe)==="Error: Request timed out"&&(Se.toastTitleText="Request timed out",Se.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(oe)==="Error: minPrice error"&&(Se.toastTitleText="DCA order submission failed",Se.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),Se}};console.log("ðŸš€ ~ toOpenDca ~ error:",oe),console.error("Open DCA Order Error: ",oe),ke(String(oe)),Ae(re),$e(re),Q(!1)}},{currentCoinKey:ze,inCoinWhiteList:_e,outCoinWhiteList:Le,dcaConfig:he}=ye(),{getDcaCoinWhiteList:Je}=oa(),[Fe,We]=p.useState([]);p.useEffect(()=>{ze=="sellCoin"?We(_e):We(Le),console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:104 ~ DcaInputBlock ~ whiteTokenList:",Fe)},[ze,_e,Le]),p.useEffect(()=>{he&&he.whitelistMode&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",he),Je(he.whitelistMode))},[he==null?void 0:he.whitelistMode]);const[pe,Ze]=p.useState(!1),y=p.useMemo(()=>{const j=m?e==null?void 0:e.decimals:s==null?void 0:s.decimals;let le="",Oe="",oe="",re="";return $&&N&&(le=m?Ke(b(1).div(N).toString(),j,!0).toString():$,Oe=m?Ke(b(1).div($).toString(),j,!0).toString():N,oe=m?$:Ke(b(1).div(N).toString(),j,!0).toString(),re=m?N:Ke(b(1).div($).toString(),j,!0).toString()),{estEndDate:ee,sellPerOrder:C,platformFee:W,minPriceValue:le,maxPriceValue:Oe,minPriceResever:oe,maxPriceResever:re}},[m,ee,C,W,$,N]),w=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[f,B]=p.useState([0,0]),[Y,xe]=p.useState(0),[me,ie]=p.useState(0),mt=j=>{console.log("ðŸš€ ~ handleSlider ~ val:",j),B(j),O(j[0].toString()),V(j[1].toString())};return p.useEffect(()=>{if($&&N){const j=Number($),le=Number(N);B([j,le]),console.log("ðŸš€ ~ useEffect ~ start:",j,le)}$||z("0%"),N||q("0%")},[$,N]),p.useEffect(()=>{if(L){const j=b("-100").div(100).plus(1).mul(L).toNumber(),le=b("100").div(100).plus(1).mul(L).toNumber();console.log("ðŸš€ ~ useEffect ~ min:",j,le),xe(j),ie(le)}},[L]),t.jsxs(K,{w:"100%",children:[t.jsx(Gs,{onClick:_,currentCoinKey:ze,whiteTokenList:Fe,from:{inputTabOptions:{type:"outlineTab",tabList:w,currentTab:d=="total"?"Total":"Per Order",handleChangeTab:j=>{r(j==null?void 0:j.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(Z==null?void 0:Z.balanceFormat)||"",value:h,amountValue:H,loading:!1,onChange:se,selectable:!0,placeholder:"0.0",token:s,onTokenChange:j=>ne(j,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(I==null?void 0:I.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:e,onTokenChange:j=>ne(j,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:be,svgFill:"text_caption",transform:be==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:be==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>te(!0),onMouseLeave:()=>te(!1)}}),(S==null?void 0:S.status)&&t.jsx(it,{tips:S==null?void 0:S.tips}),t.jsxs(R,{w:"100%",children:[t.jsx(Et,{title:"Invest Every",label:l,inputValue:n,list:J,onListItemClick:j=>{g(j)},inputChange:j=>{console.log("ðŸš€ ~ DcaInputBlock ~ item:",j),c(j)}}),t.jsx(Et,{title:t.jsx(Fs,{type:"over",children:t.jsx(E,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:u,inputChange:j=>{i(j),de()}})]}),(U==null?void 0:U.status)&&t.jsx(it,{tips:U==null?void 0:U.tips}),(M==null?void 0:M.status)&&t.jsx(it,{tips:M==null?void 0:M.tips}),t.jsxs(Qe,{zIndex:"1",p:"16px",borderRadius:"16px",children:[t.jsxs(K,{align:"flex-start",children:[t.jsx(E,{color:"text_caption",children:"Set Price Range"}),t.jsx(E,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:h?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),h&&C&&t.jsxs(R,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[t.jsx(E,{children:"Current Rate"}),t.jsx(K,{align:{base:"flex-start",lg:"flex-end"},children:t.jsx(Us,{color:"text_caption",pageDirect:m,handlePageToggleDirect:ae,fromToken:s,toToken:e,fromValue:C,toValue:o,isLoading:X||!o||!C})})]})]}),t.jsxs(R,{justify:"space-between",gap:"8px",mt:"20px",children:[t.jsx($t,{direct:m,text:h&&$?P:"",inputValue:$,inputChange:j=>O(j),align:"flex-start"}),t.jsx(E,{color:"text_caption",children:"-"}),t.jsx($t,{direct:m,text:h&&N?T:"",inputValue:N,inputChange:j=>V(j),align:"flex-start"})]}),!X&&h&&$&&N&&Number(N)>=Number($)&&(A==null?void 0:A.text)!=="No Available Route"&&t.jsxs(K,{w:"100%",gap:"0",mt:"20px",children:[t.jsxs(qt,{min:Y,max:me,step:.1,value:f,onChange:j=>{mt(j)},colorScheme:"teal",children:[t.jsx(Yt,{children:t.jsx(Kt,{})}),t.jsx(St,{index:0}),t.jsx(St,{index:1})]}),t.jsx(As,{src:Vs,w:"32px",h:"32px"}),t.jsx(R,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:t.jsx(E,{children:"Current Rate"})})]})]}),(k==null?void 0:k.status)&&t.jsx(it,{tips:k==null?void 0:k.tips}),t.jsx(He,{isLoading:ve,disabled:(A==null?void 0:A.disabled)||ve,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",onClick:(A==null?void 0:A.text)=="Connect Wallet"?()=>fe(!0):()=>Ze(!0),children:A==null?void 0:A.text}),h&&t.jsx(pa,{detailsData:y}),pe&&t.jsx(ua,{confirmData:y,isOpen:pe,onClose:()=>Ze(!1),toOpenDca:Ue,toOpenDcaLoading:ve}),(e||s)&&t.jsx(qs,{addToken:!0,tokensInfo:Ee,waringModalCancel:j=>{j.forEach(le=>{(le.coin_type===(e==null?void 0:e.coin_type)||le.coin_type===(s==null?void 0:s.coin_type))&&ne(void 0,le.coin_type===(e==null?void 0:e.coin_type))})}})]})}const it=({tips:a})=>t.jsxs(R,{w:"100%",bg:"primary_red_bg",p:"12px",borderRadius:"12px",children:[t.jsx(Re,{svgW:"16px",svgH:"16px",variant:"error",xlinkHref:"#icon-icon-warning",cursor:"text"}),t.jsx(E,{color:"primary_red",lineHeight:"20px",children:a})]});function xa(a){const i=Math.floor(a/2592e3);a%=2592e3;const n=Math.floor(a/604800);a%=604800;const u=Math.floor(a/86400);a%=86400;const l=Math.floor(a/3600);a%=3600;const g=Math.floor(a/60);a%=60;const m=[];return i>0&&m.push(`${i} Month${i>1?"s":""}`),n>0&&m.push(`${n} Week${n>1?"s":""}`),u>0&&m.push(`${u} Day${u>1?"s":""}`),l>0&&m.push(`${l} Hour${l>1?"s":""}`),g>0&&m.push(`${g} Minute${g>1?"s":""}`),m.join(" ")}function da(){const{getTokenInfo:a}=Ft(),{peripherySdk:s}=Xe(),e=async l=>{console.log("ðŸš€ ~ getDcaOrderList ~ walletAddress:",l);try{const g=await s.Dca.getDcaOrders(l);return console.log("ðŸš€ ~ getDcaOrderList ~ list:",g),await u(g==null?void 0:g.data)}catch(g){console.log("ðŸš€ ~ getDcaOrderList ~ error:",g)}},h=async l=>{const g=await a(l),m=Ce.pow(10,g==null?void 0:g.decimals);return{token:g,decimalsPow:m}},o=(l,g,m,D,d)=>{const r=b(l).div(g).div(b(D).div(m)).toString(),v=b(l).div(g).div(b(d).div(m)).toString();return{minPrice:r,maxPrice:v,minPriceResever:b(1).div(b(v)).toString(),maxPriceResever:b(1).div(b(r)).toString()}},c=l=>l.in_withdrawn>0&&l.in_withdrawn==l.in_deposited?"Close":l.in_withdrawn>0&&l.out_withdrawn>0?"PartialDeal":l.amount_left_next_cycle==0&&l.next_cycle_at==0?"AllDeal":"Active",i=(l,g,m,D,d,r,v)=>{const T=P=>P==="--"?"--":b(1).div(P).toString();switch(l){case"Close":return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"};case"PartialDeal":{const P=g.sub(m).div(r).toString(),z=g.sub(m).div(g).mul(100).toDP(2,Ce.ROUND_HALF_UP).toString();return console.log("ðŸš€ ~ useGetDcaOrderList ~ inDeposited:",m,g),{currentAvgPrice:P,currentAvgPriceResever:T(P),inBalanceRatio:z,inDepositedOut:g.sub(m).toString()}}case"AllDeal":{const P=g.div(r).toString();return{currentAvgPrice:P,currentAvgPriceResever:T(P),inBalanceRatio:"100",inDepositedOut:g.sub(D).toString()}}case"Active":{const P=d.gt(0)||r.gt(0)?g.sub(D).div(d.add(r)).toString():"--",z=g.sub(D).div(g).mul(100).toDP(2,Ce.ROUND_HALF_UP).toString();return{currentAvgPrice:P,currentAvgPriceResever:T(P),inBalanceRatio:z,inDepositedOut:g.sub(D).toString()}}default:return{currentAvgPrice:"--",currentAvgPriceResever:"--",inBalanceRatio:"0",inDepositedOut:"0"}}},n=(l,g,m,D)=>{const d=Date.now()/1e3,r=b(d).sub(l).div(g),v=m.lte(0)&&b(D).lte(0);return r.gt(3)&&v},u=async l=>{const g=[],m=[];for(const r of l){const{token:v,decimalsPow:T}=await h(r.in_coin_type),{token:P,decimalsPow:z}=await h(r.out_coin_type),q=b(r.in_deposited).div(T);console.log("ðŸš€ ~ buildDcaOrderList ~ order.in_deposited:",r.in_deposited,T);const L=b(r.in_deposited).div(r.in_amount_per_cycle).floor().toString(),A=b(r.in_amount_per_cycle).div(T).toString(),X=b(r.in_balance).div(T),Z=b(r.in_withdrawn).div(T),I=b(r.out_balance).gt(0)?b(r.out_balance).div(z):b(0),H=b(r.out_withdrawn).div(z),se=G(q.div(L).toString()),ne=X.div(A).floor().toNumber(),{minPrice:$,maxPrice:N,minPriceResever:O,maxPriceResever:V}=o(r.in_amount_per_cycle,T,z,r.max_out_amount_per_cycle,r.min_out_amount_per_cycle),ae=c(r),{currentAvgPrice:_,currentAvgPriceResever:S,inBalanceRatio:U,inDepositedOut:M}=i(ae,q,Z,X,I,H),k=n(r.created_at,r.cycle_frequency,I,H),C={createAt:Ie(r.created_at*1e3,"YMDHM"),cycleFrequency:r.cycle_frequency,orderID:r.id,inAmountPerCycle:A,nextCycleAt:Ie(r.next_cycle_at*1e3,"YMDHM"),inDeposited:q.toString(),cycleCount:L,inDepositedOut:M,inBalance:X.toString(),minPrice:G($),maxPrice:G(N),minPriceResever:G(O),maxPriceResever:G(V),inCoin:v,outCoin:P,outBalance:I.toString(),inBalanceRatio:U,outWithdraw:H.toString(),investEvery:xa(r.cycle_frequency),eachOrderSize:se,currentAvgPrice:_==="--"?"--":G(_,P.decimals),currentAvgPriceResever:_==="--"?"--":G(S,v.decimals),orderStatus:ae,inWithdrawn:Z.toString(),ofOrderLeft:ne,isShowTradeTips:k,next_cycle_at:r.created_at+ne*r.cycle_frequency,created_at:r.created_at,version:r.version};ae==="Active"?g.push(C):m.push(C)}const D=g==null?void 0:g.sort((r,v)=>v.version-r.version),d=m==null?void 0:m.sort((r,v)=>v.version-r.version);return console.log("ðŸš€ ~ buildDcaOrderList ~ activeResult, pastResult:",D,d,g,m),{activeResult:D,pastResult:d}};return{getDcaOrderList:e}}function Xa(){const[a,s]=p.useState([]),[e,h]=p.useState([]),{currentAccount:o}=ot(),{sellCoin:c,buyCoin:i,setIsDcaRefresh:n}=ye(),[u,l]=p.useState(!0),{isShowTradeChart:g,isShowTradeOrders:m}=Ys(),{getDcaOrderList:D}=da(),{fetchAccountBalance:d}=wt(),r=async(L,A=!1)=>{if(!m)return;A&&l(!0);const{activeResult:X,pastResult:Z}=await D(L);s(X),h(Z),l(!1),console.log("ðŸš€ ~ handleGetDcaOrderList ~ list:",X,Z)};p.useEffect(()=>{o!=null&&o.address?r(o==null?void 0:o.address,!0):(s([]),h([]))},[o==null?void 0:o.address,m]);const v=(L=!0)=>{q(0),n(!0),setTimeout(()=>{n(!1)},1e3),o!=null&&o.address&&(L||d(),r(o==null?void 0:o.address,L))};Ks({onRpcChange:()=>{v()}}),p.useEffect(()=>{o!=null&&o.address&&d()},[o==null?void 0:o.address]);const{isApp:T,windowWidth:P}=lt(),[z,q]=p.useState(0);return ks({interval:1e3,callback:()=>{q(z+1),z>=20&&v(!1)}}),t.jsxs(R,{mt:P&&P<1024?"28px":"42px",className:T||g||m?"":"bg_img",w:"100%",gap:"16px",justify:"center",align:"flex-start",flexDirection:{base:"column",lg:"row"},children:[(m||g)&&t.jsxs(K,{w:{base:"100%",lg:"calc(100% - 470px)"},mt:T&&!g?"-16px":"0",children:[g&&t.jsx(Rs,{baseToken:c,quoteToken:i}),m&&!T&&t.jsx(Mt,{handleRefresh:v,activeList:a,pastList:e,isOrderLoading:u})]}),t.jsxs(K,{w:{base:"100%",lg:"470px"},children:[t.jsxs(R,{w:"100%",justify:"space-between",mb:"8px",children:[t.jsx(Ns,{currTradeTab:Ms.DCA}),t.jsx(Cs,{})]}),t.jsx(ma,{handleGetDcaOrderList:L=>r(L)})]}),T&&m&&t.jsx(K,{w:{base:"100%",lg:"calc(100% - 470px)"},children:t.jsx(Mt,{handleRefresh:v,activeList:a,pastList:e,isOrderLoading:u})})]})}export{Xa as default};

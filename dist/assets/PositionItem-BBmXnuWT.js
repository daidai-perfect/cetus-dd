import{y as Ue,a as b,ak as ve,j as e,H as _,C as me,I as pe,T as A,f as O,P as Ae,h as fe,m as Te,n as _e,p as Y,V as B,F as I,W as $e,X as qe,Y as He,a0 as Ye,$ as Ge,k as Me,q as je}from"./vendor-BowHGuwE.js";import{a as K,J as Fe,K as te,d as g,z as ee,a2 as H,C as Ve,B as Oe,n as Se,a9 as ze,$ as V,aa as Je,r as ke,w as de,R as Q,f as ue,q as We,h as Qe}from"./index-C2ps9-Dy.js";import{u as Ke,V as Xe,a as Ze,b as Ie}from"./VaultsAprBlock-DopL6eV7.js";import{a as et,u as tt,V as st}from"./VaultsAction-Bci8uukT.js";import{u as Ne}from"./useAccountBalance-B0xlJzQj.js";import{u as rt}from"./useInterval-BcJtT0it.js";import{P as nt}from"./PoweredByHaedal-uLEk4Xbu.js";import{V as at}from"./VTextLabelBox-CVt1crGp.js";import{u as it}from"./global-BoVQYRiM.js";import{u as X,b as ct,a as lt}from"./usePositionList-B802Vh58.js";import{u as ot}from"./useTransaction-Ck5-rOQU.js";import{h as xt}from"./RemoveBlock-Dd2q82D4.js";import{T as dt}from"./TableSortTh-ClUImyFH.js";import{b as pt}from"./useClaimPosition-DmR0MUnL.js";import{a as ut}from"./useNotifiSubscription-55mM24ly.js";import{S as ge,A as gt}from"./SingleTokenInfo-DIrFWCBu.js";import{L as mt}from"./ExpendItem-CPm9nAfZ.js";function qt(){const{search:t}=Ue(),[n,i]=b.useState({});return b.useLayoutEffect(()=>{const s=new URLSearchParams(t);i(Object.fromEntries(s.entries()))},[t]),n}const Ht=({tooltip:t,...n})=>{const i=ve(),{isApp:s}=K();return e.jsx(_,{w:"20px",h:"20px",onClick:x=>{te(x),s||i("/farms")},...n,children:e.jsx(Fe,{placement:"top",tooltip:t||e.jsx(A,{fontSize:"12px",children:"Farm rewards available"}),children:e.jsx(me,{children:e.jsx(pe,{w:"100%",h:"100%",minW:"100%",src:"/images/icon_farms.png"})})})})};function ht(t){const{minPrice:n,maxPrice:i,currPrice:s}=t,[x,m]=b.useState(0),[p,S]=b.useState(0),c=b.useRef(null),r=b.useRef(null);b.useEffect(()=>{const y=()=>{c.current&&m(c.current.offsetWidth),r.current&&S(r.current.offsetWidth)},h=new ResizeObserver(y),f=new ResizeObserver(y);return c.current&&h.observe(c.current),r.current&&f.observe(r.current),()=>{c.current&&h.unobserve(c.current),r.current&&f.unobserve(r.current)}},[n,i,s]);const u=b.useMemo(()=>{if(i==="âˆž")return"0px";if(s&&n&&i&&x){if(g(s).lessThanOrEqualTo(i)&&g(s).greaterThanOrEqualTo(n)){const y=g(s).sub(n).div(g(i).sub(g(n))).toString();return`${g(x).mul(y).toFixed(0)}px`}if(g(s).lt(n))return"-36px";if(g(s).gt(i))return"calc(100% + 36px)"}return"0px"},[s,n,i,x]),v=b.useMemo(()=>{const y=u.replace("px","");return Number(y)-p/2+"px"},[u,p]),{isApp:w}=K();return e.jsx(e.Fragment,{children:n!==void 0&&i!==void 0&&s!==void 0?e.jsx(_,{w:"100%",height:"60px",background:"primary_opacity.10",borderRadius:"16px",p:"0px 0px 8px",children:e.jsxs(O,{w:"100%",padding:n&&g(s).lt(n)?"0 40px 0 60px":i&&g(s).gt(i)?"0 60px 0 40px":"0 40px",position:"relative",children:[e.jsx(A,{whiteSpace:"nowrap",position:"absolute",top:"20px",left:n&&g(s).lt(n)?"60px":"40px",fontSize:"12px",color:"text_caption",children:ee(n)}),e.jsx(O,{w:"100%",position:"relative",height:"14px",ref:c,bgImage:"url('/images/img_range@2x.png')",bgSize:"100% 14px",bgPosition:"center",children:e.jsxs(Ae,{isLazy:!0,placement:"top",trigger:w?"click":"hover",autoFocus:!1,returnFocusOnClose:!1,gutter:4,children:[e.jsx(fe,{children:e.jsx(O,{as:"button",children:e.jsx(O,{bg:"#fff",borderRadius:"8px",w:"4px",height:"15px",position:"absolute",top:"50%",transform:"translateY(-50%)",left:u,ml:"-2px",zIndex:"5"})})}),e.jsx(Te,{w:"fit-content",bg:"none",border:"none",ref:r,position:"absolute",top:"-32px !important",left:v,zIndex:"5",children:e.jsx(_e,{fontSize:"12px",w:"fit-content",bg:"none",border:"none",children:e.jsx(A,{whiteSpace:"nowrap",fontSize:"12px",color:"primary",children:ee(s)})})})]})}),e.jsx(A,{whiteSpace:"nowrap",position:"absolute",top:"20px",right:i&&g(s).gt(i)?"60px":"40px",fontSize:"12px",color:"text_caption",children:ee(i)})]})},u):e.jsx(_,{w:"100%",height:"60px",background:"primary_opacity.10",borderRadius:"16px",p:"0 40px",children:e.jsx(Y,{w:"100%",h:"20px"})})})}function bt(t){const{vaultId:n,displayTokenA:i,displayTokenB:s,feeDisplay:x,minPrice:m,maxPrice:p,currPrice:S}=t;console.log("ðŸš€ðŸš€ðŸš€ ~ VaultInfo.tsx:25 ~ VaultInfo ~ props:",t);const{vaultListObj:c}=Ke(),r=b.useMemo(()=>{if(H(c)&&n)return c[n]},[c,n]);return e.jsxs(B,{width:"calc(100% + 32px)",padding:"0 16px",alignItems:"left",paddingBottom:"16px",borderBottom:"1px solid",borderColor:"border",children:[e.jsxs(I,{children:[e.jsx(Ve,{coinAIconUrl:i==null?void 0:i.logo_url,coinBIconUrl:s==null?void 0:s.logo_url,imageStyle:{w:"32px",h:"32px"},imgBoxStyle:{w:"32px",h:"32px"}}),e.jsxs(I,{marginLeft:"8px",justifyContent:"space-between",alignItems:"center",width:"100%",children:[e.jsx(O,{children:e.jsxs(I,{alignItems:"center",children:[e.jsx(A,{fontSize:"16px",color:"text_caption",children:`${i==null?void 0:i.symbol} - ${s==null?void 0:s.symbol}`}),e.jsx(Oe,{w:"unset",p:"3px 12px 2px",borderRadius:"12px",bg:"none",borderColor:"primary",marginLeft:"8px",children:e.jsx(A,{fontSize:"12px",color:"primary",children:x})})]})}),e.jsx(I,{flexDirection:"column",children:e.jsx(at,{wrapStyle:{gap:"2px",alignItems:"flex-end !important"},title:"APY",titleStyle:{color:"primary",fontSize:"12px"},valueTooltip:e.jsx(Xe,{vaultsLstApyDisplay:r==null?void 0:r.vaultsLstApyDisplay,vaultsApyDisplay:r==null?void 0:r.vaultsApyDisplay,vaultsTotalApyDisplay:r==null?void 0:r.vaultsTotalApyDisplay,vaultsAprDisplay:r==null?void 0:r.vaultsAprDisplay,category:r==null?void 0:r.category}),value:(r==null?void 0:r.category)=="cetus"?r==null?void 0:r.vaultsTotalApyDisplay:(r==null?void 0:r.vaultsApyDisplay)||"-",valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500"}})})]})]}),e.jsx(ht,{minPrice:m,maxPrice:p,currPrice:S})]})}function Yt(t){const{currentAccount:n}=Se(),{isOpen:i,setIsOpen:s,vaultId:x,category:m,displayTokenA:p,displayTokenB:S,feeDisplay:c,clmmPool:r,isReverse:u}=t,{isOpenWalletModal:v}=Se(),{getCurrentVaultDetail:w,getCurrentVaultContractInfo:y}=et(),{clearVaultsActionData:h}=tt(),{fetchAccountBalance:f}=Ne(),P=ve(),{vaultsPoolObj:W}=Ze(),o=b.useMemo(()=>W[x],[W,x]);b.useEffect(()=>{x&&w(x)},[n==null?void 0:n.address,x]);const{getPythLastPrice:N}=Ie(),a=b.useRef(!1);b.useEffect(()=>(a.current=!0,()=>{a.current=!1,h()}),[]),b.useEffect(()=>{o!=null&&o.displayCoinTypeA&&(o!=null&&o.displayCoinTypeB)&&N([o==null?void 0:o.displayCoinTypeA,o==null?void 0:o.displayCoinTypeB])},[o==null?void 0:o.displayCoinTypeA,o==null?void 0:o.displayCoinTypeB]),rt({interval:20*1e3,callback:()=>{a.current&&m=="haedal"&&N([o==null?void 0:o.displayCoinTypeA,o==null?void 0:o.displayCoinTypeB])}});const d=()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:142 ~ autoRefresh ~ autoRefresh:"),n!=null&&n.address?(f(),w(x,!0)):y(x)};return e.jsxs($e,{isCentered:!0,isOpen:i&&!v,onClose:()=>{s(!1)},children:[e.jsx(qe,{}),e.jsx(He,{width:{base:"100%",lg:"420px"},children:e.jsx(Ye,{p:"0 0 8px",children:e.jsxs(B,{width:"100%",children:[e.jsxs(B,{width:"100%",p:"6px 16px 16px",mb:"-16px",gap:"0",borderRadius:"16px",sx:{backgroundImage:"url('/images/vault_modal_bg@2x.png')",backgroundPosition:"top center",backgroundRepeat:"no-repeat",backgroundSize:"100% 320px"},children:[e.jsxs(_,{h:"36px",w:"100%",mb:"12px",children:[e.jsx(A,{color:"text_caption",fontWeight:"500",fontSize:"16px",children:"Auto Vault"}),e.jsx(Ge,{})]}),e.jsx(bt,{displayTokenA:p,displayTokenB:S,feeDisplay:c,clmmPool:r,isReverse:u,minPrice:o==null?void 0:o.minPrice,maxPrice:o==null?void 0:o.maxPrice,currPrice:o==null?void 0:o.currentPrice,category:m,vaultId:x}),e.jsx(st,{vaultId:x,isModal:!0,autoRefresh:d})]}),e.jsxs(_,{borderTop:"1px solid",borderColor:"border",width:"100%",padding:"12px 16px 4px",justifyContent:m=="haedal"?"space-between":"center",children:[e.jsx(nt,{mt:"0",category:m}),e.jsx(A,{fontSize:"12px",_hover:{color:"primary"},whiteSpace:"nowrap",cursor:"pointer",onClick:()=>{m&&x&&(h(),P(`/vaults-detail/${x}/${m}`))},children:"Vault Details >"})]})]})})})]})}function De(){const t=(i,s,x,m)=>{const p=Math.max(i,x),c=Math.min(s,m)-p,r=s-i,u=m-x,v=V(c.toString()),w=V(r.toString()),y=V(u.toString());return c<=0?V(0):c===r?y.div(v):c===u?v.div(w):v.mul(v).div(y).div(w)};return{getPositionApr:(i,s,x,m)=>{if(!H(i)||!H(s)||!H(m))return;const{minPrice:p,minPriceResever:S,maxPrice:c,maxPriceResever:r}=s,{tokenA:u,tokenB:v,miningAprList:w,feeApr:y,feeApr7d:h,feeApr30d:f,isReverse:P}=i;console.log("ðŸš€ðŸš€ðŸš€ ~ usePositionApr.ts:27 ~ getPositionApr ~ isReverse:",P);const W=u==null?void 0:u.decimals,o=v==null?void 0:v.decimals,N=p=="0"&&c=="âˆž",a=P?S:p,d=N?2**50:P?r:c;console.log("ðŸš€ðŸš€ðŸš€ ~ usePositionApr.ts:31 ~ getPositionApr ~ lowerUserPrice:",a),console.log("ðŸš€ðŸš€ðŸš€ ~ usePositionApr.ts:33 ~ getPositionApr ~ upperUserPrice:",d);const{lower:L,upper:z}=m,se=ze.tickIndexToPrice(L,W,o).toNumber(),re=ze.tickIndexToPrice(z,W,o).toNumber(),k=t(a,d,se,re);console.log("ðŸš€ðŸš€ðŸš€ ~ usePositionApr.ts:41 ~ getPositionApr ~ positionMulti:",k.toString());const R=V(x=="day"?y:x=="month"?f:h).mul(k).toString(),M=[];let F=V(R);return w==null||w.forEach(G=>{const $=V(k).mul(G.apr).toString();M.push({...G,posMiningRewardApr:$}),F=F.add($)}),console.log("ðŸš€ðŸš€ðŸš€ ~ usePositionApr.ts:45 ~ getPositionApr ~",{aprPercentageTotal:F.toString(),aprByFee:R,posMiningReward:M}),{aprPercentageTotal:F.toString(),displayAprPercentageTotal:Je(F.toNumber()*100),aprByFee:R,posMiningReward:M}}}}function yt(){const[t,n]=b.useState(!1),{getPositionApr:i}=De(),{getTokenAmountValue:s}=ke(),{posPoolsRelatedData:x,posLiquidityData:m,posFeeData:p,farmsPosRewardsData:S,posRewardsData:c,posApiPoolData:r,poolRangeObj:u,setPosBaseList:v}=X(),{mevProtect:w,transactionMode:y,maxCapForGas:h,customGasPrice:f}=it(),{getCloseTsPayloadAll:P}=xt(),{signAndExecuteTransaction:W,transactionConfirmation:o}=ot(),{fetchAccountBalance:N}=Ne(),{getPositionBaseList:a,getPosRelatedData:d}=ct(),{currentAccount:L}=Se(),z=async()=>{const k=await a(L==null?void 0:L.address);d(k)};return{getPositionSortList:(k,R,M)=>{if(!(M!=null&&M.length))return;const F=(l=[])=>l.map(j=>{var T;return{...j,amountUSD:s((T=j==null?void 0:j.token)==null?void 0:T.coin_type,j==null?void 0:j.display_amount_owed)}}).filter(j=>g(j.display_amount_owed).gt(0)),G=M.map(l=>{var Pe,Ce,Re,Le,Be;const j=l.posId,T=l.clmmPool,C=r[T],D=u[T],E=(Pe=D==null?void 0:D.ranges)==null?void 0:Pe.reduce((oe,xe)=>(oe[xe.dateType]=xe,oe),{}),ne=i(C,x[j],"week",E==null?void 0:E.week),q=m[j],he=s((Ce=l.displayTokenA)==null?void 0:Ce.coin_type,q==null?void 0:q.displayCoinAmountA),be=s((Re=l.displayTokenB)==null?void 0:Re.coin_type,q==null?void 0:q.displayCoinAmountB),Z=g(he).plus(be),U=p[j],ae=s((Le=l.displayTokenA)==null?void 0:Le.coin_type,U==null?void 0:U.displayFeeOwedA),ie=s((Be=l.displayTokenB)==null?void 0:Be.coin_type,U==null?void 0:U.displayFeeOwedB),ce=g(ae).plus(ie),le=F(c[j]),J=F(S[l.id]),ye=[...le,...J].reduce((oe,xe)=>oe.plus(xe.amountUSD),g(0));return{...l,apr:ne,totalLiquidity:Z.toString(),totalFee:ce.toString(),totalRewards:ye.toString()}}),$={apr:(l,j)=>{var D,E;const T=g(((D=l.apr)==null?void 0:D.aprPercentageTotal)??0),C=g(((E=j.apr)==null?void 0:E.aprPercentageTotal)??0);return R==="asc"?T.minus(C).toNumber():C.minus(T).toNumber()},liquidity:(l,j)=>{const T=g(l.totalLiquidity),C=g(j.totalLiquidity);return R==="asc"?T.minus(C).toNumber():C.minus(T).toNumber()},fees:(l,j)=>{const T=g(l.totalFee),C=g(j.totalFee);return R==="asc"?T.minus(C).toNumber():C.minus(T).toNumber()},rewards:(l,j)=>{const T=g(l.totalRewards),C=g(j.totalRewards);return R==="asc"?T.minus(C).toNumber():C.minus(T).toNumber()}};return $[k]&&G.sort($[k]),G},toCloseAllAction:async k=>{n(!0);try{const R=k.map(l=>{var U,ae,ie,ce,le;const j=m[l==null?void 0:l.posId],T=c[l==null?void 0:l.posId],C=r[l.clmmPool],D=!T||(T==null?void 0:T.length)==0?(U=(C==null?void 0:C.miningRewardList)||[])==null?void 0:U.reduce((J,ye)=>(J.push(ye.coinType),J),[]):(T||[]).map(J=>J.coin_address);console.log("ðŸš€ ~ paramsList ~ rewarderCoinTypes:",l,r,C,T,D);const E=ee(j==null?void 0:j.displayCoinAmountA,void 0,!0),ne=ee(j==null?void 0:j.displayCoinAmountB,void 0,!0),q=l.isReverse,[he,be]=q?[g(ne).mul(de.pow(10,(ae=l.displayTokenB)==null?void 0:ae.decimals)).toString(),g(E).mul(de.pow(10,(ie=l.displayTokenA)==null?void 0:ie.decimals)).toString()]:[g(E).mul(de.pow(10,(ce=l.displayTokenA)==null?void 0:ce.decimals)).toString(),g(ne).mul(de.pow(10,(le=l.displayTokenB)==null?void 0:le.decimals)).toString()],Z={posId:l.posType==="farms"?l.id:l.posId,poolAddress:l.clmmPool,coinTypeA:l.coinTypeA,coinTypeB:l.coinTypeB,amountA:he,amountB:be,liquidity:l.liquidity,lowerTick:l.lowerTick,upperTick:l.upperTick,posType:l.posType,rewarderCoinTypes:D};return l.posType==="farms"&&(Z.farmsPoolId=l.farmsPool,Z.farmsPosId=l.id),Z});console.log("ðŸš€ ~ toRemove ~ paramsList:",R);const M={getShowInfo:l=>{const j=l==="success";return{modalDescriptionText:j?"":"Close All",toastTitleText:j?"Close All Successful":"Close All",toastDescriptionContent:j?"":void 0}}};o(M);const{tx:F,msafeParams:G}=await P(R),$=await W(F,M,{useMev:w,useFastMode:y==="Fast Mode",maxCapForGas:h,customGasPrice:f,msafeParams:G});console.log("ðŸš€ ~ toClaim ~ res:",$),$&&(N(),v([]),z())}catch(R){console.error("ðŸš€ ~ toClaim ~ error:",R)}finally{n(!1)}},isRemoveLoading:t}}const jt=({positionInfo:t,width:n,onFeesChange:i})=>{var y,h;const[s,x]=b.useState(!1),{getTokenAmountValue:m}=ke(),{posFeeData:p,posFeeDataLoading:S}=X(),c=p[t==null?void 0:t.posId],r=m((y=t==null?void 0:t.displayTokenA)==null?void 0:y.coin_type,c==null?void 0:c.displayFeeOwedA,"--"),u=m((h=t==null?void 0:t.displayTokenB)==null?void 0:h.coin_type,c==null?void 0:c.displayFeeOwedB,"--"),v=b.useMemo(()=>r!=="--"&&u!=="--"?Q(g(r).plus(u).toString(),2):"$--",[r,u]),{isApp:w}=K();return b.useEffect(()=>{i==null||i(v)},[v]),e.jsx(B,{w:{base:"100%",lg:n||"unset"},justify:{base:"space-between",lg:"unset"},align:"flex-end",flexDirection:{base:"row",lg:"column"},children:e.jsx(O,{p:"12px 0",onClick:f=>te(f),onMouseEnter:Number(r)==0&&Number(u)==0?()=>{}:()=>x(!0),onMouseLeave:()=>x(!1),children:e.jsxs(Ae,{isLazy:!0,trigger:w?"click":"hover",placement:"top-start",children:[e.jsx(fe,{children:e.jsx(me,{as:"button",cursor:Number(r)==0&&Number(u)==0?"default":"help",children:e.jsx(Y,{isLoaded:!!v,children:e.jsx(A,{color:"text_caption",textDecoration:Number(r)==0&&Number(u)==0?"none":"underline dotted",textUnderlineOffset:"3px",borderColor:"text_caption",children:v})})})}),s&&v!=="--"&&e.jsx(Me,{children:e.jsx(Te,{zIndex:"2",w:"fit-content",p:"4px ",children:e.jsx(_e,{p:"8px",children:e.jsxs(B,{align:"flex-start",minW:"200px",children:[e.jsxs(_,{w:"100%",justify:"space-between",borderBottom:"1px solid",borderColor:"border",pb:"8px",sx:{_last:{borderBottom:"none",pb:"0px"}},children:[e.jsx(ge,{token:t==null?void 0:t.displayTokenA,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(B,{align:"flex-end",gap:"4px",children:[e.jsx(A,{fontSize:"12px",color:"text_caption",children:ue(c==null?void 0:c.displayFeeOwedA)}),e.jsx(A,{fontSize:"12px",children:Q(r,2)})]})]}),e.jsxs(_,{w:"100%",justify:"space-between",children:[e.jsx(ge,{token:t==null?void 0:t.displayTokenB,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(B,{align:"flex-end",gap:"4px",children:[e.jsx(A,{fontSize:"12px",color:"text_caption",children:ue(c==null?void 0:c.displayFeeOwedB)}),e.jsx(A,{fontSize:"12px",children:Q(u,2)})]})]})]})})})})]})})})},wt=({positionInfo:t,width:n,onRewardsChange:i})=>{var o,N;const{getTokenAmountValue:s}=ke(),{coinPriceObj:x}=We(),{posRewardsData:m,posRewardsDataLoading:p,posApiPoolData:S,farmsPosRewardsData:c,farmsPosRewardsDataLoading:r}=X(),u=(o=S[t==null?void 0:t.clmmPool])==null?void 0:o.haveMining,v=(N=S[t==null?void 0:t.clmmPool])==null?void 0:N.haveFarming,w=m[t==null?void 0:t.posId],y=c[t==null?void 0:t.id],h=b.useMemo(()=>{const a=w==null?void 0:w.map(d=>{var z;console.log("ðŸš€ ~ list ~ reward:",d);const L=s((z=d==null?void 0:d.token)==null?void 0:z.coin_type,d==null?void 0:d.display_amount_owed,"--");return{...d,amountUSD:L}});return a&&a.length>0?a.filter(d=>g(d.display_amount_owed).gt(0)):[]},[t,w,x]),f=b.useMemo(()=>{const a=y==null?void 0:y.map(d=>{var z;console.log("ðŸš€ ~ list ~ reward:",d);const L=s((z=d==null?void 0:d.token)==null?void 0:z.coin_type,d==null?void 0:d.display_amount_owed,"--");return{...d,amountUSD:L}});return a&&a.length>0?a.filter(d=>g(d.display_amount_owed).gt(0)):[]},[t,y,x]),P=b.useMemo(()=>{let a;const d=h.concat(f);return console.log("ðŸš€ ~ totalUSD ~ arr:",d,h,f),(d==null?void 0:d.length)>0?(d.forEach(L=>{const z=L==null?void 0:L.amountUSD;a=z=="--"||a=="--"?"--":g(a).plus(z).toString()}),a=="--"?"$--":Q(a,2)):"$0"},[h,f]),{isApp:W}=K();return b.useEffect(()=>{i==null||i(P)},[P]),e.jsx(e.Fragment,{children:e.jsx(B,{w:{base:"100%",lg:n||"unset"},justify:{base:"space-between",lg:"unset"},align:{base:"flex-end",lg:"flex-end"},flexDirection:{base:"row",lg:"column"},children:e.jsx(O,{p:"12px 0",onClick:a=>te(a),children:e.jsxs(Ae,{isLazy:!0,trigger:W?"click":"hover",placement:"top-start",children:[e.jsx(fe,{children:e.jsx(me,{as:"button",cursor:P=="$0"?"text":"help",children:e.jsx(Y,{isLoaded:!!P&&!p&&!r,children:e.jsx(A,{color:"text_caption",textDecoration:P=="$0"?"none":"underline dotted",textUnderlineOffset:"3px",children:P})})})}),P!=="$0"&&e.jsx(Me,{children:e.jsx(Te,{zIndex:"2",w:"fit-content",p:"4px",children:e.jsx(_e,{borderRadius:"12px",p:"8px",children:e.jsxs(B,{align:"flex-start",children:[u&&e.jsx(A,{fontSize:"12px",color:"text_caption",children:"Mining Rewards"}),h==null?void 0:h.map(a=>{var d;return e.jsxs(_,{minW:"200px",justify:"space-between",borderBottom:"1px solid",borderColor:"border",pb:"8px",sx:{_last:{borderBottom:"none",pb:"0px"}},children:[e.jsx(ge,{token:a==null?void 0:a.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(B,{align:"flex-end",gap:"4px",children:[e.jsx(A,{fontSize:"12px",color:"text_caption",children:ue(a==null?void 0:a.display_amount_owed)}),e.jsxs(A,{fontSize:"12px",children:[" ",Q(a==null?void 0:a.amountUSD,2)]})]})]},(d=a==null?void 0:a.token)==null?void 0:d.coin_type)}),v&&e.jsx(A,{fontSize:"12px",color:"text_caption",children:"Farming Rewards"}),f==null?void 0:f.map(a=>{var d;return e.jsxs(_,{minW:"200px",justify:"space-between",borderBottom:"1px solid",borderColor:"border",pb:"8px",sx:{_last:{borderBottom:"none",pb:"0px"}},children:[e.jsx(ge,{token:a==null?void 0:a.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(B,{align:"flex-end",gap:"4px",children:[e.jsx(A,{fontSize:"12px",color:"text_caption",children:ue(a==null?void 0:a.display_amount_owed)}),e.jsxs(A,{fontSize:"12px",children:[" ",Q(a==null?void 0:a.amountUSD,2)]})]})]},(d=a==null?void 0:a.token)==null?void 0:d.coin_type)})]})})})})]})})})})},St="/images/icon_active_new@2x.png";function vt({isActive:t,isLoading:n,imgStyle:i={},...s}){const{imgW:x="16px",imgH:m="12px"}=i;return e.jsx(I,{borderRadius:"8px",align:"center",justifyContent:"center",bg:"bg_secondary",h:"18px",p:"0px 8px",...s,children:e.jsx(Fe,{placement:"top",tooltip:e.jsx(A,{fontSize:"12px",lineHeight:"20px",maxW:"240px",textAlign:"left",children:t?"The price of this pool is currently within your position price range.":"The price of this pool is currently out of your position price range."}),children:e.jsx(me,{onClick:p=>te(p),children:e.jsxs(_,{align:"center",children:[t&&e.jsx(pe,{w:x,h:m,src:St}),e.jsx(Y,{w:"100%",isLoaded:!n,children:e.jsx(A,{fontSize:"12px",color:t?"primary":"primary_gray",fontWeight:"500",children:t?"Active":"Inactive"})})]})})})})}function At({positionInfo:t,width:n}){const{posPoolsRelatedData:i}=X(),s=i[t==null?void 0:t.posId],x=(s==null?void 0:s.currentStatus)=="Active";K();const m=b.useMemo(()=>s==null?void 0:s.minPriceOrigin,[s]),p=b.useMemo(()=>s==null?void 0:s.maxPriceOrigin,[s]),S=b.useMemo(()=>s==null?void 0:s.currentPriceOrigin,[s]),[c,r]=b.useState(0),u=b.useRef(null);b.useEffect(()=>{const w=()=>{u.current&&r(u.current.offsetWidth)},y=new ResizeObserver(w);return u.current&&y.observe(u.current),()=>{u.current&&y.unobserve(u.current)}},[m,p,S]);const v=b.useMemo(()=>{if(p==="âˆž")return"0px";if(S&&m&&p&&c){if(g(S).lessThanOrEqualTo(p)&&g(S).greaterThanOrEqualTo(m)){const w=g(S).sub(m).div(g(p).sub(g(m))).toString();return`${g(c).mul(w).toFixed(0)}px`}if(g(S).lt(m))return"6px";if(g(S).gt(p))return"calc(100% - 6px)"}return"0px"},[S,m,p,c]);return e.jsxs(B,{align:"flex-start",w:{base:"100%",lg:n},maxW:{base:"100%",lg:n},children:[e.jsxs(_,{maxW:"100%",w:{base:"100%",lg:"unset"},borderRadius:"12px",pr:"16px",children:[e.jsx(Y,{isLoaded:!!(s!=null&&s.minPrice)&&!!(s!=null&&s.maxPrice),borderRadius:"4px",children:e.jsx(A,{lineHeight:"1",fontSize:"14px",color:"text_caption",whiteSpace:"nowrap",children:`${s==null?void 0:s.minPrice} - ${s==null?void 0:s.maxPrice}`})}),e.jsx(vt,{isActive:x,isLoading:(s==null?void 0:s.currentStatus)==""})]}),e.jsx(Y,{h:"6px",isLoaded:!!(s!=null&&s.currentPriceOrigin),borderRadius:"4px",children:e.jsx(O,{w:"88px",h:"6px",bgImage:p==="âˆž"?"none":"url('/images/img_inactive_bg@2x.png')",bgSize:"88px 6px",children:e.jsx(O,{w:"88px",h:p==="âˆž"?"2px":"6px",position:"relative",ref:u,background:p==="âˆž"?"linear-gradient(135deg, #68FFD8 0%, #0091FF 100%)":x?"url('/images/position_img_active@2x.png')":"none",bgSize:"100% 6px",bgPosition:"center",bgRepeat:"no-repeat",children:p!=="âˆž"&&e.jsx(O,{w:"2px",h:"8px",bg:"#fff",borderRadius:"8px",position:"absolute",top:"50%",left:v,transform:"translateY(-50%)",zIndex:"5"})})})})]})}function ft({positionInfo:t,positionItemWidth:n=[]}){const{isApp:i}=K(),{getExplorerUrl:s}=Qe(),{getClmmPosName:x}=lt(),m=ve(),{setCurrentPosDetailTab:p}=ut(),{posPoolsOriginalData:S,posPoolsRelatedData:c,posApiPoolData:r,poolRangeObj:u}=X(),v=c[t==null?void 0:t.posId],w=r[t==null?void 0:t.clmmPool],y=b.useMemo(()=>{var k;if(t!=null&&t.tokenName)return t==null?void 0:t.tokenName;{const R=(k=S==null?void 0:S[t==null?void 0:t.clmmPool])==null?void 0:k.index;return x(Number(t==null?void 0:t.index),R)}},[t==null?void 0:t.tokenName,t==null?void 0:t.index,t==null?void 0:t.clmmPool,S]),h=()=>{console.log("ðŸš€ ~ PoolItem ~ poolInfo:",t),m(`/position-detail/${t==null?void 0:t.id}`)},[f,P]=b.useState(!1),{getPositionApr:W}=De(),o=b.useMemo(()=>{if(H(v)&&H(w)&&H(u)){console.log("ðŸš€ ~ positionApr ~ poolRangeObj:",u);const k=u[t==null?void 0:t.clmmPool];if(k){const R=k==null?void 0:k.ranges.reduce((M,F)=>(M[F.dateType]=F,M),{});return W(w,v,"week",R.week)}}},[v,w,t,u]),{toClaimPosition:N,isClaimLoading:a}=pt(),d=()=>{N(t,null,!0)},[L,z]=b.useState(null),[se,re]=b.useState(null);return e.jsxs(Oe,{onMouseEnter:()=>{setTimeout(()=>{P(!0)},40)},onMouseLeave:()=>{setTimeout(()=>{P(!1)},80)},w:"100%",bg:"position_bg",border:"none",p:{base:"16px 8px 12px",lg:"20px 16px "},borderRadius:"16px",onClick:h,children:[e.jsx(_,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:e.jsx(B,{w:"100%",align:"flex-start",children:e.jsxs(_,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},gap:{base:"0",lg:"8px"},children:[i&&e.jsx(O,{h:"4px"}),e.jsx(At,{positionInfo:t,width:n[0]}),i&&e.jsx(O,{h:"4px"}),e.jsx(_,{w:n[1],justify:"flex-end",children:e.jsx(Y,{isLoaded:!!o,children:e.jsx(A,{textAlign:"right",color:"text_caption",children:o==null?void 0:o.displayAprPercentageTotal})})}),e.jsx(B,{w:{base:"100%",lg:n[2]},justify:{base:"space-between",lg:"unset"},align:"flex-end",flexDirection:{base:"row",lg:"column"},children:e.jsx(mt,{positionInfo:t,fontSize:"14px"})}),e.jsx(jt,{positionInfo:t,width:n[3],onFeesChange:z}),e.jsx(wt,{positionInfo:t,width:n[4],onRewardsChange:re})]})})}),e.jsx(O,{sx:{maxHeight:f?"44px":"0",opacity:f?1:0,overflow:"hidden",transition:"all 0.2s ease"},children:e.jsxs(_,{w:"100%",justify:"space-between",mt:"12px",children:[e.jsxs(_,{flexDirection:{base:"column",lg:"row"},w:{base:"100%",lg:"unset"},children:[e.jsxs(_,{w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"flex-start"},children:[e.jsx(A,{fontSize:{base:"14px",lg:"12px"},children:"NFT ID"}),e.jsx(Y,{isLoaded:!!y,children:e.jsx(A,{fontWeight:"500",fontSize:{base:"14px",lg:"12px"},color:"text_caption",children:y==null?void 0:y.split("|")[1]})})]}),e.jsxs(_,{w:{base:"100%",lg:"unset"},justify:{base:"space-between",lg:"flex-start"},children:[e.jsx(A,{fontSize:{base:"14px",lg:"12px"},ml:{base:"0",lg:"8px"},children:"Address"}),e.jsx(gt,{fontWeight:"500",color:"text_caption",address:t==null?void 0:t.id,showLink:!1,fontSize:{base:"14px",lg:"12px"},onClickLink:()=>{window.open(s(t==null?void 0:t.id,"nftAddress"),"_blank")}})]})]}),e.jsxs(_,{children:[e.jsx(je,{variant:"outline",fontSize:"12px",bg:"none",w:"96px",h:"32px",borderRadius:"8px",onClick:()=>p("increase"),children:"Increase"}),e.jsx(je,{variant:"outline",fontSize:"12px",bg:"none",w:"96px",h:"32px",borderRadius:"8px",onClick:()=>p("remove"),children:"Remove"}),e.jsx(je,{variant:"outline",fontSize:"12px",bg:"none",w:"96px",h:"32px",borderRadius:"8px",onClick:k=>{te(k),d()},isLoading:a,disabled:a||L=="$0"&&se=="$0",children:"Claim Yield"})]})]})})]})}const we=["480px","20%","20%","20%","20%"],Ee=[{label:"APR",value:"apr"},{label:"Liquidity",value:"liquidity"},{label:"Pending Fees",value:"fees"},{label:"Pending Rewards",value:"rewards"}],Tt=Ee.reduce((t,n)=>(t[n.value]=n,t),{});function Gt({poolInfo:t}){var w,y;const{coinPriceObj:n}=We(),{posApiPoolData:i}=X(),{getPositionSortList:s}=yt(),[x,m]=b.useState("desc"),[p,S]=b.useState({label:"",value:""}),c=(w=i[t==null?void 0:t.clmmPoolAddress])==null?void 0:w.haveMining,r=(y=i[t==null?void 0:t.clmmPoolAddress])==null?void 0:y.haveFarming,u=h=>{(h==null?void 0:h.value)===p.value?m(f=>f==="desc"?"asc":"desc"):(m("desc"),S(h))},v=b.useMemo(()=>{if(!H(t))return[];const h=p.value?s(p.value,x,t.list):t.list;return console.log("ðŸš€ ~ positionList ~ sortedList:",h),h},[p.value,x,t==null?void 0:t.list,n]);return e.jsxs(B,{gap:"12px",w:"100%",maxH:"680px",overflow:"auto",children:[e.jsxs(_,{w:"100%",p:"0 16px",children:[e.jsx(A,{w:we[0],children:"Price Range"}),Ee.map((h,f)=>e.jsxs(_,{gap:"4px",w:we[f+1],justify:"flex-end",children:[c&&h.value=="rewards"&&e.jsx(pe,{w:"18px",h:"18px",src:"/images/icon_mining.png"}),r&&h.value=="rewards"&&e.jsx(pe,{w:"18px",h:"18px",src:"/images/icon_farms.png"}),e.jsx(dt,{labelInfo:Tt[h.value],sortRule:x,sortBy:p,clickSort:u})]},h.value))]}),v.map(h=>e.jsx(ft,{positionInfo:h,positionItemWidth:we},h==null?void 0:h.id))]})}export{Ht as F,Gt as P,Yt as V,yt as a,qt as u};
//# sourceMappingURL=PositionItem-BBmXnuWT.js.map
